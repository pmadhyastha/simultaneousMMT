-------
[train]
-------
         num_workers:0
          pin_memory:False
                seed:1582660384
               gclip:1
              l2_reg:1e-05
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
          model_type:SimultaneousWaitKNMT
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:64
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:
             de-hyphen
     eval_batch_size:32
           eval_freq:0
        eval_max_len:100
          eval_start:1
           eval_zero:False
   save_best_metrics:True
           save_path:/homes/al4616/experiments/simnmt/nmtpy/word2word/en-fr
    save_optim_state:False
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/homes/al4616/experiments/simnmt/nmtpy/word2word/en-fr/tb_dir
     pretrained_file:
   pretrained_layers:
       freeze_layers:
          handle_oom:False
           subfolder:wait2-rnn-unimodal
              exp_id:simultaneouswaitknmt-rc615e
------
[vars]
------
                  sl:en
                  tl:fr
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             enc_dim:320
   enc_bidirectional:False
             dec_dim:320
             emb_dim:200
         dropout_emb:0.4
         dropout_ctx:0.5
         dropout_out:0.5
          n_encoders:2
            tied_emb:2way
             max_len:None
           out_logic:deep
           direction:src:Text -> trg:Text
        sampler_type:bucket
           bucket_by:src
     translator_args:
                     k:2
------
[data]
------
            txt_root:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr
           train_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.fr
             val_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.fr
test_2016_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.fr
test_2017_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.fr
------------
[vocabulary]
------------
                 src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.en
                 trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.fr
----------------------------------------------------------------------

Python 3.7.7 -- torch 1.4.0 with CUDA 10.1 (on machine 'kingfisher.doc.ic.ac.uk')
nmtpytorch 4.1.0
DeviceManager(cuda:0, n_gpu=1)
Seed for further reproducibility: 1582660384
SLURM Job ID: 7213
Loading dataset(s)
Initializing dataset for 'src'...
0sents [00:00, ?sents/s]18567sents [00:00, 185639.20sents/s]29000sents [00:00, 182250.38sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]15318sents [00:00, 153152.40sents/s]29000sents [00:00, 149341.37sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'train.lc.norm.tok.en' (29000 sentences)
  Targets:
    --> TextDataset 'train.lc.norm.tok.fr' (29000 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 161742.70sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]1014sents [00:00, 132990.13sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)
  Targets:
    --> TextDataset 'val.lc.norm.tok.fr' (1014 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 173324.00sents/s]
Skipping 'trg' as target
MultimodalDataset - (1 source(s) / 0 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)

Ignoring batch_size 32 for simultaneous greedy search
SimultaneousWaitKNMT(
  (encoders): ModuleDict(
    (src): TextEncoder(
      (do_emb): Dropout(p=0.4, inplace=False)
      (emb): Embedding(9797, 200, padding_idx=0)
      (enc): GRU(200, 320, num_layers=2)
      (output): Sequential(
        (0): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (dec): SimultaneousConditionalDecoder(
    (emb): Embedding(11048, 200, padding_idx=0)
    (att): ModuleDict(
      (src): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
    )
    (dec0): GRUCell(200, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.5, inplace=False)
    (hid2out): FF(in_features=840, out_features=200, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=200, out_features=11048, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss()
  )
)
Vocabulary of 9797 items ('train.lc.norm.tok.vocab.en')
Vocabulary of 11048 items ('train.lc.norm.tok.vocab.fr')
# parameters: 6.89M (6.89M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 1e-05, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Training started on 03-06-2020 00:07:58
Starting Epoch 1
Epoch 1 - update         30 => loss:   6.739 (#OOM: 0)
Epoch 1 - update         60 => loss:   5.733 (#OOM: 0)
Epoch 1 - update         90 => loss:   5.188 (#OOM: 0)
Epoch 1 - update        120 => loss:   4.968 (#OOM: 0)
Epoch 1 - update        150 => loss:   4.335 (#OOM: 0)
Epoch 1 - update        180 => loss:   4.684 (#OOM: 0)
Epoch 1 - update        210 => loss:   4.494 (#OOM: 0)
Epoch 1 - update        240 => loss:   4.398 (#OOM: 0)
Epoch 1 - update        270 => loss:   4.017 (#OOM: 0)
Epoch 1 - update        300 => loss:   4.155 (#OOM: 0)
Epoch 1 - update        330 => loss:   3.873 (#OOM: 0)
Epoch 1 - update        360 => loss:   3.490 (#OOM: 0)
Epoch 1 - update        390 => loss:   3.950 (#OOM: 0)
Epoch 1 - update        420 => loss:   3.830 (#OOM: 0)
Epoch 1 - update        450 => loss:   3.949 (#OOM: 0)
--> Epoch 1 finished with mean loss 4.61925
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (810 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 35.33batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.63batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.53batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 51.95batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 53.10batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.31batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 89.10batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 76.88batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.90batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 75.42batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 76.56batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 76.41batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 73.13batch/s]  7%|██                          | 73/1014 [00:00<00:12, 74.54batch/s]  8%|██▎                         | 83/1014 [00:01<00:12, 75.54batch/s]  9%|██▌                         | 93/1014 [00:01<00:12, 74.92batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 74.73batch/s] 11%|███                        | 113/1014 [00:01<00:12, 75.01batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.12batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.95batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 77.47batch/s] 15%|████▏                      | 155/1014 [00:01<00:10, 78.24batch/s] 16%|████▍                      | 166/1014 [00:02<00:10, 78.38batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 78.46batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 78.00batch/s] 20%|█████▎                     | 199/1014 [00:02<00:10, 78.30batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 78.84batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 78.55batch/s] 23%|██████▏                    | 232/1014 [00:02<00:09, 79.00batch/s] 24%|██████▍                    | 243/1014 [00:03<00:09, 78.85batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 77.55batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 77.95batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 78.52batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 79.06batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 79.14batch/s] 30%|████████▏                  | 309/1014 [00:03<00:08, 79.50batch/s] 32%|████████▌                  | 320/1014 [00:04<00:08, 79.39batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 79.17batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 78.92batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 79.13batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 79.16batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 79.30batch/s] 38%|██████████▎                | 386/1014 [00:04<00:07, 79.12batch/s] 39%|██████████▌                | 397/1014 [00:05<00:07, 79.20batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 79.29batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 79.16batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 79.29batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 79.44batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 79.73batch/s] 46%|████████████▎              | 463/1014 [00:05<00:06, 79.88batch/s] 47%|████████████▌              | 474/1014 [00:05<00:06, 79.36batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 79.25batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 79.25batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 79.42batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 79.22batch/s] 52%|██████████████             | 529/1014 [00:06<00:06, 79.16batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:05, 79.24batch/s] 54%|██████████████▋            | 551/1014 [00:06<00:05, 79.06batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 79.17batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 79.30batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 79.42batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 79.41batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 78.79batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:05, 78.88batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:04, 78.03batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 78.24batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 78.54batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 78.52batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 78.59batch/s] 67%|██████████████████▏        | 683/1014 [00:08<00:04, 78.60batch/s] 68%|██████████████████▍        | 694/1014 [00:08<00:04, 78.95batch/s] 70%|██████████████████▊        | 705/1014 [00:08<00:03, 78.98batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 78.59batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 78.65batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 78.81batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 78.73batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 78.73batch/s] 76%|████████████████████▌      | 771/1014 [00:09<00:03, 78.62batch/s] 77%|████████████████████▊      | 782/1014 [00:09<00:02, 78.57batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 78.62batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 78.69batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 78.85batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 78.95batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 79.11batch/s] 84%|██████████████████████▌    | 848/1014 [00:10<00:02, 79.15batch/s] 85%|██████████████████████▊    | 859/1014 [00:10<00:01, 79.07batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 78.99batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 79.05batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 79.06batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 79.11batch/s] 90%|████████████████████████▎  | 914/1014 [00:11<00:01, 79.17batch/s] 91%|████████████████████████▋  | 925/1014 [00:11<00:01, 79.27batch/s] 92%|████████████████████████▉  | 936/1014 [00:11<00:00, 79.42batch/s] 93%|█████████████████████████▏ | 947/1014 [00:11<00:00, 79.47batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 79.08batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 79.00batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 78.68batch/s] 98%|██████████████████████████▍| 991/1014 [00:12<00:00, 78.73batch/s] 99%|█████████████████████████▋| 1002/1014 [00:12<00:00, 78.79batch/s]100%|█████████████████████████▉| 1013/1014 [00:12<00:00, 78.35batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 78.35batch/s]
Validation 1 -> LOSS = 3.20
Validation 1 -> BLEU = 12.60, 45.1/18.2/8.3/4.1 (BP=0.976, ratio=0.977, hyp_len=14046, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 3.20 @ validation 1
--> Best BLEU so far: 12.60 @ validation 1
Starting Epoch 2
Epoch 2 - update        480 => loss:   4.015 (#OOM: 0)
Epoch 2 - update        510 => loss:   3.543 (#OOM: 0)
Epoch 2 - update        540 => loss:   3.190 (#OOM: 0)
Epoch 2 - update        570 => loss:   3.132 (#OOM: 0)
Epoch 2 - update        600 => loss:   3.642 (#OOM: 0)
Epoch 2 - update        630 => loss:   3.175 (#OOM: 0)
Epoch 2 - update        660 => loss:   3.227 (#OOM: 0)
Epoch 2 - update        690 => loss:   3.087 (#OOM: 0)
Epoch 2 - update        720 => loss:   3.355 (#OOM: 0)
Epoch 2 - update        750 => loss:   3.199 (#OOM: 0)
Epoch 2 - update        780 => loss:   3.175 (#OOM: 0)
Epoch 2 - update        810 => loss:   3.114 (#OOM: 0)
Epoch 2 - update        840 => loss:   2.935 (#OOM: 0)
Epoch 2 - update        870 => loss:   2.875 (#OOM: 0)
Epoch 2 - update        900 => loss:   2.798 (#OOM: 0)
Epoch 2 - update        930 => loss:   2.894 (#OOM: 0)
--> Epoch 2 finished with mean loss 3.17644
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (796 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.85batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.80batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 56.75batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 54.33batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 55.26batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.43batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.45batch/s]  2%|▍                           | 16/1014 [00:00<00:16, 60.58batch/s]  2%|▋                           | 24/1014 [00:00<00:15, 65.54batch/s]  3%|▉                           | 32/1014 [00:00<00:16, 59.51batch/s]  4%|█                           | 40/1014 [00:00<00:18, 52.50batch/s]  5%|█▎                          | 48/1014 [00:00<00:17, 55.45batch/s]  6%|█▌                          | 56/1014 [00:01<00:18, 50.89batch/s]  6%|█▊                          | 64/1014 [00:01<00:17, 53.19batch/s]  7%|█▉                          | 72/1014 [00:01<00:17, 54.35batch/s]  8%|██▏                         | 81/1014 [00:01<00:16, 56.65batch/s]  9%|██▍                         | 90/1014 [00:01<00:16, 55.82batch/s] 10%|██▋                        | 100/1014 [00:01<00:15, 57.89batch/s] 11%|██▉                        | 110/1014 [00:01<00:15, 57.54batch/s] 12%|███▏                       | 120/1014 [00:02<00:15, 57.72batch/s] 13%|███▍                       | 130/1014 [00:02<00:14, 59.36batch/s] 14%|███▋                       | 140/1014 [00:02<00:14, 58.69batch/s] 15%|███▉                       | 150/1014 [00:02<00:14, 59.53batch/s] 16%|████▎                      | 160/1014 [00:02<00:14, 60.50batch/s] 17%|████▌                      | 170/1014 [00:02<00:13, 61.53batch/s] 18%|████▊                      | 180/1014 [00:02<00:13, 62.25batch/s] 19%|█████                      | 190/1014 [00:03<00:13, 63.13batch/s] 20%|█████▎                     | 200/1014 [00:03<00:12, 63.96batch/s] 21%|█████▌                     | 210/1014 [00:03<00:12, 64.60batch/s] 22%|█████▊                     | 220/1014 [00:03<00:12, 64.98batch/s] 23%|██████                     | 230/1014 [00:03<00:12, 64.14batch/s] 24%|██████▍                    | 240/1014 [00:03<00:12, 64.39batch/s] 25%|██████▋                    | 250/1014 [00:03<00:11, 64.92batch/s] 26%|██████▉                    | 260/1014 [00:03<00:11, 65.04batch/s] 27%|███████▏                   | 270/1014 [00:04<00:11, 64.55batch/s] 28%|███████▍                   | 280/1014 [00:04<00:11, 64.75batch/s] 29%|███████▋                   | 290/1014 [00:04<00:11, 65.16batch/s] 30%|███████▉                   | 300/1014 [00:04<00:10, 65.38batch/s] 31%|████████▎                  | 310/1014 [00:04<00:10, 65.51batch/s] 32%|████████▌                  | 320/1014 [00:04<00:10, 65.79batch/s] 33%|████████▊                  | 330/1014 [00:04<00:10, 66.10batch/s] 34%|█████████                  | 340/1014 [00:05<00:10, 66.40batch/s] 35%|█████████▎                 | 350/1014 [00:05<00:09, 66.60batch/s] 36%|█████████▌                 | 360/1014 [00:05<00:09, 65.63batch/s] 36%|█████████▊                 | 370/1014 [00:05<00:09, 64.60batch/s] 37%|██████████                 | 380/1014 [00:05<00:09, 65.11batch/s] 38%|██████████▍                | 390/1014 [00:06<00:09, 64.83batch/s] 39%|██████████▋                | 400/1014 [00:06<00:09, 65.37batch/s] 40%|██████████▉                | 410/1014 [00:06<00:09, 64.76batch/s] 41%|███████████▏               | 420/1014 [00:06<00:09, 65.04batch/s] 42%|███████████▍               | 430/1014 [00:06<00:08, 65.31batch/s] 43%|███████████▋               | 440/1014 [00:06<00:08, 64.87batch/s] 44%|███████████▉               | 450/1014 [00:06<00:08, 64.98batch/s] 45%|████████████▏              | 460/1014 [00:07<00:08, 65.12batch/s] 46%|████████████▌              | 470/1014 [00:07<00:08, 65.22batch/s] 47%|████████████▊              | 480/1014 [00:07<00:08, 65.25batch/s] 48%|█████████████              | 490/1014 [00:07<00:07, 65.55batch/s] 49%|█████████████▎             | 500/1014 [00:07<00:07, 65.88batch/s] 50%|█████████████▌             | 510/1014 [00:07<00:07, 65.35batch/s] 51%|█████████████▊             | 520/1014 [00:07<00:07, 65.06batch/s] 52%|██████████████             | 530/1014 [00:08<00:07, 65.42batch/s] 53%|██████████████▍            | 540/1014 [00:08<00:07, 65.75batch/s] 54%|██████████████▋            | 550/1014 [00:08<00:07, 66.14batch/s] 55%|██████████████▉            | 560/1014 [00:08<00:06, 66.36batch/s] 56%|███████████████▏           | 570/1014 [00:08<00:06, 66.46batch/s] 57%|███████████████▍           | 580/1014 [00:08<00:06, 66.42batch/s] 58%|███████████████▋           | 590/1014 [00:08<00:06, 66.62batch/s] 59%|███████████████▉           | 600/1014 [00:09<00:06, 66.57batch/s] 60%|████████████████▏          | 610/1014 [00:09<00:06, 66.34batch/s] 61%|████████████████▌          | 620/1014 [00:09<00:05, 66.13batch/s] 62%|████████████████▊          | 630/1014 [00:09<00:05, 65.94batch/s] 63%|█████████████████          | 640/1014 [00:09<00:05, 66.15batch/s] 64%|█████████████████▎         | 650/1014 [00:09<00:05, 66.00batch/s] 65%|█████████████████▌         | 660/1014 [00:10<00:05, 65.53batch/s] 66%|█████████████████▊         | 670/1014 [00:10<00:05, 65.29batch/s] 67%|██████████████████         | 680/1014 [00:10<00:05, 65.11batch/s] 68%|██████████████████▎        | 690/1014 [00:10<00:04, 65.21batch/s] 69%|██████████████████▋        | 700/1014 [00:10<00:04, 65.30batch/s] 70%|██████████████████▉        | 710/1014 [00:10<00:04, 65.35batch/s] 71%|███████████████████▏       | 720/1014 [00:10<00:04, 65.49batch/s] 72%|███████████████████▍       | 730/1014 [00:11<00:04, 65.58batch/s] 73%|███████████████████▋       | 740/1014 [00:11<00:04, 65.79batch/s] 74%|███████████████████▉       | 750/1014 [00:11<00:04, 65.89batch/s] 75%|████████████████████▏      | 760/1014 [00:11<00:03, 65.62batch/s] 76%|████████████████████▌      | 770/1014 [00:11<00:03, 65.72batch/s] 77%|████████████████████▊      | 780/1014 [00:11<00:03, 65.78batch/s] 78%|█████████████████████      | 790/1014 [00:11<00:03, 65.95batch/s] 79%|█████████████████████▎     | 800/1014 [00:12<00:03, 66.04batch/s] 80%|█████████████████████▌     | 810/1014 [00:12<00:03, 65.81batch/s] 81%|█████████████████████▊     | 820/1014 [00:12<00:02, 65.98batch/s] 82%|██████████████████████     | 830/1014 [00:12<00:02, 66.12batch/s] 83%|██████████████████████▎    | 840/1014 [00:12<00:02, 66.20batch/s] 84%|██████████████████████▋    | 850/1014 [00:12<00:02, 66.36batch/s] 85%|██████████████████████▉    | 860/1014 [00:13<00:02, 66.02batch/s] 86%|███████████████████████▏   | 870/1014 [00:13<00:02, 66.19batch/s] 87%|███████████████████████▍   | 880/1014 [00:13<00:02, 66.26batch/s] 88%|███████████████████████▋   | 890/1014 [00:13<00:01, 66.28batch/s] 89%|███████████████████████▉   | 900/1014 [00:13<00:01, 66.10batch/s] 90%|████████████████████████▏  | 910/1014 [00:13<00:01, 65.82batch/s] 91%|████████████████████████▍  | 920/1014 [00:13<00:01, 65.94batch/s] 92%|████████████████████████▊  | 930/1014 [00:14<00:01, 66.13batch/s] 93%|█████████████████████████  | 940/1014 [00:14<00:01, 66.15batch/s] 94%|█████████████████████████▎ | 950/1014 [00:14<00:00, 65.89batch/s] 95%|█████████████████████████▌ | 960/1014 [00:14<00:00, 65.98batch/s] 96%|█████████████████████████▊ | 970/1014 [00:14<00:00, 66.06batch/s] 97%|██████████████████████████ | 980/1014 [00:14<00:00, 66.18batch/s] 98%|██████████████████████████▎| 990/1014 [00:14<00:00, 66.26batch/s] 99%|█████████████████████████▋| 1000/1014 [00:15<00:00, 66.16batch/s]100%|█████████████████████████▉| 1010/1014 [00:15<00:00, 66.26batch/s]100%|██████████████████████████| 1014/1014 [00:15<00:00, 66.34batch/s]
Validation 2 -> LOSS = 2.56
Validation 2 -> BLEU = 17.32, 42.8/22.0/12.7/7.5 (BP=1.000, ratio=1.217, hyp_len=17502, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 2.56 @ validation 2
--> Best BLEU so far: 17.32 @ validation 2
Starting Epoch 3
Epoch 3 - update        960 => loss:   2.612 (#OOM: 0)
Epoch 3 - update        990 => loss:   2.661 (#OOM: 0)
Epoch 3 - update       1020 => loss:   2.604 (#OOM: 0)
Epoch 3 - update       1050 => loss:   2.984 (#OOM: 0)
Epoch 3 - update       1080 => loss:   2.467 (#OOM: 0)
Epoch 3 - update       1110 => loss:   2.560 (#OOM: 0)
Epoch 3 - update       1140 => loss:   2.579 (#OOM: 0)
Epoch 3 - update       1170 => loss:   2.523 (#OOM: 0)
Epoch 3 - update       1200 => loss:   2.280 (#OOM: 0)
Epoch 3 - update       1230 => loss:   2.920 (#OOM: 0)
Epoch 3 - update       1260 => loss:   2.255 (#OOM: 0)
Epoch 3 - update       1290 => loss:   2.805 (#OOM: 0)
Epoch 3 - update       1320 => loss:   2.510 (#OOM: 0)
Epoch 3 - update       1350 => loss:   2.340 (#OOM: 0)
Epoch 3 - update       1380 => loss:   1.985 (#OOM: 0)
Epoch 3 - update       1410 => loss:   2.252 (#OOM: 0)
--> Epoch 3 finished with mean loss 2.66741
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (795 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 40.11batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 45.92batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.72batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 52.62batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 52.99batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.79batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:25, 39.05batch/s]  1%|▎                           | 13/1014 [00:00<00:15, 63.70batch/s]  2%|▌                           | 22/1014 [00:00<00:14, 69.43batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 75.06batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 76.87batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 78.43batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 79.23batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 79.31batch/s]  8%|██▎                         | 82/1014 [00:01<00:12, 75.49batch/s]  9%|██▌                         | 92/1014 [00:01<00:12, 76.83batch/s] 10%|██▋                        | 102/1014 [00:01<00:11, 77.83batch/s] 11%|██▉                        | 112/1014 [00:01<00:11, 78.26batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 78.31batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 77.01batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 76.74batch/s] 15%|████                       | 152/1014 [00:01<00:11, 77.16batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 77.51batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 76.12batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 76.43batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 76.77batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 77.07batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 76.96batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.83batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.64batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 74.22batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.28batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 73.13batch/s] 27%|███████▏                   | 272/1014 [00:03<00:10, 73.16batch/s] 28%|███████▌                   | 282/1014 [00:03<00:10, 72.79batch/s] 29%|███████▊                   | 292/1014 [00:04<00:09, 72.88batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 72.77batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 71.14batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 71.31batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 71.49batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 71.56batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:09, 72.00batch/s] 36%|█████████▋                 | 362/1014 [00:05<00:09, 72.18batch/s] 37%|█████████▉                 | 372/1014 [00:05<00:08, 72.23batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 72.10batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 72.14batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 72.50batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 71.95batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 72.02batch/s] 43%|███████████▌               | 432/1014 [00:06<00:08, 71.97batch/s] 44%|███████████▊               | 442/1014 [00:06<00:07, 72.33batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 72.57batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 71.93batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 72.00batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 72.32batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 72.20batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:07, 72.41batch/s] 50%|█████████████▋             | 512/1014 [00:07<00:06, 72.04batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 71.85batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 71.98batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 72.25batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 72.53batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 72.68batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:06, 72.25batch/s] 57%|███████████████▍           | 582/1014 [00:08<00:05, 72.23batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 72.45batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 72.48batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 72.56batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 72.63batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 72.75batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 71.80batch/s] 64%|█████████████████▎         | 652/1014 [00:09<00:05, 71.75batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 71.82batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 71.89batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 71.94batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 72.01batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 72.07batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 72.17batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:04, 72.21batch/s] 72%|███████████████████▍       | 732/1014 [00:10<00:03, 72.19batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 72.19batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 72.35batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 72.35batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 71.88batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 72.00batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:03, 72.14batch/s] 79%|█████████████████████▎     | 802/1014 [00:11<00:02, 72.27batch/s] 80%|█████████████████████▌     | 812/1014 [00:11<00:02, 72.43batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 72.19batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 72.22batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 72.07batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 71.97batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 72.00batch/s] 86%|███████████████████████▏   | 872/1014 [00:12<00:01, 71.74batch/s] 87%|███████████████████████▍   | 882/1014 [00:12<00:01, 71.86batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 71.95batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 71.98batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 72.12batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 72.07batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 72.15batch/s] 93%|█████████████████████████  | 942/1014 [00:13<00:00, 72.07batch/s] 94%|█████████████████████████▎ | 952/1014 [00:13<00:00, 72.15batch/s] 95%|█████████████████████████▌ | 962/1014 [00:13<00:00, 72.18batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 72.22batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 72.33batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 72.45batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 72.43batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 72.54batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 72.56batch/s]
Validation 3 -> LOSS = 2.21
Validation 3 -> BLEU = 24.76, 51.8/30.4/19.3/12.3 (BP=1.000, ratio=1.098, hyp_len=15795, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 2.21 @ validation 3
--> Best BLEU so far: 24.76 @ validation 3
Starting Epoch 4
Epoch 4 - update       1440 => loss:   2.022 (#OOM: 0)
Epoch 4 - update       1470 => loss:   2.150 (#OOM: 0)
Epoch 4 - update       1500 => loss:   2.581 (#OOM: 0)
Epoch 4 - update       1530 => loss:   2.252 (#OOM: 0)
Epoch 4 - update       1560 => loss:   2.425 (#OOM: 0)
Epoch 4 - update       1590 => loss:   2.291 (#OOM: 0)
Epoch 4 - update       1620 => loss:   2.338 (#OOM: 0)
Epoch 4 - update       1650 => loss:   2.216 (#OOM: 0)
Epoch 4 - update       1680 => loss:   2.053 (#OOM: 0)
Epoch 4 - update       1710 => loss:   2.358 (#OOM: 0)
Epoch 4 - update       1740 => loss:   2.090 (#OOM: 0)
Epoch 4 - update       1770 => loss:   2.511 (#OOM: 0)
Epoch 4 - update       1800 => loss:   2.104 (#OOM: 0)
Epoch 4 - update       1830 => loss:   2.685 (#OOM: 0)
Epoch 4 - update       1860 => loss:   2.157 (#OOM: 0)
Epoch 4 - update       1890 => loss:   2.284 (#OOM: 0)
--> Epoch 4 finished with mean loss 2.35354
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (807 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.17batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.30batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.22batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.58batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.22batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.92batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:13, 73.36batch/s]  2%|▌                           | 19/1014 [00:00<00:11, 83.32batch/s]  3%|▊                           | 29/1014 [00:00<00:12, 81.97batch/s]  4%|█                           | 39/1014 [00:00<00:12, 80.57batch/s]  5%|█▎                          | 49/1014 [00:00<00:12, 79.77batch/s]  6%|█▋                          | 59/1014 [00:00<00:11, 80.57batch/s]  7%|█▉                          | 69/1014 [00:00<00:11, 81.99batch/s]  8%|██▏                         | 79/1014 [00:00<00:11, 82.63batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 82.46batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 82.51batch/s] 11%|██▉                        | 109/1014 [00:01<00:10, 83.04batch/s] 12%|███▏                       | 119/1014 [00:01<00:10, 82.26batch/s] 13%|███▍                       | 129/1014 [00:01<00:10, 82.26batch/s] 14%|███▋                       | 139/1014 [00:01<00:10, 81.36batch/s] 15%|███▉                       | 149/1014 [00:01<00:10, 81.46batch/s] 16%|████▏                      | 159/1014 [00:01<00:10, 81.43batch/s] 17%|████▌                      | 169/1014 [00:02<00:10, 81.70batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 81.29batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 80.08batch/s] 20%|█████▎                     | 199/1014 [00:02<00:10, 79.63batch/s] 21%|█████▌                     | 209/1014 [00:02<00:10, 79.14batch/s] 22%|█████▊                     | 219/1014 [00:02<00:10, 78.23batch/s] 23%|██████                     | 229/1014 [00:02<00:09, 78.63batch/s] 24%|██████▎                    | 239/1014 [00:03<00:09, 78.70batch/s] 25%|██████▋                    | 249/1014 [00:03<00:09, 78.49batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 78.42batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 78.30batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 78.45batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 78.73batch/s] 29%|███████▉                   | 299/1014 [00:03<00:09, 79.20batch/s] 30%|████████▏                  | 309/1014 [00:03<00:08, 78.91batch/s] 31%|████████▍                  | 319/1014 [00:04<00:08, 78.92batch/s] 32%|████████▊                  | 329/1014 [00:04<00:08, 78.83batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 78.71batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 78.86batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 78.99batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 79.00batch/s] 37%|██████████                 | 379/1014 [00:04<00:08, 78.86batch/s] 38%|██████████▎                | 389/1014 [00:04<00:07, 78.89batch/s] 39%|██████████▌                | 399/1014 [00:05<00:07, 79.02batch/s] 40%|██████████▉                | 409/1014 [00:05<00:07, 78.90batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 78.86batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 78.70batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 78.86batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 79.02batch/s] 45%|████████████▏              | 459/1014 [00:05<00:07, 78.79batch/s] 46%|████████████▍              | 469/1014 [00:06<00:06, 78.01batch/s] 47%|████████████▊              | 479/1014 [00:06<00:06, 78.12batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 78.04batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 78.07batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 78.03batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 78.08batch/s] 52%|██████████████             | 529/1014 [00:06<00:06, 78.00batch/s] 53%|██████████████▎            | 539/1014 [00:06<00:06, 77.94batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:05, 77.74batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:05, 77.66batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 77.34batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 77.39batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 77.38batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 77.26batch/s] 60%|████████████████▏          | 609/1014 [00:07<00:05, 77.42batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:05, 77.46batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:04, 77.37batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 76.78batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 76.85batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 76.92batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 77.04batch/s] 67%|██████████████████         | 679/1014 [00:08<00:04, 77.18batch/s] 68%|██████████████████▎        | 689/1014 [00:08<00:04, 77.21batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 77.09batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:03, 76.93batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 76.99batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 77.20batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 77.13batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 77.01batch/s] 75%|████████████████████▏      | 759/1014 [00:09<00:03, 77.22batch/s] 76%|████████████████████▍      | 769/1014 [00:09<00:03, 77.32batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 77.30batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:02, 77.34batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 77.48batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 77.43batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 77.36batch/s] 82%|██████████████████████     | 829/1014 [00:10<00:02, 77.23batch/s] 83%|██████████████████████▎    | 839/1014 [00:10<00:02, 77.26batch/s] 84%|██████████████████████▌    | 849/1014 [00:10<00:02, 77.31batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 77.01batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 76.94batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 77.08batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 77.07batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 77.07batch/s] 90%|████████████████████████▏  | 909/1014 [00:11<00:01, 77.12batch/s] 91%|████████████████████████▍  | 919/1014 [00:11<00:01, 77.21batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 77.30batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:00, 77.38batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 77.53batch/s] 95%|█████████████████████████▌ | 959/1014 [00:12<00:00, 77.47batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 77.35batch/s] 97%|██████████████████████████ | 979/1014 [00:12<00:00, 77.36batch/s] 98%|██████████████████████████▎| 989/1014 [00:12<00:00, 77.42batch/s] 99%|██████████████████████████▌| 999/1014 [00:12<00:00, 77.59batch/s]100%|█████████████████████████▊| 1009/1014 [00:12<00:00, 77.69batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 77.70batch/s]
Validation 4 -> LOSS = 2.00
Validation 4 -> BLEU = 31.27, 60.0/37.6/25.0/16.9 (BP=1.000, ratio=1.004, hyp_len=14444, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 2.00 @ validation 4
--> Best BLEU so far: 31.27 @ validation 4
Starting Epoch 5
Epoch 5 - update       1920 => loss:   2.596 (#OOM: 0)
Epoch 5 - update       1950 => loss:   2.021 (#OOM: 0)
Epoch 5 - update       1980 => loss:   1.921 (#OOM: 0)
Epoch 5 - update       2010 => loss:   2.072 (#OOM: 0)
Epoch 5 - update       2040 => loss:   1.959 (#OOM: 0)
Epoch 5 - update       2070 => loss:   2.089 (#OOM: 0)
Epoch 5 - update       2100 => loss:   1.808 (#OOM: 0)
Epoch 5 - update       2130 => loss:   2.213 (#OOM: 0)
Epoch 5 - update       2160 => loss:   2.186 (#OOM: 0)
Epoch 5 - update       2190 => loss:   1.852 (#OOM: 0)
Epoch 5 - update       2220 => loss:   1.818 (#OOM: 0)
Epoch 5 - update       2250 => loss:   1.742 (#OOM: 0)
Epoch 5 - update       2280 => loss:   2.458 (#OOM: 0)
Epoch 5 - update       2310 => loss:   1.988 (#OOM: 0)
Epoch 5 - update       2340 => loss:   1.753 (#OOM: 0)
Epoch 5 - update       2370 => loss:   3.055 (#OOM: 0)
--> Epoch 5 finished with mean loss 2.12539
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (859 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.74batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.04batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.10batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 53.27batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 53.85batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.54batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 87.93batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 88.28batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 88.08batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 87.82batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 85.30batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 84.21batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 81.82batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 81.83batch/s]  8%|██▏                         | 81/1014 [00:00<00:11, 81.42batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 80.64batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 80.59batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 80.09batch/s] 12%|███                        | 117/1014 [00:01<00:11, 80.50batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 81.16batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 81.09batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 81.68batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 81.91batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 81.41batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 81.62batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 82.11batch/s] 19%|█████▏                     | 197/1014 [00:02<00:09, 82.08batch/s] 20%|█████▌                     | 207/1014 [00:02<00:09, 81.80batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 81.73batch/s] 22%|██████                     | 227/1014 [00:02<00:09, 82.10batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 82.60batch/s] 24%|██████▌                    | 247/1014 [00:02<00:09, 82.68batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 82.49batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 82.56batch/s] 27%|███████▍                   | 277/1014 [00:03<00:08, 82.74batch/s] 28%|███████▋                   | 287/1014 [00:03<00:08, 82.71batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 82.61batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 82.68batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 81.25batch/s] 32%|████████▋                  | 327/1014 [00:04<00:08, 81.31batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 81.62batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 81.94batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 82.10batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:07, 82.36batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 82.35batch/s] 38%|██████████▎                | 387/1014 [00:04<00:07, 82.29batch/s] 39%|██████████▌                | 397/1014 [00:04<00:07, 82.31batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 82.21batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 82.21batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 82.20batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 82.20batch/s] 44%|███████████▉               | 447/1014 [00:05<00:06, 82.14batch/s] 45%|████████████▏              | 457/1014 [00:05<00:06, 82.04batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 82.03batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 81.71batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 81.91batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 81.77batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 81.66batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 81.62batch/s] 52%|██████████████             | 527/1014 [00:06<00:05, 81.52batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 81.49batch/s] 54%|██████████████▌            | 547/1014 [00:06<00:05, 81.53batch/s] 55%|██████████████▊            | 557/1014 [00:06<00:05, 80.86batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 80.75batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 80.80batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 80.78batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 80.73batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 80.66batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:04, 80.60batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 80.35batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 80.51batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 80.57batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 80.33batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 80.38batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 80.49batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:04, 80.67batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:03, 80.62batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 80.53batch/s] 71%|███████████████████        | 717/1014 [00:08<00:03, 80.55batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 80.60batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 80.54batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 80.53batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 80.44batch/s] 76%|████████████████████▍      | 767/1014 [00:09<00:03, 80.21batch/s] 77%|████████████████████▋      | 777/1014 [00:09<00:02, 80.18batch/s] 78%|████████████████████▉      | 787/1014 [00:09<00:02, 80.10batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 80.12batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 80.17batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 80.20batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 80.27batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 80.28batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 80.31batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 80.29batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 80.27batch/s] 86%|███████████████████████▎   | 877/1014 [00:10<00:01, 80.37batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 80.37batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 80.40batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 80.18batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 80.08batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 79.97batch/s] 92%|████████████████████████▉  | 937/1014 [00:11<00:00, 79.88batch/s] 93%|█████████████████████████▏ | 947/1014 [00:11<00:00, 79.86batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 79.85batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 79.70batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 79.66batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 79.47batch/s] 98%|██████████████████████████▌| 997/1014 [00:12<00:00, 79.59batch/s] 99%|█████████████████████████▊| 1007/1014 [00:12<00:00, 79.54batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.59batch/s]
Validation 5 -> LOSS = 1.85
Validation 5 -> BLEU = 34.40, 62.9/41.0/28.5/19.8 (BP=0.991, ratio=0.991, hyp_len=14259, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.85 @ validation 5
--> Best BLEU so far: 34.40 @ validation 5
Starting Epoch 6
Epoch 6 - update       2400 => loss:   2.343 (#OOM: 0)
Epoch 6 - update       2430 => loss:   2.201 (#OOM: 0)
Epoch 6 - update       2460 => loss:   2.065 (#OOM: 0)
Epoch 6 - update       2490 => loss:   1.930 (#OOM: 0)
Epoch 6 - update       2520 => loss:   2.055 (#OOM: 0)
Epoch 6 - update       2550 => loss:   1.867 (#OOM: 0)
Epoch 6 - update       2580 => loss:   1.866 (#OOM: 0)
Epoch 6 - update       2610 => loss:   2.003 (#OOM: 0)
Epoch 6 - update       2640 => loss:   1.970 (#OOM: 0)
Epoch 6 - update       2670 => loss:   1.500 (#OOM: 0)
Epoch 6 - update       2700 => loss:   3.133 (#OOM: 0)
Epoch 6 - update       2730 => loss:   1.880 (#OOM: 0)
Epoch 6 - update       2760 => loss:   2.375 (#OOM: 0)
Epoch 6 - update       2790 => loss:   2.153 (#OOM: 0)
Epoch 6 - update       2820 => loss:   2.068 (#OOM: 0)
Epoch 6 - update       2850 => loss:   1.773 (#OOM: 0)
--> Epoch 6 finished with mean loss 1.95455
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (789 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.52batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.61batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.99batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.93batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 53.13batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.15batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.76batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.71batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.32batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 75.29batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 76.90batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 76.53batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 77.30batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 77.20batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 73.30batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 72.96batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.18batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 74.76batch/s] 11%|███                        | 114/1014 [00:01<00:12, 74.55batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 74.67batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 75.06batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 75.71batch/s] 15%|████                       | 152/1014 [00:01<00:11, 76.15batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.83batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 75.98batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 76.18batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 76.14batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 75.31batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 75.88batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.66batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 76.18batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 76.55batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 76.01batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 76.53batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 77.19batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 77.38batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 77.75batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 77.89batch/s] 31%|████████▎                  | 312/1014 [00:03<00:08, 78.16batch/s] 32%|████████▌                  | 323/1014 [00:04<00:08, 78.66batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 78.72batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 78.90batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 78.71batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 78.77batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 79.08batch/s] 38%|██████████▎                | 389/1014 [00:04<00:07, 78.94batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 78.80batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 78.87batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 78.82batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 79.07batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 79.27batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 79.12batch/s] 46%|████████████▍              | 466/1014 [00:05<00:06, 79.14batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 79.55batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 79.67batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 79.63batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 79.52batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 79.25batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:06, 79.08batch/s] 54%|██████████████▍            | 543/1014 [00:06<00:06, 78.41batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:05, 78.33batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 78.45batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 78.39batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 78.44batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 78.50batch/s] 60%|████████████████▏          | 609/1014 [00:07<00:05, 78.58batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:05, 78.67batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:04, 78.52batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 78.52batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 78.50batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 78.68batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 78.69batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:04, 78.80batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:04, 78.79batch/s] 70%|██████████████████▊        | 708/1014 [00:08<00:03, 78.86batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 78.67batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 78.84batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 78.83batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 78.75batch/s] 75%|████████████████████▎      | 763/1014 [00:09<00:03, 78.89batch/s] 76%|████████████████████▌      | 774/1014 [00:09<00:03, 78.84batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 78.98batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 79.09batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 79.15batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 79.08batch/s] 82%|██████████████████████     | 829/1014 [00:10<00:02, 78.90batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 79.00batch/s] 84%|██████████████████████▋    | 851/1014 [00:10<00:02, 79.06batch/s] 85%|██████████████████████▉    | 862/1014 [00:10<00:01, 78.96batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 79.04batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 78.90batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 78.88batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 78.90batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 78.96batch/s] 92%|████████████████████████▋  | 928/1014 [00:11<00:01, 78.85batch/s] 93%|█████████████████████████  | 939/1014 [00:11<00:00, 78.76batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 78.62batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 78.65batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 78.54batch/s] 97%|██████████████████████████▏| 983/1014 [00:12<00:00, 78.39batch/s] 98%|██████████████████████████▍| 994/1014 [00:12<00:00, 78.44batch/s] 99%|█████████████████████████▊| 1005/1014 [00:12<00:00, 78.44batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 78.49batch/s]
Validation 6 -> LOSS = 1.74
Validation 6 -> BLEU = 36.67, 64.2/43.2/30.6/21.7 (BP=0.996, ratio=0.996, hyp_len=14321, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.74 @ validation 6
--> Best BLEU so far: 36.67 @ validation 6
Starting Epoch 7
Epoch 7 - update       2880 => loss:   2.128 (#OOM: 0)
Epoch 7 - update       2910 => loss:   1.770 (#OOM: 0)
Epoch 7 - update       2940 => loss:   1.806 (#OOM: 0)
Epoch 7 - update       2970 => loss:   1.993 (#OOM: 0)
Epoch 7 - update       3000 => loss:   2.176 (#OOM: 0)
Epoch 7 - update       3030 => loss:   1.778 (#OOM: 0)
Epoch 7 - update       3060 => loss:   1.558 (#OOM: 0)
Epoch 7 - update       3090 => loss:   1.345 (#OOM: 0)
Epoch 7 - update       3120 => loss:   1.584 (#OOM: 0)
Epoch 7 - update       3150 => loss:   2.037 (#OOM: 0)
Epoch 7 - update       3180 => loss:   1.751 (#OOM: 0)
Epoch 7 - update       3210 => loss:   1.701 (#OOM: 0)
Epoch 7 - update       3240 => loss:   2.001 (#OOM: 0)
Epoch 7 - update       3270 => loss:   1.687 (#OOM: 0)
Epoch 7 - update       3300 => loss:   1.336 (#OOM: 0)
Epoch 7 - update       3330 => loss:   1.703 (#OOM: 0)
--> Epoch 7 finished with mean loss 1.82361
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (792 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.80batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.94batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.34batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.30batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.06batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.04batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 69.45batch/s]  2%|▍                           | 17/1014 [00:00<00:13, 73.27batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 78.49batch/s]  4%|█                           | 37/1014 [00:00<00:12, 77.01batch/s]  5%|█▎                          | 47/1014 [00:00<00:12, 78.10batch/s]  6%|█▌                          | 57/1014 [00:00<00:12, 78.97batch/s]  7%|█▊                          | 67/1014 [00:00<00:12, 75.75batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 76.18batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 76.71batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 77.13batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 77.14batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.87batch/s] 13%|███▍                       | 127/1014 [00:01<00:11, 77.47batch/s] 14%|███▋                       | 137/1014 [00:01<00:11, 78.12batch/s] 14%|███▉                       | 147/1014 [00:01<00:11, 77.74batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 77.30batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 77.46batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 75.22batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 75.95batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 76.34batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 76.61batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 76.65batch/s] 22%|██████                     | 227/1014 [00:02<00:10, 76.87batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 77.10batch/s] 24%|██████▌                    | 247/1014 [00:03<00:09, 77.24batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 77.21batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 77.46batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 77.57batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 77.57batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 77.45batch/s] 30%|████████▏                  | 307/1014 [00:03<00:09, 77.71batch/s] 31%|████████▍                  | 317/1014 [00:04<00:08, 77.82batch/s] 32%|████████▋                  | 327/1014 [00:04<00:08, 77.93batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 78.32batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 78.32batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 78.49batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 78.85batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 79.21batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 79.63batch/s] 39%|██████████▌                | 399/1014 [00:04<00:07, 79.91batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 80.19batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 80.36batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 80.32batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 80.34batch/s] 45%|████████████               | 454/1014 [00:05<00:06, 80.25batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 80.21batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 80.28batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 80.09batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 80.24batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 80.12batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 80.27batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 80.15batch/s] 53%|██████████████▍            | 542/1014 [00:06<00:05, 80.23batch/s] 55%|██████████████▋            | 553/1014 [00:06<00:05, 80.14batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 80.18batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 80.20batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 80.19batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 80.32batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 80.39batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:04, 80.23batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 80.24batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 80.22batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 80.20batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 80.07batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 80.12batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 80.00batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:03, 80.05batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 80.03batch/s] 71%|███████████████████        | 718/1014 [00:08<00:03, 79.89batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 79.91batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 79.69batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 79.71batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 79.57batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:03, 79.71batch/s] 77%|████████████████████▉      | 784/1014 [00:09<00:02, 79.65batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 79.64batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 79.63batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 79.61batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 79.53batch/s] 83%|██████████████████████▎    | 839/1014 [00:10<00:02, 79.63batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 79.56batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 79.50batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 79.35batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 79.31batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 79.30batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 79.30batch/s] 90%|████████████████████████▍  | 916/1014 [00:11<00:01, 79.30batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 79.49batch/s] 93%|████████████████████████▉  | 938/1014 [00:11<00:00, 79.63batch/s] 94%|█████████████████████████▎ | 949/1014 [00:11<00:00, 79.70batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 79.61batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 79.71batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 79.69batch/s] 98%|██████████████████████████▍| 993/1014 [00:12<00:00, 79.68batch/s] 99%|█████████████████████████▋| 1004/1014 [00:12<00:00, 79.66batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.52batch/s]
Validation 7 -> LOSS = 1.67
Validation 7 -> BLEU = 37.85, 66.4/45.1/32.6/23.5 (BP=0.973, ratio=0.973, hyp_len=13998, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.67 @ validation 7
--> Best BLEU so far: 37.85 @ validation 7
Starting Epoch 8
Epoch 8 - update       3360 => loss:   1.941 (#OOM: 0)
Epoch 8 - update       3390 => loss:   1.687 (#OOM: 0)
Epoch 8 - update       3420 => loss:   2.636 (#OOM: 0)
Epoch 8 - update       3450 => loss:   1.712 (#OOM: 0)
Epoch 8 - update       3480 => loss:   1.231 (#OOM: 0)
Epoch 8 - update       3510 => loss:   1.558 (#OOM: 0)
Epoch 8 - update       3540 => loss:   1.351 (#OOM: 0)
Epoch 8 - update       3570 => loss:   1.586 (#OOM: 0)
Epoch 8 - update       3600 => loss:   1.373 (#OOM: 0)
Epoch 8 - update       3630 => loss:   1.852 (#OOM: 0)
Epoch 8 - update       3660 => loss:   1.713 (#OOM: 0)
Epoch 8 - update       3690 => loss:   2.000 (#OOM: 0)
Epoch 8 - update       3720 => loss:   1.621 (#OOM: 0)
Epoch 8 - update       3750 => loss:   1.228 (#OOM: 0)
Epoch 8 - update       3780 => loss:   2.046 (#OOM: 0)
Epoch 8 - update       3810 => loss:   1.568 (#OOM: 0)
--> Epoch 8 finished with mean loss 1.71477
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.56 mins)   (916 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.56batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.91batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.88batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.25batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.46batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.19batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.91batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 78.58batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 80.37batch/s]  3%|▉                           | 35/1014 [00:00<00:11, 83.34batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 84.10batch/s]  5%|█▌                          | 55/1014 [00:00<00:11, 82.78batch/s]  6%|█▊                          | 65/1014 [00:00<00:11, 82.06batch/s]  7%|██                          | 75/1014 [00:00<00:11, 80.08batch/s]  8%|██▎                         | 85/1014 [00:01<00:11, 80.78batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 80.47batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 80.74batch/s] 11%|███                        | 115/1014 [00:01<00:11, 80.48batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 80.40batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 79.54batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 78.76batch/s] 15%|████▏                      | 155/1014 [00:01<00:10, 78.62batch/s] 16%|████▍                      | 165/1014 [00:02<00:10, 78.56batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 78.65batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 79.53batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 79.90batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 79.94batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 79.86batch/s] 22%|█████▉                     | 225/1014 [00:02<00:09, 80.14batch/s] 23%|██████▎                    | 235/1014 [00:02<00:09, 79.88batch/s] 24%|██████▌                    | 245/1014 [00:03<00:09, 79.97batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 80.29batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 80.38batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 80.30batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 80.26batch/s] 29%|███████▊                   | 295/1014 [00:03<00:08, 80.39batch/s] 30%|████████                   | 305/1014 [00:03<00:08, 79.55batch/s] 31%|████████▍                  | 315/1014 [00:03<00:08, 79.74batch/s] 32%|████████▋                  | 325/1014 [00:04<00:08, 79.34batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 79.24batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 79.17batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 79.00batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 79.05batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 78.97batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 78.79batch/s] 39%|██████████▌                | 395/1014 [00:04<00:07, 79.03batch/s] 40%|██████████▊                | 405/1014 [00:05<00:07, 78.12batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 78.40batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 78.36batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 78.57batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 78.28batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 77.33batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 77.37batch/s] 47%|████████████▋              | 475/1014 [00:06<00:06, 77.21batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 77.09batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 77.22batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 77.27batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 77.33batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 77.48batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:06, 77.41batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 77.43batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:05, 77.24batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 77.03batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 77.01batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 76.87batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 76.68batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 76.58batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 76.61batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 76.53batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 75.90batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.89batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.81batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.93batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 76.02batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.87batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.86batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.78batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.80batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.86batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.77batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.72batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 75.69batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.52batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.42batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.05batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.09batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.08batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.08batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.08batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.18batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.12batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.06batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.10batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.07batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.00batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.03batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 75.05batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.10batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.11batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.14batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.16batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.02batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.64batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.68batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.73batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.70batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.78batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.83batch/s]
Validation 8 -> LOSS = 1.59
Validation 8 -> BLEU = 38.75, 64.6/44.9/32.6/23.8 (BP=1.000, ratio=1.051, hyp_len=15111, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.59 @ validation 8
--> Best BLEU so far: 38.75 @ validation 8
Starting Epoch 9
Epoch 9 - update       3840 => loss:   1.666 (#OOM: 0)
Epoch 9 - update       3870 => loss:   1.594 (#OOM: 0)
Epoch 9 - update       3900 => loss:   1.819 (#OOM: 0)
Epoch 9 - update       3930 => loss:   2.533 (#OOM: 0)
Epoch 9 - update       3960 => loss:   1.202 (#OOM: 0)
Epoch 9 - update       3990 => loss:   2.066 (#OOM: 0)
Epoch 9 - update       4020 => loss:   1.358 (#OOM: 0)
Epoch 9 - update       4050 => loss:   1.898 (#OOM: 0)
Epoch 9 - update       4080 => loss:   1.281 (#OOM: 0)
Epoch 9 - update       4110 => loss:   1.283 (#OOM: 0)
Epoch 9 - update       4140 => loss:   1.500 (#OOM: 0)
Epoch 9 - update       4170 => loss:   1.612 (#OOM: 0)
Epoch 9 - update       4200 => loss:   1.847 (#OOM: 0)
Epoch 9 - update       4230 => loss:   1.130 (#OOM: 0)
Epoch 9 - update       4260 => loss:   1.453 (#OOM: 0)
Epoch 9 - update       4290 => loss:   1.662 (#OOM: 0)
--> Epoch 9 finished with mean loss 1.61975
--> Overhead/Training/Evaluation: 0.02/0.42/0.00 mins (total: 0.44 mins)   (1145 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.59batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 58.19batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 57.00batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 55.48batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 54.69batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.50batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 83.83batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 85.59batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 83.79batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.72batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 82.68batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 82.72batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 82.43batch/s]  7%|██                          | 73/1014 [00:00<00:11, 83.44batch/s]  8%|██▎                         | 83/1014 [00:01<00:11, 82.60batch/s]  9%|██▌                         | 93/1014 [00:01<00:11, 81.56batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 81.29batch/s] 11%|███                        | 113/1014 [00:01<00:11, 80.84batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 77.47batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 76.48batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 76.80batch/s] 15%|████                       | 153/1014 [00:01<00:11, 76.55batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 76.62batch/s] 17%|████▌                      | 173/1014 [00:02<00:10, 77.06batch/s] 18%|████▊                      | 183/1014 [00:02<00:10, 77.28batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 76.70batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 77.02batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 76.67batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 76.54batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 76.42batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 76.63batch/s] 25%|██████▋                    | 253/1014 [00:03<00:09, 76.38batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 76.56batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 76.50batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 76.61batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 76.55batch/s] 30%|████████                   | 303/1014 [00:03<00:09, 76.67batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 76.72batch/s] 32%|████████▌                  | 323/1014 [00:04<00:08, 76.83batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 76.99batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 77.23batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 77.51batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 77.52batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 77.63batch/s] 38%|██████████▏                | 383/1014 [00:04<00:08, 77.43batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 77.46batch/s] 40%|██████████▋                | 403/1014 [00:05<00:07, 77.45batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 77.49batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 77.38batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 77.21batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 77.18batch/s] 45%|████████████               | 453/1014 [00:05<00:07, 77.40batch/s] 46%|████████████▎              | 463/1014 [00:05<00:07, 77.72batch/s] 47%|████████████▌              | 473/1014 [00:06<00:06, 77.85batch/s] 48%|████████████▊              | 483/1014 [00:06<00:06, 77.82batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 77.96batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 77.41batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 77.45batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 77.57batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:06, 77.60batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 77.41batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:05, 77.41batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 77.27batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 77.20batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 77.21batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 77.13batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 77.15batch/s] 60%|████████████████▎          | 613/1014 [00:07<00:05, 77.32batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 77.45batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:04, 77.62batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 77.54batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 77.55batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 77.54batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 77.42batch/s] 67%|██████████████████▏        | 683/1014 [00:08<00:04, 77.48batch/s] 68%|██████████████████▍        | 693/1014 [00:08<00:04, 77.63batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 77.72batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 77.65batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 77.76batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 77.73batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 77.77batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 77.69batch/s] 75%|████████████████████▎      | 763/1014 [00:09<00:03, 77.87batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:03, 77.88batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:02, 78.01batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 78.06batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 78.08batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 78.15batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 78.14batch/s] 82%|██████████████████████▏    | 833/1014 [00:10<00:02, 78.23batch/s] 83%|██████████████████████▍    | 843/1014 [00:10<00:02, 78.31batch/s] 84%|██████████████████████▋    | 853/1014 [00:10<00:02, 78.36batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:01, 78.38batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 78.43batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 78.52batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 78.58batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 78.48batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 78.50batch/s] 91%|████████████████████████▌  | 923/1014 [00:11<00:01, 78.51batch/s] 92%|████████████████████████▊  | 933/1014 [00:11<00:01, 78.47batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 78.32batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 78.33batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 78.41batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 78.36batch/s] 97%|██████████████████████████▏| 983/1014 [00:12<00:00, 78.35batch/s] 98%|██████████████████████████▍| 993/1014 [00:12<00:00, 78.48batch/s] 99%|█████████████████████████▋| 1003/1014 [00:12<00:00, 78.49batch/s]100%|█████████████████████████▉| 1013/1014 [00:12<00:00, 78.61batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 78.61batch/s]
Validation 9 -> LOSS = 1.55
Validation 9 -> BLEU = 41.47, 68.0/47.8/35.3/26.0 (BP=0.998, ratio=0.998, hyp_len=14357, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.55 @ validation 9
--> Best BLEU so far: 41.47 @ validation 9
Starting Epoch 10
Epoch 10 - update       4320 => loss:   1.747 (#OOM: 0)
Epoch 10 - update       4350 => loss:   1.523 (#OOM: 0)
Epoch 10 - update       4380 => loss:   1.466 (#OOM: 0)
Epoch 10 - update       4410 => loss:   1.468 (#OOM: 0)
Epoch 10 - update       4440 => loss:   1.717 (#OOM: 0)
Epoch 10 - update       4470 => loss:   1.455 (#OOM: 0)
Epoch 10 - update       4500 => loss:   1.563 (#OOM: 0)
Epoch 10 - update       4530 => loss:   1.637 (#OOM: 0)
Epoch 10 - update       4560 => loss:   1.655 (#OOM: 0)
Epoch 10 - update       4590 => loss:   1.526 (#OOM: 0)
Epoch 10 - update       4620 => loss:   1.521 (#OOM: 0)
Epoch 10 - update       4650 => loss:   1.363 (#OOM: 0)
Epoch 10 - update       4680 => loss:   1.495 (#OOM: 0)
Epoch 10 - update       4710 => loss:   1.307 (#OOM: 0)
Epoch 10 - update       4740 => loss:   1.428 (#OOM: 0)
Epoch 10 - update       4770 => loss:   1.369 (#OOM: 0)
--> Epoch 10 finished with mean loss 1.54705
--> Overhead/Training/Evaluation: 0.02/0.43/0.00 mins (total: 0.45 mins)   (1117 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.24batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.04batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 56.66batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 54.40batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 54.38batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.31batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 77.65batch/s]  2%|▍                           | 18/1014 [00:00<00:16, 62.10batch/s]  3%|▋                           | 27/1014 [00:00<00:14, 66.78batch/s]  4%|▉                           | 36/1014 [00:00<00:14, 67.02batch/s]  4%|█▏                          | 45/1014 [00:00<00:14, 68.78batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 69.79batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 71.05batch/s]  7%|█▉                          | 72/1014 [00:00<00:13, 72.34batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 72.74batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.37batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.54batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.44batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.01batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.35batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.47batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.89batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.97batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.34batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.58batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 75.61batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.48batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.75batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 76.47batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 75.86batch/s] 22%|██████                     | 228/1014 [00:02<00:10, 76.14batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 76.11batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 75.97batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 76.01batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.71batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.32batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 76.39batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 76.59batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 76.46batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 76.61batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 76.74batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 76.77batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 77.02batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 77.25batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 77.15batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 77.28batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 77.45batch/s] 39%|██████████▌                | 398/1014 [00:05<00:07, 77.65batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 77.69batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 77.58batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 77.30batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 77.19batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 77.12batch/s] 45%|████████████▏              | 458/1014 [00:05<00:07, 77.23batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 77.01batch/s] 47%|████████████▋              | 478/1014 [00:06<00:06, 77.01batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 77.02batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 77.18batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 77.08batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 77.14batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 77.10batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:06, 77.08batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 77.22batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 77.19batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 77.25batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 77.28batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 77.36batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 77.39batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 77.48batch/s] 61%|████████████████▍          | 618/1014 [00:07<00:05, 77.56batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:04, 77.67batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 77.53batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 77.69batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 77.77batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 78.04batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 78.05batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:04, 78.11batch/s] 69%|██████████████████▋        | 702/1014 [00:08<00:03, 78.20batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 78.21batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 78.21batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 78.23batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 78.05batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 78.07batch/s] 76%|████████████████████▍      | 768/1014 [00:09<00:03, 77.98batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 77.84batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 77.85batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 77.85batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 77.93batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 78.01batch/s] 82%|██████████████████████▏    | 834/1014 [00:10<00:02, 77.95batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 78.06batch/s] 84%|██████████████████████▊    | 856/1014 [00:10<00:02, 78.10batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 78.04batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 78.06batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 78.05batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 78.01batch/s] 90%|████████████████████████▎  | 911/1014 [00:11<00:01, 78.06batch/s] 91%|████████████████████████▌  | 922/1014 [00:11<00:01, 78.11batch/s] 92%|████████████████████████▊  | 933/1014 [00:11<00:01, 78.12batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 78.14batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 78.21batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 78.24batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 78.30batch/s] 97%|██████████████████████████▎| 988/1014 [00:12<00:00, 78.26batch/s] 99%|██████████████████████████▌| 999/1014 [00:12<00:00, 78.14batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 78.14batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 78.16batch/s]
Validation 10 -> LOSS = 1.51
Validation 10 -> BLEU = 42.37, 68.6/48.7/36.2/26.9 (BP=0.998, ratio=0.998, hyp_len=14352, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.51 @ validation 10
--> Best BLEU so far: 42.37 @ validation 10
Starting Epoch 11
Epoch 11 - update       4800 => loss:   1.377 (#OOM: 0)
Epoch 11 - update       4830 => loss:   1.134 (#OOM: 0)
Epoch 11 - update       4860 => loss:   1.377 (#OOM: 0)
Epoch 11 - update       4890 => loss:   1.353 (#OOM: 0)
Epoch 11 - update       4920 => loss:   1.667 (#OOM: 0)
Epoch 11 - update       4950 => loss:   1.129 (#OOM: 0)
Epoch 11 - update       4980 => loss:   1.525 (#OOM: 0)
Epoch 11 - update       5010 => loss:   1.462 (#OOM: 0)
Epoch 11 - update       5040 => loss:   1.338 (#OOM: 0)
Epoch 11 - update       5070 => loss:   1.416 (#OOM: 0)
Epoch 11 - update       5100 => loss:   1.695 (#OOM: 0)
Epoch 11 - update       5130 => loss:   2.034 (#OOM: 0)
Epoch 11 - update       5160 => loss:   1.416 (#OOM: 0)
Epoch 11 - update       5190 => loss:   1.285 (#OOM: 0)
Epoch 11 - update       5220 => loss:   1.460 (#OOM: 0)
--> Epoch 11 finished with mean loss 1.48077
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (777 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.41batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.65batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.26batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.75batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.40batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.64batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.82batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.66batch/s]  2%|▋                           | 25/1014 [00:00<00:13, 75.85batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 73.83batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 72.76batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.62batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 73.52batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 71.89batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 72.27batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 72.66batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 72.91batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 74.42batch/s] 12%|███                        | 117/1014 [00:01<00:12, 73.89batch/s] 13%|███▍                       | 127/1014 [00:01<00:12, 73.54batch/s] 14%|███▋                       | 137/1014 [00:01<00:11, 73.44batch/s] 14%|███▉                       | 147/1014 [00:01<00:11, 73.74batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 73.97batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 74.55batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 74.78batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 75.51batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.38batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.23batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 74.97batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 74.40batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 74.39batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 74.63batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.18batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.23batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.79batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.85batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.87batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 75.65batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.97batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 75.72batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 75.62batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 75.78batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 76.01batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 76.37batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 76.38batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 76.37batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 76.15batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 76.20batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 76.50batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 76.44batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 76.31batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 76.38batch/s] 45%|████████████▏              | 457/1014 [00:05<00:07, 76.42batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 76.41batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 76.52batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 76.73batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 76.91batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 76.88batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 76.90batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 76.72batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:06, 76.77batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 77.01batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:05, 77.12batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 77.08batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 77.25batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 77.29batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 77.31batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 77.35batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:05, 77.37batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 76.82batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 76.75batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 76.74batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 76.84batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 76.84batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 76.73batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:04, 76.82batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 76.80batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 76.55batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 76.56batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 76.54batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 76.65batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 76.68batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 76.78batch/s] 76%|████████████████████▍      | 767/1014 [00:09<00:03, 76.80batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 76.59batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 76.54batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 76.58batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 76.50batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 76.42batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 76.51batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 76.60batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 76.42batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 76.30batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.91batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.92batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.99batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 76.10batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 76.13batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 76.22batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 76.17batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 76.12batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 76.03batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 76.04batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 76.00batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 76.01batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 75.97batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.98batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.96batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.93batch/s]
Validation 11 -> LOSS = 1.48
Validation 11 -> BLEU = 43.44, 69.5/49.9/37.6/28.2 (BP=0.992, ratio=0.992, hyp_len=14270, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.48 @ validation 11
--> Best BLEU so far: 43.44 @ validation 11
Starting Epoch 12
Epoch 12 - update       5250 => loss:   1.327 (#OOM: 0)
Epoch 12 - update       5280 => loss:   1.193 (#OOM: 0)
Epoch 12 - update       5310 => loss:   1.482 (#OOM: 0)
Epoch 12 - update       5340 => loss:   1.288 (#OOM: 0)
Epoch 12 - update       5370 => loss:   1.415 (#OOM: 0)
Epoch 12 - update       5400 => loss:   1.488 (#OOM: 0)
Epoch 12 - update       5430 => loss:   1.357 (#OOM: 0)
Epoch 12 - update       5460 => loss:   1.879 (#OOM: 0)
Epoch 12 - update       5490 => loss:   1.277 (#OOM: 0)
Epoch 12 - update       5520 => loss:   1.941 (#OOM: 0)
Epoch 12 - update       5550 => loss:   1.253 (#OOM: 0)
Epoch 12 - update       5580 => loss:   1.174 (#OOM: 0)
Epoch 12 - update       5610 => loss:   1.357 (#OOM: 0)
Epoch 12 - update       5640 => loss:   1.507 (#OOM: 0)
Epoch 12 - update       5670 => loss:   1.923 (#OOM: 0)
Epoch 12 - update       5700 => loss:   1.383 (#OOM: 0)
--> Epoch 12 finished with mean loss 1.42351
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.68 mins)   (764 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.18batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.01batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.46batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.84batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 52.57batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.76batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.48batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.61batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.03batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 77.73batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 78.01batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 79.54batch/s]  6%|█▋                          | 61/1014 [00:00<00:11, 80.44batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 81.19batch/s]  8%|██▏                         | 79/1014 [00:00<00:11, 80.31batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 79.25batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 78.26batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 77.84batch/s] 11%|███                        | 115/1014 [00:01<00:11, 76.73batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 76.95batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 76.96batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 77.64batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.91batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.30batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 76.51batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 76.56batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.72batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.74batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.42batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 76.51batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 76.65batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 76.45batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 76.16batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 76.53batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 75.76batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.63batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.67batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.20batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.21batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.46batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 75.52batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.61batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 75.54batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.41batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 75.32batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.47batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.64batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.70batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.76batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.60batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.48batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.86batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.82batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.71batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.66batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 75.47batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 75.56batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.45batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 75.49batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.40batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.31batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.44batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.54batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.76batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.91batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.97batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 76.11batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 76.12batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 76.21batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 76.30batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 76.31batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 76.34batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 76.59batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:04, 76.54batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 76.47batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 76.45batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 76.51batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 76.27batch/s] 67%|██████████████████▏        | 683/1014 [00:08<00:04, 76.03batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.93batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.90batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 76.05batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.90batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 76.02batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.91batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 75.97batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 76.07batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 76.09batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.99batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 76.04batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 76.04batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.99batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.95batch/s] 82%|██████████████████████▏    | 833/1014 [00:10<00:02, 75.85batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.91batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.87batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 75.45batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.34batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.38batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.40batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 75.24batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.27batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.16batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.12batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.00batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.04batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.12batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.10batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.10batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.18batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.22batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.32batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.31batch/s]
Validation 12 -> LOSS = 1.46
Validation 12 -> BLEU = 43.49, 69.2/49.8/37.3/27.8 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.46 @ validation 12
--> Best BLEU so far: 43.49 @ validation 12
Starting Epoch 13
Epoch 13 - update       5730 => loss:   1.076 (#OOM: 0)
Epoch 13 - update       5760 => loss:   0.988 (#OOM: 0)
Epoch 13 - update       5790 => loss:   1.487 (#OOM: 0)
Epoch 13 - update       5820 => loss:   1.538 (#OOM: 0)
Epoch 13 - update       5850 => loss:   1.230 (#OOM: 0)
Epoch 13 - update       5880 => loss:   1.320 (#OOM: 0)
Epoch 13 - update       5910 => loss:   1.292 (#OOM: 0)
Epoch 13 - update       5940 => loss:   1.295 (#OOM: 0)
Epoch 13 - update       5970 => loss:   1.280 (#OOM: 0)
Epoch 13 - update       6000 => loss:   1.150 (#OOM: 0)
Epoch 13 - update       6030 => loss:   1.143 (#OOM: 0)
Epoch 13 - update       6060 => loss:   1.361 (#OOM: 0)
Epoch 13 - update       6090 => loss:   1.467 (#OOM: 0)
Epoch 13 - update       6120 => loss:   1.208 (#OOM: 0)
Epoch 13 - update       6150 => loss:   1.537 (#OOM: 0)
Epoch 13 - update       6180 => loss:   1.554 (#OOM: 0)
--> Epoch 13 finished with mean loss 1.37041
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (878 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 39.85batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 43.09batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 50.51batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 49.33batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 49.51batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.45batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 6/1014 [00:00<00:18, 55.09batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 70.50batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 69.27batch/s]  3%|▉                           | 33/1014 [00:00<00:14, 67.43batch/s]  4%|█▏                          | 42/1014 [00:00<00:14, 68.87batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 70.34batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 71.15batch/s]  7%|█▉                          | 69/1014 [00:00<00:13, 71.50batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 72.11batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 72.63batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 73.77batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 73.82batch/s] 11%|███                        | 114/1014 [00:01<00:12, 73.97batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 74.24batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 74.74batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 74.11batch/s] 15%|███▉                       | 150/1014 [00:02<00:11, 74.51batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 74.04batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 74.66batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 75.00batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.97batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 75.02batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 75.34batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 75.54batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.41batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 75.34batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 75.15batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 74.79batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 74.43batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 74.18batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 73.34batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 73.17batch/s] 29%|███████▊                   | 294/1014 [00:04<00:09, 73.47batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 73.34batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 73.57batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 73.54batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 73.68batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 73.70batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:09, 73.89batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 73.06batch/s] 36%|█████████▋                 | 366/1014 [00:05<00:08, 73.02batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 73.21batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 73.24batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 73.35batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 73.54batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 73.55batch/s] 41%|███████████▏               | 420/1014 [00:05<00:08, 73.66batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 73.63batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 73.80batch/s] 44%|███████████▉               | 447/1014 [00:06<00:07, 73.67batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 73.84batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 73.77batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 73.80batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.02batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 74.05batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 73.90batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 73.93batch/s] 51%|█████████████▊             | 519/1014 [00:07<00:06, 73.84batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 73.74batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 73.78batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 73.83batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 74.08batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 74.19batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.25batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 74.38batch/s] 59%|███████████████▊           | 596/1014 [00:08<00:05, 74.31batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.20batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.28batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 74.12batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.28batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.25batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 74.11batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.09batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 74.07batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 73.97batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 74.11batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 74.16batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 74.15batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 74.23batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.28batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 74.21batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.26batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.19batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.39batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.39batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.21batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.07batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 74.01batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 73.89batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.03batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.03batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.11batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.22batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.16batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 74.12batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 74.12batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.20batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.30batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 74.21batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 74.29batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 74.24batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 74.31batch/s] 95%|█████████████████████████▋ | 966/1014 [00:13<00:00, 74.27batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.25batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.26batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.32batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.40batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.40batch/s]
Validation 13 -> LOSS = 1.43
Validation 13 -> BLEU = 44.24, 69.2/50.1/38.2/28.9 (BP=1.000, ratio=1.011, hyp_len=14536, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.43 @ validation 13
--> Best BLEU so far: 44.24 @ validation 13
Starting Epoch 14
Epoch 14 - update       6210 => loss:   1.646 (#OOM: 0)
Epoch 14 - update       6240 => loss:   1.347 (#OOM: 0)
Epoch 14 - update       6270 => loss:   1.010 (#OOM: 0)
Epoch 14 - update       6300 => loss:   1.392 (#OOM: 0)
Epoch 14 - update       6330 => loss:   1.170 (#OOM: 0)
Epoch 14 - update       6360 => loss:   1.154 (#OOM: 0)
Epoch 14 - update       6390 => loss:   1.213 (#OOM: 0)
Epoch 14 - update       6420 => loss:   0.822 (#OOM: 0)
Epoch 14 - update       6450 => loss:   1.725 (#OOM: 0)
Epoch 14 - update       6480 => loss:   1.172 (#OOM: 0)
Epoch 14 - update       6510 => loss:   1.401 (#OOM: 0)
Epoch 14 - update       6540 => loss:   1.345 (#OOM: 0)
Epoch 14 - update       6570 => loss:   1.497 (#OOM: 0)
Epoch 14 - update       6600 => loss:   1.155 (#OOM: 0)
Epoch 14 - update       6630 => loss:   1.360 (#OOM: 0)
Epoch 14 - update       6660 => loss:   1.441 (#OOM: 0)
--> Epoch 14 finished with mean loss 1.32629
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.56 mins)   (909 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.41batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.20batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.45batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.30batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.04batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.30batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.97batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 77.35batch/s]  2%|▋                           | 24/1014 [00:00<00:12, 76.34batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.69batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 76.65batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 77.26batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 73.99batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 73.33batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 73.72batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 72.88batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 73.33batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 73.62batch/s] 11%|███                        | 113/1014 [00:01<00:12, 72.74batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 72.38batch/s] 13%|███▍                       | 131/1014 [00:01<00:12, 72.87batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 73.44batch/s] 15%|███▉                       | 149/1014 [00:02<00:11, 73.64batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 73.94batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 74.20batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 74.31batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 74.02batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 74.62batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.24batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 74.52batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 74.23batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 74.45batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 74.69batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 74.33batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 75.07batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.19batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.37batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.36batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 75.32batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 75.40batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 75.87batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 75.41batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 75.55batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 75.44batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.56batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.76batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 75.85batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.88batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 75.98batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 76.12batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 76.47batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 76.38batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.57batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.59batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 75.54batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.70batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 75.79batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 75.82batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 75.87batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 75.13batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 75.19batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 75.21batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.09batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 75.01batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.08batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 74.92batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 74.76batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 74.72batch/s] 59%|███████████████▉           | 598/1014 [00:08<00:05, 74.68batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 74.72batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 74.71batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 74.74batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 74.74batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 74.94batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 75.10batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 75.09batch/s] 67%|██████████████████         | 678/1014 [00:09<00:04, 75.08batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 75.07batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 75.00batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 74.98batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 74.92batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 75.05batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 74.91batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 74.97batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 74.89batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 74.80batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 74.87batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 74.80batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 74.74batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 74.66batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 74.73batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 74.83batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 74.87batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 74.74batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 74.70batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 74.63batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 74.51batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 74.60batch/s] 89%|███████████████████████▉   | 898/1014 [00:12<00:01, 74.53batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 74.40batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 74.45batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 74.56batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 74.55batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 74.48batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 74.51batch/s] 95%|█████████████████████████▊ | 968/1014 [00:13<00:00, 74.45batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 74.53batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 74.56batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 74.56batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 74.58batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.60batch/s]
Validation 14 -> LOSS = 1.42
Validation 14 -> BLEU = 45.20, 70.2/51.3/39.1/29.8 (BP=0.998, ratio=0.998, hyp_len=14356, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.42 @ validation 14
--> Best BLEU so far: 45.20 @ validation 14
Starting Epoch 15
Epoch 15 - update       6690 => loss:   1.310 (#OOM: 0)
Epoch 15 - update       6720 => loss:   1.682 (#OOM: 0)
Epoch 15 - update       6750 => loss:   0.994 (#OOM: 0)
Epoch 15 - update       6780 => loss:   1.236 (#OOM: 0)
Epoch 15 - update       6810 => loss:   1.467 (#OOM: 0)
Epoch 15 - update       6840 => loss:   1.220 (#OOM: 0)
Epoch 15 - update       6870 => loss:   1.377 (#OOM: 0)
Epoch 15 - update       6900 => loss:   1.119 (#OOM: 0)
Epoch 15 - update       6930 => loss:   1.183 (#OOM: 0)
Epoch 15 - update       6960 => loss:   1.046 (#OOM: 0)
Epoch 15 - update       6990 => loss:   1.295 (#OOM: 0)
Epoch 15 - update       7020 => loss:   1.279 (#OOM: 0)
Epoch 15 - update       7050 => loss:   1.290 (#OOM: 0)
Epoch 15 - update       7080 => loss:   1.490 (#OOM: 0)
Epoch 15 - update       7110 => loss:   1.278 (#OOM: 0)
Epoch 15 - update       7140 => loss:   1.134 (#OOM: 0)
--> Epoch 15 finished with mean loss 1.28544
--> Overhead/Training/Evaluation: 0.03/0.50/0.00 mins (total: 0.53 mins)   (959 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.58batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.38batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 55.14batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.07batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.27batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.42batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 6/1014 [00:00<00:17, 57.39batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 71.26batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 73.30batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 75.05batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.93batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 75.56batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 71.62batch/s]  7%|█▉                          | 69/1014 [00:00<00:13, 70.38batch/s]  8%|██▏                         | 78/1014 [00:01<00:13, 69.77batch/s]  9%|██▍                         | 87/1014 [00:01<00:13, 69.89batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 71.20batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 71.47batch/s] 11%|███                        | 114/1014 [00:01<00:12, 70.75batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 70.83batch/s] 13%|███▌                       | 132/1014 [00:01<00:12, 71.38batch/s] 14%|███▊                       | 141/1014 [00:01<00:12, 71.73batch/s] 15%|███▉                       | 150/1014 [00:02<00:12, 71.60batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 71.66batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 71.99batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 72.67batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 72.95batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 72.99batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 72.75batch/s] 21%|█████▋                     | 213/1014 [00:02<00:11, 72.81batch/s] 22%|█████▉                     | 222/1014 [00:03<00:10, 73.34batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 73.72batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 73.74batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 73.66batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 74.10batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 73.97batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 73.62batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 73.05batch/s] 29%|███████▊                   | 294/1014 [00:04<00:09, 73.20batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 73.25batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 73.59batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 73.54batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 73.30batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 73.26batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:09, 72.88batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 73.01batch/s] 36%|█████████▋                 | 366/1014 [00:05<00:08, 73.16batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 73.05batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 72.91batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 72.99batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 72.68batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 72.82batch/s] 42%|███████████▏               | 421/1014 [00:05<00:08, 73.10batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 73.21batch/s] 43%|███████████▋               | 441/1014 [00:06<00:07, 72.96batch/s] 44%|████████████               | 451/1014 [00:06<00:07, 73.18batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 73.05batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 73.09batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 73.08batch/s] 48%|█████████████              | 491/1014 [00:06<00:07, 73.16batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 73.34batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 73.42batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 73.69batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 73.76batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 73.92batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 74.01batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:06, 74.04batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:06, 73.76batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 73.73batch/s] 58%|███████████████▋           | 591/1014 [00:08<00:05, 73.76batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 73.83batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 73.92batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 74.09batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 74.02batch/s] 63%|█████████████████          | 641/1014 [00:08<00:05, 73.96batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 74.13batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 74.07batch/s] 66%|█████████████████▊         | 671/1014 [00:09<00:04, 74.21batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 74.27batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 74.06batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 74.23batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 74.27batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 74.22batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 74.18batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 74.22batch/s] 74%|███████████████████▉       | 751/1014 [00:10<00:03, 74.17batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 74.17batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 73.97batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 74.04batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:03, 74.03batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.04batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 74.01batch/s] 81%|█████████████████████▊     | 821/1014 [00:11<00:02, 74.12batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 74.10batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 74.02batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 74.03batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 74.10batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 74.21batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 74.17batch/s] 88%|███████████████████████▋   | 891/1014 [00:12<00:01, 74.19batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 74.15batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 74.17batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 74.28batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 74.32batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 74.19batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 74.33batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 74.30batch/s] 96%|█████████████████████████▊ | 971/1014 [00:13<00:00, 74.33batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 74.42batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 74.36batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 74.38batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 74.42batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.43batch/s]
Validation 15 -> LOSS = 1.41
Validation 15 -> BLEU = 44.87, 69.8/51.0/38.8/29.4 (BP=1.000, ratio=1.008, hyp_len=14490, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.41 @ validation 15
--> Best BLEU so far: 45.20 @ validation 14
Starting Epoch 16
Epoch 16 - update       7170 => loss:   1.241 (#OOM: 0)
Epoch 16 - update       7200 => loss:   1.073 (#OOM: 0)
Epoch 16 - update       7230 => loss:   1.169 (#OOM: 0)
Epoch 16 - update       7260 => loss:   1.216 (#OOM: 0)
Epoch 16 - update       7290 => loss:   1.252 (#OOM: 0)
Epoch 16 - update       7320 => loss:   1.537 (#OOM: 0)
Epoch 16 - update       7350 => loss:   0.953 (#OOM: 0)
Epoch 16 - update       7380 => loss:   1.065 (#OOM: 0)
Epoch 16 - update       7410 => loss:   1.254 (#OOM: 0)
Epoch 16 - update       7440 => loss:   1.159 (#OOM: 0)
Epoch 16 - update       7470 => loss:   1.816 (#OOM: 0)
Epoch 16 - update       7500 => loss:   1.593 (#OOM: 0)
Epoch 16 - update       7530 => loss:   1.375 (#OOM: 0)
Epoch 16 - update       7560 => loss:   1.191 (#OOM: 0)
Epoch 16 - update       7590 => loss:   0.832 (#OOM: 0)
Epoch 16 - update       7620 => loss:   1.056 (#OOM: 0)
--> Epoch 16 finished with mean loss 1.24601
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (809 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.29batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.08batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.66batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 53.57batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.48batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.97batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.95batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.45batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.43batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 75.68batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 75.51batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 76.62batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 76.74batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 77.98batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 77.65batch/s]  8%|██▏                         | 77/1014 [00:00<00:12, 77.58batch/s]  8%|██▎                         | 86/1014 [00:01<00:11, 77.94batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 78.90batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 78.51batch/s] 11%|███                        | 113/1014 [00:01<00:11, 78.81batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 78.52batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 78.54batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 78.73batch/s] 15%|███▉                       | 149/1014 [00:01<00:11, 78.51batch/s] 16%|████▏                      | 158/1014 [00:02<00:10, 78.11batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 78.66batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 78.89batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 78.22batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 77.48batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 77.89batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 78.12batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 78.02batch/s] 23%|██████                     | 230/1014 [00:02<00:10, 78.28batch/s] 24%|██████▎                    | 239/1014 [00:03<00:09, 78.05batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 77.90batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 77.70batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 77.77batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 77.93batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 77.74batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 77.95batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 78.04batch/s] 31%|████████▎                  | 311/1014 [00:03<00:09, 77.81batch/s] 32%|████████▌                  | 320/1014 [00:04<00:08, 77.90batch/s] 32%|████████▊                  | 329/1014 [00:04<00:08, 77.70batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 77.75batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 77.80batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 77.62batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 77.21batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 77.41batch/s] 38%|██████████▏                | 383/1014 [00:04<00:08, 77.12batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 76.97batch/s] 40%|██████████▋                | 401/1014 [00:05<00:07, 76.88batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 76.68batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 76.49batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 76.60batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 76.66batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 76.74batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 76.54batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 76.70batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 76.63batch/s] 48%|████████████▊              | 482/1014 [00:06<00:06, 76.61batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 76.67batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 76.61batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 76.71batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.76batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 76.48batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 76.35batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 76.27batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 76.32batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 76.29batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 76.17batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 76.04batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 76.10batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 76.10batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.20batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 76.02batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.97batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 75.92batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 76.03batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.95batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 76.02batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 76.07batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 76.07batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 76.02batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 76.16batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.93batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.87batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.93batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.98batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.99batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 76.14batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 76.05batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 76.02batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.85batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.70batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.63batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.57batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.64batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.63batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.52batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.58batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:01, 75.53batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.48batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.54batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.52batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.65batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.65batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.62batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.58batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.58batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.58batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.71batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.77batch/s] 97%|██████████████████████████▏| 983/1014 [00:12<00:00, 75.85batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.89batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.90batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.96batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.95batch/s]
Validation 16 -> LOSS = 1.39
Validation 16 -> BLEU = 45.39, 71.2/51.9/39.6/30.3 (BP=0.989, ratio=0.989, hyp_len=14225, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.39 @ validation 16
--> Best BLEU so far: 45.39 @ validation 16
Starting Epoch 17
Epoch 17 - update       7650 => loss:   0.928 (#OOM: 0)
Epoch 17 - update       7680 => loss:   1.575 (#OOM: 0)
Epoch 17 - update       7710 => loss:   1.353 (#OOM: 0)
Epoch 17 - update       7740 => loss:   1.205 (#OOM: 0)
Epoch 17 - update       7770 => loss:   0.881 (#OOM: 0)
Epoch 17 - update       7800 => loss:   1.352 (#OOM: 0)
Epoch 17 - update       7830 => loss:   1.482 (#OOM: 0)
Epoch 17 - update       7860 => loss:   1.165 (#OOM: 0)
Epoch 17 - update       7890 => loss:   0.969 (#OOM: 0)
Epoch 17 - update       7920 => loss:   1.004 (#OOM: 0)
Epoch 17 - update       7950 => loss:   1.287 (#OOM: 0)
Epoch 17 - update       7980 => loss:   1.278 (#OOM: 0)
Epoch 17 - update       8010 => loss:   1.083 (#OOM: 0)
Epoch 17 - update       8040 => loss:   1.212 (#OOM: 0)
Epoch 17 - update       8070 => loss:   1.540 (#OOM: 0)
Epoch 17 - update       8100 => loss:   0.750 (#OOM: 0)
--> Epoch 17 finished with mean loss 1.21392
--> Overhead/Training/Evaluation: 0.03/0.51/0.00 mins (total: 0.54 mins)   (942 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.20batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 52.33batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.05batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.53batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.34batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.22batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.19batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.64batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.33batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 77.43batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 78.30batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 76.61batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 77.07batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 76.48batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 77.31batch/s]  8%|██▏                         | 79/1014 [00:01<00:11, 78.01batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 78.99batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 79.13batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 79.17batch/s] 11%|███                        | 115/1014 [00:01<00:11, 79.60batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 79.15batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 79.68batch/s] 14%|███▊                       | 142/1014 [00:01<00:10, 79.72batch/s] 15%|████                       | 151/1014 [00:01<00:10, 79.33batch/s] 16%|████▎                      | 160/1014 [00:02<00:10, 79.46batch/s] 17%|████▌                      | 169/1014 [00:02<00:10, 78.99batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 77.55batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 77.16batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 77.20batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 77.69batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 77.82batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 77.49batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 77.61batch/s] 24%|██████▌                    | 246/1014 [00:03<00:09, 77.89batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 77.75batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 78.28batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 78.08batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 78.25batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 78.63batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 78.87batch/s] 31%|████████▍                  | 316/1014 [00:04<00:08, 78.98batch/s] 32%|████████▋                  | 326/1014 [00:04<00:08, 78.60batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 78.33batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 78.34batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 78.35batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 77.97batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 78.14batch/s] 38%|██████████▎                | 386/1014 [00:04<00:08, 78.13batch/s] 39%|██████████▌                | 396/1014 [00:05<00:07, 77.99batch/s] 40%|██████████▊                | 406/1014 [00:05<00:07, 78.04batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 77.94batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 77.96batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 78.06batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 77.71batch/s] 45%|████████████▏              | 456/1014 [00:05<00:07, 77.85batch/s] 46%|████████████▍              | 466/1014 [00:05<00:07, 77.69batch/s] 47%|████████████▋              | 476/1014 [00:06<00:06, 77.71batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 77.92batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 78.04batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 78.00batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 78.06batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 78.13batch/s] 53%|██████████████▎            | 536/1014 [00:06<00:06, 78.02batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 77.96batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:05, 78.12batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 78.14batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 78.05batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 77.95batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 78.01batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 78.00batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:05, 77.97batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:04, 77.73batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:04, 77.60batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 77.52batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 77.44batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 77.33batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 77.49batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:04, 77.31batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 77.28batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:03, 77.37batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 77.33batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 77.31batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 77.32batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 77.34batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 77.29batch/s] 76%|████████████████████▍      | 766/1014 [00:09<00:03, 77.15batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 77.08batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:02, 77.06batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 76.84batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 76.78batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 76.82batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 76.68batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 76.66batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 76.52batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 76.60batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 76.47batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 76.48batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 76.39batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 76.44batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 76.49batch/s] 90%|████████████████████████▍  | 916/1014 [00:11<00:01, 76.51batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 76.44batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 76.48batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 76.50batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 76.45batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 76.44batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 76.47batch/s] 97%|██████████████████████████▎| 986/1014 [00:12<00:00, 76.46batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 76.52batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 76.41batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.49batch/s]
Validation 17 -> LOSS = 1.38
Validation 17 -> BLEU = 45.84, 71.3/52.5/40.4/31.1 (BP=0.984, ratio=0.984, hyp_len=14159, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.38 @ validation 17
--> Best BLEU so far: 45.84 @ validation 17
Starting Epoch 18
Epoch 18 - update       8130 => loss:   1.007 (#OOM: 0)
Epoch 18 - update       8160 => loss:   1.359 (#OOM: 0)
Epoch 18 - update       8190 => loss:   1.406 (#OOM: 0)
Epoch 18 - update       8220 => loss:   1.570 (#OOM: 0)
Epoch 18 - update       8250 => loss:   0.872 (#OOM: 0)
Epoch 18 - update       8280 => loss:   1.030 (#OOM: 0)
Epoch 18 - update       8310 => loss:   1.014 (#OOM: 0)
Epoch 18 - update       8340 => loss:   1.124 (#OOM: 0)
Epoch 18 - update       8370 => loss:   0.974 (#OOM: 0)
Epoch 18 - update       8400 => loss:   0.805 (#OOM: 0)
Epoch 18 - update       8430 => loss:   1.110 (#OOM: 0)
Epoch 18 - update       8460 => loss:   0.917 (#OOM: 0)
Epoch 18 - update       8490 => loss:   1.336 (#OOM: 0)
Epoch 18 - update       8520 => loss:   1.144 (#OOM: 0)
Epoch 18 - update       8550 => loss:   1.186 (#OOM: 0)
Epoch 18 - update       8580 => loss:   0.993 (#OOM: 0)
--> Epoch 18 finished with mean loss 1.18228
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (898 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.45batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 54.23batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 52.71batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 53.81batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.82batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.08batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.85batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.19batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 75.54batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 74.04batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 76.74batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 76.39batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 76.28batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 77.09batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 78.28batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 78.58batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 78.85batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 78.81batch/s] 11%|███                        | 116/1014 [00:01<00:11, 78.50batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 77.86batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.16batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 74.91batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.59batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.04batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.33batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.41batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.38batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.54batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.96batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.53batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.73batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.97batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.83batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.84batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 75.69batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.83batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.30batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.03batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.42batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 75.46batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.36batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 75.43batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 75.39batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 75.50batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 75.60batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.74batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 75.95batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.92batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 75.76batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 75.58batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 75.52batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 75.56batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 75.71batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 75.52batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.68batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 75.72batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 76.01batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 76.17batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 76.18batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 75.95batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 75.97batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 75.77batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 75.78batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.60batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 75.47batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.22batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 75.26batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 75.32batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 75.17batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 75.12batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.30batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 75.13batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 75.20batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.22batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.31batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.27batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 75.28batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.19batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.31batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.30batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.39batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.31batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.42batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.31batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 75.41batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.53batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.55batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 75.68batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.63batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.49batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.49batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 75.36batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.43batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.53batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.43batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.45batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.34batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.36batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.38batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 75.27batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 75.15batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.17batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 75.23batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.25batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.31batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.40batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 75.42batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.47batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.42batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.54batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.57batch/s]
Validation 18 -> LOSS = 1.37
Validation 18 -> BLEU = 46.03, 70.7/52.2/40.0/30.6 (BP=0.998, ratio=0.998, hyp_len=14358, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.37 @ validation 18
--> Best BLEU so far: 46.03 @ validation 18
Starting Epoch 19
Epoch 19 - update       8610 => loss:   1.522 (#OOM: 0)
Epoch 19 - update       8640 => loss:   1.022 (#OOM: 0)
Epoch 19 - update       8670 => loss:   1.305 (#OOM: 0)
Epoch 19 - update       8700 => loss:   1.119 (#OOM: 0)
Epoch 19 - update       8730 => loss:   1.256 (#OOM: 0)
Epoch 19 - update       8760 => loss:   1.391 (#OOM: 0)
Epoch 19 - update       8790 => loss:   1.360 (#OOM: 0)
Epoch 19 - update       8820 => loss:   0.916 (#OOM: 0)
Epoch 19 - update       8850 => loss:   1.043 (#OOM: 0)
Epoch 19 - update       8880 => loss:   1.061 (#OOM: 0)
Epoch 19 - update       8910 => loss:   1.423 (#OOM: 0)
Epoch 19 - update       8940 => loss:   1.523 (#OOM: 0)
Epoch 19 - update       8970 => loss:   0.923 (#OOM: 0)
Epoch 19 - update       9000 => loss:   1.012 (#OOM: 0)
Epoch 19 - update       9030 => loss:   1.230 (#OOM: 0)
Epoch 19 - update       9060 => loss:   0.995 (#OOM: 0)
--> Epoch 19 finished with mean loss 1.15339
--> Overhead/Training/Evaluation: 0.03/0.49/0.00 mins (total: 0.52 mins)   (988 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.46batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 53.54batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 53.76batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 53.15batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.20batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.12batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.09batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.44batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 79.79batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 78.96batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 78.07batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.80batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 76.87batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.62batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 76.11batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.68batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 77.08batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 77.29batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 76.46batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.50batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.64batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.09batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.61batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.75batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.04batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.29batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 75.75batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.83batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 76.29batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 76.43batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.45batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 76.00batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.49batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 75.39batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 75.62batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 75.76batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 75.77batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.85batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.77batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.86batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.59batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.54batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.36batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 75.33batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 74.81batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 74.76batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 74.99batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 75.16batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 75.18batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.04batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.17batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.07batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.90batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.12batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.20batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 75.19batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 75.18batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 75.05batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 74.91batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 75.09batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 75.19batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.10batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.23batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.32batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 75.37batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 75.34batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 75.53batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 75.40batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.26batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.13batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.27batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.22batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.24batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 75.26batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.18batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.11batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.14batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 75.04batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.07batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.10batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.00batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.87batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.93batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.06batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 75.05batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 75.12batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.17batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 75.19batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.07batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 75.19batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 75.24batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 75.37batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.42batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 75.38batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.35batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.36batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.25batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 75.33batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.21batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.16batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.24batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.28batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.18batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.21batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.25batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 75.25batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.23batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.26batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.24batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.18batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.22batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.15batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 75.20batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.23batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.23batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.24batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.23batch/s]
Validation 19 -> LOSS = 1.38
Validation 19 -> BLEU = 46.22, 70.7/52.3/40.2/30.7 (BP=1.000, ratio=1.006, hyp_len=14472, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.37 @ validation 18
--> Best BLEU so far: 46.22 @ validation 19
Starting Epoch 20
Epoch 20 - update       9090 => loss:   0.984 (#OOM: 0)
Epoch 20 - update       9120 => loss:   1.035 (#OOM: 0)
Epoch 20 - update       9150 => loss:   1.035 (#OOM: 0)
Epoch 20 - update       9180 => loss:   0.807 (#OOM: 0)
Epoch 20 - update       9210 => loss:   0.805 (#OOM: 0)
Epoch 20 - update       9240 => loss:   1.334 (#OOM: 0)
Epoch 20 - update       9270 => loss:   0.560 (#OOM: 0)
Epoch 20 - update       9300 => loss:   1.197 (#OOM: 0)
Epoch 20 - update       9330 => loss:   1.133 (#OOM: 0)
Epoch 20 - update       9360 => loss:   1.391 (#OOM: 0)
Epoch 20 - update       9390 => loss:   1.282 (#OOM: 0)
Epoch 20 - update       9420 => loss:   1.243 (#OOM: 0)
Epoch 20 - update       9450 => loss:   1.291 (#OOM: 0)
Epoch 20 - update       9480 => loss:   1.395 (#OOM: 0)
Epoch 20 - update       9510 => loss:   1.051 (#OOM: 0)
Epoch 20 - update       9540 => loss:   0.825 (#OOM: 0)
--> Epoch 20 finished with mean loss 1.12476
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (767 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.70batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.35batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 50.10batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.23batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 49.53batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.64batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 80.78batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.75batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.71batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 79.49batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.69batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.09batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 79.50batch/s]  7%|██                          | 73/1014 [00:00<00:11, 81.21batch/s]  8%|██▎                         | 83/1014 [00:01<00:11, 80.73batch/s]  9%|██▌                         | 93/1014 [00:01<00:11, 79.90batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 78.74batch/s] 11%|███                        | 113/1014 [00:01<00:11, 78.61batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 79.00batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 78.98batch/s] 14%|███▊                       | 143/1014 [00:01<00:10, 79.46batch/s] 15%|████                       | 153/1014 [00:01<00:10, 78.56batch/s] 16%|████▎                      | 163/1014 [00:02<00:10, 78.31batch/s] 17%|████▌                      | 173/1014 [00:02<00:10, 78.14batch/s] 18%|████▊                      | 183/1014 [00:02<00:10, 78.54batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 78.32batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 78.14batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 78.14batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 78.12batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 77.58batch/s] 24%|██████▍                    | 243/1014 [00:03<00:09, 77.44batch/s] 25%|██████▋                    | 253/1014 [00:03<00:09, 77.10batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 77.01batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 76.72batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 76.80batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 76.92batch/s] 30%|████████                   | 303/1014 [00:03<00:09, 76.99batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 76.85batch/s] 32%|████████▌                  | 323/1014 [00:04<00:08, 76.79batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 76.82batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 76.85batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 76.92batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 77.02batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 76.74batch/s] 38%|██████████▏                | 383/1014 [00:04<00:08, 76.66batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 76.62batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 76.33batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 76.46batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 76.29batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 76.22batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 76.16batch/s] 45%|████████████               | 453/1014 [00:05<00:07, 75.89batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 76.00batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 76.05batch/s] 48%|████████████▊              | 483/1014 [00:06<00:06, 76.08batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 76.10batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.77batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.97batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 76.11batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 76.08batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 76.09batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 76.06batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 76.00batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.79batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.85batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.74batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 75.72batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.63batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.62batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.80batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.72batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.77batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.78batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.72batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.63batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.36batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.29batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 75.20batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.31batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.22batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.14batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 75.09batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.04batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.92batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 74.94batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 74.95batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.04batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.01batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 74.91batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.89batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.93batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.03batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 75.19batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.21batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.13batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.21batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.30batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.32batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.22batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.27batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.31batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.41batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.42batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.29batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.34batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.31batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.32batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.27batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.26batch/s]
Validation 20 -> LOSS = 1.37
Validation 20 -> BLEU = 46.28, 71.9/53.0/40.7/31.4 (BP=0.985, ratio=0.985, hyp_len=14166, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.37 @ validation 20
--> Best BLEU so far: 46.28 @ validation 20
Starting Epoch 21
Epoch 21 - update       9570 => loss:   0.797 (#OOM: 0)
Epoch 21 - update       9600 => loss:   0.936 (#OOM: 0)
Epoch 21 - update       9630 => loss:   0.850 (#OOM: 0)
Epoch 21 - update       9660 => loss:   0.819 (#OOM: 0)
Epoch 21 - update       9690 => loss:   1.397 (#OOM: 0)
Epoch 21 - update       9720 => loss:   1.346 (#OOM: 0)
Epoch 21 - update       9750 => loss:   1.222 (#OOM: 0)
Epoch 21 - update       9780 => loss:   0.881 (#OOM: 0)
Epoch 21 - update       9810 => loss:   0.580 (#OOM: 0)
Epoch 21 - update       9840 => loss:   1.598 (#OOM: 0)
Epoch 21 - update       9870 => loss:   0.855 (#OOM: 0)
Epoch 21 - update       9900 => loss:   1.070 (#OOM: 0)
Epoch 21 - update       9930 => loss:   0.426 (#OOM: 0)
Epoch 21 - update       9960 => loss:   0.998 (#OOM: 0)
Epoch 21 - update       9990 => loss:   1.027 (#OOM: 0)
--> Epoch 21 finished with mean loss 1.10132
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (782 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.85batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.31batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.62batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.03batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.08batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.01batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.89batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 72.06batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 74.22batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 73.45batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 74.17batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 73.54batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 71.85batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 72.93batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 73.88batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.18batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.11batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 75.08batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.16batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.04batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 75.97batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 76.91batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 76.27batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 75.95batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 76.83batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 76.92batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 76.61batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.87batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.35batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 76.45batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 76.57batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 76.64batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 76.26batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 76.36batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 76.22batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 76.03batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 76.03batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 76.18batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 76.17batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 76.24batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 76.12batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 76.21batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 76.00batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.81batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 75.59batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.71batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.78batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.92batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 76.01batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.76batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.68batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 75.89batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 75.97batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.69batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.60batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 75.67batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.01batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 75.19batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 75.11batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.16batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 75.21batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.30batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.34batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.26batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.33batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.34batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 75.07batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 75.18batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 75.23batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.28batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.29batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.50batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.68batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.74batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.75batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.70batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.87batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.99batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.93batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.90batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.85batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.75batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 75.61batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.73batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.73batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.79batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.86batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.92batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.88batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.90batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 75.94batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.98batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.92batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.95batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 76.00batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.83batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.82batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.86batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 76.01batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.94batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.87batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.85batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.79batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.80batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.83batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 75.84batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.82batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.76batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.71batch/s]
Validation 21 -> LOSS = 1.36
Validation 21 -> BLEU = 45.96, 70.9/52.3/40.3/30.9 (BP=0.992, ratio=0.992, hyp_len=14263, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.36 @ validation 21
--> Best BLEU so far: 46.28 @ validation 20
Starting Epoch 22
Epoch 22 - update      10020 => loss:   0.983 (#OOM: 0)
Epoch 22 - update      10050 => loss:   0.625 (#OOM: 0)
Epoch 22 - update      10080 => loss:   0.444 (#OOM: 0)
Epoch 22 - update      10110 => loss:   0.855 (#OOM: 0)
Epoch 22 - update      10140 => loss:   0.956 (#OOM: 0)
Epoch 22 - update      10170 => loss:   0.889 (#OOM: 0)
Epoch 22 - update      10200 => loss:   1.409 (#OOM: 0)
Epoch 22 - update      10230 => loss:   0.971 (#OOM: 0)
Epoch 22 - update      10260 => loss:   1.067 (#OOM: 0)
Epoch 22 - update      10290 => loss:   1.184 (#OOM: 0)
Epoch 22 - update      10320 => loss:   1.072 (#OOM: 0)
Epoch 22 - update      10350 => loss:   0.925 (#OOM: 0)
Epoch 22 - update      10380 => loss:   1.188 (#OOM: 0)
Epoch 22 - update      10410 => loss:   1.213 (#OOM: 0)
Epoch 22 - update      10440 => loss:   1.191 (#OOM: 0)
Epoch 22 - update      10470 => loss:   1.546 (#OOM: 0)
--> Epoch 22 finished with mean loss 1.07496
--> Overhead/Training/Evaluation: 0.02/0.44/0.00 mins (total: 0.47 mins)   (1091 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.19batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.06batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 47.14batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 46.38batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.16batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.19batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.70batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 71.03batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.30batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 68.00batch/s]  4%|█                           | 40/1014 [00:00<00:14, 67.40batch/s]  5%|█▎                          | 48/1014 [00:00<00:14, 68.73batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 69.45batch/s]  7%|█▊                          | 66/1014 [00:00<00:13, 70.96batch/s]  7%|██                          | 76/1014 [00:01<00:12, 72.40batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 72.87batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 73.57batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 72.61batch/s] 11%|███                        | 116/1014 [00:01<00:12, 72.72batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.06batch/s] 13%|███▌                       | 136/1014 [00:01<00:12, 72.86batch/s] 14%|███▉                       | 146/1014 [00:02<00:11, 72.86batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 72.37batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 72.81batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 72.03batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 72.35batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 72.68batch/s] 20%|█████▍                     | 206/1014 [00:02<00:11, 73.26batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 73.27batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 73.25batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 73.36batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 73.38batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 72.56batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 72.65batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 72.75batch/s] 28%|███████▌                   | 286/1014 [00:03<00:10, 72.25batch/s] 29%|███████▉                   | 296/1014 [00:04<00:09, 72.66batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 72.77batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 73.25batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 73.55batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 73.21batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 73.37batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 73.57batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 73.81batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 73.80batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 73.80batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 73.98batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 73.98batch/s] 41%|███████████                | 416/1014 [00:05<00:08, 74.31batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 74.18batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 74.25batch/s] 44%|███████████▉               | 446/1014 [00:06<00:07, 74.33batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 74.52batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 74.32batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 74.48batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.60batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 74.56batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 74.69batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 74.79batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 74.56batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 74.49batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 74.27batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 74.41batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 74.52batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.56batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 74.76batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 74.70batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.57batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.45batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 74.29batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.39batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.36batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 74.42batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.48batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 74.28batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 74.23batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 74.35batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 74.41batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 74.47batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 74.59batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.65batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 74.54batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.44batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.39batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.38batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.45batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.37batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.53batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 74.59batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.66batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.73batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.85batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.84batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.89batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.95batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.08batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 75.14batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 75.17batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.12batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.06batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.11batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 74.95batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 74.98batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 74.92batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.99batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.73batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.80batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.70batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.74batch/s]
Validation 22 -> LOSS = 1.35
Validation 22 -> BLEU = 46.43, 70.7/52.3/40.3/31.1 (BP=1.000, ratio=1.007, hyp_len=14479, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.35 @ validation 22
--> Best BLEU so far: 46.43 @ validation 22
Starting Epoch 23
Epoch 23 - update      10500 => loss:   1.002 (#OOM: 0)
Epoch 23 - update      10530 => loss:   0.896 (#OOM: 0)
Epoch 23 - update      10560 => loss:   1.352 (#OOM: 0)
Epoch 23 - update      10590 => loss:   1.311 (#OOM: 0)
Epoch 23 - update      10620 => loss:   0.803 (#OOM: 0)
Epoch 23 - update      10650 => loss:   0.770 (#OOM: 0)
Epoch 23 - update      10680 => loss:   1.098 (#OOM: 0)
Epoch 23 - update      10710 => loss:   0.807 (#OOM: 0)
Epoch 23 - update      10740 => loss:   0.974 (#OOM: 0)
Epoch 23 - update      10770 => loss:   0.905 (#OOM: 0)
Epoch 23 - update      10800 => loss:   0.856 (#OOM: 0)
Epoch 23 - update      10830 => loss:   0.807 (#OOM: 0)
Epoch 23 - update      10860 => loss:   1.059 (#OOM: 0)
Epoch 23 - update      10890 => loss:   0.757 (#OOM: 0)
Epoch 23 - update      10920 => loss:   1.131 (#OOM: 0)
Epoch 23 - update      10950 => loss:   0.825 (#OOM: 0)
--> Epoch 23 finished with mean loss 1.05493
--> Overhead/Training/Evaluation: 0.03/0.49/0.00 mins (total: 0.52 mins)   (979 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 36.99batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.13batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.33batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.05batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 50.06batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.70batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.72batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.23batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 77.38batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 74.11batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 75.27batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 76.11batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.06batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 75.11batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.57batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.81batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.39batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.78batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.00batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.85batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.30batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.93batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.50batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.62batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.85batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.07batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 76.19batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 76.36batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 76.33batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 76.79batch/s] 22%|██████                     | 227/1014 [00:02<00:10, 77.01batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 76.98batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 76.55batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 76.15batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 76.39batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 76.51batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 76.76batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 76.65batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 76.58batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 76.67batch/s] 32%|████████▋                  | 327/1014 [00:04<00:08, 76.57batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 76.40batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 76.49batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 76.32batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 76.36batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 76.40batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 76.38batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 76.49batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 76.54batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 76.18batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 76.34batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 76.43batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 76.64batch/s] 45%|████████████▏              | 457/1014 [00:05<00:07, 76.39batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 76.41batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 76.52batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 76.40batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 76.51batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 76.50batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 76.32batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 76.19batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 76.13batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 76.05batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 76.16batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 76.07batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 76.17batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 76.24batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 76.15batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 76.18batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 76.42batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 76.39batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 76.48batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 76.29batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 76.27batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 76.28batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 76.30batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:04, 76.38batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 76.33batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 76.34batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 76.33batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 76.29batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.71batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.67batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 75.75batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.71batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.84batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 75.84batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.79batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.81batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.75batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 75.77batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.69batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.75batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.66batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.67batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.65batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.74batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.77batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 75.71batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 75.66batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.78batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 75.77batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.76batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.82batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.84batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 75.93batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 75.95batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.92batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 76.03batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.93batch/s]
Validation 23 -> LOSS = 1.37
Validation 23 -> BLEU = 46.77, 72.0/53.5/41.2/31.8 (BP=0.987, ratio=0.987, hyp_len=14196, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.35 @ validation 22
--> Best BLEU so far: 46.77 @ validation 23
Starting Epoch 24
Epoch 24 - update      10980 => loss:   1.016 (#OOM: 0)
Epoch 24 - update      11010 => loss:   1.074 (#OOM: 0)
Epoch 24 - update      11040 => loss:   1.034 (#OOM: 0)
Epoch 24 - update      11070 => loss:   0.773 (#OOM: 0)
Epoch 24 - update      11100 => loss:   1.495 (#OOM: 0)
Epoch 24 - update      11130 => loss:   0.950 (#OOM: 0)
Epoch 24 - update      11160 => loss:   0.849 (#OOM: 0)
Epoch 24 - update      11190 => loss:   0.895 (#OOM: 0)
Epoch 24 - update      11220 => loss:   0.867 (#OOM: 0)
Epoch 24 - update      11250 => loss:   0.884 (#OOM: 0)
Epoch 24 - update      11280 => loss:   0.626 (#OOM: 0)
Epoch 24 - update      11310 => loss:   1.065 (#OOM: 0)
Epoch 24 - update      11340 => loss:   1.239 (#OOM: 0)
Epoch 24 - update      11370 => loss:   1.304 (#OOM: 0)
Epoch 24 - update      11400 => loss:   1.179 (#OOM: 0)
Epoch 24 - update      11430 => loss:   1.173 (#OOM: 0)
--> Epoch 24 finished with mean loss 1.03470
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.58 mins)   (892 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.29batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.90batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.60batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.30batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 53.33batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.39batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 77.38batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 80.19batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 77.04batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 78.94batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 77.24batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 76.16batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.45batch/s]  7%|██                          | 73/1014 [00:00<00:12, 77.93batch/s]  8%|██▎                         | 83/1014 [00:01<00:11, 77.66batch/s]  9%|██▌                         | 93/1014 [00:01<00:11, 77.15batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 76.65batch/s] 11%|███                        | 113/1014 [00:01<00:11, 76.02batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 76.55batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 77.11batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 76.99batch/s] 15%|████                       | 153/1014 [00:01<00:11, 77.10batch/s] 16%|████▎                      | 163/1014 [00:02<00:10, 77.73batch/s] 17%|████▌                      | 173/1014 [00:02<00:10, 77.11batch/s] 18%|████▊                      | 183/1014 [00:02<00:10, 77.03batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 76.80batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 76.17batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 75.94batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.42batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.29batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.82batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 74.76batch/s] 26%|███████                    | 263/1014 [00:03<00:10, 74.56batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 74.72batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 74.76batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 74.62batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 75.07batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 75.23batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.10batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.92batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 75.29batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 75.00batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 74.87batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 75.01batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 75.19batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 75.35batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.54batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.56batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.79batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.66batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.14batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.98batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.76batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.68batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.88batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 74.61batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 74.72batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.60batch/s] 52%|█████████████▉             | 523/1014 [00:07<00:06, 74.54batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 74.75batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 74.81batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.01batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 74.95batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.08batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.13batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.12batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 75.20batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.19batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.23batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.35batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.36batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.44batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.49batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.45batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.40batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.46batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.14batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 75.15batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.06batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 74.99batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.09batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 75.16batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.00batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.92batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 74.91batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 74.94batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 74.85batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 74.93batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 74.94batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.85batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.87batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.78batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 74.71batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 74.69batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 74.86batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.01batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 74.99batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 74.99batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 74.91batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 74.91batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 74.96batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 74.87batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 74.88batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.02batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.05batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 74.92batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 74.87batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 74.96batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.95batch/s]
Validation 24 -> LOSS = 1.35
Validation 24 -> BLEU = 47.04, 71.3/52.9/41.0/31.7 (BP=1.000, ratio=1.001, hyp_len=14394, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.35 @ validation 24
--> Best BLEU so far: 47.04 @ validation 24
Starting Epoch 25
Epoch 25 - update      11460 => loss:   0.718 (#OOM: 0)
Epoch 25 - update      11490 => loss:   1.342 (#OOM: 0)
Epoch 25 - update      11520 => loss:   0.723 (#OOM: 0)
Epoch 25 - update      11550 => loss:   0.829 (#OOM: 0)
Epoch 25 - update      11580 => loss:   1.035 (#OOM: 0)
Epoch 25 - update      11610 => loss:   0.935 (#OOM: 0)
Epoch 25 - update      11640 => loss:   1.015 (#OOM: 0)
Epoch 25 - update      11670 => loss:   1.063 (#OOM: 0)
Epoch 25 - update      11700 => loss:   0.882 (#OOM: 0)
Epoch 25 - update      11730 => loss:   0.645 (#OOM: 0)
Epoch 25 - update      11760 => loss:   0.917 (#OOM: 0)
Epoch 25 - update      11790 => loss:   0.977 (#OOM: 0)
Epoch 25 - update      11820 => loss:   1.013 (#OOM: 0)
Epoch 25 - update      11850 => loss:   1.216 (#OOM: 0)
Epoch 25 - update      11880 => loss:   1.095 (#OOM: 0)
Epoch 25 - update      11910 => loss:   0.614 (#OOM: 0)
--> Epoch 25 finished with mean loss 1.01355
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (881 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.56batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.98batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.57batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.44batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 48.64batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.95batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.19batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 77.69batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 74.62batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 74.51batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 74.94batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 74.58batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 72.49batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 73.53batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 74.86batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 74.49batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 74.12batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 73.81batch/s] 11%|███                        | 116/1014 [00:01<00:12, 74.06batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 73.52batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 73.76batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 73.26batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.29batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 74.45batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 74.49batch/s] 18%|████▊                      | 183/1014 [00:02<00:11, 74.95batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 75.26batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 75.44batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 75.40batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.51batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 76.06batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 75.81batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 75.96batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 76.03batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 75.59batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 75.73batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.83batch/s] 30%|████████                   | 303/1014 [00:03<00:09, 76.02batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 76.01batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 76.12batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 76.17batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 76.36batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 76.63batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 76.85batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 76.87batch/s] 38%|██████████▏                | 383/1014 [00:04<00:08, 76.78batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 76.37batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 76.15batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.89batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 76.15batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 76.25batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.97batch/s] 45%|████████████               | 453/1014 [00:05<00:07, 76.06batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 75.96batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 76.14batch/s] 48%|████████████▊              | 483/1014 [00:06<00:06, 76.12batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 76.33batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 76.42batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 76.38batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 76.63batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:06, 76.57batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 76.70batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 76.82batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 76.85batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 76.93batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 76.90batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 76.99batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 77.03batch/s] 60%|████████████████▎          | 613/1014 [00:07<00:05, 76.97batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 76.93batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:04, 77.07batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 76.97batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 76.90batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 76.85batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 76.80batch/s] 67%|██████████████████▏        | 683/1014 [00:08<00:04, 76.77batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 76.71batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 76.67batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 76.68batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 76.69batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 76.72batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 76.83batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 76.66batch/s] 75%|████████████████████▎      | 763/1014 [00:09<00:03, 76.56batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 76.69batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 76.56batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 76.48batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 76.42batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 76.34batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 76.31batch/s] 82%|██████████████████████▏    | 833/1014 [00:10<00:02, 76.31batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 76.07batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 76.01batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:01, 76.05batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.88batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.91batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.91batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 76.09batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.92batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.78batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.78batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.75batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.72batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.67batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.75batch/s] 97%|██████████████████████████▏| 983/1014 [00:12<00:00, 75.76batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.87batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.76batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.73batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.71batch/s]
Validation 25 -> LOSS = 1.36
Validation 25 -> BLEU = 46.85, 71.5/53.2/41.1/31.8 (BP=0.993, ratio=0.993, hyp_len=14278, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.35 @ validation 24
--> Best BLEU so far: 47.04 @ validation 24
Starting Epoch 26
Epoch 26 - update      11940 => loss:   1.103 (#OOM: 0)
Epoch 26 - update      11970 => loss:   0.739 (#OOM: 0)
Epoch 26 - update      12000 => loss:   0.758 (#OOM: 0)
Epoch 26 - update      12030 => loss:   1.053 (#OOM: 0)
Epoch 26 - update      12060 => loss:   1.215 (#OOM: 0)
Epoch 26 - update      12090 => loss:   1.145 (#OOM: 0)
Epoch 26 - update      12120 => loss:   0.798 (#OOM: 0)
Epoch 26 - update      12150 => loss:   0.828 (#OOM: 0)
Epoch 26 - update      12180 => loss:   1.005 (#OOM: 0)
Epoch 26 - update      12210 => loss:   1.117 (#OOM: 0)
Epoch 26 - update      12240 => loss:   1.016 (#OOM: 0)
Epoch 26 - update      12270 => loss:   0.870 (#OOM: 0)
Epoch 26 - update      12300 => loss:   0.887 (#OOM: 0)
Epoch 26 - update      12330 => loss:   1.022 (#OOM: 0)
Epoch 26 - update      12360 => loss:   0.735 (#OOM: 0)
Epoch 26 - update      12390 => loss:   1.029 (#OOM: 0)
--> Epoch 26 finished with mean loss 0.99780
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (784 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.28batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 48.82batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.04batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.70batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.18batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.15batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.90batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.48batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.59batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 76.56batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.59batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 73.01batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 74.08batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 73.35batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 73.38batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 74.74batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 75.17batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 75.86batch/s] 11%|███                        | 115/1014 [00:01<00:11, 76.98batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 76.72batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 75.95batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 75.50batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 75.18batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 75.57batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 75.18batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 75.79batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 76.65batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.70batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 77.30batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 77.74batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 77.65batch/s] 24%|██████▌                    | 245/1014 [00:03<00:09, 78.16batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 77.66batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 77.57batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 77.62batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 77.50batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 77.58batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 77.30batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 77.25batch/s] 32%|████████▋                  | 325/1014 [00:04<00:08, 77.26batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 77.18batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 77.32batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 77.33batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 76.98batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 76.98batch/s] 38%|██████████▎                | 385/1014 [00:04<00:08, 77.08batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 76.99batch/s] 40%|██████████▊                | 405/1014 [00:05<00:07, 76.84batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 76.66batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 76.88batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 76.90batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 76.81batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 76.83batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 76.62batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 76.70batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 76.85batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 76.95batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 76.93batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 77.05batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 77.04batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:06, 76.98batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 76.87batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:05, 76.73batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 76.74batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 76.84batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 76.84batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 76.71batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 76.68batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 76.67batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 76.33batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 76.20batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 76.03batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.78batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.47batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.26batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.20batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.23batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.37batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.33batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.23batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.34batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.40batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 75.43batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.44batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.48batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.46batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.59batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.68batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.62batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.47batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.49batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.56batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.47batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.54batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.64batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.52batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.58batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.60batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.76batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.73batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.77batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.69batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.69batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.60batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.53batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 75.50batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.50batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.59batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.59batch/s]
Validation 26 -> LOSS = 1.35
Validation 26 -> BLEU = 46.55, 71.8/53.2/41.2/31.8 (BP=0.985, ratio=0.985, hyp_len=14163, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.35 @ validation 24
--> Best BLEU so far: 47.04 @ validation 24
Starting Epoch 27
Epoch 27 - update      12420 => loss:   0.760 (#OOM: 0)
Epoch 27 - update      12450 => loss:   0.960 (#OOM: 0)
Epoch 27 - update      12480 => loss:   1.016 (#OOM: 0)
Epoch 27 - update      12510 => loss:   1.004 (#OOM: 0)
Epoch 27 - update      12540 => loss:   0.851 (#OOM: 0)
Epoch 27 - update      12570 => loss:   0.865 (#OOM: 0)
Epoch 27 - update      12600 => loss:   1.011 (#OOM: 0)
Epoch 27 - update      12630 => loss:   0.532 (#OOM: 0)
Epoch 27 - update      12660 => loss:   0.861 (#OOM: 0)
Epoch 27 - update      12690 => loss:   0.993 (#OOM: 0)
Epoch 27 - update      12720 => loss:   0.813 (#OOM: 0)
Epoch 27 - update      12750 => loss:   1.206 (#OOM: 0)
Epoch 27 - update      12780 => loss:   0.810 (#OOM: 0)
Epoch 27 - update      12810 => loss:   1.423 (#OOM: 0)
Epoch 27 - update      12840 => loss:   1.117 (#OOM: 0)
Epoch 27 - update      12870 => loss:   0.783 (#OOM: 0)
--> Epoch 27 finished with mean loss 0.97788
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (782 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.51batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.12batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.96batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.46batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.60batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.80batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.77batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.51batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 78.55batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 75.91batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 71.16batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 72.10batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 73.56batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 72.39batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 74.89batch/s]  8%|██▎                         | 82/1014 [00:01<00:12, 75.81batch/s]  9%|██▌                         | 92/1014 [00:01<00:11, 76.90batch/s] 10%|██▋                        | 102/1014 [00:01<00:11, 77.18batch/s] 11%|██▉                        | 112/1014 [00:01<00:11, 77.17batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 76.61batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 75.64batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 76.07batch/s] 15%|████                       | 152/1014 [00:01<00:11, 76.98batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 77.49batch/s] 17%|████▌                      | 172/1014 [00:02<00:10, 77.14batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 77.19batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 77.38batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 77.03batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 76.97batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 77.59batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 77.10batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 77.12batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 76.57batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 76.41batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 76.35batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 76.02batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 75.73batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 75.78batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 75.51batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.80batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.46batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 74.99batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 75.01batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 75.18batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 75.04batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 75.08batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 75.21batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 75.30batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.31batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 75.03batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.62batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.73batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.68batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.59batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 74.69batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.86batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 74.90batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.85batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 74.63batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 74.68batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 74.82batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 74.65batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 74.76batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 74.61batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.53batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.39batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.45batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.34batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.21batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 74.19batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 74.05batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 74.17batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 74.03batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 74.10batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 74.06batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.20batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 74.18batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.12batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 74.18batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 74.31batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 74.46batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 74.48batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 74.26batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.35batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.51batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 74.51batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 74.48batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 74.59batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 74.64batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 74.55batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 74.54batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 74.58batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.45batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.53batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.57batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.50batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 74.46batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 74.56batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.51batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.50batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 74.48batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.48batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.48batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.55batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 74.59batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.54batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.56batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.51batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.55batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.55batch/s]
Validation 27 -> LOSS = 1.34
Validation 27 -> BLEU = 45.79, 70.2/51.8/39.8/30.4 (BP=1.000, ratio=1.019, hyp_len=14654, ref_len=14382)
** Learning rate changed -> 0.0002
Saving best model based on LOSS
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.34 @ validation 27
--> Best BLEU so far: 47.04 @ validation 24
Starting Epoch 28
Epoch 28 - update      12900 => loss:   0.691 (#OOM: 0)
Epoch 28 - update      12930 => loss:   1.323 (#OOM: 0)
Epoch 28 - update      12960 => loss:   0.622 (#OOM: 0)
Epoch 28 - update      12990 => loss:   1.046 (#OOM: 0)
Epoch 28 - update      13020 => loss:   0.985 (#OOM: 0)
Epoch 28 - update      13050 => loss:   1.030 (#OOM: 0)
Epoch 28 - update      13080 => loss:   0.819 (#OOM: 0)
Epoch 28 - update      13110 => loss:   0.728 (#OOM: 0)
Epoch 28 - update      13140 => loss:   0.871 (#OOM: 0)
Epoch 28 - update      13170 => loss:   0.988 (#OOM: 0)
Epoch 28 - update      13200 => loss:   0.915 (#OOM: 0)
Epoch 28 - update      13230 => loss:   0.736 (#OOM: 0)
Epoch 28 - update      13260 => loss:   0.607 (#OOM: 0)
Epoch 28 - update      13290 => loss:   0.870 (#OOM: 0)
Epoch 28 - update      13320 => loss:   0.777 (#OOM: 0)
Epoch 28 - update      13350 => loss:   0.848 (#OOM: 0)
--> Epoch 28 finished with mean loss 0.92990
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (835 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 41.73batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.79batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.84batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.83batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.76batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.89batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 94.89batch/s]  2%|▌                           | 20/1014 [00:00<00:11, 88.09batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 86.68batch/s]  4%|█                           | 40/1014 [00:00<00:11, 85.20batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 83.04batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 84.86batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 82.40batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 82.30batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 82.45batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 81.89batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 81.41batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 81.92batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 80.71batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 80.40batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 79.84batch/s] 16%|████▎                      | 160/1014 [00:02<00:10, 79.89batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 79.98batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 79.95batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 80.18batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 80.21batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 79.68batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 79.64batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 79.62batch/s] 24%|██████▍                    | 240/1014 [00:03<00:09, 79.51batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 79.85batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 79.73batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 79.54batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 79.26batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 79.18batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 79.04batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 78.73batch/s] 32%|████████▌                  | 320/1014 [00:04<00:08, 78.49batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 78.26batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 78.06batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 78.20batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 78.08batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 77.52batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 77.41batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 77.41batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 77.46batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 77.63batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 77.77batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 77.83batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 77.66batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 77.91batch/s] 45%|████████████▏              | 460/1014 [00:05<00:07, 77.80batch/s] 46%|████████████▌              | 470/1014 [00:06<00:06, 77.96batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 77.87batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 77.58batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 77.44batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 77.55batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 77.58batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 77.70batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:06, 77.80batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:05, 78.00batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 78.06batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 77.85batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 77.86batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 77.59batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 77.53batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 77.63batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:05, 77.52batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:04, 77.44batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 77.31batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 77.23batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 77.10batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 76.94batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 76.76batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:04, 76.90batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 76.81batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:03, 76.54batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 76.39batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 76.30batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 76.17batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 76.23batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 76.30batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 76.16batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.99batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.91batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.90batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.85batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.84batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 75.92batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 76.04batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.90batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.90batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.90batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 76.02batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 76.00batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.96batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 75.89batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.58batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.56batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.44batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.46batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.28batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.24batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 75.20batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.31batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.33batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 75.35batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.34batch/s]
Validation 28 -> LOSS = 1.33
Validation 28 -> BLEU = 46.90, 71.4/52.9/40.7/31.4 (BP=1.000, ratio=1.000, hyp_len=14384, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.04 @ validation 24
Starting Epoch 29
Epoch 29 - update      13380 => loss:   0.942 (#OOM: 0)
Epoch 29 - update      13410 => loss:   0.813 (#OOM: 0)
Epoch 29 - update      13440 => loss:   0.946 (#OOM: 0)
Epoch 29 - update      13470 => loss:   0.761 (#OOM: 0)
Epoch 29 - update      13500 => loss:   0.802 (#OOM: 0)
Epoch 29 - update      13530 => loss:   1.133 (#OOM: 0)
Epoch 29 - update      13560 => loss:   0.816 (#OOM: 0)
Epoch 29 - update      13590 => loss:   0.955 (#OOM: 0)
Epoch 29 - update      13620 => loss:   1.039 (#OOM: 0)
Epoch 29 - update      13650 => loss:   1.274 (#OOM: 0)
Epoch 29 - update      13680 => loss:   0.827 (#OOM: 0)
Epoch 29 - update      13710 => loss:   0.745 (#OOM: 0)
Epoch 29 - update      13740 => loss:   1.046 (#OOM: 0)
Epoch 29 - update      13770 => loss:   0.751 (#OOM: 0)
Epoch 29 - update      13800 => loss:   0.775 (#OOM: 0)
Epoch 29 - update      13830 => loss:   0.746 (#OOM: 0)
--> Epoch 29 finished with mean loss 0.90923
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (780 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.27batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.57batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.05batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.28batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.04batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.28batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 78.74batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 74.81batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 74.35batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 74.14batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 72.44batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 73.25batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 74.00batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 73.34batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.25batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.26batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.38batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 75.34batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.73batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.34batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.42batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.07batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.26batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.41batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.03batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 73.77batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.98batch/s] 20%|█████▎                     | 199/1014 [00:02<00:10, 74.83batch/s] 21%|█████▌                     | 209/1014 [00:02<00:10, 75.15batch/s] 22%|█████▊                     | 219/1014 [00:02<00:10, 75.29batch/s] 23%|██████                     | 229/1014 [00:03<00:10, 75.12batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 75.18batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 75.49batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 75.57batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.12batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.36batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 75.53batch/s] 29%|███████▉                   | 299/1014 [00:03<00:09, 75.76batch/s] 30%|████████▏                  | 309/1014 [00:04<00:09, 75.83batch/s] 31%|████████▍                  | 319/1014 [00:04<00:09, 75.74batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 75.70batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 75.49batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 75.56batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 75.45batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 75.24batch/s] 37%|██████████                 | 379/1014 [00:05<00:08, 75.15batch/s] 38%|██████████▎                | 389/1014 [00:05<00:08, 75.25batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 75.45batch/s] 40%|██████████▉                | 409/1014 [00:05<00:08, 75.05batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 74.96batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 75.16batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 75.38batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 75.21batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 75.13batch/s] 46%|████████████▍              | 469/1014 [00:06<00:07, 75.11batch/s] 47%|████████████▊              | 479/1014 [00:06<00:07, 75.16batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 75.15batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 75.22batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 75.10batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 75.17batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 75.12batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 75.21batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 75.28batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:06, 75.38batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 75.39batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 75.37batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 75.22batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 74.93batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 74.92batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 74.94batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 74.89batch/s] 63%|█████████████████          | 639/1014 [00:08<00:05, 74.95batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 74.96batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 75.01batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 75.15batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 75.18batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 75.33batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 75.36batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 75.34batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 75.39batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 75.35batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 75.36batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 75.12batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 75.10batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 75.15batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 75.18batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:02, 75.19batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 75.13batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 75.19batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 75.04batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 75.09batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 75.04batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 74.99batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 74.99batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 74.98batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 74.99batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 75.02batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 75.15batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 75.24batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 75.20batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 75.29batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:00, 75.29batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 75.32batch/s] 95%|█████████████████████████▌ | 959/1014 [00:12<00:00, 75.28batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 75.25batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 75.29batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 75.15batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 75.13batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 75.15batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.07batch/s]
Validation 29 -> LOSS = 1.34
Validation 29 -> BLEU = 47.49, 71.5/53.4/41.5/32.1 (BP=1.000, ratio=1.001, hyp_len=14392, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.49 @ validation 29
Starting Epoch 30
Epoch 30 - update      13860 => loss:   0.792 (#OOM: 0)
Epoch 30 - update      13890 => loss:   1.116 (#OOM: 0)
Epoch 30 - update      13920 => loss:   0.929 (#OOM: 0)
Epoch 30 - update      13950 => loss:   0.844 (#OOM: 0)
Epoch 30 - update      13980 => loss:   1.117 (#OOM: 0)
Epoch 30 - update      14010 => loss:   0.878 (#OOM: 0)
Epoch 30 - update      14040 => loss:   0.785 (#OOM: 0)
Epoch 30 - update      14070 => loss:   0.788 (#OOM: 0)
Epoch 30 - update      14100 => loss:   0.648 (#OOM: 0)
Epoch 30 - update      14130 => loss:   1.137 (#OOM: 0)
Epoch 30 - update      14160 => loss:   1.048 (#OOM: 0)
Epoch 30 - update      14190 => loss:   1.087 (#OOM: 0)
Epoch 30 - update      14220 => loss:   0.834 (#OOM: 0)
Epoch 30 - update      14250 => loss:   1.055 (#OOM: 0)
Epoch 30 - update      14280 => loss:   0.493 (#OOM: 0)
Epoch 30 - update      14310 => loss:   0.908 (#OOM: 0)
--> Epoch 30 finished with mean loss 0.89892
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (856 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.24batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.43batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.14batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.77batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 52.80batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.94batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 65.74batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 71.21batch/s]  2%|▋                           | 23/1014 [00:00<00:14, 70.74batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.06batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 74.51batch/s]  5%|█▍                          | 50/1014 [00:00<00:13, 73.26batch/s]  6%|█▋                          | 59/1014 [00:00<00:13, 73.34batch/s]  7%|█▉                          | 68/1014 [00:00<00:13, 72.53batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 72.92batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 73.55batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 74.51batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 75.32batch/s] 11%|███                        | 113/1014 [00:01<00:11, 75.27batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 74.08batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 74.65batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 75.04batch/s] 15%|███▉                       | 149/1014 [00:01<00:11, 74.79batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 75.06batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 74.69batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 75.32batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 75.72batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 75.47batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 75.94batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 75.78batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 74.94batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 75.26batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 75.00batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 75.25batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.09batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.46batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 75.46batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.43batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.38batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 75.58batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 75.47batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 75.54batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 75.52batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 75.96batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 75.69batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 75.78batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 75.54batch/s] 37%|██████████                 | 379/1014 [00:05<00:08, 75.56batch/s] 38%|██████████▎                | 389/1014 [00:05<00:08, 75.51batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 75.30batch/s] 40%|██████████▉                | 409/1014 [00:05<00:08, 75.51batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 75.59batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 75.17batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 75.24batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 75.04batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 74.94batch/s] 46%|████████████▍              | 469/1014 [00:06<00:07, 75.06batch/s] 47%|████████████▊              | 479/1014 [00:06<00:07, 75.14batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 75.11batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 75.13batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 75.24batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 75.25batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 75.16batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 75.19batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 75.10batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:06, 74.99batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 75.12batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 75.13batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 75.15batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 75.15batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 75.23batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 75.12batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 75.17batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 75.29batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 75.16batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 75.14batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 75.01batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 74.86batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 74.60batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 74.77batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 74.74batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 74.62batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 74.74batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 74.74batch/s] 74%|███████████████████▉       | 749/1014 [00:10<00:03, 74.65batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 74.76batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 74.92batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 74.95batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 74.95batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 74.86batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 74.95batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 74.92batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 74.93batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 74.90batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 74.99batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 75.06batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 75.05batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 75.10batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 75.14batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 75.11batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 75.20batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 75.11batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 75.13batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:00, 75.14batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 75.25batch/s] 95%|█████████████████████████▌ | 959/1014 [00:12<00:00, 75.30batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 75.21batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 75.23batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 75.33batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 75.37batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 75.46batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.43batch/s]
Validation 30 -> LOSS = 1.34
Validation 30 -> BLEU = 47.67, 72.0/53.6/41.8/32.5 (BP=0.997, ratio=0.997, hyp_len=14332, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 31
Epoch 31 - update      14340 => loss:   1.006 (#OOM: 0)
Epoch 31 - update      14370 => loss:   0.536 (#OOM: 0)
Epoch 31 - update      14400 => loss:   0.877 (#OOM: 0)
Epoch 31 - update      14430 => loss:   0.943 (#OOM: 0)
Epoch 31 - update      14460 => loss:   0.775 (#OOM: 0)
Epoch 31 - update      14490 => loss:   0.574 (#OOM: 0)
Epoch 31 - update      14520 => loss:   0.786 (#OOM: 0)
Epoch 31 - update      14550 => loss:   1.000 (#OOM: 0)
Epoch 31 - update      14580 => loss:   0.874 (#OOM: 0)
Epoch 31 - update      14610 => loss:   1.016 (#OOM: 0)
Epoch 31 - update      14640 => loss:   0.765 (#OOM: 0)
Epoch 31 - update      14670 => loss:   0.869 (#OOM: 0)
Epoch 31 - update      14700 => loss:   0.783 (#OOM: 0)
Epoch 31 - update      14730 => loss:   0.923 (#OOM: 0)
Epoch 31 - update      14760 => loss:   0.573 (#OOM: 0)
--> Epoch 31 finished with mean loss 0.88707
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (806 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.87batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.44batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 49.93batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.67batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 50.13batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.50batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.47batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 82.82batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 79.13batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.79batch/s]  4%|█                           | 37/1014 [00:00<00:11, 81.75batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 81.13batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 82.63batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 79.17batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 78.48batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 77.52batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 78.11batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 77.47batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.69batch/s] 13%|███▍                       | 127/1014 [00:01<00:11, 77.16batch/s] 14%|███▋                       | 137/1014 [00:01<00:11, 76.83batch/s] 14%|███▉                       | 147/1014 [00:01<00:11, 77.36batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 77.01batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 77.07batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 76.95batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 75.48batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.54batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.27batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 74.55batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 74.71batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 75.00batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 75.05batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 74.80batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 74.97batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.72batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.89batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.14batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 74.90batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.17batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 74.81batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 74.58batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:09, 74.07batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 73.93batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.09batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.45batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.69batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 74.91batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 75.12batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 75.01batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 74.94batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 75.14batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.51batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 75.37batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 75.44batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 75.52batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 75.79batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.89batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.91batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.91batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.59batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.79batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 76.00batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 76.06batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 76.00batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 76.21batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 76.09batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 76.34batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 76.38batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 76.26batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 76.26batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 76.05batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 76.02batch/s] 67%|██████████████████         | 679/1014 [00:08<00:04, 76.07batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 76.17batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 76.12batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 76.14batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 76.01batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.97batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 76.00batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 75.95batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.94batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.71batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:02, 75.58batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.53batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 75.51batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.59batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.49batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.50batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.53batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.66batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.66batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.67batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 75.68batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.71batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 75.59batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.66batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.60batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.67batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.72batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.73batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.75batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.78batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 75.80batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.81batch/s]
Validation 31 -> LOSS = 1.34
Validation 31 -> BLEU = 47.44, 72.1/53.9/41.8/32.4 (BP=0.991, ratio=0.991, hyp_len=14252, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 32
Epoch 32 - update      14790 => loss:   1.124 (#OOM: 0)
Epoch 32 - update      14820 => loss:   0.851 (#OOM: 0)
Epoch 32 - update      14850 => loss:   0.683 (#OOM: 0)
Epoch 32 - update      14880 => loss:   0.671 (#OOM: 0)
Epoch 32 - update      14910 => loss:   0.606 (#OOM: 0)
Epoch 32 - update      14940 => loss:   0.745 (#OOM: 0)
Epoch 32 - update      14970 => loss:   0.996 (#OOM: 0)
Epoch 32 - update      15000 => loss:   0.756 (#OOM: 0)
Epoch 32 - update      15030 => loss:   0.832 (#OOM: 0)
Epoch 32 - update      15060 => loss:   0.800 (#OOM: 0)
Epoch 32 - update      15090 => loss:   0.660 (#OOM: 0)
Epoch 32 - update      15120 => loss:   0.874 (#OOM: 0)
Epoch 32 - update      15150 => loss:   0.494 (#OOM: 0)
Epoch 32 - update      15180 => loss:   0.782 (#OOM: 0)
Epoch 32 - update      15210 => loss:   0.788 (#OOM: 0)
Epoch 32 - update      15240 => loss:   0.755 (#OOM: 0)
--> Epoch 32 finished with mean loss 0.87690
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (857 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.47batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.07batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.39batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.77batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.65batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.24batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.24batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 82.03batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 73.89batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 73.78batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 70.33batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 70.78batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 71.51batch/s]  7%|█▉                          | 71/1014 [00:00<00:13, 71.97batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 72.28batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 72.44batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 72.39batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 73.04batch/s] 11%|███                        | 116/1014 [00:01<00:12, 73.78batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 73.98batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 74.14batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 73.58batch/s] 15%|████                       | 152/1014 [00:02<00:11, 73.88batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 74.08batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 74.17batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 74.21batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 74.19batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 74.48batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.40batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 74.37batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 74.03batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.30batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 73.88batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 74.01batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 74.09batch/s] 27%|███████▏                   | 269/1014 [00:03<00:10, 74.12batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 74.35batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.52batch/s] 29%|███████▉                   | 296/1014 [00:04<00:09, 73.51batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 73.60batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 73.52batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 73.59batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 73.65batch/s] 34%|█████████                  | 341/1014 [00:04<00:09, 73.62batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:09, 73.68batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 73.60batch/s] 36%|█████████▊                 | 368/1014 [00:05<00:08, 73.50batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 73.33batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 73.16batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 73.43batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 73.31batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 73.56batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 73.14batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 73.13batch/s] 43%|███████████▋               | 440/1014 [00:06<00:07, 73.19batch/s] 44%|███████████▉               | 449/1014 [00:06<00:07, 73.35batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 73.31batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 73.11batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 73.24batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 73.23batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 72.65batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:07, 72.78batch/s] 50%|█████████████▋             | 512/1014 [00:07<00:06, 72.93batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 73.09batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 73.05batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 73.24batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 73.24batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 73.40batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 73.38batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 73.25batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 73.39batch/s] 58%|███████████████▊           | 593/1014 [00:08<00:05, 73.23batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 73.30batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 73.40batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 73.47batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 73.48batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 73.51batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 73.62batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 73.68batch/s] 66%|█████████████████▋         | 666/1014 [00:09<00:04, 73.91batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 73.88batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 73.93batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 73.88batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 73.90batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 73.97batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 74.07batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.12batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 74.21batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.18batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.21batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.02batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.04batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.03batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.02batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 74.13batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.22batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.24batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.23batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.19batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.20batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.23batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 74.23batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 74.19batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.22batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.28batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 74.19batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 74.26batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 74.27batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 74.30batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 74.40batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.38batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.40batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.34batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.40batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.48batch/s]
Validation 32 -> LOSS = 1.34
Validation 32 -> BLEU = 47.16, 71.2/53.0/41.1/31.9 (BP=1.000, ratio=1.008, hyp_len=14493, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 33
Epoch 33 - update      15270 => loss:   0.713 (#OOM: 0)
Epoch 33 - update      15300 => loss:   0.988 (#OOM: 0)
Epoch 33 - update      15330 => loss:   1.010 (#OOM: 0)
Epoch 33 - update      15360 => loss:   0.570 (#OOM: 0)
Epoch 33 - update      15390 => loss:   0.792 (#OOM: 0)
Epoch 33 - update      15420 => loss:   0.647 (#OOM: 0)
Epoch 33 - update      15450 => loss:   0.724 (#OOM: 0)
Epoch 33 - update      15480 => loss:   1.291 (#OOM: 0)
Epoch 33 - update      15510 => loss:   0.637 (#OOM: 0)
Epoch 33 - update      15540 => loss:   1.168 (#OOM: 0)
Epoch 33 - update      15570 => loss:   0.782 (#OOM: 0)
Epoch 33 - update      15600 => loss:   1.051 (#OOM: 0)
Epoch 33 - update      15630 => loss:   0.630 (#OOM: 0)
Epoch 33 - update      15660 => loss:   1.057 (#OOM: 0)
Epoch 33 - update      15690 => loss:   0.867 (#OOM: 0)
Epoch 33 - update      15720 => loss:   0.811 (#OOM: 0)
--> Epoch 33 finished with mean loss 0.86768
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (768 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.17batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.61batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.03batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.34batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.66batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.09batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.06batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.08batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.66batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 82.31batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 77.36batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 78.36batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 78.04batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 80.03batch/s]  7%|██                          | 73/1014 [00:00<00:12, 78.21batch/s]  8%|██▎                         | 83/1014 [00:01<00:12, 77.32batch/s]  9%|██▌                         | 93/1014 [00:01<00:12, 76.40batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 76.26batch/s] 11%|███                        | 113/1014 [00:01<00:12, 74.55batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 73.81batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 74.08batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 73.56batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.58batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 74.70batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 74.89batch/s] 18%|████▊                      | 183/1014 [00:02<00:11, 74.78batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 75.16batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 75.22batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 75.21batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.32batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.30batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 75.30batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 75.32batch/s] 26%|███████                    | 263/1014 [00:03<00:10, 75.05batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 75.22batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 75.08batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.18batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 75.29batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 75.07batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.06batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.71batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 74.73batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 74.79batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 74.68batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 75.06batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 75.30batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 75.44batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.54batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.59batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.73batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.76batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.82batch/s] 45%|████████████               | 453/1014 [00:05<00:07, 75.52batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 75.36batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.36batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 75.29batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.56batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.64batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.78batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.74batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.96batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.88batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 76.00batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 75.95batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.89batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.76batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.82batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 75.77batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.83batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.88batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.91batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.98batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.99batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.92batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.71batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.62batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.65batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.63batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 75.51batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.41batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.51batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.36batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 75.36batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.43batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.38batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.46batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.36batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.36batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.33batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.28batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.32batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.43batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.44batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:01, 75.56batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.47batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.53batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.51batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.64batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.60batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.58batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.53batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.58batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.49batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.49batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.52batch/s] 97%|██████████████████████████▏| 983/1014 [00:12<00:00, 75.62batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.69batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.79batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.69batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.70batch/s]
Validation 33 -> LOSS = 1.34
Validation 33 -> BLEU = 46.89, 71.4/53.1/41.0/31.6 (BP=0.996, ratio=0.996, hyp_len=14328, ref_len=14382)
** Learning rate changed -> 0.0001
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 34
Epoch 34 - update      15750 => loss:   0.857 (#OOM: 0)
Epoch 34 - update      15780 => loss:   0.833 (#OOM: 0)
Epoch 34 - update      15810 => loss:   0.610 (#OOM: 0)
Epoch 34 - update      15840 => loss:   0.964 (#OOM: 0)
Epoch 34 - update      15870 => loss:   0.570 (#OOM: 0)
Epoch 34 - update      15900 => loss:   0.697 (#OOM: 0)
Epoch 34 - update      15930 => loss:   0.763 (#OOM: 0)
Epoch 34 - update      15960 => loss:   0.951 (#OOM: 0)
Epoch 34 - update      15990 => loss:   0.676 (#OOM: 0)
Epoch 34 - update      16020 => loss:   1.161 (#OOM: 0)
Epoch 34 - update      16050 => loss:   1.011 (#OOM: 0)
Epoch 34 - update      16080 => loss:   1.081 (#OOM: 0)
Epoch 34 - update      16110 => loss:   0.480 (#OOM: 0)
Epoch 34 - update      16140 => loss:   0.741 (#OOM: 0)
Epoch 34 - update      16170 => loss:   0.765 (#OOM: 0)
Epoch 34 - update      16200 => loss:   0.621 (#OOM: 0)
--> Epoch 34 finished with mean loss 0.84661
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (841 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.61batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.33batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.58batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 52.51batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 50.91batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.13batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 84.02batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.50batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.94batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.45batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.23batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 77.32batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 76.90batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 76.79batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 77.48batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 77.45batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.56batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 77.18batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.42batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.55batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.08batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.61batch/s] 15%|████                       | 153/1014 [00:02<00:11, 76.21batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 76.10batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 76.41batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.57batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.94batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 76.09batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.89batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.06batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 76.10batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 76.41batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 76.65batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 76.76batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 76.54batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 76.67batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.96batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.76batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.81batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.95batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.94batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.65batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 75.58batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.67batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 75.88batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 75.51batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 75.42batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 75.42batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.33batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.25batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.26batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.32batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.20batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.27batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 75.37batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 75.39batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 75.34batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.30batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 75.04batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 75.17batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.08batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.20batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.30batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 75.31batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 75.29batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 75.45batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 75.54batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.52batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.43batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.32batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.26batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.28batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 75.49batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.44batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.29batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.17batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.23batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.27batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.20batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.30batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.23batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.25batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.43batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.46batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.41batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.56batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.51batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 75.45batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.40batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.44batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.36batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.42batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.49batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.47batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.48batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.44batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.37batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.38batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.39batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.53batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.66batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.58batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 75.59batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.52batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.45batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.47batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 75.40batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.38batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.42batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.30batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 75.23batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.23batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.19batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.14batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.14batch/s]
Validation 34 -> LOSS = 1.34
Validation 34 -> BLEU = 47.42, 71.6/53.3/41.3/32.0 (BP=1.000, ratio=1.000, hyp_len=14384, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 35
Epoch 35 - update      16230 => loss:   0.675 (#OOM: 0)
Epoch 35 - update      16260 => loss:   0.697 (#OOM: 0)
Epoch 35 - update      16290 => loss:   0.528 (#OOM: 0)
Epoch 35 - update      16320 => loss:   0.459 (#OOM: 0)
Epoch 35 - update      16350 => loss:   1.034 (#OOM: 0)
Epoch 35 - update      16380 => loss:   0.523 (#OOM: 0)
Epoch 35 - update      16410 => loss:   0.723 (#OOM: 0)
Epoch 35 - update      16440 => loss:   0.733 (#OOM: 0)
Epoch 35 - update      16470 => loss:   0.863 (#OOM: 0)
Epoch 35 - update      16500 => loss:   0.577 (#OOM: 0)
Epoch 35 - update      16530 => loss:   0.667 (#OOM: 0)
Epoch 35 - update      16560 => loss:   0.538 (#OOM: 0)
Epoch 35 - update      16590 => loss:   0.640 (#OOM: 0)
Epoch 35 - update      16620 => loss:   1.081 (#OOM: 0)
Epoch 35 - update      16650 => loss:   0.642 (#OOM: 0)
Epoch 35 - update      16680 => loss:   0.681 (#OOM: 0)
--> Epoch 35 finished with mean loss 0.83619
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (772 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.15batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.10batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.52batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 50.91batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 50.17batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.16batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 71.15batch/s]  2%|▍                           | 17/1014 [00:00<00:13, 74.17batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 73.98batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 75.07batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 74.17batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 75.63batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 75.60batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 75.79batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 75.36batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 75.66batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 75.27batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 75.26batch/s] 11%|███                        | 116/1014 [00:01<00:12, 74.75batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 74.85batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.44batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 74.79batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.17batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 74.60batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 75.16batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.19batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 74.90batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.05batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.39batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.37batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.03batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.94batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.19batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.53batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 75.67batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.23batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.18batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.23batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.16batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.90batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.72batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.14batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 75.30batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 74.99batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 75.31batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 75.10batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 75.14batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 75.23batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.26batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.32batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.41batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.70batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.64batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.95batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 76.02batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.94batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.91batch/s] 48%|████████████▉              | 484/1014 [00:06<00:06, 75.76batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.35batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.65batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.69batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.72batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 75.70batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.64batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.52batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.61batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.75batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.81batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.81batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 75.75batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.67batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.42batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.59batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.46batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.23batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.23batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 74.96batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.00batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.05batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.05batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.10batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.11batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.16batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.09batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 75.04batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.12batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.11batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.22batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.13batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.14batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.21batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.25batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.31batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.37batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.44batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.36batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.51batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.46batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.52batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 75.31batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.43batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.58batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.61batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 75.67batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.74batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.81batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.70batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 75.66batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.73batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.73batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.74batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.74batch/s]
Validation 35 -> LOSS = 1.34
Validation 35 -> BLEU = 47.50, 71.8/53.5/41.5/32.2 (BP=0.998, ratio=0.998, hyp_len=14354, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 36
Epoch 36 - update      16710 => loss:   1.010 (#OOM: 0)
Epoch 36 - update      16740 => loss:   0.508 (#OOM: 0)
Epoch 36 - update      16770 => loss:   0.799 (#OOM: 0)
Epoch 36 - update      16800 => loss:   0.975 (#OOM: 0)
Epoch 36 - update      16830 => loss:   0.982 (#OOM: 0)
Epoch 36 - update      16860 => loss:   0.446 (#OOM: 0)
Epoch 36 - update      16890 => loss:   0.703 (#OOM: 0)
Epoch 36 - update      16920 => loss:   0.691 (#OOM: 0)
Epoch 36 - update      16950 => loss:   1.166 (#OOM: 0)
Epoch 36 - update      16980 => loss:   0.953 (#OOM: 0)
Epoch 36 - update      17010 => loss:   0.881 (#OOM: 0)
Epoch 36 - update      17040 => loss:   1.135 (#OOM: 0)
Epoch 36 - update      17070 => loss:   0.751 (#OOM: 0)
Epoch 36 - update      17100 => loss:   0.890 (#OOM: 0)
Epoch 36 - update      17130 => loss:   0.955 (#OOM: 0)
Epoch 36 - update      17160 => loss:   0.639 (#OOM: 0)
--> Epoch 36 finished with mean loss 0.83143
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.60 mins)   (850 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.87batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.07batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.43batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.71batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 53.06batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.54batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.51batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 96.61batch/s]  2%|▌                           | 20/1014 [00:00<00:12, 80.39batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 82.16batch/s]  4%|█                           | 40/1014 [00:00<00:11, 82.49batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 79.89batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 79.69batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 80.15batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 79.33batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 79.25batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 78.63batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 77.95batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 77.21batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 76.96batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 77.13batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 76.87batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.55batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 77.12batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.69batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 76.98batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 77.09batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 77.20batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 77.16batch/s] 23%|██████                     | 230/1014 [00:02<00:10, 76.90batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 76.87batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 77.38batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 77.60batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 77.33batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 77.53batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 77.34batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 77.30batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 77.08batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 76.69batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 76.89batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 76.62batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 76.78batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 76.84batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 76.91batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 76.78batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 76.93batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 77.28batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 77.10batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 77.00batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 76.90batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 76.98batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 76.86batch/s] 45%|████████████▏              | 460/1014 [00:05<00:07, 76.85batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 76.84batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 76.81batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 76.61batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 76.41batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 76.26batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 76.24batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 76.25batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.20batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 76.01batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 76.00batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 76.14batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 76.16batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 75.98batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 76.11batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 76.25batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 76.24batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 76.01batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 76.09batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 75.98batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 75.86batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 75.90batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 75.78batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 75.75batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.88batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 75.93batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.96batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 75.97batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.83batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 75.73batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.89batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 75.87batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.98batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.81batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.77batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.76batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.62batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 75.48batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.48batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.43batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.52batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.49batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.37batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.42batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.32batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.34batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.41batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.45batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.38batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.32batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.22batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.27batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 75.21batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.27batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.21batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 75.21batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.25batch/s]
Validation 36 -> LOSS = 1.34
Validation 36 -> BLEU = 47.53, 71.9/53.5/41.5/32.3 (BP=0.998, ratio=0.998, hyp_len=14352, ref_len=14382)
** Learning rate changed -> 5e-05
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 37
Epoch 37 - update      17190 => loss:   0.654 (#OOM: 0)
Epoch 37 - update      17220 => loss:   0.680 (#OOM: 0)
Epoch 37 - update      17250 => loss:   0.656 (#OOM: 0)
Epoch 37 - update      17280 => loss:   0.965 (#OOM: 0)
Epoch 37 - update      17310 => loss:   0.948 (#OOM: 0)
Epoch 37 - update      17340 => loss:   1.023 (#OOM: 0)
Epoch 37 - update      17370 => loss:   0.726 (#OOM: 0)
Epoch 37 - update      17400 => loss:   0.716 (#OOM: 0)
Epoch 37 - update      17430 => loss:   0.592 (#OOM: 0)
Epoch 37 - update      17460 => loss:   0.798 (#OOM: 0)
Epoch 37 - update      17490 => loss:   0.756 (#OOM: 0)
Epoch 37 - update      17520 => loss:   0.974 (#OOM: 0)
Epoch 37 - update      17550 => loss:   0.927 (#OOM: 0)
Epoch 37 - update      17580 => loss:   0.624 (#OOM: 0)
Epoch 37 - update      17610 => loss:   0.950 (#OOM: 0)
Epoch 37 - update      17640 => loss:   0.834 (#OOM: 0)
--> Epoch 37 finished with mean loss 0.81937
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.61 mins)   (840 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.82batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.69batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.64batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 49.78batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.33batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 50.85batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.47batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 71.64batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 70.72batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.78batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 76.48batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 74.21batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 73.49batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 72.83batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 74.14batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 75.19batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 74.06batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.48batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 73.29batch/s] 11%|███                        | 114/1014 [00:01<00:12, 73.95batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 73.70batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 73.51batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 73.45batch/s] 15%|███▉                       | 150/1014 [00:02<00:11, 72.79batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 73.22batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 72.85batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 73.02batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 72.83batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 72.78batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 73.08batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 72.94batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 73.66batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 73.89batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.05batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 73.52batch/s] 26%|███████                    | 263/1014 [00:03<00:10, 73.80batch/s] 27%|███████▎                   | 273/1014 [00:03<00:10, 73.91batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 74.31batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 74.63batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 75.02batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.69batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.04batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 75.02batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 74.92batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 75.03batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 75.34batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 75.16batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 75.05batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.68batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.72batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.49batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.57batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 74.48batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 74.64batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.96batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.80batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.96batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.97batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 74.70batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 74.96batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.12batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.20batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.23batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.43batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.38batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 75.34batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.41batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.28batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.26batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 75.38batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.18batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.31batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.33batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.44batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.59batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.41batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.48batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.56batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.49batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.58batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 75.55batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.70batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.66batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.57batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 75.61batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.55batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.54batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.63batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.52batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.55batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.54batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.36batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.35batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.42batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.43batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 75.34batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.33batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.18batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.08batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 75.09batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.23batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.20batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.13batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.20batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.14batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.10batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.19batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.17batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.21batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.24batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.18batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.20batch/s]
Validation 37 -> LOSS = 1.34
Validation 37 -> BLEU = 47.48, 71.7/53.5/41.4/32.0 (BP=1.000, ratio=1.001, hyp_len=14394, ref_len=14382)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 38
Epoch 38 - update      17670 => loss:   0.975 (#OOM: 0)
Epoch 38 - update      17700 => loss:   0.742 (#OOM: 0)
Epoch 38 - update      17730 => loss:   0.974 (#OOM: 0)
Epoch 38 - update      17760 => loss:   0.867 (#OOM: 0)
Epoch 38 - update      17790 => loss:   0.655 (#OOM: 0)
Epoch 38 - update      17820 => loss:   0.980 (#OOM: 0)
Epoch 38 - update      17850 => loss:   0.915 (#OOM: 0)
Epoch 38 - update      17880 => loss:   0.893 (#OOM: 0)
Epoch 38 - update      17910 => loss:   1.036 (#OOM: 0)
Epoch 38 - update      17940 => loss:   1.162 (#OOM: 0)
Epoch 38 - update      17970 => loss:   0.972 (#OOM: 0)
Epoch 38 - update      18000 => loss:   0.721 (#OOM: 0)
Epoch 38 - update      18030 => loss:   1.127 (#OOM: 0)
Epoch 38 - update      18060 => loss:   1.205 (#OOM: 0)
Epoch 38 - update      18090 => loss:   0.592 (#OOM: 0)
Epoch 38 - update      18120 => loss:   0.856 (#OOM: 0)
--> Epoch 38 finished with mean loss 0.81472
--> Overhead/Training/Evaluation: 0.02/0.47/0.00 mins (total: 0.49 mins)   (1033 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.03batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.69batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.50batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.05batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.22batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.96batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 78.88batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.41batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 72.60batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 72.43batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 70.57batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 71.18batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 71.42batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 71.87batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 73.08batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.52batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.62batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.58batch/s] 12%|███                        | 117/1014 [00:01<00:12, 73.15batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.27batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.00batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.12batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.66batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.76batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 75.34batch/s] 18%|████▊                      | 182/1014 [00:02<00:11, 74.67batch/s] 19%|█████                      | 192/1014 [00:02<00:11, 74.42batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 74.50batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 74.50batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.20batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 74.63batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 74.99batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.81batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 75.11batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 75.40batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 75.73batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 75.72batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 75.52batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 75.62batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.56batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.69batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.80batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 76.01batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 75.35batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 75.26batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 75.11batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 75.07batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 75.18batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.27batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 75.19batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.11batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 75.05batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.81batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.88batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 75.08batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.96batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 75.17batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 75.25batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 75.42batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 75.40batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 75.26batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 75.11batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 75.22batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 75.23batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 75.26batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 75.36batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 75.39batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 75.46batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.32batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 75.39batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 75.50batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 75.39batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 75.38batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 75.37batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 75.41batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 75.40batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 75.22batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 75.35batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 75.43batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 75.28batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 75.35batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 75.39batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 75.43batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 75.54batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 75.58batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.65batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.66batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 75.77batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 75.85batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.71batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 75.69batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.77batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 75.68batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 75.71batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 75.75batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 75.76batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 75.58batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 75.64batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.57batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.51batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.51batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.45batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.53batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.48batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.48batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 75.41batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.37batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.29batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.43batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.43batch/s]
Validation 38 -> LOSS = 1.34
Validation 38 -> BLEU = 47.55, 71.9/53.6/41.5/32.1 (BP=0.999, ratio=0.999, hyp_len=14364, ref_len=14382)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 47.67 @ validation 30
Starting Epoch 39
Epoch 39 - update      18150 => loss:   0.818 (#OOM: 0)
Epoch 39 - update      18180 => loss:   0.630 (#OOM: 0)
Epoch 39 - update      18210 => loss:   1.112 (#OOM: 0)
Epoch 39 - update      18240 => loss:   1.003 (#OOM: 0)
Epoch 39 - update      18270 => loss:   0.571 (#OOM: 0)
Epoch 39 - update      18300 => loss:   0.720 (#OOM: 0)
Epoch 39 - update      18330 => loss:   1.116 (#OOM: 0)
Epoch 39 - update      18360 => loss:   0.680 (#OOM: 0)
Epoch 39 - update      18390 => loss:   0.627 (#OOM: 0)
Epoch 39 - update      18420 => loss:   0.423 (#OOM: 0)
Epoch 39 - update      18450 => loss:   0.938 (#OOM: 0)
Epoch 39 - update      18480 => loss:   0.701 (#OOM: 0)
Epoch 39 - update      18510 => loss:   0.868 (#OOM: 0)
Epoch 39 - update      18540 => loss:   1.050 (#OOM: 0)
Epoch 39 - update      18570 => loss:   0.771 (#OOM: 0)
Epoch 39 - update      18600 => loss:   0.644 (#OOM: 0)
--> Epoch 39 finished with mean loss 0.81088
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (832 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.78batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.05batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.80batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.62batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.68batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.31batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 69.81batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 68.95batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.61batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 76.63batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 77.21batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 75.87batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 75.34batch/s]  7%|██                          | 74/1014 [00:00<00:12, 77.00batch/s]  8%|██▎                         | 84/1014 [00:01<00:12, 76.44batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 75.68batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 76.37batch/s] 11%|███                        | 114/1014 [00:01<00:11, 75.87batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 76.49batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.82batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 76.43batch/s] 15%|████                       | 154/1014 [00:02<00:11, 76.36batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 76.59batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 76.28batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 76.13batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 75.41batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 75.64batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 75.61batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.47batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.58batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 75.34batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 75.43batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 75.32batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 75.42batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.17batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.29batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.07batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.29batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.03batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 75.51batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 75.65batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 75.97batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 75.63batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 75.69batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 75.85batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.88batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.96batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 76.06batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.97batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 76.10batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 76.19batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 76.52batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 76.38batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 76.03batch/s] 48%|████████████▉              | 484/1014 [00:06<00:06, 76.04batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 76.21batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 76.13batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 76.01batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 76.18batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 76.19batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 76.08batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.95batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.65batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.69batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.75batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.82batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 75.67batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.68batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.77batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.73batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.51batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.52batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.54batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.70batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.82batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.99batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.98batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.83batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.62batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.60batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.58batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 75.37batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.33batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.40batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.41batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.32batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.20batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.10batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.10batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.15batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.17batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.08batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.01batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.07batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.02batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 74.99batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.79batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.74batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.75batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.75batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.88batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.92batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.88batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.77batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.84batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.86batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.81batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.87batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.87batch/s]
Validation 39 -> LOSS = 1.34
Validation 39 -> BLEU = 48.03, 72.4/54.2/42.2/32.8 (BP=0.995, ratio=0.995, hyp_len=14312, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.03 @ validation 39
Starting Epoch 40
Epoch 40 - update      18630 => loss:   0.650 (#OOM: 0)
Epoch 40 - update      18660 => loss:   0.663 (#OOM: 0)
Epoch 40 - update      18690 => loss:   0.561 (#OOM: 0)
Epoch 40 - update      18720 => loss:   0.661 (#OOM: 0)
Epoch 40 - update      18750 => loss:   0.471 (#OOM: 0)
Epoch 40 - update      18780 => loss:   0.791 (#OOM: 0)
Epoch 40 - update      18810 => loss:   0.397 (#OOM: 0)
Epoch 40 - update      18840 => loss:   0.590 (#OOM: 0)
Epoch 40 - update      18870 => loss:   1.169 (#OOM: 0)
Epoch 40 - update      18900 => loss:   0.880 (#OOM: 0)
Epoch 40 - update      18930 => loss:   1.037 (#OOM: 0)
Epoch 40 - update      18960 => loss:   0.773 (#OOM: 0)
Epoch 40 - update      18990 => loss:   0.660 (#OOM: 0)
Epoch 40 - update      19020 => loss:   0.722 (#OOM: 0)
Epoch 40 - update      19050 => loss:   1.220 (#OOM: 0)
Epoch 40 - update      19080 => loss:   0.554 (#OOM: 0)
--> Epoch 40 finished with mean loss 0.80735
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (770 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 55.99batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.09batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.20batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.83batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.28batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.95batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 68.63batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 70.57batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 73.16batch/s]  3%|▊                           | 31/1014 [00:00<00:13, 73.78batch/s]  4%|█                           | 40/1014 [00:00<00:12, 75.48batch/s]  5%|█▎                          | 49/1014 [00:00<00:12, 77.26batch/s]  6%|█▌                          | 58/1014 [00:00<00:12, 78.42batch/s]  7%|█▊                          | 67/1014 [00:00<00:12, 77.04batch/s]  7%|██                          | 76/1014 [00:00<00:12, 77.63batch/s]  8%|██▎                         | 85/1014 [00:01<00:11, 78.49batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 78.23batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 77.63batch/s] 11%|██▉                        | 112/1014 [00:01<00:11, 78.02batch/s] 12%|███▏                       | 121/1014 [00:01<00:11, 77.62batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 78.60batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 78.20batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.88batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.60batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 76.18batch/s] 18%|████▊                      | 181/1014 [00:02<00:10, 76.27batch/s] 19%|█████                      | 191/1014 [00:02<00:10, 75.41batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 75.49batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 75.20batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 75.40batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 75.72batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 75.34batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.78batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 76.01batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 76.49batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 76.51batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 76.25batch/s] 30%|████████                   | 301/1014 [00:03<00:09, 76.34batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 76.03batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 75.86batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 75.66batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 75.93batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 75.86batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 75.97batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 76.07batch/s] 38%|██████████▏                | 381/1014 [00:05<00:08, 76.02batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 76.17batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 76.06batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 76.10batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 76.23batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 76.16batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 75.99batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 76.15batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 76.35batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 76.25batch/s] 47%|████████████▊              | 481/1014 [00:06<00:06, 76.37batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 76.10batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 76.14batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 76.00batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 75.79batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 75.89batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 75.74batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 75.80batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 75.94batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 75.96batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 75.96batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 75.94batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 75.93batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 75.93batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.80batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 75.71batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 75.55batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 75.44batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 75.56batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 75.50batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 75.44batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 75.49batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 75.61batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 75.56batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 75.46batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 75.36batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 75.48batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 75.53batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 75.32batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 75.35batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 75.15batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 75.02batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.95batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 74.90batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 74.99batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 75.04batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 75.03batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 75.02batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 75.07batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 75.21batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 75.19batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 75.13batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 75.15batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 75.12batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 75.13batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 75.20batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 75.15batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 75.23batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 75.23batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 75.28batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 75.36batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.39batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 75.36batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 75.35batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.38batch/s]
Validation 40 -> LOSS = 1.34
Validation 40 -> BLEU = 47.63, 71.8/53.5/41.6/32.3 (BP=0.999, ratio=0.999, hyp_len=14368, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.03 @ validation 39
Starting Epoch 41
Epoch 41 - update      19110 => loss:   0.767 (#OOM: 0)
Epoch 41 - update      19140 => loss:   0.708 (#OOM: 0)
Epoch 41 - update      19170 => loss:   1.115 (#OOM: 0)
Epoch 41 - update      19200 => loss:   0.660 (#OOM: 0)
Epoch 41 - update      19230 => loss:   0.642 (#OOM: 0)
Epoch 41 - update      19260 => loss:   0.722 (#OOM: 0)
Epoch 41 - update      19290 => loss:   0.702 (#OOM: 0)
Epoch 41 - update      19320 => loss:   0.614 (#OOM: 0)
Epoch 41 - update      19350 => loss:   1.071 (#OOM: 0)
Epoch 41 - update      19380 => loss:   0.681 (#OOM: 0)
Epoch 41 - update      19410 => loss:   0.990 (#OOM: 0)
Epoch 41 - update      19440 => loss:   0.865 (#OOM: 0)
Epoch 41 - update      19470 => loss:   0.736 (#OOM: 0)
Epoch 41 - update      19500 => loss:   0.849 (#OOM: 0)
Epoch 41 - update      19530 => loss:   0.922 (#OOM: 0)
--> Epoch 41 finished with mean loss 0.80437
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.62 mins)   (826 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.17batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.87batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.39batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.76batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.06batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.91batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.05batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 79.73batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 78.12batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 78.87batch/s]  5%|█▎                          | 46/1014 [00:00<00:11, 80.92batch/s]  6%|█▌                          | 56/1014 [00:00<00:11, 81.01batch/s]  7%|█▊                          | 66/1014 [00:00<00:11, 80.43batch/s]  7%|██                          | 76/1014 [00:00<00:11, 79.02batch/s]  8%|██▎                         | 86/1014 [00:01<00:11, 78.77batch/s]  9%|██▋                         | 96/1014 [00:01<00:11, 77.87batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 77.43batch/s] 11%|███                        | 116/1014 [00:01<00:11, 77.46batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 77.19batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 78.32batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 78.09batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 78.39batch/s] 16%|████▍                      | 166/1014 [00:02<00:10, 77.98batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 77.37batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 77.64batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 77.49batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 77.43batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 77.28batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 76.90batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 76.98batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 76.69batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 76.60batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 76.34batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 76.62batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 76.54batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 76.09batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 76.18batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 76.17batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 76.19batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 76.12batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 75.88batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.85batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 75.68batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.61batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.80batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 76.02batch/s] 40%|██████████▊                | 406/1014 [00:05<00:07, 76.23batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 75.97batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 76.04batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 75.99batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 76.01batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 75.88batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.92batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 76.07batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 76.10batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 76.01batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 75.94batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.98batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 76.06batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.86batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.85batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.87batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.92batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.80batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.76batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.60batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 75.60batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 75.39batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.37batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 75.16batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.21batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.20batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.40batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 75.16batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.13batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.13batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.08batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.24batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.26batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.28batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.26batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.21batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.28batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 75.23batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 75.24batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 75.30batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.29batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 75.32batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.31batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 75.25batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 75.15batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 75.27batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.28batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 75.23batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.31batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 75.33batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 75.37batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.37batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.48batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.47batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.48batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.45batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.51batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.43batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 75.48batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 75.32batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.32batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.43batch/s]
Validation 41 -> LOSS = 1.34
Validation 41 -> BLEU = 47.48, 71.8/53.3/41.3/32.1 (BP=1.000, ratio=1.000, hyp_len=14384, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.03 @ validation 39
Starting Epoch 42
Epoch 42 - update      19560 => loss:   0.560 (#OOM: 0)
Epoch 42 - update      19590 => loss:   0.987 (#OOM: 0)
Epoch 42 - update      19620 => loss:   0.658 (#OOM: 0)
Epoch 42 - update      19650 => loss:   0.541 (#OOM: 0)
Epoch 42 - update      19680 => loss:   0.647 (#OOM: 0)
Epoch 42 - update      19710 => loss:   0.554 (#OOM: 0)
Epoch 42 - update      19740 => loss:   0.607 (#OOM: 0)
Epoch 42 - update      19770 => loss:   0.826 (#OOM: 0)
Epoch 42 - update      19800 => loss:   0.733 (#OOM: 0)
Epoch 42 - update      19830 => loss:   0.930 (#OOM: 0)
Epoch 42 - update      19860 => loss:   0.978 (#OOM: 0)
Epoch 42 - update      19890 => loss:   0.670 (#OOM: 0)
Epoch 42 - update      19920 => loss:   0.622 (#OOM: 0)
Epoch 42 - update      19950 => loss:   0.784 (#OOM: 0)
Epoch 42 - update      19980 => loss:   0.757 (#OOM: 0)
Epoch 42 - update      20010 => loss:   0.344 (#OOM: 0)
--> Epoch 42 finished with mean loss 0.80179
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (893 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.21batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.23batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.30batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.88batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.93batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.28batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.25batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 82.49batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.31batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.73batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 78.55batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.23batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.02batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.14batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 78.10batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 77.96batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 76.17batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.72batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 75.96batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.99batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.69batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 75.70batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.27batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.40batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 75.33batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 74.78batch/s] 18%|████▊                      | 183/1014 [00:02<00:11, 74.74batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 75.26batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.91batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.88batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 74.90batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.96batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.73batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 75.16batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 75.42batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 75.19batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 75.23batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.12batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.87batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 75.21batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 74.74batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.52batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 74.92batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 74.94batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 75.15batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 75.19batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.99batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 75.23batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.38batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 75.10batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.20batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.39batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.63batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 75.48batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 75.40batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.29batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 75.29batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.38batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.40batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.24batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.14batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.11batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.35batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.24batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 75.04batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.27batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.08batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.24batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 75.21batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.35batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.26batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.06batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 74.84batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 74.57batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.64batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.63batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 74.79batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.92batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 74.92batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 75.08batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.15batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.18batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.13batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 74.97batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 74.99batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.99batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.03batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.11batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.27batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.16batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.28batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.32batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.33batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.33batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 75.29batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.31batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.27batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.27batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.42batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.39batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.42batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.40batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.34batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.39batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.48batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.34batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.23batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.28batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.19batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.21batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.22batch/s]
Validation 42 -> LOSS = 1.34
Validation 42 -> BLEU = 47.76, 71.8/53.7/41.7/32.4 (BP=1.000, ratio=1.002, hyp_len=14413, ref_len=14382)
** Learning rate changed -> 2.5e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.03 @ validation 39
Starting Epoch 43
Epoch 43 - update      20040 => loss:   1.010 (#OOM: 0)
Epoch 43 - update      20070 => loss:   0.698 (#OOM: 0)
Epoch 43 - update      20100 => loss:   0.600 (#OOM: 0)
Epoch 43 - update      20130 => loss:   0.946 (#OOM: 0)
Epoch 43 - update      20160 => loss:   0.871 (#OOM: 0)
Epoch 43 - update      20190 => loss:   0.626 (#OOM: 0)
Epoch 43 - update      20220 => loss:   0.875 (#OOM: 0)
Epoch 43 - update      20250 => loss:   0.721 (#OOM: 0)
Epoch 43 - update      20280 => loss:   0.382 (#OOM: 0)
Epoch 43 - update      20310 => loss:   0.611 (#OOM: 0)
Epoch 43 - update      20340 => loss:   0.585 (#OOM: 0)
Epoch 43 - update      20370 => loss:   0.881 (#OOM: 0)
Epoch 43 - update      20400 => loss:   0.784 (#OOM: 0)
Epoch 43 - update      20430 => loss:   0.893 (#OOM: 0)
Epoch 43 - update      20460 => loss:   0.549 (#OOM: 0)
Epoch 43 - update      20490 => loss:   0.706 (#OOM: 0)
--> Epoch 43 finished with mean loss 0.79370
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (822 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.14batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.80batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 53.12batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.20batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.71batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.66batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.63batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 80.06batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.29batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 82.98batch/s]  4%|█                           | 38/1014 [00:00<00:12, 76.53batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 75.27batch/s]  6%|█▌                          | 58/1014 [00:00<00:12, 75.24batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 75.20batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 75.26batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 75.51batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 76.07batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 75.09batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 76.31batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 76.35batch/s] 14%|███▋                       | 138/1014 [00:01<00:11, 76.70batch/s] 15%|███▉                       | 148/1014 [00:01<00:11, 76.83batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 77.01batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 76.76batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 75.95batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 76.43batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 76.52batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 77.07batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 77.09batch/s] 22%|██████                     | 228/1014 [00:02<00:10, 77.18batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 77.01batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 76.86batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 76.94batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 76.86batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.79batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 76.86batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 77.05batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 76.82batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 76.57batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 76.81batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 76.61batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 76.62batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 76.82batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 76.46batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 76.60batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 76.34batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 76.49batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 76.69batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 77.02batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 76.63batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 76.76batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 76.86batch/s] 45%|████████████▏              | 458/1014 [00:05<00:07, 76.81batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 77.02batch/s] 47%|████████████▋              | 478/1014 [00:06<00:06, 77.14batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 77.03batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.84batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 76.91batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.92batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 76.95batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:06, 77.00batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 76.95batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 76.74batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 76.85batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 76.93batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 76.78batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 76.70batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.83batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 76.73batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 76.77batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 76.75batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 76.49batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 76.30batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 76.28batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 76.27batch/s] 68%|██████████████████▎        | 688/1014 [00:08<00:04, 76.51batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 76.54batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:03, 76.59batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 76.63batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 76.40batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 76.22batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 76.22batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 76.33batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 76.09batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.97batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 75.94batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.82batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.65batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.61batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 75.65batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.77batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.87batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.91batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.81batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.82batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.75batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.66batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 75.61batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.56batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.58batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.53batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.52batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.45batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.32batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.45batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.48batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.56batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.56batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.46batch/s]
Validation 43 -> LOSS = 1.34
Validation 43 -> BLEU = 47.53, 71.8/53.6/41.6/32.2 (BP=0.998, ratio=0.998, hyp_len=14348, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.03 @ validation 39
Starting Epoch 44
Epoch 44 - update      20520 => loss:   0.340 (#OOM: 0)
Epoch 44 - update      20550 => loss:   0.817 (#OOM: 0)
Epoch 44 - update      20580 => loss:   1.133 (#OOM: 0)
Epoch 44 - update      20610 => loss:   0.630 (#OOM: 0)
Epoch 44 - update      20640 => loss:   0.985 (#OOM: 0)
Epoch 44 - update      20670 => loss:   0.701 (#OOM: 0)
Epoch 44 - update      20700 => loss:   0.898 (#OOM: 0)
Epoch 44 - update      20730 => loss:   0.609 (#OOM: 0)
Epoch 44 - update      20760 => loss:   0.882 (#OOM: 0)
Epoch 44 - update      20790 => loss:   0.594 (#OOM: 0)
Epoch 44 - update      20820 => loss:   0.805 (#OOM: 0)
Epoch 44 - update      20850 => loss:   0.810 (#OOM: 0)
Epoch 44 - update      20880 => loss:   0.586 (#OOM: 0)
Epoch 44 - update      20910 => loss:   0.780 (#OOM: 0)
Epoch 44 - update      20940 => loss:   0.665 (#OOM: 0)
Epoch 44 - update      20970 => loss:   0.826 (#OOM: 0)
--> Epoch 44 finished with mean loss 0.79433
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (760 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.11batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.24batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 50.87batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.22batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 52.42batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.76batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.04batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.69batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 71.10batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.77batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 69.61batch/s]  4%|█                           | 40/1014 [00:00<00:13, 71.06batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 70.13batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 69.98batch/s]  6%|█▊                          | 64/1014 [00:00<00:13, 70.08batch/s]  7%|██                          | 73/1014 [00:01<00:13, 71.46batch/s]  8%|██▎                         | 82/1014 [00:01<00:12, 72.47batch/s]  9%|██▌                         | 91/1014 [00:01<00:12, 73.15batch/s] 10%|██▋                        | 100/1014 [00:01<00:12, 73.93batch/s] 11%|██▉                        | 109/1014 [00:01<00:12, 72.60batch/s] 12%|███▏                       | 118/1014 [00:01<00:12, 72.86batch/s] 13%|███▍                       | 127/1014 [00:01<00:12, 73.50batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 73.29batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 74.07batch/s] 15%|████                       | 154/1014 [00:02<00:11, 73.74batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 73.91batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 74.29batch/s] 18%|████▊                      | 181/1014 [00:02<00:11, 73.97batch/s] 19%|█████                      | 190/1014 [00:02<00:11, 73.97batch/s] 20%|█████▎                     | 199/1014 [00:02<00:11, 73.65batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 73.47batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 73.22batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 73.70batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 73.87batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 74.14batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 74.15batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 74.37batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 74.55batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 74.90batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 74.98batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 74.91batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 75.06batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.51batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 75.30batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 74.95batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 74.98batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.73batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.80batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.84batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.96batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 75.22batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 75.42batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 75.19batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 75.13batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 75.28batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 75.10batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.08batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 75.05batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.91batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 74.78batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.54batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 74.58batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 74.40batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 74.43batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 74.76batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 74.63batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 74.67batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 74.69batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 74.79batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 74.86batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 74.80batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 74.77batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 74.75batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 74.88batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 74.82batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 74.83batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.88batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 74.96batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 75.03batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.11batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.15batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.28batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.29batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.30batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.29batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.39batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 75.27batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.21batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.26batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 75.13batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.15batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.06batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.95batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 75.05batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.09batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.08batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 74.99batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.02batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.00batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 74.91batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.02batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.92batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.84batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.78batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.93batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.00batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.06batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.19batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 75.18batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.25batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.08batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.10batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.10batch/s]
Validation 44 -> LOSS = 1.34
Validation 44 -> BLEU = 47.99, 72.1/53.9/41.9/32.6 (BP=1.000, ratio=1.002, hyp_len=14404, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.03 @ validation 39
Starting Epoch 45
Epoch 45 - update      21000 => loss:   0.568 (#OOM: 0)
Epoch 45 - update      21030 => loss:   0.487 (#OOM: 0)
Epoch 45 - update      21060 => loss:   0.581 (#OOM: 0)
Epoch 45 - update      21090 => loss:   0.951 (#OOM: 0)
Epoch 45 - update      21120 => loss:   0.522 (#OOM: 0)
Epoch 45 - update      21150 => loss:   0.548 (#OOM: 0)
Epoch 45 - update      21180 => loss:   0.725 (#OOM: 0)
Epoch 45 - update      21210 => loss:   0.724 (#OOM: 0)
Epoch 45 - update      21240 => loss:   0.789 (#OOM: 0)
Epoch 45 - update      21270 => loss:   0.574 (#OOM: 0)
Epoch 45 - update      21300 => loss:   0.683 (#OOM: 0)
Epoch 45 - update      21330 => loss:   1.037 (#OOM: 0)
Epoch 45 - update      21360 => loss:   1.057 (#OOM: 0)
Epoch 45 - update      21390 => loss:   0.892 (#OOM: 0)
Epoch 45 - update      21420 => loss:   0.849 (#OOM: 0)
Epoch 45 - update      21450 => loss:   0.860 (#OOM: 0)
--> Epoch 45 finished with mean loss 0.79074
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.60 mins)   (852 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.42batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 49.41batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 51.05batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 52.81batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 51.30batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 50.73batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.51batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 69.92batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.70batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 73.21batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 75.93batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 76.29batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 76.23batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 75.86batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 75.56batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 76.20batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 75.60batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 75.89batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 75.71batch/s] 11%|███                        | 114/1014 [00:01<00:11, 75.82batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.51batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 75.51batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 75.69batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 75.85batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 75.77batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.62batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 75.36batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 75.02batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 74.56batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 74.28batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.20batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.14batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 74.16batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 74.07batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 73.99batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 74.03batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 74.12batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 74.42batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.70batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 74.74batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.74batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 74.93batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 74.88batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 74.97batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 74.74batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 74.21batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.25batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 74.30batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.68batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.68batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.94batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 74.85batch/s] 41%|███████████                | 416/1014 [00:05<00:08, 74.73batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 74.78batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 74.75batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 74.93batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 74.94batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 74.82batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 74.70batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.41batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 74.42batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 74.67batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 74.75batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 75.01batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.00batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 74.83batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 74.98batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 74.81batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.88batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.10batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.16batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.84batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.92batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 74.80batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.89batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.03batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.06batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.93batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 75.10batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.09batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.11batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.16batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.12batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.12batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.00batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.07batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.03batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.18batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 75.13batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 75.07batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 75.04batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.05batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 75.24batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.21batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 75.17batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 75.04batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.98batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.13batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 75.19batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.16batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 75.12batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 75.12batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.13batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.07batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.05batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.22batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.21batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.22batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.09batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 75.13batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 75.12batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.11batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.06batch/s]
Validation 45 -> LOSS = 1.34
Validation 45 -> BLEU = 48.14, 72.2/54.1/42.1/32.8 (BP=0.999, ratio=0.999, hyp_len=14364, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.14 @ validation 45
Starting Epoch 46
Epoch 46 - update      21480 => loss:   0.520 (#OOM: 0)
Epoch 46 - update      21510 => loss:   0.920 (#OOM: 0)
Epoch 46 - update      21540 => loss:   0.524 (#OOM: 0)
Epoch 46 - update      21570 => loss:   1.101 (#OOM: 0)
Epoch 46 - update      21600 => loss:   0.602 (#OOM: 0)
Epoch 46 - update      21630 => loss:   0.747 (#OOM: 0)
Epoch 46 - update      21660 => loss:   0.630 (#OOM: 0)
Epoch 46 - update      21690 => loss:   0.860 (#OOM: 0)
Epoch 46 - update      21720 => loss:   1.100 (#OOM: 0)
Epoch 46 - update      21750 => loss:   0.867 (#OOM: 0)
Epoch 46 - update      21780 => loss:   0.616 (#OOM: 0)
Epoch 46 - update      21810 => loss:   0.943 (#OOM: 0)
Epoch 46 - update      21840 => loss:   0.639 (#OOM: 0)
Epoch 46 - update      21870 => loss:   0.896 (#OOM: 0)
Epoch 46 - update      21900 => loss:   0.714 (#OOM: 0)
Epoch 46 - update      21930 => loss:   0.733 (#OOM: 0)
--> Epoch 46 finished with mean loss 0.79015
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (817 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.51batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 46.66batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 47.27batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 48.03batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.94batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.25batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 77.53batch/s]  2%|▌                           | 19/1014 [00:00<00:11, 85.78batch/s]  3%|▊                           | 29/1014 [00:00<00:11, 83.18batch/s]  4%|█                           | 39/1014 [00:00<00:12, 80.27batch/s]  5%|█▎                          | 49/1014 [00:00<00:12, 76.98batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 77.09batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 77.44batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 76.50batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 76.82batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.59batch/s] 11%|██▉                        | 109/1014 [00:01<00:11, 76.50batch/s] 12%|███▏                       | 119/1014 [00:01<00:11, 75.65batch/s] 13%|███▍                       | 129/1014 [00:01<00:11, 75.42batch/s] 14%|███▋                       | 139/1014 [00:01<00:11, 75.19batch/s] 15%|███▉                       | 149/1014 [00:01<00:11, 75.27batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 75.57batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 75.76batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.49batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.75batch/s] 20%|█████▎                     | 199/1014 [00:02<00:10, 75.23batch/s] 21%|█████▌                     | 209/1014 [00:02<00:10, 75.76batch/s] 22%|█████▊                     | 219/1014 [00:02<00:10, 76.06batch/s] 23%|██████                     | 229/1014 [00:03<00:10, 76.28batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 76.04batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 76.17batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 76.49batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 76.87batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 77.07batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 77.04batch/s] 29%|███████▉                   | 299/1014 [00:03<00:09, 77.12batch/s] 30%|████████▏                  | 309/1014 [00:04<00:09, 77.04batch/s] 31%|████████▍                  | 319/1014 [00:04<00:09, 76.85batch/s] 32%|████████▊                  | 329/1014 [00:04<00:08, 76.97batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 76.90batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 77.14batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 77.00batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 77.18batch/s] 37%|██████████                 | 379/1014 [00:04<00:08, 77.34batch/s] 38%|██████████▎                | 389/1014 [00:05<00:08, 76.99batch/s] 39%|██████████▌                | 399/1014 [00:05<00:07, 77.03batch/s] 40%|██████████▉                | 409/1014 [00:05<00:07, 76.79batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 76.88batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 76.81batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 76.93batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 77.04batch/s] 45%|████████████▏              | 459/1014 [00:05<00:07, 77.19batch/s] 46%|████████████▍              | 469/1014 [00:06<00:07, 77.08batch/s] 47%|████████████▊              | 479/1014 [00:06<00:06, 77.05batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 76.92batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 77.03batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 76.60batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 76.49batch/s] 52%|██████████████             | 529/1014 [00:06<00:06, 76.44batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 76.57batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 76.58batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:05, 76.63batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 76.64batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 76.69batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 76.62batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 76.63batch/s] 60%|████████████████▏          | 609/1014 [00:07<00:05, 76.53batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 76.33batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 76.21batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 76.28batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 76.29batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 76.09batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 75.79batch/s] 67%|██████████████████         | 679/1014 [00:08<00:04, 75.90batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 76.01batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 76.07batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 76.11batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 76.16batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 76.12batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 76.15batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 76.15batch/s] 75%|████████████████████▏      | 759/1014 [00:09<00:03, 75.96batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 75.99batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 75.89batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:02, 75.94batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 76.08batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 76.06batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 76.06batch/s] 82%|██████████████████████     | 829/1014 [00:10<00:02, 76.02batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 75.97batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 76.02batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 75.79batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 75.85batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 75.79batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 75.71batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 75.73batch/s] 90%|████████████████████████▏  | 909/1014 [00:11<00:01, 75.86batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 75.90batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 75.91batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:00, 75.89batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 75.89batch/s] 95%|█████████████████████████▌ | 959/1014 [00:12<00:00, 75.85batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 75.73batch/s] 97%|██████████████████████████ | 979/1014 [00:12<00:00, 75.66batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 75.63batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 75.70batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 75.74batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.75batch/s]
Validation 46 -> LOSS = 1.34
Validation 46 -> BLEU = 47.70, 72.0/53.7/41.6/32.2 (BP=1.000, ratio=1.000, hyp_len=14377, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.14 @ validation 45
Starting Epoch 47
Epoch 47 - update      21960 => loss:   0.528 (#OOM: 0)
Epoch 47 - update      21990 => loss:   0.992 (#OOM: 0)
Epoch 47 - update      22020 => loss:   0.792 (#OOM: 0)
Epoch 47 - update      22050 => loss:   0.880 (#OOM: 0)
Epoch 47 - update      22080 => loss:   1.142 (#OOM: 0)
Epoch 47 - update      22110 => loss:   0.841 (#OOM: 0)
Epoch 47 - update      22140 => loss:   0.958 (#OOM: 0)
Epoch 47 - update      22170 => loss:   0.650 (#OOM: 0)
Epoch 47 - update      22200 => loss:   0.883 (#OOM: 0)
Epoch 47 - update      22230 => loss:   0.583 (#OOM: 0)
Epoch 47 - update      22260 => loss:   0.613 (#OOM: 0)
Epoch 47 - update      22290 => loss:   0.703 (#OOM: 0)
Epoch 47 - update      22320 => loss:   0.852 (#OOM: 0)
Epoch 47 - update      22350 => loss:   0.662 (#OOM: 0)
Epoch 47 - update      22380 => loss:   1.171 (#OOM: 0)
Epoch 47 - update      22410 => loss:   0.568 (#OOM: 0)
--> Epoch 47 finished with mean loss 0.78866
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.62 mins)   (823 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.64batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.68batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.15batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.73batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.79batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 80.04batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.16batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 75.69batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 74.90batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 76.03batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 75.75batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.51batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 75.66batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.39batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.48batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.10batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.65batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.01batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.22batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.03batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.31batch/s] 15%|████                       | 153/1014 [00:02<00:11, 72.87batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.24batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.73batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 73.74batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.98batch/s] 20%|█████▎                     | 199/1014 [00:02<00:10, 74.56batch/s] 21%|█████▌                     | 209/1014 [00:02<00:10, 74.81batch/s] 22%|█████▊                     | 219/1014 [00:02<00:10, 75.46batch/s] 23%|██████                     | 229/1014 [00:03<00:10, 75.51batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 75.29batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 75.48batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 75.25batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.29batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.49batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 75.48batch/s] 29%|███████▉                   | 299/1014 [00:03<00:09, 75.50batch/s] 30%|████████▏                  | 309/1014 [00:04<00:09, 75.35batch/s] 31%|████████▍                  | 319/1014 [00:04<00:09, 74.74batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 74.72batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 74.70batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 74.92batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 74.63batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 74.73batch/s] 37%|██████████                 | 379/1014 [00:05<00:08, 74.70batch/s] 38%|██████████▎                | 389/1014 [00:05<00:08, 74.98batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 75.03batch/s] 40%|██████████▉                | 409/1014 [00:05<00:08, 75.19batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 75.01batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 75.09batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 75.19batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 75.14batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 75.16batch/s] 46%|████████████▍              | 469/1014 [00:06<00:07, 74.86batch/s] 47%|████████████▊              | 479/1014 [00:06<00:07, 75.09batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 75.28batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 75.24batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 75.20batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 75.23batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 75.35batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 75.26batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 75.15batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:06, 75.08batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 75.09batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 75.15batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 75.10batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 74.99batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 74.86batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 74.90batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 74.85batch/s] 63%|█████████████████          | 639/1014 [00:08<00:05, 74.88batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 75.05batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 75.08batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 74.95batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 74.89batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 74.94batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 74.84batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 74.62batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 74.73batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 74.64batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 74.66batch/s] 74%|███████████████████▉       | 749/1014 [00:10<00:03, 74.57batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 74.41batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 74.14batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 74.10batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 74.15batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 74.12batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 74.10batch/s] 81%|█████████████████████▊     | 819/1014 [00:11<00:02, 74.14batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 74.06batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 74.17batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 74.14batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 74.14batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 74.17batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 74.24batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 74.28batch/s] 89%|███████████████████████▉   | 899/1014 [00:12<00:01, 74.40batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 74.31batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 74.23batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 74.19batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:01, 74.15batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 74.14batch/s] 95%|█████████████████████████▌ | 959/1014 [00:12<00:00, 74.15batch/s] 96%|█████████████████████████▊ | 969/1014 [00:13<00:00, 74.28batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 74.40batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 74.46batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 74.50batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 74.46batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.47batch/s]
Validation 47 -> LOSS = 1.34
Validation 47 -> BLEU = 47.80, 71.9/53.8/41.7/32.4 (BP=1.000, ratio=1.006, hyp_len=14469, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.14 @ validation 45
Starting Epoch 48
Epoch 48 - update      22440 => loss:   0.716 (#OOM: 0)
Epoch 48 - update      22470 => loss:   0.676 (#OOM: 0)
Epoch 48 - update      22500 => loss:   0.562 (#OOM: 0)
Epoch 48 - update      22530 => loss:   1.069 (#OOM: 0)
Epoch 48 - update      22560 => loss:   0.730 (#OOM: 0)
Epoch 48 - update      22590 => loss:   0.670 (#OOM: 0)
Epoch 48 - update      22620 => loss:   0.767 (#OOM: 0)
Epoch 48 - update      22650 => loss:   1.015 (#OOM: 0)
Epoch 48 - update      22680 => loss:   0.857 (#OOM: 0)
Epoch 48 - update      22710 => loss:   0.616 (#OOM: 0)
Epoch 48 - update      22740 => loss:   0.763 (#OOM: 0)
Epoch 48 - update      22770 => loss:   0.676 (#OOM: 0)
Epoch 48 - update      22800 => loss:   0.642 (#OOM: 0)
Epoch 48 - update      22830 => loss:   0.999 (#OOM: 0)
Epoch 48 - update      22860 => loss:   0.637 (#OOM: 0)
Epoch 48 - update      22890 => loss:   0.990 (#OOM: 0)
--> Epoch 48 finished with mean loss 0.78798
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (770 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.31batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 57.04batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.40batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 50.31batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.70batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.76batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 83.05batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 77.76batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.71batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 77.41batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.38batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 80.07batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 79.73batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 80.26batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 80.92batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 80.74batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 80.61batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 80.15batch/s] 12%|███                        | 117/1014 [00:01<00:11, 80.08batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 79.76batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 78.55batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 78.58batch/s] 15%|████                       | 153/1014 [00:01<00:10, 78.44batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 78.26batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 77.93batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 77.74batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 77.32batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 77.15batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 76.76batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.25batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 76.38batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 76.70batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 76.55batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 76.76batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 76.27batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 76.21batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 76.07batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.83batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.87batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 76.00batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.93batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.58batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 75.36batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.42batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 75.34batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 75.17batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 75.24batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 75.37batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.26batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.43batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.43batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.41batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.56batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.71batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 75.68batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 75.70batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 75.80batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.93batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 75.75batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 75.74batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.83batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.99batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.93batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 76.08batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 75.98batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.12batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 76.11batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 76.00batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.80batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.62batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.71batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.67batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 75.66batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.74batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.78batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.59batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 75.52batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.65batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 75.87batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 76.02batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 76.11batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 76.08batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 75.99batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 75.90batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 75.87batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 75.90batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.86batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 75.72batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 75.69batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 75.64batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.53batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 75.52batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.64batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.46batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.38batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 75.25batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.40batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.34batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.36batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.38batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.37batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.45batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.39batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 75.31batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.37batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.39batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.27batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.21batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.23batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.33batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.36batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.34batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.41batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.47batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.44batch/s]
Validation 48 -> LOSS = 1.34
Validation 48 -> BLEU = 47.99, 72.4/54.1/42.0/32.7 (BP=0.996, ratio=0.996, hyp_len=14328, ref_len=14382)
** Learning rate changed -> 1.25e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.14 @ validation 45
Starting Epoch 49
Epoch 49 - update      22920 => loss:   0.636 (#OOM: 0)
Epoch 49 - update      22950 => loss:   1.063 (#OOM: 0)
Epoch 49 - update      22980 => loss:   0.633 (#OOM: 0)
Epoch 49 - update      23010 => loss:   0.649 (#OOM: 0)
Epoch 49 - update      23040 => loss:   0.878 (#OOM: 0)
Epoch 49 - update      23070 => loss:   0.647 (#OOM: 0)
Epoch 49 - update      23100 => loss:   0.561 (#OOM: 0)
Epoch 49 - update      23130 => loss:   0.767 (#OOM: 0)
Epoch 49 - update      23160 => loss:   0.782 (#OOM: 0)
Epoch 49 - update      23190 => loss:   0.773 (#OOM: 0)
Epoch 49 - update      23220 => loss:   0.936 (#OOM: 0)
Epoch 49 - update      23250 => loss:   1.014 (#OOM: 0)
Epoch 49 - update      23280 => loss:   0.952 (#OOM: 0)
Epoch 49 - update      23310 => loss:   0.892 (#OOM: 0)
Epoch 49 - update      23340 => loss:   0.932 (#OOM: 0)
Epoch 49 - update      23370 => loss:   0.858 (#OOM: 0)
--> Epoch 49 finished with mean loss 0.78539
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (775 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.75batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.85batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.25batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.13batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.67batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.19batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.88batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.94batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.92batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 75.17batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 73.83batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.80batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 72.82batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 72.00batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 72.87batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 72.96batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 72.82batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 72.79batch/s] 11%|███                        | 115/1014 [00:01<00:12, 73.40batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 74.26batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 74.28batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 73.77batch/s] 15%|████                       | 151/1014 [00:02<00:11, 73.86batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 73.93batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 73.96batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 73.69batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 73.75batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 73.74batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.08batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 73.84batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 74.09batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 74.17batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.51batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 74.66batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 74.42batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 74.71batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.63batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.47batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.57batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.03batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.01batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 75.07batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 75.43batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 75.52batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 75.28batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.03batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.93batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.93batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.68batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.55batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 74.62batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 74.71batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.01batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 74.78batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 74.79batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.94batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 74.89batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 74.74batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.79batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 74.77batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 74.39batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 74.43batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 74.29batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 74.36batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 74.17batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 74.33batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.34batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.31batch/s] 59%|███████████████▊           | 595/1014 [00:08<00:05, 74.30batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 74.38batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 74.25batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 74.15batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 73.96batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.06batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.09batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.03batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 73.97batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.07batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.07batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.12batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 74.18batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.15batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.12batch/s] 73%|███████████████████▊       | 745/1014 [00:10<00:03, 74.17batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.28batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.40batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.46batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.52batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.55batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.52batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.50batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.49batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.59batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.61batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.76batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 74.69batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.61batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.61batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 74.69batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.61batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.65batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.56batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.59batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.62batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.70batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.80batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.75batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.81batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.85batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.85batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.82batch/s]
Validation 49 -> LOSS = 1.34
Validation 49 -> BLEU = 47.95, 72.0/53.9/41.8/32.5 (BP=1.000, ratio=1.002, hyp_len=14414, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.14 @ validation 45
Starting Epoch 50
Epoch 50 - update      23400 => loss:   0.789 (#OOM: 0)
Epoch 50 - update      23430 => loss:   0.751 (#OOM: 0)
Epoch 50 - update      23460 => loss:   0.820 (#OOM: 0)
Epoch 50 - update      23490 => loss:   0.642 (#OOM: 0)
Epoch 50 - update      23520 => loss:   0.679 (#OOM: 0)
Epoch 50 - update      23550 => loss:   0.701 (#OOM: 0)
Epoch 50 - update      23580 => loss:   0.725 (#OOM: 0)
Epoch 50 - update      23610 => loss:   0.885 (#OOM: 0)
Epoch 50 - update      23640 => loss:   0.661 (#OOM: 0)
Epoch 50 - update      23670 => loss:   0.444 (#OOM: 0)
Epoch 50 - update      23700 => loss:   0.786 (#OOM: 0)
Epoch 50 - update      23730 => loss:   0.716 (#OOM: 0)
Epoch 50 - update      23760 => loss:   0.672 (#OOM: 0)
Epoch 50 - update      23790 => loss:   0.685 (#OOM: 0)
Epoch 50 - update      23820 => loss:   0.759 (#OOM: 0)
Epoch 50 - update      23850 => loss:   0.751 (#OOM: 0)
--> Epoch 50 finished with mean loss 0.78372
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (800 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.29batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.75batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.37batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.58batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 51.58batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.93batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.04batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 78.59batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 80.13batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 80.42batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 80.77batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 78.30batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 77.18batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 77.64batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 77.89batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 76.98batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 77.34batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 76.70batch/s] 11%|███                        | 116/1014 [00:01<00:11, 75.29batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 75.09batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.87batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 76.44batch/s] 15%|████                       | 152/1014 [00:01<00:11, 76.32batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.37batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.30batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 76.55batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.98batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.72batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.86batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.13batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.85batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.81batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.33batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.29batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 75.10batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.06batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 74.78batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.83batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.97batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.17batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.29batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.28batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 75.67batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 75.67batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 75.88batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 76.05batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 75.86batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 75.74batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 75.79batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.54batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.61batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.60batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.49batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.58batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 75.50batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 75.54batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.52batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 75.50batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.34batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.35batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.27batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.46batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.58batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.49batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.39batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 75.42batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.38batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.34batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.27batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 75.24batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.49batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.33batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.28batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.24batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.33batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.54batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.49batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.50batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.39batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.45batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 75.34batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.25batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.19batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.30batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 75.30batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.33batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.20batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.00batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.06batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 74.92batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 74.98batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 74.87batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.91batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.81batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.88batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 74.99batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.02batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.09batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.15batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 75.05batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.24batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.09batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.04batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.03batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.10batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 75.11batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 75.20batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.23batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.20batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.32batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.31batch/s]
Validation 50 -> LOSS = 1.34
Validation 50 -> BLEU = 48.19, 72.4/54.3/42.2/32.8 (BP=0.999, ratio=0.999, hyp_len=14361, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.19 @ validation 50
Starting Epoch 51
Epoch 51 - update      23880 => loss:   0.659 (#OOM: 0)
Epoch 51 - update      23910 => loss:   0.603 (#OOM: 0)
Epoch 51 - update      23940 => loss:   0.644 (#OOM: 0)
Epoch 51 - update      23970 => loss:   0.853 (#OOM: 0)
Epoch 51 - update      24000 => loss:   0.467 (#OOM: 0)
Epoch 51 - update      24030 => loss:   0.684 (#OOM: 0)
Epoch 51 - update      24060 => loss:   0.558 (#OOM: 0)
Epoch 51 - update      24090 => loss:   0.469 (#OOM: 0)
Epoch 51 - update      24120 => loss:   0.505 (#OOM: 0)
Epoch 51 - update      24150 => loss:   0.560 (#OOM: 0)
Epoch 51 - update      24180 => loss:   0.729 (#OOM: 0)
Epoch 51 - update      24210 => loss:   0.872 (#OOM: 0)
Epoch 51 - update      24240 => loss:   0.671 (#OOM: 0)
Epoch 51 - update      24270 => loss:   0.531 (#OOM: 0)
Epoch 51 - update      24300 => loss:   0.569 (#OOM: 0)
--> Epoch 51 finished with mean loss 0.77941
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (772 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.44batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.60batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.03batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.45batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 52.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.98batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 80.11batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.63batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.63batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 74.26batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 72.26batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 73.88batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 72.71batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 71.29batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 72.32batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 71.99batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 72.49batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 72.81batch/s] 12%|███                        | 117/1014 [00:01<00:12, 72.63batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.36batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 72.21batch/s] 14%|███▊                       | 144/1014 [00:01<00:12, 72.11batch/s] 15%|████                       | 153/1014 [00:02<00:11, 72.68batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.27batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 74.12batch/s] 18%|████▊                      | 182/1014 [00:02<00:11, 74.04batch/s] 19%|█████                      | 192/1014 [00:02<00:11, 74.52batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 75.02batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 75.17batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.64batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.80batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.85batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 75.72batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 76.16batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 76.27batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 76.09batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 76.01batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 76.22batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 76.17batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.88batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 75.81batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.99batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 75.77batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 75.81batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 75.90batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 76.05batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 75.92batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 75.81batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.57batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 75.43batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.11batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 75.13batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.92batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 75.00batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 75.06batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 75.35batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 75.26batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 75.21batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 75.18batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 75.26batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 75.28batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 75.08batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 74.99batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 74.97batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.83batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.94batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 75.03batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.88batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.80batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 74.72batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 74.68batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 74.58batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 74.68batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 74.63batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 74.85batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.86batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 74.93batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 75.03batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 75.06batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 74.95batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 74.86batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 74.86batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 74.94batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.96batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.94batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.03batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.18batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 75.26batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 75.24batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.32batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 75.33batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.34batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 75.49batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 75.55batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 75.47batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 75.54batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 75.54batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 75.63batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.73batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.66batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.73batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.69batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.72batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.72batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.64batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 75.72batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.75batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.85batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.70batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.71batch/s]
Validation 51 -> LOSS = 1.34
Validation 51 -> BLEU = 48.05, 72.2/54.1/42.0/32.6 (BP=1.000, ratio=1.000, hyp_len=14377, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.19 @ validation 50
Starting Epoch 52
Epoch 52 - update      24330 => loss:   0.389 (#OOM: 0)
Epoch 52 - update      24360 => loss:   0.965 (#OOM: 0)
Epoch 52 - update      24390 => loss:   0.492 (#OOM: 0)
Epoch 52 - update      24420 => loss:   0.205 (#OOM: 0)
Epoch 52 - update      24450 => loss:   0.620 (#OOM: 0)
Epoch 52 - update      24480 => loss:   1.023 (#OOM: 0)
Epoch 52 - update      24510 => loss:   0.781 (#OOM: 0)
Epoch 52 - update      24540 => loss:   0.889 (#OOM: 0)
Epoch 52 - update      24570 => loss:   0.819 (#OOM: 0)
Epoch 52 - update      24600 => loss:   0.937 (#OOM: 0)
Epoch 52 - update      24630 => loss:   0.566 (#OOM: 0)
Epoch 52 - update      24660 => loss:   0.735 (#OOM: 0)
Epoch 52 - update      24690 => loss:   0.729 (#OOM: 0)
Epoch 52 - update      24720 => loss:   0.812 (#OOM: 0)
Epoch 52 - update      24750 => loss:   0.661 (#OOM: 0)
Epoch 52 - update      24780 => loss:   0.933 (#OOM: 0)
--> Epoch 52 finished with mean loss 0.78122
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (877 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 41.36batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.76batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 51.92batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 51.22batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.43batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.79batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 68.29batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 69.97batch/s]  2%|▋                           | 23/1014 [00:00<00:14, 70.34batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.45batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 73.91batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 76.93batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 76.77batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 77.08batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 78.23batch/s]  9%|██▌                         | 91/1014 [00:01<00:11, 77.98batch/s] 10%|██▋                        | 101/1014 [00:01<00:11, 78.68batch/s] 11%|██▉                        | 111/1014 [00:01<00:11, 78.56batch/s] 12%|███▏                       | 121/1014 [00:01<00:11, 76.86batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 77.23batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 77.23batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.80batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.79batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 77.24batch/s] 18%|████▊                      | 181/1014 [00:02<00:10, 77.10batch/s] 19%|█████                      | 191/1014 [00:02<00:10, 77.02batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 77.41batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 77.29batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 77.42batch/s] 23%|██████▏                    | 231/1014 [00:02<00:10, 77.35batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 76.62batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 76.52batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 76.24batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 76.60batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 76.96batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 76.94batch/s] 30%|████████                   | 301/1014 [00:03<00:09, 76.89batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 77.07batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 76.88batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 76.80batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 76.87batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 77.04batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 77.10batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 77.24batch/s] 38%|██████████▏                | 381/1014 [00:04<00:08, 77.46batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 76.92batch/s] 40%|██████████▋                | 401/1014 [00:05<00:07, 76.72batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 76.44batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 76.36batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 76.45batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 76.52batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 76.29batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 76.12batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 76.27batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 76.02batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 76.14batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 76.36batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 76.41batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 76.50batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 76.60batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 76.46batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 76.28batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 76.09batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 76.22batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 75.85batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 75.60batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 75.68batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 75.83batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.67batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 75.67batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 75.64batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 75.52batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 75.45batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 75.37batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 75.36batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 75.44batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 75.55batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 75.65batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 75.64batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 75.64batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 75.52batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 75.46batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 75.42batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 75.51batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 75.46batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 75.58batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 75.62batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 75.65batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 75.70batch/s] 82%|██████████████████████▏    | 831/1014 [00:10<00:02, 75.76batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 75.76batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 75.83batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 75.80batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 75.75batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 75.65batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 75.63batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 75.37batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 75.41batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 75.22batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 75.15batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 75.14batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 75.12batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 75.19batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 75.09batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 75.04batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.11batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 75.21batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 75.24batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.29batch/s]
Validation 52 -> LOSS = 1.34
Validation 52 -> BLEU = 47.82, 72.1/53.8/41.7/32.4 (BP=0.999, ratio=0.999, hyp_len=14371, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.19 @ validation 50
Starting Epoch 53
Epoch 53 - update      24810 => loss:   0.138 (#OOM: 0)
Epoch 53 - update      24840 => loss:   0.709 (#OOM: 0)
Epoch 53 - update      24870 => loss:   0.693 (#OOM: 0)
Epoch 53 - update      24900 => loss:   0.635 (#OOM: 0)
Epoch 53 - update      24930 => loss:   0.555 (#OOM: 0)
Epoch 53 - update      24960 => loss:   0.577 (#OOM: 0)
Epoch 53 - update      24990 => loss:   0.660 (#OOM: 0)
Epoch 53 - update      25020 => loss:   0.633 (#OOM: 0)
Epoch 53 - update      25050 => loss:   0.707 (#OOM: 0)
Epoch 53 - update      25080 => loss:   0.754 (#OOM: 0)
Epoch 53 - update      25110 => loss:   0.697 (#OOM: 0)
Epoch 53 - update      25140 => loss:   0.662 (#OOM: 0)
Epoch 53 - update      25170 => loss:   0.878 (#OOM: 0)
Epoch 53 - update      25200 => loss:   0.865 (#OOM: 0)
Epoch 53 - update      25230 => loss:   0.455 (#OOM: 0)
Epoch 53 - update      25260 => loss:   0.814 (#OOM: 0)
--> Epoch 53 finished with mean loss 0.78013
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (767 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 47.32batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.17batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.12batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.74batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.14batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.83batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.57batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.14batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.25batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 79.84batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 76.65batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 77.55batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.17batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 77.06batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.93batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 75.83batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.44batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 75.33batch/s] 12%|███                        | 117/1014 [00:01<00:11, 74.98batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.09batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.99batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.38batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.67batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.60batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.24batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.68batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.67batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.96batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 73.97batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.20batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.29batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.64batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 75.15batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 75.01batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 75.53batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 75.66batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.62batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.48batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.37batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.07batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.01batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 75.19batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 74.78batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 75.01batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 75.27batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 75.04batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 75.09batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.00batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.02batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.83batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 74.90batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.11batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 74.74batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 74.81batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 74.82batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.53batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 74.69batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 74.76batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.78batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 74.61batch/s] 52%|█████████████▉             | 524/1014 [00:07<00:06, 74.46batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 74.55batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 74.56batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 74.53batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 74.52batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 74.50batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.56batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.60batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 74.70batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 74.75batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 74.77batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 74.71batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.68batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.60batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 74.55batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 74.52batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.59batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 74.61batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 74.59batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 74.61batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.64batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 74.72batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 74.72batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.68batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.65batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 74.66batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.55batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 74.62batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.70batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.71batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.80batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.85batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.93batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.95batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.98batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.98batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.99batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.07batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 75.07batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.96batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.89batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.88batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.98batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.90batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.96batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.05batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.99batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.07batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.13batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.08batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.08batch/s]
Validation 53 -> LOSS = 1.34
Validation 53 -> BLEU = 47.89, 72.1/53.9/41.9/32.5 (BP=0.999, ratio=0.999, hyp_len=14363, ref_len=14382)
** Learning rate changed -> 6.25e-06
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.19 @ validation 50
Starting Epoch 54
Epoch 54 - update      25290 => loss:   1.006 (#OOM: 0)
Epoch 54 - update      25320 => loss:   0.658 (#OOM: 0)
Epoch 54 - update      25350 => loss:   0.696 (#OOM: 0)
Epoch 54 - update      25380 => loss:   0.771 (#OOM: 0)
Epoch 54 - update      25410 => loss:   0.822 (#OOM: 0)
Epoch 54 - update      25440 => loss:   0.619 (#OOM: 0)
Epoch 54 - update      25470 => loss:   0.562 (#OOM: 0)
Epoch 54 - update      25500 => loss:   0.582 (#OOM: 0)
Epoch 54 - update      25530 => loss:   0.757 (#OOM: 0)
Epoch 54 - update      25560 => loss:   0.732 (#OOM: 0)
Epoch 54 - update      25590 => loss:   0.587 (#OOM: 0)
Epoch 54 - update      25620 => loss:   0.817 (#OOM: 0)
Epoch 54 - update      25650 => loss:   0.546 (#OOM: 0)
Epoch 54 - update      25680 => loss:   0.774 (#OOM: 0)
Epoch 54 - update      25710 => loss:   0.607 (#OOM: 0)
Epoch 54 - update      25740 => loss:   1.014 (#OOM: 0)
--> Epoch 54 finished with mean loss 0.77786
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.57 mins)   (907 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 49.34batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.26batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.94batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.24batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.43batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.38batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.12batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.00batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 80.42batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 80.39batch/s]  4%|█▏                          | 44/1014 [00:00<00:11, 81.20batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 77.93batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 79.02batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 77.48batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 77.89batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 76.26batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 75.62batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 75.43batch/s] 11%|███                        | 116/1014 [00:01<00:11, 75.32batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 75.30batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.10batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 74.94batch/s] 15%|████                       | 152/1014 [00:02<00:11, 74.70batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 74.79batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 74.77batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.10batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 74.79batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 74.79batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.58batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.03batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 74.77batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.46batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 74.23batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.68batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 74.58batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 74.61batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 74.49batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 74.34batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 74.15batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 74.48batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.88batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.07batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 74.89batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 75.15batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 75.51batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 75.43batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 75.54batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 75.51batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 75.49batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.65batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 75.73batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.97batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 76.17batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 76.24batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 75.98batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 75.92batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 75.78batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 75.61batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 75.81batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 75.88batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 75.70batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 75.61batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 75.72batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 75.87batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 75.83batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 75.77batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 75.75batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 75.77batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 75.82batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.57batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 75.44batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 75.44batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 75.36batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 75.33batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 75.36batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 75.20batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 75.25batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 75.37batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 75.43batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 75.36batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 75.34batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 75.27batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 75.30batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 75.33batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 75.36batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 75.46batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.35batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.41batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 75.46batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 75.40batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.44batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 75.44batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.33batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 75.43batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 75.34batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 75.53batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 75.54batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 75.62batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 75.61batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.55batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.51batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.44batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.47batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.55batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.60batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.66batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 75.55batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.48batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.50batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.40batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.41batch/s]
Validation 54 -> LOSS = 1.34
Validation 54 -> BLEU = 48.11, 72.1/54.0/42.0/32.7 (BP=1.000, ratio=1.001, hyp_len=14395, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.19 @ validation 50
Starting Epoch 55
Epoch 55 - update      25770 => loss:   0.906 (#OOM: 0)
Epoch 55 - update      25800 => loss:   0.853 (#OOM: 0)
Epoch 55 - update      25830 => loss:   1.139 (#OOM: 0)
Epoch 55 - update      25860 => loss:   0.661 (#OOM: 0)
Epoch 55 - update      25890 => loss:   0.918 (#OOM: 0)
Epoch 55 - update      25920 => loss:   0.722 (#OOM: 0)
Epoch 55 - update      25950 => loss:   0.660 (#OOM: 0)
Epoch 55 - update      25980 => loss:   0.737 (#OOM: 0)
Epoch 55 - update      26010 => loss:   0.581 (#OOM: 0)
Epoch 55 - update      26040 => loss:   0.998 (#OOM: 0)
Epoch 55 - update      26070 => loss:   0.993 (#OOM: 0)
Epoch 55 - update      26100 => loss:   0.710 (#OOM: 0)
Epoch 55 - update      26130 => loss:   0.743 (#OOM: 0)
Epoch 55 - update      26160 => loss:   0.962 (#OOM: 0)
Epoch 55 - update      26190 => loss:   0.489 (#OOM: 0)
Epoch 55 - update      26220 => loss:   0.517 (#OOM: 0)
--> Epoch 55 finished with mean loss 0.77764
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (902 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.50batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.33batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 51.63batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 49.35batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 48.99batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.14batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.39batch/s]  2%|▍                           | 16/1014 [00:00<00:15, 66.27batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 69.99batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 71.19batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 73.46batch/s]  5%|█▍                          | 50/1014 [00:00<00:13, 73.12batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 73.54batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 73.93batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 74.76batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 75.08batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 75.38batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 76.06batch/s] 11%|███                        | 113/1014 [00:01<00:11, 76.89batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 75.05batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 75.46batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 75.67batch/s] 15%|███▉                       | 149/1014 [00:01<00:11, 75.60batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 75.85batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 75.30batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 75.57batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 75.47batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 76.03batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 76.04batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 76.23batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 75.79batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 75.29batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 75.19batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 74.99batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.22batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.82batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 76.13batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 76.02batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.83batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 76.03batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 76.17batch/s] 32%|████████▋                  | 327/1014 [00:04<00:08, 76.41batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 76.63batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 76.84batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 76.90batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 76.95batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 76.76batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 76.63batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 76.54batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 76.57batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 76.25batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 76.42batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 76.36batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 76.11batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.95batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 75.79batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 75.94batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 75.84batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 75.90batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 75.84batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 75.73batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 75.63batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 75.50batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.49batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 75.45batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.46batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 75.42batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 75.28batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 75.12batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 75.15batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.18batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 75.14batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 75.09batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.21batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.17batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.11batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 75.09batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.04batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.03batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.89batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 74.80batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.88batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.04batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 74.96batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 75.10batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.05batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.07batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 75.00batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.05batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 74.97batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.12batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 75.19batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.23batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.23batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.15batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.20batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.25batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.30batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.33batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 75.34batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 75.39batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.29batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 75.30batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.19batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.14batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.28batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 75.31batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.32batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.34batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.41batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.44batch/s]
Validation 55 -> LOSS = 1.34
Validation 55 -> BLEU = 48.26, 72.2/54.2/42.2/32.9 (BP=0.999, ratio=0.999, hyp_len=14369, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.26 @ validation 55
Starting Epoch 56
Epoch 56 - update      26250 => loss:   0.955 (#OOM: 0)
Epoch 56 - update      26280 => loss:   0.626 (#OOM: 0)
Epoch 56 - update      26310 => loss:   0.734 (#OOM: 0)
Epoch 56 - update      26340 => loss:   0.726 (#OOM: 0)
Epoch 56 - update      26370 => loss:   0.866 (#OOM: 0)
Epoch 56 - update      26400 => loss:   0.470 (#OOM: 0)
Epoch 56 - update      26430 => loss:   0.740 (#OOM: 0)
Epoch 56 - update      26460 => loss:   1.051 (#OOM: 0)
Epoch 56 - update      26490 => loss:   0.730 (#OOM: 0)
Epoch 56 - update      26520 => loss:   0.813 (#OOM: 0)
Epoch 56 - update      26550 => loss:   0.646 (#OOM: 0)
Epoch 56 - update      26580 => loss:   0.782 (#OOM: 0)
Epoch 56 - update      26610 => loss:   0.813 (#OOM: 0)
Epoch 56 - update      26640 => loss:   0.778 (#OOM: 0)
Epoch 56 - update      26670 => loss:   0.728 (#OOM: 0)
Epoch 56 - update      26700 => loss:   0.594 (#OOM: 0)
--> Epoch 56 finished with mean loss 0.77829
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (806 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.20batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.35batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.48batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.74batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.88batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.83batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 84.66batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 76.31batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 72.51batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 72.12batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 71.03batch/s]  5%|█▌                          | 55/1014 [00:00<00:13, 73.65batch/s]  6%|█▊                          | 65/1014 [00:00<00:12, 73.18batch/s]  7%|██                          | 75/1014 [00:01<00:12, 72.98batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 72.63batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 72.63batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 73.21batch/s] 11%|███                        | 115/1014 [00:01<00:12, 73.19batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 73.02batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 73.68batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 73.66batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 74.26batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 73.44batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 73.09batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 72.83batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 72.95batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 73.24batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 73.73batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 73.62batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 73.41batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 73.71batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 74.11batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.05batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.42batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.60batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.09batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.13batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.13batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 74.78batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.94batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 74.74batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.85batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.96batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 75.08batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.26batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.19batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.01batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 74.99batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 74.90batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 74.90batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 74.96batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.00batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.96batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 74.82batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 74.53batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.42batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 74.22batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 74.22batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 74.26batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 74.42batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 74.14batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 74.03batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 74.35batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.26batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.36batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 74.41batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 74.47batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 74.48batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 74.45batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 74.50batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.59batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.42batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.54batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.55batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.61batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.71batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.72batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 74.71batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.81batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.69batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 74.65batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.74batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.88batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.73batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.68batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.81batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.96batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.06batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.26batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.17batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.29batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.32batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.28batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.35batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.42batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.43batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 75.34batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.43batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.52batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.38batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.54batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.53batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.41batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.42batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 75.45batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.52batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.51batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.40batch/s]
Validation 56 -> LOSS = 1.34
Validation 56 -> BLEU = 48.19, 72.3/54.2/42.2/32.9 (BP=0.997, ratio=0.997, hyp_len=14345, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.26 @ validation 55
Starting Epoch 57
Epoch 57 - update      26730 => loss:   0.873 (#OOM: 0)
Epoch 57 - update      26760 => loss:   0.591 (#OOM: 0)
Epoch 57 - update      26790 => loss:   0.689 (#OOM: 0)
Epoch 57 - update      26820 => loss:   0.718 (#OOM: 0)
Epoch 57 - update      26850 => loss:   0.971 (#OOM: 0)
Epoch 57 - update      26880 => loss:   0.547 (#OOM: 0)
Epoch 57 - update      26910 => loss:   0.562 (#OOM: 0)
Epoch 57 - update      26940 => loss:   0.732 (#OOM: 0)
Epoch 57 - update      26970 => loss:   0.953 (#OOM: 0)
Epoch 57 - update      27000 => loss:   0.564 (#OOM: 0)
Epoch 57 - update      27030 => loss:   0.614 (#OOM: 0)
Epoch 57 - update      27060 => loss:   0.419 (#OOM: 0)
Epoch 57 - update      27090 => loss:   0.654 (#OOM: 0)
Epoch 57 - update      27120 => loss:   0.681 (#OOM: 0)
Epoch 57 - update      27150 => loss:   0.807 (#OOM: 0)
Epoch 57 - update      27180 => loss:   0.759 (#OOM: 0)
--> Epoch 57 finished with mean loss 0.77605
--> Overhead/Training/Evaluation: 0.03/0.48/0.00 mins (total: 0.50 mins)   (1017 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.28batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.73batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.95batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.03batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.02batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.96batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.93batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.55batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.04batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 74.42batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.24batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 76.95batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 78.22batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 78.04batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 78.22batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 78.71batch/s]  8%|██▎                         | 86/1014 [00:01<00:11, 77.98batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 76.25batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 75.91batch/s] 11%|███                        | 114/1014 [00:01<00:11, 77.39batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 77.04batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 77.61batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 77.71batch/s] 15%|████                       | 154/1014 [00:01<00:11, 77.84batch/s] 16%|████▎                      | 164/1014 [00:02<00:10, 77.31batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 77.42batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 77.07batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 77.16batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 76.88batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 77.40batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 77.04batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 77.04batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 76.78batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 76.19batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 76.46batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 76.17batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.93batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.99batch/s] 30%|████████                   | 304/1014 [00:03<00:09, 76.03batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 76.45batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 76.47batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 76.52batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 76.38batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 76.30batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 76.31batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 76.15batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 76.09batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.95batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.67batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.87batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.84batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.83batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.88batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 75.83batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.90batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.75batch/s] 48%|████████████▉              | 484/1014 [00:06<00:06, 75.83batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.68batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.85batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.84batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.73batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 75.68batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.52batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.53batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.73batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.84batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.93batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.91batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 75.86batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.95batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.92batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.99batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.96batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.83batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.85batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.67batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.65batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.76batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.67batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.57batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.63batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.58batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.45batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 75.53batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.50batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.37batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.45batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.37batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.31batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.40batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.24batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.14batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.15batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.07batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.17batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.10batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.16batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.07batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 75.00batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.97batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.01batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.94batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.96batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.83batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.77batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.79batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.73batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.70batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.63batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.61batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.61batch/s]
Validation 57 -> LOSS = 1.34
Validation 57 -> BLEU = 48.32, 72.4/54.3/42.3/32.9 (BP=0.999, ratio=0.999, hyp_len=14370, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.32 @ validation 57
Starting Epoch 58
Epoch 58 - update      27210 => loss:   0.629 (#OOM: 0)
Epoch 58 - update      27240 => loss:   0.628 (#OOM: 0)
Epoch 58 - update      27270 => loss:   0.634 (#OOM: 0)
Epoch 58 - update      27300 => loss:   0.619 (#OOM: 0)
Epoch 58 - update      27330 => loss:   0.930 (#OOM: 0)
Epoch 58 - update      27360 => loss:   0.583 (#OOM: 0)
Epoch 58 - update      27390 => loss:   0.874 (#OOM: 0)
Epoch 58 - update      27420 => loss:   0.897 (#OOM: 0)
Epoch 58 - update      27450 => loss:   0.802 (#OOM: 0)
Epoch 58 - update      27480 => loss:   0.992 (#OOM: 0)
Epoch 58 - update      27510 => loss:   0.634 (#OOM: 0)
Epoch 58 - update      27540 => loss:   0.980 (#OOM: 0)
Epoch 58 - update      27570 => loss:   0.989 (#OOM: 0)
Epoch 58 - update      27600 => loss:   0.683 (#OOM: 0)
Epoch 58 - update      27630 => loss:   1.001 (#OOM: 0)
Epoch 58 - update      27660 => loss:   0.683 (#OOM: 0)
--> Epoch 58 finished with mean loss 0.77677
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (805 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 48.47batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.40batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.62batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.17batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.66batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.45batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 69.51batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 69.97batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.11batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 67.71batch/s]  4%|█                           | 40/1014 [00:00<00:14, 68.77batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 69.07batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 69.88batch/s]  6%|█▊                          | 65/1014 [00:00<00:13, 71.26batch/s]  7%|██                          | 74/1014 [00:01<00:13, 71.35batch/s]  8%|██▎                         | 83/1014 [00:01<00:13, 71.50batch/s]  9%|██▌                         | 92/1014 [00:01<00:12, 71.83batch/s] 10%|██▋                        | 101/1014 [00:01<00:12, 72.46batch/s] 11%|██▉                        | 110/1014 [00:01<00:12, 72.55batch/s] 12%|███▏                       | 119/1014 [00:01<00:12, 72.90batch/s] 13%|███▍                       | 128/1014 [00:01<00:12, 73.30batch/s] 14%|███▋                       | 137/1014 [00:01<00:11, 73.55batch/s] 14%|███▉                       | 147/1014 [00:01<00:11, 74.60batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 74.68batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 73.86batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 73.56batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 73.88batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 74.24batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 74.13batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 74.23batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 73.96batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 73.94batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 73.84batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 73.38batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 73.42batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 73.15batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 73.08batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 73.53batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 73.51batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 73.38batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 73.18batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 73.07batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:09, 73.44batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 73.73batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 73.43batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 73.67batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 73.69batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 73.75batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 73.51batch/s] 41%|███████████                | 417/1014 [00:05<00:08, 73.35batch/s] 42%|███████████▎               | 427/1014 [00:05<00:08, 73.22batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 73.51batch/s] 44%|███████████▉               | 447/1014 [00:06<00:07, 73.22batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 73.52batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 73.66batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 73.63batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 73.48batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:07, 73.48batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 73.45batch/s] 51%|█████████████▊             | 517/1014 [00:07<00:06, 73.43batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 73.44batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 73.56batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 73.55batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 73.75batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 73.90batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 74.03batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 73.93batch/s] 59%|███████████████▉           | 597/1014 [00:08<00:05, 74.01batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 74.18batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 74.39batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 74.52batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 74.52batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 74.47batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.58batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 74.61batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 74.61batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 74.57batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 74.57batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.66batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 74.70batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.65batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 74.76batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 74.93batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 75.01batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 74.98batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.00batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 75.11batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.10batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.11batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.23batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 75.20batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.22batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.26batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.20batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.18batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.25batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.17batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.17batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 75.19batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 75.23batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.19batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 75.19batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.25batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.14batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.28batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 75.29batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.28batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.26batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.34batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.22batch/s]
Validation 58 -> LOSS = 1.34
Validation 58 -> BLEU = 48.33, 72.4/54.3/42.3/33.0 (BP=0.999, ratio=0.999, hyp_len=14364, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 59
Epoch 59 - update      27690 => loss:   0.751 (#OOM: 0)
Epoch 59 - update      27720 => loss:   0.670 (#OOM: 0)
Epoch 59 - update      27750 => loss:   0.656 (#OOM: 0)
Epoch 59 - update      27780 => loss:   0.471 (#OOM: 0)
Epoch 59 - update      27810 => loss:   0.501 (#OOM: 0)
Epoch 59 - update      27840 => loss:   1.069 (#OOM: 0)
Epoch 59 - update      27870 => loss:   0.845 (#OOM: 0)
Epoch 59 - update      27900 => loss:   0.832 (#OOM: 0)
Epoch 59 - update      27930 => loss:   0.877 (#OOM: 0)
Epoch 59 - update      27960 => loss:   0.718 (#OOM: 0)
Epoch 59 - update      27990 => loss:   0.738 (#OOM: 0)
Epoch 59 - update      28020 => loss:   0.723 (#OOM: 0)
Epoch 59 - update      28050 => loss:   0.457 (#OOM: 0)
Epoch 59 - update      28080 => loss:   0.908 (#OOM: 0)
Epoch 59 - update      28110 => loss:   0.662 (#OOM: 0)
Epoch 59 - update      28140 => loss:   0.659 (#OOM: 0)
--> Epoch 59 finished with mean loss 0.77722
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (805 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.61batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 48.35batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 48.16batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 48.16batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 49.39batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 50.20batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.29batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 69.22batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 70.72batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 72.08batch/s]  3%|▊                           | 31/1014 [00:00<00:14, 69.36batch/s]  4%|█                           | 39/1014 [00:00<00:13, 70.69batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 73.27batch/s]  6%|█▌                          | 57/1014 [00:00<00:13, 72.92batch/s]  7%|█▊                          | 66/1014 [00:00<00:13, 71.85batch/s]  7%|██                          | 75/1014 [00:01<00:12, 72.71batch/s]  8%|██▎                         | 84/1014 [00:01<00:12, 73.50batch/s]  9%|██▌                         | 93/1014 [00:01<00:12, 74.50batch/s] 10%|██▋                        | 102/1014 [00:01<00:12, 74.17batch/s] 11%|██▉                        | 111/1014 [00:01<00:12, 73.23batch/s] 12%|███▏                       | 120/1014 [00:01<00:12, 72.91batch/s] 13%|███▍                       | 129/1014 [00:01<00:12, 72.87batch/s] 14%|███▋                       | 138/1014 [00:01<00:11, 73.36batch/s] 14%|███▉                       | 147/1014 [00:01<00:11, 73.56batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 73.56batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 73.71batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 73.63batch/s] 18%|████▊                      | 183/1014 [00:02<00:11, 73.73batch/s] 19%|█████                      | 192/1014 [00:02<00:11, 73.64batch/s] 20%|█████▎                     | 201/1014 [00:02<00:11, 73.85batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 74.64batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 75.26batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 75.37batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 75.65batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 76.09batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 75.88batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 75.56batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 75.53batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 75.31batch/s] 30%|████████                   | 301/1014 [00:04<00:09, 75.08batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 75.31batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 75.36batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 75.66batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 75.65batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 75.58batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 75.49batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 75.14batch/s] 38%|██████████▏                | 381/1014 [00:05<00:08, 75.30batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 75.39batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 75.13batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 75.21batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 75.25batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 75.08batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 74.90batch/s] 44%|████████████               | 451/1014 [00:06<00:07, 75.07batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 75.45batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 75.43batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 75.33batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 75.43batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 75.68batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 75.79batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 75.76batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 75.79batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 75.87batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 75.99batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 76.08batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 76.11batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 76.14batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 76.08batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 76.07batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 75.96batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.96batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 75.94batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 76.11batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 76.24batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 76.24batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 76.16batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 76.18batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 76.18batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 76.08batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:03, 76.00batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 75.94batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 76.05batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 76.06batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 75.94batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 76.04batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 76.05batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 75.99batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 76.05batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 76.13batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 76.14batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 76.15batch/s] 82%|██████████████████████▏    | 831/1014 [00:10<00:02, 76.14batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 76.11batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 76.19batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 76.18batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 76.07batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 76.04batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 76.05batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 75.98batch/s] 90%|████████████████████████▎  | 911/1014 [00:11<00:01, 76.05batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 76.10batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 75.99batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 75.93batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 75.91batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 75.92batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 75.90batch/s] 97%|██████████████████████████ | 981/1014 [00:12<00:00, 75.87batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.88batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 75.86batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 75.91batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.81batch/s]
Validation 59 -> LOSS = 1.34
Validation 59 -> BLEU = 48.24, 72.4/54.3/42.3/33.0 (BP=0.996, ratio=0.996, hyp_len=14328, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 60
Epoch 60 - update      28170 => loss:   0.563 (#OOM: 0)
Epoch 60 - update      28200 => loss:   1.073 (#OOM: 0)
Epoch 60 - update      28230 => loss:   0.640 (#OOM: 0)
Epoch 60 - update      28260 => loss:   0.852 (#OOM: 0)
Epoch 60 - update      28290 => loss:   0.561 (#OOM: 0)
Epoch 60 - update      28320 => loss:   0.549 (#OOM: 0)
Epoch 60 - update      28350 => loss:   0.966 (#OOM: 0)
Epoch 60 - update      28380 => loss:   0.800 (#OOM: 0)
Epoch 60 - update      28410 => loss:   0.638 (#OOM: 0)
Epoch 60 - update      28440 => loss:   0.812 (#OOM: 0)
Epoch 60 - update      28470 => loss:   0.676 (#OOM: 0)
Epoch 60 - update      28500 => loss:   1.106 (#OOM: 0)
Epoch 60 - update      28530 => loss:   0.758 (#OOM: 0)
Epoch 60 - update      28560 => loss:   0.927 (#OOM: 0)
Epoch 60 - update      28590 => loss:   0.770 (#OOM: 0)
Epoch 60 - update      28620 => loss:   0.677 (#OOM: 0)
--> Epoch 60 finished with mean loss 0.77713
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (893 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.16batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 48.50batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.52batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 48.45batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 50.97batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.86batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.16batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.55batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.70batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 77.98batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 77.39batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 76.99batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 77.36batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 77.16batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 75.66batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 76.47batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 76.22batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 74.99batch/s] 11%|███                        | 115/1014 [00:01<00:12, 74.53batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 73.82batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 73.67batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 74.09batch/s] 15%|████                       | 151/1014 [00:02<00:11, 74.72batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 75.12batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 74.92batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 75.17batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 75.07batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.54batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 75.64batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 75.71batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.44batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.67batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 75.59batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 75.33batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 75.30batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.02batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.20batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.05batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.79batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.72batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.51batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.28batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 74.48batch/s] 34%|█████████                  | 340/1014 [00:04<00:09, 74.75batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 75.04batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.00batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.23batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.39batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.26batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.20batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.13batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.33batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 75.29batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 75.28batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 75.16batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.21batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.19batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.00batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.22batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.36batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.44batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 75.43batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 75.33batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 75.45batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 75.24batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.12batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.17batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.18batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.23batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.25batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.18batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.99batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 75.04batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 75.01batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 75.02batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 75.02batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 75.08batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.17batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.14batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.12batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.02batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 75.03batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 74.94batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.01batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 74.94batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 74.86batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.89batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.91batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 74.93batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 75.00batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.10batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 75.16batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 75.23batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.27batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.46batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.52batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.59batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 75.46batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.49batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.49batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.53batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.54batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.59batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.55batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.53batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.72batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.75batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.70batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.69batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.77batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.73batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.77batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 75.81batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.81batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.65batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 75.64batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.60batch/s]
Validation 60 -> LOSS = 1.34
Validation 60 -> BLEU = 48.16, 72.2/54.1/42.1/32.8 (BP=0.998, ratio=0.998, hyp_len=14360, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 61
Epoch 61 - update      28650 => loss:   0.584 (#OOM: 0)
Epoch 61 - update      28680 => loss:   0.529 (#OOM: 0)
Epoch 61 - update      28710 => loss:   0.716 (#OOM: 0)
Epoch 61 - update      28740 => loss:   0.561 (#OOM: 0)
Epoch 61 - update      28770 => loss:   0.831 (#OOM: 0)
Epoch 61 - update      28800 => loss:   0.487 (#OOM: 0)
Epoch 61 - update      28830 => loss:   1.002 (#OOM: 0)
Epoch 61 - update      28860 => loss:   0.814 (#OOM: 0)
Epoch 61 - update      28890 => loss:   0.606 (#OOM: 0)
Epoch 61 - update      28920 => loss:   0.747 (#OOM: 0)
Epoch 61 - update      28950 => loss:   0.209 (#OOM: 0)
Epoch 61 - update      28980 => loss:   0.876 (#OOM: 0)
Epoch 61 - update      29010 => loss:   1.004 (#OOM: 0)
Epoch 61 - update      29040 => loss:   0.862 (#OOM: 0)
Epoch 61 - update      29070 => loss:   0.747 (#OOM: 0)
--> Epoch 61 finished with mean loss 0.77813
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.68 mins)   (764 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 20%|██████▏                        | 7/35 [00:00<00:00, 58.49batch/s] 40%|████████████                  | 14/35 [00:00<00:00, 55.60batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 54.37batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 52.42batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.77batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.74batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 93.63batch/s]  2%|▌                           | 20/1014 [00:00<00:12, 79.91batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 83.50batch/s]  4%|█                           | 40/1014 [00:00<00:11, 81.83batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 83.17batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 83.19batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 82.27batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 81.42batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 80.51batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 80.41batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 80.44batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 80.03batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 79.82batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 79.88batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 79.21batch/s] 16%|████▎                      | 160/1014 [00:02<00:10, 79.11batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 79.64batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 79.25batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 78.53batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 77.84batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 77.96batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 77.19batch/s] 23%|██████                     | 230/1014 [00:02<00:10, 77.22batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 77.23batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 76.97batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 76.86batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 76.90batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 76.83batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 76.85batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 76.61batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 76.58batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 76.90batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 76.40batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 76.51batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 76.60batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 76.64batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 76.28batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 76.36batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 76.33batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 76.09batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 76.46batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 76.58batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 76.42batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 76.63batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 76.57batch/s] 45%|████████████▏              | 460/1014 [00:05<00:07, 76.71batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 76.91batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 76.80batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 76.94batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 76.92batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 76.58batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 76.42batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 76.53batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.43batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 76.55batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 76.59batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 76.65batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 76.58batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 76.55batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 76.56batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 76.62batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 76.52batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 76.44batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 76.49batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 76.35batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 76.31batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 76.28batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 76.15batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 76.26batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 76.22batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:03, 76.26batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 76.23batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 76.22batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 76.28batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 76.19batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 76.26batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 76.15batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 76.10batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 76.20batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 76.32batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 76.24batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 76.21batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 76.13batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 76.09batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 76.04batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.87batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.86batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.81batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.70batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.59batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.48batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.45batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.38batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.26batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.17batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.27batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.35batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 75.47batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.39batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.34batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 75.21batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.20batch/s]
Validation 61 -> LOSS = 1.34
Validation 61 -> BLEU = 48.24, 72.4/54.3/42.3/33.0 (BP=0.997, ratio=0.997, hyp_len=14340, ref_len=14382)
** Learning rate changed -> 3.125e-06
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 62
Epoch 62 - update      29100 => loss:   0.967 (#OOM: 0)
Epoch 62 - update      29130 => loss:   0.627 (#OOM: 0)
Epoch 62 - update      29160 => loss:   0.677 (#OOM: 0)
Epoch 62 - update      29190 => loss:   1.044 (#OOM: 0)
Epoch 62 - update      29220 => loss:   0.887 (#OOM: 0)
Epoch 62 - update      29250 => loss:   0.874 (#OOM: 0)
Epoch 62 - update      29280 => loss:   0.786 (#OOM: 0)
Epoch 62 - update      29310 => loss:   0.660 (#OOM: 0)
Epoch 62 - update      29340 => loss:   0.516 (#OOM: 0)
Epoch 62 - update      29370 => loss:   1.015 (#OOM: 0)
Epoch 62 - update      29400 => loss:   0.836 (#OOM: 0)
Epoch 62 - update      29430 => loss:   0.725 (#OOM: 0)
Epoch 62 - update      29460 => loss:   1.026 (#OOM: 0)
Epoch 62 - update      29490 => loss:   0.968 (#OOM: 0)
Epoch 62 - update      29520 => loss:   0.841 (#OOM: 0)
Epoch 62 - update      29550 => loss:   0.502 (#OOM: 0)
--> Epoch 62 finished with mean loss 0.77667
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.58 mins)   (887 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.03batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.00batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.08batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.34batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.15batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.71batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:13, 75.65batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.51batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 75.40batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 77.30batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 76.01batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 76.52batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 74.99batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 73.83batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 73.16batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.03batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.67batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.00batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.51batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.00batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 75.17batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.97batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.11batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.37batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.78batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 75.50batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.41batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.38batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.06batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 75.31batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 75.25batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.17batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 75.12batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.51batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 74.45batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 74.76batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 74.68batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 74.39batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 74.64batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.76batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.84batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.73batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.67batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 74.39batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 74.14batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 74.25batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 74.39batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 74.16batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.27batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.17batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.37batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.44batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.22batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.22batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.60batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.65batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.75batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 74.76batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.58batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 74.69batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.46batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 74.25batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 74.17batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 74.33batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 74.49batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 74.54batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 74.53batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.55batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.65batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.88batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.98batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.03batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 75.11batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 74.96batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 75.12batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 75.05batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 75.13batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 75.02batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 75.04batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 75.11batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 75.26batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 75.15batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 75.34batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 75.51batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 75.50batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 75.54batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 75.62batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 75.67batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.72batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.71batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 75.75batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 75.70batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.70batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 75.73batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.79batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 75.72batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 75.83batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 75.85batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 75.79batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 75.87batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 75.54batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.50batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.47batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.52batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.54batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.49batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.47batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.44batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 75.50batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.61batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.53batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.45batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.43batch/s]
Validation 62 -> LOSS = 1.34
Validation 62 -> BLEU = 48.15, 72.4/54.2/42.2/32.9 (BP=0.997, ratio=0.997, hyp_len=14335, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 63
Epoch 63 - update      29580 => loss:   0.689 (#OOM: 0)
Epoch 63 - update      29610 => loss:   0.889 (#OOM: 0)
Epoch 63 - update      29640 => loss:   0.439 (#OOM: 0)
Epoch 63 - update      29670 => loss:   0.764 (#OOM: 0)
Epoch 63 - update      29700 => loss:   0.614 (#OOM: 0)
Epoch 63 - update      29730 => loss:   0.682 (#OOM: 0)
Epoch 63 - update      29760 => loss:   1.007 (#OOM: 0)
Epoch 63 - update      29790 => loss:   0.652 (#OOM: 0)
Epoch 63 - update      29820 => loss:   0.502 (#OOM: 0)
Epoch 63 - update      29850 => loss:   0.741 (#OOM: 0)
Epoch 63 - update      29880 => loss:   0.690 (#OOM: 0)
Epoch 63 - update      29910 => loss:   0.184 (#OOM: 0)
Epoch 63 - update      29940 => loss:   0.466 (#OOM: 0)
Epoch 63 - update      29970 => loss:   0.570 (#OOM: 0)
Epoch 63 - update      30000 => loss:   0.544 (#OOM: 0)
Epoch 63 - update      30030 => loss:   0.464 (#OOM: 0)
--> Epoch 63 finished with mean loss 0.77504
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (770 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.33batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.36batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.24batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.66batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.55batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.51batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.46batch/s]  2%|▍                           | 16/1014 [00:00<00:15, 66.41batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 66.53batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 68.92batch/s]  4%|█                           | 40/1014 [00:00<00:15, 64.09batch/s]  5%|█▎                          | 48/1014 [00:00<00:14, 65.92batch/s]  6%|█▌                          | 57/1014 [00:00<00:14, 68.16batch/s]  7%|█▊                          | 66/1014 [00:00<00:13, 69.82batch/s]  7%|██                          | 75/1014 [00:01<00:13, 70.43batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 72.24batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 72.07batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 71.63batch/s] 11%|███                        | 115/1014 [00:01<00:12, 71.74batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 72.14batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 71.76batch/s] 14%|███▊                       | 145/1014 [00:02<00:12, 71.70batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 72.34batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 72.61batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 72.86batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 73.09batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 72.50batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 72.84batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 72.97batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 72.43batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 72.64batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 73.00batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 73.52batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.08batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.03batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.09batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.11batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.04batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.34batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 74.41batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.55batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 74.58batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.82batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.98batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.97batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.96batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.29batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.28batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 75.18batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.17batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.09batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 75.31batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.39batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.23batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.21batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 75.36batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.32batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 75.28batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 75.22batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.36batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 75.38batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.45batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.52batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.71batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.64batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.65batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 75.69batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 75.41batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 75.47batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.51batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.31batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.26batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.12batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.05batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.01batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.98batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.94batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.94batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 74.92batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.01batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.04batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 74.85batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.88batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.83batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.94batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.89batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.71batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.62batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.64batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.77batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.79batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.86batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.80batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 74.87batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.90batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.92batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 74.98batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.97batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.06batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.05batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.00batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.94batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.00batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.98batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.06batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 75.11batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.02batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.07batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.15batch/s]
Validation 63 -> LOSS = 1.34
Validation 63 -> BLEU = 48.09, 72.3/54.1/42.1/32.8 (BP=0.998, ratio=0.998, hyp_len=14348, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 64
Epoch 64 - update      30060 => loss:   0.819 (#OOM: 0)
Epoch 64 - update      30090 => loss:   0.493 (#OOM: 0)
Epoch 64 - update      30120 => loss:   0.632 (#OOM: 0)
Epoch 64 - update      30150 => loss:   0.819 (#OOM: 0)
Epoch 64 - update      30180 => loss:   0.774 (#OOM: 0)
Epoch 64 - update      30210 => loss:   0.666 (#OOM: 0)
Epoch 64 - update      30240 => loss:   0.684 (#OOM: 0)
Epoch 64 - update      30270 => loss:   0.565 (#OOM: 0)
Epoch 64 - update      30300 => loss:   0.588 (#OOM: 0)
Epoch 64 - update      30330 => loss:   0.841 (#OOM: 0)
Epoch 64 - update      30360 => loss:   0.644 (#OOM: 0)
Epoch 64 - update      30390 => loss:   0.725 (#OOM: 0)
Epoch 64 - update      30420 => loss:   0.668 (#OOM: 0)
Epoch 64 - update      30450 => loss:   0.729 (#OOM: 0)
Epoch 64 - update      30480 => loss:   0.778 (#OOM: 0)
Epoch 64 - update      30510 => loss:   0.716 (#OOM: 0)
--> Epoch 64 finished with mean loss 0.77464
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.67 mins)   (773 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.13batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.29batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.67batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.12batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.07batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.62batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.15batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.20batch/s]  2%|▋                           | 24/1014 [00:00<00:12, 77.26batch/s]  3%|▉                           | 32/1014 [00:00<00:12, 75.97batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 78.21batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 78.17batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 78.62batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 78.00batch/s]  8%|██▏                         | 77/1014 [00:00<00:12, 77.00batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 75.96batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 76.87batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 77.00batch/s] 11%|███                        | 113/1014 [00:01<00:11, 75.43batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 75.90batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 76.26batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 75.94batch/s] 15%|███▉                       | 149/1014 [00:01<00:11, 75.87batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 75.25batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 75.00batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 74.90batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 75.47batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 75.67batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 75.87batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 75.58batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 75.09batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 74.81batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 75.12batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 75.21batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.37batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.56batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 75.69batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.94batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 76.08batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 75.95batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 76.00batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 76.02batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 75.83batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 75.92batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 75.47batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.41batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.32batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 75.07batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.68batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 74.75batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 74.84batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 75.01batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 74.95batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 75.11batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 75.21batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.42batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.35batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.55batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.50batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 75.49batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 75.59batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 75.59batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 75.43batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 75.49batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 75.61batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.65batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.43batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.46batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 75.56batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 75.57batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 75.52batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 75.33batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 75.33batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 75.32batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.41batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.47batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.53batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.62batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.61batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 75.59batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 75.75batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 75.93batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 75.92batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 75.94batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 75.80batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 75.74batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 75.69batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 75.66batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 75.74batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 75.65batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 75.62batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.62batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.44batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 75.43batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 75.49batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.31batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 75.23batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.11batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 75.13batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 75.18batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 75.26batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 75.18batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 75.30batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 75.31batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.20batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.23batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.25batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.22batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.21batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.25batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.27batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 75.24batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.29batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.26batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.21batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.25batch/s]
Validation 64 -> LOSS = 1.34
Validation 64 -> BLEU = 48.21, 72.3/54.2/42.2/33.0 (BP=0.998, ratio=0.998, hyp_len=14347, ref_len=14382)
** Learning rate changed -> 1.5625e-06
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 65
Epoch 65 - update      30540 => loss:   1.018 (#OOM: 0)
Epoch 65 - update      30570 => loss:   0.754 (#OOM: 0)
Epoch 65 - update      30600 => loss:   0.754 (#OOM: 0)
Epoch 65 - update      30630 => loss:   0.728 (#OOM: 0)
Epoch 65 - update      30660 => loss:   0.873 (#OOM: 0)
Epoch 65 - update      30690 => loss:   1.059 (#OOM: 0)
Epoch 65 - update      30720 => loss:   0.693 (#OOM: 0)
Epoch 65 - update      30750 => loss:   0.425 (#OOM: 0)
Epoch 65 - update      30780 => loss:   0.798 (#OOM: 0)
Epoch 65 - update      30810 => loss:   0.645 (#OOM: 0)
Epoch 65 - update      30840 => loss:   0.685 (#OOM: 0)
Epoch 65 - update      30870 => loss:   0.684 (#OOM: 0)
Epoch 65 - update      30900 => loss:   0.441 (#OOM: 0)
Epoch 65 - update      30930 => loss:   0.503 (#OOM: 0)
Epoch 65 - update      30960 => loss:   0.483 (#OOM: 0)
Epoch 65 - update      30990 => loss:   0.630 (#OOM: 0)
--> Epoch 65 finished with mean loss 0.77559
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (807 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.96batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 46.90batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.60batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 53.93batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 53.97batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.32batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 6/1014 [00:00<00:17, 57.15batch/s]  1%|▍                           | 14/1014 [00:00<00:14, 67.98batch/s]  2%|▌                           | 22/1014 [00:00<00:14, 70.07batch/s]  3%|▊                           | 30/1014 [00:00<00:13, 71.83batch/s]  4%|█                           | 38/1014 [00:00<00:13, 71.15batch/s]  5%|█▎                          | 46/1014 [00:00<00:13, 71.11batch/s]  6%|█▌                          | 56/1014 [00:00<00:12, 74.06batch/s]  7%|█▊                          | 66/1014 [00:00<00:12, 73.04batch/s]  7%|██                          | 76/1014 [00:01<00:12, 73.69batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 73.93batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 73.50batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 73.81batch/s] 11%|███                        | 116/1014 [00:01<00:12, 73.83batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.51batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 74.54batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 74.61batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 74.43batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 74.58batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 74.83batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 75.27batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.55batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.96batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.03batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 76.47batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 76.96batch/s] 24%|██████▌                    | 246/1014 [00:03<00:09, 77.43batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 77.43batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 77.55batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 77.13batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 77.17batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 77.35batch/s] 30%|████████▏                  | 306/1014 [00:03<00:09, 77.23batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 77.43batch/s] 32%|████████▋                  | 326/1014 [00:04<00:08, 77.68batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 77.86batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 78.20batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 78.28batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 77.93batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 77.79batch/s] 38%|██████████▎                | 386/1014 [00:04<00:08, 77.49batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 77.12batch/s] 40%|██████████▊                | 406/1014 [00:05<00:07, 77.17batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 77.06batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 77.07batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 76.96batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 77.13batch/s] 45%|████████████▏              | 456/1014 [00:05<00:07, 77.12batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 76.83batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 76.73batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 76.70batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 76.96batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 77.14batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 77.16batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 76.93batch/s] 53%|██████████████▎            | 536/1014 [00:06<00:06, 76.99batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 76.60batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:05, 76.60batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 76.63batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 76.71batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 76.87batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 76.82batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 76.59batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 76.46batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 76.47batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:04, 76.58batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 76.57batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 76.63batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 76.62batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 76.52batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:04, 76.50batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 76.54batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 76.47batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 76.59batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 76.74batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 76.78batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 76.66batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 76.52batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 76.49batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 76.43batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:02, 76.29batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 76.29batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 76.21batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 76.06batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 76.10batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 76.19batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 76.14batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 76.02batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 76.03batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 76.03batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.94batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 75.89batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 75.93batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.97batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.85batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.74batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.73batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.62batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.60batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.67batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 75.56batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 75.59batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.56batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.61batch/s]
Validation 65 -> LOSS = 1.34
Validation 65 -> BLEU = 48.11, 72.2/54.1/42.1/32.8 (BP=0.998, ratio=0.998, hyp_len=14353, ref_len=14382)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 66
Epoch 66 - update      31020 => loss:   0.733 (#OOM: 0)
Epoch 66 - update      31050 => loss:   0.568 (#OOM: 0)
Epoch 66 - update      31080 => loss:   0.513 (#OOM: 0)
Epoch 66 - update      31110 => loss:   0.890 (#OOM: 0)
Epoch 66 - update      31140 => loss:   0.705 (#OOM: 0)
Epoch 66 - update      31170 => loss:   0.625 (#OOM: 0)
Epoch 66 - update      31200 => loss:   0.760 (#OOM: 0)
Epoch 66 - update      31230 => loss:   0.695 (#OOM: 0)
Epoch 66 - update      31260 => loss:   0.919 (#OOM: 0)
Epoch 66 - update      31290 => loss:   0.724 (#OOM: 0)
Epoch 66 - update      31320 => loss:   0.621 (#OOM: 0)
Epoch 66 - update      31350 => loss:   0.717 (#OOM: 0)
Epoch 66 - update      31380 => loss:   0.408 (#OOM: 0)
Epoch 66 - update      31410 => loss:   0.662 (#OOM: 0)
Epoch 66 - update      31440 => loss:   0.834 (#OOM: 0)
Epoch 66 - update      31470 => loss:   0.839 (#OOM: 0)
--> Epoch 66 finished with mean loss 0.77482
--> Overhead/Training/Evaluation: 0.02/0.47/0.00 mins (total: 0.49 mins)   (1030 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.87batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 52.71batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.18batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.82batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.80batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.41batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.37batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.55batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.86batch/s]  2%|▋                           | 24/1014 [00:00<00:12, 77.14batch/s]  3%|▉                           | 32/1014 [00:00<00:12, 76.45batch/s]  4%|█                           | 40/1014 [00:00<00:12, 75.99batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 78.87batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 75.81batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 77.04batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 76.41batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 77.18batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 77.01batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 76.86batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 77.12batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 76.62batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 76.44batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 76.28batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.22batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.36batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.82batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 76.59batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 76.34batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 76.18batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 75.99batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 75.39batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 76.08batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 75.83batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 75.59batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 75.52batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 75.60batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 75.74batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 75.92batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 75.76batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 75.59batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 75.95batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.89batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 76.00batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 75.90batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 76.04batch/s] 37%|██████████                 | 380/1014 [00:05<00:08, 75.85batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 75.70batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 75.72batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 75.78batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 75.78batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 75.72batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 75.82batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 75.82batch/s] 45%|████████████▏              | 460/1014 [00:06<00:07, 75.73batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 75.86batch/s] 47%|████████████▊              | 480/1014 [00:06<00:07, 75.94batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 76.00batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 76.01batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 75.93batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 76.04batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 76.22batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.13batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 75.95batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 76.05batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 75.83batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 75.58batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 75.47batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 75.58batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 75.45batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 75.21batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.23batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 75.37batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 75.40batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 75.40batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 75.46batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 75.32batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 75.44batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.56batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 75.40batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.50batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 75.51batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.57batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 75.59batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.65batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 75.63batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.81batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.78batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.79batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.81batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.75batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 75.68batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.71batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.73batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.62batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.65batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.74batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.63batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.60batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.57batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.60batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.57batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.59batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.44batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.42batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.43batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 75.43batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.42batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.35batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 75.35batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.38batch/s]
Validation 66 -> LOSS = 1.34
Validation 66 -> BLEU = 48.13, 72.3/54.1/42.1/32.8 (BP=0.998, ratio=0.998, hyp_len=14348, ref_len=14382)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 67
Epoch 67 - update      31500 => loss:   0.149 (#OOM: 0)
Epoch 67 - update      31530 => loss:   0.758 (#OOM: 0)
Epoch 67 - update      31560 => loss:   0.571 (#OOM: 0)
Epoch 67 - update      31590 => loss:   0.739 (#OOM: 0)
Epoch 67 - update      31620 => loss:   0.636 (#OOM: 0)
Epoch 67 - update      31650 => loss:   1.025 (#OOM: 0)
Epoch 67 - update      31680 => loss:   0.503 (#OOM: 0)
Epoch 67 - update      31710 => loss:   0.817 (#OOM: 0)
Epoch 67 - update      31740 => loss:   0.773 (#OOM: 0)
Epoch 67 - update      31770 => loss:   0.510 (#OOM: 0)
Epoch 67 - update      31800 => loss:   0.823 (#OOM: 0)
Epoch 67 - update      31830 => loss:   0.613 (#OOM: 0)
Epoch 67 - update      31860 => loss:   0.727 (#OOM: 0)
Epoch 67 - update      31890 => loss:   0.687 (#OOM: 0)
Epoch 67 - update      31920 => loss:   0.573 (#OOM: 0)
Epoch 67 - update      31950 => loss:   0.889 (#OOM: 0)
--> Epoch 67 finished with mean loss 0.77435
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (836 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.39batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.34batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 50.99batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.36batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.63batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.38batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 64.57batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 71.11batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 72.03batch/s]  3%|▊                           | 31/1014 [00:00<00:13, 72.65batch/s]  4%|█                           | 40/1014 [00:00<00:13, 74.37batch/s]  5%|█▎                          | 49/1014 [00:00<00:13, 72.49batch/s]  6%|█▌                          | 58/1014 [00:00<00:13, 72.96batch/s]  7%|█▊                          | 67/1014 [00:00<00:13, 72.72batch/s]  7%|██                          | 76/1014 [00:01<00:12, 73.05batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 71.98batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 71.38batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 72.57batch/s] 11%|███                        | 113/1014 [00:01<00:12, 74.00batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 74.54batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.32batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.51batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.34batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 74.80batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 74.63batch/s] 18%|████▊                      | 183/1014 [00:02<00:11, 74.72batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 74.68batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.12batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.27batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 73.85batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.08batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 73.73batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 74.04batch/s] 26%|███████                    | 263/1014 [00:03<00:10, 73.99batch/s] 27%|███████▎                   | 273/1014 [00:03<00:10, 73.81batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 74.14batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 74.25batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.11batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.21batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 73.96batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 73.95batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:09, 74.02batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 74.19batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 74.29batch/s] 37%|█████████▉                 | 373/1014 [00:05<00:08, 74.39batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.58batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.81batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.02batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.77batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.57batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 74.85batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 74.89batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.88batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.62batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.64batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.84batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 74.95batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.21batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.01batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.01batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.10batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 74.98batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 74.99batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 75.04batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 74.79batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.01batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 74.98batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.98batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.09batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.06batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.25batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.44batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.34batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.39batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.48batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.49batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.49batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.44batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 75.50batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.57batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.45batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.55batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 75.50batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.46batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.28batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.25batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.30batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.41batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.38batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.36batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.36batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.34batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.36batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 75.26batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.27batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.33batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.40batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.48batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.53batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.49batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.49batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.56batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.50batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.40batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.38batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.22batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.21batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.22batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.17batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.12batch/s]
Validation 67 -> LOSS = 1.34
Validation 67 -> BLEU = 48.16, 72.3/54.1/42.1/32.9 (BP=0.998, ratio=0.998, hyp_len=14356, ref_len=14382)
** Learning rate changed -> 1e-06
Early stopping patience: 1
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 68
Epoch 68 - update      31980 => loss:   0.480 (#OOM: 0)
Epoch 68 - update      32010 => loss:   1.019 (#OOM: 0)
Epoch 68 - update      32040 => loss:   0.626 (#OOM: 0)
Epoch 68 - update      32070 => loss:   0.973 (#OOM: 0)
Epoch 68 - update      32100 => loss:   0.613 (#OOM: 0)
Epoch 68 - update      32130 => loss:   0.944 (#OOM: 0)
Epoch 68 - update      32160 => loss:   0.766 (#OOM: 0)
Epoch 68 - update      32190 => loss:   0.961 (#OOM: 0)
Epoch 68 - update      32220 => loss:   0.685 (#OOM: 0)
Epoch 68 - update      32250 => loss:   0.972 (#OOM: 0)
Epoch 68 - update      32280 => loss:   0.580 (#OOM: 0)
Epoch 68 - update      32310 => loss:   0.674 (#OOM: 0)
Epoch 68 - update      32340 => loss:   0.608 (#OOM: 0)
Epoch 68 - update      32370 => loss:   0.586 (#OOM: 0)
Epoch 68 - update      32400 => loss:   0.711 (#OOM: 0)
Epoch 68 - update      32430 => loss:   0.663 (#OOM: 0)
--> Epoch 68 finished with mean loss 0.77573
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (796 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.24batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.96batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.56batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.49batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.12batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.03batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.00batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 69.64batch/s]  1%|▍                           | 15/1014 [00:00<00:13, 72.09batch/s]  2%|▋                           | 23/1014 [00:00<00:14, 66.76batch/s]  3%|▊                           | 31/1014 [00:00<00:14, 66.52batch/s]  4%|█                           | 39/1014 [00:00<00:14, 68.08batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 70.45batch/s]  6%|█▌                          | 57/1014 [00:00<00:13, 71.78batch/s]  7%|█▊                          | 66/1014 [00:00<00:13, 72.24batch/s]  7%|██                          | 75/1014 [00:01<00:13, 71.69batch/s]  8%|██▎                         | 84/1014 [00:01<00:12, 72.33batch/s]  9%|██▌                         | 93/1014 [00:01<00:12, 72.19batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 73.93batch/s] 11%|███                        | 113/1014 [00:01<00:12, 74.69batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.17batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 74.08batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 73.94batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.98batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 74.37batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 74.30batch/s] 18%|████▊                      | 183/1014 [00:02<00:11, 74.70batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 74.70batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.46batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.24batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 74.02batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 73.78batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 73.79batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 74.22batch/s] 26%|███████                    | 263/1014 [00:03<00:10, 74.68batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 74.91batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 75.23batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.25batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 75.03batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 75.33batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.10batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.85batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:09, 74.46batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 74.46batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 74.75batch/s] 37%|█████████▉                 | 373/1014 [00:05<00:08, 74.59batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.62batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.84batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.71batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.79batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.64batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 74.65batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 74.48batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.59batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.93batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.01batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 75.06batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.20batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.19batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.26batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.46batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.66batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.60batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.70batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 75.72batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.67batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.54batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.55batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 75.57batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.68batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.83batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.76batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.46batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.43batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.59batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.47batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.61batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.59batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.59batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.89batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.96batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.84batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.85batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 75.86batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 75.75batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.72batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 75.60batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 75.48batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.40batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.31batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.28batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 75.17batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.22batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.31batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 75.31batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.42batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 75.53batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.54batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.49batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.54batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.43batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.43batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.36batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.49batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 75.42batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.37batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 75.38batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.35batch/s]
Validation 68 -> LOSS = 1.34
Validation 68 -> BLEU = 48.14, 72.3/54.2/42.1/32.9 (BP=0.998, ratio=0.998, hyp_len=14350, ref_len=14382)
Early stopping patience: 0
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Starting Epoch 69
Early stopped.
--> This is model: simultaneouswaitknmt-rc615e
--> Best LOSS so far: 1.33 @ validation 28
--> Best BLEU so far: 48.33 @ validation 58
Training finished on 03-06-2020 01:06
Wed Jun  3 01:06:26 2020       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 435.21       Driver Version: 435.21       CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  TITAN Xp            On   | 00000000:1B:00.0 Off |                  N/A |
| 30%   48C    P0    63W / 250W |      0MiB / 12196MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
-------
[train]
-------
         num_workers:0
          pin_memory:False
                seed:1582660384
               gclip:1
              l2_reg:1e-05
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
          model_type:SimultaneousWaitKNMT
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:64
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:
             de-hyphen
     eval_batch_size:32
           eval_freq:0
        eval_max_len:100
          eval_start:1
           eval_zero:False
   save_best_metrics:True
           save_path:/homes/al4616/experiments/simnmt/nmtpy/word2word/en-fr
    save_optim_state:False
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/homes/al4616/experiments/simnmt/nmtpy/word2word/en-fr/tb_dir
     pretrained_file:
   pretrained_layers:
       freeze_layers:
          handle_oom:False
           subfolder:wait3-rnn-unimodal
              exp_id:simultaneouswaitknmt-r31e88
------
[vars]
------
                  sl:en
                  tl:fr
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             enc_dim:320
   enc_bidirectional:False
             dec_dim:320
             emb_dim:200
         dropout_emb:0.4
         dropout_ctx:0.5
         dropout_out:0.5
          n_encoders:2
            tied_emb:2way
             max_len:None
           out_logic:deep
           direction:src:Text -> trg:Text
        sampler_type:bucket
           bucket_by:src
     translator_args:
                     k:3
------
[data]
------
            txt_root:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr
           train_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.fr
             val_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.fr
test_2016_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.fr
test_2017_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.fr
------------
[vocabulary]
------------
                 src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.en
                 trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.fr
----------------------------------------------------------------------

Python 3.7.7 -- torch 1.4.0 with CUDA 10.1 (on machine 'kingfisher.doc.ic.ac.uk')
nmtpytorch 4.1.0
DeviceManager(cuda:0, n_gpu=1)
Seed for further reproducibility: 1582660384
SLURM Job ID: 7213
Loading dataset(s)
Initializing dataset for 'src'...
0sents [00:00, ?sents/s]18187sents [00:00, 181832.02sents/s]29000sents [00:00, 178087.74sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]15152sents [00:00, 151489.44sents/s]29000sents [00:00, 148089.17sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'train.lc.norm.tok.en' (29000 sentences)
  Targets:
    --> TextDataset 'train.lc.norm.tok.fr' (29000 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 166621.91sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]1014sents [00:00, 142037.35sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)
  Targets:
    --> TextDataset 'val.lc.norm.tok.fr' (1014 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 167093.24sents/s]
Skipping 'trg' as target
MultimodalDataset - (1 source(s) / 0 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)

Ignoring batch_size 32 for simultaneous greedy search
SimultaneousWaitKNMT(
  (encoders): ModuleDict(
    (src): TextEncoder(
      (do_emb): Dropout(p=0.4, inplace=False)
      (emb): Embedding(9797, 200, padding_idx=0)
      (enc): GRU(200, 320, num_layers=2)
      (output): Sequential(
        (0): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (dec): SimultaneousConditionalDecoder(
    (emb): Embedding(11048, 200, padding_idx=0)
    (att): ModuleDict(
      (src): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
    )
    (dec0): GRUCell(200, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.5, inplace=False)
    (hid2out): FF(in_features=840, out_features=200, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=200, out_features=11048, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss()
  )
)
Vocabulary of 9797 items ('train.lc.norm.tok.vocab.en')
Vocabulary of 11048 items ('train.lc.norm.tok.vocab.fr')
# parameters: 6.89M (6.89M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 1e-05, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Training started on 03-06-2020 01:06:31
Starting Epoch 1
Epoch 1 - update         30 => loss:   6.723 (#OOM: 0)
Epoch 1 - update         60 => loss:   5.699 (#OOM: 0)
Epoch 1 - update         90 => loss:   5.154 (#OOM: 0)
Epoch 1 - update        120 => loss:   4.929 (#OOM: 0)
Epoch 1 - update        150 => loss:   4.303 (#OOM: 0)
Epoch 1 - update        180 => loss:   4.654 (#OOM: 0)
Epoch 1 - update        210 => loss:   4.464 (#OOM: 0)
Epoch 1 - update        240 => loss:   4.371 (#OOM: 0)
Epoch 1 - update        270 => loss:   4.003 (#OOM: 0)
Epoch 1 - update        300 => loss:   4.128 (#OOM: 0)
Epoch 1 - update        330 => loss:   3.858 (#OOM: 0)
Epoch 1 - update        360 => loss:   3.468 (#OOM: 0)
Epoch 1 - update        390 => loss:   3.918 (#OOM: 0)
Epoch 1 - update        420 => loss:   3.798 (#OOM: 0)
Epoch 1 - update        450 => loss:   3.952 (#OOM: 0)
--> Epoch 1 finished with mean loss 4.59345
--> Overhead/Training/Evaluation: 0.04/0.65/0.00 mins (total: 0.69 mins)   (748 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 38.88batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.28batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.60batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 50.04batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 50.96batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.13batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.74batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 72.54batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 72.37batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 70.53batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 71.93batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 71.71batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 68.58batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 70.66batch/s]  8%|██▏                         | 81/1014 [00:01<00:13, 70.84batch/s]  9%|██▍                         | 90/1014 [00:01<00:13, 70.24batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 70.62batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 70.79batch/s] 12%|███                        | 117/1014 [00:01<00:12, 70.38batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 71.11batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 72.11batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 72.91batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.67batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.67batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.93batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 73.65batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.51batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 74.03batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 74.33batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.31batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.39batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.70batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.63batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 73.31batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 73.71batch/s] 27%|███████▏                   | 270/1014 [00:03<00:10, 74.11batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 74.42batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 74.89batch/s] 29%|███████▉                   | 299/1014 [00:03<00:09, 74.78batch/s] 30%|████████▏                  | 309/1014 [00:04<00:09, 75.07batch/s] 31%|████████▍                  | 319/1014 [00:04<00:09, 74.98batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 74.49batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 74.52batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 74.94batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 73.96batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 74.15batch/s] 37%|██████████                 | 379/1014 [00:05<00:08, 73.02batch/s] 38%|██████████▎                | 389/1014 [00:05<00:08, 72.86batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 72.12batch/s] 40%|██████████▉                | 409/1014 [00:05<00:08, 72.31batch/s] 41%|███████████▏               | 419/1014 [00:05<00:08, 72.15batch/s] 42%|███████████▍               | 429/1014 [00:05<00:08, 72.30batch/s] 43%|███████████▋               | 439/1014 [00:06<00:07, 72.43batch/s] 44%|███████████▉               | 449/1014 [00:06<00:07, 72.80batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 73.00batch/s] 46%|████████████▍              | 469/1014 [00:06<00:07, 72.73batch/s] 47%|████████████▊              | 479/1014 [00:06<00:07, 72.64batch/s] 48%|█████████████              | 489/1014 [00:06<00:07, 72.76batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:07, 72.72batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 72.99batch/s] 51%|█████████████▊             | 519/1014 [00:07<00:06, 72.72batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 72.55batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 72.68batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 72.53batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:06, 72.64batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:06, 72.81batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 73.10batch/s] 58%|███████████████▋           | 589/1014 [00:08<00:05, 73.27batch/s] 59%|███████████████▉           | 599/1014 [00:08<00:05, 72.67batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 72.70batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 72.77batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 72.70batch/s] 63%|█████████████████          | 639/1014 [00:08<00:05, 72.92batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 73.06batch/s] 65%|█████████████████▌         | 659/1014 [00:09<00:04, 73.08batch/s] 66%|█████████████████▊         | 669/1014 [00:09<00:04, 73.01batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 72.99batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 73.22batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 73.30batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 73.37batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:04, 72.88batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 72.98batch/s] 73%|███████████████████▋       | 739/1014 [00:10<00:03, 73.06batch/s] 74%|███████████████████▉       | 749/1014 [00:10<00:03, 73.05batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 73.01batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 72.95batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 72.91batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 72.88batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 72.98batch/s] 80%|█████████████████████▌     | 809/1014 [00:11<00:02, 73.07batch/s] 81%|█████████████████████▊     | 819/1014 [00:11<00:02, 73.26batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 73.31batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 73.40batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 73.43batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 72.99batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 72.96batch/s] 87%|███████████████████████▍   | 879/1014 [00:12<00:01, 72.99batch/s] 88%|███████████████████████▋   | 889/1014 [00:12<00:01, 73.08batch/s] 89%|███████████████████████▉   | 899/1014 [00:12<00:01, 73.10batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 73.20batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 73.34batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 73.49batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:01, 73.59batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 73.32batch/s] 95%|█████████████████████████▌ | 959/1014 [00:13<00:00, 73.31batch/s] 96%|█████████████████████████▊ | 969/1014 [00:13<00:00, 73.27batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 73.04batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 73.11batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 73.14batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 73.20batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 72.85batch/s]
Validation 1 -> LOSS = 3.17
Validation 1 -> BLEU = 13.30, 45.3/19.0/8.7/4.2 (BP=0.997, ratio=0.997, hyp_len=14335, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 3.17 @ validation 1
--> Best BLEU so far: 13.30 @ validation 1
Starting Epoch 2
Epoch 2 - update        480 => loss:   3.984 (#OOM: 0)
Epoch 2 - update        510 => loss:   3.486 (#OOM: 0)
Epoch 2 - update        540 => loss:   3.155 (#OOM: 0)
Epoch 2 - update        570 => loss:   3.112 (#OOM: 0)
Epoch 2 - update        600 => loss:   3.637 (#OOM: 0)
Epoch 2 - update        630 => loss:   3.130 (#OOM: 0)
Epoch 2 - update        660 => loss:   3.187 (#OOM: 0)
Epoch 2 - update        690 => loss:   3.048 (#OOM: 0)
Epoch 2 - update        720 => loss:   3.295 (#OOM: 0)
Epoch 2 - update        750 => loss:   3.187 (#OOM: 0)
Epoch 2 - update        780 => loss:   3.138 (#OOM: 0)
Epoch 2 - update        810 => loss:   3.076 (#OOM: 0)
Epoch 2 - update        840 => loss:   2.916 (#OOM: 0)
Epoch 2 - update        870 => loss:   2.844 (#OOM: 0)
Epoch 2 - update        900 => loss:   2.774 (#OOM: 0)
Epoch 2 - update        930 => loss:   2.819 (#OOM: 0)
--> Epoch 2 finished with mean loss 3.14459
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (826 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.70batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.65batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.30batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.98batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.67batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.88batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 64.98batch/s]  1%|▍                           | 14/1014 [00:00<00:15, 64.77batch/s]  2%|▌                           | 22/1014 [00:00<00:14, 68.41batch/s]  3%|▊                           | 30/1014 [00:00<00:14, 68.11batch/s]  4%|█                           | 38/1014 [00:00<00:15, 61.28batch/s]  5%|█▎                          | 46/1014 [00:00<00:16, 57.26batch/s]  5%|█▍                          | 54/1014 [00:01<00:18, 53.32batch/s]  6%|█▋                          | 62/1014 [00:01<00:19, 49.20batch/s]  7%|█▉                          | 70/1014 [00:01<00:18, 50.50batch/s]  8%|██▏                         | 79/1014 [00:01<00:17, 52.68batch/s]  9%|██▍                         | 88/1014 [00:01<00:17, 51.97batch/s] 10%|██▋                         | 97/1014 [00:01<00:17, 51.74batch/s] 10%|██▊                        | 106/1014 [00:02<00:17, 52.59batch/s] 11%|███                        | 115/1014 [00:02<00:17, 52.33batch/s] 12%|███▎                       | 124/1014 [00:02<00:16, 53.25batch/s] 13%|███▌                       | 133/1014 [00:02<00:16, 52.74batch/s] 14%|███▊                       | 142/1014 [00:02<00:16, 53.52batch/s] 15%|████                       | 151/1014 [00:02<00:16, 53.66batch/s] 16%|████▎                      | 160/1014 [00:02<00:15, 54.44batch/s] 17%|████▌                      | 169/1014 [00:03<00:15, 55.47batch/s] 18%|████▋                      | 178/1014 [00:03<00:15, 55.67batch/s] 18%|████▉                      | 187/1014 [00:03<00:14, 56.08batch/s] 19%|█████▏                     | 196/1014 [00:03<00:14, 56.97batch/s] 20%|█████▍                     | 205/1014 [00:03<00:14, 57.59batch/s] 21%|█████▋                     | 214/1014 [00:03<00:13, 58.30batch/s] 22%|█████▉                     | 223/1014 [00:03<00:13, 57.32batch/s] 23%|██████▏                    | 232/1014 [00:04<00:13, 57.96batch/s] 24%|██████▍                    | 241/1014 [00:04<00:13, 58.43batch/s] 25%|██████▋                    | 250/1014 [00:04<00:12, 58.83batch/s] 26%|██████▉                    | 259/1014 [00:04<00:12, 58.26batch/s] 26%|███████▏                   | 268/1014 [00:04<00:13, 57.08batch/s] 27%|███████▍                   | 277/1014 [00:04<00:12, 57.40batch/s] 28%|███████▌                   | 286/1014 [00:04<00:12, 57.29batch/s] 29%|███████▊                   | 295/1014 [00:05<00:12, 56.98batch/s] 30%|████████                   | 304/1014 [00:05<00:12, 57.20batch/s] 31%|████████▎                  | 313/1014 [00:05<00:12, 57.43batch/s] 32%|████████▌                  | 322/1014 [00:05<00:11, 57.96batch/s] 33%|████████▊                  | 331/1014 [00:05<00:11, 57.60batch/s] 34%|█████████                  | 340/1014 [00:05<00:11, 57.96batch/s] 34%|█████████▎                 | 349/1014 [00:06<00:11, 58.08batch/s] 35%|█████████▌                 | 358/1014 [00:06<00:11, 57.77batch/s] 36%|█████████▊                 | 367/1014 [00:06<00:11, 58.10batch/s] 37%|██████████                 | 376/1014 [00:06<00:10, 58.45batch/s] 38%|██████████▎                | 385/1014 [00:06<00:10, 57.59batch/s] 39%|██████████▍                | 394/1014 [00:06<00:10, 57.54batch/s] 40%|██████████▋                | 403/1014 [00:07<00:10, 56.94batch/s] 41%|██████████▉                | 412/1014 [00:07<00:10, 57.21batch/s] 42%|███████████▏               | 421/1014 [00:07<00:10, 57.47batch/s] 42%|███████████▍               | 430/1014 [00:07<00:10, 57.79batch/s] 43%|███████████▋               | 439/1014 [00:07<00:10, 57.44batch/s] 44%|███████████▉               | 448/1014 [00:07<00:09, 57.54batch/s] 45%|████████████▏              | 457/1014 [00:07<00:09, 57.70batch/s] 46%|████████████▍              | 466/1014 [00:08<00:09, 57.89batch/s] 47%|████████████▋              | 475/1014 [00:08<00:09, 57.12batch/s] 48%|████████████▉              | 484/1014 [00:08<00:09, 57.25batch/s] 49%|█████████████▏             | 493/1014 [00:08<00:09, 57.35batch/s] 50%|█████████████▎             | 502/1014 [00:08<00:08, 57.64batch/s] 50%|█████████████▌             | 511/1014 [00:09<00:08, 56.56batch/s] 51%|█████████████▊             | 520/1014 [00:09<00:08, 56.83batch/s] 52%|██████████████             | 529/1014 [00:09<00:08, 57.06batch/s] 53%|██████████████▎            | 538/1014 [00:09<00:08, 56.86batch/s] 54%|██████████████▌            | 548/1014 [00:09<00:08, 57.28batch/s] 55%|██████████████▊            | 558/1014 [00:09<00:07, 57.46batch/s] 56%|███████████████            | 568/1014 [00:09<00:07, 57.69batch/s] 57%|███████████████▍           | 578/1014 [00:10<00:07, 57.73batch/s] 58%|███████████████▋           | 588/1014 [00:10<00:07, 57.50batch/s] 59%|███████████████▉           | 598/1014 [00:10<00:07, 57.58batch/s] 60%|████████████████▏          | 608/1014 [00:10<00:07, 57.37batch/s] 61%|████████████████▍          | 618/1014 [00:10<00:06, 57.29batch/s] 62%|████████████████▋          | 628/1014 [00:10<00:06, 57.47batch/s] 63%|████████████████▉          | 638/1014 [00:11<00:06, 57.74batch/s] 64%|█████████████████▎         | 648/1014 [00:11<00:06, 57.70batch/s] 65%|█████████████████▌         | 658/1014 [00:11<00:06, 57.85batch/s] 66%|█████████████████▊         | 668/1014 [00:11<00:06, 57.40batch/s] 67%|██████████████████         | 678/1014 [00:11<00:05, 57.23batch/s] 68%|██████████████████▎        | 688/1014 [00:12<00:05, 57.11batch/s] 69%|██████████████████▌        | 698/1014 [00:12<00:05, 57.02batch/s] 70%|██████████████████▊        | 708/1014 [00:12<00:05, 56.90batch/s] 71%|███████████████████        | 718/1014 [00:12<00:05, 56.76batch/s] 72%|███████████████████▍       | 728/1014 [00:12<00:05, 56.95batch/s] 73%|███████████████████▋       | 738/1014 [00:12<00:04, 57.07batch/s] 74%|███████████████████▉       | 748/1014 [00:13<00:04, 57.21batch/s] 75%|████████████████████▏      | 758/1014 [00:13<00:04, 57.26batch/s] 76%|████████████████████▍      | 768/1014 [00:13<00:04, 57.35batch/s] 77%|████████████████████▋      | 778/1014 [00:13<00:04, 57.12batch/s] 78%|████████████████████▉      | 788/1014 [00:13<00:03, 57.32batch/s] 79%|█████████████████████▏     | 798/1014 [00:13<00:03, 57.48batch/s] 80%|█████████████████████▌     | 808/1014 [00:14<00:03, 57.32batch/s] 81%|█████████████████████▊     | 818/1014 [00:14<00:03, 57.23batch/s] 82%|██████████████████████     | 828/1014 [00:14<00:03, 57.38batch/s] 83%|██████████████████████▎    | 838/1014 [00:14<00:03, 57.26batch/s] 84%|██████████████████████▌    | 848/1014 [00:14<00:02, 57.47batch/s] 85%|██████████████████████▊    | 858/1014 [00:14<00:02, 57.25batch/s] 86%|███████████████████████    | 868/1014 [00:15<00:02, 57.18batch/s] 87%|███████████████████████▍   | 878/1014 [00:15<00:02, 57.32batch/s] 88%|███████████████████████▋   | 888/1014 [00:15<00:02, 57.16batch/s] 89%|███████████████████████▉   | 898/1014 [00:15<00:02, 57.05batch/s] 90%|████████████████████████▏  | 908/1014 [00:15<00:01, 56.89batch/s] 91%|████████████████████████▍  | 918/1014 [00:16<00:01, 56.80batch/s] 92%|████████████████████████▋  | 928/1014 [00:16<00:01, 56.91batch/s] 93%|████████████████████████▉  | 938/1014 [00:16<00:01, 56.95batch/s] 93%|█████████████████████████▏ | 948/1014 [00:16<00:01, 56.84batch/s] 94%|█████████████████████████▌ | 958/1014 [00:16<00:00, 56.49batch/s] 95%|█████████████████████████▊ | 968/1014 [00:17<00:00, 56.64batch/s] 96%|██████████████████████████ | 978/1014 [00:17<00:00, 56.73batch/s] 97%|██████████████████████████▎| 988/1014 [00:17<00:00, 56.80batch/s] 98%|██████████████████████████▌| 998/1014 [00:17<00:00, 56.94batch/s] 99%|█████████████████████████▊| 1008/1014 [00:17<00:00, 56.85batch/s]100%|██████████████████████████| 1014/1014 [00:17<00:00, 56.93batch/s]
Validation 2 -> LOSS = 2.52
Validation 2 -> BLEU = 16.08, 39.2/20.6/11.9/7.0 (BP=1.000, ratio=1.382, hyp_len=19877, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 2.52 @ validation 2
--> Best BLEU so far: 16.08 @ validation 2
Starting Epoch 3
Epoch 3 - update        960 => loss:   2.553 (#OOM: 0)
Epoch 3 - update        990 => loss:   2.636 (#OOM: 0)
Epoch 3 - update       1020 => loss:   2.570 (#OOM: 0)
Epoch 3 - update       1050 => loss:   2.952 (#OOM: 0)
Epoch 3 - update       1080 => loss:   2.425 (#OOM: 0)
Epoch 3 - update       1110 => loss:   2.507 (#OOM: 0)
Epoch 3 - update       1140 => loss:   2.560 (#OOM: 0)
Epoch 3 - update       1170 => loss:   2.439 (#OOM: 0)
Epoch 3 - update       1200 => loss:   2.244 (#OOM: 0)
Epoch 3 - update       1230 => loss:   2.843 (#OOM: 0)
Epoch 3 - update       1260 => loss:   2.240 (#OOM: 0)
Epoch 3 - update       1290 => loss:   2.786 (#OOM: 0)
Epoch 3 - update       1320 => loss:   2.462 (#OOM: 0)
Epoch 3 - update       1350 => loss:   2.359 (#OOM: 0)
Epoch 3 - update       1380 => loss:   1.972 (#OOM: 0)
Epoch 3 - update       1410 => loss:   2.250 (#OOM: 0)
--> Epoch 3 finished with mean loss 2.62673
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (883 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 41.18batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.62batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.67batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.13batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.76batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.23batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.03batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.86batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 76.65batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 77.58batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 78.24batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.16batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.66batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.72batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 78.66batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 78.28batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 78.99batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 80.08batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 80.09batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 80.20batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 79.42batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 79.33batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 79.52batch/s] 16%|████▎                      | 160/1014 [00:02<00:10, 79.50batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 79.74batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 79.19batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 78.76batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 79.12batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 78.79batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 76.98batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 76.54batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 76.19batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 76.14batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 76.20batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 75.94batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 74.31batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 74.19batch/s] 30%|███████▉                   | 300/1014 [00:04<00:09, 73.94batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 74.06batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 74.04batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 74.13batch/s] 34%|█████████                  | 340/1014 [00:04<00:09, 73.90batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 74.06batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 74.34batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 74.35batch/s] 37%|██████████                 | 380/1014 [00:05<00:08, 74.08batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 74.02batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 74.25batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 74.32batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 74.27batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 74.08batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 74.18batch/s] 44%|███████████▉               | 450/1014 [00:06<00:07, 74.40batch/s] 45%|████████████▏              | 460/1014 [00:06<00:07, 74.33batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 74.24batch/s] 47%|████████████▊              | 480/1014 [00:06<00:07, 74.39batch/s] 48%|█████████████              | 490/1014 [00:06<00:07, 73.65batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 73.73batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 73.88batch/s] 51%|█████████████▊             | 520/1014 [00:07<00:06, 73.57batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 73.52batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 73.76batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 74.06batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:06, 74.21batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 74.25batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 74.21batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 74.34batch/s] 59%|███████████████▉           | 600/1014 [00:08<00:05, 74.29batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 74.28batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 74.17batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 74.22batch/s] 63%|█████████████████          | 640/1014 [00:08<00:05, 73.98batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 73.82batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 73.87batch/s] 66%|█████████████████▊         | 670/1014 [00:09<00:04, 73.85batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 73.24batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 73.40batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 72.94batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 73.01batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:04, 73.06batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 73.15batch/s] 73%|███████████████████▋       | 740/1014 [00:10<00:03, 73.07batch/s] 74%|███████████████████▉       | 750/1014 [00:10<00:03, 73.20batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 73.15batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 72.64batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 72.66batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:03, 72.78batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 72.85batch/s] 80%|█████████████████████▌     | 810/1014 [00:11<00:02, 73.01batch/s] 81%|█████████████████████▊     | 820/1014 [00:11<00:02, 73.06batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 73.12batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 73.03batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 72.89batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 72.90batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 73.04batch/s] 87%|███████████████████████▍   | 880/1014 [00:12<00:01, 73.08batch/s] 88%|███████████████████████▋   | 890/1014 [00:12<00:01, 73.20batch/s] 89%|███████████████████████▉   | 900/1014 [00:12<00:01, 73.19batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 73.28batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 73.28batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 73.35batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:01, 73.38batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 73.39batch/s] 95%|█████████████████████████▌ | 960/1014 [00:13<00:00, 73.38batch/s] 96%|█████████████████████████▊ | 970/1014 [00:13<00:00, 73.37batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 73.47batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 73.54batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 73.58batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 73.66batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.67batch/s]
Validation 3 -> LOSS = 2.16
Validation 3 -> BLEU = 28.94, 57.5/34.9/23.0/15.2 (BP=1.000, ratio=1.016, hyp_len=14614, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 2.16 @ validation 3
--> Best BLEU so far: 28.94 @ validation 3
Starting Epoch 4
Epoch 4 - update       1440 => loss:   2.004 (#OOM: 0)
Epoch 4 - update       1470 => loss:   2.101 (#OOM: 0)
Epoch 4 - update       1500 => loss:   2.482 (#OOM: 0)
Epoch 4 - update       1530 => loss:   2.228 (#OOM: 0)
Epoch 4 - update       1560 => loss:   2.401 (#OOM: 0)
Epoch 4 - update       1590 => loss:   2.266 (#OOM: 0)
Epoch 4 - update       1620 => loss:   2.306 (#OOM: 0)
Epoch 4 - update       1650 => loss:   2.171 (#OOM: 0)
Epoch 4 - update       1680 => loss:   2.023 (#OOM: 0)
Epoch 4 - update       1710 => loss:   2.337 (#OOM: 0)
Epoch 4 - update       1740 => loss:   2.044 (#OOM: 0)
Epoch 4 - update       1770 => loss:   2.442 (#OOM: 0)
Epoch 4 - update       1800 => loss:   2.045 (#OOM: 0)
Epoch 4 - update       1830 => loss:   2.593 (#OOM: 0)
Epoch 4 - update       1860 => loss:   2.122 (#OOM: 0)
Epoch 4 - update       1890 => loss:   2.219 (#OOM: 0)
--> Epoch 4 finished with mean loss 2.30571
--> Overhead/Training/Evaluation: 0.03/0.52/0.00 mins (total: 0.54 mins)   (937 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 59.83batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.58batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.51batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.27batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.66batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.08batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.39batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.64batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.08batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 75.90batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 76.10batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 74.97batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 74.58batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 75.02batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 76.40batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 76.92batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 77.24batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 77.46batch/s] 11%|███                        | 115/1014 [00:01<00:11, 77.88batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 78.29batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 78.22batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 77.29batch/s] 15%|████                       | 151/1014 [00:01<00:11, 77.80batch/s] 16%|████▎                      | 160/1014 [00:02<00:10, 77.77batch/s] 17%|████▌                      | 169/1014 [00:02<00:10, 78.18batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 78.66batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 77.66batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 77.31batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 75.09batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 75.02batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 74.50batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 74.80batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.30batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 73.99batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 73.59batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 73.68batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 73.50batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 73.63batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.11batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.23batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 73.87batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 74.16batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 73.90batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 74.01batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 74.22batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 74.35batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.13batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 73.95batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.17batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 73.86batch/s] 41%|███████████                | 416/1014 [00:05<00:08, 73.64batch/s] 42%|███████████▎               | 426/1014 [00:05<00:08, 72.96batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 73.10batch/s] 44%|███████████▉               | 446/1014 [00:06<00:07, 73.27batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 73.16batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 72.97batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 73.02batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 72.76batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:07, 72.81batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 72.78batch/s] 51%|█████████████▋             | 516/1014 [00:07<00:06, 72.82batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 72.93batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 72.89batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 72.74batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 72.68batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 72.49batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:06, 72.42batch/s] 58%|███████████████▌           | 586/1014 [00:08<00:05, 72.28batch/s] 59%|███████████████▊           | 596/1014 [00:08<00:05, 72.35batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 72.45batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 72.49batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 72.53batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 72.38batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:05, 72.51batch/s] 65%|█████████████████▍         | 656/1014 [00:09<00:04, 72.50batch/s] 66%|█████████████████▋         | 666/1014 [00:09<00:04, 72.48batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 72.63batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 72.75batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 72.17batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 71.92batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 71.73batch/s] 72%|███████████████████▎       | 726/1014 [00:10<00:04, 71.81batch/s] 73%|███████████████████▌       | 736/1014 [00:10<00:03, 71.68batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 71.24batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 71.35batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 71.42batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 71.34batch/s] 78%|████████████████████▉      | 786/1014 [00:11<00:03, 71.37batch/s] 79%|█████████████████████▏     | 796/1014 [00:11<00:03, 71.48batch/s] 79%|█████████████████████▍     | 806/1014 [00:11<00:02, 71.53batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 71.45batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 71.32batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 71.30batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 71.31batch/s] 84%|██████████████████████▊    | 856/1014 [00:12<00:02, 70.96batch/s] 85%|███████████████████████    | 866/1014 [00:12<00:02, 70.92batch/s] 86%|███████████████████████▎   | 876/1014 [00:12<00:01, 70.94batch/s] 87%|███████████████████████▌   | 886/1014 [00:12<00:01, 70.97batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 70.99batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 71.05batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 71.14batch/s] 91%|████████████████████████▋  | 926/1014 [00:13<00:01, 71.16batch/s] 92%|████████████████████████▉  | 936/1014 [00:13<00:01, 71.28batch/s] 93%|█████████████████████████▏ | 946/1014 [00:13<00:00, 71.46batch/s] 94%|█████████████████████████▍ | 956/1014 [00:13<00:00, 71.46batch/s] 95%|█████████████████████████▋ | 966/1014 [00:13<00:00, 71.45batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 71.39batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 71.48batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 71.56batch/s] 99%|█████████████████████████▊| 1006/1014 [00:14<00:00, 71.65batch/s]100%|██████████████████████████| 1014/1014 [00:14<00:00, 71.67batch/s]
Validation 4 -> LOSS = 1.93
Validation 4 -> BLEU = 32.66, 60.4/38.9/26.5/18.2 (BP=1.000, ratio=1.039, hyp_len=14938, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.93 @ validation 4
--> Best BLEU so far: 32.66 @ validation 4
Starting Epoch 5
Epoch 5 - update       1920 => loss:   2.541 (#OOM: 0)
Epoch 5 - update       1950 => loss:   1.981 (#OOM: 0)
Epoch 5 - update       1980 => loss:   1.874 (#OOM: 0)
Epoch 5 - update       2010 => loss:   2.043 (#OOM: 0)
Epoch 5 - update       2040 => loss:   1.900 (#OOM: 0)
Epoch 5 - update       2070 => loss:   2.040 (#OOM: 0)
Epoch 5 - update       2100 => loss:   1.779 (#OOM: 0)
Epoch 5 - update       2130 => loss:   2.123 (#OOM: 0)
Epoch 5 - update       2160 => loss:   2.129 (#OOM: 0)
Epoch 5 - update       2190 => loss:   1.811 (#OOM: 0)
Epoch 5 - update       2220 => loss:   1.810 (#OOM: 0)
Epoch 5 - update       2250 => loss:   1.696 (#OOM: 0)
Epoch 5 - update       2280 => loss:   2.401 (#OOM: 0)
Epoch 5 - update       2310 => loss:   1.968 (#OOM: 0)
Epoch 5 - update       2340 => loss:   1.681 (#OOM: 0)
Epoch 5 - update       2370 => loss:   2.503 (#OOM: 0)
--> Epoch 5 finished with mean loss 2.07127
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.59 mins)   (874 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.08batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.45batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 45.69batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 48.95batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 51.94batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.31batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.29batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.72batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 79.29batch/s]  2%|▋                           | 25/1014 [00:00<00:11, 82.59batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 81.54batch/s]  4%|█▏                          | 43/1014 [00:00<00:11, 81.96batch/s]  5%|█▍                          | 52/1014 [00:00<00:11, 80.34batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 78.30batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 77.70batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 76.07batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 74.84batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 75.21batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 74.78batch/s] 11%|███                        | 115/1014 [00:01<00:11, 75.42batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 75.69batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.27batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 75.56batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.12batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 75.93batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 76.05batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 76.36batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.54batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.72batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.44batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 76.84batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 76.93batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 77.32batch/s] 24%|██████▍                    | 241/1014 [00:03<00:09, 77.69batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 77.13batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 76.96batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 77.08batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 77.34batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 77.36batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 77.32batch/s] 30%|████████                   | 304/1014 [00:03<00:09, 77.32batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 77.27batch/s] 32%|████████▌                  | 322/1014 [00:04<00:08, 76.93batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 76.63batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 76.98batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 77.20batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 77.47batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 77.41batch/s] 38%|██████████▏                | 381/1014 [00:04<00:08, 77.47batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 77.29batch/s] 40%|██████████▋                | 401/1014 [00:05<00:07, 77.22batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 77.20batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 77.16batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 77.14batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 77.27batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 77.13batch/s] 45%|████████████▎              | 461/1014 [00:05<00:07, 77.18batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 77.17batch/s] 47%|████████████▊              | 481/1014 [00:06<00:06, 76.91batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 77.08batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 77.13batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 77.04batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 77.08batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 77.06batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 76.94batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 77.08batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 76.27batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 76.29batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 76.35batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 76.30batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 76.41batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:05, 76.42batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 76.14batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 76.03batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 76.19batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 76.27batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 76.13batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 76.13batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 76.20batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 76.38batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 76.29batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:03, 76.21batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 76.52batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 76.33batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 76.33batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 76.34batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 76.13batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 76.09batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 76.08batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 76.11batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 76.11batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 76.17batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 76.30batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 76.26batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 76.29batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 76.20batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 76.31batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 76.30batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 76.33batch/s] 90%|████████████████████████▏  | 909/1014 [00:11<00:01, 76.11batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 76.04batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 76.05batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.98batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.99batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.74batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.73batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 75.60batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.62batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.62batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.69batch/s]
Validation 5 -> LOSS = 1.77
Validation 5 -> BLEU = 36.43, 65.0/43.4/30.7/21.6 (BP=0.985, ratio=0.985, hyp_len=14162, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.77 @ validation 5
--> Best BLEU so far: 36.43 @ validation 5
Starting Epoch 6
Epoch 6 - update       2400 => loss:   2.280 (#OOM: 0)
Epoch 6 - update       2430 => loss:   2.153 (#OOM: 0)
Epoch 6 - update       2460 => loss:   2.025 (#OOM: 0)
Epoch 6 - update       2490 => loss:   1.832 (#OOM: 0)
Epoch 6 - update       2520 => loss:   1.993 (#OOM: 0)
Epoch 6 - update       2550 => loss:   1.847 (#OOM: 0)
Epoch 6 - update       2580 => loss:   1.823 (#OOM: 0)
Epoch 6 - update       2610 => loss:   1.942 (#OOM: 0)
Epoch 6 - update       2640 => loss:   1.916 (#OOM: 0)
Epoch 6 - update       2670 => loss:   1.515 (#OOM: 0)
Epoch 6 - update       2700 => loss:   2.960 (#OOM: 0)
Epoch 6 - update       2730 => loss:   1.828 (#OOM: 0)
Epoch 6 - update       2760 => loss:   2.384 (#OOM: 0)
Epoch 6 - update       2790 => loss:   2.058 (#OOM: 0)
Epoch 6 - update       2820 => loss:   2.024 (#OOM: 0)
Epoch 6 - update       2850 => loss:   1.703 (#OOM: 0)
--> Epoch 6 finished with mean loss 1.88899
--> Overhead/Training/Evaluation: 0.02/0.47/0.00 mins (total: 0.49 mins)   (1030 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.90batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.33batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.08batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.88batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 50.72batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.52batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.98batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.25batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 70.76batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 72.08batch/s]  4%|█                           | 40/1014 [00:00<00:13, 72.83batch/s]  5%|█▎                          | 49/1014 [00:00<00:12, 74.48batch/s]  6%|█▌                          | 58/1014 [00:00<00:12, 74.04batch/s]  7%|█▊                          | 67/1014 [00:00<00:12, 74.33batch/s]  7%|██                          | 76/1014 [00:01<00:13, 70.44batch/s]  8%|██▎                         | 85/1014 [00:01<00:13, 70.88batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 71.45batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 72.59batch/s] 11%|██▉                        | 112/1014 [00:01<00:12, 72.56batch/s] 12%|███▏                       | 121/1014 [00:01<00:12, 71.91batch/s] 13%|███▍                       | 130/1014 [00:01<00:12, 72.05batch/s] 14%|███▋                       | 139/1014 [00:01<00:12, 72.65batch/s] 15%|███▉                       | 148/1014 [00:02<00:11, 73.03batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 72.82batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 72.99batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 73.17batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 73.35batch/s] 19%|█████▏                     | 193/1014 [00:02<00:11, 73.36batch/s] 20%|█████▍                     | 202/1014 [00:02<00:11, 72.77batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 73.31batch/s] 22%|█████▊                     | 220/1014 [00:03<00:10, 73.04batch/s] 23%|██████                     | 229/1014 [00:03<00:10, 73.29batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 73.76batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 73.85batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 73.88batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.05batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.56batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.77batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.95batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.08batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.50batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 75.69batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 75.72batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 75.90batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 75.76batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.85batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 76.17batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 76.31batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.99batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.70batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 75.75batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.78batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 76.06batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 76.27batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 76.04batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.97batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 76.26batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 76.32batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 76.24batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 76.20batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 76.11batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.77batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 75.83batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.58batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.52batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.64batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.60batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.66batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 75.54batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 75.63batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 75.67batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.61batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.60batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.63batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.62batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.76batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.75batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.85batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.85batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.91batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.88batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.88batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.88batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.87batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 75.91batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.97batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.92batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 76.06batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 76.16batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 76.19batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 76.30batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 76.00batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 76.00batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 76.07batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 76.17batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 76.09batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 76.04batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.96batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.95batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.93batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 76.01batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.61batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.24batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.08batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.09batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.11batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.01batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.83batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.89batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.87batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.96batch/s]
Validation 6 -> LOSS = 1.66
Validation 6 -> BLEU = 39.83, 67.0/46.6/34.0/24.8 (BP=0.990, ratio=0.990, hyp_len=14234, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.66 @ validation 6
--> Best BLEU so far: 39.83 @ validation 6
Starting Epoch 7
Epoch 7 - update       2880 => loss:   2.103 (#OOM: 0)
Epoch 7 - update       2910 => loss:   1.721 (#OOM: 0)
Epoch 7 - update       2940 => loss:   1.763 (#OOM: 0)
Epoch 7 - update       2970 => loss:   1.903 (#OOM: 0)
Epoch 7 - update       3000 => loss:   2.092 (#OOM: 0)
Epoch 7 - update       3030 => loss:   1.718 (#OOM: 0)
Epoch 7 - update       3060 => loss:   1.493 (#OOM: 0)
Epoch 7 - update       3090 => loss:   1.327 (#OOM: 0)
Epoch 7 - update       3120 => loss:   1.524 (#OOM: 0)
Epoch 7 - update       3150 => loss:   1.913 (#OOM: 0)
Epoch 7 - update       3180 => loss:   1.660 (#OOM: 0)
Epoch 7 - update       3210 => loss:   1.598 (#OOM: 0)
Epoch 7 - update       3240 => loss:   1.916 (#OOM: 0)
Epoch 7 - update       3270 => loss:   1.586 (#OOM: 0)
Epoch 7 - update       3300 => loss:   1.373 (#OOM: 0)
Epoch 7 - update       3330 => loss:   1.699 (#OOM: 0)
--> Epoch 7 finished with mean loss 1.74776
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.62 mins)   (824 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.61batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 48.26batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 50.83batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.09batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 50.19batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.57batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.80batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 63.66batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 67.86batch/s]  2%|▋                           | 23/1014 [00:00<00:14, 70.17batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.50batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 73.49batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 74.27batch/s]  6%|█▋                          | 59/1014 [00:00<00:13, 72.44batch/s]  7%|█▉                          | 68/1014 [00:00<00:13, 71.92batch/s]  8%|██▏                         | 77/1014 [00:01<00:13, 71.05batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 71.76batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 72.06batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 71.91batch/s] 11%|███                        | 113/1014 [00:01<00:12, 71.66batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 71.91batch/s] 13%|███▍                       | 131/1014 [00:01<00:12, 72.80batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 73.42batch/s] 15%|███▉                       | 149/1014 [00:02<00:11, 72.45batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 72.89batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 72.48batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 72.35batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 70.89batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 71.21batch/s] 20%|█████▍                     | 203/1014 [00:02<00:11, 71.38batch/s] 21%|█████▋                     | 212/1014 [00:03<00:11, 70.26batch/s] 22%|█████▉                     | 221/1014 [00:03<00:11, 70.37batch/s] 23%|██████                     | 230/1014 [00:03<00:11, 70.88batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 71.07batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 71.31batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 71.24batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 71.55batch/s] 27%|███████▎                   | 275/1014 [00:03<00:10, 71.67batch/s] 28%|███████▌                   | 284/1014 [00:03<00:10, 71.76batch/s] 29%|███████▊                   | 293/1014 [00:04<00:10, 72.02batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 71.79batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 71.09batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 71.17batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 71.31batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 71.55batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:09, 71.67batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:09, 71.79batch/s] 36%|█████████▋                 | 365/1014 [00:05<00:09, 72.08batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 72.54batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 72.96batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 73.29batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 73.47batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 73.73batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 73.83batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 73.92batch/s] 44%|███████████▊               | 445/1014 [00:06<00:07, 73.76batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 73.69batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 73.68batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 73.71batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 73.70batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:07, 73.89batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 73.83batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 73.79batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 73.91batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 74.14batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 73.76batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 73.88batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 74.00batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.06batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 73.93batch/s] 59%|███████████████▊           | 595/1014 [00:08<00:05, 74.04batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 74.11batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 73.99batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 74.01batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 74.13batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 73.82batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 73.85batch/s] 66%|█████████████████▋         | 665/1014 [00:09<00:04, 73.74batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 73.63batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 73.62batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 73.75batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 73.73batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 73.68batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 73.33batch/s] 72%|███████████████████▌       | 735/1014 [00:10<00:03, 73.33batch/s] 73%|███████████████████▊       | 745/1014 [00:10<00:03, 73.23batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 73.17batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 73.07batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 73.14batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 73.17batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 73.28batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 73.28batch/s] 80%|█████████████████████▋     | 815/1014 [00:11<00:02, 73.26batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 73.40batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 72.97batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 72.88batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 72.94batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:02, 72.94batch/s] 86%|███████████████████████▎   | 875/1014 [00:12<00:01, 72.82batch/s] 87%|███████████████████████▌   | 885/1014 [00:12<00:01, 72.75batch/s] 88%|███████████████████████▊   | 895/1014 [00:12<00:01, 72.76batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 72.40batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 72.47batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 72.63batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 72.72batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 72.76batch/s] 94%|█████████████████████████▍ | 955/1014 [00:13<00:00, 72.66batch/s] 95%|█████████████████████████▋ | 965/1014 [00:13<00:00, 72.75batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 72.84batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 72.80batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 72.81batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 72.79batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 72.74batch/s]
Validation 7 -> LOSS = 1.56
Validation 7 -> BLEU = 40.52, 66.2/46.7/34.4/25.3 (BP=1.000, ratio=1.027, hyp_len=14775, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.56 @ validation 7
--> Best BLEU so far: 40.52 @ validation 7
Starting Epoch 8
Epoch 8 - update       3360 => loss:   1.819 (#OOM: 0)
Epoch 8 - update       3390 => loss:   1.621 (#OOM: 0)
Epoch 8 - update       3420 => loss:   2.512 (#OOM: 0)
Epoch 8 - update       3450 => loss:   1.660 (#OOM: 0)
Epoch 8 - update       3480 => loss:   1.138 (#OOM: 0)
Epoch 8 - update       3510 => loss:   1.474 (#OOM: 0)
Epoch 8 - update       3540 => loss:   1.311 (#OOM: 0)
Epoch 8 - update       3570 => loss:   1.505 (#OOM: 0)
Epoch 8 - update       3600 => loss:   1.353 (#OOM: 0)
Epoch 8 - update       3630 => loss:   1.720 (#OOM: 0)
Epoch 8 - update       3660 => loss:   1.631 (#OOM: 0)
Epoch 8 - update       3690 => loss:   1.910 (#OOM: 0)
Epoch 8 - update       3720 => loss:   1.567 (#OOM: 0)
Epoch 8 - update       3750 => loss:   1.206 (#OOM: 0)
Epoch 8 - update       3780 => loss:   1.990 (#OOM: 0)
Epoch 8 - update       3810 => loss:   1.503 (#OOM: 0)
--> Epoch 8 finished with mean loss 1.63044
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (799 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.91batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 42.78batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 44.30batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 47.67batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 46.99batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 48.72batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.18batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.29batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.63batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.56batch/s]  3%|▉                           | 35/1014 [00:00<00:11, 81.83batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 81.04batch/s]  5%|█▌                          | 55/1014 [00:00<00:12, 79.62batch/s]  6%|█▊                          | 65/1014 [00:00<00:12, 78.90batch/s]  7%|██                          | 75/1014 [00:00<00:12, 76.53batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 77.19batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 77.03batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 77.58batch/s] 11%|███                        | 115/1014 [00:01<00:11, 77.57batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 77.62batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.98batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 75.99batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 76.07batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 75.99batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 75.97batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 76.38batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 76.73batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.50batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.30batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 76.47batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 76.24batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 76.30batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 76.70batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 77.08batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 76.92batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 77.09batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 77.24batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 76.71batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 76.95batch/s] 32%|████████▋                  | 325/1014 [00:04<00:08, 76.77batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 75.63batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 75.75batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 75.67batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.67batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 75.52batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.28batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.58batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.37batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 75.63batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.61batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.66batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 74.80batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 73.96batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.00batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 73.87batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 73.70batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:07, 73.69batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 73.78batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 73.83batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 73.88batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 73.84batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 73.80batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 73.48batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 73.45batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 73.56batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 73.46batch/s] 59%|███████████████▊           | 595/1014 [00:08<00:05, 73.41batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 73.36batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 73.48batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 73.36batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 72.75batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:05, 72.67batch/s] 65%|█████████████████▍         | 655/1014 [00:09<00:04, 72.61batch/s] 66%|█████████████████▋         | 665/1014 [00:09<00:04, 72.66batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 72.75batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 72.72batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 72.74batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 72.71batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 72.71batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 72.82batch/s] 72%|███████████████████▌       | 735/1014 [00:10<00:03, 72.77batch/s] 73%|███████████████████▊       | 745/1014 [00:10<00:03, 72.79batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 72.78batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 72.67batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 72.63batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 72.26batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:03, 72.37batch/s] 79%|█████████████████████▍     | 805/1014 [00:11<00:02, 72.35batch/s] 80%|█████████████████████▋     | 815/1014 [00:11<00:02, 72.41batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 72.43batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 72.59batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 72.55batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 72.45batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:02, 72.53batch/s] 86%|███████████████████████▎   | 875/1014 [00:12<00:01, 72.46batch/s] 87%|███████████████████████▌   | 885/1014 [00:12<00:01, 72.45batch/s] 88%|███████████████████████▊   | 895/1014 [00:12<00:01, 72.49batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 72.54batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 72.56batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 72.56batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 72.64batch/s] 93%|█████████████████████████▏ | 945/1014 [00:13<00:00, 72.66batch/s] 94%|█████████████████████████▍ | 955/1014 [00:13<00:00, 72.52batch/s] 95%|█████████████████████████▋ | 965/1014 [00:13<00:00, 72.46batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 72.45batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 72.47batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 72.46batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 72.55batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 72.56batch/s]
Validation 8 -> LOSS = 1.49
Validation 8 -> BLEU = 42.45, 67.5/48.5/36.4/27.3 (BP=1.000, ratio=1.034, hyp_len=14867, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.49 @ validation 8
--> Best BLEU so far: 42.45 @ validation 8
Starting Epoch 9
Epoch 9 - update       3840 => loss:   1.592 (#OOM: 0)
Epoch 9 - update       3870 => loss:   1.488 (#OOM: 0)
Epoch 9 - update       3900 => loss:   1.712 (#OOM: 0)
Epoch 9 - update       3930 => loss:   2.469 (#OOM: 0)
Epoch 9 - update       3960 => loss:   1.186 (#OOM: 0)
Epoch 9 - update       3990 => loss:   1.947 (#OOM: 0)
Epoch 9 - update       4020 => loss:   1.248 (#OOM: 0)
Epoch 9 - update       4050 => loss:   1.827 (#OOM: 0)
Epoch 9 - update       4080 => loss:   1.251 (#OOM: 0)
Epoch 9 - update       4110 => loss:   1.252 (#OOM: 0)
Epoch 9 - update       4140 => loss:   1.404 (#OOM: 0)
Epoch 9 - update       4170 => loss:   1.520 (#OOM: 0)
Epoch 9 - update       4200 => loss:   1.671 (#OOM: 0)
Epoch 9 - update       4230 => loss:   1.094 (#OOM: 0)
Epoch 9 - update       4260 => loss:   1.344 (#OOM: 0)
Epoch 9 - update       4290 => loss:   1.592 (#OOM: 0)
--> Epoch 9 finished with mean loss 1.53559
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.63 mins)   (811 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.09batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.86batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 53.97batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 52.73batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.87batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.66batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.79batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 82.35batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 77.20batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 78.28batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 77.41batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 78.20batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 77.91batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 79.47batch/s]  8%|██▎                         | 82/1014 [00:01<00:11, 78.82batch/s]  9%|██▌                         | 92/1014 [00:01<00:11, 77.39batch/s] 10%|██▋                        | 102/1014 [00:01<00:11, 76.45batch/s] 11%|██▉                        | 112/1014 [00:01<00:11, 75.34batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 72.05batch/s] 13%|███▌                       | 132/1014 [00:01<00:12, 71.31batch/s] 14%|███▊                       | 142/1014 [00:01<00:12, 71.28batch/s] 15%|████                       | 152/1014 [00:02<00:12, 70.83batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 71.00batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 71.23batch/s] 18%|████▊                      | 182/1014 [00:02<00:11, 71.42batch/s] 19%|█████                      | 192/1014 [00:02<00:11, 70.62batch/s] 20%|█████▍                     | 202/1014 [00:02<00:11, 71.02batch/s] 21%|█████▋                     | 212/1014 [00:02<00:11, 70.74batch/s] 22%|█████▉                     | 222/1014 [00:03<00:11, 70.48batch/s] 23%|██████▏                    | 232/1014 [00:03<00:11, 70.82batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 71.03batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 70.89batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 71.16batch/s] 27%|███████▏                   | 272/1014 [00:03<00:10, 71.41batch/s] 28%|███████▌                   | 282/1014 [00:03<00:10, 71.60batch/s] 29%|███████▊                   | 292/1014 [00:04<00:10, 71.49batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 71.63batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 71.69batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 71.79batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 71.87batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 71.89batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:09, 72.22batch/s] 36%|█████████▋                 | 362/1014 [00:05<00:09, 72.28batch/s] 37%|█████████▉                 | 372/1014 [00:05<00:08, 72.29batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 72.24batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 72.41batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 72.57batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 72.51batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 72.50batch/s] 43%|███████████▌               | 432/1014 [00:05<00:08, 72.40batch/s] 44%|███████████▊               | 442/1014 [00:06<00:07, 72.57batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 72.50batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 72.56batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 72.52batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 72.40batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 72.53batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:07, 72.66batch/s] 50%|█████████████▋             | 512/1014 [00:07<00:06, 72.68batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 72.53batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 72.56batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 72.42batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 72.57batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 72.50batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:06, 72.47batch/s] 57%|███████████████▍           | 582/1014 [00:08<00:05, 72.49batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 72.50batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 72.47batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 72.52batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 72.65batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 72.82batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 72.68batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 72.64batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 72.61batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 72.44batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 72.39batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 72.59batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 72.66batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 72.65batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:04, 72.77batch/s] 72%|███████████████████▍       | 732/1014 [00:10<00:03, 72.77batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 72.85batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 72.66batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 72.83batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 72.81batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 72.92batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:03, 73.00batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 72.99batch/s] 80%|█████████████████████▌     | 812/1014 [00:11<00:02, 73.05batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 73.07batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 73.14batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 73.25batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 73.27batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 73.30batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 73.31batch/s] 87%|███████████████████████▍   | 882/1014 [00:12<00:01, 73.45batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 73.47batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 73.51batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 73.58batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 73.57batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 73.48batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 73.42batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 73.42batch/s] 95%|█████████████████████████▌ | 962/1014 [00:13<00:00, 73.53batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 73.53batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 73.53batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 73.55batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 73.59batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 73.72batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.73batch/s]
Validation 9 -> LOSS = 1.44
Validation 9 -> BLEU = 44.53, 69.9/50.7/38.3/29.0 (BP=1.000, ratio=1.007, hyp_len=14485, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.44 @ validation 9
--> Best BLEU so far: 44.53 @ validation 9
Starting Epoch 10
Epoch 10 - update       4320 => loss:   1.601 (#OOM: 0)
Epoch 10 - update       4350 => loss:   1.378 (#OOM: 0)
Epoch 10 - update       4380 => loss:   1.354 (#OOM: 0)
Epoch 10 - update       4410 => loss:   1.403 (#OOM: 0)
Epoch 10 - update       4440 => loss:   1.607 (#OOM: 0)
Epoch 10 - update       4470 => loss:   1.389 (#OOM: 0)
Epoch 10 - update       4500 => loss:   1.448 (#OOM: 0)
Epoch 10 - update       4530 => loss:   1.509 (#OOM: 0)
Epoch 10 - update       4560 => loss:   1.559 (#OOM: 0)
Epoch 10 - update       4590 => loss:   1.464 (#OOM: 0)
Epoch 10 - update       4620 => loss:   1.401 (#OOM: 0)
Epoch 10 - update       4650 => loss:   1.260 (#OOM: 0)
Epoch 10 - update       4680 => loss:   1.398 (#OOM: 0)
Epoch 10 - update       4710 => loss:   1.214 (#OOM: 0)
Epoch 10 - update       4740 => loss:   1.334 (#OOM: 0)
Epoch 10 - update       4770 => loss:   1.417 (#OOM: 0)
--> Epoch 10 finished with mean loss 1.45618
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.69 mins)   (749 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.91batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.55batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 53.77batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.13batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 50.41batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.35batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.48batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.48batch/s]  2%|▋                           | 25/1014 [00:00<00:13, 75.50batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 71.43batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 71.47batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.59batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 71.83batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 72.42batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 72.48batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 71.94batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 71.79batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 70.95batch/s] 11%|███                        | 115/1014 [00:01<00:12, 71.99batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 71.10batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 71.46batch/s] 14%|███▊                       | 142/1014 [00:01<00:12, 71.85batch/s] 15%|████                       | 151/1014 [00:02<00:11, 72.15batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 72.20batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 72.29batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 72.65batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 72.67batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 72.98batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 73.43batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 73.29batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 73.48batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 73.50batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 73.35batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 72.81batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 72.92batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 72.43batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 72.87batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 73.02batch/s] 29%|███████▊                   | 295/1014 [00:04<00:09, 73.04batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 73.36batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 73.14batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 73.22batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 73.35batch/s] 34%|█████████                  | 340/1014 [00:04<00:09, 73.37batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:09, 73.62batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 73.84batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 73.69batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 73.84batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 73.72batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 73.94batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.19batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 74.13batch/s] 42%|███████████▏               | 421/1014 [00:05<00:08, 73.86batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 73.94batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 73.76batch/s] 44%|███████████▉               | 448/1014 [00:06<00:07, 73.79batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 73.95batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 73.81batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 73.84batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 73.72batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:07, 73.66batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 73.78batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 73.69batch/s] 51%|█████████████▊             | 520/1014 [00:07<00:06, 73.76batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 73.67batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 73.65batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 73.67batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 73.54batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 73.49batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 73.57batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 73.44batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 73.59batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 73.58batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 73.50batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 73.63batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 73.71batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 73.60batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 73.75batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 73.85batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.06batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.06batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.15batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.25batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.26batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 74.23batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.23batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.34batch/s] 73%|███████████████████▊       | 745/1014 [00:10<00:03, 74.17batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.26batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.33batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.24batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.17batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.16batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.27batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.22batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.20batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.17batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.24batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.28batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:02, 74.23batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.28batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.28batch/s] 88%|███████████████████████▊   | 895/1014 [00:12<00:01, 74.30batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.38batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.26batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.37batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.41batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.40batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.49batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.49batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.62batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.65batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.60batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.55batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.59batch/s]
Validation 10 -> LOSS = 1.40
Validation 10 -> BLEU = 46.22, 71.6/52.7/40.3/30.8 (BP=0.993, ratio=0.993, hyp_len=14285, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.40 @ validation 10
--> Best BLEU so far: 46.22 @ validation 10
Starting Epoch 11
Epoch 11 - update       4800 => loss:   1.322 (#OOM: 0)
Epoch 11 - update       4830 => loss:   1.074 (#OOM: 0)
Epoch 11 - update       4860 => loss:   1.239 (#OOM: 0)
Epoch 11 - update       4890 => loss:   1.263 (#OOM: 0)
Epoch 11 - update       4920 => loss:   1.506 (#OOM: 0)
Epoch 11 - update       4950 => loss:   1.056 (#OOM: 0)
Epoch 11 - update       4980 => loss:   1.355 (#OOM: 0)
Epoch 11 - update       5010 => loss:   1.344 (#OOM: 0)
Epoch 11 - update       5040 => loss:   1.270 (#OOM: 0)
Epoch 11 - update       5070 => loss:   1.312 (#OOM: 0)
Epoch 11 - update       5100 => loss:   1.543 (#OOM: 0)
Epoch 11 - update       5130 => loss:   1.946 (#OOM: 0)
Epoch 11 - update       5160 => loss:   1.300 (#OOM: 0)
Epoch 11 - update       5190 => loss:   1.213 (#OOM: 0)
Epoch 11 - update       5220 => loss:   1.418 (#OOM: 0)
--> Epoch 11 finished with mean loss 1.38516
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (803 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.49batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 47.74batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 48.84batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 48.54batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 49.38batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.64batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.52batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.27batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.01batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 74.12batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 72.64batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.08batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 72.93batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 71.84batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 72.36batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 72.52batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 73.00batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 73.65batch/s] 11%|███                        | 115/1014 [00:01<00:12, 73.33batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 72.38batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 72.51batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 72.82batch/s] 15%|████                       | 151/1014 [00:02<00:11, 73.54batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 73.68batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 73.27batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 73.83batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 74.38batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 74.22batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.50batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 74.42batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 74.04batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 73.91batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 73.99batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 74.25batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 74.51batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 74.72batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.23batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.26batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 75.29batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 75.03batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 75.52batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 75.31batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 75.24batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 75.42batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.52batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.78batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 75.90batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.60batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 75.48batch/s] 40%|██████████▊                | 408/1014 [00:05<00:08, 75.64batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 75.87batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 75.78batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.75batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.78batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 75.98batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.92batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 76.04batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 76.13batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.43batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 76.43batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.38batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 76.31batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 76.46batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 76.68batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 76.73batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 76.69batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 76.80batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 76.81batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 76.84batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.86batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 76.97batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 76.80batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 76.75batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 76.69batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 76.84batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 76.82batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 76.78batch/s] 68%|██████████████████▎        | 688/1014 [00:08<00:04, 76.81batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 76.77batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:03, 76.54batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 76.49batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 76.47batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 76.59batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 76.61batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 76.70batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 76.69batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 76.48batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 76.40batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 76.32batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 76.26batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 76.20batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 76.22batch/s] 83%|██████████████████████▎    | 838/1014 [00:10<00:02, 76.30batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 76.14batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 76.06batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.67batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.70batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.72batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.80batch/s] 90%|████████████████████████▏  | 908/1014 [00:11<00:01, 75.77batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.82batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.76batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.69batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.59batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.63batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.54batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.55batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.48batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.52batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.56batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.49batch/s]
Validation 11 -> LOSS = 1.38
Validation 11 -> BLEU = 47.34, 73.0/54.5/42.2/32.6 (BP=0.978, ratio=0.978, hyp_len=14070, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.38 @ validation 11
--> Best BLEU so far: 47.34 @ validation 11
Starting Epoch 12
Epoch 12 - update       5250 => loss:   1.215 (#OOM: 0)
Epoch 12 - update       5280 => loss:   1.101 (#OOM: 0)
Epoch 12 - update       5310 => loss:   1.351 (#OOM: 0)
Epoch 12 - update       5340 => loss:   1.161 (#OOM: 0)
Epoch 12 - update       5370 => loss:   1.298 (#OOM: 0)
Epoch 12 - update       5400 => loss:   1.380 (#OOM: 0)
Epoch 12 - update       5430 => loss:   1.279 (#OOM: 0)
Epoch 12 - update       5460 => loss:   1.772 (#OOM: 0)
Epoch 12 - update       5490 => loss:   1.217 (#OOM: 0)
Epoch 12 - update       5520 => loss:   1.871 (#OOM: 0)
Epoch 12 - update       5550 => loss:   1.182 (#OOM: 0)
Epoch 12 - update       5580 => loss:   1.157 (#OOM: 0)
Epoch 12 - update       5610 => loss:   1.292 (#OOM: 0)
Epoch 12 - update       5640 => loss:   1.382 (#OOM: 0)
Epoch 12 - update       5670 => loss:   1.711 (#OOM: 0)
Epoch 12 - update       5700 => loss:   1.261 (#OOM: 0)
--> Epoch 12 finished with mean loss 1.32666
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.61 mins)   (838 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 39.70batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.05batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 47.83batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 50.00batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.10batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.10batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.67batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.10batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.21batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 75.69batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 76.40batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 77.36batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 78.96batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 79.90batch/s]  8%|██▏                         | 79/1014 [00:00<00:11, 79.15batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 78.14batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 77.54batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 77.50batch/s] 11%|███                        | 115/1014 [00:01<00:11, 76.70batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 76.78batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 76.69batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 77.19batch/s] 15%|████                       | 151/1014 [00:01<00:11, 77.14batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.21batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 76.24batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 76.34batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.00batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.14batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 75.62batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 75.72batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.78batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.58batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 75.31batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 75.49batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 75.06batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 74.88batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.87batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.56batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.61batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.91batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.97batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.07batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 75.07batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 74.89batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 74.70batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 74.84batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.95batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.97batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.01batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 74.97batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.97batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.34batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.49batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 74.48batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 74.48batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.30batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.46batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.36batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.34batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:07, 74.18batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 74.15batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.34batch/s] 52%|█████████████▉             | 523/1014 [00:07<00:06, 74.47batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 74.63batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 74.75batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 74.71batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 74.78batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 74.73batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 74.73batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 74.86batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.90batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 74.97batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.16batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.13batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.14batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.13batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.26batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.67batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 74.46batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.38batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 74.32batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 74.46batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 74.36batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 74.44batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 74.35batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 74.43batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 74.54batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.49batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 74.39batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 74.39batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 74.41batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 74.34batch/s] 81%|█████████████████████▉     | 823/1014 [00:11<00:02, 74.23batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.14batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.22batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.18batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 74.08batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 73.91batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 73.97batch/s] 88%|███████████████████████▊   | 893/1014 [00:12<00:01, 74.04batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 74.01batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 74.07batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 73.89batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 73.89batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 73.78batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 73.81batch/s] 95%|█████████████████████████▋ | 963/1014 [00:13<00:00, 73.87batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 73.90batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 73.92batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 73.96batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 73.97batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 74.11batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.09batch/s]
Validation 12 -> LOSS = 1.34
Validation 12 -> BLEU = 46.63, 71.0/52.7/40.5/31.2 (BP=1.000, ratio=1.007, hyp_len=14480, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.34 @ validation 12
--> Best BLEU so far: 47.34 @ validation 11
Starting Epoch 13
Epoch 13 - update       5730 => loss:   0.955 (#OOM: 0)
Epoch 13 - update       5760 => loss:   0.932 (#OOM: 0)
Epoch 13 - update       5790 => loss:   1.308 (#OOM: 0)
Epoch 13 - update       5820 => loss:   1.411 (#OOM: 0)
Epoch 13 - update       5850 => loss:   1.160 (#OOM: 0)
Epoch 13 - update       5880 => loss:   1.237 (#OOM: 0)
Epoch 13 - update       5910 => loss:   1.188 (#OOM: 0)
Epoch 13 - update       5940 => loss:   1.212 (#OOM: 0)
Epoch 13 - update       5970 => loss:   1.171 (#OOM: 0)
Epoch 13 - update       6000 => loss:   1.068 (#OOM: 0)
Epoch 13 - update       6030 => loss:   1.067 (#OOM: 0)
Epoch 13 - update       6060 => loss:   1.254 (#OOM: 0)
Epoch 13 - update       6090 => loss:   1.358 (#OOM: 0)
Epoch 13 - update       6120 => loss:   1.145 (#OOM: 0)
Epoch 13 - update       6150 => loss:   1.438 (#OOM: 0)
Epoch 13 - update       6180 => loss:   1.424 (#OOM: 0)
--> Epoch 13 finished with mean loss 1.26957
--> Overhead/Training/Evaluation: 0.03/0.56/0.00 mins (total: 0.59 mins)   (868 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 41.77batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.78batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.26batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.05batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 50.67batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.61batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 6/1014 [00:00<00:17, 58.21batch/s]  1%|▍                           | 15/1014 [00:00<00:13, 72.07batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 68.06batch/s]  3%|▉                           | 33/1014 [00:00<00:14, 66.81batch/s]  4%|█▏                          | 42/1014 [00:00<00:14, 66.71batch/s]  5%|█▍                          | 51/1014 [00:00<00:14, 66.64batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 68.18batch/s]  7%|█▉                          | 69/1014 [00:01<00:13, 68.03batch/s]  8%|██▏                         | 78/1014 [00:01<00:13, 68.84batch/s]  9%|██▍                         | 87/1014 [00:01<00:13, 69.64batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 70.84batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 70.89batch/s] 11%|███                        | 114/1014 [00:01<00:12, 71.46batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 71.24batch/s] 13%|███▌                       | 132/1014 [00:01<00:12, 71.90batch/s] 14%|███▊                       | 141/1014 [00:01<00:12, 71.63batch/s] 15%|███▉                       | 150/1014 [00:02<00:12, 71.86batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 71.55batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 72.29batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 72.58batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 72.76batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 73.00batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 73.35batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 73.66batch/s] 22%|█████▉                     | 222/1014 [00:03<00:10, 73.52batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 73.40batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 73.21batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 73.00batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 73.08batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 73.02batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 72.74batch/s] 28%|███████▌                   | 285/1014 [00:03<00:10, 72.65batch/s] 29%|███████▊                   | 294/1014 [00:04<00:09, 72.74batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 72.69batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 72.87batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 72.91batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 72.97batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 73.14batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:09, 73.48batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 73.55batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 73.65batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 73.94batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.14batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.26batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 74.46batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 74.52batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 74.59batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 74.53batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 74.63batch/s] 44%|███████████▉               | 447/1014 [00:06<00:07, 74.49batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 74.58batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.54batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.51batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.64batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 74.37batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 74.22batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 74.16batch/s] 51%|█████████████▊             | 519/1014 [00:07<00:06, 73.89batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 73.68batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 73.71batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 73.77batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 73.98batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 74.12batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.21batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 74.30batch/s] 59%|███████████████▊           | 596/1014 [00:08<00:05, 74.22batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.18batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.24batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 74.07batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.20batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.20batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 74.09batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.07batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 74.10batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 74.01batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 74.05batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 74.08batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 74.06batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 74.14batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.22batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 74.17batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.26batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.21batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.37batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.41batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.00batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 73.47batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 73.42batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 73.34batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 73.47batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 73.42batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 73.47batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:02, 73.62batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 73.56batch/s] 87%|███████████████████████▌   | 886/1014 [00:12<00:01, 73.53batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 73.54batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 73.61batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 73.67batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 73.57batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 73.66batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 73.66batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 73.76batch/s] 95%|█████████████████████████▋ | 966/1014 [00:13<00:00, 73.75batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 73.73batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 73.74batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 73.80batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 73.86batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.82batch/s]
Validation 13 -> LOSS = 1.32
Validation 13 -> BLEU = 48.11, 72.0/54.1/42.1/32.7 (BP=1.000, ratio=1.011, hyp_len=14543, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.32 @ validation 13
--> Best BLEU so far: 48.11 @ validation 13
Starting Epoch 14
Epoch 14 - update       6210 => loss:   1.508 (#OOM: 0)
Epoch 14 - update       6240 => loss:   1.261 (#OOM: 0)
Epoch 14 - update       6270 => loss:   0.943 (#OOM: 0)
Epoch 14 - update       6300 => loss:   1.289 (#OOM: 0)
Epoch 14 - update       6330 => loss:   1.055 (#OOM: 0)
Epoch 14 - update       6360 => loss:   1.029 (#OOM: 0)
Epoch 14 - update       6390 => loss:   1.131 (#OOM: 0)
Epoch 14 - update       6420 => loss:   0.792 (#OOM: 0)
Epoch 14 - update       6450 => loss:   1.550 (#OOM: 0)
Epoch 14 - update       6480 => loss:   1.033 (#OOM: 0)
Epoch 14 - update       6510 => loss:   1.264 (#OOM: 0)
Epoch 14 - update       6540 => loss:   1.255 (#OOM: 0)
Epoch 14 - update       6570 => loss:   1.369 (#OOM: 0)
Epoch 14 - update       6600 => loss:   1.034 (#OOM: 0)
Epoch 14 - update       6630 => loss:   1.284 (#OOM: 0)
Epoch 14 - update       6660 => loss:   1.475 (#OOM: 0)
--> Epoch 14 finished with mean loss 1.22533
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (763 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.06batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.62batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.03batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.76batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 49.77batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.19batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 77.13batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.36batch/s]  3%|▋                           | 26/1014 [00:00<00:14, 66.75batch/s]  3%|▉                           | 35/1014 [00:00<00:14, 68.70batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 70.27batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 70.47batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 68.05batch/s]  7%|█▉                          | 71/1014 [00:01<00:13, 68.76batch/s]  8%|██▏                         | 80/1014 [00:01<00:13, 69.05batch/s]  9%|██▍                         | 89/1014 [00:01<00:13, 69.44batch/s] 10%|██▋                         | 98/1014 [00:01<00:13, 70.30batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 70.46batch/s] 11%|███                        | 116/1014 [00:01<00:12, 70.21batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 70.49batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 71.02batch/s] 14%|███▊                       | 144/1014 [00:02<00:12, 71.71batch/s] 15%|████                       | 154/1014 [00:02<00:11, 72.29batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 72.53batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 73.08batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 72.57batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 72.43batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 72.09batch/s] 21%|█████▋                     | 214/1014 [00:02<00:11, 72.38batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 72.46batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 72.77batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 72.93batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 73.06batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 73.52batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 73.66batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 73.93batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 73.83batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 73.84batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.23batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.42batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 74.53batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:09, 74.26batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 74.51batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 74.55batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.52batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.77batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 74.87batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.99batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.17batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.34batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 74.33batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 74.31batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 74.26batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 74.18batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.52batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 74.56batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 74.63batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.01batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 73.99batch/s] 52%|█████████████▉             | 524/1014 [00:07<00:06, 73.98batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 73.92batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 73.85batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 73.78batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 73.80batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 73.68batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 73.61batch/s] 59%|███████████████▊           | 594/1014 [00:08<00:05, 73.72batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 73.63batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 73.54batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 73.65batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 73.59batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:05, 73.70batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 73.81batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 73.94batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 74.05batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 73.96batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 73.97batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 73.88batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 73.90batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 73.56batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 73.67batch/s] 73%|███████████████████▊       | 744/1014 [00:10<00:03, 73.53batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 73.56batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 73.57batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 73.59batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 73.59batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 73.53batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 73.50batch/s] 80%|█████████████████████▋     | 814/1014 [00:11<00:02, 73.50batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 73.70batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 73.70batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 73.71batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 73.76batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 73.73batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 73.70batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 73.74batch/s] 88%|███████████████████████▊   | 894/1014 [00:12<00:01, 73.70batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 73.75batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 73.39batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 73.57batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 73.55batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 73.66batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 73.63batch/s] 95%|█████████████████████████▋ | 964/1014 [00:13<00:00, 73.58batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 73.63batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 73.65batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 73.71batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 73.70batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.70batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.70batch/s]
Validation 14 -> LOSS = 1.30
Validation 14 -> BLEU = 48.38, 72.3/54.5/42.4/32.8 (BP=1.000, ratio=1.009, hyp_len=14509, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.30 @ validation 14
--> Best BLEU so far: 48.38 @ validation 14
Starting Epoch 15
Epoch 15 - update       6690 => loss:   1.253 (#OOM: 0)
Epoch 15 - update       6720 => loss:   1.545 (#OOM: 0)
Epoch 15 - update       6750 => loss:   0.925 (#OOM: 0)
Epoch 15 - update       6780 => loss:   1.110 (#OOM: 0)
Epoch 15 - update       6810 => loss:   1.342 (#OOM: 0)
Epoch 15 - update       6840 => loss:   1.148 (#OOM: 0)
Epoch 15 - update       6870 => loss:   1.251 (#OOM: 0)
Epoch 15 - update       6900 => loss:   1.037 (#OOM: 0)
Epoch 15 - update       6930 => loss:   1.088 (#OOM: 0)
Epoch 15 - update       6960 => loss:   0.946 (#OOM: 0)
Epoch 15 - update       6990 => loss:   1.206 (#OOM: 0)
Epoch 15 - update       7020 => loss:   1.139 (#OOM: 0)
Epoch 15 - update       7050 => loss:   1.256 (#OOM: 0)
Epoch 15 - update       7080 => loss:   1.349 (#OOM: 0)
Epoch 15 - update       7110 => loss:   1.175 (#OOM: 0)
Epoch 15 - update       7140 => loss:   1.062 (#OOM: 0)
--> Epoch 15 finished with mean loss 1.18269
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.61 mins)   (840 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 49.76batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.34batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.43batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.34batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.63batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.88batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 6/1014 [00:00<00:17, 58.12batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 70.53batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 75.09batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 76.13batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 76.37batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 75.86batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 71.84batch/s]  7%|█▉                          | 69/1014 [00:00<00:13, 70.07batch/s]  8%|██▏                         | 78/1014 [00:01<00:13, 69.35batch/s]  9%|██▍                         | 87/1014 [00:01<00:13, 69.29batch/s]  9%|██▋                         | 96/1014 [00:01<00:13, 70.04batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 70.14batch/s] 11%|███                        | 114/1014 [00:01<00:12, 69.66batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 69.80batch/s] 13%|███▌                       | 132/1014 [00:01<00:12, 70.42batch/s] 14%|███▊                       | 141/1014 [00:01<00:12, 70.64batch/s] 15%|███▉                       | 150/1014 [00:02<00:12, 71.10batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 71.29batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 71.79batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 72.32batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 72.70batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 72.70batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 72.35batch/s] 21%|█████▋                     | 213/1014 [00:02<00:11, 72.34batch/s] 22%|█████▉                     | 222/1014 [00:03<00:10, 72.88batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 71.96batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 71.86batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 71.85batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 72.24batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 72.42batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 72.23batch/s] 28%|███████▌                   | 285/1014 [00:03<00:10, 71.85batch/s] 29%|███████▊                   | 294/1014 [00:04<00:09, 72.05batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 72.08batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 72.42batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 72.48batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 72.29batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 72.23batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:09, 72.15batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:09, 72.36batch/s] 36%|█████████▋                 | 366/1014 [00:05<00:08, 72.57batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 72.52batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 72.54batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 72.59batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 72.52batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 72.52batch/s] 42%|███████████▏               | 421/1014 [00:05<00:08, 72.76batch/s] 43%|███████████▍               | 431/1014 [00:05<00:08, 72.79batch/s] 43%|███████████▋               | 441/1014 [00:06<00:07, 72.78batch/s] 44%|████████████               | 451/1014 [00:06<00:07, 73.00batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 72.85batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 72.87batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 72.85batch/s] 48%|█████████████              | 491/1014 [00:06<00:07, 73.01batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:07, 73.06batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 73.10batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 73.35batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 73.39batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 73.40batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 73.52batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:06, 73.41batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:06, 73.15batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 73.08batch/s] 58%|███████████████▋           | 591/1014 [00:08<00:05, 73.01batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 73.08batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 73.21batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 73.42batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 73.27batch/s] 63%|█████████████████          | 641/1014 [00:08<00:05, 73.15batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 73.32batch/s] 65%|█████████████████▌         | 661/1014 [00:09<00:04, 73.23batch/s] 66%|█████████████████▊         | 671/1014 [00:09<00:04, 73.30batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 73.36batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 73.20batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 73.38batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 73.39batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 73.37batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 73.33batch/s] 73%|███████████████████▋       | 741/1014 [00:10<00:03, 73.34batch/s] 74%|███████████████████▉       | 751/1014 [00:10<00:03, 73.30batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 73.37batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 73.22batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 73.35batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:03, 73.30batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 73.34batch/s] 80%|█████████████████████▌     | 811/1014 [00:11<00:02, 73.43batch/s] 81%|█████████████████████▊     | 821/1014 [00:11<00:02, 73.57batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 73.63batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 73.64batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 73.67batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 73.71batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 73.79batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 73.78batch/s] 88%|███████████████████████▋   | 891/1014 [00:12<00:01, 73.78batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 73.70batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 73.74batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 73.77batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 73.76batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 73.30batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 73.43batch/s] 95%|█████████████████████████▌ | 961/1014 [00:13<00:00, 73.32batch/s] 96%|█████████████████████████▊ | 971/1014 [00:13<00:00, 73.33batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 73.41batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 73.33batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 73.36batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 73.38batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.38batch/s]
Validation 15 -> LOSS = 1.29
Validation 15 -> BLEU = 47.64, 71.1/53.7/41.7/32.4 (BP=1.000, ratio=1.024, hyp_len=14726, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.29 @ validation 15
--> Best BLEU so far: 48.38 @ validation 14
Starting Epoch 16
Epoch 16 - update       7170 => loss:   1.114 (#OOM: 0)
Epoch 16 - update       7200 => loss:   0.987 (#OOM: 0)
Epoch 16 - update       7230 => loss:   1.078 (#OOM: 0)
Epoch 16 - update       7260 => loss:   1.128 (#OOM: 0)
Epoch 16 - update       7290 => loss:   1.095 (#OOM: 0)
Epoch 16 - update       7320 => loss:   1.415 (#OOM: 0)
Epoch 16 - update       7350 => loss:   0.946 (#OOM: 0)
Epoch 16 - update       7380 => loss:   0.986 (#OOM: 0)
Epoch 16 - update       7410 => loss:   1.142 (#OOM: 0)
Epoch 16 - update       7440 => loss:   1.039 (#OOM: 0)
Epoch 16 - update       7470 => loss:   1.674 (#OOM: 0)
Epoch 16 - update       7500 => loss:   1.435 (#OOM: 0)
Epoch 16 - update       7530 => loss:   1.265 (#OOM: 0)
Epoch 16 - update       7560 => loss:   1.119 (#OOM: 0)
Epoch 16 - update       7590 => loss:   0.820 (#OOM: 0)
Epoch 16 - update       7620 => loss:   0.962 (#OOM: 0)
--> Epoch 16 finished with mean loss 1.14421
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (756 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.29batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.12batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.80batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.23batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.23batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.86batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.83batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.49batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.82batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 74.04batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.32batch/s]  4%|█                           | 40/1014 [00:00<00:13, 73.76batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 74.63batch/s]  6%|█▌                          | 56/1014 [00:00<00:12, 74.60batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 74.25batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 74.68batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 75.80batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 76.81batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 77.07batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 77.45batch/s] 12%|███                        | 117/1014 [00:01<00:11, 77.21batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 77.24batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 77.45batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 77.60batch/s] 15%|████                       | 153/1014 [00:01<00:11, 77.11batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 77.31batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 77.49batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.99batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 76.41batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 76.26batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 76.83batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 76.83batch/s] 22%|██████                     | 228/1014 [00:02<00:10, 77.00batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 77.00batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 76.71batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 76.50batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 76.58batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.72batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 76.90batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 77.08batch/s] 30%|████████▏                  | 308/1014 [00:03<00:09, 77.14batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 76.83batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 76.70batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 76.69batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 76.72batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 76.77batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 76.63batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 76.83batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 76.46batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 76.42batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 76.30batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 76.13batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 76.20batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 76.22batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 76.21batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 76.16batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 76.20batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 76.25batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 76.19batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.18batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 76.27batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.25batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 76.08batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.96batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 75.84batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.98batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 75.99batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 75.87batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 75.78batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 75.87batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.01batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 75.92batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 75.41batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 75.41batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.42batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 75.35batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 75.53batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 75.66batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 75.54batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 75.65batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 75.49batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 75.29batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 75.42batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.43batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 75.58batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 75.54batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 75.46batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.33batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 75.30batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.29batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.11batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.11batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 75.19batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.19batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.05batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.07batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.09batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.10batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.20batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.22batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 75.24batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.15batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.28batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.26batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.19batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.31batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.32batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.49batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.55batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.51batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.57batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.59batch/s]
Validation 16 -> LOSS = 1.28
Validation 16 -> BLEU = 49.21, 73.7/55.8/43.9/34.4 (BP=0.986, ratio=0.986, hyp_len=14180, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.28 @ validation 16
--> Best BLEU so far: 49.21 @ validation 16
Starting Epoch 17
Epoch 17 - update       7650 => loss:   0.827 (#OOM: 0)
Epoch 17 - update       7680 => loss:   1.511 (#OOM: 0)
Epoch 17 - update       7710 => loss:   1.216 (#OOM: 0)
Epoch 17 - update       7740 => loss:   1.120 (#OOM: 0)
Epoch 17 - update       7770 => loss:   0.747 (#OOM: 0)
Epoch 17 - update       7800 => loss:   1.234 (#OOM: 0)
Epoch 17 - update       7830 => loss:   1.379 (#OOM: 0)
Epoch 17 - update       7860 => loss:   0.999 (#OOM: 0)
Epoch 17 - update       7890 => loss:   0.905 (#OOM: 0)
Epoch 17 - update       7920 => loss:   0.916 (#OOM: 0)
Epoch 17 - update       7950 => loss:   1.149 (#OOM: 0)
Epoch 17 - update       7980 => loss:   1.196 (#OOM: 0)
Epoch 17 - update       8010 => loss:   1.031 (#OOM: 0)
Epoch 17 - update       8040 => loss:   1.114 (#OOM: 0)
Epoch 17 - update       8070 => loss:   1.365 (#OOM: 0)
Epoch 17 - update       8100 => loss:   0.597 (#OOM: 0)
--> Epoch 17 finished with mean loss 1.10821
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (845 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.94batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.58batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.57batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.10batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.79batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.58batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.55batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.66batch/s]  1%|▎                           | 13/1014 [00:00<00:16, 59.43batch/s]  2%|▌                           | 22/1014 [00:00<00:15, 64.45batch/s]  3%|▊                           | 31/1014 [00:00<00:14, 67.96batch/s]  4%|█                           | 40/1014 [00:00<00:14, 66.93batch/s]  5%|█▎                          | 49/1014 [00:00<00:13, 69.18batch/s]  6%|█▌                          | 58/1014 [00:00<00:14, 68.03batch/s]  7%|█▊                          | 67/1014 [00:00<00:13, 69.07batch/s]  7%|██                          | 76/1014 [00:01<00:13, 70.75batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 71.89batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 72.67batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 73.03batch/s] 11%|██▉                        | 112/1014 [00:01<00:12, 73.99batch/s] 12%|███▏                       | 121/1014 [00:01<00:12, 73.54batch/s] 13%|███▍                       | 130/1014 [00:01<00:12, 73.41batch/s] 14%|███▋                       | 139/1014 [00:01<00:11, 74.00batch/s] 15%|███▉                       | 148/1014 [00:01<00:11, 74.27batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 74.41batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 74.67batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 73.60batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 71.44batch/s] 19%|█████▏                     | 193/1014 [00:02<00:11, 71.47batch/s] 20%|█████▍                     | 202/1014 [00:02<00:11, 72.06batch/s] 21%|█████▌                     | 211/1014 [00:02<00:11, 72.29batch/s] 22%|█████▊                     | 220/1014 [00:03<00:10, 72.57batch/s] 23%|██████                     | 229/1014 [00:03<00:10, 72.45batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 72.58batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 72.94batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 73.01batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 73.61batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 73.46batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 73.74batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.07batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.36batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 74.36batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 73.45batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 73.42batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 73.43batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 73.52batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 73.32batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 73.49batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 73.57batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 73.51batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 73.62batch/s] 41%|███████████                | 416/1014 [00:05<00:08, 73.42batch/s] 42%|███████████▎               | 426/1014 [00:05<00:08, 73.39batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 73.52batch/s] 44%|███████████▉               | 446/1014 [00:06<00:07, 73.13batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 73.29batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 73.37batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 73.42batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 73.66batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:07, 73.80batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 73.84batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 73.97batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 74.02batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 74.01batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 73.90batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 74.11batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 74.09batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.00batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 73.99batch/s] 59%|███████████████▊           | 596/1014 [00:08<00:05, 74.05batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.10batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.08batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 73.90batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 73.73batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 73.69batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 73.63batch/s] 66%|█████████████████▋         | 666/1014 [00:09<00:04, 73.58batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 73.81batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 73.70batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 73.71batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 73.81batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 73.80batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 73.74batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 73.82batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 73.85batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 73.79batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 73.74batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 73.72batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 73.72batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 73.54batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 73.56batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 73.60batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 73.52batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 73.53batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 73.44batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 73.53batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:02, 73.45batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 73.43batch/s] 87%|███████████████████████▌   | 886/1014 [00:12<00:01, 73.42batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 73.37batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 73.40batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 73.37batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 73.38batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 73.42batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 73.46batch/s] 94%|█████████████████████████▍ | 956/1014 [00:13<00:00, 73.45batch/s] 95%|█████████████████████████▋ | 966/1014 [00:13<00:00, 73.45batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 73.44batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 73.46batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 73.50batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 73.43batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.52batch/s]
Validation 17 -> LOSS = 1.27
Validation 17 -> BLEU = 48.90, 72.3/54.9/43.0/33.6 (BP=1.000, ratio=1.022, hyp_len=14696, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.27 @ validation 17
--> Best BLEU so far: 49.21 @ validation 16
Starting Epoch 18
Epoch 18 - update       8130 => loss:   0.913 (#OOM: 0)
Epoch 18 - update       8160 => loss:   1.206 (#OOM: 0)
Epoch 18 - update       8190 => loss:   1.323 (#OOM: 0)
Epoch 18 - update       8220 => loss:   1.416 (#OOM: 0)
Epoch 18 - update       8250 => loss:   0.836 (#OOM: 0)
Epoch 18 - update       8280 => loss:   0.884 (#OOM: 0)
Epoch 18 - update       8310 => loss:   0.990 (#OOM: 0)
Epoch 18 - update       8340 => loss:   1.009 (#OOM: 0)
Epoch 18 - update       8370 => loss:   0.881 (#OOM: 0)
Epoch 18 - update       8400 => loss:   0.789 (#OOM: 0)
Epoch 18 - update       8430 => loss:   1.021 (#OOM: 0)
Epoch 18 - update       8460 => loss:   0.869 (#OOM: 0)
Epoch 18 - update       8490 => loss:   1.230 (#OOM: 0)
Epoch 18 - update       8520 => loss:   1.093 (#OOM: 0)
Epoch 18 - update       8550 => loss:   1.097 (#OOM: 0)
Epoch 18 - update       8580 => loss:   0.889 (#OOM: 0)
--> Epoch 18 finished with mean loss 1.07628
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.63 mins)   (809 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 49.84batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.36batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.00batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.21batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.44batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.95batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.12batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.63batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 74.01batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 71.03batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 73.07batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 73.68batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 73.71batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 75.12batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 76.30batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 76.43batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 76.70batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 77.08batch/s] 11%|███                        | 116/1014 [00:01<00:11, 77.16batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 77.00batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.72batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.52batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.68batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.03batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.43batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.34batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.26batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.09batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.33batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.14batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.39batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.56batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.05batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.18batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 74.00batch/s] 27%|███████▏                   | 269/1014 [00:03<00:10, 73.95batch/s] 27%|███████▍                   | 278/1014 [00:03<00:10, 73.46batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 73.28batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 73.74batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 73.74batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 73.71batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 73.79batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 73.82batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:09, 73.92batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.09batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.29batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.55batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.58batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 74.44batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 74.25batch/s] 41%|███████████                | 417/1014 [00:05<00:08, 74.24batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 74.20batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.36batch/s] 44%|███████████▉               | 447/1014 [00:06<00:07, 74.21batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 74.46batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.58batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.86batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 75.04batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.94batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 74.80batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 74.61batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 74.41batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 74.38batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 74.20batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 74.14batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 73.89batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 73.92batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 74.01batch/s] 59%|███████████████▉           | 597/1014 [00:08<00:05, 73.87batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 73.91batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 74.17batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 73.94batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 74.09batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 74.14batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.24batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 74.23batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 74.21batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 74.06batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 74.19batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.21batch/s] 71%|███████████████████        | 717/1014 [00:09<00:04, 74.24batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.18batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 74.32batch/s] 74%|███████████████████▉       | 747/1014 [00:10<00:03, 74.22batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 74.35batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 74.48batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 74.52batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 74.67batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 74.61batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 74.51batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.52batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 74.39batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 74.31batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 74.36batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 74.31batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 74.33batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 74.22batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 74.23batch/s] 88%|███████████████████████▉   | 897/1014 [00:12<00:01, 74.23batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.14batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.04batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.01batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.04batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 73.98batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 74.03batch/s] 95%|█████████████████████████▋ | 967/1014 [00:13<00:00, 74.12batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.08batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.12batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 74.05batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 74.14batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.16batch/s]
Validation 18 -> LOSS = 1.26
Validation 18 -> BLEU = 49.89, 73.3/55.8/44.1/34.8 (BP=0.997, ratio=0.997, hyp_len=14333, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.26 @ validation 18
--> Best BLEU so far: 49.89 @ validation 18
Starting Epoch 19
Epoch 19 - update       8610 => loss:   1.376 (#OOM: 0)
Epoch 19 - update       8640 => loss:   0.933 (#OOM: 0)
Epoch 19 - update       8670 => loss:   1.199 (#OOM: 0)
Epoch 19 - update       8700 => loss:   1.000 (#OOM: 0)
Epoch 19 - update       8730 => loss:   1.083 (#OOM: 0)
Epoch 19 - update       8760 => loss:   1.294 (#OOM: 0)
Epoch 19 - update       8790 => loss:   1.291 (#OOM: 0)
Epoch 19 - update       8820 => loss:   0.858 (#OOM: 0)
Epoch 19 - update       8850 => loss:   1.010 (#OOM: 0)
Epoch 19 - update       8880 => loss:   0.909 (#OOM: 0)
Epoch 19 - update       8910 => loss:   1.276 (#OOM: 0)
Epoch 19 - update       8940 => loss:   1.343 (#OOM: 0)
Epoch 19 - update       8970 => loss:   0.805 (#OOM: 0)
Epoch 19 - update       9000 => loss:   0.931 (#OOM: 0)
Epoch 19 - update       9030 => loss:   1.102 (#OOM: 0)
Epoch 19 - update       9060 => loss:   0.774 (#OOM: 0)
--> Epoch 19 finished with mean loss 1.04629
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (771 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.72batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 52.25batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.41batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.96batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.92batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.82batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.80batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 83.91batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.29batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 78.74batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 77.12batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.19batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 76.91batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.01batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 76.22batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.23batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 76.24batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.41batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 75.53batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.62batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.44batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.93batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.44batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.53batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.27batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.62batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.89batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.13batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.38batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.58batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 75.59batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 75.34batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.80batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.73batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.90batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 75.02batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 75.02batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.12batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 74.96batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.09batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.94batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.92batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.71batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.69batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 74.36batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 74.35batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 74.62batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 74.73batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 74.68batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.55batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.66batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.61batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.39batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.55batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.54batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 74.56batch/s] 44%|███████████▉               | 450/1014 [00:06<00:07, 74.53batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 74.44batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 74.31batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.53batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.64batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.52batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.61batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.60batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 74.67batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 74.62batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 74.83batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 74.74batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 74.58batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 74.49batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.61batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.59batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.65batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.73batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.77batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 74.68batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 74.57batch/s] 63%|█████████████████          | 639/1014 [00:08<00:05, 74.50batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 74.51batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.58batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.35batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.21batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.30batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.41batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.39batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 74.49batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 74.57batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 74.61batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 74.55batch/s] 74%|███████████████████▉       | 748/1014 [00:10<00:03, 74.67batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 74.73batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 74.84batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 74.95batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 74.91batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 74.89batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 74.94batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 74.89batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 74.92batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 74.78batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 74.78batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 74.89batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 74.95batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 74.87batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 74.94batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.00batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 75.01batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.04batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.08batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.07batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.04batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.01batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 74.93batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 74.98batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.05batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.04batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.10batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.11batch/s]
Validation 19 -> LOSS = 1.25
Validation 19 -> BLEU = 49.62, 74.0/56.2/44.1/34.6 (BP=0.989, ratio=0.989, hyp_len=14219, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.25 @ validation 19
--> Best BLEU so far: 49.89 @ validation 18
Starting Epoch 20
Epoch 20 - update       9090 => loss:   0.868 (#OOM: 0)
Epoch 20 - update       9120 => loss:   0.891 (#OOM: 0)
Epoch 20 - update       9150 => loss:   0.889 (#OOM: 0)
Epoch 20 - update       9180 => loss:   0.796 (#OOM: 0)
Epoch 20 - update       9210 => loss:   0.720 (#OOM: 0)
Epoch 20 - update       9240 => loss:   1.172 (#OOM: 0)
Epoch 20 - update       9270 => loss:   0.522 (#OOM: 0)
Epoch 20 - update       9300 => loss:   1.075 (#OOM: 0)
Epoch 20 - update       9330 => loss:   1.051 (#OOM: 0)
Epoch 20 - update       9360 => loss:   1.319 (#OOM: 0)
Epoch 20 - update       9390 => loss:   1.123 (#OOM: 0)
Epoch 20 - update       9420 => loss:   1.092 (#OOM: 0)
Epoch 20 - update       9450 => loss:   1.162 (#OOM: 0)
Epoch 20 - update       9480 => loss:   1.250 (#OOM: 0)
Epoch 20 - update       9510 => loss:   0.927 (#OOM: 0)
Epoch 20 - update       9540 => loss:   0.739 (#OOM: 0)
--> Epoch 20 finished with mean loss 1.01915
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (757 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.20batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.25batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 50.57batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.47batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 49.84batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.81batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.37batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 77.65batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 76.81batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 77.46batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 77.68batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 76.71batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 77.60batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 78.53batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 77.97batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 77.17batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 76.56batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 75.81batch/s] 11%|███                        | 116/1014 [00:01<00:11, 76.38batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 76.48batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.71batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 76.03batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.27batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 74.87batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 74.69batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.26batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.51batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.43batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.21batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.01batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.40batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.89batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 74.96batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 74.98batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 75.11batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 74.97batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 74.86batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.10batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.10batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.93batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.98batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 74.86batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 74.82batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 74.94batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.01batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 74.97batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 74.69batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.46batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.51batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.43batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.25batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.33batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 74.31batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 74.25batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 74.45batch/s] 44%|███████████▉               | 449/1014 [00:06<00:07, 74.37batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 74.19batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.36batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 74.43batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 73.80batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 73.69batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:07, 72.95batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 73.17batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 73.32batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 73.35batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 73.46batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 73.42batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 73.35batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 73.43batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 73.40batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 73.46batch/s] 58%|███████████████▊           | 593/1014 [00:08<00:05, 73.37batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 73.45batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 73.54batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 73.47batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 73.55batch/s] 63%|█████████████████          | 639/1014 [00:08<00:05, 73.74batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 73.74batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 73.82batch/s] 66%|█████████████████▊         | 669/1014 [00:09<00:04, 73.78batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 73.69batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 73.51batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 73.44batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 73.44batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:04, 73.50batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 73.63batch/s] 73%|███████████████████▋       | 739/1014 [00:10<00:03, 73.56batch/s] 74%|███████████████████▉       | 749/1014 [00:10<00:03, 73.54batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 73.59batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 73.51batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 73.41batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 73.42batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 73.52batch/s] 80%|█████████████████████▌     | 809/1014 [00:11<00:02, 73.45batch/s] 81%|█████████████████████▊     | 819/1014 [00:11<00:02, 73.46batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 73.34batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 73.44batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 73.45batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 73.56batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 73.61batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 73.52batch/s] 88%|███████████████████████▋   | 889/1014 [00:12<00:01, 73.60batch/s] 89%|███████████████████████▉   | 899/1014 [00:12<00:01, 73.69batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 73.77batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 73.67batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 73.70batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:01, 73.77batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 73.76batch/s] 95%|█████████████████████████▌ | 959/1014 [00:13<00:00, 73.72batch/s] 96%|█████████████████████████▊ | 969/1014 [00:13<00:00, 73.83batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 73.77batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 73.74batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 73.78batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 73.77batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.76batch/s]
Validation 20 -> LOSS = 1.24
Validation 20 -> BLEU = 49.84, 73.3/55.8/43.9/34.4 (BP=1.000, ratio=1.008, hyp_len=14497, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.24 @ validation 20
--> Best BLEU so far: 49.89 @ validation 18
Starting Epoch 21
Epoch 21 - update       9570 => loss:   0.680 (#OOM: 0)
Epoch 21 - update       9600 => loss:   0.885 (#OOM: 0)
Epoch 21 - update       9630 => loss:   0.816 (#OOM: 0)
Epoch 21 - update       9660 => loss:   0.730 (#OOM: 0)
Epoch 21 - update       9690 => loss:   1.228 (#OOM: 0)
Epoch 21 - update       9720 => loss:   1.241 (#OOM: 0)
Epoch 21 - update       9750 => loss:   1.107 (#OOM: 0)
Epoch 21 - update       9780 => loss:   0.844 (#OOM: 0)
Epoch 21 - update       9810 => loss:   0.518 (#OOM: 0)
Epoch 21 - update       9840 => loss:   1.370 (#OOM: 0)
Epoch 21 - update       9870 => loss:   0.797 (#OOM: 0)
Epoch 21 - update       9900 => loss:   0.976 (#OOM: 0)
Epoch 21 - update       9930 => loss:   0.424 (#OOM: 0)
Epoch 21 - update       9960 => loss:   0.905 (#OOM: 0)
Epoch 21 - update       9990 => loss:   0.889 (#OOM: 0)
--> Epoch 21 finished with mean loss 0.99366
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.69 mins)   (752 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.47batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.89batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.40batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.07batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.17batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.99batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.33batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 70.88batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 69.92batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 72.24batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 73.12batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 71.92batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 71.67batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 73.12batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 73.38batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 73.78batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 73.90batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 73.62batch/s] 11%|███                        | 114/1014 [00:01<00:12, 74.30batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 74.69batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 74.88batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 75.65batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 75.16batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 74.67batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 74.88batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 74.88batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.99batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 74.71batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 74.91batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.98batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.82batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 75.00batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 74.94batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 74.83batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 74.46batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 74.67batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 74.44batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.15batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 74.10batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.17batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 74.12batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 74.17batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 74.20batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 74.27batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 74.22batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.01batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 73.62batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 73.02batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 73.07batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 73.13batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 73.17batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 73.25batch/s] 41%|███████████▏               | 420/1014 [00:05<00:08, 73.20batch/s] 42%|███████████▍               | 429/1014 [00:05<00:08, 72.96batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 73.14batch/s] 44%|███████████▉               | 447/1014 [00:06<00:07, 73.25batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 73.44batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 73.26batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 73.29batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 73.18batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 73.33batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 73.37batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 73.31batch/s] 51%|█████████████▊             | 519/1014 [00:07<00:06, 73.35batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 73.46batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 73.47batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 73.52batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 73.47batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 73.37batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:06, 73.35batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 73.52batch/s] 58%|███████████████▋           | 591/1014 [00:08<00:05, 72.99batch/s] 59%|███████████████▉           | 600/1014 [00:08<00:05, 72.99batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 73.04batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 73.10batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 73.10batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 73.10batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:05, 73.28batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 73.44batch/s] 65%|█████████████████▋         | 663/1014 [00:09<00:04, 73.52batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 73.60batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 73.53batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 73.61batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 73.67batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 73.76batch/s] 71%|███████████████████        | 717/1014 [00:09<00:04, 73.70batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 73.64batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 73.57batch/s] 73%|███████████████████▊       | 744/1014 [00:10<00:03, 73.49batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 73.35batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 73.45batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 73.57batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 73.56batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 73.67batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 73.70batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 73.72batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 73.66batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 73.68batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 73.65batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 73.67batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 73.63batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 73.55batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 73.66batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 73.66batch/s] 88%|███████████████████████▋   | 888/1014 [00:12<00:01, 73.57batch/s] 88%|███████████████████████▉   | 897/1014 [00:12<00:01, 73.58batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 73.64batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 73.72batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 73.75batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 73.68batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 73.65batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 73.63batch/s] 95%|█████████████████████████▌ | 960/1014 [00:13<00:00, 73.57batch/s] 96%|█████████████████████████▊ | 969/1014 [00:13<00:00, 73.58batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 73.63batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 73.63batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 73.69batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 73.64batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.63batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.62batch/s]
Validation 21 -> LOSS = 1.24
Validation 21 -> BLEU = 50.88, 74.0/56.7/45.0/35.5 (BP=1.000, ratio=1.000, hyp_len=14383, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.24 @ validation 21
--> Best BLEU so far: 50.88 @ validation 21
Starting Epoch 22
Epoch 22 - update      10020 => loss:   0.902 (#OOM: 0)
Epoch 22 - update      10050 => loss:   0.597 (#OOM: 0)
Epoch 22 - update      10080 => loss:   0.313 (#OOM: 0)
Epoch 22 - update      10110 => loss:   0.730 (#OOM: 0)
Epoch 22 - update      10140 => loss:   0.865 (#OOM: 0)
Epoch 22 - update      10170 => loss:   0.812 (#OOM: 0)
Epoch 22 - update      10200 => loss:   1.269 (#OOM: 0)
Epoch 22 - update      10230 => loss:   0.850 (#OOM: 0)
Epoch 22 - update      10260 => loss:   0.979 (#OOM: 0)
Epoch 22 - update      10290 => loss:   1.040 (#OOM: 0)
Epoch 22 - update      10320 => loss:   0.954 (#OOM: 0)
Epoch 22 - update      10350 => loss:   0.830 (#OOM: 0)
Epoch 22 - update      10380 => loss:   1.100 (#OOM: 0)
Epoch 22 - update      10410 => loss:   1.035 (#OOM: 0)
Epoch 22 - update      10440 => loss:   1.071 (#OOM: 0)
Epoch 22 - update      10470 => loss:   1.531 (#OOM: 0)
--> Epoch 22 finished with mean loss 0.96880
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (769 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.78batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.66batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.05batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 47.61batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.17batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.12batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.34batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.73batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.79batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 75.90batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 74.38batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 73.66batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 74.20batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 75.04batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 74.97batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 75.08batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 75.32batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 74.60batch/s] 11%|███                        | 115/1014 [00:01<00:12, 74.64batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 74.26batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 74.44batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 74.84batch/s] 15%|████                       | 151/1014 [00:02<00:11, 74.63batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 74.11batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 74.26batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 73.64batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 73.52batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 73.50batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.15batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.12batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 74.08batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 74.14batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 74.13batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 73.28batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 73.38batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 73.43batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 72.92batch/s] 29%|███████▉                   | 296/1014 [00:04<00:09, 73.29batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 73.47batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 73.96batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 74.16batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 73.74batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 73.90batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 74.08batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 74.37batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.52batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.69batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.72batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 74.70batch/s] 41%|███████████                | 416/1014 [00:05<00:08, 74.73batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 74.92batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 74.90batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 74.98batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 75.04batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 74.81batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 74.92batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.97batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 74.96batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 75.05batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.18batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 74.88batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 74.74batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 74.55batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 74.65batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 74.64batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.57batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 74.65batch/s] 59%|███████████████▊           | 596/1014 [00:08<00:05, 74.41batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.21batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.04batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 73.33batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 73.18batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:05, 73.07batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 73.08batch/s] 66%|█████████████████▋         | 666/1014 [00:09<00:04, 73.17batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 72.96batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 72.86batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 72.93batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 72.95batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 73.06batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 73.15batch/s] 73%|███████████████████▌       | 736/1014 [00:10<00:03, 73.20batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 72.98batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 72.91batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 72.87batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 72.90batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 72.94batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 72.83batch/s] 79%|█████████████████████▍     | 806/1014 [00:11<00:02, 72.96batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 73.03batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 73.08batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 73.12batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 73.23batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 73.21batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:02, 73.16batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 73.23batch/s] 87%|███████████████████████▌   | 886/1014 [00:12<00:01, 73.32batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 73.34batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 73.38batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 73.38batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 73.40batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 73.49batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 73.41batch/s] 94%|█████████████████████████▍ | 956/1014 [00:13<00:00, 73.41batch/s] 95%|█████████████████████████▋ | 966/1014 [00:13<00:00, 73.34batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 73.40batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 73.48batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 73.52batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 73.41batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.42batch/s]
Validation 22 -> LOSS = 1.23
Validation 22 -> BLEU = 51.25, 74.2/57.1/45.5/36.3 (BP=0.997, ratio=0.997, hyp_len=14337, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.23 @ validation 22
--> Best BLEU so far: 51.25 @ validation 22
Starting Epoch 23
Epoch 23 - update      10500 => loss:   0.920 (#OOM: 0)
Epoch 23 - update      10530 => loss:   0.808 (#OOM: 0)
Epoch 23 - update      10560 => loss:   1.227 (#OOM: 0)
Epoch 23 - update      10590 => loss:   1.123 (#OOM: 0)
Epoch 23 - update      10620 => loss:   0.677 (#OOM: 0)
Epoch 23 - update      10650 => loss:   0.722 (#OOM: 0)
Epoch 23 - update      10680 => loss:   0.939 (#OOM: 0)
Epoch 23 - update      10710 => loss:   0.715 (#OOM: 0)
Epoch 23 - update      10740 => loss:   0.842 (#OOM: 0)
Epoch 23 - update      10770 => loss:   0.829 (#OOM: 0)
Epoch 23 - update      10800 => loss:   0.736 (#OOM: 0)
Epoch 23 - update      10830 => loss:   0.764 (#OOM: 0)
Epoch 23 - update      10860 => loss:   0.907 (#OOM: 0)
Epoch 23 - update      10890 => loss:   0.686 (#OOM: 0)
Epoch 23 - update      10920 => loss:   1.018 (#OOM: 0)
Epoch 23 - update      10950 => loss:   0.740 (#OOM: 0)
--> Epoch 23 finished with mean loss 0.94785
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.56 mins)   (916 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 39.11batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.05batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.18batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.08batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 51.09batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.68batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 80.07batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.63batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.68batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 72.62batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 74.74batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 75.07batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.54batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 73.88batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 73.56batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 72.99batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.06batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.07batch/s] 12%|███                        | 117/1014 [00:01<00:12, 73.58batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.64batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.31batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.92batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.24batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.57batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.71batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 75.88batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.71batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.78batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.78batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 76.22batch/s] 22%|██████                     | 227/1014 [00:02<00:10, 76.40batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 76.32batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 75.98batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.67batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.85batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.75batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.90batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.10batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 75.04batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.10batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 75.01batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 74.87batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 74.91batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.64batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.63batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.52batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.45batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 74.53batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 74.61batch/s] 41%|███████████                | 417/1014 [00:05<00:08, 74.36batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 74.54batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.61batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 74.79batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 74.59batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.71batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.81batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 74.79batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.93batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 74.77batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 74.55batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 74.44batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 74.43batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 74.45batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 74.55batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 74.40batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 74.51batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 74.65batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 74.73batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 74.74batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.00batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 74.95batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 75.04batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 74.92batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.94batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 74.78batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 74.69batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 74.76batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 74.80batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.80batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 74.81batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.82batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 74.66batch/s] 74%|███████████████████▉       | 747/1014 [00:10<00:03, 74.67batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 74.73batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 74.62batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 74.70batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 74.65batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 74.63batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 74.68batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.63batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 74.70batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 74.65batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 74.70batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 74.64batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 74.65batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 74.61batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 74.67batch/s] 88%|███████████████████████▉   | 897/1014 [00:12<00:01, 74.65batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.60batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.56batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.70batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.71batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 74.72batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 74.80batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 74.83batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.91batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.98batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.00batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.13batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.06batch/s]
Validation 23 -> LOSS = 1.23
Validation 23 -> BLEU = 51.06, 74.7/57.3/45.7/36.3 (BP=0.989, ratio=0.989, hyp_len=14230, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.23 @ validation 23
--> Best BLEU so far: 51.25 @ validation 22
Starting Epoch 24
Epoch 24 - update      10980 => loss:   0.904 (#OOM: 0)
Epoch 24 - update      11010 => loss:   0.951 (#OOM: 0)
Epoch 24 - update      11040 => loss:   0.913 (#OOM: 0)
Epoch 24 - update      11070 => loss:   0.693 (#OOM: 0)
Epoch 24 - update      11100 => loss:   1.328 (#OOM: 0)
Epoch 24 - update      11130 => loss:   0.834 (#OOM: 0)
Epoch 24 - update      11160 => loss:   0.777 (#OOM: 0)
Epoch 24 - update      11190 => loss:   0.781 (#OOM: 0)
Epoch 24 - update      11220 => loss:   0.784 (#OOM: 0)
Epoch 24 - update      11250 => loss:   0.764 (#OOM: 0)
Epoch 24 - update      11280 => loss:   0.589 (#OOM: 0)
Epoch 24 - update      11310 => loss:   0.960 (#OOM: 0)
Epoch 24 - update      11340 => loss:   1.117 (#OOM: 0)
Epoch 24 - update      11370 => loss:   1.164 (#OOM: 0)
Epoch 24 - update      11400 => loss:   1.045 (#OOM: 0)
Epoch 24 - update      11430 => loss:   1.033 (#OOM: 0)
--> Epoch 24 finished with mean loss 0.92768
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (890 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.80batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.42batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 47.36batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 48.80batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.65batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.33batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.70batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 84.00batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.76batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 81.04batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.85batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 76.71batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 78.69batch/s]  7%|██                          | 74/1014 [00:00<00:11, 78.67batch/s]  8%|██▎                         | 84/1014 [00:01<00:12, 77.48batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 77.41batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 76.17batch/s] 11%|███                        | 114/1014 [00:01<00:11, 75.43batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 76.44batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 76.99batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 76.60batch/s] 15%|████                       | 154/1014 [00:02<00:11, 76.83batch/s] 16%|████▎                      | 164/1014 [00:02<00:10, 77.33batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 76.21batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 75.67batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 75.36batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 75.15batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 74.90batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 74.28batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.83batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 73.29batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 73.42batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 73.64batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 73.72batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 73.72batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 73.82batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.39batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 74.45batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 74.38batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 74.21batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 74.24batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 73.91batch/s] 37%|█████████▉                 | 371/1014 [00:05<00:08, 73.97batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 74.22batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.40batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.42batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 74.26batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 74.35batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.25batch/s] 44%|███████████▉               | 448/1014 [00:06<00:07, 73.93batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 73.58batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 73.40batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 73.54batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 73.68batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 73.78batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 73.54batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 73.57batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 73.70batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 73.87batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 73.86batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:06, 73.93batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 74.03batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 74.04batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.24batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 74.30batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 74.38batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 74.56batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.46batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.48batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 74.45batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 74.41batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 74.40batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 74.18batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 74.14batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 74.06batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 74.02batch/s] 73%|███████████████████▊       | 745/1014 [00:10<00:03, 74.05batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.08batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 73.99batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 73.88batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 73.90batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 73.93batch/s] 80%|█████████████████████▌     | 811/1014 [00:11<00:02, 73.51batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 73.58batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 73.54batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 73.48batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 73.42batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:02, 73.36batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 73.45batch/s] 88%|███████████████████████▋   | 888/1014 [00:12<00:01, 73.59batch/s] 89%|███████████████████████▉   | 899/1014 [00:12<00:01, 73.63batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 73.67batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 73.68batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 73.56batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 73.62batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 73.57batch/s] 95%|█████████████████████████▋ | 965/1014 [00:13<00:00, 73.58batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 73.69batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 73.67batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 73.65batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 73.41batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.41batch/s]
Validation 24 -> LOSS = 1.22
Validation 24 -> BLEU = 51.05, 73.8/56.9/45.1/35.8 (BP=1.000, ratio=1.014, hyp_len=14579, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.22 @ validation 24
--> Best BLEU so far: 51.25 @ validation 22
Starting Epoch 25
Epoch 25 - update      11460 => loss:   0.642 (#OOM: 0)
Epoch 25 - update      11490 => loss:   1.156 (#OOM: 0)
Epoch 25 - update      11520 => loss:   0.657 (#OOM: 0)
Epoch 25 - update      11550 => loss:   0.780 (#OOM: 0)
Epoch 25 - update      11580 => loss:   1.032 (#OOM: 0)
Epoch 25 - update      11610 => loss:   0.837 (#OOM: 0)
Epoch 25 - update      11640 => loss:   0.919 (#OOM: 0)
Epoch 25 - update      11670 => loss:   0.980 (#OOM: 0)
Epoch 25 - update      11700 => loss:   0.776 (#OOM: 0)
Epoch 25 - update      11730 => loss:   0.558 (#OOM: 0)
Epoch 25 - update      11760 => loss:   0.828 (#OOM: 0)
Epoch 25 - update      11790 => loss:   0.874 (#OOM: 0)
Epoch 25 - update      11820 => loss:   0.911 (#OOM: 0)
Epoch 25 - update      11850 => loss:   1.065 (#OOM: 0)
Epoch 25 - update      11880 => loss:   1.015 (#OOM: 0)
Epoch 25 - update      11910 => loss:   0.536 (#OOM: 0)
--> Epoch 25 finished with mean loss 0.90580
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (781 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.80batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.12batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.89batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 46.64batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 46.59batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.85batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.83batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.82batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.40batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 74.58batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 74.47batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 73.33batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 73.81batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 70.90batch/s]  7%|█▉                          | 71/1014 [00:00<00:13, 72.00batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 73.44batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 73.04batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 72.88batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 72.87batch/s] 11%|███                        | 116/1014 [00:01<00:12, 73.33batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 72.86batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 73.42batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 72.68batch/s] 15%|████                       | 152/1014 [00:02<00:11, 73.42batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 73.80batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 74.19batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 74.14batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 74.62batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 74.81batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.76batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 74.91batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 74.95batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.55batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 75.41batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 75.71batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 75.39batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 75.06batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.26batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.32batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.38batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.57batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.50batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 75.74batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 75.94batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 76.06batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 76.38batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 76.47batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 76.22batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.82batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.63batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.34batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.68batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.74batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.38batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 75.33batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.34batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.53batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.51batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.72batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.73batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.72batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.96batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 75.91batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 76.12batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 76.26batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 76.29batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 76.38batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 76.40batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 76.46batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 76.45batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 76.44batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 76.37batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:04, 76.46batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 76.34batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 76.24batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 76.25batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 76.20batch/s] 67%|██████████████████▏        | 684/1014 [00:08<00:04, 76.27batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 76.13batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 76.18batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 76.16batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 76.16batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 76.21batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 76.32batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 76.13batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 76.03batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 76.15batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 76.08batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.95batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.91batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.79batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.75batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.72batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.67batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.68batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.67batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.47batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.47batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.46batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 75.60batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.49batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.34batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.29batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 75.16batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.18batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.12batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.12batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 75.14batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.25batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.17batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.14batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.14batch/s]
Validation 25 -> LOSS = 1.22
Validation 25 -> BLEU = 51.37, 74.9/57.8/46.0/36.5 (BP=0.989, ratio=0.989, hyp_len=14225, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.22 @ validation 24
--> Best BLEU so far: 51.37 @ validation 25
Starting Epoch 26
Epoch 26 - update      11940 => loss:   0.946 (#OOM: 0)
Epoch 26 - update      11970 => loss:   0.684 (#OOM: 0)
Epoch 26 - update      12000 => loss:   0.656 (#OOM: 0)
Epoch 26 - update      12030 => loss:   0.919 (#OOM: 0)
Epoch 26 - update      12060 => loss:   1.031 (#OOM: 0)
Epoch 26 - update      12090 => loss:   0.980 (#OOM: 0)
Epoch 26 - update      12120 => loss:   0.751 (#OOM: 0)
Epoch 26 - update      12150 => loss:   0.697 (#OOM: 0)
Epoch 26 - update      12180 => loss:   0.965 (#OOM: 0)
Epoch 26 - update      12210 => loss:   0.960 (#OOM: 0)
Epoch 26 - update      12240 => loss:   0.870 (#OOM: 0)
Epoch 26 - update      12270 => loss:   0.785 (#OOM: 0)
Epoch 26 - update      12300 => loss:   0.763 (#OOM: 0)
Epoch 26 - update      12330 => loss:   0.916 (#OOM: 0)
Epoch 26 - update      12360 => loss:   0.674 (#OOM: 0)
Epoch 26 - update      12390 => loss:   0.962 (#OOM: 0)
--> Epoch 26 finished with mean loss 0.88998
--> Overhead/Training/Evaluation: 0.04/0.65/0.00 mins (total: 0.69 mins)   (749 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.30batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 48.37batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 50.14batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.73batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.94batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.84batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.68batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.22batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.25batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 74.90batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 73.80batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 72.52batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 73.68batch/s]  7%|█▉                          | 69/1014 [00:00<00:13, 72.68batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 72.47batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 73.59batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 73.92batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 74.11batch/s] 11%|███                        | 115/1014 [00:01<00:11, 75.02batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 74.71batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.04batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 73.78batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 73.24batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 73.77batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 73.13batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 73.78batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 74.73batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.78batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.46batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 75.86batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 75.91batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 76.29batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 76.11batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 75.93batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 76.08batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 76.01batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 76.06batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.65batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.54batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 75.46batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 75.45batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 75.63batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 75.73batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.57batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 75.62batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.75batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.66batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.58batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 75.40batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.62batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.66batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 75.46batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.53batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.29batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.26batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 75.33batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.41batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 75.32batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 75.49batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.46batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 75.46batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.42batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.38batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.44batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.56batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.56batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 75.47batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 75.42batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 75.44batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.26batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.07batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.03batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.93batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.69batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.48batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.48batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.52batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.64batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 74.64batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.57batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.72batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 74.78batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.79batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.75batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.77batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.72batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.85batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.92batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.87batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.62batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.65batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.70batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.60batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 74.68batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.80batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.61batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 74.70batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.75batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.87batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.85batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.95batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.87batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.92batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.89batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.84batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.85batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.90batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.97batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.90batch/s]
Validation 26 -> LOSS = 1.21
Validation 26 -> BLEU = 51.47, 75.0/57.6/45.9/36.5 (BP=0.992, ratio=0.992, hyp_len=14271, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 26
--> Best BLEU so far: 51.47 @ validation 26
Starting Epoch 27
Epoch 27 - update      12420 => loss:   0.657 (#OOM: 0)
Epoch 27 - update      12450 => loss:   0.834 (#OOM: 0)
Epoch 27 - update      12480 => loss:   0.853 (#OOM: 0)
Epoch 27 - update      12510 => loss:   0.920 (#OOM: 0)
Epoch 27 - update      12540 => loss:   0.772 (#OOM: 0)
Epoch 27 - update      12570 => loss:   0.825 (#OOM: 0)
Epoch 27 - update      12600 => loss:   0.837 (#OOM: 0)
Epoch 27 - update      12630 => loss:   0.496 (#OOM: 0)
Epoch 27 - update      12660 => loss:   0.752 (#OOM: 0)
Epoch 27 - update      12690 => loss:   0.923 (#OOM: 0)
Epoch 27 - update      12720 => loss:   0.745 (#OOM: 0)
Epoch 27 - update      12750 => loss:   1.168 (#OOM: 0)
Epoch 27 - update      12780 => loss:   0.743 (#OOM: 0)
Epoch 27 - update      12810 => loss:   1.297 (#OOM: 0)
Epoch 27 - update      12840 => loss:   0.969 (#OOM: 0)
Epoch 27 - update      12870 => loss:   0.729 (#OOM: 0)
--> Epoch 27 finished with mean loss 0.87108
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (769 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.56batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 46.73batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.49batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.07batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 48.99batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.13batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.11batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.70batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 76.78batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.13batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 72.21batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 73.53batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 74.05batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 70.47batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 72.94batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.12batch/s]  9%|██▌                         | 91/1014 [00:01<00:12, 75.07batch/s] 10%|██▋                        | 101/1014 [00:01<00:12, 76.00batch/s] 11%|██▉                        | 111/1014 [00:01<00:11, 76.79batch/s] 12%|███▏                       | 121/1014 [00:01<00:11, 75.98batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 74.49batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 75.21batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.16batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.81batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 76.80batch/s] 18%|████▊                      | 181/1014 [00:02<00:10, 76.62batch/s] 19%|█████                      | 191/1014 [00:02<00:10, 76.67batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 76.89batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 76.75batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 77.21batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 76.81batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 76.70batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 76.46batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 76.01batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 75.93batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 75.55batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 75.32batch/s] 30%|████████                   | 301/1014 [00:03<00:09, 75.34batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 74.99batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 75.03batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 74.61batch/s] 34%|█████████                  | 341/1014 [00:04<00:09, 74.19batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 74.27batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 74.44batch/s] 37%|█████████▉                 | 371/1014 [00:05<00:08, 74.15batch/s] 38%|██████████▏                | 381/1014 [00:05<00:08, 74.27batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 74.34batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 74.41batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 74.35batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 74.16batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 74.03batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 73.92batch/s] 44%|████████████               | 451/1014 [00:06<00:07, 73.46batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 73.43batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 73.44batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 73.62batch/s] 48%|█████████████              | 491/1014 [00:06<00:07, 73.64batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 73.66batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 73.49batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 73.67batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 73.84batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 73.65batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 73.83batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:06, 73.69batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:06, 73.64batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 73.62batch/s] 58%|███████████████▋           | 591/1014 [00:08<00:05, 73.71batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 73.68batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 73.61batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 73.62batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 73.59batch/s] 63%|█████████████████          | 641/1014 [00:08<00:05, 73.62batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 73.48batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 73.51batch/s] 66%|█████████████████▊         | 671/1014 [00:09<00:04, 73.45batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 73.52batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 73.56batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 73.56batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 73.55batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 73.68batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 73.90batch/s] 73%|███████████████████▋       | 741/1014 [00:10<00:03, 73.85batch/s] 74%|███████████████████▉       | 751/1014 [00:10<00:03, 73.77batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 73.80batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 73.86batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 73.85batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:03, 73.70batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 73.83batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 73.91batch/s] 81%|█████████████████████▊     | 821/1014 [00:11<00:02, 73.84batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 73.79batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 73.80batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 73.73batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 73.85batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 73.91batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 73.50batch/s] 88%|███████████████████████▋   | 891/1014 [00:12<00:01, 73.53batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 73.67batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 73.62batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 73.65batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 73.59batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 73.51batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 73.53batch/s] 95%|█████████████████████████▌ | 961/1014 [00:13<00:00, 73.60batch/s] 96%|█████████████████████████▊ | 971/1014 [00:13<00:00, 73.60batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 73.55batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 73.61batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 73.58batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 73.60batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.62batch/s]
Validation 27 -> LOSS = 1.22
Validation 27 -> BLEU = 50.60, 73.3/56.4/44.8/35.4 (BP=1.000, ratio=1.018, hyp_len=14639, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 26
--> Best BLEU so far: 51.47 @ validation 26
Starting Epoch 28
Epoch 28 - update      12900 => loss:   0.621 (#OOM: 0)
Epoch 28 - update      12930 => loss:   1.184 (#OOM: 0)
Epoch 28 - update      12960 => loss:   0.541 (#OOM: 0)
Epoch 28 - update      12990 => loss:   0.966 (#OOM: 0)
Epoch 28 - update      13020 => loss:   0.951 (#OOM: 0)
Epoch 28 - update      13050 => loss:   0.894 (#OOM: 0)
Epoch 28 - update      13080 => loss:   0.751 (#OOM: 0)
Epoch 28 - update      13110 => loss:   0.687 (#OOM: 0)
Epoch 28 - update      13140 => loss:   0.807 (#OOM: 0)
Epoch 28 - update      13170 => loss:   0.897 (#OOM: 0)
Epoch 28 - update      13200 => loss:   0.852 (#OOM: 0)
Epoch 28 - update      13230 => loss:   0.641 (#OOM: 0)
Epoch 28 - update      13260 => loss:   0.567 (#OOM: 0)
Epoch 28 - update      13290 => loss:   0.834 (#OOM: 0)
Epoch 28 - update      13320 => loss:   0.732 (#OOM: 0)
Epoch 28 - update      13350 => loss:   0.806 (#OOM: 0)
--> Epoch 28 finished with mean loss 0.85334
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (845 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 41.15batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.49batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.50batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 47.35batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 47.57batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.66batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 88.97batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 88.56batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 83.95batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 84.85batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 83.53batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 83.88batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 83.71batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 81.90batch/s]  8%|██▏                         | 81/1014 [00:00<00:11, 82.33batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 80.82batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 79.70batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 79.14batch/s] 12%|███                        | 117/1014 [00:01<00:11, 79.88batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 79.22batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 79.27batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 79.00batch/s] 15%|████                       | 153/1014 [00:01<00:10, 78.90batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 78.86batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 78.74batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 78.61batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 78.91batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 79.19batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 78.47batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 78.51batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 78.09batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 78.23batch/s] 24%|██████▍                    | 243/1014 [00:03<00:09, 78.36batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 78.62batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 78.45batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 78.21batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 77.90batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 77.92batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 77.76batch/s] 30%|████████▏                  | 306/1014 [00:03<00:09, 78.03batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 77.42batch/s] 32%|████████▋                  | 324/1014 [00:04<00:08, 77.35batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 77.36batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 77.02batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 77.28batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 77.27batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 76.90batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 76.60batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 76.74batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 77.09batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 77.19batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 77.23batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 77.31batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 77.21batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 77.47batch/s] 45%|████████████▏              | 457/1014 [00:05<00:07, 77.34batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 77.18batch/s] 47%|████████████▋              | 477/1014 [00:06<00:06, 77.10batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 76.99batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 76.73batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 76.78batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 76.85batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 76.93batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:06, 77.05batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 77.15batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:05, 77.22batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 77.13batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 77.19batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 76.35batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 76.31batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 76.24batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 76.15batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 76.17batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 76.15batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 76.08batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.96batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.82batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 75.71batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.71batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.76batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.54batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.50batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.48batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.33batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.32batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 75.42batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.44batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.19batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 75.15batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.11batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.06batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.02batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 75.08batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.20batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.03batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.10batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.03batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.07batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.11batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 74.96batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.94batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.88batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.76batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.71batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 74.58batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 74.52batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 74.45batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.46batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.47batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 74.54batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 74.61batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.61batch/s]
Validation 28 -> LOSS = 1.22
Validation 28 -> BLEU = 51.84, 74.8/57.7/46.1/36.7 (BP=0.997, ratio=0.997, hyp_len=14343, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 26
--> Best BLEU so far: 51.84 @ validation 28
Starting Epoch 29
Epoch 29 - update      13380 => loss:   0.885 (#OOM: 0)
Epoch 29 - update      13410 => loss:   0.730 (#OOM: 0)
Epoch 29 - update      13440 => loss:   0.911 (#OOM: 0)
Epoch 29 - update      13470 => loss:   0.686 (#OOM: 0)
Epoch 29 - update      13500 => loss:   0.705 (#OOM: 0)
Epoch 29 - update      13530 => loss:   1.066 (#OOM: 0)
Epoch 29 - update      13560 => loss:   0.788 (#OOM: 0)
Epoch 29 - update      13590 => loss:   0.868 (#OOM: 0)
Epoch 29 - update      13620 => loss:   0.931 (#OOM: 0)
Epoch 29 - update      13650 => loss:   1.156 (#OOM: 0)
Epoch 29 - update      13680 => loss:   0.765 (#OOM: 0)
Epoch 29 - update      13710 => loss:   0.684 (#OOM: 0)
Epoch 29 - update      13740 => loss:   0.946 (#OOM: 0)
Epoch 29 - update      13770 => loss:   0.725 (#OOM: 0)
Epoch 29 - update      13800 => loss:   0.704 (#OOM: 0)
Epoch 29 - update      13830 => loss:   0.734 (#OOM: 0)
--> Epoch 29 finished with mean loss 0.83679
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.64 mins)   (798 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.07batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.66batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.48batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.80batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.62batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.79batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 78.89batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.37batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 75.47batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 74.66batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 72.55batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 72.49batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 72.72batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 72.48batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 73.28batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.57batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 74.52batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.99batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.48batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.58batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.76batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.53batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.82batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.15batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.33batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.62batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.85batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.39batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.78batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 75.94batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 75.83batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.83batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 76.14batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 76.22batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 76.36batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 75.84batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.80batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 76.03batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 76.26batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 76.39batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 76.28batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 76.53batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 76.23batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 76.19batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 76.02batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 76.01batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 75.76batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 75.86batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.88batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 76.11batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.91batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.69batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.57batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.72batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 75.74batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 75.70batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 75.75batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.68batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 75.51batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 75.67batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.55batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.53batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.62batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 75.58batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 75.65batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 75.67batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 75.70batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.83batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.92batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.87batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.80batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.59batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 75.53batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.55batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.51batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.44batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 75.49batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.44batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.45batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.58batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.49batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.55batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.57batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 75.57batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 75.43batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.51batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 75.47batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.40batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.09batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.11batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.03batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.15batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.14batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.15batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 75.15batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.19batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 75.02batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 75.03batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.09batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.92batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.84batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.87batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 74.90batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.84batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 74.93batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.00batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 75.09batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.07batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.13batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.06batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.20batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.13batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.19batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.19batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.77batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.84batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.82batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.79batch/s]
Validation 29 -> LOSS = 1.22
Validation 29 -> BLEU = 51.32, 74.7/57.4/45.6/36.2 (BP=0.995, ratio=0.995, hyp_len=14305, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 26
--> Best BLEU so far: 51.84 @ validation 28
Starting Epoch 30
Epoch 30 - update      13860 => loss:   0.713 (#OOM: 0)
Epoch 30 - update      13890 => loss:   1.022 (#OOM: 0)
Epoch 30 - update      13920 => loss:   0.817 (#OOM: 0)
Epoch 30 - update      13950 => loss:   0.775 (#OOM: 0)
Epoch 30 - update      13980 => loss:   1.029 (#OOM: 0)
Epoch 30 - update      14010 => loss:   0.756 (#OOM: 0)
Epoch 30 - update      14040 => loss:   0.754 (#OOM: 0)
Epoch 30 - update      14070 => loss:   0.703 (#OOM: 0)
Epoch 30 - update      14100 => loss:   0.579 (#OOM: 0)
Epoch 30 - update      14130 => loss:   1.031 (#OOM: 0)
Epoch 30 - update      14160 => loss:   0.985 (#OOM: 0)
Epoch 30 - update      14190 => loss:   0.974 (#OOM: 0)
Epoch 30 - update      14220 => loss:   0.758 (#OOM: 0)
Epoch 30 - update      14250 => loss:   0.993 (#OOM: 0)
Epoch 30 - update      14280 => loss:   0.488 (#OOM: 0)
Epoch 30 - update      14310 => loss:   0.745 (#OOM: 0)
--> Epoch 30 finished with mean loss 0.82299
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (768 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.13batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.01batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.33batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.56batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.69batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.44batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 64.51batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 71.14batch/s]  2%|▋                           | 23/1014 [00:00<00:14, 70.09batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.25batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 73.35batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 74.71batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 74.73batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 73.18batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 73.05batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 73.59batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 74.11batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 74.60batch/s] 11%|███                        | 113/1014 [00:01<00:12, 74.75batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 73.92batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 74.51batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 74.65batch/s] 15%|███▉                       | 149/1014 [00:02<00:12, 71.90batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 72.26batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 71.90batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 72.61batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 72.70batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 71.51batch/s] 20%|█████▍                     | 203/1014 [00:02<00:11, 72.11batch/s] 21%|█████▋                     | 212/1014 [00:02<00:11, 72.08batch/s] 22%|█████▉                     | 221/1014 [00:03<00:11, 71.65batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 71.95batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 71.84batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 72.06batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 72.03batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 72.44batch/s] 27%|███████▎                   | 275/1014 [00:03<00:10, 72.46batch/s] 28%|███████▌                   | 284/1014 [00:03<00:10, 72.53batch/s] 29%|███████▊                   | 293/1014 [00:04<00:09, 72.61batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 73.01batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 72.87batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 72.90batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 72.94batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 73.26batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:09, 73.13batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 73.14batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 73.08batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 73.12batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 72.99batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 72.96batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 73.01batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 73.14batch/s] 41%|███████████▏               | 419/1014 [00:05<00:08, 73.29batch/s] 42%|███████████▍               | 428/1014 [00:05<00:08, 72.95batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 72.87batch/s] 44%|███████████▉               | 446/1014 [00:06<00:07, 72.80batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 72.50batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 72.65batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 72.88batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 72.98batch/s] 48%|█████████████              | 491/1014 [00:06<00:07, 72.96batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:07, 73.00batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 73.18batch/s] 51%|█████████████▊             | 518/1014 [00:07<00:06, 73.18batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 73.18batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 73.14batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 73.05batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 72.99batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 73.03batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:06, 73.11batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 73.14batch/s] 58%|███████████████▋           | 590/1014 [00:08<00:05, 73.10batch/s] 59%|███████████████▉           | 599/1014 [00:08<00:05, 73.13batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 73.22batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 73.09batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 73.20batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 73.21batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:05, 73.25batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 73.09batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 73.10batch/s] 66%|█████████████████▊         | 671/1014 [00:09<00:04, 72.99batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 72.82batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 72.57batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 72.70batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 72.66batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 72.73batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 72.63batch/s] 72%|███████████████████▌       | 734/1014 [00:10<00:03, 72.80batch/s] 73%|███████████████████▊       | 743/1014 [00:10<00:03, 72.59batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 72.58batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 72.61batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 72.69batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 72.78batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 72.80batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 72.73batch/s] 79%|█████████████████████▍     | 806/1014 [00:11<00:02, 72.83batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 72.99batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 72.92batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 72.91batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 73.04batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 73.10batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:02, 73.18batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 73.23batch/s] 87%|███████████████████████▌   | 886/1014 [00:12<00:01, 73.23batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 73.23batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 73.51batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 73.42batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 73.44batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:01, 73.51batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 73.55batch/s] 95%|█████████████████████████▌ | 962/1014 [00:13<00:00, 73.55batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 73.56batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 73.55batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 73.56batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 73.58batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.59batch/s]
Validation 30 -> LOSS = 1.22
Validation 30 -> BLEU = 50.87, 73.8/56.6/44.9/35.7 (BP=1.000, ratio=1.009, hyp_len=14515, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 26
--> Best BLEU so far: 51.84 @ validation 28
Starting Epoch 31
Epoch 31 - update      14340 => loss:   0.885 (#OOM: 0)
Epoch 31 - update      14370 => loss:   0.471 (#OOM: 0)
Epoch 31 - update      14400 => loss:   0.770 (#OOM: 0)
Epoch 31 - update      14430 => loss:   0.797 (#OOM: 0)
Epoch 31 - update      14460 => loss:   0.662 (#OOM: 0)
Epoch 31 - update      14490 => loss:   0.535 (#OOM: 0)
Epoch 31 - update      14520 => loss:   0.678 (#OOM: 0)
Epoch 31 - update      14550 => loss:   0.860 (#OOM: 0)
Epoch 31 - update      14580 => loss:   0.845 (#OOM: 0)
Epoch 31 - update      14610 => loss:   0.927 (#OOM: 0)
Epoch 31 - update      14640 => loss:   0.684 (#OOM: 0)
Epoch 31 - update      14670 => loss:   0.784 (#OOM: 0)
Epoch 31 - update      14700 => loss:   0.765 (#OOM: 0)
Epoch 31 - update      14730 => loss:   0.862 (#OOM: 0)
Epoch 31 - update      14760 => loss:   0.491 (#OOM: 0)
--> Epoch 31 finished with mean loss 0.80987
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (801 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.57batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.84batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.44batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 49.72batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 48.37batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.64batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.62batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.37batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.17batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 73.97batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.58batch/s]  4%|█                           | 40/1014 [00:00<00:13, 72.04batch/s]  5%|█▎                          | 49/1014 [00:00<00:13, 74.15batch/s]  6%|█▌                          | 58/1014 [00:00<00:12, 75.11batch/s]  7%|█▊                          | 67/1014 [00:00<00:13, 71.00batch/s]  7%|██                          | 76/1014 [00:01<00:13, 71.27batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 71.47batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 71.66batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 71.66batch/s] 11%|██▉                        | 112/1014 [00:01<00:12, 71.41batch/s] 12%|███▏                       | 121/1014 [00:01<00:12, 72.27batch/s] 13%|███▍                       | 130/1014 [00:01<00:12, 72.79batch/s] 14%|███▋                       | 139/1014 [00:01<00:11, 73.60batch/s] 15%|███▉                       | 148/1014 [00:01<00:11, 74.15batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 73.96batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 74.40batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 72.61batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 72.03batch/s] 19%|█████▏                     | 193/1014 [00:02<00:11, 72.44batch/s] 20%|█████▍                     | 202/1014 [00:02<00:11, 72.00batch/s] 21%|█████▌                     | 211/1014 [00:02<00:11, 71.73batch/s] 22%|█████▊                     | 220/1014 [00:03<00:11, 71.97batch/s] 23%|██████                     | 229/1014 [00:03<00:10, 72.12batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 72.63batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 72.77batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 72.79batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 72.90batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 72.72batch/s] 28%|███████▌                   | 283/1014 [00:03<00:10, 72.61batch/s] 29%|███████▊                   | 293/1014 [00:04<00:09, 73.19batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 73.17batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 73.25batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 72.99batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 72.89batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:09, 72.67batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:09, 72.56batch/s] 36%|█████████▋                 | 363/1014 [00:05<00:09, 72.24batch/s] 37%|█████████▉                 | 373/1014 [00:05<00:08, 72.57batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 72.79batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 72.97batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 73.11batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 73.07batch/s] 42%|███████████▎               | 423/1014 [00:05<00:08, 73.06batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 72.87batch/s] 44%|███████████▊               | 443/1014 [00:06<00:07, 73.15batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 73.24batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 73.31batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 73.33batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 73.50batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:07, 73.74batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 73.63batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 73.61batch/s] 52%|█████████████▉             | 523/1014 [00:07<00:06, 73.59batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 73.42batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 73.55batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 73.79batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 73.88batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 73.77batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 73.77batch/s] 58%|███████████████▊           | 593/1014 [00:08<00:05, 73.97batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 73.80batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 74.04batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 74.08batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 73.99batch/s] 63%|█████████████████          | 643/1014 [00:08<00:05, 74.00batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 73.75batch/s] 65%|█████████████████▋         | 663/1014 [00:09<00:04, 73.55batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 73.65batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 73.72batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 73.72batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 73.81batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 73.72batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 73.71batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 73.54batch/s] 73%|███████████████████▊       | 743/1014 [00:10<00:03, 73.62batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 73.54batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 73.52batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 73.51batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 73.47batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:03, 73.31batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 73.12batch/s] 80%|█████████████████████▋     | 813/1014 [00:11<00:02, 73.24batch/s] 81%|█████████████████████▉     | 823/1014 [00:11<00:02, 73.28batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 73.20batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 73.23batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 73.28batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 73.38batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 73.48batch/s] 87%|███████████████████████▌   | 883/1014 [00:12<00:01, 73.37batch/s] 88%|███████████████████████▊   | 893/1014 [00:12<00:01, 73.39batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 73.47batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 73.36batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 73.36batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 73.47batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 73.45batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 73.54batch/s] 95%|█████████████████████████▋ | 963/1014 [00:13<00:00, 73.59batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 73.66batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 73.61batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 73.70batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 73.71batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 73.72batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.74batch/s]
Validation 31 -> LOSS = 1.22
Validation 31 -> BLEU = 51.36, 74.3/57.0/45.4/36.2 (BP=1.000, ratio=1.004, hyp_len=14444, ref_len=14382)
** Learning rate changed -> 0.0002
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 26
--> Best BLEU so far: 51.84 @ validation 28
Starting Epoch 32
Epoch 32 - update      14790 => loss:   1.103 (#OOM: 0)
Epoch 32 - update      14820 => loss:   0.692 (#OOM: 0)
Epoch 32 - update      14850 => loss:   0.585 (#OOM: 0)
Epoch 32 - update      14880 => loss:   0.571 (#OOM: 0)
Epoch 32 - update      14910 => loss:   0.526 (#OOM: 0)
Epoch 32 - update      14940 => loss:   0.639 (#OOM: 0)
Epoch 32 - update      14970 => loss:   0.883 (#OOM: 0)
Epoch 32 - update      15000 => loss:   0.631 (#OOM: 0)
Epoch 32 - update      15030 => loss:   0.736 (#OOM: 0)
Epoch 32 - update      15060 => loss:   0.687 (#OOM: 0)
Epoch 32 - update      15090 => loss:   0.592 (#OOM: 0)
Epoch 32 - update      15120 => loss:   0.757 (#OOM: 0)
Epoch 32 - update      15150 => loss:   0.417 (#OOM: 0)
Epoch 32 - update      15180 => loss:   0.691 (#OOM: 0)
Epoch 32 - update      15210 => loss:   0.684 (#OOM: 0)
Epoch 32 - update      15240 => loss:   0.594 (#OOM: 0)
--> Epoch 32 finished with mean loss 0.76406
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.64 mins)   (798 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.78batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 46.92batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.32batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.67batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.45batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.94batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.92batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 77.11batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 80.46batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 73.36batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 74.50batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 71.63batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 72.35batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 72.94batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 73.37batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 73.95batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 74.14batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 74.15batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 74.90batch/s] 11%|███                        | 116/1014 [00:01<00:11, 75.49batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 74.97batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.02batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 74.83batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.19batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 75.34batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 75.46batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.70batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.59batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.91batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.81batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.82batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.47batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.71batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.28batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.37batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 75.48batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.33batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.61batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.75batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.66batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.75batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.71batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 74.73batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 74.76batch/s] 34%|█████████                  | 341/1014 [00:04<00:09, 74.70batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 74.84batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 74.76batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 74.61batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.39batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.05batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.24batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 73.97batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.16batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 73.79batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 73.64batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 73.72batch/s] 44%|███████████▉               | 449/1014 [00:06<00:07, 73.81batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 73.64batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 73.42batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 73.51batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 73.41batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 72.81batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 73.00batch/s] 50%|█████████████▋             | 512/1014 [00:07<00:06, 73.09batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 73.28batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 73.25batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 73.39batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 73.34batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 73.49batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 73.44batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 73.26batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 73.41batch/s] 58%|███████████████▊           | 593/1014 [00:08<00:05, 73.22batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 73.33batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 73.37batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 73.47batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 73.47batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 73.53batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 73.67batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 73.77batch/s] 66%|█████████████████▋         | 666/1014 [00:09<00:04, 73.99batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 73.98batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 74.07batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 74.03batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 74.06batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 74.17batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 74.28batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.36batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 74.49batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.44batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.45batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.27batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.32batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.30batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.37batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 74.42batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.51batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.49batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.46batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.46batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.45batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.53batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 74.56batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 74.52batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.62batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.63batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 74.53batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 74.59batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 74.57batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 74.58batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 74.69batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.70batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.75batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.72batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.76batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.81batch/s]
Validation 32 -> LOSS = 1.21
Validation 32 -> BLEU = 52.14, 75.2/58.1/46.5/37.1 (BP=0.995, ratio=0.995, hyp_len=14308, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 32
--> Best BLEU so far: 52.14 @ validation 32
Starting Epoch 33
Epoch 33 - update      15270 => loss:   0.643 (#OOM: 0)
Epoch 33 - update      15300 => loss:   0.838 (#OOM: 0)
Epoch 33 - update      15330 => loss:   0.854 (#OOM: 0)
Epoch 33 - update      15360 => loss:   0.525 (#OOM: 0)
Epoch 33 - update      15390 => loss:   0.717 (#OOM: 0)
Epoch 33 - update      15420 => loss:   0.545 (#OOM: 0)
Epoch 33 - update      15450 => loss:   0.611 (#OOM: 0)
Epoch 33 - update      15480 => loss:   1.134 (#OOM: 0)
Epoch 33 - update      15510 => loss:   0.603 (#OOM: 0)
Epoch 33 - update      15540 => loss:   0.958 (#OOM: 0)
Epoch 33 - update      15570 => loss:   0.630 (#OOM: 0)
Epoch 33 - update      15600 => loss:   0.920 (#OOM: 0)
Epoch 33 - update      15630 => loss:   0.555 (#OOM: 0)
Epoch 33 - update      15660 => loss:   0.882 (#OOM: 0)
Epoch 33 - update      15690 => loss:   0.742 (#OOM: 0)
Epoch 33 - update      15720 => loss:   0.667 (#OOM: 0)
--> Epoch 33 finished with mean loss 0.74441
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (817 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.88batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 45.32batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.52batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 48.76batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.35batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.77batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.75batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 68.08batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.86batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 79.93batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 76.45batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 77.08batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 77.37batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 78.25batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 77.99batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 75.84batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 75.41batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 74.03batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 74.10batch/s] 11%|███                        | 115/1014 [00:01<00:12, 72.67batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 72.83batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 73.18batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 72.67batch/s] 15%|████                       | 152/1014 [00:02<00:11, 73.56batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.38batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 73.50batch/s] 18%|████▊                      | 182/1014 [00:02<00:11, 73.79batch/s] 19%|█████                      | 192/1014 [00:02<00:11, 73.88batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 74.31batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 73.97batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.18batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 74.25batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 73.98batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 73.93batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 73.65batch/s] 27%|███████▏                   | 272/1014 [00:03<00:10, 73.81batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 73.63batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 73.94batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 74.01batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 73.67batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 73.54batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 73.57batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 73.49batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:09, 73.54batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 73.52batch/s] 37%|█████████▉                 | 372/1014 [00:05<00:08, 73.79batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 74.07batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 74.23batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 74.31batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 74.28batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 74.40batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.44batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.62batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.36batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.26batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 74.14batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.15batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 74.43batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.50batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 74.66batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 74.61batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 74.78batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 74.68batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 74.76batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 74.64batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.59batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.45batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.49batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.54batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.61batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 74.71batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 74.71batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 74.83batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 74.85batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 74.78batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 74.60batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.57batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 74.58batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.59batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 74.48batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 74.27batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 74.21batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 74.01batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 74.06batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.14batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.10batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 74.22batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 74.11batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 74.13batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 74.16batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 74.19batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 74.30batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 74.39batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.35batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.43batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.36batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.40batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 74.44batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 74.53batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.38batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.49batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 74.47batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.45batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.40batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.39batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 74.42batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.51batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.58batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.70batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.66batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.68batch/s]
Validation 33 -> LOSS = 1.21
Validation 33 -> BLEU = 51.96, 75.2/58.1/46.4/37.0 (BP=0.993, ratio=0.993, hyp_len=14286, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.14 @ validation 32
Starting Epoch 34
Epoch 34 - update      15750 => loss:   0.711 (#OOM: 0)
Epoch 34 - update      15780 => loss:   0.694 (#OOM: 0)
Epoch 34 - update      15810 => loss:   0.527 (#OOM: 0)
Epoch 34 - update      15840 => loss:   0.812 (#OOM: 0)
Epoch 34 - update      15870 => loss:   0.471 (#OOM: 0)
Epoch 34 - update      15900 => loss:   0.588 (#OOM: 0)
Epoch 34 - update      15930 => loss:   0.673 (#OOM: 0)
Epoch 34 - update      15960 => loss:   0.832 (#OOM: 0)
Epoch 34 - update      15990 => loss:   0.562 (#OOM: 0)
Epoch 34 - update      16020 => loss:   1.001 (#OOM: 0)
Epoch 34 - update      16050 => loss:   0.839 (#OOM: 0)
Epoch 34 - update      16080 => loss:   1.045 (#OOM: 0)
Epoch 34 - update      16110 => loss:   0.400 (#OOM: 0)
Epoch 34 - update      16140 => loss:   0.664 (#OOM: 0)
Epoch 34 - update      16170 => loss:   0.676 (#OOM: 0)
Epoch 34 - update      16200 => loss:   0.599 (#OOM: 0)
--> Epoch 34 finished with mean loss 0.73763
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.69 mins)   (750 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 49.66batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 48.95batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.54batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 52.61batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 50.69batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.88batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.88batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.14batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 78.78batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 80.21batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 78.72batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 77.04batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 76.81batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 75.40batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 76.31batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 76.15batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 76.40batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 76.54batch/s] 11%|███                        | 116/1014 [00:01<00:11, 76.03batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 76.38batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.88batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.79batch/s] 15%|████                       | 152/1014 [00:01<00:11, 76.14batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.51batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.23batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.56batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 76.04batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 76.13batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 75.65batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 75.99batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 75.70batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 75.82batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 75.98batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 76.00batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 76.18batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 75.52batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 75.27batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 75.68batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 75.89batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 75.65batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 75.31batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.25batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.49batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 75.25batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 75.29batch/s] 37%|██████████                 | 380/1014 [00:05<00:08, 75.19batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 75.25batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 75.10batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 74.99batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 74.85batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 74.73batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 74.85batch/s] 44%|███████████▉               | 450/1014 [00:06<00:07, 74.90batch/s] 45%|████████████▏              | 460/1014 [00:06<00:07, 74.71batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 74.71batch/s] 47%|████████████▊              | 480/1014 [00:06<00:07, 74.52batch/s] 48%|█████████████              | 490/1014 [00:06<00:07, 74.48batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 74.51batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 74.60batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 74.66batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 74.66batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 74.77batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 74.86batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:06, 74.81batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 74.86batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 74.94batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 75.00batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 75.12batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 75.16batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 75.05batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 74.98batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 74.85batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 74.99batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 74.92batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 74.88batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 74.96batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 74.99batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.16batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 75.16batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.20batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 75.21batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.41batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 75.12batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.21batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 75.10batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.18batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.11batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.25batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.36batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.27batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 75.26batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.21batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.22batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.20batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.24batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.36batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.33batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.28batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.30batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.20batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.21batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.23batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.16batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.26batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.22batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 74.99batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 74.83batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 74.85batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 74.83batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.88batch/s]
Validation 34 -> LOSS = 1.21
Validation 34 -> BLEU = 52.10, 75.3/58.3/46.6/37.2 (BP=0.991, ratio=0.991, hyp_len=14259, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.14 @ validation 32
Starting Epoch 35
Epoch 35 - update      16230 => loss:   0.555 (#OOM: 0)
Epoch 35 - update      16260 => loss:   0.573 (#OOM: 0)
Epoch 35 - update      16290 => loss:   0.449 (#OOM: 0)
Epoch 35 - update      16320 => loss:   0.406 (#OOM: 0)
Epoch 35 - update      16350 => loss:   0.903 (#OOM: 0)
Epoch 35 - update      16380 => loss:   0.462 (#OOM: 0)
Epoch 35 - update      16410 => loss:   0.617 (#OOM: 0)
Epoch 35 - update      16440 => loss:   0.623 (#OOM: 0)
Epoch 35 - update      16470 => loss:   0.731 (#OOM: 0)
Epoch 35 - update      16500 => loss:   0.521 (#OOM: 0)
Epoch 35 - update      16530 => loss:   0.591 (#OOM: 0)
Epoch 35 - update      16560 => loss:   0.496 (#OOM: 0)
Epoch 35 - update      16590 => loss:   0.559 (#OOM: 0)
Epoch 35 - update      16620 => loss:   0.937 (#OOM: 0)
Epoch 35 - update      16650 => loss:   0.532 (#OOM: 0)
Epoch 35 - update      16680 => loss:   0.566 (#OOM: 0)
--> Epoch 35 finished with mean loss 0.72512
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (794 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.11batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.28batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.18batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 51.50batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 50.80batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.75batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.35batch/s]  2%|▍                           | 17/1014 [00:00<00:13, 74.05batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 73.80batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 75.90batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 74.57batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 76.42batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 76.73batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 76.76batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 77.56batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 77.29batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 76.53batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 76.27batch/s] 11%|███                        | 116/1014 [00:01<00:11, 75.61batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 75.93batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 76.30batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.16batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.19batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 74.58batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 74.96batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.08batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 74.78batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 74.97batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.13batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 74.98batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 74.63batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.55batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 74.79batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.07batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 75.18batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 74.86batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 74.93batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.80batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.85batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.63batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.42batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.77batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 74.85batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 74.50batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 74.78batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 74.58batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.46batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.66batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 74.70batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.75batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.84batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.18batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.13batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.42batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 75.52batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.44batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.50batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.35batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.02batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.29batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.30batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.22batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 75.10batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.02batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.00batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.04batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.16batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.17batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.22batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 75.13batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.08batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 74.83batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 74.96batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.90batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.64batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 74.59batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 74.36batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.37batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 74.38batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 74.44batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 74.48batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.46batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 74.53batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 74.49batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.46batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.48batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 74.46batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.56batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 74.52batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.53batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.57batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.63batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.58batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.65batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.64batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.53batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.65batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.52batch/s] 88%|███████████████████████▊   | 894/1014 [00:12<00:01, 74.50batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.33batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.43batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.59batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.61batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.65batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.73batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.80batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.75batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.67batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.78batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.80batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.82batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.82batch/s]
Validation 35 -> LOSS = 1.22
Validation 35 -> BLEU = 52.23, 75.0/58.2/46.6/37.2 (BP=0.996, ratio=0.996, hyp_len=14322, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.23 @ validation 35
Starting Epoch 36
Epoch 36 - update      16710 => loss:   0.893 (#OOM: 0)
Epoch 36 - update      16740 => loss:   0.436 (#OOM: 0)
Epoch 36 - update      16770 => loss:   0.695 (#OOM: 0)
Epoch 36 - update      16800 => loss:   0.864 (#OOM: 0)
Epoch 36 - update      16830 => loss:   0.847 (#OOM: 0)
Epoch 36 - update      16860 => loss:   0.420 (#OOM: 0)
Epoch 36 - update      16890 => loss:   0.557 (#OOM: 0)
Epoch 36 - update      16920 => loss:   0.609 (#OOM: 0)
Epoch 36 - update      16950 => loss:   1.021 (#OOM: 0)
Epoch 36 - update      16980 => loss:   0.852 (#OOM: 0)
Epoch 36 - update      17010 => loss:   0.768 (#OOM: 0)
Epoch 36 - update      17040 => loss:   0.963 (#OOM: 0)
Epoch 36 - update      17070 => loss:   0.641 (#OOM: 0)
Epoch 36 - update      17100 => loss:   0.790 (#OOM: 0)
Epoch 36 - update      17130 => loss:   0.867 (#OOM: 0)
Epoch 36 - update      17160 => loss:   0.553 (#OOM: 0)
--> Epoch 36 finished with mean loss 0.71764
--> Overhead/Training/Evaluation: 0.03/0.56/0.00 mins (total: 0.59 mins)   (867 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.13batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 46.97batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.04batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.57batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.10batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.66batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.63batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 93.28batch/s]  2%|▌                           | 20/1014 [00:00<00:12, 76.70batch/s]  3%|▊                           | 30/1014 [00:00<00:12, 78.36batch/s]  4%|█                           | 40/1014 [00:00<00:12, 80.91batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 77.15batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 78.20batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 78.91batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 78.27batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 78.74batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 78.16batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 77.95batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 77.28batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 77.21batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 77.47batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 77.21batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 77.27batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 77.94batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 77.30batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 77.48batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 77.76batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 77.73batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 77.72batch/s] 23%|██████                     | 230/1014 [00:02<00:10, 77.37batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 77.38batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 77.75batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 77.98batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 77.67batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 77.73batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 77.49batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 77.40batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 77.19batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 76.69batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 76.74batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 76.41batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 76.50batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 76.55batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 76.54batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 76.35batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 76.48batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 76.82batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 76.61batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 76.52batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 76.53batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 76.70batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 76.61batch/s] 45%|████████████▏              | 460/1014 [00:06<00:07, 76.52batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 76.59batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 76.57batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 76.56batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 76.37batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 76.04batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 76.06batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 76.06batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.00batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 75.99batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 75.99batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 76.05batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 76.05batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 75.87batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 75.97batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 76.11batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 76.08batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.95batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 76.07batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 76.04batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 75.83batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 75.91batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 75.70batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 75.62batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.64batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 75.71batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.65batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 75.68batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.46batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 75.49batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.62batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 75.60batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.76batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.63batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.47batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.45batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.29batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 75.13batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.13batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.03batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.09batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.02batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 74.89batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 74.94batch/s] 89%|███████████████████████▉   | 900/1014 [00:12<00:01, 74.89batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 74.93batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 74.96batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.01batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 74.96batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 74.90batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 74.83batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 74.85batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 74.84batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 74.91batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 74.80batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 74.79batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.82batch/s]
Validation 36 -> LOSS = 1.22
Validation 36 -> BLEU = 51.79, 75.1/58.2/46.4/36.8 (BP=0.991, ratio=0.991, hyp_len=14255, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.23 @ validation 35
Starting Epoch 37
Epoch 37 - update      17190 => loss:   0.566 (#OOM: 0)
Epoch 37 - update      17220 => loss:   0.547 (#OOM: 0)
Epoch 37 - update      17250 => loss:   0.534 (#OOM: 0)
Epoch 37 - update      17280 => loss:   0.839 (#OOM: 0)
Epoch 37 - update      17310 => loss:   0.785 (#OOM: 0)
Epoch 37 - update      17340 => loss:   0.885 (#OOM: 0)
Epoch 37 - update      17370 => loss:   0.582 (#OOM: 0)
Epoch 37 - update      17400 => loss:   0.566 (#OOM: 0)
Epoch 37 - update      17430 => loss:   0.473 (#OOM: 0)
Epoch 37 - update      17460 => loss:   0.689 (#OOM: 0)
Epoch 37 - update      17490 => loss:   0.673 (#OOM: 0)
Epoch 37 - update      17520 => loss:   0.863 (#OOM: 0)
Epoch 37 - update      17550 => loss:   0.812 (#OOM: 0)
Epoch 37 - update      17580 => loss:   0.519 (#OOM: 0)
Epoch 37 - update      17610 => loss:   0.807 (#OOM: 0)
Epoch 37 - update      17640 => loss:   0.706 (#OOM: 0)
--> Epoch 37 finished with mean loss 0.71016
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.62 mins)   (821 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.44batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.40batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.11batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.78batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.37batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.00batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.24batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 69.69batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.26batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 75.60batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 73.87batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 72.32batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 71.40batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 72.85batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 73.78batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 73.33batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.05batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 73.48batch/s] 11%|███                        | 114/1014 [00:01<00:12, 74.28batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 74.20batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 74.05batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 73.80batch/s] 15%|███▉                       | 150/1014 [00:02<00:11, 73.17batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 73.11batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 72.81batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 72.99batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 72.74batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 72.44batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 72.79batch/s] 21%|█████▋                     | 213/1014 [00:02<00:11, 72.75batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 73.45batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 73.60batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 73.71batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 73.21batch/s] 26%|███████                    | 263/1014 [00:03<00:10, 73.64batch/s] 27%|███████▎                   | 273/1014 [00:03<00:10, 73.78batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 74.05batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 74.32batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.66batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.30batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 74.54batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.61batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:09, 74.34batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 74.45batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 74.80batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 74.73batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.76batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.30batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.28batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.11batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.22batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 74.13batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 74.26batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.54batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.30batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.40batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.51batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:07, 74.31batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 74.57batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.73batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 74.73batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 74.61batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 74.78batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 74.85batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 74.69batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 74.77batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 74.64batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 74.64batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.74batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 74.50batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 74.64batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 74.56batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 74.65batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 74.78batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.64batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.67batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 74.79batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.73batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 74.79batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 74.74batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 74.83batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 74.79batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 74.70batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 74.74batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 74.75batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.71batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 74.75batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 74.61batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 74.65batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 74.61batch/s] 81%|█████████████████████▉     | 823/1014 [00:11<00:02, 74.41batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.41batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.45batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.42batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 74.35batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 74.35batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 74.20batch/s] 88%|███████████████████████▊   | 893/1014 [00:12<00:01, 74.18batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 74.20batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 74.34batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 74.38batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 74.35batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 74.34batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 74.29batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 74.25batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 74.28batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 74.26batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 74.24batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 74.29batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 74.22batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.24batch/s]
Validation 37 -> LOSS = 1.21
Validation 37 -> BLEU = 51.97, 75.0/58.0/46.2/36.6 (BP=0.998, ratio=0.998, hyp_len=14347, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.23 @ validation 35
Starting Epoch 38
Epoch 38 - update      17670 => loss:   0.843 (#OOM: 0)
Epoch 38 - update      17700 => loss:   0.609 (#OOM: 0)
Epoch 38 - update      17730 => loss:   0.816 (#OOM: 0)
Epoch 38 - update      17760 => loss:   0.770 (#OOM: 0)
Epoch 38 - update      17790 => loss:   0.523 (#OOM: 0)
Epoch 38 - update      17820 => loss:   0.855 (#OOM: 0)
Epoch 38 - update      17850 => loss:   0.700 (#OOM: 0)
Epoch 38 - update      17880 => loss:   0.813 (#OOM: 0)
Epoch 38 - update      17910 => loss:   0.907 (#OOM: 0)
Epoch 38 - update      17940 => loss:   0.999 (#OOM: 0)
Epoch 38 - update      17970 => loss:   0.892 (#OOM: 0)
Epoch 38 - update      18000 => loss:   0.652 (#OOM: 0)
Epoch 38 - update      18030 => loss:   0.992 (#OOM: 0)
Epoch 38 - update      18060 => loss:   1.098 (#OOM: 0)
Epoch 38 - update      18090 => loss:   0.575 (#OOM: 0)
Epoch 38 - update      18120 => loss:   0.877 (#OOM: 0)
--> Epoch 38 finished with mean loss 0.70359
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (829 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.39batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.21batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.00batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.54batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.74batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.41batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:13, 77.28batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 72.17batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 71.44batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 71.38batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 70.12batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 70.48batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 71.18batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 71.77batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 72.79batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.50batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.93batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.12batch/s] 12%|███                        | 117/1014 [00:01<00:12, 73.58batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.79batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.35batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.20batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.45batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.37batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 75.05batch/s] 18%|████▊                      | 182/1014 [00:02<00:11, 74.35batch/s] 19%|█████                      | 192/1014 [00:02<00:11, 74.09batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 74.13batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 73.61batch/s] 22%|█████▉                     | 222/1014 [00:03<00:10, 73.47batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 74.01batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 74.48batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.61batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 75.06batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 75.16batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 75.64batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 75.67batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 75.39batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 75.48batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.29batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.22batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.35batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 75.52batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 74.90batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 74.70batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 74.49batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 74.43batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 74.43batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 74.60batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 74.66batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.73batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.84batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.55batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.58batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 74.72batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.73batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 74.87batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.90batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 75.07batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 75.06batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 74.88batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 74.73batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 74.84batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 74.91batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.91batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.99batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.96batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 75.00batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.84batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 74.92batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 75.00batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 74.81batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 74.82batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 74.81batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 74.74batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.78batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 74.66batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.79batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 74.87batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 74.76batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 74.86batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 74.87batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 74.92batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 75.02batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 75.08batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.16batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.15batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 75.25batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 75.26batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.09batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 75.06batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.11batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 75.00batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.96batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.97batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.99batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 74.85batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 74.92batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.86batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.79batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 74.78batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.74batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.80batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.77batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 74.81batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.73batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.69batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.59batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.76batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.76batch/s]
Validation 38 -> LOSS = 1.22
Validation 38 -> BLEU = 52.07, 75.1/58.0/46.3/37.0 (BP=0.997, ratio=0.997, hyp_len=14332, ref_len=14382)
** Learning rate changed -> 0.0001
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.23 @ validation 35
Starting Epoch 39
Epoch 39 - update      18150 => loss:   0.697 (#OOM: 0)
Epoch 39 - update      18180 => loss:   0.468 (#OOM: 0)
Epoch 39 - update      18210 => loss:   0.963 (#OOM: 0)
Epoch 39 - update      18240 => loss:   0.827 (#OOM: 0)
Epoch 39 - update      18270 => loss:   0.523 (#OOM: 0)
Epoch 39 - update      18300 => loss:   0.607 (#OOM: 0)
Epoch 39 - update      18330 => loss:   0.974 (#OOM: 0)
Epoch 39 - update      18360 => loss:   0.561 (#OOM: 0)
Epoch 39 - update      18390 => loss:   0.527 (#OOM: 0)
Epoch 39 - update      18420 => loss:   0.392 (#OOM: 0)
Epoch 39 - update      18450 => loss:   0.781 (#OOM: 0)
Epoch 39 - update      18480 => loss:   0.514 (#OOM: 0)
Epoch 39 - update      18510 => loss:   0.718 (#OOM: 0)
Epoch 39 - update      18540 => loss:   0.891 (#OOM: 0)
Epoch 39 - update      18570 => loss:   0.651 (#OOM: 0)
Epoch 39 - update      18600 => loss:   0.421 (#OOM: 0)
--> Epoch 39 finished with mean loss 0.68137
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (884 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.52batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 45.32batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 45.38batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 46.05batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 48.61batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.60batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 67.49batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 68.67batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.15batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 74.58batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.83batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 75.01batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 74.62batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 75.62batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 75.84batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 75.20batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.27batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 75.48batch/s] 11%|███                        | 116/1014 [00:01<00:11, 74.92batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.61batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 75.31batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 75.79batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 76.18batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 76.44batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 76.23batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 75.87batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.49batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.27batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 75.56batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 75.50batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 75.26batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 75.13batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 75.38batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.44batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.40batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.83batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.00batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.97batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 74.72batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 74.53batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 74.83batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 74.91batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.17batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 74.95batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 75.11batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.42batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.51batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 75.70batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 75.68batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 75.66batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 75.57batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.70batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 75.94batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.85batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.57batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 75.59batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 75.77batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 75.67batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.55batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 75.53batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.65batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.53batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.40batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.17batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.22batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.22batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.28batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 75.21batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 75.19batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.25batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 75.04batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.91batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 74.94batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.05batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 75.26batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.33batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.53batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.59batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.42batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.27batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.26batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.03batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.90batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.93batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.88batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.90batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.74batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.67batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 74.62batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.68batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.73batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.70batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.69batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.67batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.78batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 74.66batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 74.50batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.36batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.35batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 74.33batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 74.34batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 74.41batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 74.47batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 74.44batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.37batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.44batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.43batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.32batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.40batch/s]
Validation 39 -> LOSS = 1.21
Validation 39 -> BLEU = 51.91, 74.6/57.7/46.0/36.7 (BP=1.000, ratio=1.006, hyp_len=14475, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.23 @ validation 35
Starting Epoch 40
Epoch 40 - update      18630 => loss:   0.504 (#OOM: 0)
Epoch 40 - update      18660 => loss:   0.523 (#OOM: 0)
Epoch 40 - update      18690 => loss:   0.467 (#OOM: 0)
Epoch 40 - update      18720 => loss:   0.550 (#OOM: 0)
Epoch 40 - update      18750 => loss:   0.329 (#OOM: 0)
Epoch 40 - update      18780 => loss:   0.645 (#OOM: 0)
Epoch 40 - update      18810 => loss:   0.352 (#OOM: 0)
Epoch 40 - update      18840 => loss:   0.507 (#OOM: 0)
Epoch 40 - update      18870 => loss:   0.978 (#OOM: 0)
Epoch 40 - update      18900 => loss:   0.716 (#OOM: 0)
Epoch 40 - update      18930 => loss:   0.877 (#OOM: 0)
Epoch 40 - update      18960 => loss:   0.674 (#OOM: 0)
Epoch 40 - update      18990 => loss:   0.578 (#OOM: 0)
Epoch 40 - update      19020 => loss:   0.621 (#OOM: 0)
Epoch 40 - update      19050 => loss:   1.064 (#OOM: 0)
Epoch 40 - update      19080 => loss:   0.454 (#OOM: 0)
--> Epoch 40 finished with mean loss 0.67276
--> Overhead/Training/Evaluation: 0.03/0.56/0.00 mins (total: 0.59 mins)   (867 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.94batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.50batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.12batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.41batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.90batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.29batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.24batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 71.65batch/s]  2%|▋                           | 25/1014 [00:00<00:13, 74.90batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 74.03batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 77.08batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 79.57batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 78.80batch/s]  7%|██                          | 74/1014 [00:00<00:12, 78.26batch/s]  8%|██▎                         | 84/1014 [00:01<00:11, 78.97batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 78.50batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 77.90batch/s] 11%|███                        | 114/1014 [00:01<00:11, 78.06batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 77.32batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 78.63batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 77.26batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 75.73batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.99batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.29batch/s] 19%|█████                      | 190/1014 [00:02<00:11, 74.85batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 75.01batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 74.79batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.06batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.40batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 75.16batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 75.54batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.78batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.25batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 75.65batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 75.65batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 75.34batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.12batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.96batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 74.98batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.98batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 75.15batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.95batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.14batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 75.06batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 75.27batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 75.34batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.35batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.28batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 75.53batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.52batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.61batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 75.45batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 75.52batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 75.52batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 75.28batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 75.42batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 75.37batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.51batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.60batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.58batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.69batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 75.51batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 75.56batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 75.59batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.38batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 75.15batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 75.02batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.19batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.12batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.08batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.15batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.11batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 75.09batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 74.89batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.01batch/s] 74%|███████████████████▉       | 751/1014 [00:10<00:03, 74.99batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.84batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.83batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.64batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.55batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.38batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.39batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 74.58batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 74.63batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 74.60batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 74.64batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.77batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 74.76batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 74.66batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.76batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.65batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.68batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 74.71batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 74.78batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 74.76batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 74.83batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.91batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 74.93batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.97batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.99batch/s]
Validation 40 -> LOSS = 1.22
Validation 40 -> BLEU = 52.37, 75.4/58.4/46.8/37.4 (BP=0.994, ratio=0.994, hyp_len=14289, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.37 @ validation 40
Starting Epoch 41
Epoch 41 - update      19110 => loss:   0.667 (#OOM: 0)
Epoch 41 - update      19140 => loss:   0.580 (#OOM: 0)
Epoch 41 - update      19170 => loss:   0.886 (#OOM: 0)
Epoch 41 - update      19200 => loss:   0.539 (#OOM: 0)
Epoch 41 - update      19230 => loss:   0.511 (#OOM: 0)
Epoch 41 - update      19260 => loss:   0.577 (#OOM: 0)
Epoch 41 - update      19290 => loss:   0.597 (#OOM: 0)
Epoch 41 - update      19320 => loss:   0.473 (#OOM: 0)
Epoch 41 - update      19350 => loss:   0.795 (#OOM: 0)
Epoch 41 - update      19380 => loss:   0.552 (#OOM: 0)
Epoch 41 - update      19410 => loss:   0.823 (#OOM: 0)
Epoch 41 - update      19440 => loss:   0.692 (#OOM: 0)
Epoch 41 - update      19470 => loss:   0.600 (#OOM: 0)
Epoch 41 - update      19500 => loss:   0.754 (#OOM: 0)
Epoch 41 - update      19530 => loss:   0.790 (#OOM: 0)
--> Epoch 41 finished with mean loss 0.66891
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (805 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.82batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.84batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.32batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.54batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.89batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.78batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.13batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 76.57batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.37batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 78.88batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.91batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 77.90batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 76.23batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 76.40batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.26batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 75.47batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.26batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.76batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.15batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.94batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 76.20batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 76.35batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 76.62batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 76.27batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 75.58batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 75.78batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.55batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.61batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 75.53batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 74.94batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 75.18batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 74.87batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 74.73batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 74.48batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 74.71batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.69batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.11batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.32batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 74.48batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 74.49batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 74.37batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 74.17batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 74.11batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 74.11batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.14batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.35batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.57batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 74.75batch/s] 41%|███████████                | 416/1014 [00:05<00:08, 74.55batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 74.66batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 74.66batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 74.51batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 74.43batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 74.51batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 74.62batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.47batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 74.28batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 74.29batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 74.34batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 74.45batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 74.21batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 74.23batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 74.30batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 74.36batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.28batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 74.14batch/s] 59%|███████████████▊           | 596/1014 [00:08<00:05, 73.99batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.06batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 73.87batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 73.97batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 73.88batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 73.99batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 73.93batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.03batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 73.84batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 73.74batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 73.78batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 73.77batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 73.94batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 73.98batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 73.99batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 73.95batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 73.94batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.00batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 73.93batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 73.92batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.01batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.00batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 74.04batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.10batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.02batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 73.92batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.05batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.08batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.07batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 74.20batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 74.21batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.25batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.28batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 74.37batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 74.33batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 74.35batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 74.28batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 74.33batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.25batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.30batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.07batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.06batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.16batch/s]
Validation 41 -> LOSS = 1.22
Validation 41 -> BLEU = 52.44, 75.0/58.2/46.5/37.2 (BP=1.000, ratio=1.003, hyp_len=14420, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.44 @ validation 41
Starting Epoch 42
Epoch 42 - update      19560 => loss:   0.439 (#OOM: 0)
Epoch 42 - update      19590 => loss:   0.799 (#OOM: 0)
Epoch 42 - update      19620 => loss:   0.543 (#OOM: 0)
Epoch 42 - update      19650 => loss:   0.502 (#OOM: 0)
Epoch 42 - update      19680 => loss:   0.535 (#OOM: 0)
Epoch 42 - update      19710 => loss:   0.504 (#OOM: 0)
Epoch 42 - update      19740 => loss:   0.537 (#OOM: 0)
Epoch 42 - update      19770 => loss:   0.633 (#OOM: 0)
Epoch 42 - update      19800 => loss:   0.559 (#OOM: 0)
Epoch 42 - update      19830 => loss:   0.756 (#OOM: 0)
Epoch 42 - update      19860 => loss:   0.812 (#OOM: 0)
Epoch 42 - update      19890 => loss:   0.538 (#OOM: 0)
Epoch 42 - update      19920 => loss:   0.559 (#OOM: 0)
Epoch 42 - update      19950 => loss:   0.641 (#OOM: 0)
Epoch 42 - update      19980 => loss:   0.613 (#OOM: 0)
Epoch 42 - update      20010 => loss:   0.282 (#OOM: 0)
--> Epoch 42 finished with mean loss 0.66280
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (760 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.18batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.27batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 47.79batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 49.56batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.40batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 49.55batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.02batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 84.23batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 78.82batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.06batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 79.02batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.11batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 77.42batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 76.76batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 76.27batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 75.95batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.28batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 74.50batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.92batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.09batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.64batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 73.91batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.53batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.17batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.65batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.19batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 73.18batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.26batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.78batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 73.40batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 73.43batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 73.72batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.76batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 73.58batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 73.99batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 73.90batch/s] 27%|███████▏                   | 270/1014 [00:03<00:10, 73.87batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 73.75batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 73.86batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 73.43batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 73.44batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 73.29batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 73.13batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 73.04batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 73.38batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:09, 73.55batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 73.66batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 73.82batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 73.73batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 73.82batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 73.83batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 73.98batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 73.80batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 73.95batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.10batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.40batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.45batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.48batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 74.33batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.03batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 74.11batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.18batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 73.90batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 74.03batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 74.05batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 74.23batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 74.23batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 74.12batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.35batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.14batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.32batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.39batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.45batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 74.39batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 74.21batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 74.07batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 73.86batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 73.95batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 73.91batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.11batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 74.25batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.22batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 74.41batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 74.49batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 74.48batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 74.48batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 74.31batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.41batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.32batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 74.35batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 74.36batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 74.50batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 74.42batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 74.51batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 74.55batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 74.57batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.53batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.50batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.51batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.44batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 74.46batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 74.51batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.47batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.52batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 74.55batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.44batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.47batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.52batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 74.29batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.11batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.15batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.08batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.15batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.16batch/s]
Validation 42 -> LOSS = 1.22
Validation 42 -> BLEU = 52.50, 74.9/58.2/46.7/37.4 (BP=1.000, ratio=1.001, hyp_len=14403, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.50 @ validation 42
Starting Epoch 43
Epoch 43 - update      20040 => loss:   0.813 (#OOM: 0)
Epoch 43 - update      20070 => loss:   0.595 (#OOM: 0)
Epoch 43 - update      20100 => loss:   0.511 (#OOM: 0)
Epoch 43 - update      20130 => loss:   0.772 (#OOM: 0)
Epoch 43 - update      20160 => loss:   0.667 (#OOM: 0)
Epoch 43 - update      20190 => loss:   0.531 (#OOM: 0)
Epoch 43 - update      20220 => loss:   0.732 (#OOM: 0)
Epoch 43 - update      20250 => loss:   0.629 (#OOM: 0)
Epoch 43 - update      20280 => loss:   0.336 (#OOM: 0)
Epoch 43 - update      20310 => loss:   0.514 (#OOM: 0)
Epoch 43 - update      20340 => loss:   0.495 (#OOM: 0)
Epoch 43 - update      20370 => loss:   0.719 (#OOM: 0)
Epoch 43 - update      20400 => loss:   0.632 (#OOM: 0)
Epoch 43 - update      20430 => loss:   0.733 (#OOM: 0)
Epoch 43 - update      20460 => loss:   0.462 (#OOM: 0)
Epoch 43 - update      20490 => loss:   0.644 (#OOM: 0)
--> Epoch 43 finished with mean loss 0.65870
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (771 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.95batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.06batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.30batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.62batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.37batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.34batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.31batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 82.53batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 79.33batch/s]  3%|▊                           | 28/1014 [00:00<00:12, 81.93batch/s]  4%|█                           | 38/1014 [00:00<00:12, 77.02batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 75.24batch/s]  6%|█▌                          | 58/1014 [00:00<00:12, 74.64batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 74.88batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 74.27batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 74.65batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 74.96batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.45batch/s] 12%|███▏                       | 118/1014 [00:01<00:12, 74.31batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 74.44batch/s] 14%|███▋                       | 138/1014 [00:01<00:11, 74.80batch/s] 15%|███▉                       | 148/1014 [00:01<00:11, 74.98batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 75.43batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.31batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 74.33batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 74.81batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 74.90batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 75.37batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 75.36batch/s] 22%|██████                     | 228/1014 [00:03<00:10, 75.60batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 75.44batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 75.19batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 75.31batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.05batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.06batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.12batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 75.36batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 75.26batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 75.18batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 75.57batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 75.62batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 75.62batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.81batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.54batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 75.60batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.26batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 75.42batch/s] 40%|██████████▊                | 408/1014 [00:05<00:08, 75.55batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 75.71batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 75.30batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.46batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.60batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 75.65batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.78batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 75.87batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 75.83batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 75.55batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 75.70batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 75.74batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 75.77batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.79batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 75.73batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.43batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 75.41batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 75.52batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 75.45batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 75.39batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 75.60batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 75.50batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 75.50batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 75.52batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.31batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 75.07batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 75.05batch/s] 67%|██████████████████         | 678/1014 [00:09<00:04, 75.04batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 75.24batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 75.23batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 75.19batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 75.19batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 74.91batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 74.75batch/s] 74%|███████████████████▉       | 748/1014 [00:10<00:03, 74.77batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 74.90batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 74.79batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 74.65batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 74.68batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 74.64batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 74.63batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 74.52batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 74.51batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 74.57batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 74.64batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 74.72batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 74.65batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 74.70batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 74.73batch/s] 89%|███████████████████████▉   | 898/1014 [00:12<00:01, 74.64batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 74.59batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 74.45batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 74.24batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 74.02batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 73.98batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 73.89batch/s] 95%|█████████████████████████▊ | 968/1014 [00:13<00:00, 73.73batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 73.85batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 73.85batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 73.91batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 73.90batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.78batch/s]
Validation 43 -> LOSS = 1.22
Validation 43 -> BLEU = 52.12, 74.8/57.9/46.3/36.8 (BP=1.000, ratio=1.002, hyp_len=14414, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.50 @ validation 42
Starting Epoch 44
Epoch 44 - update      20520 => loss:   0.283 (#OOM: 0)
Epoch 44 - update      20550 => loss:   0.616 (#OOM: 0)
Epoch 44 - update      20580 => loss:   0.976 (#OOM: 0)
Epoch 44 - update      20610 => loss:   0.464 (#OOM: 0)
Epoch 44 - update      20640 => loss:   0.810 (#OOM: 0)
Epoch 44 - update      20670 => loss:   0.556 (#OOM: 0)
Epoch 44 - update      20700 => loss:   0.763 (#OOM: 0)
Epoch 44 - update      20730 => loss:   0.511 (#OOM: 0)
Epoch 44 - update      20760 => loss:   0.753 (#OOM: 0)
Epoch 44 - update      20790 => loss:   0.451 (#OOM: 0)
Epoch 44 - update      20820 => loss:   0.650 (#OOM: 0)
Epoch 44 - update      20850 => loss:   0.629 (#OOM: 0)
Epoch 44 - update      20880 => loss:   0.463 (#OOM: 0)
Epoch 44 - update      20910 => loss:   0.644 (#OOM: 0)
Epoch 44 - update      20940 => loss:   0.579 (#OOM: 0)
Epoch 44 - update      20970 => loss:   0.705 (#OOM: 0)
--> Epoch 44 finished with mean loss 0.65607
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (787 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.08batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 48.18batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 51.67batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.76batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 52.81batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.03batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.34batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:13, 77.18batch/s]  2%|▍                           | 18/1014 [00:00<00:14, 68.87batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 70.52batch/s]  4%|▉                           | 36/1014 [00:00<00:14, 68.95batch/s]  4%|█▏                          | 45/1014 [00:00<00:14, 68.98batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 69.62batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 70.37batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 71.22batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 72.74batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.03batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 74.26batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.63batch/s] 12%|███                        | 117/1014 [00:01<00:12, 73.09batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.69batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 73.24batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 74.36batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 74.09batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 74.41batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 74.51batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 74.37batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 74.00batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 73.87batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 74.20batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.18batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 74.45batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 74.39batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 74.55batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.47batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.75batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.16batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.28batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.82batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.23batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 75.19batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.97batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 75.10batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.57batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.72batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.76batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.72batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.01batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.18batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 75.00batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.03batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.12batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 75.17batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.09batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.29batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.08batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 75.04batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.95batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 74.83batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 74.61batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 74.52batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 74.62batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 74.39batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 74.39batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 74.35batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.47batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.51batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 74.48batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 74.42batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 74.46batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 74.47batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 74.37batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.28batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.22batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.35batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.47batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.40batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.43batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.56batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 74.61batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.64batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.61batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 74.64batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.61batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.55batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.61batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.61batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.53batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.41batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.30batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.38batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.41batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.49batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.43batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:02, 74.42batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.36batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.27batch/s] 88%|███████████████████████▊   | 895/1014 [00:12<00:01, 74.40batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.29batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.18batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.19batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.25batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.32batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.37batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.36batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.33batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.47batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.31batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.31batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.28batch/s]
Validation 44 -> LOSS = 1.22
Validation 44 -> BLEU = 52.37, 74.9/58.2/46.6/37.3 (BP=0.999, ratio=0.999, hyp_len=14363, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.50 @ validation 42
Starting Epoch 45
Epoch 45 - update      21000 => loss:   0.479 (#OOM: 0)
Epoch 45 - update      21030 => loss:   0.380 (#OOM: 0)
Epoch 45 - update      21060 => loss:   0.453 (#OOM: 0)
Epoch 45 - update      21090 => loss:   0.863 (#OOM: 0)
Epoch 45 - update      21120 => loss:   0.425 (#OOM: 0)
Epoch 45 - update      21150 => loss:   0.422 (#OOM: 0)
Epoch 45 - update      21180 => loss:   0.599 (#OOM: 0)
Epoch 45 - update      21210 => loss:   0.590 (#OOM: 0)
Epoch 45 - update      21240 => loss:   0.641 (#OOM: 0)
Epoch 45 - update      21270 => loss:   0.497 (#OOM: 0)
Epoch 45 - update      21300 => loss:   0.538 (#OOM: 0)
Epoch 45 - update      21330 => loss:   0.825 (#OOM: 0)
Epoch 45 - update      21360 => loss:   0.864 (#OOM: 0)
Epoch 45 - update      21390 => loss:   0.730 (#OOM: 0)
Epoch 45 - update      21420 => loss:   0.732 (#OOM: 0)
Epoch 45 - update      21450 => loss:   0.730 (#OOM: 0)
--> Epoch 45 finished with mean loss 0.65091
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (808 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.53batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 49.35batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 50.92batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 52.64batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 52.76batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.89batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.63batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.47batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.93batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.01batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 74.16batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.40batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 75.60batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 74.91batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 74.32batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 74.70batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 74.26batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.88batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 75.95batch/s] 11%|███                        | 114/1014 [00:01<00:11, 76.37batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.75batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 75.62batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 75.72batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 75.81batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 75.54batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.34batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 75.11batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.75batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 74.43batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 74.07batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 73.92batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.38batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 74.43batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 74.41batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 74.61batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 74.73batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 74.89batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.22batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.53batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.49batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 75.47batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 75.56batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 75.40batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 75.47batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 75.40batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 74.59batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.72batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 74.68batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 75.04batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.95batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.15batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 75.03batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 75.00batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 75.03batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 74.92batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.05batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 75.27batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.27batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.08batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.90batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 74.95batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 75.17batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.22batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 75.47batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.44batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.30batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.41batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.19batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.23batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.33batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.37batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.90batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.98batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 74.90batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 75.01batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.12batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.11batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.00batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 75.13batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.10batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.09batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.16batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.12batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.18batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.08batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.16batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.19batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.33batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 75.25batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 75.24batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 75.24batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.29batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 75.41batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.37batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 75.31batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 75.20batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 75.04batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.14batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 75.15batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.10batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 75.11batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 75.15batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.15batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.06batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.07batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.27batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.25batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.29batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.18batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 75.15batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 75.17batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.13batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.06batch/s]
Validation 45 -> LOSS = 1.22
Validation 45 -> BLEU = 52.65, 75.3/58.6/47.0/37.5 (BP=0.997, ratio=0.997, hyp_len=14336, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.65 @ validation 45
Starting Epoch 46
Epoch 46 - update      21480 => loss:   0.385 (#OOM: 0)
Epoch 46 - update      21510 => loss:   0.779 (#OOM: 0)
Epoch 46 - update      21540 => loss:   0.422 (#OOM: 0)
Epoch 46 - update      21570 => loss:   0.928 (#OOM: 0)
Epoch 46 - update      21600 => loss:   0.542 (#OOM: 0)
Epoch 46 - update      21630 => loss:   0.598 (#OOM: 0)
Epoch 46 - update      21660 => loss:   0.502 (#OOM: 0)
Epoch 46 - update      21690 => loss:   0.708 (#OOM: 0)
Epoch 46 - update      21720 => loss:   0.906 (#OOM: 0)
Epoch 46 - update      21750 => loss:   0.710 (#OOM: 0)
Epoch 46 - update      21780 => loss:   0.511 (#OOM: 0)
Epoch 46 - update      21810 => loss:   0.793 (#OOM: 0)
Epoch 46 - update      21840 => loss:   0.510 (#OOM: 0)
Epoch 46 - update      21870 => loss:   0.727 (#OOM: 0)
Epoch 46 - update      21900 => loss:   0.556 (#OOM: 0)
Epoch 46 - update      21930 => loss:   0.585 (#OOM: 0)
--> Epoch 46 finished with mean loss 0.64687
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (797 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 38.29batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.88batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 45.59batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 46.31batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 48.28batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.91batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.88batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.38batch/s]  2%|▍                           | 17/1014 [00:00<00:11, 83.65batch/s]  3%|▋                           | 26/1014 [00:00<00:11, 83.11batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 78.84batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 77.05batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 75.87batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 74.85batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 75.61batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 74.68batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 75.01batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 75.10batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 75.01batch/s] 11%|███                        | 116/1014 [00:01<00:12, 73.88batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 73.98batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 73.26batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 73.18batch/s] 15%|████                       | 152/1014 [00:02<00:11, 73.43batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 73.80batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 73.91batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 73.79batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 73.90batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 73.51batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 73.95batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 74.50batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 74.71batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.90batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 74.64batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 74.97batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 75.13batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.37batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.64batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.68batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.92batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.93batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.92batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.84batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 75.88batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 75.91batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 76.08batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 75.69batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.80batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 75.81batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.54batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.58batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.47batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.50batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 75.55batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 75.61batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 75.79batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 75.85batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 75.92batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 75.92batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.88batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 75.81batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.91batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.86batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 75.59batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 75.53batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 75.47batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 75.62batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 75.64batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 75.60batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.66batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.70batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.81batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.59batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 75.61batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 75.44batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 75.24batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 75.23batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 75.29batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.28batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.30batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.92batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 74.88batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.02batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.20batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.27batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 75.18batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.11batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.09batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.07batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 74.79batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 74.86batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.83batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 74.87batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 74.92batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 74.92batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.00batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 74.96batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.94batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.83batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.75batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 74.76batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 74.72batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 74.63batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 74.52batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 74.60batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 74.76batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 74.69batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 74.65batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 74.71batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 74.68batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 74.60batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 74.49batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 74.47batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 74.49batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 74.55batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 74.58batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.59batch/s]
Validation 46 -> LOSS = 1.22
Validation 46 -> BLEU = 52.46, 74.9/58.1/46.6/37.3 (BP=1.000, ratio=1.000, hyp_len=14386, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.65 @ validation 45
Starting Epoch 47
Epoch 47 - update      21960 => loss:   0.431 (#OOM: 0)
Epoch 47 - update      21990 => loss:   0.854 (#OOM: 0)
Epoch 47 - update      22020 => loss:   0.640 (#OOM: 0)
Epoch 47 - update      22050 => loss:   0.752 (#OOM: 0)
Epoch 47 - update      22080 => loss:   0.936 (#OOM: 0)
Epoch 47 - update      22110 => loss:   0.672 (#OOM: 0)
Epoch 47 - update      22140 => loss:   0.820 (#OOM: 0)
Epoch 47 - update      22170 => loss:   0.570 (#OOM: 0)
Epoch 47 - update      22200 => loss:   0.702 (#OOM: 0)
Epoch 47 - update      22230 => loss:   0.452 (#OOM: 0)
Epoch 47 - update      22260 => loss:   0.490 (#OOM: 0)
Epoch 47 - update      22290 => loss:   0.512 (#OOM: 0)
Epoch 47 - update      22320 => loss:   0.660 (#OOM: 0)
Epoch 47 - update      22350 => loss:   0.562 (#OOM: 0)
Epoch 47 - update      22380 => loss:   0.964 (#OOM: 0)
Epoch 47 - update      22410 => loss:   0.471 (#OOM: 0)
--> Epoch 47 finished with mean loss 0.64396
--> Overhead/Training/Evaluation: 0.03/0.50/0.00 mins (total: 0.53 mins)   (962 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 48.96batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.78batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 48.96batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.66batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 49.46batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.97batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.82batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.36batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.16batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 75.02batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 75.56batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 75.47batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.43batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 75.54batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.20batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.05batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 74.49batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.63batch/s] 12%|███                        | 117/1014 [00:01<00:12, 73.91batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.44batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 73.56batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 72.98batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.10batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.33batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.67batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.13batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.24batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 74.83batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 74.63batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.73batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.81batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.68batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.68batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.67batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 74.80batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 74.84batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.02batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 74.85batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.00batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.45batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 73.96batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 73.86batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.05batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 74.11batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 74.18batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 74.12batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 74.21batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 74.27batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.51batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.68batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.73batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.69batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.51batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.56batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 74.53batch/s] 44%|███████████▉               | 450/1014 [00:06<00:07, 74.75batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 74.71batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 74.59batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.67batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.75batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.88batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.73batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.63batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 74.59batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 74.56batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 74.57batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 74.41batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 74.51batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 74.46batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.48batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.56batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.51batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.41batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.48batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 74.37batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 74.39batch/s] 63%|█████████████████          | 639/1014 [00:08<00:05, 74.51batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 74.66batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.64batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.55batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.50batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.56batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.46batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.35batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 74.27batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 74.45batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 74.38batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 74.33batch/s] 74%|███████████████████▉       | 751/1014 [00:10<00:03, 74.32batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 74.23batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 74.18batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 74.18batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:03, 74.21batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.23batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 74.21batch/s] 81%|█████████████████████▊     | 821/1014 [00:11<00:02, 74.26batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 74.20batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 74.30batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 74.28batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 74.38batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 74.32batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 74.41batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 74.40batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 74.50batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 74.42batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 74.30batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 74.26batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 74.17batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 74.08batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 74.10batch/s] 96%|█████████████████████████▊ | 971/1014 [00:13<00:00, 74.24batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 74.32batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 74.41batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 74.42batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 74.42batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.40batch/s]
Validation 47 -> LOSS = 1.22
Validation 47 -> BLEU = 52.62, 75.0/58.4/46.8/37.4 (BP=1.000, ratio=1.004, hyp_len=14436, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.65 @ validation 45
Starting Epoch 48
Epoch 48 - update      22440 => loss:   0.580 (#OOM: 0)
Epoch 48 - update      22470 => loss:   0.532 (#OOM: 0)
Epoch 48 - update      22500 => loss:   0.475 (#OOM: 0)
Epoch 48 - update      22530 => loss:   0.879 (#OOM: 0)
Epoch 48 - update      22560 => loss:   0.560 (#OOM: 0)
Epoch 48 - update      22590 => loss:   0.550 (#OOM: 0)
Epoch 48 - update      22620 => loss:   0.592 (#OOM: 0)
Epoch 48 - update      22650 => loss:   0.816 (#OOM: 0)
Epoch 48 - update      22680 => loss:   0.657 (#OOM: 0)
Epoch 48 - update      22710 => loss:   0.517 (#OOM: 0)
Epoch 48 - update      22740 => loss:   0.600 (#OOM: 0)
Epoch 48 - update      22770 => loss:   0.538 (#OOM: 0)
Epoch 48 - update      22800 => loss:   0.531 (#OOM: 0)
Epoch 48 - update      22830 => loss:   0.846 (#OOM: 0)
Epoch 48 - update      22860 => loss:   0.553 (#OOM: 0)
Epoch 48 - update      22890 => loss:   0.851 (#OOM: 0)
--> Epoch 48 finished with mean loss 0.64084
--> Overhead/Training/Evaluation: 0.03/0.57/0.00 mins (total: 0.61 mins)   (843 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.71batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.73batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 50.92batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 49.06batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 50.58batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.59batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.90batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 77.37batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.32batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.49batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 76.45batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 77.95batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.39batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 78.04batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 78.71batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 78.48batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 78.46batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 78.14batch/s] 12%|███                        | 117/1014 [00:01<00:11, 78.11batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 77.99batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.76batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 76.55batch/s] 15%|████                       | 153/1014 [00:02<00:11, 76.39batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 76.39batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 76.22batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.29batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.97batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 76.01batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.64batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.56batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.53batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.86batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.66batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.93batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 74.45batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 74.45batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 74.30batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 74.15batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 74.20batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.39batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.34batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.12batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 73.91batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 73.95batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 73.90batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 73.79batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 73.87batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 74.03batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 73.89batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 73.98batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 73.93batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.02batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.13batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.31batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 74.25batch/s] 44%|███████████▉               | 450/1014 [00:06<00:07, 74.21batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 74.29batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 74.41batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.21batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.22batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.33batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 74.51batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 74.58batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 74.65batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 74.66batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 74.72batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 74.62batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 74.51batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.31batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.26batch/s] 59%|███████████████▊           | 595/1014 [00:08<00:05, 74.25batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 74.34batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 74.47batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 74.38batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 74.28batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.41batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.62batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.73batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.94batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.98batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.93batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.84batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 74.69batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.75batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.68batch/s] 73%|███████████████████▊       | 745/1014 [00:10<00:03, 74.46batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.44batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.50batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.37batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.32batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.51batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.39batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.31batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.23batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.28batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.24batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.22batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:02, 74.22batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.25batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.32batch/s] 88%|███████████████████████▊   | 895/1014 [00:12<00:01, 74.39batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.23batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.22batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.28batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.28batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.08batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.09batch/s] 95%|█████████████████████████▋ | 965/1014 [00:13<00:00, 74.11batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.18batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.15batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.25batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.30batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.27batch/s]
Validation 48 -> LOSS = 1.23
Validation 48 -> BLEU = 52.71, 75.5/58.7/47.1/37.6 (BP=0.996, ratio=0.996, hyp_len=14326, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 49
Epoch 49 - update      22920 => loss:   0.503 (#OOM: 0)
Epoch 49 - update      22950 => loss:   0.809 (#OOM: 0)
Epoch 49 - update      22980 => loss:   0.487 (#OOM: 0)
Epoch 49 - update      23010 => loss:   0.525 (#OOM: 0)
Epoch 49 - update      23040 => loss:   0.680 (#OOM: 0)
Epoch 49 - update      23070 => loss:   0.486 (#OOM: 0)
Epoch 49 - update      23100 => loss:   0.438 (#OOM: 0)
Epoch 49 - update      23130 => loss:   0.585 (#OOM: 0)
Epoch 49 - update      23160 => loss:   0.653 (#OOM: 0)
Epoch 49 - update      23190 => loss:   0.629 (#OOM: 0)
Epoch 49 - update      23220 => loss:   0.745 (#OOM: 0)
Epoch 49 - update      23250 => loss:   0.835 (#OOM: 0)
Epoch 49 - update      23280 => loss:   0.800 (#OOM: 0)
Epoch 49 - update      23310 => loss:   0.743 (#OOM: 0)
Epoch 49 - update      23340 => loss:   0.765 (#OOM: 0)
Epoch 49 - update      23370 => loss:   0.680 (#OOM: 0)
--> Epoch 49 finished with mean loss 0.63772
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (817 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.08batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.82batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.38batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.49batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.11batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.48batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.45batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.17batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.48batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.81batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 75.87batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 74.53batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.59batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 72.13batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 71.26batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 72.24batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 71.53batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 71.24batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 70.77batch/s] 11%|███                        | 115/1014 [00:01<00:12, 71.32batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 72.30batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 72.45batch/s] 14%|███▊                       | 142/1014 [00:01<00:12, 72.19batch/s] 15%|████                       | 151/1014 [00:02<00:11, 72.00batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 71.88batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 72.20batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 72.36batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 72.40batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 72.27batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 72.57batch/s] 21%|█████▋                     | 214/1014 [00:02<00:11, 72.34batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 72.53batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 72.62batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 72.92batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 73.07batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 72.81batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 73.15batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 73.20batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 73.08batch/s] 29%|███████▊                   | 295/1014 [00:04<00:09, 73.26batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 73.60batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 73.68batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 73.61batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 74.10batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 74.00batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 74.11batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 74.03batch/s] 37%|█████████▉                 | 372/1014 [00:05<00:08, 73.80batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 73.75batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 73.51batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 73.43batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 73.50batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 73.49batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 73.72batch/s] 44%|███████████▊               | 442/1014 [00:06<00:07, 73.29batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 73.22batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 73.32batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 73.45batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 73.28batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 73.31batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 73.31batch/s] 50%|█████████████▋             | 512/1014 [00:07<00:06, 73.04batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 73.07batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 72.90batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 72.97batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 72.94batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 73.08batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:06, 73.11batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 73.31batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 73.26batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 73.40batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 73.40batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 73.25batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 73.11batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 73.13batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 73.31batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 73.33batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 73.31batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 73.41batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 73.47batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 73.42batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 73.53batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 73.53batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 73.44batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 73.53batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 73.60batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 73.68batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 73.84batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 73.83batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:03, 73.94batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 73.92batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 73.93batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 73.87batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 73.95batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 73.87batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.00batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.02batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.06batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 73.99batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 74.00batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 73.99batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 73.99batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 73.96batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 73.96batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 73.99batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.09batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.20batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 74.19batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.22batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.26batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.29batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.27batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.29batch/s]
Validation 49 -> LOSS = 1.23
Validation 49 -> BLEU = 52.34, 75.1/58.1/46.5/37.1 (BP=0.999, ratio=0.999, hyp_len=14368, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 50
Epoch 50 - update      23400 => loss:   0.633 (#OOM: 0)
Epoch 50 - update      23430 => loss:   0.569 (#OOM: 0)
Epoch 50 - update      23460 => loss:   0.649 (#OOM: 0)
Epoch 50 - update      23490 => loss:   0.491 (#OOM: 0)
Epoch 50 - update      23520 => loss:   0.564 (#OOM: 0)
Epoch 50 - update      23550 => loss:   0.569 (#OOM: 0)
Epoch 50 - update      23580 => loss:   0.556 (#OOM: 0)
Epoch 50 - update      23610 => loss:   0.711 (#OOM: 0)
Epoch 50 - update      23640 => loss:   0.525 (#OOM: 0)
Epoch 50 - update      23670 => loss:   0.338 (#OOM: 0)
Epoch 50 - update      23700 => loss:   0.653 (#OOM: 0)
Epoch 50 - update      23730 => loss:   0.563 (#OOM: 0)
Epoch 50 - update      23760 => loss:   0.541 (#OOM: 0)
Epoch 50 - update      23790 => loss:   0.550 (#OOM: 0)
Epoch 50 - update      23820 => loss:   0.647 (#OOM: 0)
Epoch 50 - update      23850 => loss:   0.622 (#OOM: 0)
--> Epoch 50 finished with mean loss 0.63331
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (818 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.15batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.76batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.57batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.83batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.36batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.07batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.04batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 68.12batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.70batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.37batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 79.54batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 80.26batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 77.32batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 76.18batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 77.31batch/s]  8%|██▏                         | 79/1014 [00:01<00:11, 78.05batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 77.21batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 77.27batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 76.95batch/s] 11%|███                        | 115/1014 [00:01<00:11, 76.12batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 75.74batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 76.22batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 76.58batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.31batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.31batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 76.32batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 76.60batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.00batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.84batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 75.72batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 75.82batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.63batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.62batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 75.21batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 74.97batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 74.82batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 74.80batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.60batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.77batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.84batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.94batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.92batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.76batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.11batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.04batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 75.27batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 75.20batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 75.07batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 75.08batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 75.16batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 74.77batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 74.77batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 74.85batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.88batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.88batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.80batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.83batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 74.81batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.87batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 74.60batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.77batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 74.60batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 74.75batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 74.88batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 74.94batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 74.63batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 74.69batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.74batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.67batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.59batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.34batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.55batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 74.51batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 74.37batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 74.28batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 74.37batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 74.51batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 74.48batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.53batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 74.37batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.24batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 74.16batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 74.08batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 74.02batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 74.09batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 74.10batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.09batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.01batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 73.79batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:03, 73.80batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 73.62batch/s] 80%|█████████████████████▌     | 812/1014 [00:11<00:02, 73.69batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 73.73batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 73.86batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 73.64batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 73.62batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 73.74batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 73.80batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 73.84batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 73.90batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 73.85batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.00batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 73.83batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 73.81batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 73.90batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 73.91batch/s] 95%|█████████████████████████▌ | 962/1014 [00:13<00:00, 73.91batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 73.95batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 73.99batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.01batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 73.93batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.03batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.02batch/s]
Validation 50 -> LOSS = 1.23
Validation 50 -> BLEU = 52.34, 74.9/58.2/46.5/37.0 (BP=1.000, ratio=1.003, hyp_len=14427, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 51
Epoch 51 - update      23880 => loss:   0.550 (#OOM: 0)
Epoch 51 - update      23910 => loss:   0.484 (#OOM: 0)
Epoch 51 - update      23940 => loss:   0.473 (#OOM: 0)
Epoch 51 - update      23970 => loss:   0.666 (#OOM: 0)
Epoch 51 - update      24000 => loss:   0.380 (#OOM: 0)
Epoch 51 - update      24030 => loss:   0.587 (#OOM: 0)
Epoch 51 - update      24060 => loss:   0.512 (#OOM: 0)
Epoch 51 - update      24090 => loss:   0.385 (#OOM: 0)
Epoch 51 - update      24120 => loss:   0.396 (#OOM: 0)
Epoch 51 - update      24150 => loss:   0.463 (#OOM: 0)
Epoch 51 - update      24180 => loss:   0.621 (#OOM: 0)
Epoch 51 - update      24210 => loss:   0.746 (#OOM: 0)
Epoch 51 - update      24240 => loss:   0.536 (#OOM: 0)
Epoch 51 - update      24270 => loss:   0.401 (#OOM: 0)
Epoch 51 - update      24300 => loss:   0.449 (#OOM: 0)
--> Epoch 51 finished with mean loss 0.62835
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (786 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.06batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.73batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 47.26batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 47.06batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 51.60batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.55batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.12batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.91batch/s]  2%|▋                           | 25/1014 [00:00<00:13, 75.81batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 72.35batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 70.61batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.45batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 72.22batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 72.72batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 73.60batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 73.05batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 72.67batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 72.63batch/s] 11%|███                        | 115/1014 [00:01<00:12, 72.07batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 72.46batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 71.61batch/s] 14%|███▊                       | 142/1014 [00:01<00:12, 71.48batch/s] 15%|████                       | 151/1014 [00:02<00:12, 71.40batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 72.36batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.11batch/s] 18%|████▊                      | 181/1014 [00:02<00:11, 73.29batch/s] 19%|█████                      | 191/1014 [00:02<00:11, 73.86batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 74.08batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 74.13batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 74.15batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 74.37batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.62batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 74.43batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 74.74batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 74.97batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 74.74batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 74.55batch/s] 30%|████████                   | 301/1014 [00:04<00:09, 74.74batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 74.90batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 74.80batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 74.66batch/s] 34%|█████████                  | 341/1014 [00:04<00:09, 74.70batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 74.56batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 74.58batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 74.53batch/s] 38%|██████████▏                | 381/1014 [00:05<00:08, 74.75batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 74.85batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 74.55batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 74.23batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 74.25batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 73.91batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 74.01batch/s] 44%|████████████               | 451/1014 [00:06<00:07, 73.72batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 73.78batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 73.86batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 74.05batch/s] 48%|█████████████              | 491/1014 [00:06<00:07, 74.04batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 74.05batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 74.05batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 74.17batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 74.22batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 74.13batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 73.91batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:06, 73.93batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 73.92batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 74.04batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 74.07batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 73.98batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 73.91batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 73.85batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 73.89batch/s] 63%|█████████████████          | 641/1014 [00:08<00:05, 73.77batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 73.89batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 73.83batch/s] 66%|█████████████████▊         | 671/1014 [00:09<00:04, 74.05batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 74.03batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 74.18batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 74.26batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 74.29batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 74.24batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 73.97batch/s] 73%|███████████████████▋       | 741/1014 [00:10<00:03, 73.93batch/s] 74%|███████████████████▉       | 751/1014 [00:10<00:03, 73.98batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 74.03batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 73.93batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 73.97batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:03, 74.15batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.26batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 74.25batch/s] 81%|█████████████████████▊     | 821/1014 [00:11<00:02, 74.35batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 74.32batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 74.31batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 74.43batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 74.55batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 74.51batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 74.59batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 74.60batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 74.67batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 74.74batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 74.73batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 74.86batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 74.77batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 74.76batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 74.78batch/s] 96%|█████████████████████████▊ | 971/1014 [00:13<00:00, 74.64batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 74.75batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 74.77batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 74.86batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 74.71batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.70batch/s]
Validation 51 -> LOSS = 1.23
Validation 51 -> BLEU = 52.38, 75.2/58.4/46.6/37.2 (BP=0.998, ratio=0.998, hyp_len=14347, ref_len=14382)
** Learning rate changed -> 5e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 52
Epoch 52 - update      24330 => loss:   0.347 (#OOM: 0)
Epoch 52 - update      24360 => loss:   0.810 (#OOM: 0)
Epoch 52 - update      24390 => loss:   0.372 (#OOM: 0)
Epoch 52 - update      24420 => loss:   0.189 (#OOM: 0)
Epoch 52 - update      24450 => loss:   0.488 (#OOM: 0)
Epoch 52 - update      24480 => loss:   0.831 (#OOM: 0)
Epoch 52 - update      24510 => loss:   0.674 (#OOM: 0)
Epoch 52 - update      24540 => loss:   0.681 (#OOM: 0)
Epoch 52 - update      24570 => loss:   0.621 (#OOM: 0)
Epoch 52 - update      24600 => loss:   0.760 (#OOM: 0)
Epoch 52 - update      24630 => loss:   0.426 (#OOM: 0)
Epoch 52 - update      24660 => loss:   0.594 (#OOM: 0)
Epoch 52 - update      24690 => loss:   0.607 (#OOM: 0)
Epoch 52 - update      24720 => loss:   0.665 (#OOM: 0)
Epoch 52 - update      24750 => loss:   0.538 (#OOM: 0)
Epoch 52 - update      24780 => loss:   0.767 (#OOM: 0)
--> Epoch 52 finished with mean loss 0.62111
--> Overhead/Training/Evaluation: 0.03/0.57/0.00 mins (total: 0.61 mins)   (846 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 40.95batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.76batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 50.87batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 50.08batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 50.34batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.68batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 68.80batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 71.14batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 73.30batch/s]  3%|▉                           | 32/1014 [00:00<00:12, 75.80batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 76.04batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 78.05batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 77.94batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 77.94batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 78.86batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 78.01batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 79.05batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 78.67batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 77.07batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 77.84batch/s] 14%|███▋                       | 138/1014 [00:01<00:11, 77.24batch/s] 15%|███▉                       | 148/1014 [00:01<00:11, 77.17batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 77.06batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 77.27batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 76.80batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 76.92batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 77.19batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 77.18batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 77.09batch/s] 22%|██████                     | 228/1014 [00:02<00:10, 76.95batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 76.70batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 76.25batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 75.98batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 76.08batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.27batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 76.36batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 75.95batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 76.22batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 76.06batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 76.17batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 76.04batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 76.12batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 76.10batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 76.25batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 76.53batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 76.38batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 76.24batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 75.92batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 75.75batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 75.88batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 76.05batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 76.14batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 76.11batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 76.20batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 76.14batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 76.10batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.16batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 76.28batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.33batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 76.40batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 76.29batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 76.32batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 76.05batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 75.97batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 75.86batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 75.46batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 75.57batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 75.56batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 75.51batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 75.54batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 75.38batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.24batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 75.20batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 75.08batch/s] 67%|██████████████████         | 678/1014 [00:09<00:04, 74.98batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 74.95batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 75.03batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 75.16batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 75.23batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 75.25batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.25batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 75.27batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 75.02batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 75.11batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.10batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 75.07batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.09batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.08batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.13batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 75.21batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.20batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.20batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.18batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.12batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.11batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.11batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 74.94batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 74.87batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 74.82batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 74.69batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 74.54batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 74.59batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 74.52batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 74.47batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 74.37batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 74.35batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 74.46batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 74.50batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.58batch/s]
Validation 52 -> LOSS = 1.23
Validation 52 -> BLEU = 52.46, 75.1/58.4/46.7/37.2 (BP=0.999, ratio=0.999, hyp_len=14367, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 53
Epoch 53 - update      24810 => loss:   0.124 (#OOM: 0)
Epoch 53 - update      24840 => loss:   0.553 (#OOM: 0)
Epoch 53 - update      24870 => loss:   0.492 (#OOM: 0)
Epoch 53 - update      24900 => loss:   0.500 (#OOM: 0)
Epoch 53 - update      24930 => loss:   0.441 (#OOM: 0)
Epoch 53 - update      24960 => loss:   0.438 (#OOM: 0)
Epoch 53 - update      24990 => loss:   0.570 (#OOM: 0)
Epoch 53 - update      25020 => loss:   0.496 (#OOM: 0)
Epoch 53 - update      25050 => loss:   0.568 (#OOM: 0)
Epoch 53 - update      25080 => loss:   0.616 (#OOM: 0)
Epoch 53 - update      25110 => loss:   0.532 (#OOM: 0)
Epoch 53 - update      25140 => loss:   0.528 (#OOM: 0)
Epoch 53 - update      25170 => loss:   0.627 (#OOM: 0)
Epoch 53 - update      25200 => loss:   0.681 (#OOM: 0)
Epoch 53 - update      25230 => loss:   0.365 (#OOM: 0)
Epoch 53 - update      25260 => loss:   0.668 (#OOM: 0)
--> Epoch 53 finished with mean loss 0.61690
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (832 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.54batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.12batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.16batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 49.60batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 50.28batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 49.97batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.55batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 87.93batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 84.22batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.74batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 80.82batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.41batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 77.76batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.13batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 76.83batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.53batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 75.69batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 74.05batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.29batch/s] 12%|███                        | 117/1014 [00:01<00:12, 73.13batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.23batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 73.37batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.68batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.42batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.33batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.37batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 73.13batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.23batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.15batch/s] 20%|█████▌                     | 207/1014 [00:02<00:11, 73.05batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 73.23batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 73.30batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.64batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 74.20batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 74.14batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 74.58batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 74.58batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 74.78batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 74.71batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.79batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.52batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.33batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 74.56batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:09, 74.10batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 74.16batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 74.38batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.22batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.29batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 74.25batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.34batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.07batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 74.13batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 74.34batch/s] 44%|███████████▊               | 444/1014 [00:06<00:07, 73.91batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 73.99batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 73.98batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 73.78batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 73.94batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 74.10batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.06batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 73.91batch/s] 52%|█████████████▉             | 524/1014 [00:07<00:06, 73.82batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 73.97batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 74.06batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 73.81batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 73.71batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 73.64batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 73.73batch/s] 59%|███████████████▊           | 594/1014 [00:08<00:05, 73.68batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 73.69batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 73.82batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 73.87batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 73.87batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:05, 73.87batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 73.83batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 73.79batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 73.73batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 73.72batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 73.78batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 73.80batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 73.85batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 73.91batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 73.98batch/s] 73%|███████████████████▊       | 744/1014 [00:10<00:03, 74.04batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 73.98batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 73.93batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 73.97batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 73.96batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 73.98batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.04batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.01batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.10batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.13batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.13batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.16batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.19batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.17batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.19batch/s] 88%|███████████████████████▊   | 894/1014 [00:12<00:01, 74.26batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.26batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.13batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.09batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.12batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.21batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.17batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.27batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.38batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.31batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.38batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.37batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.30batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.29batch/s]
Validation 53 -> LOSS = 1.23
Validation 53 -> BLEU = 52.68, 75.3/58.5/47.0/37.5 (BP=0.998, ratio=0.998, hyp_len=14356, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 54
Epoch 54 - update      25290 => loss:   0.810 (#OOM: 0)
Epoch 54 - update      25320 => loss:   0.509 (#OOM: 0)
Epoch 54 - update      25350 => loss:   0.579 (#OOM: 0)
Epoch 54 - update      25380 => loss:   0.585 (#OOM: 0)
Epoch 54 - update      25410 => loss:   0.671 (#OOM: 0)
Epoch 54 - update      25440 => loss:   0.488 (#OOM: 0)
Epoch 54 - update      25470 => loss:   0.287 (#OOM: 0)
Epoch 54 - update      25500 => loss:   0.455 (#OOM: 0)
Epoch 54 - update      25530 => loss:   0.569 (#OOM: 0)
Epoch 54 - update      25560 => loss:   0.558 (#OOM: 0)
Epoch 54 - update      25590 => loss:   0.487 (#OOM: 0)
Epoch 54 - update      25620 => loss:   0.670 (#OOM: 0)
Epoch 54 - update      25650 => loss:   0.452 (#OOM: 0)
Epoch 54 - update      25680 => loss:   0.615 (#OOM: 0)
Epoch 54 - update      25710 => loss:   0.477 (#OOM: 0)
Epoch 54 - update      25740 => loss:   0.830 (#OOM: 0)
--> Epoch 54 finished with mean loss 0.61132
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (808 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.83batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.08batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.13batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.93batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.34batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.92batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.87batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.16batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.25batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 79.33batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 81.59batch/s]  4%|█▏                          | 43/1014 [00:00<00:11, 83.02batch/s]  5%|█▍                          | 52/1014 [00:00<00:11, 80.76batch/s]  6%|█▋                          | 61/1014 [00:00<00:11, 81.55batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 79.41batch/s]  8%|██▏                         | 79/1014 [00:00<00:11, 79.38batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 77.19batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 77.07batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 76.24batch/s] 11%|███                        | 115/1014 [00:01<00:11, 76.28batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 75.53batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.22batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 75.30batch/s] 15%|████                       | 151/1014 [00:02<00:11, 75.10batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 75.08batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 75.40batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 75.64batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 75.29batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.57batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.86batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 74.96batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 74.81batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 74.33batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.21batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 74.43batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 74.29batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 74.16batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.56batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.08batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.24batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.22batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.57batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.88batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 75.11batch/s] 34%|█████████                  | 340/1014 [00:04<00:09, 74.73batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 74.78batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 74.94batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.13batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 75.05batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.08batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.20batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.13batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.38batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 75.45batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 75.70batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 75.83batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 75.80batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 75.71batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 75.48batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 75.39batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 75.28batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 75.47batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 75.66batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 75.44batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 75.34batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 75.42batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 75.58batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:06, 75.50batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 75.46batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 75.36batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 75.43batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 75.46batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 75.18batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.01batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 74.99batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 74.94batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 74.90batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 74.95batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 74.76batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 74.89batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 74.95batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 74.99batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 75.00batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 74.94batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 74.91batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 74.78batch/s] 74%|███████████████████▉       | 751/1014 [00:10<00:03, 74.79batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 74.86batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 74.90batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 74.82batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 74.90batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.99batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 74.91batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 74.98batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 74.99batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 74.87batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 74.88batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 74.81batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 74.92batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 74.97batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 74.97batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 74.95batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 74.90batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 74.88batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 74.76batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 74.76batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 74.85batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 74.94batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 74.88batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 74.87batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 74.79batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 74.86batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 74.66batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.63batch/s]
Validation 54 -> LOSS = 1.23
Validation 54 -> BLEU = 52.62, 75.4/58.8/47.1/37.6 (BP=0.995, ratio=0.995, hyp_len=14304, ref_len=14382)
** Learning rate changed -> 2.5e-05
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 55
Epoch 55 - update      25770 => loss:   0.764 (#OOM: 0)
Epoch 55 - update      25800 => loss:   0.668 (#OOM: 0)
Epoch 55 - update      25830 => loss:   0.864 (#OOM: 0)
Epoch 55 - update      25860 => loss:   0.500 (#OOM: 0)
Epoch 55 - update      25890 => loss:   0.739 (#OOM: 0)
Epoch 55 - update      25920 => loss:   0.549 (#OOM: 0)
Epoch 55 - update      25950 => loss:   0.469 (#OOM: 0)
Epoch 55 - update      25980 => loss:   0.556 (#OOM: 0)
Epoch 55 - update      26010 => loss:   0.450 (#OOM: 0)
Epoch 55 - update      26040 => loss:   0.827 (#OOM: 0)
Epoch 55 - update      26070 => loss:   0.731 (#OOM: 0)
Epoch 55 - update      26100 => loss:   0.585 (#OOM: 0)
Epoch 55 - update      26130 => loss:   0.626 (#OOM: 0)
Epoch 55 - update      26160 => loss:   0.739 (#OOM: 0)
Epoch 55 - update      26190 => loss:   0.358 (#OOM: 0)
Epoch 55 - update      26220 => loss:   0.295 (#OOM: 0)
--> Epoch 55 finished with mean loss 0.60684
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (794 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.06batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.81batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.27batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 50.14batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 49.85batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.06batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.15batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 71.39batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.74batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 72.98batch/s]  4%|█                           | 40/1014 [00:00<00:13, 73.62batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 73.14batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 72.92batch/s]  6%|█▊                          | 65/1014 [00:00<00:12, 73.81batch/s]  7%|██                          | 74/1014 [00:00<00:12, 75.10batch/s]  8%|██▎                         | 83/1014 [00:01<00:12, 74.17batch/s]  9%|██▌                         | 93/1014 [00:01<00:12, 75.69batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 76.36batch/s] 11%|███                        | 113/1014 [00:01<00:11, 77.29batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.50batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.61batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.72batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.10batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 75.05batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 74.52batch/s] 18%|████▊                      | 183/1014 [00:02<00:11, 74.17batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 74.71batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.70batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.79batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 74.43batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 73.84batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 73.53batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 73.90batch/s] 26%|███████                    | 263/1014 [00:03<00:10, 74.18batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 74.75batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 74.71batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 74.46batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.54batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.63batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 74.72batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.93batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 74.99batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 75.24batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 75.06batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 74.61batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.78batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.70batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.81batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.70batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.97batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.17batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 74.85batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.74batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.45batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.50batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.75batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 74.63batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 74.70batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.54batch/s] 52%|█████████████▉             | 523/1014 [00:07<00:06, 74.54batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 74.57batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 74.44batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 74.39batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 74.45batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 74.45batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 74.19batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 74.18batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.12batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 74.10batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 74.14batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 74.15batch/s] 63%|█████████████████          | 643/1014 [00:08<00:05, 74.15batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 74.31batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.19batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.24batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 74.12batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.08batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 74.07batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 74.06batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 74.03batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 74.28batch/s] 73%|███████████████████▊       | 743/1014 [00:10<00:03, 74.26batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 74.25batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 74.42batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.34batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 74.32batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 74.26batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 74.25batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 74.26batch/s] 81%|█████████████████████▉     | 823/1014 [00:11<00:02, 74.31batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.40batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.45batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.33batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 74.37batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 74.48batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 74.56batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 74.55batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 74.54batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 74.62batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 74.64batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 74.56batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 74.56batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 74.46batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 74.47batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 74.39batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 74.43batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 74.43batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 74.52batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 74.56batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.59batch/s]
Validation 55 -> LOSS = 1.23
Validation 55 -> BLEU = 52.63, 75.2/58.6/47.0/37.6 (BP=0.996, ratio=0.996, hyp_len=14321, ref_len=14382)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 56
Epoch 56 - update      26250 => loss:   0.768 (#OOM: 0)
Epoch 56 - update      26280 => loss:   0.507 (#OOM: 0)
Epoch 56 - update      26310 => loss:   0.594 (#OOM: 0)
Epoch 56 - update      26340 => loss:   0.556 (#OOM: 0)
Epoch 56 - update      26370 => loss:   0.663 (#OOM: 0)
Epoch 56 - update      26400 => loss:   0.355 (#OOM: 0)
Epoch 56 - update      26430 => loss:   0.536 (#OOM: 0)
Epoch 56 - update      26460 => loss:   0.831 (#OOM: 0)
Epoch 56 - update      26490 => loss:   0.573 (#OOM: 0)
Epoch 56 - update      26520 => loss:   0.627 (#OOM: 0)
Epoch 56 - update      26550 => loss:   0.527 (#OOM: 0)
Epoch 56 - update      26580 => loss:   0.626 (#OOM: 0)
Epoch 56 - update      26610 => loss:   0.602 (#OOM: 0)
Epoch 56 - update      26640 => loss:   0.582 (#OOM: 0)
Epoch 56 - update      26670 => loss:   0.572 (#OOM: 0)
Epoch 56 - update      26700 => loss:   0.494 (#OOM: 0)
--> Epoch 56 finished with mean loss 0.60438
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (790 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.92batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.91batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.75batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.10batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.23batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.31batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 83.27batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 76.53batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 74.33batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 73.03batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 71.89batch/s]  5%|█▌                          | 55/1014 [00:00<00:12, 74.50batch/s]  6%|█▊                          | 65/1014 [00:00<00:12, 73.40batch/s]  7%|██                          | 75/1014 [00:01<00:12, 74.77batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 73.96batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 73.70batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 73.80batch/s] 11%|███                        | 115/1014 [00:01<00:12, 73.51batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 73.50batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 73.49batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 73.50batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 74.12batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 73.31batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 72.96batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 72.47batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 72.72batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 73.09batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 73.59batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 73.53batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 73.16batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 73.44batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 74.00batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 73.77batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.09batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.18batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.67batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.76batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.73batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 74.32batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.49batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:09, 74.27batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.20batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.33batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.41batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.55batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.47batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.28batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 74.24batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 74.19batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 74.18batch/s] 44%|███████████▊               | 445/1014 [00:06<00:07, 74.14batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 74.21batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.28batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 73.97batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 73.65batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:07, 73.66batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 73.59batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 73.59batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 73.68batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 73.84batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 73.66batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 73.50batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 73.74batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 73.68batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 73.74batch/s] 59%|███████████████▊           | 595/1014 [00:08<00:05, 73.74batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 73.75batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 73.70batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 73.63batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 73.69batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 73.84batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 73.73batch/s] 66%|█████████████████▋         | 665/1014 [00:09<00:04, 73.87batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 73.87batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 73.99batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.11batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.12batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 74.02batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.08batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.02batch/s] 73%|███████████████████▊       | 745/1014 [00:10<00:03, 73.96batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.08batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.21batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.05batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.02batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.16batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.32batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.40batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.61batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.47batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.66batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.69batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 74.72batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.79batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.82batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 74.70batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.52batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.59batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.65batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.50batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.65batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.62batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.53batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.55batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.57batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.63batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.58batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.49batch/s]
Validation 56 -> LOSS = 1.22
Validation 56 -> BLEU = 52.57, 75.3/58.7/47.0/37.6 (BP=0.994, ratio=0.994, hyp_len=14301, ref_len=14382)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 57
Epoch 57 - update      26730 => loss:   0.706 (#OOM: 0)
Epoch 57 - update      26760 => loss:   0.438 (#OOM: 0)
Epoch 57 - update      26790 => loss:   0.534 (#OOM: 0)
Epoch 57 - update      26820 => loss:   0.544 (#OOM: 0)
Epoch 57 - update      26850 => loss:   0.771 (#OOM: 0)
Epoch 57 - update      26880 => loss:   0.380 (#OOM: 0)
Epoch 57 - update      26910 => loss:   0.456 (#OOM: 0)
Epoch 57 - update      26940 => loss:   0.592 (#OOM: 0)
Epoch 57 - update      26970 => loss:   0.737 (#OOM: 0)
Epoch 57 - update      27000 => loss:   0.449 (#OOM: 0)
Epoch 57 - update      27030 => loss:   0.430 (#OOM: 0)
Epoch 57 - update      27060 => loss:   0.311 (#OOM: 0)
Epoch 57 - update      27090 => loss:   0.473 (#OOM: 0)
Epoch 57 - update      27120 => loss:   0.493 (#OOM: 0)
Epoch 57 - update      27150 => loss:   0.612 (#OOM: 0)
Epoch 57 - update      27180 => loss:   0.565 (#OOM: 0)
--> Epoch 57 finished with mean loss 0.60443
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (876 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.85batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.83batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.15batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.24batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.44batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.60batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.57batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 69.76batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.22batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 73.76batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.53batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 76.01batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 76.07batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 75.84batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 75.76batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 76.17batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 75.84batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 74.19batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 73.93batch/s] 11%|███                        | 114/1014 [00:01<00:11, 75.47batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 75.31batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.53batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.21batch/s] 15%|████                       | 154/1014 [00:02<00:11, 75.36batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 74.64batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 74.91batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 74.58batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 74.73batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 74.70batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 75.20batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 73.75batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.68batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 73.84batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 73.51batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 73.84batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 73.66batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 73.53batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 73.52batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 73.73batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.07batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.22batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 74.38batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:09, 74.33batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 74.24batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 74.27batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.22batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.30batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 74.32batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.06batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.30batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 74.34batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 74.34batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 74.40batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 74.10batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 74.16batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.18batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 74.27batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 74.24batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.44batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 74.44batch/s] 52%|█████████████▉             | 524/1014 [00:07<00:06, 74.38batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 74.38batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 74.28batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 74.30batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 74.45batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 74.63batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.77batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.70batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 74.63batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 74.75batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 74.74batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 74.71batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.76batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.64batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 74.66batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 74.54batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.58batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 74.77batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 74.66batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 74.59batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.69batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 74.66batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 74.61batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.64batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.63batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 74.51batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.54batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 74.56batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.52batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.61batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.40batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.34batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.30batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.28batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.34batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.36batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.37batch/s] 88%|███████████████████████▊   | 894/1014 [00:12<00:01, 74.29batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.16batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.07batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.09batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.06batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.09batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.01batch/s] 95%|█████████████████████████▋ | 964/1014 [00:13<00:00, 73.98batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.06batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.00batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.08batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.06batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.04batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.04batch/s]
Validation 57 -> LOSS = 1.23
Validation 57 -> BLEU = 52.57, 74.9/58.4/46.8/37.4 (BP=1.000, ratio=1.001, hyp_len=14397, ref_len=14382)
** Learning rate changed -> 1.25e-05
Early stopping patience: 1
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 58
Epoch 58 - update      27210 => loss:   0.504 (#OOM: 0)
Epoch 58 - update      27240 => loss:   0.499 (#OOM: 0)
Epoch 58 - update      27270 => loss:   0.462 (#OOM: 0)
Epoch 58 - update      27300 => loss:   0.482 (#OOM: 0)
Epoch 58 - update      27330 => loss:   0.681 (#OOM: 0)
Epoch 58 - update      27360 => loss:   0.428 (#OOM: 0)
Epoch 58 - update      27390 => loss:   0.680 (#OOM: 0)
Epoch 58 - update      27420 => loss:   0.739 (#OOM: 0)
Epoch 58 - update      27450 => loss:   0.591 (#OOM: 0)
Epoch 58 - update      27480 => loss:   0.811 (#OOM: 0)
Epoch 58 - update      27510 => loss:   0.474 (#OOM: 0)
Epoch 58 - update      27540 => loss:   0.753 (#OOM: 0)
Epoch 58 - update      27570 => loss:   0.782 (#OOM: 0)
Epoch 58 - update      27600 => loss:   0.495 (#OOM: 0)
Epoch 58 - update      27630 => loss:   0.818 (#OOM: 0)
Epoch 58 - update      27660 => loss:   0.467 (#OOM: 0)
--> Epoch 58 finished with mean loss 0.60174
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (816 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.23batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 52.46batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.22batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.65batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.82batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.08batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.05batch/s]
Performing greedy search (args: {'k': 3})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:15, 64.68batch/s]  2%|▍                           | 16/1014 [00:00<00:15, 63.80batch/s]  2%|▋                           | 24/1014 [00:00<00:15, 65.31batch/s]  3%|▉                           | 32/1014 [00:00<00:15, 62.64batch/s]  4%|█                           | 40/1014 [00:00<00:15, 64.18batch/s]  5%|█▎                          | 48/1014 [00:00<00:14, 65.09batch/s]  6%|█▌                          | 56/1014 [00:00<00:14, 66.10batch/s]  6%|█▊                          | 64/1014 [00:00<00:14, 67.53batch/s]  7%|██                          | 73/1014 [00:01<00:13, 69.05batch/s]  8%|██▎                         | 82/1014 [00:01<00:13, 69.11batch/s]  9%|██▌                         | 91/1014 [00:01<00:13, 69.08batch/s] 10%|██▋                        | 100/1014 [00:01<00:13, 70.11batch/s] 11%|██▉                        | 109/1014 [00:01<00:12, 70.50batch/s] 12%|███▏                       | 118/1014 [00:01<00:12, 70.64batch/s] 13%|███▍                       | 127/1014 [00:01<00:12, 71.41batch/s] 13%|███▌                       | 136/1014 [00:01<00:12, 71.96batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 73.30batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 73.23batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 72.33batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 72.35batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 72.41batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 73.04batch/s] 20%|█████▍                     | 206/1014 [00:02<00:11, 73.19batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 73.39batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 73.35batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 73.27batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 73.34batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 73.07batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 72.92batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 72.80batch/s] 28%|███████▌                   | 286/1014 [00:03<00:10, 72.79batch/s] 29%|███████▉                   | 296/1014 [00:04<00:09, 73.16batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 73.24batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 72.93batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 72.83batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 72.76batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 73.21batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 73.65batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 73.39batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 73.15batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 73.20batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 73.19batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 73.25batch/s] 41%|███████████                | 416/1014 [00:05<00:08, 73.04batch/s] 42%|███████████▎               | 426/1014 [00:05<00:08, 73.06batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 73.33batch/s] 44%|███████████▉               | 446/1014 [00:06<00:07, 73.23batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 73.44batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 73.63batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 73.67batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 73.51batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:07, 73.52batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 73.47batch/s] 51%|█████████████▋             | 516/1014 [00:07<00:06, 73.49batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 73.49batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 73.49batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 73.48batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 73.59batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 73.79batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 73.88batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 73.86batch/s] 59%|███████████████▊           | 596/1014 [00:08<00:05, 73.79batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 73.92batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.20batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 74.30batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.27batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.21batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 74.29batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.37batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 74.40batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 74.39batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 74.27batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 74.28batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 74.27batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 74.30batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.26batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 74.36batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.43batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.43batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.49batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.53batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.50batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.53batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 74.65batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.60batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.57batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.64batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.61batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.51batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.57batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 74.50batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 74.55batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.55batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.57batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 74.49batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 74.46batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 74.54batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 74.54batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 74.56batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.66batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.62batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.66batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.73batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.33batch/s]
Validation 58 -> LOSS = 1.23
Validation 58 -> BLEU = 52.58, 75.1/58.5/46.9/37.5 (BP=0.997, ratio=0.997, hyp_len=14346, ref_len=14382)
Early stopping patience: 0
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Starting Epoch 59
Early stopped.
--> This is model: simultaneouswaitknmt-r31e88
--> Best LOSS so far: 1.21 @ validation 33
--> Best BLEU so far: 52.71 @ validation 48
Training finished on 03-06-2020 01:58
Wed Jun  3 01:58:04 2020       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 435.21       Driver Version: 435.21       CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  TITAN Xp            On   | 00000000:1B:00.0 Off |                  N/A |
| 30%   48C    P0    63W / 250W |      0MiB / 12196MiB |     24%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
-------
[train]
-------
         num_workers:0
          pin_memory:False
                seed:1582660384
               gclip:1
              l2_reg:1e-05
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
          model_type:SimultaneousWaitKNMT
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:64
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:
             de-hyphen
     eval_batch_size:32
           eval_freq:0
        eval_max_len:100
          eval_start:1
           eval_zero:False
   save_best_metrics:True
           save_path:/homes/al4616/experiments/simnmt/nmtpy/word2word/en-fr
    save_optim_state:False
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/homes/al4616/experiments/simnmt/nmtpy/word2word/en-fr/tb_dir
     pretrained_file:
   pretrained_layers:
       freeze_layers:
          handle_oom:False
           subfolder:wait5-rnn-unimodal
              exp_id:simultaneouswaitknmt-r2844c
------
[vars]
------
                  sl:en
                  tl:fr
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             enc_dim:320
   enc_bidirectional:False
             dec_dim:320
             emb_dim:200
         dropout_emb:0.4
         dropout_ctx:0.5
         dropout_out:0.5
          n_encoders:2
            tied_emb:2way
             max_len:None
           out_logic:deep
           direction:src:Text -> trg:Text
        sampler_type:bucket
           bucket_by:src
     translator_args:
                     k:5
------
[data]
------
            txt_root:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr
           train_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.fr
             val_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.fr
test_2016_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.fr
test_2017_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.fr
------------
[vocabulary]
------------
                 src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.en
                 trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.fr
----------------------------------------------------------------------

Python 3.7.7 -- torch 1.4.0 with CUDA 10.1 (on machine 'kingfisher.doc.ic.ac.uk')
nmtpytorch 4.1.0
DeviceManager(cuda:0, n_gpu=1)
Seed for further reproducibility: 1582660384
SLURM Job ID: 7213
Loading dataset(s)
Initializing dataset for 'src'...
0sents [00:00, ?sents/s]17458sents [00:00, 174517.75sents/s]29000sents [00:00, 172177.29sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]14843sents [00:00, 148401.84sents/s]29000sents [00:00, 145346.15sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'train.lc.norm.tok.en' (29000 sentences)
  Targets:
    --> TextDataset 'train.lc.norm.tok.fr' (29000 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 160424.89sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]1014sents [00:00, 144366.06sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)
  Targets:
    --> TextDataset 'val.lc.norm.tok.fr' (1014 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 161736.55sents/s]
Skipping 'trg' as target
MultimodalDataset - (1 source(s) / 0 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)

Ignoring batch_size 32 for simultaneous greedy search
SimultaneousWaitKNMT(
  (encoders): ModuleDict(
    (src): TextEncoder(
      (do_emb): Dropout(p=0.4, inplace=False)
      (emb): Embedding(9797, 200, padding_idx=0)
      (enc): GRU(200, 320, num_layers=2)
      (output): Sequential(
        (0): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (dec): SimultaneousConditionalDecoder(
    (emb): Embedding(11048, 200, padding_idx=0)
    (att): ModuleDict(
      (src): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
    )
    (dec0): GRUCell(200, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.5, inplace=False)
    (hid2out): FF(in_features=840, out_features=200, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=200, out_features=11048, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss()
  )
)
Vocabulary of 9797 items ('train.lc.norm.tok.vocab.en')
Vocabulary of 11048 items ('train.lc.norm.tok.vocab.fr')
# parameters: 6.89M (6.89M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 1e-05, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Training started on 03-06-2020 01:58:09
Starting Epoch 1
Epoch 1 - update         30 => loss:   6.705 (#OOM: 0)
Epoch 1 - update         60 => loss:   5.699 (#OOM: 0)
Epoch 1 - update         90 => loss:   5.161 (#OOM: 0)
Epoch 1 - update        120 => loss:   4.951 (#OOM: 0)
Epoch 1 - update        150 => loss:   4.347 (#OOM: 0)
Epoch 1 - update        180 => loss:   4.673 (#OOM: 0)
Epoch 1 - update        210 => loss:   4.495 (#OOM: 0)
Epoch 1 - update        240 => loss:   4.386 (#OOM: 0)
Epoch 1 - update        270 => loss:   4.062 (#OOM: 0)
Epoch 1 - update        300 => loss:   4.168 (#OOM: 0)
Epoch 1 - update        330 => loss:   3.900 (#OOM: 0)
Epoch 1 - update        360 => loss:   3.506 (#OOM: 0)
Epoch 1 - update        390 => loss:   3.981 (#OOM: 0)
Epoch 1 - update        420 => loss:   3.822 (#OOM: 0)
Epoch 1 - update        450 => loss:   3.970 (#OOM: 0)
--> Epoch 1 finished with mean loss 4.61274
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (822 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.38batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.41batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.08batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 50.80batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.66batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.44batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 83.08batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 74.90batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 75.07batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 72.92batch/s]  4%|█▏                          | 45/1014 [00:00<00:14, 66.70batch/s]  5%|█▍                          | 54/1014 [00:00<00:14, 67.57batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 69.06batch/s]  7%|██                          | 73/1014 [00:01<00:13, 70.39batch/s]  8%|██▎                         | 83/1014 [00:01<00:13, 71.30batch/s]  9%|██▌                         | 93/1014 [00:01<00:12, 71.12batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 71.16batch/s] 11%|███                        | 113/1014 [00:01<00:12, 71.42batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 71.52batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 72.15batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 73.47batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.13batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 73.90batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 74.04batch/s] 18%|████▊                      | 183/1014 [00:02<00:11, 73.77batch/s] 19%|█████▏                     | 193/1014 [00:02<00:11, 74.06batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.43batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.71batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 74.65batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.03batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.77batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 73.49batch/s] 26%|███████                    | 263/1014 [00:03<00:10, 73.75batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 74.27batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 74.69batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.04batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 75.03batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 75.42batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.00batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 75.02batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 75.07batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 75.24batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 75.41batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 75.47batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.47batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.68batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.07batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.26batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.04batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 74.26batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 74.48batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.87batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 75.03batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.77batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.62batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:07, 73.97batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 74.01batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.17batch/s] 52%|█████████████▉             | 523/1014 [00:07<00:06, 73.80batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 73.82batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 73.24batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 73.41batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 73.60batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 73.85batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 73.98batch/s] 58%|███████████████▊           | 593/1014 [00:08<00:05, 74.07batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.31batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 74.44batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 74.39batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 74.42batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 74.58batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 74.70batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.75batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 74.78batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 74.79batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.12batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.11batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.24batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.35batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.49batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 75.47batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.40batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 75.26batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.31batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.32batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.34batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.45batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.60batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.76batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.79batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 75.32batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.29batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 75.37batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 75.38batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.41batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.53batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.60batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.74batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.80batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.72batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 75.67batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 75.70batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.77batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.76batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.70batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.69batch/s]
Validation 1 -> LOSS = 3.22
Validation 1 -> BLEU = 13.13, 47.1/19.9/9.0/4.2 (BP=0.957, ratio=0.958, hyp_len=13783, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 3.22 @ validation 1
--> Best BLEU so far: 13.13 @ validation 1
Starting Epoch 2
Epoch 2 - update        480 => loss:   4.042 (#OOM: 0)
Epoch 2 - update        510 => loss:   3.511 (#OOM: 0)
Epoch 2 - update        540 => loss:   3.159 (#OOM: 0)
Epoch 2 - update        570 => loss:   3.144 (#OOM: 0)
Epoch 2 - update        600 => loss:   3.778 (#OOM: 0)
Epoch 2 - update        630 => loss:   3.145 (#OOM: 0)
Epoch 2 - update        660 => loss:   3.221 (#OOM: 0)
Epoch 2 - update        690 => loss:   3.048 (#OOM: 0)
Epoch 2 - update        720 => loss:   3.335 (#OOM: 0)
Epoch 2 - update        750 => loss:   3.227 (#OOM: 0)
Epoch 2 - update        780 => loss:   3.148 (#OOM: 0)
Epoch 2 - update        810 => loss:   3.127 (#OOM: 0)
Epoch 2 - update        840 => loss:   2.939 (#OOM: 0)
Epoch 2 - update        870 => loss:   2.873 (#OOM: 0)
Epoch 2 - update        900 => loss:   2.758 (#OOM: 0)
Epoch 2 - update        930 => loss:   2.798 (#OOM: 0)
--> Epoch 2 finished with mean loss 3.17172
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.56 mins)   (908 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.39batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.66batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.17batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.88batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 48.58batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 48.37batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.97batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 69.56batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.98batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 69.34batch/s]  4%|█                           | 40/1014 [00:00<00:14, 67.69batch/s]  5%|█▎                          | 48/1014 [00:00<00:14, 67.97batch/s]  6%|█▌                          | 56/1014 [00:00<00:14, 65.83batch/s]  6%|█▊                          | 64/1014 [00:00<00:14, 65.23batch/s]  7%|█▉                          | 72/1014 [00:01<00:14, 65.47batch/s]  8%|██▏                         | 81/1014 [00:01<00:13, 66.94batch/s]  9%|██▍                         | 90/1014 [00:01<00:14, 63.99batch/s] 10%|██▋                         | 99/1014 [00:01<00:13, 65.60batch/s] 11%|██▉                        | 108/1014 [00:01<00:13, 65.86batch/s] 12%|███                        | 117/1014 [00:01<00:13, 65.99batch/s] 12%|███▎                       | 126/1014 [00:01<00:13, 67.02batch/s] 13%|███▌                       | 135/1014 [00:02<00:13, 67.27batch/s] 14%|███▊                       | 144/1014 [00:02<00:12, 67.43batch/s] 15%|████                       | 153/1014 [00:02<00:12, 68.28batch/s] 16%|████▎                      | 162/1014 [00:02<00:12, 68.65batch/s] 17%|████▌                      | 171/1014 [00:02<00:12, 69.09batch/s] 18%|████▊                      | 180/1014 [00:02<00:12, 69.14batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 69.25batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 69.62batch/s] 20%|█████▌                     | 207/1014 [00:02<00:11, 69.91batch/s] 21%|█████▊                     | 216/1014 [00:03<00:11, 70.03batch/s] 22%|█████▉                     | 225/1014 [00:03<00:11, 69.83batch/s] 23%|██████▏                    | 234/1014 [00:03<00:11, 69.91batch/s] 24%|██████▍                    | 243/1014 [00:03<00:11, 69.13batch/s] 25%|██████▋                    | 252/1014 [00:03<00:11, 69.25batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 69.35batch/s] 27%|███████▏                   | 270/1014 [00:03<00:10, 68.93batch/s] 28%|███████▍                   | 279/1014 [00:04<00:10, 68.89batch/s] 28%|███████▋                   | 288/1014 [00:04<00:10, 69.11batch/s] 29%|███████▉                   | 297/1014 [00:04<00:10, 69.08batch/s] 30%|████████▏                  | 306/1014 [00:04<00:10, 69.24batch/s] 31%|████████▍                  | 315/1014 [00:04<00:10, 69.18batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 69.38batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 69.56batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 69.62batch/s] 35%|█████████▎                 | 351/1014 [00:05<00:09, 69.60batch/s] 36%|█████████▌                 | 360/1014 [00:05<00:09, 69.65batch/s] 36%|█████████▊                 | 369/1014 [00:05<00:09, 69.10batch/s] 37%|██████████                 | 378/1014 [00:05<00:09, 69.26batch/s] 38%|██████████▎                | 387/1014 [00:05<00:09, 69.50batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 69.66batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 69.02batch/s] 41%|███████████                | 414/1014 [00:06<00:08, 68.42batch/s] 42%|███████████▎               | 423/1014 [00:06<00:08, 68.09batch/s] 43%|███████████▌               | 432/1014 [00:06<00:08, 68.42batch/s] 43%|███████████▋               | 441/1014 [00:06<00:08, 68.31batch/s] 44%|███████████▉               | 450/1014 [00:06<00:08, 68.25batch/s] 45%|████████████▏              | 459/1014 [00:06<00:08, 68.14batch/s] 46%|████████████▍              | 468/1014 [00:06<00:08, 67.65batch/s] 47%|████████████▋              | 477/1014 [00:07<00:07, 67.60batch/s] 48%|████████████▉              | 486/1014 [00:07<00:07, 67.78batch/s] 49%|█████████████▏             | 495/1014 [00:07<00:07, 67.85batch/s] 50%|█████████████▍             | 504/1014 [00:07<00:07, 67.78batch/s] 51%|█████████████▋             | 513/1014 [00:07<00:07, 66.47batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:07, 66.64batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:07, 66.80batch/s] 53%|██████████████▍            | 540/1014 [00:08<00:07, 66.95batch/s] 54%|██████████████▌            | 549/1014 [00:08<00:06, 67.23batch/s] 55%|██████████████▊            | 558/1014 [00:08<00:06, 67.33batch/s] 56%|███████████████            | 567/1014 [00:08<00:06, 67.47batch/s] 57%|███████████████▎           | 576/1014 [00:08<00:06, 67.44batch/s] 58%|███████████████▌           | 585/1014 [00:08<00:06, 67.41batch/s] 59%|███████████████▊           | 594/1014 [00:08<00:06, 67.49batch/s] 59%|████████████████           | 603/1014 [00:08<00:06, 67.40batch/s] 60%|████████████████▎          | 612/1014 [00:09<00:05, 67.55batch/s] 61%|████████████████▌          | 621/1014 [00:09<00:05, 66.72batch/s] 62%|████████████████▊          | 630/1014 [00:09<00:05, 66.83batch/s] 63%|█████████████████          | 639/1014 [00:09<00:05, 66.94batch/s] 64%|█████████████████▎         | 648/1014 [00:09<00:05, 66.73batch/s] 65%|█████████████████▍         | 657/1014 [00:09<00:05, 66.81batch/s] 66%|█████████████████▋         | 666/1014 [00:10<00:05, 66.42batch/s] 67%|█████████████████▉         | 675/1014 [00:10<00:05, 66.52batch/s] 67%|██████████████████▏        | 684/1014 [00:10<00:04, 66.65batch/s] 68%|██████████████████▍        | 693/1014 [00:10<00:04, 66.69batch/s] 69%|██████████████████▋        | 702/1014 [00:10<00:04, 66.76batch/s] 70%|██████████████████▉        | 711/1014 [00:10<00:04, 66.73batch/s] 71%|███████████████████▏       | 720/1014 [00:10<00:04, 66.82batch/s] 72%|███████████████████▍       | 729/1014 [00:10<00:04, 66.86batch/s] 73%|███████████████████▋       | 738/1014 [00:11<00:04, 66.98batch/s] 74%|███████████████████▉       | 747/1014 [00:11<00:03, 67.09batch/s] 75%|████████████████████▏      | 756/1014 [00:11<00:03, 67.06batch/s] 75%|████████████████████▎      | 765/1014 [00:11<00:03, 67.05batch/s] 76%|████████████████████▌      | 774/1014 [00:11<00:03, 66.91batch/s] 77%|████████████████████▊      | 783/1014 [00:11<00:03, 67.08batch/s] 78%|█████████████████████      | 792/1014 [00:11<00:03, 67.12batch/s] 79%|█████████████████████▎     | 801/1014 [00:11<00:03, 67.21batch/s] 80%|█████████████████████▌     | 810/1014 [00:12<00:03, 67.24batch/s] 81%|█████████████████████▊     | 819/1014 [00:12<00:02, 67.36batch/s] 82%|██████████████████████     | 828/1014 [00:12<00:02, 67.41batch/s] 83%|██████████████████████▎    | 837/1014 [00:12<00:02, 67.44batch/s] 83%|██████████████████████▌    | 846/1014 [00:12<00:02, 67.22batch/s] 84%|██████████████████████▊    | 855/1014 [00:12<00:02, 67.16batch/s] 85%|███████████████████████    | 864/1014 [00:12<00:02, 67.22batch/s] 86%|███████████████████████▏   | 873/1014 [00:12<00:02, 67.35batch/s] 87%|███████████████████████▍   | 882/1014 [00:13<00:01, 67.31batch/s] 88%|███████████████████████▋   | 891/1014 [00:13<00:01, 67.02batch/s] 89%|███████████████████████▉   | 900/1014 [00:13<00:01, 66.77batch/s] 90%|████████████████████████▏  | 909/1014 [00:13<00:01, 66.47batch/s] 91%|████████████████████████▍  | 918/1014 [00:13<00:01, 66.55batch/s] 91%|████████████████████████▋  | 927/1014 [00:13<00:01, 66.55batch/s] 92%|████████████████████████▉  | 936/1014 [00:14<00:01, 66.48batch/s] 93%|█████████████████████████▏ | 945/1014 [00:14<00:01, 66.43batch/s] 94%|█████████████████████████▍ | 954/1014 [00:14<00:00, 66.46batch/s] 95%|█████████████████████████▋ | 963/1014 [00:14<00:00, 66.43batch/s] 96%|█████████████████████████▉ | 972/1014 [00:14<00:00, 66.50batch/s] 97%|██████████████████████████ | 981/1014 [00:14<00:00, 66.58batch/s] 98%|██████████████████████████▎| 990/1014 [00:14<00:00, 66.58batch/s] 99%|██████████████████████████▌| 999/1014 [00:14<00:00, 66.70batch/s] 99%|█████████████████████████▊| 1008/1014 [00:15<00:00, 66.77batch/s]100%|██████████████████████████| 1014/1014 [00:15<00:00, 66.83batch/s]
Validation 2 -> LOSS = 2.53
Validation 2 -> BLEU = 19.54, 47.5/25.2/14.5/8.4 (BP=1.000, ratio=1.144, hyp_len=16460, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 2.53 @ validation 2
--> Best BLEU so far: 19.54 @ validation 2
Starting Epoch 3
Epoch 3 - update        960 => loss:   2.595 (#OOM: 0)
Epoch 3 - update        990 => loss:   2.632 (#OOM: 0)
Epoch 3 - update       1020 => loss:   2.539 (#OOM: 0)
Epoch 3 - update       1050 => loss:   2.988 (#OOM: 0)
Epoch 3 - update       1080 => loss:   2.445 (#OOM: 0)
Epoch 3 - update       1110 => loss:   2.510 (#OOM: 0)
Epoch 3 - update       1140 => loss:   2.611 (#OOM: 0)
Epoch 3 - update       1170 => loss:   2.486 (#OOM: 0)
Epoch 3 - update       1200 => loss:   2.279 (#OOM: 0)
Epoch 3 - update       1230 => loss:   2.842 (#OOM: 0)
Epoch 3 - update       1260 => loss:   2.267 (#OOM: 0)
Epoch 3 - update       1290 => loss:   2.819 (#OOM: 0)
Epoch 3 - update       1320 => loss:   2.473 (#OOM: 0)
Epoch 3 - update       1350 => loss:   2.417 (#OOM: 0)
Epoch 3 - update       1380 => loss:   2.002 (#OOM: 0)
Epoch 3 - update       1410 => loss:   2.316 (#OOM: 0)
--> Epoch 3 finished with mean loss 2.64259
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (754 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 40.62batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.66batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 49.15batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.68batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 50.27batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.58batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.34batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 67.31batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 70.94batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 75.56batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 76.90batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 77.37batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 79.14batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 78.69batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 77.60batch/s]  8%|██▎                         | 82/1014 [00:01<00:12, 76.89batch/s]  9%|██▌                         | 92/1014 [00:01<00:11, 78.22batch/s] 10%|██▋                        | 102/1014 [00:01<00:11, 79.17batch/s] 11%|██▉                        | 112/1014 [00:01<00:11, 79.30batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 78.98batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 77.33batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 77.29batch/s] 15%|████                       | 152/1014 [00:01<00:11, 77.37batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 77.44batch/s] 17%|████▌                      | 172/1014 [00:02<00:10, 77.97batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 75.98batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 75.91batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 75.92batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 75.65batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.25batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.04batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 74.59batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.63batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 74.13batch/s] 27%|███████▏                   | 272/1014 [00:03<00:10, 74.14batch/s] 28%|███████▌                   | 282/1014 [00:03<00:10, 72.57batch/s] 29%|███████▊                   | 292/1014 [00:04<00:09, 72.54batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 72.42batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 72.38batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 72.48batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 72.37batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 72.18batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:09, 72.25batch/s] 36%|█████████▋                 | 362/1014 [00:05<00:09, 72.24batch/s] 37%|█████████▉                 | 372/1014 [00:05<00:08, 72.06batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 71.91batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 72.04batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 72.34batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 72.26batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 72.30batch/s] 43%|███████████▌               | 432/1014 [00:05<00:08, 72.21batch/s] 44%|███████████▊               | 442/1014 [00:06<00:07, 72.48batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 72.61batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 72.58batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 72.48batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 72.64batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 72.34batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:07, 72.39batch/s] 50%|█████████████▋             | 512/1014 [00:07<00:06, 72.39batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 72.10batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 72.24batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 72.47batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 72.65batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 72.75batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:06, 72.67batch/s] 57%|███████████████▍           | 582/1014 [00:08<00:05, 72.68batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 72.90batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 72.94batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 72.90batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 72.85batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 72.89batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 72.66batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 72.60batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 72.59batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 72.59batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 72.47batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 72.49batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 72.49batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 72.51batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:04, 72.51batch/s] 72%|███████████████████▍       | 732/1014 [00:10<00:03, 72.47batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 72.50batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 72.62batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 72.50batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 72.31batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 71.92batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:03, 72.08batch/s] 79%|█████████████████████▎     | 802/1014 [00:11<00:02, 72.10batch/s] 80%|█████████████████████▌     | 812/1014 [00:11<00:02, 72.28batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 72.33batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 72.35batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 72.21batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 72.17batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 72.07batch/s] 86%|███████████████████████▏   | 872/1014 [00:12<00:01, 72.07batch/s] 87%|███████████████████████▍   | 882/1014 [00:12<00:01, 72.08batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 71.80batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 71.76batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 71.87batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 71.84batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 71.92batch/s] 93%|█████████████████████████  | 942/1014 [00:13<00:01, 71.81batch/s] 94%|█████████████████████████▎ | 952/1014 [00:13<00:00, 71.89batch/s] 95%|█████████████████████████▌ | 962/1014 [00:13<00:00, 71.59batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 71.65batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 71.67batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 71.72batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 71.69batch/s]100%|█████████████████████████▉| 1012/1014 [00:14<00:00, 71.72batch/s]100%|██████████████████████████| 1014/1014 [00:14<00:00, 71.73batch/s]
Validation 3 -> LOSS = 2.16
Validation 3 -> BLEU = 27.72, 56.7/34.0/21.8/14.1 (BP=1.000, ratio=1.054, hyp_len=15157, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 2.16 @ validation 3
--> Best BLEU so far: 27.72 @ validation 3
Starting Epoch 4
Epoch 4 - update       1440 => loss:   2.027 (#OOM: 0)
Epoch 4 - update       1470 => loss:   2.136 (#OOM: 0)
Epoch 4 - update       1500 => loss:   2.508 (#OOM: 0)
Epoch 4 - update       1530 => loss:   2.276 (#OOM: 0)
Epoch 4 - update       1560 => loss:   2.451 (#OOM: 0)
Epoch 4 - update       1590 => loss:   2.254 (#OOM: 0)
Epoch 4 - update       1620 => loss:   2.284 (#OOM: 0)
Epoch 4 - update       1650 => loss:   2.169 (#OOM: 0)
Epoch 4 - update       1680 => loss:   2.047 (#OOM: 0)
Epoch 4 - update       1710 => loss:   2.322 (#OOM: 0)
Epoch 4 - update       1740 => loss:   2.041 (#OOM: 0)
Epoch 4 - update       1770 => loss:   2.439 (#OOM: 0)
Epoch 4 - update       1800 => loss:   2.034 (#OOM: 0)
Epoch 4 - update       1830 => loss:   2.624 (#OOM: 0)
Epoch 4 - update       1860 => loss:   2.142 (#OOM: 0)
Epoch 4 - update       1890 => loss:   2.219 (#OOM: 0)
--> Epoch 4 finished with mean loss 2.31304
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (776 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.42batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.28batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.82batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.65batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.16batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.81batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 71.95batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.28batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 75.11batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.72batch/s]  4%|█                           | 40/1014 [00:00<00:13, 74.14batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 74.23batch/s]  6%|█▌                          | 56/1014 [00:00<00:12, 74.01batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 73.70batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 74.11batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 75.10batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 75.69batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.62batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 75.76batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.17batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.73batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.37batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.63batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.75batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.27batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.72batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.92batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.11batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.90batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 73.40batch/s] 21%|█████▊                     | 216/1014 [00:03<00:11, 71.44batch/s] 22%|█████▉                     | 225/1014 [00:03<00:11, 71.20batch/s] 23%|██████▏                    | 234/1014 [00:03<00:11, 70.40batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 70.52batch/s] 25%|██████▋                    | 252/1014 [00:03<00:11, 69.22batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 69.14batch/s] 27%|███████▏                   | 270/1014 [00:03<00:10, 69.09batch/s] 28%|███████▍                   | 279/1014 [00:04<00:10, 69.12batch/s] 28%|███████▋                   | 288/1014 [00:04<00:10, 69.43batch/s] 29%|███████▉                   | 297/1014 [00:04<00:10, 69.91batch/s] 30%|████████▏                  | 306/1014 [00:04<00:10, 70.01batch/s] 31%|████████▍                  | 315/1014 [00:04<00:10, 69.76batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 69.67batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 69.68batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 69.83batch/s] 35%|█████████▎                 | 351/1014 [00:05<00:09, 69.87batch/s] 36%|█████████▌                 | 360/1014 [00:05<00:09, 70.13batch/s] 36%|█████████▊                 | 369/1014 [00:05<00:09, 70.18batch/s] 37%|██████████                 | 378/1014 [00:05<00:09, 70.09batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 69.80batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 70.07batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 69.69batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 69.65batch/s] 42%|███████████▎               | 423/1014 [00:06<00:08, 69.63batch/s] 43%|███████████▌               | 432/1014 [00:06<00:08, 68.94batch/s] 43%|███████████▋               | 441/1014 [00:06<00:08, 69.07batch/s] 44%|███████████▉               | 450/1014 [00:06<00:08, 69.16batch/s] 45%|████████████▏              | 459/1014 [00:06<00:08, 68.83batch/s] 46%|████████████▍              | 468/1014 [00:06<00:08, 68.09batch/s] 47%|████████████▋              | 477/1014 [00:07<00:07, 67.50batch/s] 48%|████████████▉              | 486/1014 [00:07<00:07, 67.19batch/s] 49%|█████████████▏             | 495/1014 [00:07<00:07, 67.17batch/s] 50%|█████████████▍             | 504/1014 [00:07<00:07, 67.18batch/s] 51%|█████████████▋             | 513/1014 [00:07<00:07, 67.00batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:07, 67.03batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:07, 66.94batch/s] 53%|██████████████▍            | 540/1014 [00:08<00:07, 66.69batch/s] 54%|██████████████▌            | 549/1014 [00:08<00:06, 66.65batch/s] 55%|██████████████▊            | 558/1014 [00:08<00:06, 66.66batch/s] 56%|███████████████            | 567/1014 [00:08<00:06, 66.07batch/s] 57%|███████████████▎           | 576/1014 [00:08<00:06, 66.06batch/s] 58%|███████████████▌           | 585/1014 [00:08<00:06, 65.62batch/s] 59%|███████████████▊           | 594/1014 [00:09<00:06, 65.75batch/s] 59%|████████████████           | 603/1014 [00:09<00:06, 65.70batch/s] 60%|████████████████▎          | 612/1014 [00:09<00:06, 65.73batch/s] 61%|████████████████▌          | 621/1014 [00:09<00:05, 65.84batch/s] 62%|████████████████▊          | 630/1014 [00:09<00:05, 65.83batch/s] 63%|█████████████████          | 639/1014 [00:09<00:05, 65.44batch/s] 64%|█████████████████▎         | 648/1014 [00:09<00:05, 65.48batch/s] 65%|█████████████████▍         | 657/1014 [00:10<00:05, 65.67batch/s] 66%|█████████████████▋         | 666/1014 [00:10<00:05, 65.77batch/s] 67%|█████████████████▉         | 675/1014 [00:10<00:05, 65.97batch/s] 67%|██████████████████▏        | 684/1014 [00:10<00:04, 66.08batch/s] 68%|██████████████████▍        | 693/1014 [00:10<00:04, 66.07batch/s] 69%|██████████████████▋        | 702/1014 [00:10<00:04, 66.13batch/s] 70%|██████████████████▉        | 711/1014 [00:10<00:04, 65.77batch/s] 71%|███████████████████▏       | 720/1014 [00:10<00:04, 65.77batch/s] 72%|███████████████████▍       | 729/1014 [00:11<00:04, 65.96batch/s] 73%|███████████████████▋       | 738/1014 [00:11<00:04, 65.85batch/s] 74%|███████████████████▉       | 747/1014 [00:11<00:04, 65.87batch/s] 75%|████████████████████▏      | 756/1014 [00:11<00:03, 66.02batch/s] 75%|████████████████████▎      | 765/1014 [00:11<00:03, 66.13batch/s] 76%|████████████████████▌      | 774/1014 [00:11<00:03, 65.86batch/s] 77%|████████████████████▊      | 783/1014 [00:11<00:03, 65.93batch/s] 78%|█████████████████████      | 792/1014 [00:11<00:03, 66.02batch/s] 79%|█████████████████████▎     | 801/1014 [00:12<00:03, 66.14batch/s] 80%|█████████████████████▌     | 810/1014 [00:12<00:03, 66.15batch/s] 81%|█████████████████████▊     | 819/1014 [00:12<00:02, 66.17batch/s] 82%|██████████████████████     | 828/1014 [00:12<00:02, 66.12batch/s] 83%|██████████████████████▎    | 837/1014 [00:12<00:02, 66.24batch/s] 83%|██████████████████████▌    | 846/1014 [00:12<00:02, 66.28batch/s] 84%|██████████████████████▊    | 855/1014 [00:12<00:02, 66.01batch/s] 85%|███████████████████████    | 864/1014 [00:13<00:02, 66.16batch/s] 86%|███████████████████████▏   | 873/1014 [00:13<00:02, 66.09batch/s] 87%|███████████████████████▍   | 882/1014 [00:13<00:01, 66.17batch/s] 88%|███████████████████████▋   | 891/1014 [00:13<00:01, 66.17batch/s] 89%|███████████████████████▉   | 900/1014 [00:13<00:01, 66.21batch/s] 90%|████████████████████████▏  | 909/1014 [00:13<00:01, 66.29batch/s] 91%|████████████████████████▍  | 918/1014 [00:13<00:01, 66.39batch/s] 91%|████████████████████████▋  | 927/1014 [00:13<00:01, 66.43batch/s] 92%|████████████████████████▉  | 936/1014 [00:14<00:01, 66.54batch/s] 93%|█████████████████████████▏ | 945/1014 [00:14<00:01, 66.64batch/s] 94%|█████████████████████████▍ | 954/1014 [00:14<00:00, 66.68batch/s] 95%|█████████████████████████▋ | 963/1014 [00:14<00:00, 66.72batch/s] 96%|█████████████████████████▉ | 972/1014 [00:14<00:00, 66.74batch/s] 97%|██████████████████████████ | 981/1014 [00:14<00:00, 66.75batch/s] 98%|██████████████████████████▎| 990/1014 [00:14<00:00, 66.82batch/s] 99%|██████████████████████████▌| 999/1014 [00:14<00:00, 66.95batch/s] 99%|█████████████████████████▊| 1008/1014 [00:15<00:00, 67.07batch/s]100%|██████████████████████████| 1014/1014 [00:15<00:00, 67.10batch/s]
Validation 4 -> LOSS = 1.93
Validation 4 -> BLEU = 30.49, 57.0/36.5/24.7/16.8 (BP=1.000, ratio=1.118, hyp_len=16083, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.93 @ validation 4
--> Best BLEU so far: 30.49 @ validation 4
Starting Epoch 5
Epoch 5 - update       1920 => loss:   2.546 (#OOM: 0)
Epoch 5 - update       1950 => loss:   2.008 (#OOM: 0)
Epoch 5 - update       1980 => loss:   1.857 (#OOM: 0)
Epoch 5 - update       2010 => loss:   2.071 (#OOM: 0)
Epoch 5 - update       2040 => loss:   1.905 (#OOM: 0)
Epoch 5 - update       2070 => loss:   2.060 (#OOM: 0)
Epoch 5 - update       2100 => loss:   1.800 (#OOM: 0)
Epoch 5 - update       2130 => loss:   2.122 (#OOM: 0)
Epoch 5 - update       2160 => loss:   2.136 (#OOM: 0)
Epoch 5 - update       2190 => loss:   1.844 (#OOM: 0)
Epoch 5 - update       2220 => loss:   1.814 (#OOM: 0)
Epoch 5 - update       2250 => loss:   1.703 (#OOM: 0)
Epoch 5 - update       2280 => loss:   2.384 (#OOM: 0)
Epoch 5 - update       2310 => loss:   1.996 (#OOM: 0)
Epoch 5 - update       2340 => loss:   1.695 (#OOM: 0)
Epoch 5 - update       2370 => loss:   2.389 (#OOM: 0)
--> Epoch 5 finished with mean loss 2.07520
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (761 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.36batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.49batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 45.76batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 48.87batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 51.64batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.76batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.73batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.68batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 81.44batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 82.43batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 81.52batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 79.40batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.25batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 71.25batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 71.88batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 71.85batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 71.50batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 71.93batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 72.06batch/s] 12%|███                        | 117/1014 [00:01<00:12, 72.50batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.12batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 72.74batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 72.90batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.61batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.74batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.11batch/s] 18%|████▊                      | 181/1014 [00:02<00:11, 74.95batch/s] 19%|█████                      | 191/1014 [00:02<00:10, 75.24batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 75.34batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 75.56batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 75.91batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 76.17batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 76.71batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 76.48batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 76.70batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 76.97batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 76.92batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 76.88batch/s] 30%|████████                   | 301/1014 [00:03<00:09, 77.04batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 76.92batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 76.65batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 76.49batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 76.75batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 77.01batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 77.31batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 77.14batch/s] 38%|██████████▏                | 381/1014 [00:04<00:08, 77.28batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 77.14batch/s] 40%|██████████▋                | 401/1014 [00:05<00:07, 77.08batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 77.04batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 76.87batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 76.87batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 76.93batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 76.87batch/s] 45%|████████████▎              | 461/1014 [00:05<00:07, 76.85batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 76.75batch/s] 47%|████████████▊              | 481/1014 [00:06<00:06, 76.64batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 76.78batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 76.80batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 76.73batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 76.71batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 76.66batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 76.52batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 76.66batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 76.38batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 76.52batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 76.57batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 76.55batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 76.63batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:05, 76.63batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 76.53batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 76.43batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 76.55batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 76.58batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 76.37batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 76.33batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 76.44batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 76.59batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 76.45batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:03, 76.40batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 76.64batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 76.55batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 76.58batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 76.58batch/s] 75%|████████████████████▎      | 761/1014 [00:09<00:03, 76.43batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 75.80batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 75.79batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 75.89batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 75.93batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 75.92batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 75.98batch/s] 82%|██████████████████████▏    | 831/1014 [00:10<00:02, 76.00batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 76.03batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 75.99batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 75.97batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 75.98batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 75.93batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 75.95batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 75.98batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 75.74batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 75.68batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 75.72batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 75.73batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 75.80batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 75.66batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 75.62batch/s] 97%|██████████████████████████ | 981/1014 [00:12<00:00, 75.48batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.53batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 75.52batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 75.55batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.59batch/s]
Validation 5 -> LOSS = 1.77
Validation 5 -> BLEU = 37.80, 65.8/44.6/31.7/22.6 (BP=0.993, ratio=0.993, hyp_len=14280, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.77 @ validation 5
--> Best BLEU so far: 37.80 @ validation 5
Starting Epoch 6
Epoch 6 - update       2400 => loss:   2.242 (#OOM: 0)
Epoch 6 - update       2430 => loss:   2.128 (#OOM: 0)
Epoch 6 - update       2460 => loss:   1.991 (#OOM: 0)
Epoch 6 - update       2490 => loss:   1.816 (#OOM: 0)
Epoch 6 - update       2520 => loss:   2.011 (#OOM: 0)
Epoch 6 - update       2550 => loss:   1.910 (#OOM: 0)
Epoch 6 - update       2580 => loss:   1.833 (#OOM: 0)
Epoch 6 - update       2610 => loss:   1.959 (#OOM: 0)
Epoch 6 - update       2640 => loss:   1.926 (#OOM: 0)
Epoch 6 - update       2670 => loss:   1.506 (#OOM: 0)
Epoch 6 - update       2700 => loss:   2.927 (#OOM: 0)
Epoch 6 - update       2730 => loss:   1.855 (#OOM: 0)
Epoch 6 - update       2760 => loss:   2.399 (#OOM: 0)
Epoch 6 - update       2790 => loss:   2.070 (#OOM: 0)
Epoch 6 - update       2820 => loss:   2.064 (#OOM: 0)
Epoch 6 - update       2850 => loss:   1.715 (#OOM: 0)
--> Epoch 6 finished with mean loss 1.89483
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (812 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.04batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.39batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 47.79batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.78batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 50.61batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.45batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.95batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.86batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.32batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 74.45batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.70batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 74.73batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 75.76batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 74.97batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 75.35batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 75.37batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 76.42batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 76.22batch/s] 11%|███                        | 114/1014 [00:01<00:11, 75.71batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.27batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 75.19batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 75.76batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 76.11batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 75.29batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.68batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 75.76batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 76.05batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 75.37batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 74.83batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 75.24batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.88batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 75.06batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 75.51batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 75.73batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 75.56batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.86batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 76.24batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 76.18batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 76.47batch/s] 30%|████████                   | 303/1014 [00:03<00:09, 76.39batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 76.60batch/s] 32%|████████▌                  | 322/1014 [00:04<00:08, 77.01batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 77.04batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 77.26batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 76.96batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 76.71batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 77.01batch/s] 38%|██████████▏                | 382/1014 [00:04<00:08, 77.07batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 76.76batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 76.45batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 76.59batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 76.56batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 76.75batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 76.96batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 76.61batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 76.72batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 76.65batch/s] 48%|████████████▊              | 482/1014 [00:06<00:06, 76.92batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 76.92batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 76.86batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 76.89batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 76.65batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:06, 76.36batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 76.37batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 76.29batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 76.36batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 76.50batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 76.47batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 76.39batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 76.52batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:05, 76.51batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 76.56batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:04, 76.56batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 76.56batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 76.41batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 76.51batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 76.46batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 76.48batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 76.41batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 76.44batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 76.46batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 76.43batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 76.60batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 76.52batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 76.33batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 76.40batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 76.38batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 76.47batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 76.66batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 76.71batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 76.77batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 76.67batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 76.48batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 76.49batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 76.59batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:01, 76.51batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 76.57batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 76.48batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 76.36batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 76.41batch/s] 90%|████████████████████████▎  | 912/1014 [00:11<00:01, 76.46batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 76.46batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 76.37batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 76.33batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 76.12batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 76.12batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.99batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 75.92batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.84batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.90batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.89batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.91batch/s]
Validation 6 -> LOSS = 1.65
Validation 6 -> BLEU = 40.74, 68.2/47.7/35.0/25.7 (BP=0.986, ratio=0.986, hyp_len=14176, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.65 @ validation 6
--> Best BLEU so far: 40.74 @ validation 6
Starting Epoch 7
Epoch 7 - update       2880 => loss:   2.058 (#OOM: 0)
Epoch 7 - update       2910 => loss:   1.666 (#OOM: 0)
Epoch 7 - update       2940 => loss:   1.720 (#OOM: 0)
Epoch 7 - update       2970 => loss:   1.846 (#OOM: 0)
Epoch 7 - update       3000 => loss:   2.073 (#OOM: 0)
Epoch 7 - update       3030 => loss:   1.737 (#OOM: 0)
Epoch 7 - update       3060 => loss:   1.492 (#OOM: 0)
Epoch 7 - update       3090 => loss:   1.388 (#OOM: 0)
Epoch 7 - update       3120 => loss:   1.553 (#OOM: 0)
Epoch 7 - update       3150 => loss:   1.935 (#OOM: 0)
Epoch 7 - update       3180 => loss:   1.702 (#OOM: 0)
Epoch 7 - update       3210 => loss:   1.615 (#OOM: 0)
Epoch 7 - update       3240 => loss:   1.945 (#OOM: 0)
Epoch 7 - update       3270 => loss:   1.594 (#OOM: 0)
Epoch 7 - update       3300 => loss:   1.479 (#OOM: 0)
Epoch 7 - update       3330 => loss:   1.732 (#OOM: 0)
--> Epoch 7 finished with mean loss 1.75199
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (763 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.75batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.62batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.82batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 49.65batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.08batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 50.59batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.84batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 69.05batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 70.47batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 72.50batch/s]  3%|▉                           | 32/1014 [00:00<00:12, 75.91batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 74.67batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 74.85batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 74.63batch/s]  7%|█▉                          | 68/1014 [00:00<00:13, 68.50batch/s]  8%|██▏                         | 77/1014 [00:01<00:13, 67.51batch/s]  8%|██▎                         | 86/1014 [00:01<00:13, 68.68batch/s]  9%|██▌                         | 95/1014 [00:01<00:13, 69.55batch/s] 10%|██▊                        | 104/1014 [00:01<00:13, 69.46batch/s] 11%|███                        | 113/1014 [00:01<00:12, 69.82batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 70.32batch/s] 13%|███▌                       | 132/1014 [00:01<00:12, 71.35batch/s] 14%|███▊                       | 142/1014 [00:01<00:12, 72.20batch/s] 15%|████                       | 152/1014 [00:02<00:12, 71.71batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 72.00batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 71.95batch/s] 18%|████▊                      | 182/1014 [00:02<00:11, 70.50batch/s] 19%|█████                      | 192/1014 [00:02<00:11, 70.67batch/s] 20%|█████▍                     | 202/1014 [00:02<00:11, 71.13batch/s] 21%|█████▋                     | 212/1014 [00:02<00:11, 71.79batch/s] 22%|█████▉                     | 222/1014 [00:03<00:11, 71.45batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 71.67batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 71.92batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 71.61batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 72.13batch/s] 27%|███████▏                   | 272/1014 [00:03<00:10, 72.30batch/s] 28%|███████▌                   | 282/1014 [00:03<00:10, 72.32batch/s] 29%|███████▊                   | 292/1014 [00:04<00:09, 72.55batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 72.65batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 72.72batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 72.83batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 72.97batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 73.15batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:09, 73.27batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 73.33batch/s] 37%|█████████▉                 | 372/1014 [00:05<00:08, 73.77batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 74.00batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 74.27batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 74.47batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 74.65batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 74.75batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.75batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.72batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.62batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.66batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 74.53batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.45batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 73.79batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 73.90batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 73.75batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 73.79batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 74.05batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 74.05batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 73.58batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 73.72batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 73.77batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 73.93batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 73.96batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.05batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.01batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 73.94batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 74.10batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 74.03batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 73.76batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 73.78batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 73.81batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 73.76batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 73.79batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 73.72batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 73.66batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 73.48batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 73.46batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 73.30batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 73.36batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 73.20batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 73.31batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 73.26batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:03, 73.26batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 73.20batch/s] 80%|█████████████████████▌     | 812/1014 [00:11<00:02, 73.26batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 73.32batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 72.91batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 72.91batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 72.98batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 73.03batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 72.86batch/s] 87%|███████████████████████▍   | 882/1014 [00:12<00:01, 72.73batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 72.64batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 72.66batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 72.65batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 72.77batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 72.85batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 72.96batch/s] 94%|█████████████████████████▎ | 952/1014 [00:13<00:00, 72.98batch/s] 95%|█████████████████████████▌ | 962/1014 [00:13<00:00, 72.99batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 73.09batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 73.13batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 73.11batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 73.11batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 73.03batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.03batch/s]
Validation 7 -> LOSS = 1.56
Validation 7 -> BLEU = 41.74, 67.8/48.0/35.5/26.2 (BP=1.000, ratio=1.012, hyp_len=14548, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.56 @ validation 7
--> Best BLEU so far: 41.74 @ validation 7
Starting Epoch 8
Epoch 8 - update       3360 => loss:   1.802 (#OOM: 0)
Epoch 8 - update       3390 => loss:   1.597 (#OOM: 0)
Epoch 8 - update       3420 => loss:   2.514 (#OOM: 0)
Epoch 8 - update       3450 => loss:   1.669 (#OOM: 0)
Epoch 8 - update       3480 => loss:   1.149 (#OOM: 0)
Epoch 8 - update       3510 => loss:   1.535 (#OOM: 0)
Epoch 8 - update       3540 => loss:   1.340 (#OOM: 0)
Epoch 8 - update       3570 => loss:   1.521 (#OOM: 0)
Epoch 8 - update       3600 => loss:   1.394 (#OOM: 0)
Epoch 8 - update       3630 => loss:   1.737 (#OOM: 0)
Epoch 8 - update       3660 => loss:   1.604 (#OOM: 0)
Epoch 8 - update       3690 => loss:   1.890 (#OOM: 0)
Epoch 8 - update       3720 => loss:   1.605 (#OOM: 0)
Epoch 8 - update       3750 => loss:   1.213 (#OOM: 0)
Epoch 8 - update       3780 => loss:   1.956 (#OOM: 0)
Epoch 8 - update       3810 => loss:   1.550 (#OOM: 0)
--> Epoch 8 finished with mean loss 1.63344
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (809 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.60batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 43.78batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 45.96batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.58batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 47.95batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.86batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.83batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.80batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.98batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.97batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 77.99batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 75.84batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 74.65batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 74.85batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 73.61batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 74.95batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 74.46batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 74.37batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 75.31batch/s] 11%|███                        | 115/1014 [00:01<00:11, 75.05batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 75.43batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.35batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 74.20batch/s] 15%|████                       | 151/1014 [00:02<00:11, 74.50batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 73.96batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 74.41batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 72.37batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 73.15batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.27batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 73.28batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 73.55batch/s] 22%|██████                     | 228/1014 [00:03<00:10, 73.39batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 73.17batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 73.33batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 73.83batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 74.20batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 73.97batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 74.21batch/s] 29%|███████▉                   | 298/1014 [00:04<00:09, 73.91batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 73.99batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 74.10batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 73.73batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 73.66batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:09, 73.84batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 74.12batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 73.91batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 73.68batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 73.85batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 73.99batch/s] 40%|██████████▊                | 408/1014 [00:05<00:08, 73.77batch/s] 41%|███████████▏               | 418/1014 [00:05<00:08, 74.01batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 73.87batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 73.84batch/s] 44%|███████████▉               | 448/1014 [00:06<00:07, 73.18batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 72.90batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 72.90batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 72.88batch/s] 48%|████████████▉              | 488/1014 [00:06<00:07, 72.98batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:07, 72.94batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 73.01batch/s] 51%|█████████████▊             | 518/1014 [00:07<00:06, 73.09batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 73.14batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 72.97batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 72.91batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 72.65batch/s] 56%|███████████████            | 568/1014 [00:07<00:06, 72.58batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 72.68batch/s] 58%|███████████████▋           | 588/1014 [00:08<00:05, 72.63batch/s] 59%|███████████████▉           | 598/1014 [00:08<00:05, 72.60batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 72.61batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 72.57batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 72.56batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 72.35batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:05, 72.38batch/s] 65%|█████████████████▌         | 658/1014 [00:09<00:04, 72.30batch/s] 66%|█████████████████▊         | 668/1014 [00:09<00:04, 72.53batch/s] 67%|██████████████████         | 678/1014 [00:09<00:04, 72.44batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 72.44batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 72.43batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 72.41batch/s] 71%|███████████████████        | 718/1014 [00:09<00:04, 72.44batch/s] 72%|███████████████████▍       | 728/1014 [00:10<00:03, 72.47batch/s] 73%|███████████████████▋       | 738/1014 [00:10<00:03, 72.37batch/s] 74%|███████████████████▉       | 748/1014 [00:10<00:03, 72.43batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 72.39batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 72.22batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 72.26batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 72.20batch/s] 79%|█████████████████████▏     | 798/1014 [00:11<00:02, 72.27batch/s] 80%|█████████████████████▌     | 808/1014 [00:11<00:02, 72.30batch/s] 81%|█████████████████████▊     | 818/1014 [00:11<00:02, 72.32batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 72.43batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 72.46batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 72.52batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 72.45batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:02, 72.40batch/s] 87%|███████████████████████▍   | 878/1014 [00:12<00:01, 72.38batch/s] 88%|███████████████████████▋   | 888/1014 [00:12<00:01, 72.40batch/s] 89%|███████████████████████▉   | 898/1014 [00:12<00:01, 72.43batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 72.53batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 72.56batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 72.16batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 72.21batch/s] 93%|█████████████████████████▏ | 948/1014 [00:13<00:00, 72.13batch/s] 94%|█████████████████████████▌ | 958/1014 [00:13<00:00, 72.08batch/s] 95%|█████████████████████████▊ | 968/1014 [00:13<00:00, 71.72batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 71.71batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 71.72batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 71.72batch/s] 99%|█████████████████████████▊| 1008/1014 [00:14<00:00, 71.78batch/s]100%|██████████████████████████| 1014/1014 [00:14<00:00, 71.79batch/s]
Validation 8 -> LOSS = 1.49
Validation 8 -> BLEU = 42.56, 67.1/48.5/36.5/27.6 (BP=1.000, ratio=1.051, hyp_len=15118, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.49 @ validation 8
--> Best BLEU so far: 42.56 @ validation 8
Starting Epoch 9
Epoch 9 - update       3840 => loss:   1.573 (#OOM: 0)
Epoch 9 - update       3870 => loss:   1.471 (#OOM: 0)
Epoch 9 - update       3900 => loss:   1.721 (#OOM: 0)
Epoch 9 - update       3930 => loss:   2.417 (#OOM: 0)
Epoch 9 - update       3960 => loss:   1.232 (#OOM: 0)
Epoch 9 - update       3990 => loss:   1.906 (#OOM: 0)
Epoch 9 - update       4020 => loss:   1.261 (#OOM: 0)
Epoch 9 - update       4050 => loss:   1.841 (#OOM: 0)
Epoch 9 - update       4080 => loss:   1.329 (#OOM: 0)
Epoch 9 - update       4110 => loss:   1.204 (#OOM: 0)
Epoch 9 - update       4140 => loss:   1.354 (#OOM: 0)
Epoch 9 - update       4170 => loss:   1.542 (#OOM: 0)
Epoch 9 - update       4200 => loss:   1.380 (#OOM: 0)
Epoch 9 - update       4230 => loss:   1.109 (#OOM: 0)
Epoch 9 - update       4260 => loss:   1.376 (#OOM: 0)
Epoch 9 - update       4290 => loss:   1.550 (#OOM: 0)
--> Epoch 9 finished with mean loss 1.53479
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (829 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 37.70batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 52.06batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.22batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 51.42batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 50.43batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.23batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.69batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 78.20batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 76.67batch/s]  3%|▉                           | 35/1014 [00:00<00:14, 66.53batch/s]  4%|█▏                          | 44/1014 [00:00<00:14, 68.80batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 69.91batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 70.86batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 72.55batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 72.28batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 73.08batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 71.96batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 72.07batch/s] 11%|███                        | 116/1014 [00:01<00:12, 69.97batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 70.92batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 70.26batch/s] 14%|███▊                       | 143/1014 [00:02<00:12, 70.46batch/s] 15%|████                       | 152/1014 [00:02<00:12, 70.57batch/s] 16%|████▎                      | 161/1014 [00:02<00:12, 70.38batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 70.53batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 70.96batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 70.76batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 70.39batch/s] 20%|█████▍                     | 206/1014 [00:02<00:11, 70.87batch/s] 21%|█████▋                     | 215/1014 [00:03<00:11, 69.55batch/s] 22%|█████▉                     | 224/1014 [00:03<00:11, 69.63batch/s] 23%|██████▏                    | 233/1014 [00:03<00:11, 69.83batch/s] 24%|██████▍                    | 242/1014 [00:03<00:11, 70.00batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 69.85batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 70.24batch/s] 27%|███████▏                   | 269/1014 [00:03<00:10, 70.45batch/s] 27%|███████▍                   | 278/1014 [00:03<00:10, 70.71batch/s] 28%|███████▋                   | 287/1014 [00:04<00:10, 70.72batch/s] 29%|███████▉                   | 296/1014 [00:04<00:10, 70.80batch/s] 30%|████████                   | 305/1014 [00:04<00:10, 70.73batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 70.82batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 70.96batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 71.13batch/s] 34%|█████████                  | 341/1014 [00:04<00:09, 71.35batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:09, 71.47batch/s] 35%|█████████▌                 | 359/1014 [00:05<00:09, 71.60batch/s] 36%|█████████▊                 | 368/1014 [00:05<00:09, 71.65batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 71.66batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 71.65batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 71.92batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 71.24batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 71.21batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 71.20batch/s] 43%|███████████▍               | 431/1014 [00:06<00:08, 70.99batch/s] 43%|███████████▋               | 440/1014 [00:06<00:08, 71.20batch/s] 44%|███████████▉               | 449/1014 [00:06<00:07, 71.22batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 71.34batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 71.31batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 71.36batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 71.43batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 71.60batch/s] 50%|█████████████▍             | 503/1014 [00:07<00:07, 71.63batch/s] 50%|█████████████▋             | 512/1014 [00:07<00:06, 71.79batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 71.91batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 71.82batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 71.78batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 71.77batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 71.66batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 71.57batch/s] 57%|███████████████▎           | 575/1014 [00:08<00:06, 71.56batch/s] 58%|███████████████▌           | 584/1014 [00:08<00:06, 71.60batch/s] 58%|███████████████▊           | 593/1014 [00:08<00:05, 71.56batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 71.64batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 71.72batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 71.92batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 71.57batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 71.54batch/s] 64%|█████████████████▏         | 647/1014 [00:09<00:05, 71.56batch/s] 65%|█████████████████▍         | 656/1014 [00:09<00:05, 71.50batch/s] 66%|█████████████████▋         | 665/1014 [00:09<00:04, 71.59batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 71.43batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 71.51batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 71.71batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 71.80batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 71.80batch/s] 71%|███████████████████▎       | 723/1014 [00:10<00:04, 71.82batch/s] 72%|███████████████████▌       | 733/1014 [00:10<00:03, 71.83batch/s] 73%|███████████████████▊       | 743/1014 [00:10<00:03, 71.90batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 71.94batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 72.14batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 72.09batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 72.25batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:03, 72.32batch/s] 79%|█████████████████████▍     | 803/1014 [00:11<00:02, 72.38batch/s] 80%|█████████████████████▋     | 813/1014 [00:11<00:02, 72.38batch/s] 81%|█████████████████████▉     | 823/1014 [00:11<00:02, 72.40batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 72.53batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 72.60batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 72.66batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 72.67batch/s] 86%|███████████████████████▏   | 873/1014 [00:12<00:01, 72.73batch/s] 87%|███████████████████████▌   | 883/1014 [00:12<00:01, 72.88batch/s] 88%|███████████████████████▊   | 893/1014 [00:12<00:01, 72.93batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 73.03batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 73.08batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 73.20batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 72.90batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 72.82batch/s] 94%|█████████████████████████▍ | 953/1014 [00:13<00:00, 72.89batch/s] 95%|█████████████████████████▋ | 963/1014 [00:13<00:00, 72.98batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 72.95batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 72.89batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 72.99batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 73.07batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 73.19batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.19batch/s]
Validation 9 -> LOSS = 1.43
Validation 9 -> BLEU = 45.47, 69.8/51.3/39.4/30.3 (BP=1.000, ratio=1.016, hyp_len=14615, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.43 @ validation 9
--> Best BLEU so far: 45.47 @ validation 9
Starting Epoch 10
Epoch 10 - update       4320 => loss:   1.623 (#OOM: 0)
Epoch 10 - update       4350 => loss:   1.361 (#OOM: 0)
Epoch 10 - update       4380 => loss:   1.319 (#OOM: 0)
Epoch 10 - update       4410 => loss:   1.420 (#OOM: 0)
Epoch 10 - update       4440 => loss:   1.616 (#OOM: 0)
Epoch 10 - update       4470 => loss:   1.351 (#OOM: 0)
Epoch 10 - update       4500 => loss:   1.421 (#OOM: 0)
Epoch 10 - update       4530 => loss:   1.441 (#OOM: 0)
Epoch 10 - update       4560 => loss:   1.515 (#OOM: 0)
Epoch 10 - update       4590 => loss:   1.542 (#OOM: 0)
Epoch 10 - update       4620 => loss:   1.388 (#OOM: 0)
Epoch 10 - update       4650 => loss:   1.286 (#OOM: 0)
Epoch 10 - update       4680 => loss:   1.419 (#OOM: 0)
Epoch 10 - update       4710 => loss:   1.253 (#OOM: 0)
Epoch 10 - update       4740 => loss:   1.382 (#OOM: 0)
Epoch 10 - update       4770 => loss:   1.363 (#OOM: 0)
--> Epoch 10 finished with mean loss 1.45045
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (845 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.87batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.75batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 53.61batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.50batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 49.94batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.19batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.29batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 70.71batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 70.51batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 65.87batch/s]  4%|█                           | 40/1014 [00:00<00:14, 66.02batch/s]  5%|█▎                          | 48/1014 [00:00<00:14, 66.84batch/s]  6%|█▌                          | 56/1014 [00:00<00:14, 68.18batch/s]  6%|█▊                          | 64/1014 [00:00<00:13, 69.24batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 69.81batch/s]  8%|██▏                         | 80/1014 [00:01<00:13, 69.47batch/s]  9%|██▍                         | 88/1014 [00:01<00:13, 69.98batch/s]  9%|██▋                         | 96/1014 [00:01<00:13, 70.15batch/s] 10%|██▊                        | 104/1014 [00:01<00:13, 69.59batch/s] 11%|███                        | 113/1014 [00:01<00:12, 70.68batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 70.63batch/s] 13%|███▍                       | 131/1014 [00:01<00:12, 71.19batch/s] 14%|███▋                       | 140/1014 [00:01<00:12, 71.33batch/s] 15%|███▉                       | 149/1014 [00:02<00:12, 71.49batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 71.70batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 71.59batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 71.49batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 71.78batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 72.35batch/s] 20%|█████▍                     | 203/1014 [00:02<00:11, 72.80batch/s] 21%|█████▋                     | 212/1014 [00:02<00:11, 72.85batch/s] 22%|█████▉                     | 221/1014 [00:03<00:10, 72.77batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 72.97batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 72.99batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 72.75batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 72.23batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 71.70batch/s] 27%|███████▎                   | 275/1014 [00:03<00:10, 72.04batch/s] 28%|███████▌                   | 284/1014 [00:03<00:10, 72.10batch/s] 29%|███████▊                   | 293/1014 [00:04<00:09, 72.20batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 72.44batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 72.29batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 72.28batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 72.45batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 72.44batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:09, 72.77batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:09, 72.95batch/s] 36%|█████████▋                 | 365/1014 [00:05<00:08, 72.80batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 73.08batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 73.03batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 73.15batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 73.37batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 73.43batch/s] 41%|███████████▏               | 419/1014 [00:05<00:08, 73.27batch/s] 42%|███████████▍               | 428/1014 [00:05<00:08, 73.19batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 73.13batch/s] 44%|███████████▉               | 446/1014 [00:06<00:07, 73.06batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 73.12batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 72.53batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 72.69batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 72.51batch/s] 48%|█████████████              | 491/1014 [00:06<00:07, 72.59batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:07, 72.65batch/s] 50%|█████████████▌             | 509/1014 [00:07<00:06, 72.58batch/s] 51%|█████████████▊             | 518/1014 [00:07<00:06, 72.66batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 72.67batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 72.71batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 72.53batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 72.54batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 72.42batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:06, 72.51batch/s] 57%|███████████████▍           | 581/1014 [00:08<00:05, 72.48batch/s] 58%|███████████████▋           | 590/1014 [00:08<00:05, 72.55batch/s] 59%|███████████████▉           | 599/1014 [00:08<00:05, 72.55batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 72.60batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 72.65batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 72.73batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 72.73batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:05, 72.86batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 73.00batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 73.16batch/s] 66%|█████████████████▊         | 671/1014 [00:09<00:04, 73.17batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 73.23batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 73.29batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 73.41batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 73.45batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 73.45batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 73.44batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 73.57batch/s] 73%|███████████████████▊       | 743/1014 [00:10<00:03, 73.46batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 73.42batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 73.39batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 73.33batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 73.19batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 73.22batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 73.23batch/s] 79%|█████████████████████▍     | 806/1014 [00:11<00:02, 73.25batch/s] 80%|█████████████████████▋     | 815/1014 [00:11<00:02, 73.21batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 73.29batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 73.29batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 73.39batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 73.48batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 73.46batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 73.51batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 73.51batch/s] 87%|███████████████████████▌   | 887/1014 [00:12<00:01, 73.48batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 73.50batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 73.58batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 73.54batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 73.55batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 73.59batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 73.67batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 73.61batch/s] 95%|█████████████████████████▌ | 959/1014 [00:13<00:00, 73.69batch/s] 95%|█████████████████████████▊ | 968/1014 [00:13<00:00, 73.80batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 73.82batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 73.83batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 73.78batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 73.68batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 73.72batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.73batch/s]
Validation 10 -> LOSS = 1.38
Validation 10 -> BLEU = 46.71, 70.6/52.5/40.6/31.6 (BP=1.000, ratio=1.020, hyp_len=14669, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.38 @ validation 10
--> Best BLEU so far: 46.71 @ validation 10
Starting Epoch 11
Epoch 11 - update       4800 => loss:   1.308 (#OOM: 0)
Epoch 11 - update       4830 => loss:   1.109 (#OOM: 0)
Epoch 11 - update       4860 => loss:   1.210 (#OOM: 0)
Epoch 11 - update       4890 => loss:   1.190 (#OOM: 0)
Epoch 11 - update       4920 => loss:   1.499 (#OOM: 0)
Epoch 11 - update       4950 => loss:   1.024 (#OOM: 0)
Epoch 11 - update       4980 => loss:   1.390 (#OOM: 0)
Epoch 11 - update       5010 => loss:   1.326 (#OOM: 0)
Epoch 11 - update       5040 => loss:   1.245 (#OOM: 0)
Epoch 11 - update       5070 => loss:   1.307 (#OOM: 0)
Epoch 11 - update       5100 => loss:   1.514 (#OOM: 0)
Epoch 11 - update       5130 => loss:   1.966 (#OOM: 0)
Epoch 11 - update       5160 => loss:   1.306 (#OOM: 0)
Epoch 11 - update       5190 => loss:   1.187 (#OOM: 0)
Epoch 11 - update       5220 => loss:   1.424 (#OOM: 0)
--> Epoch 11 finished with mean loss 1.37561
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (901 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.65batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.54batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.71batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.78batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.46batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.81batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.45batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.30batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.34batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 74.65batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 73.13batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.28batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 73.36batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 71.79batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 72.66batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 72.72batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 73.08batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 73.40batch/s] 11%|███                        | 115/1014 [00:01<00:12, 73.14batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 72.28batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 72.52batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 72.76batch/s] 15%|████                       | 151/1014 [00:02<00:11, 73.57batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 73.84batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 73.57batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 73.94batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 74.31batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 74.22batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.58batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 74.48batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 74.08batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 73.89batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 73.66batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 73.83batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 74.09batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 74.26batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 74.83batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 74.87batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 74.84batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 74.68batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 75.11batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 74.90batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 74.75batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 74.94batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.14batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.39batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 75.46batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.27batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 75.27batch/s] 40%|██████████▊                | 408/1014 [00:05<00:08, 75.47batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 75.73batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 75.65batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.61batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.64batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 75.85batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.68batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 75.84batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 75.95batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.13batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 76.15batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.10batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 76.07batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 76.13batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 76.38batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 76.48batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 76.32batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 76.25batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 76.34batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 76.33batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.39batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 76.46batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 76.27batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 76.24batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 76.18batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 76.31batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 76.30batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 76.27batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 76.36batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 76.37batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 76.18batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 76.16batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 76.14batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 76.26batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 76.27batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 76.33batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 76.26batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 76.04batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 75.93batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.87batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.89batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.87batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 75.94batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.97batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.82batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.76batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.70batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.69batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.73batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.82batch/s] 90%|████████████████████████▏  | 908/1014 [00:11<00:01, 75.85batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.92batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.83batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.73batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.34batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.33batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.28batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.27batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.23batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.27batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.27batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.21batch/s]
Validation 11 -> LOSS = 1.34
Validation 11 -> BLEU = 48.79, 72.6/54.8/42.8/33.5 (BP=0.999, ratio=0.999, hyp_len=14365, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.34 @ validation 11
--> Best BLEU so far: 48.79 @ validation 11
Starting Epoch 12
Epoch 12 - update       5250 => loss:   1.229 (#OOM: 0)
Epoch 12 - update       5280 => loss:   1.104 (#OOM: 0)
Epoch 12 - update       5310 => loss:   1.345 (#OOM: 0)
Epoch 12 - update       5340 => loss:   1.126 (#OOM: 0)
Epoch 12 - update       5370 => loss:   1.310 (#OOM: 0)
Epoch 12 - update       5400 => loss:   1.370 (#OOM: 0)
Epoch 12 - update       5430 => loss:   1.292 (#OOM: 0)
Epoch 12 - update       5460 => loss:   1.676 (#OOM: 0)
Epoch 12 - update       5490 => loss:   1.172 (#OOM: 0)
Epoch 12 - update       5520 => loss:   1.911 (#OOM: 0)
Epoch 12 - update       5550 => loss:   1.151 (#OOM: 0)
Epoch 12 - update       5580 => loss:   1.123 (#OOM: 0)
Epoch 12 - update       5610 => loss:   1.229 (#OOM: 0)
Epoch 12 - update       5640 => loss:   1.380 (#OOM: 0)
Epoch 12 - update       5670 => loss:   1.700 (#OOM: 0)
Epoch 12 - update       5700 => loss:   1.253 (#OOM: 0)
--> Epoch 12 finished with mean loss 1.31237
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (776 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.32batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.80batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.68batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.35batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 52.99batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.31batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.55batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.09batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 82.94batch/s]  4%|█                           | 37/1014 [00:00<00:12, 79.67batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 80.77batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 81.50batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 81.98batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 81.19batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 80.23batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 77.63batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 77.95batch/s] 12%|███                        | 117/1014 [00:01<00:11, 77.61batch/s] 13%|███▍                       | 127/1014 [00:01<00:11, 77.96batch/s] 14%|███▋                       | 137/1014 [00:01<00:11, 77.39batch/s] 14%|███▉                       | 147/1014 [00:01<00:11, 76.98batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 76.36batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 76.54batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 76.78batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.56batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 76.48batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.96batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 76.12batch/s] 22%|██████                     | 227/1014 [00:02<00:10, 76.08batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 75.78batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 75.89batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.30batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.22batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.52batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.32batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 74.42batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 74.56batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 74.57batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 74.85batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 74.75batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 74.77batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.96batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.14batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 75.23batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.17batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 75.20batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 75.20batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 75.36batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 74.43batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.48batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 74.57batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 74.37batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.44batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.54batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 74.56batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.51batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 74.67batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 74.83batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 74.91batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 75.04batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.15batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 75.24batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.23batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 75.23batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 75.41batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 75.41batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 75.54batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.52batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 75.64batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 75.63batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.60batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.56batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.54batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 75.48batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.39batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.31batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.46batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.53batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.49batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.47batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.45batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 75.51batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.56batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.63batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 75.56batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.40batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.46batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.33batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 74.93batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 74.90batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 74.90batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 74.78batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 74.68batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 74.69batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 74.78batch/s] 88%|███████████████████████▉   | 897/1014 [00:12<00:01, 74.71batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.61batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.52batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.43batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.40batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 74.35batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 74.42batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 74.42batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.46batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.46batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 74.54batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 74.57batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.65batch/s]
Validation 12 -> LOSS = 1.32
Validation 12 -> BLEU = 49.36, 73.2/55.7/43.8/34.5 (BP=0.991, ratio=0.991, hyp_len=14247, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.32 @ validation 12
--> Best BLEU so far: 49.36 @ validation 12
Starting Epoch 13
Epoch 13 - update       5730 => loss:   0.974 (#OOM: 0)
Epoch 13 - update       5760 => loss:   0.948 (#OOM: 0)
Epoch 13 - update       5790 => loss:   1.239 (#OOM: 0)
Epoch 13 - update       5820 => loss:   1.393 (#OOM: 0)
Epoch 13 - update       5850 => loss:   1.131 (#OOM: 0)
Epoch 13 - update       5880 => loss:   1.184 (#OOM: 0)
Epoch 13 - update       5910 => loss:   1.186 (#OOM: 0)
Epoch 13 - update       5940 => loss:   1.192 (#OOM: 0)
Epoch 13 - update       5970 => loss:   1.200 (#OOM: 0)
Epoch 13 - update       6000 => loss:   1.114 (#OOM: 0)
Epoch 13 - update       6030 => loss:   1.066 (#OOM: 0)
Epoch 13 - update       6060 => loss:   1.258 (#OOM: 0)
Epoch 13 - update       6090 => loss:   1.328 (#OOM: 0)
Epoch 13 - update       6120 => loss:   1.161 (#OOM: 0)
Epoch 13 - update       6150 => loss:   1.395 (#OOM: 0)
Epoch 13 - update       6180 => loss:   1.434 (#OOM: 0)
--> Epoch 13 finished with mean loss 1.25071
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (766 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.36batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.74batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.78batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 52.09batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.25batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.08batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 6/1014 [00:00<00:19, 52.09batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 68.47batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 67.64batch/s]  3%|▉                           | 33/1014 [00:00<00:14, 66.43batch/s]  4%|█▏                          | 42/1014 [00:00<00:14, 68.00batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 69.15batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 70.35batch/s]  7%|█▉                          | 69/1014 [00:00<00:13, 70.09batch/s]  8%|██▏                         | 78/1014 [00:01<00:13, 70.70batch/s]  9%|██▍                         | 87/1014 [00:01<00:13, 71.14batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 72.04batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 72.25batch/s] 11%|███                        | 114/1014 [00:01<00:12, 72.62batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 73.15batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 73.65batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 73.47batch/s] 15%|███▉                       | 150/1014 [00:02<00:11, 73.60batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 73.24batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 73.81batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 73.97batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.11batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 74.21batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 74.52batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.80batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.61batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 74.42batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 74.12batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 73.87batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 74.01batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 73.71batch/s] 27%|███████▎                   | 276/1014 [00:03<00:10, 73.36batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 73.28batch/s] 29%|███████▊                   | 294/1014 [00:04<00:09, 73.33batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 73.24batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 73.25batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 73.11batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 73.26batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 73.26batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:09, 73.57batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 73.47batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 73.58batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 73.83batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.00batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.12batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 74.24batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 74.28batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 74.36batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 74.30batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 74.51batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 74.53batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 74.61batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.45batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.38batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.52batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 74.48batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 74.33batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 74.36batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 74.22batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 74.13batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 74.19batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 74.02batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 74.18batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 74.23batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 74.30batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.36batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 74.31batch/s] 59%|███████████████▉           | 600/1014 [00:08<00:05, 74.32batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 74.27batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 74.28batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 74.22batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.28batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.27batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.08batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.03batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 74.03batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 73.94batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 74.00batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 73.94batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 74.04batch/s] 71%|███████████████████        | 717/1014 [00:09<00:04, 74.00batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 73.91batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 73.83batch/s] 73%|███████████████████▊       | 744/1014 [00:10<00:03, 73.86batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 73.88batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 73.99batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 74.01batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 74.23batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:03, 74.01batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.00batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 73.98batch/s] 81%|█████████████████████▊     | 821/1014 [00:11<00:02, 73.81batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 73.88batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 73.95batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 73.92batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 74.02batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 74.13batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 74.02batch/s] 88%|███████████████████████▋   | 891/1014 [00:12<00:01, 74.00batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 74.12batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 74.17batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 74.17batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 74.19batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 74.21batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 74.31batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 74.30batch/s] 96%|█████████████████████████▊ | 971/1014 [00:13<00:00, 74.32batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 74.35batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 74.42batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 74.40batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 74.46batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.46batch/s]
Validation 13 -> LOSS = 1.29
Validation 13 -> BLEU = 50.77, 73.9/56.5/44.8/35.6 (BP=1.000, ratio=1.000, hyp_len=14377, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.29 @ validation 13
--> Best BLEU so far: 50.77 @ validation 13
Starting Epoch 14
Epoch 14 - update       6210 => loss:   1.421 (#OOM: 0)
Epoch 14 - update       6240 => loss:   1.221 (#OOM: 0)
Epoch 14 - update       6270 => loss:   0.906 (#OOM: 0)
Epoch 14 - update       6300 => loss:   1.217 (#OOM: 0)
Epoch 14 - update       6330 => loss:   1.020 (#OOM: 0)
Epoch 14 - update       6360 => loss:   1.039 (#OOM: 0)
Epoch 14 - update       6390 => loss:   1.156 (#OOM: 0)
Epoch 14 - update       6420 => loss:   0.808 (#OOM: 0)
Epoch 14 - update       6450 => loss:   1.479 (#OOM: 0)
Epoch 14 - update       6480 => loss:   1.036 (#OOM: 0)
Epoch 14 - update       6510 => loss:   1.196 (#OOM: 0)
Epoch 14 - update       6540 => loss:   1.197 (#OOM: 0)
Epoch 14 - update       6570 => loss:   1.269 (#OOM: 0)
Epoch 14 - update       6600 => loss:   1.044 (#OOM: 0)
Epoch 14 - update       6630 => loss:   1.262 (#OOM: 0)
Epoch 14 - update       6660 => loss:   1.417 (#OOM: 0)
--> Epoch 14 finished with mean loss 1.20033
--> Overhead/Training/Evaluation: 0.03/0.56/0.00 mins (total: 0.59 mins)   (867 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.45batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.28batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.37batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.30batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.14batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.42batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.73batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.53batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 76.51batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 76.12batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 76.92batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 76.26batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 72.95batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 72.76batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 72.43batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 72.74batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 73.69batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 73.45batch/s] 11%|███                        | 116/1014 [00:01<00:12, 72.78batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 72.94batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 73.14batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.70batch/s] 15%|████                       | 154/1014 [00:02<00:11, 74.12batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 73.96batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 74.39batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 73.90batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 73.82batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 73.58batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 73.85batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 73.60batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.85batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 73.95batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 74.01batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 74.35batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 74.40batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 74.71batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 74.35batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.37batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.68batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.77batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 74.94batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 74.74batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 74.95batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 74.64batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.77batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.97batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.08batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.15batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.33batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.63batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.42batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.36batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 75.34batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.29batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.59batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.64batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.68batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.48batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.39batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.33batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 75.26batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.02batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 74.98batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.02batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 74.95batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.85batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.93batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 74.91batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 74.79batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 74.82batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 74.76batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.84batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.94batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.08batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.14batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.01batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.04batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 74.98batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.04batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.96batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.03batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 74.89batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.89batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.92batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 74.95batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.98batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 74.91batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.86batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.87batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.00batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.93batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.91batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.94batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.87batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.81batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.86batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 74.85batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.90batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.51batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.72batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.67batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.74batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.70batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.71batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.74batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.77batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.85batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.85batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.82batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.82batch/s]
Validation 14 -> LOSS = 1.27
Validation 14 -> BLEU = 50.60, 73.7/56.5/44.7/35.5 (BP=0.999, ratio=0.999, hyp_len=14363, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.27 @ validation 14
--> Best BLEU so far: 50.77 @ validation 13
Starting Epoch 15
Epoch 15 - update       6690 => loss:   1.233 (#OOM: 0)
Epoch 15 - update       6720 => loss:   1.567 (#OOM: 0)
Epoch 15 - update       6750 => loss:   0.958 (#OOM: 0)
Epoch 15 - update       6780 => loss:   1.119 (#OOM: 0)
Epoch 15 - update       6810 => loss:   1.261 (#OOM: 0)
Epoch 15 - update       6840 => loss:   1.102 (#OOM: 0)
Epoch 15 - update       6870 => loss:   1.237 (#OOM: 0)
Epoch 15 - update       6900 => loss:   1.007 (#OOM: 0)
Epoch 15 - update       6930 => loss:   1.064 (#OOM: 0)
Epoch 15 - update       6960 => loss:   0.932 (#OOM: 0)
Epoch 15 - update       6990 => loss:   1.194 (#OOM: 0)
Epoch 15 - update       7020 => loss:   1.133 (#OOM: 0)
Epoch 15 - update       7050 => loss:   1.176 (#OOM: 0)
Epoch 15 - update       7080 => loss:   1.335 (#OOM: 0)
Epoch 15 - update       7110 => loss:   1.140 (#OOM: 0)
Epoch 15 - update       7140 => loss:   1.029 (#OOM: 0)
--> Epoch 15 finished with mean loss 1.15370
--> Overhead/Training/Evaluation: 0.03/0.52/0.00 mins (total: 0.56 mins)   (921 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.09batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.38batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.42batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.90batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.11batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.27batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.24batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:16, 61.60batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.86batch/s]  2%|▋                           | 25/1014 [00:00<00:13, 72.10batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 75.21batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 74.52batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.77batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 70.92batch/s]  7%|█▉                          | 70/1014 [00:01<00:13, 69.12batch/s]  8%|██▏                         | 79/1014 [00:01<00:13, 69.19batch/s]  9%|██▍                         | 88/1014 [00:01<00:13, 69.40batch/s] 10%|██▋                         | 97/1014 [00:01<00:13, 70.08batch/s] 10%|██▊                        | 106/1014 [00:01<00:13, 69.82batch/s] 11%|███                        | 115/1014 [00:01<00:12, 69.24batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 69.35batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 69.61batch/s] 14%|███▊                       | 142/1014 [00:02<00:12, 69.80batch/s] 15%|████                       | 151/1014 [00:02<00:12, 70.32batch/s] 16%|████▎                      | 160/1014 [00:02<00:12, 70.25batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 70.60batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 71.09batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 71.65batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 71.63batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 71.68batch/s] 21%|█████▋                     | 214/1014 [00:02<00:11, 71.56batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 71.91batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 71.99batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 72.06batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 72.03batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 72.33batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 72.46batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 72.03batch/s] 28%|███████▌                   | 286/1014 [00:03<00:10, 72.02batch/s] 29%|███████▊                   | 295/1014 [00:04<00:09, 72.12batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 72.21batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 72.39batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 72.50batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 72.35batch/s] 34%|█████████                  | 340/1014 [00:04<00:09, 72.36batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:09, 72.31batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:09, 72.44batch/s] 36%|█████████▊                 | 367/1014 [00:05<00:08, 72.48batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 72.37batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 72.45batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 72.45batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 72.26batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 72.48batch/s] 42%|███████████▏               | 421/1014 [00:05<00:08, 72.72batch/s] 42%|███████████▍               | 430/1014 [00:05<00:08, 72.72batch/s] 43%|███████████▋               | 439/1014 [00:06<00:07, 72.70batch/s] 44%|███████████▉               | 448/1014 [00:06<00:07, 72.85batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 72.77batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 72.70batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 72.61batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 72.70batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:07, 72.76batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:07, 72.90batch/s] 50%|█████████████▌             | 511/1014 [00:07<00:06, 72.95batch/s] 51%|█████████████▊             | 520/1014 [00:07<00:06, 73.17batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 73.28batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 73.22batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 73.11batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 73.23batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 73.05batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:06, 72.78batch/s] 57%|███████████████▌           | 583/1014 [00:08<00:05, 72.67batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 72.69batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 72.74batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 72.84batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 73.06batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 73.01batch/s] 63%|█████████████████          | 640/1014 [00:08<00:05, 72.82batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 72.97batch/s] 65%|█████████████████▌         | 660/1014 [00:09<00:04, 73.02batch/s] 66%|█████████████████▊         | 670/1014 [00:09<00:04, 73.04batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 73.13batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 72.94batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 73.15batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 73.25batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:04, 73.26batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 73.19batch/s] 73%|███████████████████▋       | 740/1014 [00:10<00:03, 73.25batch/s] 74%|███████████████████▉       | 750/1014 [00:10<00:03, 73.19batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 73.26batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 73.11batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 73.16batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:03, 73.22batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 73.21batch/s] 80%|█████████████████████▌     | 810/1014 [00:11<00:02, 73.30batch/s] 81%|█████████████████████▊     | 820/1014 [00:11<00:02, 73.45batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 73.39batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 73.33batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 73.35batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 73.40batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 73.44batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 73.45batch/s] 88%|███████████████████████▋   | 890/1014 [00:12<00:01, 73.47batch/s] 89%|███████████████████████▉   | 900/1014 [00:12<00:01, 73.35batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 73.32batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 73.35batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 73.39batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:01, 73.24batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 73.35batch/s] 95%|█████████████████████████▌ | 960/1014 [00:13<00:00, 73.33batch/s] 96%|█████████████████████████▊ | 970/1014 [00:13<00:00, 73.34batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 73.45batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 73.40batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 73.37batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 73.33batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.36batch/s]
Validation 15 -> LOSS = 1.25
Validation 15 -> BLEU = 51.05, 73.7/56.8/45.2/36.0 (BP=1.000, ratio=1.016, hyp_len=14613, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.25 @ validation 15
--> Best BLEU so far: 51.05 @ validation 15
Starting Epoch 16
Epoch 16 - update       7170 => loss:   1.083 (#OOM: 0)
Epoch 16 - update       7200 => loss:   0.961 (#OOM: 0)
Epoch 16 - update       7230 => loss:   1.010 (#OOM: 0)
Epoch 16 - update       7260 => loss:   1.106 (#OOM: 0)
Epoch 16 - update       7290 => loss:   1.038 (#OOM: 0)
Epoch 16 - update       7320 => loss:   1.370 (#OOM: 0)
Epoch 16 - update       7350 => loss:   0.921 (#OOM: 0)
Epoch 16 - update       7380 => loss:   0.984 (#OOM: 0)
Epoch 16 - update       7410 => loss:   1.130 (#OOM: 0)
Epoch 16 - update       7440 => loss:   1.003 (#OOM: 0)
Epoch 16 - update       7470 => loss:   1.635 (#OOM: 0)
Epoch 16 - update       7500 => loss:   1.344 (#OOM: 0)
Epoch 16 - update       7530 => loss:   1.249 (#OOM: 0)
Epoch 16 - update       7560 => loss:   1.076 (#OOM: 0)
Epoch 16 - update       7590 => loss:   0.814 (#OOM: 0)
Epoch 16 - update       7620 => loss:   0.965 (#OOM: 0)
--> Epoch 16 finished with mean loss 1.11025
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (846 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.38batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.68batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.54batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.43batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.07batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.11batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.08batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.83batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.28batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 74.20batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.73batch/s]  4%|█                           | 40/1014 [00:00<00:13, 74.72batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 75.22batch/s]  6%|█▌                          | 56/1014 [00:00<00:12, 75.29batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 75.26batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 74.84batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.19batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 76.57batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 77.04batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 77.26batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.75batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.43batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.37batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 76.58batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.90batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.83batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.94batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 75.79batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.21batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.13batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 75.79batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 75.81batch/s] 22%|██████                     | 228/1014 [00:03<00:10, 75.83batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 75.96batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 75.79batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 75.68batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.80batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.90batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 76.25batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 76.52batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 76.54batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 76.30batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 76.10batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 76.04batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 76.05batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.96batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.72batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 75.91batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.70batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 75.71batch/s] 40%|██████████▊                | 408/1014 [00:05<00:08, 75.70batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 75.53batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 75.55batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.68batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.57batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 75.61batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.77batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 75.81batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 75.73batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 75.61batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 75.70batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 75.70batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 75.63batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.49batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 75.32batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.47batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 75.45batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 75.22batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 75.17batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 75.24batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 75.38batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 75.29batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 75.19batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 75.21batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.27batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 75.30batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 75.52batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 75.62batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 75.49batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 75.64batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 75.48batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 75.35batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 75.51batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.49batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 75.67batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 75.65batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 75.54batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.39batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 75.36batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.32batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.12batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.10batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 75.21batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.22batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.05batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.03batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.01batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.02batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.10batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.10batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 75.14batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.05batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.14batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.13batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.05batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.13batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.12batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.30batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.36batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.29batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.34batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.36batch/s]
Validation 16 -> LOSS = 1.24
Validation 16 -> BLEU = 51.74, 75.3/58.4/46.6/37.2 (BP=0.985, ratio=0.985, hyp_len=14170, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.24 @ validation 16
--> Best BLEU so far: 51.74 @ validation 16
Starting Epoch 17
Epoch 17 - update       7650 => loss:   0.837 (#OOM: 0)
Epoch 17 - update       7680 => loss:   1.461 (#OOM: 0)
Epoch 17 - update       7710 => loss:   1.162 (#OOM: 0)
Epoch 17 - update       7740 => loss:   1.057 (#OOM: 0)
Epoch 17 - update       7770 => loss:   0.761 (#OOM: 0)
Epoch 17 - update       7800 => loss:   1.223 (#OOM: 0)
Epoch 17 - update       7830 => loss:   1.274 (#OOM: 0)
Epoch 17 - update       7860 => loss:   0.967 (#OOM: 0)
Epoch 17 - update       7890 => loss:   0.898 (#OOM: 0)
Epoch 17 - update       7920 => loss:   0.927 (#OOM: 0)
Epoch 17 - update       7950 => loss:   1.090 (#OOM: 0)
Epoch 17 - update       7980 => loss:   1.187 (#OOM: 0)
Epoch 17 - update       8010 => loss:   1.032 (#OOM: 0)
Epoch 17 - update       8040 => loss:   1.093 (#OOM: 0)
Epoch 17 - update       8070 => loss:   1.293 (#OOM: 0)
Epoch 17 - update       8100 => loss:   0.622 (#OOM: 0)
--> Epoch 17 finished with mean loss 1.07392
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (843 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.13batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.17batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.32batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.98batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.70batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.41batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.39batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 68.92batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.85batch/s]  2%|▋                           | 25/1014 [00:00<00:13, 76.06batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 76.39batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 73.86batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 74.13batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 74.09batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 74.88batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 75.24batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 76.05batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 76.19batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 76.42batch/s] 11%|███                        | 115/1014 [00:01<00:11, 76.64batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 76.21batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 76.81batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 77.07batch/s] 15%|████                       | 151/1014 [00:01<00:11, 77.18batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 77.21batch/s] 17%|████▌                      | 169/1014 [00:02<00:10, 77.44batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 76.56batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.34batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.26batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.51batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 76.80batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 76.79batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 76.81batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 76.73batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 77.10batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 77.17batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 77.14batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 77.11batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 77.44batch/s] 30%|████████                   | 301/1014 [00:03<00:09, 77.61batch/s] 31%|████████▎                  | 311/1014 [00:03<00:09, 77.81batch/s] 32%|████████▌                  | 321/1014 [00:04<00:08, 77.50batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 77.59batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 77.42batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 77.41batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 77.01batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 76.97batch/s] 38%|██████████▏                | 381/1014 [00:04<00:08, 76.83batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 77.02batch/s] 40%|██████████▋                | 401/1014 [00:05<00:07, 77.04batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 76.95batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 76.77batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 76.87batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 76.73batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 76.54batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 76.69batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 76.74batch/s] 47%|████████████▊              | 481/1014 [00:06<00:06, 76.84batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 76.89batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 76.92batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 77.02batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 77.01batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 76.96batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 77.04batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 77.11batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 77.27batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 77.12batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 77.17batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 77.16batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 77.02batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:05, 77.00batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 77.00batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:04, 76.65batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 76.46batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 76.35batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 76.35batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 76.34batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 76.32batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 76.26batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 76.18batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:03, 76.29batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 76.28batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 76.16batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 76.21batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 76.08batch/s] 75%|████████████████████▎      | 761/1014 [00:09<00:03, 76.10batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 75.82batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 75.90batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 75.81batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 75.55batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 75.51batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 75.49batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 75.52batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 75.41batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 75.42batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 75.42batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 75.47batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 75.36batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 75.32batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 75.40batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 75.36batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 75.37batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 75.39batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 75.31batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 75.36batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 75.39batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 75.31batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 75.26batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.38batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 75.33batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 75.32batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.34batch/s]
Validation 17 -> LOSS = 1.23
Validation 17 -> BLEU = 51.82, 75.2/58.0/46.3/36.9 (BP=0.992, ratio=0.992, hyp_len=14262, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.23 @ validation 17
--> Best BLEU so far: 51.82 @ validation 17
Starting Epoch 18
Epoch 18 - update       8130 => loss:   0.913 (#OOM: 0)
Epoch 18 - update       8160 => loss:   1.163 (#OOM: 0)
Epoch 18 - update       8190 => loss:   1.262 (#OOM: 0)
Epoch 18 - update       8220 => loss:   1.353 (#OOM: 0)
Epoch 18 - update       8250 => loss:   0.859 (#OOM: 0)
Epoch 18 - update       8280 => loss:   0.812 (#OOM: 0)
Epoch 18 - update       8310 => loss:   0.935 (#OOM: 0)
Epoch 18 - update       8340 => loss:   0.955 (#OOM: 0)
Epoch 18 - update       8370 => loss:   0.842 (#OOM: 0)
Epoch 18 - update       8400 => loss:   0.828 (#OOM: 0)
Epoch 18 - update       8430 => loss:   1.019 (#OOM: 0)
Epoch 18 - update       8460 => loss:   0.834 (#OOM: 0)
Epoch 18 - update       8490 => loss:   1.170 (#OOM: 0)
Epoch 18 - update       8520 => loss:   1.026 (#OOM: 0)
Epoch 18 - update       8550 => loss:   1.102 (#OOM: 0)
Epoch 18 - update       8580 => loss:   0.867 (#OOM: 0)
--> Epoch 18 finished with mean loss 1.03959
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (789 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 46.92batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.63batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.68batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.03batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.74batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.51batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.09batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.15batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 76.47batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 72.95batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 74.95batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 74.93batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 74.68batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 75.30batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 76.45batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 76.84batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 77.58batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 77.82batch/s] 11%|███                        | 116/1014 [00:01<00:11, 77.91batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 77.63batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 74.49batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 74.43batch/s] 15%|████                       | 152/1014 [00:02<00:11, 74.58batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 74.76batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 74.87batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 73.92batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 73.59batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 73.60batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 73.70batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 73.41batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 73.79batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.01batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 73.74batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 74.02batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 73.59batch/s] 27%|███████▏                   | 269/1014 [00:03<00:10, 73.65batch/s] 27%|███████▍                   | 278/1014 [00:03<00:10, 73.31batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 73.08batch/s] 29%|███████▉                   | 296/1014 [00:04<00:09, 73.44batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 73.46batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 73.45batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 73.44batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 73.53batch/s] 34%|█████████                  | 341/1014 [00:04<00:09, 73.60batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:09, 73.68batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 73.81batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 73.96batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.15batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.17batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.10batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 73.86batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 73.83batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 73.89batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 73.83batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 73.99batch/s] 44%|███████████▉               | 449/1014 [00:06<00:07, 73.99batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 74.16batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.19batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.50batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 74.71batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.60batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 74.45batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 74.44batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 74.26batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 74.31batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 74.25batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 74.14batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 73.88batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 73.91batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 74.00batch/s] 59%|███████████████▉           | 597/1014 [00:08<00:05, 73.87batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 73.92batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 74.11batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 73.96batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 74.08batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 74.12batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.25batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 74.23batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 74.24batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 74.22batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 74.36batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.41batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 74.52batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.42batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 74.53batch/s] 74%|███████████████████▉       | 747/1014 [00:10<00:03, 74.38batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 74.51batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 74.66batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 74.71batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 74.86batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 74.80batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 74.68batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.71batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 74.63batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 74.67batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 74.80batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 74.74batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 74.76batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 74.63batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 74.67batch/s] 88%|███████████████████████▉   | 897/1014 [00:12<00:01, 74.68batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.61batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.53batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.50batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.57batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 74.55batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 74.54batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 74.64batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.67batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.69batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 74.67batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 74.78batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.79batch/s]
Validation 18 -> LOSS = 1.22
Validation 18 -> BLEU = 52.70, 75.3/58.6/47.1/38.0 (BP=0.994, ratio=0.994, hyp_len=14297, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.22 @ validation 18
--> Best BLEU so far: 52.70 @ validation 18
Starting Epoch 19
Epoch 19 - update       8610 => loss:   1.337 (#OOM: 0)
Epoch 19 - update       8640 => loss:   0.960 (#OOM: 0)
Epoch 19 - update       8670 => loss:   1.189 (#OOM: 0)
Epoch 19 - update       8700 => loss:   1.007 (#OOM: 0)
Epoch 19 - update       8730 => loss:   0.984 (#OOM: 0)
Epoch 19 - update       8760 => loss:   1.233 (#OOM: 0)
Epoch 19 - update       8790 => loss:   1.225 (#OOM: 0)
Epoch 19 - update       8820 => loss:   0.812 (#OOM: 0)
Epoch 19 - update       8850 => loss:   1.098 (#OOM: 0)
Epoch 19 - update       8880 => loss:   0.930 (#OOM: 0)
Epoch 19 - update       8910 => loss:   1.211 (#OOM: 0)
Epoch 19 - update       8940 => loss:   1.224 (#OOM: 0)
Epoch 19 - update       8970 => loss:   0.824 (#OOM: 0)
Epoch 19 - update       9000 => loss:   0.882 (#OOM: 0)
Epoch 19 - update       9030 => loss:   1.021 (#OOM: 0)
Epoch 19 - update       9060 => loss:   0.830 (#OOM: 0)
--> Epoch 19 finished with mean loss 1.00691
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (814 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.72batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 53.02batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.99batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.24batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.06batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.81batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.78batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.86batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.21batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.84batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 70.20batch/s]  4%|█                           | 40/1014 [00:00<00:13, 71.53batch/s]  5%|█▎                          | 49/1014 [00:00<00:13, 72.82batch/s]  6%|█▌                          | 58/1014 [00:00<00:13, 70.62batch/s]  7%|█▊                          | 67/1014 [00:00<00:13, 70.55batch/s]  7%|██                          | 76/1014 [00:01<00:13, 70.97batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 71.67batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 71.51batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 71.37batch/s] 11%|██▉                        | 112/1014 [00:01<00:12, 70.46batch/s] 12%|███▏                       | 121/1014 [00:01<00:13, 67.92batch/s] 13%|███▍                       | 130/1014 [00:01<00:12, 68.82batch/s] 14%|███▋                       | 139/1014 [00:02<00:12, 68.46batch/s] 15%|███▉                       | 148/1014 [00:02<00:12, 68.90batch/s] 15%|████▏                      | 157/1014 [00:02<00:12, 69.24batch/s] 16%|████▍                      | 166/1014 [00:02<00:12, 69.12batch/s] 17%|████▋                      | 175/1014 [00:02<00:12, 69.51batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 69.76batch/s] 19%|█████▏                     | 193/1014 [00:02<00:11, 70.03batch/s] 20%|█████▍                     | 202/1014 [00:02<00:11, 70.36batch/s] 21%|█████▌                     | 211/1014 [00:02<00:11, 70.39batch/s] 22%|█████▊                     | 220/1014 [00:03<00:11, 70.35batch/s] 23%|██████                     | 229/1014 [00:03<00:11, 70.24batch/s] 23%|██████▎                    | 238/1014 [00:03<00:11, 70.27batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 70.60batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 70.83batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 70.88batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 71.20batch/s] 28%|███████▌                   | 283/1014 [00:03<00:10, 71.07batch/s] 29%|███████▊                   | 292/1014 [00:04<00:10, 71.09batch/s] 30%|████████                   | 301/1014 [00:04<00:10, 71.20batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 71.10batch/s] 31%|████████▍                  | 319/1014 [00:04<00:09, 71.32batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 71.48batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 71.37batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 71.19batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:09, 71.29batch/s] 36%|█████████▋                 | 364/1014 [00:05<00:09, 71.56batch/s] 37%|█████████▉                 | 373/1014 [00:05<00:08, 71.63batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 71.42batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 71.53batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 71.81batch/s] 40%|██████████▉                | 409/1014 [00:05<00:08, 71.75batch/s] 41%|███████████▏               | 418/1014 [00:05<00:08, 71.91batch/s] 42%|███████████▎               | 427/1014 [00:05<00:08, 72.08batch/s] 43%|███████████▌               | 436/1014 [00:06<00:08, 72.09batch/s] 44%|███████████▊               | 445/1014 [00:06<00:07, 71.95batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 71.91batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 71.84batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 71.95batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 72.04batch/s] 48%|█████████████              | 490/1014 [00:06<00:07, 72.14batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:07, 72.21batch/s] 50%|█████████████▌             | 508/1014 [00:07<00:06, 72.31batch/s] 51%|█████████████▊             | 517/1014 [00:07<00:06, 72.35batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 72.48batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 72.62batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 72.79batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 72.71batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 72.72batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:06, 72.68batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 72.67batch/s] 58%|███████████████▋           | 589/1014 [00:08<00:05, 72.65batch/s] 59%|███████████████▉           | 598/1014 [00:08<00:05, 72.76batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 72.67batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 72.72batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 72.71batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 72.74batch/s] 63%|█████████████████          | 643/1014 [00:08<00:05, 72.81batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 72.79batch/s] 65%|█████████████████▌         | 661/1014 [00:09<00:04, 72.32batch/s] 66%|█████████████████▊         | 670/1014 [00:09<00:04, 72.23batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 72.19batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 72.38batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 72.32batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 72.51batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:04, 72.59batch/s] 72%|███████████████████▍       | 729/1014 [00:10<00:03, 72.66batch/s] 73%|███████████████████▋       | 739/1014 [00:10<00:03, 72.62batch/s] 74%|███████████████████▉       | 749/1014 [00:10<00:03, 72.79batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 72.84batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 72.98batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 73.10batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 73.07batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 73.01batch/s] 80%|█████████████████████▌     | 809/1014 [00:11<00:02, 73.10batch/s] 81%|█████████████████████▊     | 819/1014 [00:11<00:02, 73.01batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 73.11batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 73.01batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 73.01batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 73.07batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 73.09batch/s] 87%|███████████████████████▍   | 879/1014 [00:12<00:01, 73.05batch/s] 88%|███████████████████████▋   | 889/1014 [00:12<00:01, 73.05batch/s] 89%|███████████████████████▉   | 899/1014 [00:12<00:01, 73.20batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 73.24batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 73.21batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 73.28batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:01, 73.24batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 73.23batch/s] 95%|█████████████████████████▌ | 959/1014 [00:13<00:00, 73.24batch/s] 96%|█████████████████████████▊ | 969/1014 [00:13<00:00, 73.14batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 73.23batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 73.26batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 73.27batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 73.28batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.32batch/s]
Validation 19 -> LOSS = 1.20
Validation 19 -> BLEU = 52.23, 74.2/57.9/46.4/37.4 (BP=1.000, ratio=1.014, hyp_len=14589, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.20 @ validation 19
--> Best BLEU so far: 52.70 @ validation 18
Starting Epoch 20
Epoch 20 - update       9090 => loss:   0.844 (#OOM: 0)
Epoch 20 - update       9120 => loss:   0.855 (#OOM: 0)
Epoch 20 - update       9150 => loss:   0.838 (#OOM: 0)
Epoch 20 - update       9180 => loss:   0.756 (#OOM: 0)
Epoch 20 - update       9210 => loss:   0.686 (#OOM: 0)
Epoch 20 - update       9240 => loss:   1.125 (#OOM: 0)
Epoch 20 - update       9270 => loss:   0.500 (#OOM: 0)
Epoch 20 - update       9300 => loss:   1.019 (#OOM: 0)
Epoch 20 - update       9330 => loss:   1.019 (#OOM: 0)
Epoch 20 - update       9360 => loss:   1.270 (#OOM: 0)
Epoch 20 - update       9390 => loss:   1.082 (#OOM: 0)
Epoch 20 - update       9420 => loss:   1.057 (#OOM: 0)
Epoch 20 - update       9450 => loss:   1.075 (#OOM: 0)
Epoch 20 - update       9480 => loss:   1.227 (#OOM: 0)
Epoch 20 - update       9510 => loss:   0.930 (#OOM: 0)
Epoch 20 - update       9540 => loss:   0.805 (#OOM: 0)
--> Epoch 20 finished with mean loss 0.97598
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (767 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.34batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.37batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.73batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.08batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 49.65batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.68batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.48batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.77batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 77.16batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 75.04batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 76.55batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 76.49batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 77.93batch/s]  7%|█▉                          | 71/1014 [00:00<00:11, 79.27batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 79.39batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 78.84batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 78.35batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 77.49batch/s] 11%|███                        | 116/1014 [00:01<00:11, 78.18batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 78.37batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 77.60batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 78.01batch/s] 15%|████                       | 152/1014 [00:01<00:11, 77.32batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.94batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.64batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 77.17batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 77.36batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 77.00batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 76.75batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.58batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 76.78batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 76.32batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 76.14batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 76.32batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 76.52batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 76.29batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.10batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 76.39batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 76.43batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 76.28batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.41batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.29batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.37batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 75.55batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.62batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 75.53batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.45batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 75.29batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.35batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.31batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.21batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.30batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 75.31batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 75.22batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 75.35batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 75.30batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 75.36batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 75.53batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.63batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 75.60batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.44batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 74.65batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 74.82batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 75.01batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 75.01batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 75.07batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 75.01batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 74.93batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.10batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.99batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.98batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 74.87batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.85batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 74.94batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 74.85batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 74.95batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 75.11batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 75.11batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 75.18batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 75.10batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 75.00batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 74.82batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 74.74batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 74.77batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 74.86batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 74.98batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 74.91batch/s] 74%|███████████████████▉       | 749/1014 [00:10<00:03, 74.88batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 74.95batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 74.97batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 74.91batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 74.92batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 75.05batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 74.95batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 74.96batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 74.80batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 74.89batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 74.84batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 74.92batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 74.97batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 74.87batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 74.93batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 75.02batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 75.11batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 74.99batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 75.04batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:00, 75.09batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 75.09batch/s] 95%|█████████████████████████▌ | 959/1014 [00:12<00:00, 75.04batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 75.16batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 75.08batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 75.06batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 75.08batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 75.06batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.03batch/s]
Validation 20 -> LOSS = 1.21
Validation 20 -> BLEU = 53.34, 75.6/59.3/47.8/38.5 (BP=0.996, ratio=0.996, hyp_len=14320, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.20 @ validation 19
--> Best BLEU so far: 53.34 @ validation 20
Starting Epoch 21
Epoch 21 - update       9570 => loss:   0.709 (#OOM: 0)
Epoch 21 - update       9600 => loss:   0.809 (#OOM: 0)
Epoch 21 - update       9630 => loss:   0.757 (#OOM: 0)
Epoch 21 - update       9660 => loss:   0.702 (#OOM: 0)
Epoch 21 - update       9690 => loss:   1.169 (#OOM: 0)
Epoch 21 - update       9720 => loss:   1.184 (#OOM: 0)
Epoch 21 - update       9750 => loss:   1.035 (#OOM: 0)
Epoch 21 - update       9780 => loss:   0.818 (#OOM: 0)
Epoch 21 - update       9810 => loss:   0.568 (#OOM: 0)
Epoch 21 - update       9840 => loss:   1.331 (#OOM: 0)
Epoch 21 - update       9870 => loss:   0.804 (#OOM: 0)
Epoch 21 - update       9900 => loss:   0.897 (#OOM: 0)
Epoch 21 - update       9930 => loss:   0.385 (#OOM: 0)
Epoch 21 - update       9960 => loss:   0.892 (#OOM: 0)
Epoch 21 - update       9990 => loss:   0.836 (#OOM: 0)
--> Epoch 21 finished with mean loss 0.95067
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (765 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.93batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.25batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.86batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.32batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.52batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.42batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.52batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.63batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.07batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 74.53batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 73.96batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 73.17batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 72.01batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 73.32batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 73.91batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 73.89batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.12batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 73.97batch/s] 11%|███                        | 114/1014 [00:01<00:12, 74.37batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.06batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 75.02batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 75.98batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.38batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.25batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 76.00batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 75.83batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 75.79batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 75.64batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 76.03batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.24batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.23batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.42batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 75.58batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 75.42batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 75.36batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 74.92batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 74.93batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 74.96batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 74.93batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.02batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.11batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.21batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 75.03batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 74.83batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 74.47batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 74.70batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 74.78batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 74.88batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 74.98batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 74.78batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.64batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.77batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.81batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 73.92batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 73.93batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 73.76batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 73.89batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 73.92batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 73.74batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 73.81batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 73.76batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 73.87batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 73.89batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 73.77batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 73.69batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 73.86batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 73.72batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 73.62batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 73.52batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 73.67batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 73.59batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 73.76batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 73.88batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 73.96batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 74.08batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 73.98batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 74.11batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.14batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 74.14batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 74.07batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 73.99batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 74.08batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 73.84batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 73.92batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.00batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 74.04batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 74.12batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 74.24batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 74.24batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 74.24batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 74.24batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 74.26batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.25batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.19batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.30batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.17batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 74.22batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 74.22batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.30batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.38batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 74.29batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.26batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.22batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.19batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 74.22batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.26batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.25batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.22batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.08batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.13batch/s]
Validation 21 -> LOSS = 1.19
Validation 21 -> BLEU = 53.08, 75.5/58.8/47.1/38.0 (BP=1.000, ratio=1.001, hyp_len=14401, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.19 @ validation 21
--> Best BLEU so far: 53.34 @ validation 20
Starting Epoch 22
Epoch 22 - update      10020 => loss:   0.831 (#OOM: 0)
Epoch 22 - update      10050 => loss:   0.571 (#OOM: 0)
Epoch 22 - update      10080 => loss:   0.349 (#OOM: 0)
Epoch 22 - update      10110 => loss:   0.713 (#OOM: 0)
Epoch 22 - update      10140 => loss:   0.853 (#OOM: 0)
Epoch 22 - update      10170 => loss:   0.832 (#OOM: 0)
Epoch 22 - update      10200 => loss:   1.229 (#OOM: 0)
Epoch 22 - update      10230 => loss:   0.851 (#OOM: 0)
Epoch 22 - update      10260 => loss:   0.949 (#OOM: 0)
Epoch 22 - update      10290 => loss:   0.987 (#OOM: 0)
Epoch 22 - update      10320 => loss:   0.931 (#OOM: 0)
Epoch 22 - update      10350 => loss:   0.791 (#OOM: 0)
Epoch 22 - update      10380 => loss:   1.045 (#OOM: 0)
Epoch 22 - update      10410 => loss:   0.971 (#OOM: 0)
Epoch 22 - update      10440 => loss:   1.064 (#OOM: 0)
Epoch 22 - update      10470 => loss:   1.048 (#OOM: 0)
--> Epoch 22 finished with mean loss 0.92437
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (805 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.64batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.31batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.00batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 47.58batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.36batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.31batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 69.80batch/s]  1%|▍                           | 15/1014 [00:00<00:13, 74.18batch/s]  2%|▋                           | 24/1014 [00:00<00:12, 77.99batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 77.30batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 74.04batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 73.57batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 74.12batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 74.90batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 74.62batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 75.57batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 76.21batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 76.05batch/s] 11%|███                        | 114/1014 [00:01<00:11, 75.53batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 74.83batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 74.99batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 75.28batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 75.08batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 74.71batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 74.90batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 74.03batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.22batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 74.48batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 74.92batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 75.38batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.99batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 75.26batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 74.94batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 74.26batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 73.92batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 73.93batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 73.87batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 73.38batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 73.77batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 73.98batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 74.23batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.77batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 74.61batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 74.47batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 74.59batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 74.91batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 75.09batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 75.23batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 75.29batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 75.22batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.31batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 75.39batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 75.37batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 75.48batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 75.43batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 75.42batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 75.41batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 75.55batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 75.58batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 75.55batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 75.71batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 75.55batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 75.41batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 75.24batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 75.36batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 75.34batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 75.47batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 75.66batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 75.65batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 75.58batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.42batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 75.18batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 75.23batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 75.25batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 75.32batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 75.36batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 75.25batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 75.08batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 75.14batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 75.18batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 75.24batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 75.35batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 75.43batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 75.47batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 75.34batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 75.21batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 75.17batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.30batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.25batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 75.29batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 75.36batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.41batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 75.43batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.48batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 75.48batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 75.54batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 75.50batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 75.59batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 75.68batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 75.70batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.78batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.74batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.78batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.82batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.76batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.68batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.76batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 75.76batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.85batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.74batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.60batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.56batch/s]
Validation 22 -> LOSS = 1.19
Validation 22 -> BLEU = 53.30, 76.2/59.5/47.8/38.5 (BP=0.991, ratio=0.991, hyp_len=14259, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.19 @ validation 22
--> Best BLEU so far: 53.34 @ validation 20
Starting Epoch 23
Epoch 23 - update      10500 => loss:   0.839 (#OOM: 0)
Epoch 23 - update      10530 => loss:   0.797 (#OOM: 0)
Epoch 23 - update      10560 => loss:   1.176 (#OOM: 0)
Epoch 23 - update      10590 => loss:   1.033 (#OOM: 0)
Epoch 23 - update      10620 => loss:   0.692 (#OOM: 0)
Epoch 23 - update      10650 => loss:   0.696 (#OOM: 0)
Epoch 23 - update      10680 => loss:   0.919 (#OOM: 0)
Epoch 23 - update      10710 => loss:   0.683 (#OOM: 0)
Epoch 23 - update      10740 => loss:   0.789 (#OOM: 0)
Epoch 23 - update      10770 => loss:   0.821 (#OOM: 0)
Epoch 23 - update      10800 => loss:   0.720 (#OOM: 0)
Epoch 23 - update      10830 => loss:   0.740 (#OOM: 0)
Epoch 23 - update      10860 => loss:   0.884 (#OOM: 0)
Epoch 23 - update      10890 => loss:   0.670 (#OOM: 0)
Epoch 23 - update      10920 => loss:   0.963 (#OOM: 0)
Epoch 23 - update      10950 => loss:   0.696 (#OOM: 0)
--> Epoch 23 finished with mean loss 0.90011
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (885 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 36.80batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.07batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.79batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.71batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 49.64batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.07batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.69batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.36batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.14batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 75.08batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 75.75batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 76.35batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 76.12batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 74.41batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 74.01batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 73.10batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 73.10batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 73.18batch/s] 11%|███                        | 115/1014 [00:01<00:12, 73.27batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 73.56batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 74.23batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 74.50batch/s] 15%|████                       | 151/1014 [00:02<00:11, 74.73batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 75.13batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 75.23batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 75.70batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 75.56batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.49batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 75.66batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 75.29batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.18batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 74.88batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.83batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 74.43batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 73.10batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 73.13batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 73.36batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 73.58batch/s] 29%|███████▊                   | 295/1014 [00:04<00:09, 72.93batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 72.90batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 73.15batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 73.06batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 72.99batch/s] 34%|█████████                  | 340/1014 [00:04<00:09, 73.13batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:09, 73.21batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 73.02batch/s] 36%|█████████▊                 | 367/1014 [00:05<00:08, 73.10batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 73.20batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 73.30batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 73.30batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 73.56batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 73.50batch/s] 42%|███████████▏               | 421/1014 [00:05<00:08, 73.58batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 73.60batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 73.66batch/s] 44%|███████████▉               | 448/1014 [00:06<00:07, 73.83batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 73.70batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 73.83batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 73.97batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 73.98batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:07, 74.17batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.14batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 74.04batch/s] 51%|█████████████▊             | 520/1014 [00:07<00:06, 74.02batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 73.84batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 73.92batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 73.83batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 73.94batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 73.90batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 73.94batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 74.04batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.06batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 74.18batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 74.22batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 74.38batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 74.35batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 74.26batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.12batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.10batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 74.19batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.09batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.04batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 74.10batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 74.11batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 74.06batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 74.11batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.13batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 73.61batch/s] 73%|███████████████████▊       | 745/1014 [00:10<00:03, 73.66batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 73.77batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 73.67batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 73.63batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 73.65batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:03, 73.74batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 73.82batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 73.83batch/s] 81%|█████████████████████▊     | 817/1014 [00:11<00:02, 73.79batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 73.85batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 73.77batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 73.83batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 73.80batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 73.77batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 73.72batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 73.65batch/s] 88%|███████████████████████▋   | 889/1014 [00:12<00:01, 73.71batch/s] 89%|███████████████████████▉   | 898/1014 [00:12<00:01, 73.71batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 73.71batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 73.69batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 73.86batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 73.91batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 73.89batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 73.98batch/s] 95%|█████████████████████████▋ | 966/1014 [00:13<00:00, 74.00batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.08batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.12batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.13batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.28batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.18batch/s]
Validation 23 -> LOSS = 1.18
Validation 23 -> BLEU = 53.40, 75.3/59.0/47.6/38.4 (BP=1.000, ratio=1.004, hyp_len=14443, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.18 @ validation 23
--> Best BLEU so far: 53.40 @ validation 23
Starting Epoch 24
Epoch 24 - update      10980 => loss:   0.856 (#OOM: 0)
Epoch 24 - update      11010 => loss:   0.907 (#OOM: 0)
Epoch 24 - update      11040 => loss:   0.918 (#OOM: 0)
Epoch 24 - update      11070 => loss:   0.704 (#OOM: 0)
Epoch 24 - update      11100 => loss:   1.183 (#OOM: 0)
Epoch 24 - update      11130 => loss:   0.812 (#OOM: 0)
Epoch 24 - update      11160 => loss:   0.721 (#OOM: 0)
Epoch 24 - update      11190 => loss:   0.775 (#OOM: 0)
Epoch 24 - update      11220 => loss:   0.779 (#OOM: 0)
Epoch 24 - update      11250 => loss:   0.729 (#OOM: 0)
Epoch 24 - update      11280 => loss:   0.574 (#OOM: 0)
Epoch 24 - update      11310 => loss:   0.897 (#OOM: 0)
Epoch 24 - update      11340 => loss:   1.033 (#OOM: 0)
Epoch 24 - update      11370 => loss:   1.131 (#OOM: 0)
Epoch 24 - update      11400 => loss:   0.991 (#OOM: 0)
Epoch 24 - update      11430 => loss:   0.966 (#OOM: 0)
--> Epoch 24 finished with mean loss 0.87852
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (796 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 55.69batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.70batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 48.74batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 50.31batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.97batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.51batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.54batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 84.08batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.96batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 80.77batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.82batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 77.13batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 78.75batch/s]  7%|██                          | 74/1014 [00:00<00:11, 79.23batch/s]  8%|██▎                         | 84/1014 [00:01<00:11, 77.99batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 78.17batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 77.09batch/s] 11%|███                        | 114/1014 [00:01<00:11, 76.53batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 77.52batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 78.20batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 77.67batch/s] 15%|████                       | 154/1014 [00:01<00:11, 78.08batch/s] 16%|████▎                      | 164/1014 [00:02<00:10, 78.73batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 77.63batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 77.29batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 77.04batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 77.01batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 76.79batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 76.37batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 76.05batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 75.56batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 75.63batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 75.80batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 75.88batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.86batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 76.00batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 76.59batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 76.73batch/s] 32%|████████▋                  | 327/1014 [00:04<00:08, 76.68batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 76.53batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 76.62batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 76.34batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 76.46batch/s] 38%|██████████▏                | 382/1014 [00:04<00:08, 76.71batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 76.85batch/s] 40%|██████████▊                | 404/1014 [00:05<00:07, 77.01batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 77.02batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 77.14batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 77.11batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 76.85batch/s] 45%|████████████▏              | 459/1014 [00:05<00:07, 76.53batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 76.29batch/s] 47%|████████████▊              | 481/1014 [00:06<00:06, 76.43batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 76.53batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 76.61batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 76.26batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 76.29batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 76.37batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 76.40batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 76.34batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 76.39batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 76.53batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 76.54batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 76.72batch/s] 60%|████████████████▎          | 613/1014 [00:07<00:05, 76.70batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 76.73batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 76.79batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 76.62batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 76.67batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 76.60batch/s] 67%|██████████████████         | 679/1014 [00:08<00:04, 76.54batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 76.51batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 76.24batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 76.12batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 76.09batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 76.00batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 76.03batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 76.05batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 76.01batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.95batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:02, 76.02batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 76.08batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 75.96batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 75.99batch/s] 82%|██████████████████████▏    | 833/1014 [00:10<00:02, 75.90batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.83batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.76batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.76batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.83batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.97batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 76.00batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 76.02batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 76.02batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.87batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.90batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.78batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.78batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.90batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.87batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.90batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 75.93batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.96batch/s]
Validation 24 -> LOSS = 1.18
Validation 24 -> BLEU = 54.70, 77.3/61.1/49.7/40.7 (BP=0.984, ratio=0.984, hyp_len=14148, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.18 @ validation 24
--> Best BLEU so far: 54.70 @ validation 24
Starting Epoch 25
Epoch 25 - update      11460 => loss:   0.637 (#OOM: 0)
Epoch 25 - update      11490 => loss:   1.106 (#OOM: 0)
Epoch 25 - update      11520 => loss:   0.649 (#OOM: 0)
Epoch 25 - update      11550 => loss:   0.758 (#OOM: 0)
Epoch 25 - update      11580 => loss:   1.076 (#OOM: 0)
Epoch 25 - update      11610 => loss:   0.800 (#OOM: 0)
Epoch 25 - update      11640 => loss:   0.860 (#OOM: 0)
Epoch 25 - update      11670 => loss:   0.904 (#OOM: 0)
Epoch 25 - update      11700 => loss:   0.748 (#OOM: 0)
Epoch 25 - update      11730 => loss:   0.546 (#OOM: 0)
Epoch 25 - update      11760 => loss:   0.759 (#OOM: 0)
Epoch 25 - update      11790 => loss:   0.813 (#OOM: 0)
Epoch 25 - update      11820 => loss:   0.849 (#OOM: 0)
Epoch 25 - update      11850 => loss:   1.036 (#OOM: 0)
Epoch 25 - update      11880 => loss:   0.952 (#OOM: 0)
Epoch 25 - update      11910 => loss:   0.509 (#OOM: 0)
--> Epoch 25 finished with mean loss 0.85489
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (808 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.97batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.66batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 49.47batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.73batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 48.51batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.65batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.62batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.18batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 77.12batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 73.75batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 73.63batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 73.37batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 73.77batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 70.82batch/s]  7%|█▉                          | 71/1014 [00:00<00:13, 72.17batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 73.47batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 73.09batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 73.12batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 72.80batch/s] 11%|███                        | 116/1014 [00:01<00:12, 72.68batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 72.05batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 72.62batch/s] 14%|███▊                       | 143/1014 [00:02<00:12, 69.71batch/s] 15%|████                       | 152/1014 [00:02<00:12, 70.42batch/s] 16%|████▎                      | 161/1014 [00:02<00:12, 70.89batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 71.34batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 71.08batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 71.51batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 71.85batch/s] 20%|█████▍                     | 206/1014 [00:02<00:11, 72.15batch/s] 21%|█████▋                     | 215/1014 [00:02<00:11, 72.45batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 72.25batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 72.89batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 72.89batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 73.11batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 72.91batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 72.82batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 73.03batch/s] 29%|███████▊                   | 294/1014 [00:04<00:09, 73.12batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 73.12batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 73.17batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 72.95batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 73.19batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:09, 73.48batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 73.59batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 73.95batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.07batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 73.99batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 73.56batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 73.40batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 73.33batch/s] 42%|███████████▎               | 424/1014 [00:05<00:08, 73.69batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 73.82batch/s] 44%|███████████▊               | 444/1014 [00:06<00:07, 73.56batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 73.55batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 73.62batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 73.81batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 73.73batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 73.93batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 73.96batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 73.97batch/s] 52%|█████████████▉             | 524/1014 [00:07<00:06, 74.21batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 74.20batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 74.45batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 74.58batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 74.66batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 74.77batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.84batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.89batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 74.86batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 74.96batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.02batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.17batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.06batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.00batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.01batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 74.84batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.93batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 74.83batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 74.87batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 74.90batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.93batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.02batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.12batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.95batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.87batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.00batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.60batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 74.51batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.45batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.35batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.29batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.28batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.23batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.24batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.33batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.14batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.20batch/s] 88%|███████████████████████▊   | 894/1014 [00:12<00:01, 74.20batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.35batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.21batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.10batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.06batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 73.93batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 73.98batch/s] 95%|█████████████████████████▋ | 964/1014 [00:13<00:00, 73.87batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 73.93batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.00batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.13batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.07batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.03batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.02batch/s]
Validation 25 -> LOSS = 1.18
Validation 25 -> BLEU = 53.30, 74.9/58.8/47.6/38.5 (BP=1.000, ratio=1.013, hyp_len=14565, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.18 @ validation 24
--> Best BLEU so far: 54.70 @ validation 24
Starting Epoch 26
Epoch 26 - update      11940 => loss:   0.895 (#OOM: 0)
Epoch 26 - update      11970 => loss:   0.667 (#OOM: 0)
Epoch 26 - update      12000 => loss:   0.622 (#OOM: 0)
Epoch 26 - update      12030 => loss:   0.861 (#OOM: 0)
Epoch 26 - update      12060 => loss:   0.943 (#OOM: 0)
Epoch 26 - update      12090 => loss:   0.960 (#OOM: 0)
Epoch 26 - update      12120 => loss:   0.709 (#OOM: 0)
Epoch 26 - update      12150 => loss:   0.709 (#OOM: 0)
Epoch 26 - update      12180 => loss:   0.867 (#OOM: 0)
Epoch 26 - update      12210 => loss:   0.930 (#OOM: 0)
Epoch 26 - update      12240 => loss:   0.796 (#OOM: 0)
Epoch 26 - update      12270 => loss:   0.742 (#OOM: 0)
Epoch 26 - update      12300 => loss:   0.720 (#OOM: 0)
Epoch 26 - update      12330 => loss:   0.907 (#OOM: 0)
Epoch 26 - update      12360 => loss:   0.681 (#OOM: 0)
Epoch 26 - update      12390 => loss:   0.866 (#OOM: 0)
--> Epoch 26 finished with mean loss 0.84018
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (794 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.07batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 47.28batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.55batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.37batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.81batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.88batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.93batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 71.70batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 70.68batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 74.85batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 74.81batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 73.00batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 74.15batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 73.23batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 72.96batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 74.17batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.62batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 74.87batch/s] 11%|███                        | 115/1014 [00:01<00:11, 75.84batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 75.57batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.42batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 73.95batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 73.64batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 73.93batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 73.44batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 73.91batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 74.75batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.66batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.39batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 75.75batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 75.89batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 76.32batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 75.82batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 75.69batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 75.85batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.72batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.85batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.54batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.29batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 75.21batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 75.16batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 75.31batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 75.46batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.21batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 75.16batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.14batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.09batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.98batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 74.77batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.02batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.13batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 75.01batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.05batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.82batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 74.95batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 75.12batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.25batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 75.23batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 75.36batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.40batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 75.51batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.47batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.48batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.52batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.69batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.70batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 75.63batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 75.57batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 75.58batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.50batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.33batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.30batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.23batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.97batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.82batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.79batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.78batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.84batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 74.84batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.82batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.98batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.09batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 75.11batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.10batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.14batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.11batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.24batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.32batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.28batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.12batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.13batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.16batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.09batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.17batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.31batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.15batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.25batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 75.26batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.39batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.35batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.44batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.38batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.41batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.40batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.40batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 75.39batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.44batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.54batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.53batch/s]
Validation 26 -> LOSS = 1.18
Validation 26 -> BLEU = 54.30, 76.6/60.3/49.0/40.0 (BP=0.990, ratio=0.990, hyp_len=14237, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.18 @ validation 26
--> Best BLEU so far: 54.70 @ validation 24
Starting Epoch 27
Epoch 27 - update      12420 => loss:   0.619 (#OOM: 0)
Epoch 27 - update      12450 => loss:   0.728 (#OOM: 0)
Epoch 27 - update      12480 => loss:   0.734 (#OOM: 0)
Epoch 27 - update      12510 => loss:   0.831 (#OOM: 0)
Epoch 27 - update      12540 => loss:   0.706 (#OOM: 0)
Epoch 27 - update      12570 => loss:   0.767 (#OOM: 0)
Epoch 27 - update      12600 => loss:   0.798 (#OOM: 0)
Epoch 27 - update      12630 => loss:   0.528 (#OOM: 0)
Epoch 27 - update      12660 => loss:   0.636 (#OOM: 0)
Epoch 27 - update      12690 => loss:   0.865 (#OOM: 0)
Epoch 27 - update      12720 => loss:   0.681 (#OOM: 0)
Epoch 27 - update      12750 => loss:   1.071 (#OOM: 0)
Epoch 27 - update      12780 => loss:   0.688 (#OOM: 0)
Epoch 27 - update      12810 => loss:   1.231 (#OOM: 0)
Epoch 27 - update      12840 => loss:   0.865 (#OOM: 0)
Epoch 27 - update      12870 => loss:   0.649 (#OOM: 0)
--> Epoch 27 finished with mean loss 0.81849
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.56 mins)   (913 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.04batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 45.98batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.30batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 48.99batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.19batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.32batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.30batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.99batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.55batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 77.01batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 73.68batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 74.02batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 75.94batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 74.28batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 75.03batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 75.17batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 75.55batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 76.44batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 76.63batch/s] 11%|███                        | 116/1014 [00:01<00:11, 76.48batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 75.26batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.50batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 76.20batch/s] 15%|████                       | 153/1014 [00:01<00:11, 77.07batch/s] 16%|████▎                      | 163/1014 [00:02<00:10, 77.77batch/s] 17%|████▌                      | 173/1014 [00:02<00:10, 77.48batch/s] 18%|████▊                      | 183/1014 [00:02<00:10, 77.53batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 77.93batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 77.75batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 77.83batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 78.19batch/s] 23%|██████▏                    | 233/1014 [00:02<00:09, 78.12batch/s] 24%|██████▍                    | 243/1014 [00:03<00:09, 77.84batch/s] 25%|██████▋                    | 253/1014 [00:03<00:09, 77.24batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 76.89batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 76.90batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 76.44batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 76.30batch/s] 30%|████████                   | 303/1014 [00:03<00:09, 76.26batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 76.08batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 76.28batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 75.84batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 75.34batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 75.43batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 75.79batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 75.55batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 75.58batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 75.79batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.76batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.69batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.48batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.28batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.39batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.84batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.82batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.90batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.95batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.16batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.13batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.03batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.08batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.24batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.15batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.25batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 75.15batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.01batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.00batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.10batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.91batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 74.69batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 74.69batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 74.58batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 74.63batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 74.52batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.56batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.47batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 74.50batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.57batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 74.54batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 74.48batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 74.64batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 74.70batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 74.77batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 74.62batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 74.67batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.81batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 74.82batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 74.71batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 74.80batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 74.75batch/s] 81%|█████████████████████▉     | 823/1014 [00:11<00:02, 74.63batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.62batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.64batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.62batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 74.69batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 74.71batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 74.40batch/s] 88%|███████████████████████▊   | 893/1014 [00:12<00:01, 74.38batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 74.49batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 74.43batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 74.33batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 74.38batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 74.40batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 74.43batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 74.48batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 74.47batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 74.47batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 74.53batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 74.54batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 74.60batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.59batch/s]
Validation 27 -> LOSS = 1.17
Validation 27 -> BLEU = 54.13, 75.8/59.5/48.3/39.4 (BP=1.000, ratio=1.007, hyp_len=14484, ref_len=14382)
** Learning rate changed -> 0.0002
Saving best model based on LOSS
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.17 @ validation 27
--> Best BLEU so far: 54.70 @ validation 24
Starting Epoch 28
Epoch 28 - update      12900 => loss:   0.596 (#OOM: 0)
Epoch 28 - update      12930 => loss:   1.130 (#OOM: 0)
Epoch 28 - update      12960 => loss:   0.538 (#OOM: 0)
Epoch 28 - update      12990 => loss:   0.858 (#OOM: 0)
Epoch 28 - update      13020 => loss:   0.873 (#OOM: 0)
Epoch 28 - update      13050 => loss:   0.814 (#OOM: 0)
Epoch 28 - update      13080 => loss:   0.692 (#OOM: 0)
Epoch 28 - update      13110 => loss:   0.622 (#OOM: 0)
Epoch 28 - update      13140 => loss:   0.708 (#OOM: 0)
Epoch 28 - update      13170 => loss:   0.819 (#OOM: 0)
Epoch 28 - update      13200 => loss:   0.710 (#OOM: 0)
Epoch 28 - update      13230 => loss:   0.578 (#OOM: 0)
Epoch 28 - update      13260 => loss:   0.502 (#OOM: 0)
Epoch 28 - update      13290 => loss:   0.729 (#OOM: 0)
Epoch 28 - update      13320 => loss:   0.613 (#OOM: 0)
Epoch 28 - update      13350 => loss:   0.685 (#OOM: 0)
--> Epoch 28 finished with mean loss 0.76835
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (766 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 40.99batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.09batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.54batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.37batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.00batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.94batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 93.57batch/s]  2%|▌                           | 20/1014 [00:00<00:11, 86.52batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 86.86batch/s]  4%|█                           | 40/1014 [00:00<00:11, 85.76batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 84.44batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 86.22batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 83.60batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 83.52batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 83.18batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 82.11batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 81.91batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 82.19batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 80.89batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 80.38batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 80.10batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 80.01batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 79.96batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 79.90batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 80.30batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 80.05batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 79.50batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 79.56batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 79.42batch/s] 24%|██████▍                    | 240/1014 [00:03<00:09, 79.43batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 79.69batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 79.39batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 79.05batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 78.76batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 78.66batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 78.55batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 78.25batch/s] 32%|████████▌                  | 320/1014 [00:04<00:08, 77.97batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 77.86batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 77.59batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 77.70batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 77.70batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 77.15batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 77.06batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 77.16batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 77.24batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 77.28batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 77.43batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 77.41batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 77.22batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 77.46batch/s] 45%|████████████▏              | 460/1014 [00:05<00:07, 77.36batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 77.29batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 77.13batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 76.80batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 76.67batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 76.78batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 76.78batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 76.84batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.82batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 77.03batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 77.11batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 76.99batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 77.04batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 76.76batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 76.66batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 76.69batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 76.63batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 76.54batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 76.51batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 76.49batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 76.40batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 76.15batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 75.97batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 76.13batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 76.08batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 75.83batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.73batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 75.65batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.50batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 75.58batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.66batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 75.56batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.29batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.24batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.23batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.20batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.21batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 75.24batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.28batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.11batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.12batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.16batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.25batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.24batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.02batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 74.93batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 74.78batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 74.78batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 74.65batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 74.67batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 74.48batch/s] 96%|█████████████████████████▊ | 970/1014 [00:13<00:00, 74.43batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 74.39batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 74.49batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 74.55batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 74.63batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.61batch/s]
Validation 28 -> LOSS = 1.16
Validation 28 -> BLEU = 55.00, 76.6/60.6/49.2/40.1 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.16 @ validation 28
--> Best BLEU so far: 55.00 @ validation 28
Starting Epoch 29
Epoch 29 - update      13380 => loss:   0.792 (#OOM: 0)
Epoch 29 - update      13410 => loss:   0.692 (#OOM: 0)
Epoch 29 - update      13440 => loss:   0.777 (#OOM: 0)
Epoch 29 - update      13470 => loss:   0.582 (#OOM: 0)
Epoch 29 - update      13500 => loss:   0.661 (#OOM: 0)
Epoch 29 - update      13530 => loss:   0.888 (#OOM: 0)
Epoch 29 - update      13560 => loss:   0.694 (#OOM: 0)
Epoch 29 - update      13590 => loss:   0.775 (#OOM: 0)
Epoch 29 - update      13620 => loss:   0.828 (#OOM: 0)
Epoch 29 - update      13650 => loss:   0.950 (#OOM: 0)
Epoch 29 - update      13680 => loss:   0.699 (#OOM: 0)
Epoch 29 - update      13710 => loss:   0.630 (#OOM: 0)
Epoch 29 - update      13740 => loss:   0.820 (#OOM: 0)
Epoch 29 - update      13770 => loss:   0.649 (#OOM: 0)
Epoch 29 - update      13800 => loss:   0.634 (#OOM: 0)
Epoch 29 - update      13830 => loss:   0.686 (#OOM: 0)
--> Epoch 29 finished with mean loss 0.74935
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.68 mins)   (762 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 55.69batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.39batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.64batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.13batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.94batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.26batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 80.97batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 77.70batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.36batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 75.23batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 73.12batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 73.38batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 73.40batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 73.33batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.42batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.38batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.39batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 75.90batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.09batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.57batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.74batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.30batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.11batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.90batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.22batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 73.19batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.18batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.62batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 74.04batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.30batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.22batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.30batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.67batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.63batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 74.83batch/s] 27%|███████▏                   | 270/1014 [00:03<00:10, 74.21batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 74.24batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 74.36batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 74.65batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 74.67batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.68batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.93batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.76batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 74.78batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 74.67batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 74.70batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 74.49batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 74.53batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.32batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.52batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.33batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.19batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.06batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 74.36batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 74.30batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 74.35batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 74.41batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.44batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 74.42batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 74.43batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 74.46batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.50batch/s] 52%|█████████████▉             | 523/1014 [00:07<00:06, 74.46batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 74.57batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 74.58batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 74.78batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 74.86batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 74.99batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 74.84batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 74.68batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.59batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 74.64batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 74.69batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 74.53batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 74.55batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 74.49batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.69batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.68batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 74.77batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.89batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 74.93batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 74.89batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.00batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.03batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 74.87batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 74.85batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 74.69batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 74.86batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 74.81batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 74.88batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 74.78batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 74.78batch/s] 81%|█████████████████████▉     | 823/1014 [00:11<00:02, 74.74batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 74.67batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.57batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.56batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 74.57batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 74.57batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 74.54batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 74.67batch/s] 89%|████████████████████████   | 903/1014 [00:12<00:01, 74.78batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 74.73batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 74.76batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 74.78batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 74.89batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 74.84batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 74.87batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 74.89batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 74.84batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 74.77batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 74.82batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 74.78batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.77batch/s]
Validation 29 -> LOSS = 1.15
Validation 29 -> BLEU = 54.83, 76.3/60.2/49.1/40.1 (BP=1.000, ratio=1.000, hyp_len=14385, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.00 @ validation 28
Starting Epoch 30
Epoch 30 - update      13860 => loss:   0.661 (#OOM: 0)
Epoch 30 - update      13890 => loss:   0.979 (#OOM: 0)
Epoch 30 - update      13920 => loss:   0.750 (#OOM: 0)
Epoch 30 - update      13950 => loss:   0.711 (#OOM: 0)
Epoch 30 - update      13980 => loss:   0.925 (#OOM: 0)
Epoch 30 - update      14010 => loss:   0.626 (#OOM: 0)
Epoch 30 - update      14040 => loss:   0.695 (#OOM: 0)
Epoch 30 - update      14070 => loss:   0.598 (#OOM: 0)
Epoch 30 - update      14100 => loss:   0.545 (#OOM: 0)
Epoch 30 - update      14130 => loss:   0.968 (#OOM: 0)
Epoch 30 - update      14160 => loss:   0.853 (#OOM: 0)
Epoch 30 - update      14190 => loss:   0.865 (#OOM: 0)
Epoch 30 - update      14220 => loss:   0.711 (#OOM: 0)
Epoch 30 - update      14250 => loss:   0.907 (#OOM: 0)
Epoch 30 - update      14280 => loss:   0.480 (#OOM: 0)
Epoch 30 - update      14310 => loss:   0.724 (#OOM: 0)
--> Epoch 30 finished with mean loss 0.73737
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (826 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.01batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.39batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.84batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.28batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 52.28batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.45batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 65.20batch/s]  1%|▍                           | 15/1014 [00:00<00:13, 72.23batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 72.73batch/s]  3%|▉                           | 32/1014 [00:00<00:12, 75.73batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 74.93batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 76.35batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 76.30batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 74.51batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 74.56batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 75.32batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 76.09batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 76.95batch/s] 11%|███                        | 113/1014 [00:01<00:11, 77.00batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 75.68batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 76.11batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 76.12batch/s] 15%|███▉                       | 149/1014 [00:01<00:11, 76.03batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 76.10batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 75.59batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 76.08batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 75.98batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 74.43batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.76batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 74.42batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 73.75batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 74.09batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 74.00batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 74.23batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 74.11batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 74.45batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.56batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 74.52batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 74.49batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 74.85batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 74.63batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 74.68batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 74.64batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 74.93batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 74.84batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 74.90batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.76batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.75batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.67batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 74.58batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 74.64batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 74.80batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 74.77batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 74.32batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.09batch/s] 44%|███████████▉               | 446/1014 [00:06<00:07, 73.97batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 73.55batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 73.59batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 73.76batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 73.72batch/s] 48%|█████████████              | 491/1014 [00:06<00:07, 73.55batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 73.50batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 73.63batch/s] 51%|█████████████▊             | 518/1014 [00:07<00:06, 73.60batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 73.46batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 73.44batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 73.41batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 73.34batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 73.41batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:06, 73.41batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 73.40batch/s] 58%|███████████████▋           | 590/1014 [00:08<00:05, 73.31batch/s] 59%|███████████████▉           | 599/1014 [00:08<00:05, 73.28batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 73.27batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 73.13batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 73.18batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 73.22batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:05, 73.28batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 73.19batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 73.23batch/s] 66%|█████████████████▊         | 671/1014 [00:09<00:04, 73.13batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 72.94batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 72.73batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 72.91batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 72.86batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 72.94batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 72.89batch/s] 72%|███████████████████▌       | 734/1014 [00:10<00:03, 73.06batch/s] 73%|███████████████████▊       | 743/1014 [00:10<00:03, 72.88batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 72.86batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 72.90batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 73.01batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 73.09batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 73.16batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 73.05batch/s] 79%|█████████████████████▍     | 806/1014 [00:11<00:02, 73.17batch/s] 80%|█████████████████████▋     | 816/1014 [00:11<00:02, 73.31batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 73.19batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 73.16batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 73.32batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 73.27batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:02, 73.31batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 73.36batch/s] 87%|███████████████████████▌   | 886/1014 [00:12<00:01, 73.33batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 73.33batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 73.58batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 73.47batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 73.47batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:01, 73.49batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 73.59batch/s] 95%|█████████████████████████▌ | 962/1014 [00:13<00:00, 73.61batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 73.59batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 73.60batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 73.66batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 73.73batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.78batch/s]
Validation 30 -> LOSS = 1.16
Validation 30 -> BLEU = 54.78, 76.0/60.1/49.1/40.2 (BP=1.000, ratio=1.007, hyp_len=14480, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.00 @ validation 28
Starting Epoch 31
Epoch 31 - update      14340 => loss:   0.771 (#OOM: 0)
Epoch 31 - update      14370 => loss:   0.408 (#OOM: 0)
Epoch 31 - update      14400 => loss:   0.688 (#OOM: 0)
Epoch 31 - update      14430 => loss:   0.718 (#OOM: 0)
Epoch 31 - update      14460 => loss:   0.629 (#OOM: 0)
Epoch 31 - update      14490 => loss:   0.496 (#OOM: 0)
Epoch 31 - update      14520 => loss:   0.610 (#OOM: 0)
Epoch 31 - update      14550 => loss:   0.780 (#OOM: 0)
Epoch 31 - update      14580 => loss:   0.748 (#OOM: 0)
Epoch 31 - update      14610 => loss:   0.800 (#OOM: 0)
Epoch 31 - update      14640 => loss:   0.642 (#OOM: 0)
Epoch 31 - update      14670 => loss:   0.698 (#OOM: 0)
Epoch 31 - update      14700 => loss:   0.764 (#OOM: 0)
Epoch 31 - update      14730 => loss:   0.767 (#OOM: 0)
Epoch 31 - update      14760 => loss:   0.490 (#OOM: 0)
--> Epoch 31 finished with mean loss 0.72692
--> Overhead/Training/Evaluation: 0.03/0.56/0.00 mins (total: 0.59 mins)   (868 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.91batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.93batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 49.42batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.27batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.84batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.11batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.08batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:13, 76.23batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.23batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 75.57batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.22batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.23batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.34batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.01batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 75.02batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 75.00batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.58batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.12batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.00batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.14batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.97batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.91batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 75.94batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 75.81batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 76.06batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 75.60batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 74.80batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 74.97batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.43batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 74.12batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.45batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 74.58batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 74.63batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 74.76batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.78batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.69batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.58batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.81batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.80batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.80batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 74.52batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.22batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:09, 74.03batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 73.86batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 73.96batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.33batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.56batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.81batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.10batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 74.93batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 74.85batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 74.94batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 75.36batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.27batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.39batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.39batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 75.67batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.64batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 75.72batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 75.74batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.73batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 75.42batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.60batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.74batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.83batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.61batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.66batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 75.71batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 75.55batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 75.75batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.63batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.52batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.51batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.40batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.33batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.38batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.49batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.47batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.55batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.36batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.30batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.26batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.31batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 75.23batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.23batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.07batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.97batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.84batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.61batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.76batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.81batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.72batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.71batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.72batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 74.76batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.85batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.67batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 74.75batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.79batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.71batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.77batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.77batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.78batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.92batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.94batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.99batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.90batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.94batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.94batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.97batch/s]
Validation 31 -> LOSS = 1.17
Validation 31 -> BLEU = 55.03, 76.8/60.8/49.6/40.5 (BP=0.995, ratio=0.995, hyp_len=14307, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.03 @ validation 31
Starting Epoch 32
Epoch 32 - update      14790 => loss:   0.976 (#OOM: 0)
Epoch 32 - update      14820 => loss:   0.701 (#OOM: 0)
Epoch 32 - update      14850 => loss:   0.560 (#OOM: 0)
Epoch 32 - update      14880 => loss:   0.537 (#OOM: 0)
Epoch 32 - update      14910 => loss:   0.495 (#OOM: 0)
Epoch 32 - update      14940 => loss:   0.660 (#OOM: 0)
Epoch 32 - update      14970 => loss:   0.820 (#OOM: 0)
Epoch 32 - update      15000 => loss:   0.630 (#OOM: 0)
Epoch 32 - update      15030 => loss:   0.682 (#OOM: 0)
Epoch 32 - update      15060 => loss:   0.621 (#OOM: 0)
Epoch 32 - update      15090 => loss:   0.573 (#OOM: 0)
Epoch 32 - update      15120 => loss:   0.706 (#OOM: 0)
Epoch 32 - update      15150 => loss:   0.402 (#OOM: 0)
Epoch 32 - update      15180 => loss:   0.664 (#OOM: 0)
Epoch 32 - update      15210 => loss:   0.650 (#OOM: 0)
Epoch 32 - update      15240 => loss:   0.572 (#OOM: 0)
--> Epoch 32 finished with mean loss 0.71707
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.60 mins)   (855 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.39batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.39batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.51batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.71batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.40batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.04batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.45batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 78.86batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 71.35batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 73.07batch/s]  4%|█▏                          | 44/1014 [00:00<00:14, 68.48batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 69.67batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 70.57batch/s]  7%|█▉                          | 71/1014 [00:00<00:13, 71.06batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 71.93batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 71.79batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 71.97batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 72.92batch/s] 11%|███                        | 116/1014 [00:01<00:12, 73.71batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 73.81batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 74.03batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 73.95batch/s] 15%|████                       | 152/1014 [00:02<00:11, 74.43batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 74.87batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 75.13batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.33batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.45batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.77batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.81batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.85batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.39batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.53batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.19batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.38batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 75.57batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.53batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.77batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 76.00batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.87batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.01batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.01batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.06batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.15batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 75.08batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.20batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 75.09batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 74.99batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.74batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.70batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.82batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.58batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.88batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 74.41batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 74.43batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 74.27batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 74.28batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 74.18batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.26batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 74.06batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 73.90batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.09batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 74.33batch/s] 52%|█████████████▉             | 524/1014 [00:07<00:06, 74.44batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 74.48batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 74.48batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 74.58batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 74.48batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 74.38batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.54batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.34batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 74.44batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 74.51batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 74.52batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 74.48batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.64batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.81batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 74.96batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 74.96batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.08batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 74.93batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.00batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.13batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.22batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.29batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.41batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 75.41batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.48batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.35batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.30batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.33batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.29batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.39batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.48batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.52batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.38batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.38batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.44batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.40batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.44batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.40batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 75.45batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.52batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.46batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.53batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 75.54batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.55batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.56batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.57batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 75.49batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.51batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.58batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.67batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.66batch/s]
Validation 32 -> LOSS = 1.16
Validation 32 -> BLEU = 55.36, 77.2/61.3/50.1/41.1 (BP=0.990, ratio=0.990, hyp_len=14245, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.36 @ validation 32
Starting Epoch 33
Epoch 33 - update      15270 => loss:   0.634 (#OOM: 0)
Epoch 33 - update      15300 => loss:   0.801 (#OOM: 0)
Epoch 33 - update      15330 => loss:   0.856 (#OOM: 0)
Epoch 33 - update      15360 => loss:   0.488 (#OOM: 0)
Epoch 33 - update      15390 => loss:   0.608 (#OOM: 0)
Epoch 33 - update      15420 => loss:   0.536 (#OOM: 0)
Epoch 33 - update      15450 => loss:   0.622 (#OOM: 0)
Epoch 33 - update      15480 => loss:   1.013 (#OOM: 0)
Epoch 33 - update      15510 => loss:   0.586 (#OOM: 0)
Epoch 33 - update      15540 => loss:   0.916 (#OOM: 0)
Epoch 33 - update      15570 => loss:   0.607 (#OOM: 0)
Epoch 33 - update      15600 => loss:   0.838 (#OOM: 0)
Epoch 33 - update      15630 => loss:   0.536 (#OOM: 0)
Epoch 33 - update      15660 => loss:   0.815 (#OOM: 0)
Epoch 33 - update      15690 => loss:   0.714 (#OOM: 0)
Epoch 33 - update      15720 => loss:   0.714 (#OOM: 0)
--> Epoch 33 finished with mean loss 0.70827
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (783 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.58batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.20batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.84batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.17batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.49batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.76batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.73batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.84batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.54batch/s]  3%|▋                           | 26/1014 [00:00<00:11, 82.35batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 77.99batch/s]  5%|█▎                          | 46/1014 [00:00<00:12, 78.21batch/s]  6%|█▌                          | 56/1014 [00:00<00:12, 78.67batch/s]  7%|█▊                          | 66/1014 [00:00<00:11, 79.16batch/s]  7%|██                          | 76/1014 [00:00<00:12, 77.46batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 77.32batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 75.75batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 75.81batch/s] 11%|███                        | 116/1014 [00:01<00:12, 74.47batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.15batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 74.43batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 74.51batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 74.77batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 74.94batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 75.52batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 75.55batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.91batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.74batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.09batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 76.21batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 76.18batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 76.23batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 75.95batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.72batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.54batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.53batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.74batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.50batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 75.29batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 75.28batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 75.20batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 75.30batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.36batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 75.16batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 75.72batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.98batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 76.06batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 76.24batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 76.17batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 76.12batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 76.22batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 75.99batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.91batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.79batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 75.96batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.11batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 76.39batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 76.28batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 76.58batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 76.45batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 76.53batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 76.31batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 76.24batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 76.01batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 76.17batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.01batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 76.02batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.89batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 75.97batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 75.96batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.92batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.81batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.62batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.74batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.60batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 75.43batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 75.53batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.32batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 75.39batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 75.43batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.39batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.43batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.39batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.31batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.41batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 75.40batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 75.51batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.64batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 75.64batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 75.64batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.68batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.66batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.71batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.70batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.72batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.67batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 75.69batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.58batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 75.65batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 75.74batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.81batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.91batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.84batch/s]
Validation 33 -> LOSS = 1.16
Validation 33 -> BLEU = 55.26, 77.1/61.2/50.1/41.1 (BP=0.990, ratio=0.990, hyp_len=14241, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.36 @ validation 32
Starting Epoch 34
Epoch 34 - update      15750 => loss:   0.656 (#OOM: 0)
Epoch 34 - update      15780 => loss:   0.668 (#OOM: 0)
Epoch 34 - update      15810 => loss:   0.521 (#OOM: 0)
Epoch 34 - update      15840 => loss:   0.763 (#OOM: 0)
Epoch 34 - update      15870 => loss:   0.501 (#OOM: 0)
Epoch 34 - update      15900 => loss:   0.599 (#OOM: 0)
Epoch 34 - update      15930 => loss:   0.658 (#OOM: 0)
Epoch 34 - update      15960 => loss:   0.758 (#OOM: 0)
Epoch 34 - update      15990 => loss:   0.537 (#OOM: 0)
Epoch 34 - update      16020 => loss:   0.964 (#OOM: 0)
Epoch 34 - update      16050 => loss:   0.761 (#OOM: 0)
Epoch 34 - update      16080 => loss:   0.960 (#OOM: 0)
Epoch 34 - update      16110 => loss:   0.422 (#OOM: 0)
Epoch 34 - update      16140 => loss:   0.614 (#OOM: 0)
Epoch 34 - update      16170 => loss:   0.664 (#OOM: 0)
Epoch 34 - update      16200 => loss:   0.573 (#OOM: 0)
--> Epoch 34 finished with mean loss 0.70016
--> Overhead/Training/Evaluation: 0.03/0.56/0.00 mins (total: 0.59 mins)   (865 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.52batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.46batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 53.63batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.46batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.15batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.24batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.07batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 81.01batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.08batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.25batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 80.21batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.94batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.03batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 77.80batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 78.11batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 77.79batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.73batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 77.17batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.71batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.66batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.15batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.99batch/s] 15%|████                       | 153/1014 [00:01<00:11, 76.68batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 76.10batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 76.13batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.39batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.76batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.90batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.70batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 75.89batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 75.91batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 76.12batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 76.15batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 76.21batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 76.16batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 76.38batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.88batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.59batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.74batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.98batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.98batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.65batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 75.55batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.54batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 75.66batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 75.49batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 75.46batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 75.41batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.29batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.04batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.00batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.93batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 74.74batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.79batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 74.89batch/s] 44%|███████████▉               | 450/1014 [00:06<00:07, 74.90batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 74.74batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 74.78batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.62batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.61batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.51batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.59batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.70batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 74.73batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 74.66batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 74.78batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 74.89batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 74.92batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 74.82batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.96batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.07batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.10batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 75.29batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.28batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.19batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.17batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 75.04batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.21batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.12batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.11batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.27batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.15batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.12batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.36batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 75.31batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.23batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.36batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.42batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 75.23batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.25batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.22batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.26batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.26batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.34batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.26batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.31batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.30batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.27batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.26batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 75.28batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.41batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.50batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.46batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.48batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.44batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.41batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.44batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.39batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.32batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.35batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.27batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.06batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.05batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.02batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.08batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.10batch/s]
Validation 34 -> LOSS = 1.16
Validation 34 -> BLEU = 55.05, 76.9/60.9/49.6/40.5 (BP=0.994, ratio=0.994, hyp_len=14295, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.36 @ validation 32
Starting Epoch 35
Epoch 35 - update      16230 => loss:   0.514 (#OOM: 0)
Epoch 35 - update      16260 => loss:   0.547 (#OOM: 0)
Epoch 35 - update      16290 => loss:   0.447 (#OOM: 0)
Epoch 35 - update      16320 => loss:   0.422 (#OOM: 0)
Epoch 35 - update      16350 => loss:   0.766 (#OOM: 0)
Epoch 35 - update      16380 => loss:   0.458 (#OOM: 0)
Epoch 35 - update      16410 => loss:   0.619 (#OOM: 0)
Epoch 35 - update      16440 => loss:   0.640 (#OOM: 0)
Epoch 35 - update      16470 => loss:   0.711 (#OOM: 0)
Epoch 35 - update      16500 => loss:   0.548 (#OOM: 0)
Epoch 35 - update      16530 => loss:   0.552 (#OOM: 0)
Epoch 35 - update      16560 => loss:   0.478 (#OOM: 0)
Epoch 35 - update      16590 => loss:   0.551 (#OOM: 0)
Epoch 35 - update      16620 => loss:   0.885 (#OOM: 0)
Epoch 35 - update      16650 => loss:   0.482 (#OOM: 0)
Epoch 35 - update      16680 => loss:   0.582 (#OOM: 0)
--> Epoch 35 finished with mean loss 0.69108
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (807 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.83batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 57.51batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.62batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 52.75batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.92batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.84batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.45batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.92batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 73.30batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 75.56batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 74.15batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 76.49batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 76.68batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 76.41batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 76.51batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 77.12batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 76.41batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 76.54batch/s] 11%|███                        | 114/1014 [00:01<00:11, 75.53batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 76.26batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 76.36batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 75.89batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 75.84batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 75.83batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.96batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 76.05batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 75.70batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 75.65batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 75.91batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 75.94batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.56batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 75.34batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 75.59batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 75.84batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 75.91batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.49batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.16batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.19batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.33batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.92batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 74.84batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 75.06batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 75.19batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 74.86batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 74.94batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 75.14batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 75.02batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 75.03batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 75.15batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 75.17batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 75.12batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 75.18batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 75.42batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 75.57batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.46batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 75.56batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 75.60batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.63batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.50batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 75.44batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 75.05batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 75.13batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 75.31batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 75.33batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 75.33batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 75.16batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.07batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.06batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.03batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.10batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 75.19batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 75.13batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 75.16batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 74.95batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 74.99batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 74.85batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.89batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.94batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.69batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.63batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 74.51batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 74.38batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 74.42batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 74.40batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 74.39batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 74.47batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 74.49batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.50batch/s] 73%|███████████████████▊       | 744/1014 [00:10<00:03, 74.38batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 74.39batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.39batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 74.44batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 74.50batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 74.60batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 74.60batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 74.55batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 74.56batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.69batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.66batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 74.70batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.71batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 74.73batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 74.80batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 74.77batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 74.73batch/s] 88%|███████████████████████▉   | 897/1014 [00:12<00:01, 74.67batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.56batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.59batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.67batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 74.73batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.76batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 74.88batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 74.91batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 74.93batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 74.85batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.94batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 75.05batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.06batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.04batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.04batch/s]
Validation 35 -> LOSS = 1.17
Validation 35 -> BLEU = 54.68, 76.3/60.3/48.9/39.8 (BP=0.999, ratio=0.999, hyp_len=14366, ref_len=14382)
** Learning rate changed -> 0.0001
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.36 @ validation 32
Starting Epoch 36
Epoch 36 - update      16710 => loss:   0.787 (#OOM: 0)
Epoch 36 - update      16740 => loss:   0.407 (#OOM: 0)
Epoch 36 - update      16770 => loss:   0.641 (#OOM: 0)
Epoch 36 - update      16800 => loss:   0.782 (#OOM: 0)
Epoch 36 - update      16830 => loss:   0.777 (#OOM: 0)
Epoch 36 - update      16860 => loss:   0.395 (#OOM: 0)
Epoch 36 - update      16890 => loss:   0.535 (#OOM: 0)
Epoch 36 - update      16920 => loss:   0.548 (#OOM: 0)
Epoch 36 - update      16950 => loss:   0.954 (#OOM: 0)
Epoch 36 - update      16980 => loss:   0.792 (#OOM: 0)
Epoch 36 - update      17010 => loss:   0.711 (#OOM: 0)
Epoch 36 - update      17040 => loss:   0.874 (#OOM: 0)
Epoch 36 - update      17070 => loss:   0.620 (#OOM: 0)
Epoch 36 - update      17100 => loss:   0.744 (#OOM: 0)
Epoch 36 - update      17130 => loss:   0.788 (#OOM: 0)
Epoch 36 - update      17160 => loss:   0.541 (#OOM: 0)
--> Epoch 36 finished with mean loss 0.66671
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (902 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.10batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 46.91batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 47.79batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 48.85batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.52batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.03batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.00batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 94.94batch/s]  2%|▌                           | 20/1014 [00:00<00:13, 75.87batch/s]  3%|▊                           | 30/1014 [00:00<00:12, 78.21batch/s]  4%|█                           | 40/1014 [00:00<00:12, 79.37batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 76.70batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 76.77batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 76.83batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 75.93batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 76.34batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 76.17batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 76.41batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 75.68batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 75.81batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 76.19batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 76.01batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.02batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.46batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 75.88batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 76.14batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 76.42batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 76.61batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 76.62batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 76.32batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 76.41batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 76.68batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 76.88batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 76.58batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 76.66batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 76.51batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 76.43batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 76.27batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 75.82batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 75.95batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.67batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.81batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 75.79batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 75.86batch/s] 37%|██████████                 | 380/1014 [00:05<00:08, 75.69batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 75.75batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 76.16batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 75.88batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 75.81batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 75.81batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 76.02batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 75.90batch/s] 45%|████████████▏              | 460/1014 [00:06<00:07, 75.85batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 75.96batch/s] 47%|████████████▊              | 480/1014 [00:06<00:07, 75.94batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 75.83batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 75.58batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 75.56batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 75.57batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 75.60batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 75.56batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 75.48batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:06, 75.46batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 75.56batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 75.58batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 75.36batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 75.46batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 75.56batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 75.56batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.44batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 75.54batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 75.55batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 75.36batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 75.45batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 75.33batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 75.24batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.34batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 75.39batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.44batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 75.46batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.31batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 75.38batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.53batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 75.53batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.70batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.56batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.56batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.55batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.39batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 75.29batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.27batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.17batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.22batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.17batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.05batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.08batch/s] 89%|███████████████████████▉   | 900/1014 [00:12<00:01, 74.99batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.00batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.04batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.06batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.02batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 74.97batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 74.93batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 74.97batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 74.93batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 74.99batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 74.89batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 74.86batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.92batch/s]
Validation 36 -> LOSS = 1.16
Validation 36 -> BLEU = 55.85, 77.2/61.5/50.4/41.4 (BP=0.995, ratio=0.995, hyp_len=14312, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.85 @ validation 36
Starting Epoch 37
Epoch 37 - update      17190 => loss:   0.516 (#OOM: 0)
Epoch 37 - update      17220 => loss:   0.491 (#OOM: 0)
Epoch 37 - update      17250 => loss:   0.488 (#OOM: 0)
Epoch 37 - update      17280 => loss:   0.763 (#OOM: 0)
Epoch 37 - update      17310 => loss:   0.739 (#OOM: 0)
Epoch 37 - update      17340 => loss:   0.828 (#OOM: 0)
Epoch 37 - update      17370 => loss:   0.535 (#OOM: 0)
Epoch 37 - update      17400 => loss:   0.505 (#OOM: 0)
Epoch 37 - update      17430 => loss:   0.491 (#OOM: 0)
Epoch 37 - update      17460 => loss:   0.624 (#OOM: 0)
Epoch 37 - update      17490 => loss:   0.609 (#OOM: 0)
Epoch 37 - update      17520 => loss:   0.809 (#OOM: 0)
Epoch 37 - update      17550 => loss:   0.764 (#OOM: 0)
Epoch 37 - update      17580 => loss:   0.500 (#OOM: 0)
Epoch 37 - update      17610 => loss:   0.781 (#OOM: 0)
Epoch 37 - update      17640 => loss:   0.702 (#OOM: 0)
--> Epoch 37 finished with mean loss 0.66056
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (821 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.24batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.81batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.10batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.82batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.92batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.33batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.40batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 70.85batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.63batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 76.85batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 75.07batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 74.45batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 74.73batch/s]  7%|██                          | 74/1014 [00:00<00:12, 76.13batch/s]  8%|██▎                         | 84/1014 [00:01<00:12, 75.45batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 75.69batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 74.81batch/s] 11%|███                        | 114/1014 [00:01<00:11, 76.01batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 75.83batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.24batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.08batch/s] 15%|████                       | 154/1014 [00:02<00:11, 73.32batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 73.31batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 73.34batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 72.96batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 72.85batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 73.11batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 73.04batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 73.64batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.00batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 74.04batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 73.48batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 73.97batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 73.84batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 74.19batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 74.48batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.62batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.43batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.61batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 74.67batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:09, 74.32batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 74.39batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 74.69batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.70batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.62batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 74.31batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.33batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.22batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 74.38batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 74.18batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 74.31batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 74.56batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 74.40batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.43batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 74.61batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 74.50batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.81batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 74.99batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.06batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 74.95batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.16batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.26batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.24batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.15batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.14batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.17batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 75.31batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.13batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.29batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.27batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.31batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.49batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.27batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.33batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.27batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.16batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.22batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.25batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.17batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.10batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.03batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.96batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.96batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 74.97batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.99batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 74.90batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.93batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.86batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.73batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.77batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.84batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.88batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.81batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.82batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.75batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 74.70batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.68batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.81batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.81batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.79batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.81batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.73batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.77batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.79batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.80batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.78batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.76batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.75batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.74batch/s]
Validation 37 -> LOSS = 1.16
Validation 37 -> BLEU = 55.36, 76.6/60.8/49.6/40.7 (BP=1.000, ratio=1.004, hyp_len=14441, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.85 @ validation 36
Starting Epoch 38
Epoch 38 - update      17670 => loss:   0.750 (#OOM: 0)
Epoch 38 - update      17700 => loss:   0.588 (#OOM: 0)
Epoch 38 - update      17730 => loss:   0.714 (#OOM: 0)
Epoch 38 - update      17760 => loss:   0.731 (#OOM: 0)
Epoch 38 - update      17790 => loss:   0.497 (#OOM: 0)
Epoch 38 - update      17820 => loss:   0.758 (#OOM: 0)
Epoch 38 - update      17850 => loss:   0.695 (#OOM: 0)
Epoch 38 - update      17880 => loss:   0.743 (#OOM: 0)
Epoch 38 - update      17910 => loss:   0.801 (#OOM: 0)
Epoch 38 - update      17940 => loss:   0.864 (#OOM: 0)
Epoch 38 - update      17970 => loss:   0.837 (#OOM: 0)
Epoch 38 - update      18000 => loss:   0.600 (#OOM: 0)
Epoch 38 - update      18030 => loss:   0.939 (#OOM: 0)
Epoch 38 - update      18060 => loss:   1.009 (#OOM: 0)
Epoch 38 - update      18090 => loss:   0.542 (#OOM: 0)
Epoch 38 - update      18120 => loss:   0.789 (#OOM: 0)
--> Epoch 38 finished with mean loss 0.65430
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (754 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.64batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.47batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.19batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.63batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.54batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.87batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.85batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.55batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 74.13batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 72.02batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 71.95batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 69.91batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 71.08batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 71.40batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 71.76batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 72.81batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.41batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.40batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 72.45batch/s] 12%|███                        | 117/1014 [00:01<00:12, 72.30batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 72.66batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 73.55batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.72batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.09batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.14batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.71batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 73.94batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.38batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.62batch/s] 20%|█████▌                     | 207/1014 [00:02<00:11, 73.12batch/s] 21%|█████▊                     | 216/1014 [00:02<00:11, 72.13batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 72.30batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 72.76batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 73.14batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 73.13batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 73.60batch/s] 27%|███████▏                   | 272/1014 [00:03<00:10, 73.78batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 74.10batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 74.13batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 73.89batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 73.95batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 73.91batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 73.85batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 73.96batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 74.18batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 73.67batch/s] 37%|█████████▉                 | 372/1014 [00:05<00:08, 73.48batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 73.12batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 73.15batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 73.18batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 73.27batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 73.22batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 73.31batch/s] 44%|███████████▊               | 442/1014 [00:06<00:07, 73.35batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 72.97batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 73.03batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 73.25batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 73.28batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 73.52batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 73.55batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 73.68batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 73.71batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 73.54batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 73.40batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 73.51batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 73.58batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:06, 73.57batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 73.65batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 73.70batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 73.77batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 73.62batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 73.66batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 73.77batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 73.60batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 73.55batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 73.52batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 73.57batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 73.61batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 73.53batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 73.64batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 73.72batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 73.67batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 73.79batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 73.74batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 73.78batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 73.86batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 73.89batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 73.93batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:03, 73.90batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 74.02batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 73.97batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 73.85batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 73.82batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 73.91batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 73.80batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 73.79batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 73.84batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 73.88batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 73.69batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 73.79batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 73.80batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 73.75batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 73.74batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 73.74batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 73.85batch/s] 95%|█████████████████████████▌ | 962/1014 [00:13<00:00, 73.83batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 73.86batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 73.65batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 73.65batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 73.58batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 73.75batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.76batch/s]
Validation 38 -> LOSS = 1.16
Validation 38 -> BLEU = 54.96, 76.0/60.3/49.2/40.4 (BP=1.000, ratio=1.011, hyp_len=14544, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.85 @ validation 36
Starting Epoch 39
Epoch 39 - update      18150 => loss:   0.671 (#OOM: 0)
Epoch 39 - update      18180 => loss:   0.501 (#OOM: 0)
Epoch 39 - update      18210 => loss:   0.846 (#OOM: 0)
Epoch 39 - update      18240 => loss:   0.769 (#OOM: 0)
Epoch 39 - update      18270 => loss:   0.499 (#OOM: 0)
Epoch 39 - update      18300 => loss:   0.570 (#OOM: 0)
Epoch 39 - update      18330 => loss:   0.910 (#OOM: 0)
Epoch 39 - update      18360 => loss:   0.535 (#OOM: 0)
Epoch 39 - update      18390 => loss:   0.492 (#OOM: 0)
Epoch 39 - update      18420 => loss:   0.418 (#OOM: 0)
Epoch 39 - update      18450 => loss:   0.777 (#OOM: 0)
Epoch 39 - update      18480 => loss:   0.532 (#OOM: 0)
Epoch 39 - update      18510 => loss:   0.674 (#OOM: 0)
Epoch 39 - update      18540 => loss:   0.785 (#OOM: 0)
Epoch 39 - update      18570 => loss:   0.623 (#OOM: 0)
Epoch 39 - update      18600 => loss:   0.230 (#OOM: 0)
--> Epoch 39 finished with mean loss 0.64773
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (816 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.94batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.90batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.44batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 48.25batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.42batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.06batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:15, 66.85batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 67.65batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 70.36batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 73.24batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 74.31batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 74.27batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 74.42batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 75.09batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 75.66batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 74.73batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.20batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 75.25batch/s] 11%|███                        | 114/1014 [00:01<00:12, 74.89batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.10batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 74.49batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 75.27batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 75.46batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 75.86batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.87batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 75.72batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 75.75batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 75.10batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 75.34batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 75.62batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.59batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 75.41batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 75.46batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 75.51batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 75.70batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.79batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.68batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.30batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.42batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 75.19batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 75.18batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 75.01batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 75.06batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.38batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.46batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 75.45batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 75.64batch/s] 37%|██████████                 | 380/1014 [00:05<00:08, 75.55batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 75.78batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 75.96batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 76.24batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 76.00batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 76.04batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 76.26batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 76.32batch/s] 45%|████████████▏              | 460/1014 [00:06<00:07, 76.44batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 76.37batch/s] 47%|████████████▊              | 480/1014 [00:06<00:07, 76.22batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 76.37batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 76.28batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 76.14batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 76.23batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 76.36batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.41batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 76.19batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 75.96batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 76.08batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 76.01batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 76.06batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 75.91batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 75.88batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 75.83batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.84batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 75.55batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 75.58batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 75.47batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 75.60batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 75.77batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 75.80batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.91batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 75.83batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.65batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 75.70batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 75.72batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 75.55batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.47batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 75.44batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.52batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 75.44batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.28batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.33batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.34batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 75.39batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.39batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.44batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.49batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.55batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.46batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.40batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.36batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.19batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.25batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.20batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.23batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.27batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.16batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.13batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 75.19batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.17batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.12batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 75.09batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.12batch/s]
Validation 39 -> LOSS = 1.16
Validation 39 -> BLEU = 55.55, 77.1/61.1/50.0/41.0 (BP=0.997, ratio=0.997, hyp_len=14337, ref_len=14382)
** Learning rate changed -> 5e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.85 @ validation 36
Starting Epoch 40
Epoch 40 - update      18630 => loss:   0.466 (#OOM: 0)
Epoch 40 - update      18660 => loss:   0.512 (#OOM: 0)
Epoch 40 - update      18690 => loss:   0.444 (#OOM: 0)
Epoch 40 - update      18720 => loss:   0.541 (#OOM: 0)
Epoch 40 - update      18750 => loss:   0.343 (#OOM: 0)
Epoch 40 - update      18780 => loss:   0.629 (#OOM: 0)
Epoch 40 - update      18810 => loss:   0.330 (#OOM: 0)
Epoch 40 - update      18840 => loss:   0.442 (#OOM: 0)
Epoch 40 - update      18870 => loss:   0.859 (#OOM: 0)
Epoch 40 - update      18900 => loss:   0.646 (#OOM: 0)
Epoch 40 - update      18930 => loss:   0.828 (#OOM: 0)
Epoch 40 - update      18960 => loss:   0.616 (#OOM: 0)
Epoch 40 - update      18990 => loss:   0.528 (#OOM: 0)
Epoch 40 - update      19020 => loss:   0.577 (#OOM: 0)
Epoch 40 - update      19050 => loss:   0.943 (#OOM: 0)
Epoch 40 - update      19080 => loss:   0.465 (#OOM: 0)
--> Epoch 40 finished with mean loss 0.63645
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (781 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.44batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.13batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.59batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.06batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.55batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.88batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 69.51batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 71.90batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 73.88batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.25batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 75.41batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 77.96batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 76.50batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 75.96batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.72batch/s]  9%|██▌                         | 91/1014 [00:01<00:11, 77.36batch/s] 10%|██▋                        | 101/1014 [00:01<00:11, 77.08batch/s] 11%|██▉                        | 111/1014 [00:01<00:11, 77.10batch/s] 12%|███▏                       | 121/1014 [00:01<00:11, 76.41batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 77.62batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 77.60batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.31batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.18batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.46batch/s] 18%|████▊                      | 181/1014 [00:02<00:11, 75.54batch/s] 19%|█████                      | 191/1014 [00:02<00:10, 74.95batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 75.04batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 74.14batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 74.27batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 74.56batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.26batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 74.71batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 74.85batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 75.21batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 75.19batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 74.87batch/s] 30%|████████                   | 301/1014 [00:04<00:09, 74.92batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 74.81batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 74.50batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 74.22batch/s] 34%|█████████                  | 341/1014 [00:04<00:09, 74.48batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 74.46batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 74.62batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 74.67batch/s] 38%|██████████▏                | 381/1014 [00:05<00:08, 74.73batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 74.87batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 74.93batch/s] 41%|██████████▉                | 411/1014 [00:05<00:08, 74.99batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 75.01batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 75.01batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 74.90batch/s] 44%|████████████               | 451/1014 [00:06<00:07, 74.99batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 75.15batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 75.05batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 75.21batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 75.07batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 75.29batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 75.29batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 75.14batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 75.16batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 75.10batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 75.16batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:06, 75.34batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 75.41batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 75.43batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 75.43batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 75.53batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 75.54batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.44batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 75.41batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 75.25batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 75.15batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 75.26batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 75.19batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 75.23batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 75.29batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 75.40batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 75.39batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 75.29batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 75.21batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 75.38batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 75.39batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 75.14batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 75.22batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 74.97batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 74.89batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.82batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 74.75batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 74.87batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 74.97batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 74.95batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 74.91batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 75.00batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 75.13batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 75.10batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 75.04batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 75.10batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 75.08batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 75.03batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 75.08batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 74.99batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 75.02batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 75.06batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 75.13batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 75.17batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.23batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 75.16batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 75.12batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.15batch/s]
Validation 40 -> LOSS = 1.16
Validation 40 -> BLEU = 55.99, 77.1/61.4/50.3/41.4 (BP=1.000, ratio=1.000, hyp_len=14375, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 41
Epoch 41 - update      19110 => loss:   0.639 (#OOM: 0)
Epoch 41 - update      19140 => loss:   0.555 (#OOM: 0)
Epoch 41 - update      19170 => loss:   0.868 (#OOM: 0)
Epoch 41 - update      19200 => loss:   0.537 (#OOM: 0)
Epoch 41 - update      19230 => loss:   0.501 (#OOM: 0)
Epoch 41 - update      19260 => loss:   0.544 (#OOM: 0)
Epoch 41 - update      19290 => loss:   0.571 (#OOM: 0)
Epoch 41 - update      19320 => loss:   0.461 (#OOM: 0)
Epoch 41 - update      19350 => loss:   0.799 (#OOM: 0)
Epoch 41 - update      19380 => loss:   0.546 (#OOM: 0)
Epoch 41 - update      19410 => loss:   0.747 (#OOM: 0)
Epoch 41 - update      19440 => loss:   0.670 (#OOM: 0)
Epoch 41 - update      19470 => loss:   0.593 (#OOM: 0)
Epoch 41 - update      19500 => loss:   0.696 (#OOM: 0)
Epoch 41 - update      19530 => loss:   0.726 (#OOM: 0)
--> Epoch 41 finished with mean loss 0.63130
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.60 mins)   (853 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.61batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.05batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.58batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.12batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.36batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.31batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.91batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 74.56batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 74.27batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.92batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.99batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.73batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.70batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 78.02batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 77.79batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 77.21batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.76batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 76.04batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.42batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.17batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 77.36batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 77.63batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 77.82batch/s] 16%|████▍                      | 166/1014 [00:02<00:10, 77.48batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 76.77batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 76.82batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.66batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 76.65batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.50batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 75.84batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 76.00batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 75.76batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 75.46batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.12batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.38batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.31batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.82batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.10batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 75.27batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 75.19batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 74.97batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 74.08batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 74.05batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 74.19batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.29batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.52batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.75batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 75.04batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 74.84batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 74.90batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 74.86batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 74.89batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 74.80batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 74.90batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.07batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.91batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 74.78batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 74.83batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 74.89batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 74.99batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 74.74batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 74.90batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 74.96batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.05batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.00batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 74.98batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 74.75batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.81batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.68batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 74.79batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.63batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.71batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 74.64batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.70batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 74.49batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 74.49batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 74.49batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 74.46batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 74.62batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 74.67batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.69batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 74.64batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 74.64batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.68batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.64batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.69batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.75batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.75batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 74.72batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.77batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.70batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.60batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.72batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.76batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.74batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 74.85batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 74.90batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.99batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.00batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.10batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.09batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.09batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.05batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.11batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.08batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 75.18batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.97batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.00batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.12batch/s]
Validation 41 -> LOSS = 1.15
Validation 41 -> BLEU = 55.62, 76.8/61.0/49.9/41.0 (BP=1.000, ratio=1.002, hyp_len=14416, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 42
Epoch 42 - update      19560 => loss:   0.413 (#OOM: 0)
Epoch 42 - update      19590 => loss:   0.752 (#OOM: 0)
Epoch 42 - update      19620 => loss:   0.542 (#OOM: 0)
Epoch 42 - update      19650 => loss:   0.466 (#OOM: 0)
Epoch 42 - update      19680 => loss:   0.509 (#OOM: 0)
Epoch 42 - update      19710 => loss:   0.452 (#OOM: 0)
Epoch 42 - update      19740 => loss:   0.495 (#OOM: 0)
Epoch 42 - update      19770 => loss:   0.597 (#OOM: 0)
Epoch 42 - update      19800 => loss:   0.526 (#OOM: 0)
Epoch 42 - update      19830 => loss:   0.668 (#OOM: 0)
Epoch 42 - update      19860 => loss:   0.745 (#OOM: 0)
Epoch 42 - update      19890 => loss:   0.512 (#OOM: 0)
Epoch 42 - update      19920 => loss:   0.522 (#OOM: 0)
Epoch 42 - update      19950 => loss:   0.609 (#OOM: 0)
Epoch 42 - update      19980 => loss:   0.571 (#OOM: 0)
Epoch 42 - update      20010 => loss:   0.271 (#OOM: 0)
--> Epoch 42 finished with mean loss 0.62822
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.61 mins)   (839 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.43batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.69batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.72batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.22batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.28batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.69batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.67batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.12batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 76.15batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.66batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 75.65batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 75.13batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 75.58batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.81batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 75.91batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 75.69batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.25batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 74.54batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.00batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.12batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.02batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.10batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.69batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.31batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.82batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.26batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 73.31batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.09batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.61batch/s] 20%|█████▌                     | 207/1014 [00:02<00:11, 73.17batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 73.23batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 73.44batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.47batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 73.22batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 73.67batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 73.74batch/s] 27%|███████▏                   | 270/1014 [00:03<00:10, 73.70batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 73.63batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 73.61batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 73.35batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 73.60batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 73.34batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 73.05batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 72.92batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 73.22batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:09, 73.26batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 73.34batch/s] 36%|█████████▊                 | 369/1014 [00:05<00:08, 73.61batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 73.59batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 73.48batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 73.41batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 73.56batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 73.35batch/s] 42%|███████████▎               | 423/1014 [00:05<00:08, 73.45batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 73.68batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.02batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 73.90batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 73.89batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 73.82batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 73.76batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 73.90batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.04batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 73.37batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 73.45batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 73.55batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 73.73batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 73.69batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 73.57batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 73.80batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 73.63batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 73.85batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 73.97batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.04batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 74.00batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 73.81batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 73.70batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 73.41batch/s] 65%|█████████████████▋         | 662/1014 [00:09<00:04, 73.53batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 73.45batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 73.64batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 73.77batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 73.71batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 73.86batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 73.94batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 73.97batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 74.00batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 73.85batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 73.89batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 73.85batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 73.89batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:03, 73.92batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 74.08batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 74.02batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 74.08batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 74.10batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 74.14batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.12batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.14batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.12batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.07batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 74.14batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 74.22batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.18batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.21batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 74.21batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.10batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.12batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.28batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 74.19batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.04batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.12batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.07batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.11batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.12batch/s]
Validation 42 -> LOSS = 1.16
Validation 42 -> BLEU = 55.53, 76.6/60.9/49.9/40.9 (BP=1.000, ratio=1.005, hyp_len=14453, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 43
Epoch 43 - update      20040 => loss:   0.767 (#OOM: 0)
Epoch 43 - update      20070 => loss:   0.585 (#OOM: 0)
Epoch 43 - update      20100 => loss:   0.504 (#OOM: 0)
Epoch 43 - update      20130 => loss:   0.782 (#OOM: 0)
Epoch 43 - update      20160 => loss:   0.639 (#OOM: 0)
Epoch 43 - update      20190 => loss:   0.498 (#OOM: 0)
Epoch 43 - update      20220 => loss:   0.734 (#OOM: 0)
Epoch 43 - update      20250 => loss:   0.610 (#OOM: 0)
Epoch 43 - update      20280 => loss:   0.324 (#OOM: 0)
Epoch 43 - update      20310 => loss:   0.539 (#OOM: 0)
Epoch 43 - update      20340 => loss:   0.491 (#OOM: 0)
Epoch 43 - update      20370 => loss:   0.635 (#OOM: 0)
Epoch 43 - update      20400 => loss:   0.608 (#OOM: 0)
Epoch 43 - update      20430 => loss:   0.658 (#OOM: 0)
Epoch 43 - update      20460 => loss:   0.469 (#OOM: 0)
Epoch 43 - update      20490 => loss:   0.587 (#OOM: 0)
--> Epoch 43 finished with mean loss 0.62443
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (754 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.15batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 52.10batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 53.36batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.40batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.76batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.52batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.48batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.11batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 77.48batch/s]  3%|▋                           | 26/1014 [00:00<00:11, 83.27batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.13batch/s]  5%|█▎                          | 46/1014 [00:00<00:12, 75.24batch/s]  6%|█▌                          | 56/1014 [00:00<00:12, 74.68batch/s]  7%|█▊                          | 66/1014 [00:00<00:12, 74.36batch/s]  7%|██                          | 76/1014 [00:01<00:12, 75.06batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 74.81batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.74batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 74.37batch/s] 11%|███                        | 116/1014 [00:01<00:12, 74.46batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.82batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 74.89batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 75.29batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 75.31batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 75.59batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 74.63batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.90batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 75.35batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.25batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 75.46batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 75.73batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 75.76batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 75.39batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 75.52batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.42batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.49batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.46batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.62batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.65batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 75.33batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 75.59batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 75.86batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 75.41batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.65batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 75.57batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.62batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.30batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.48batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 75.62batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 75.66batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 75.60batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 75.58batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.78batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 75.76batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.71batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.90batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 75.85batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 75.53batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 75.47batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.50batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 75.63batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.72batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.64batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.62batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.38batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.44batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.40batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.43batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 75.53batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 75.52batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.46batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 75.47batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.36batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.05batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.13batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 75.06batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.22batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.35batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.28batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.31batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.22batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.10batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.07batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.18batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 74.97batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 74.96batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 74.79batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 74.68batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 74.61batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 74.55batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.58batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 74.71batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 74.80batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.77batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 74.70batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 74.62batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 74.63batch/s] 88%|███████████████████████▊   | 896/1014 [00:12<00:01, 74.61batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 74.54batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.52batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 74.55batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 74.51batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 74.53batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 74.49batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 74.32batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 74.44batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 74.56batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 74.56batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.62batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.49batch/s]
Validation 43 -> LOSS = 1.15
Validation 43 -> BLEU = 55.79, 76.9/61.2/50.1/41.1 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
** Learning rate changed -> 2.5e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 44
Epoch 44 - update      20520 => loss:   0.290 (#OOM: 0)
Epoch 44 - update      20550 => loss:   0.613 (#OOM: 0)
Epoch 44 - update      20580 => loss:   0.912 (#OOM: 0)
Epoch 44 - update      20610 => loss:   0.443 (#OOM: 0)
Epoch 44 - update      20640 => loss:   0.743 (#OOM: 0)
Epoch 44 - update      20670 => loss:   0.524 (#OOM: 0)
Epoch 44 - update      20700 => loss:   0.714 (#OOM: 0)
Epoch 44 - update      20730 => loss:   0.504 (#OOM: 0)
Epoch 44 - update      20760 => loss:   0.698 (#OOM: 0)
Epoch 44 - update      20790 => loss:   0.446 (#OOM: 0)
Epoch 44 - update      20820 => loss:   0.631 (#OOM: 0)
Epoch 44 - update      20850 => loss:   0.588 (#OOM: 0)
Epoch 44 - update      20880 => loss:   0.488 (#OOM: 0)
Epoch 44 - update      20910 => loss:   0.629 (#OOM: 0)
Epoch 44 - update      20940 => loss:   0.515 (#OOM: 0)
Epoch 44 - update      20970 => loss:   0.630 (#OOM: 0)
--> Epoch 44 finished with mean loss 0.62044
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (845 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.36batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 48.65batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 52.05batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 52.15batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 53.19batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 52.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.58batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.45batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.77batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.13batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 69.29batch/s]  4%|█                           | 40/1014 [00:00<00:13, 69.73batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 69.01batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 69.63batch/s]  6%|█▊                          | 64/1014 [00:00<00:13, 69.85batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 70.57batch/s]  8%|██▏                         | 81/1014 [00:01<00:13, 71.77batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 72.14batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 72.96batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 71.99batch/s] 12%|███                        | 117/1014 [00:01<00:12, 71.34batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 71.80batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 71.68batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 72.89batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 72.91batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 73.20batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 73.40batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 73.21batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 73.00batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 73.12batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 73.56batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 73.63batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 73.90batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 73.95batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 74.16batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.46batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.80batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.16batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.15batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.78batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.17batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 75.06batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.76batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 74.91batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.29batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.51batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.41batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.39batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.64batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.85batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 74.60batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 74.68batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 74.84batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 74.95batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 74.89batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.10batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 74.95batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 74.95batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.83batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 74.87batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 74.67batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 74.64batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 74.90batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 74.68batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 74.64batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 74.60batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.82batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.93batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 74.94batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 74.96batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 74.96batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.06batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.01batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.92batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.92batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.01batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.15batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.03batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.04batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.15batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.22batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.21batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.16batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.27batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 75.15batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.07batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.10batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.02batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.92batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.82batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.65batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.71batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.74batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.81batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.75batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 74.75batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.66batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.64batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 74.78batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.67batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.57batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.61batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.68batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.76batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.84batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 74.85batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.84batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.98batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.81batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.85batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.79batch/s]
Validation 44 -> LOSS = 1.16
Validation 44 -> BLEU = 55.55, 76.8/61.0/49.8/40.8 (BP=1.000, ratio=1.001, hyp_len=14393, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 45
Epoch 45 - update      21000 => loss:   0.495 (#OOM: 0)
Epoch 45 - update      21030 => loss:   0.395 (#OOM: 0)
Epoch 45 - update      21060 => loss:   0.441 (#OOM: 0)
Epoch 45 - update      21090 => loss:   0.771 (#OOM: 0)
Epoch 45 - update      21120 => loss:   0.456 (#OOM: 0)
Epoch 45 - update      21150 => loss:   0.372 (#OOM: 0)
Epoch 45 - update      21180 => loss:   0.589 (#OOM: 0)
Epoch 45 - update      21210 => loss:   0.576 (#OOM: 0)
Epoch 45 - update      21240 => loss:   0.621 (#OOM: 0)
Epoch 45 - update      21270 => loss:   0.441 (#OOM: 0)
Epoch 45 - update      21300 => loss:   0.558 (#OOM: 0)
Epoch 45 - update      21330 => loss:   0.735 (#OOM: 0)
Epoch 45 - update      21360 => loss:   0.845 (#OOM: 0)
Epoch 45 - update      21390 => loss:   0.662 (#OOM: 0)
Epoch 45 - update      21420 => loss:   0.683 (#OOM: 0)
Epoch 45 - update      21450 => loss:   0.691 (#OOM: 0)
--> Epoch 45 finished with mean loss 0.61728
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.69 mins)   (752 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.69batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.46batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 49.46batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.16batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 51.66batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.02batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.76batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 71.08batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.50batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 70.33batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 73.41batch/s]  4%|█▏                          | 42/1014 [00:00<00:13, 74.59batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 75.00batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 75.12batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 74.58batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 75.29batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 74.83batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 75.73batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 76.24batch/s] 11%|███                        | 114/1014 [00:01<00:11, 76.36batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.98batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 75.86batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 76.00batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 75.97batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 75.61batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.37batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 75.04batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.57batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 74.19batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 73.86batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 73.79batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 74.27batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 74.39batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 74.26batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 74.12batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 74.10batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 74.06batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 74.36batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.75batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 74.69batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.60batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 74.63batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 74.49batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 74.68batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 74.73batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 74.23batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.23batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 74.27batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.69batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.70batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.98batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 74.88batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 74.84batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 74.93batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 74.90batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.05batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 75.26batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.19batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.03batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.85batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 74.90batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 75.13batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.21batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 75.45batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.39batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.24batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.34batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.09batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.18batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.23batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.25batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 74.86batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 74.97batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 74.94batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 74.96batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.07batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.11batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.05batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 75.22batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.22batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.17batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.23batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.12batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.08batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.01batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.06batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.06batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.20batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 75.12batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 75.09batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 75.08batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.10batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 75.23batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.20batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 75.14batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 75.00batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.94batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.07batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 75.05batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.04batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 75.04batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 75.02batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.02batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 74.96batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 74.98batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.15batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.11batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.12batch/s] 96%|█████████████████████████▉ | 976/1014 [00:13<00:00, 75.02batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 75.01batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 75.05batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.01batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.97batch/s]
Validation 45 -> LOSS = 1.16
Validation 45 -> BLEU = 55.72, 77.0/61.2/50.1/41.1 (BP=0.998, ratio=0.998, hyp_len=14356, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 46
Epoch 46 - update      21480 => loss:   0.379 (#OOM: 0)
Epoch 46 - update      21510 => loss:   0.694 (#OOM: 0)
Epoch 46 - update      21540 => loss:   0.417 (#OOM: 0)
Epoch 46 - update      21570 => loss:   0.841 (#OOM: 0)
Epoch 46 - update      21600 => loss:   0.478 (#OOM: 0)
Epoch 46 - update      21630 => loss:   0.582 (#OOM: 0)
Epoch 46 - update      21660 => loss:   0.495 (#OOM: 0)
Epoch 46 - update      21690 => loss:   0.683 (#OOM: 0)
Epoch 46 - update      21720 => loss:   0.862 (#OOM: 0)
Epoch 46 - update      21750 => loss:   0.606 (#OOM: 0)
Epoch 46 - update      21780 => loss:   0.509 (#OOM: 0)
Epoch 46 - update      21810 => loss:   0.785 (#OOM: 0)
Epoch 46 - update      21840 => loss:   0.522 (#OOM: 0)
Epoch 46 - update      21870 => loss:   0.750 (#OOM: 0)
Epoch 46 - update      21900 => loss:   0.533 (#OOM: 0)
Epoch 46 - update      21930 => loss:   0.585 (#OOM: 0)
--> Epoch 46 finished with mean loss 0.61541
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (812 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.45batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 46.25batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 46.69batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 47.47batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.46batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.77batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.84batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.47batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 85.05batch/s]  4%|█                           | 38/1014 [00:00<00:12, 80.37batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 78.59batch/s]  6%|█▌                          | 58/1014 [00:00<00:12, 77.83batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 77.86batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 77.31batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 76.14batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 76.48batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 76.17batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 75.11batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 74.77batch/s] 14%|███▋                       | 138/1014 [00:01<00:11, 74.56batch/s] 15%|███▉                       | 148/1014 [00:01<00:11, 74.56batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 74.96batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.25batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 74.80batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 74.80batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 74.51batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 74.86batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 75.23batch/s] 22%|██████                     | 228/1014 [00:03<00:10, 75.62batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 75.47batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 75.62batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 75.79batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 76.06batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.25batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 76.21batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 76.45batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 76.43batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 76.22batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 76.15batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 76.25batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 76.51batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 76.20batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 76.39batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 76.33batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 76.18batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 76.05batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 75.81batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 76.04batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 76.00batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 76.05batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 76.09batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 76.26batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 76.25batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 76.14batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 76.07batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.05batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 75.80batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 75.57batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 75.52batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.61batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 75.58batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.54batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 75.50batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 75.49batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 75.29batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 75.24batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 75.13batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 75.00batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 74.77batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 74.77batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 74.71batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 74.63batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 74.32batch/s] 67%|██████████████████         | 678/1014 [00:09<00:04, 74.43batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 74.56batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 74.67batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 74.73batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 74.74batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 74.72batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 74.82batch/s] 74%|███████████████████▉       | 748/1014 [00:10<00:03, 74.78batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 74.65batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 74.70batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 74.72batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 74.70batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 74.87batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 74.88batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 74.94batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 74.91batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 74.88batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 74.88batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 74.72batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 74.76batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 74.68batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 74.60batch/s] 89%|███████████████████████▉   | 898/1014 [00:12<00:01, 74.62batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 74.75batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 74.86batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 74.78batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 74.80batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 74.86batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 74.81batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 74.76batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 74.76batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 74.76batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 74.80batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 74.87batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.90batch/s]
Validation 46 -> LOSS = 1.16
Validation 46 -> BLEU = 55.86, 77.0/61.3/50.2/41.3 (BP=0.998, ratio=0.998, hyp_len=14359, ref_len=14382)
** Learning rate changed -> 1.25e-05
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 47
Epoch 47 - update      21960 => loss:   0.408 (#OOM: 0)
Epoch 47 - update      21990 => loss:   0.813 (#OOM: 0)
Epoch 47 - update      22020 => loss:   0.680 (#OOM: 0)
Epoch 47 - update      22050 => loss:   0.673 (#OOM: 0)
Epoch 47 - update      22080 => loss:   0.911 (#OOM: 0)
Epoch 47 - update      22110 => loss:   0.595 (#OOM: 0)
Epoch 47 - update      22140 => loss:   0.781 (#OOM: 0)
Epoch 47 - update      22170 => loss:   0.501 (#OOM: 0)
Epoch 47 - update      22200 => loss:   0.668 (#OOM: 0)
Epoch 47 - update      22230 => loss:   0.454 (#OOM: 0)
Epoch 47 - update      22260 => loss:   0.463 (#OOM: 0)
Epoch 47 - update      22290 => loss:   0.479 (#OOM: 0)
Epoch 47 - update      22320 => loss:   0.653 (#OOM: 0)
Epoch 47 - update      22350 => loss:   0.564 (#OOM: 0)
Epoch 47 - update      22380 => loss:   0.901 (#OOM: 0)
Epoch 47 - update      22410 => loss:   0.459 (#OOM: 0)
--> Epoch 47 finished with mean loss 0.61235
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.61 mins)   (837 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.02batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.29batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 50.58batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.04batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.46batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.76batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 78.91batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.06batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 74.70batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 75.42batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 74.70batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 75.24batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.25batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 75.46batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.06batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.13batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 74.76batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.28batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.72batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.18batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 73.99batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.26batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.27batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.70batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.89batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.11batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.37batch/s] 20%|█████▎                     | 199/1014 [00:02<00:10, 74.93batch/s] 21%|█████▌                     | 209/1014 [00:02<00:10, 74.71batch/s] 22%|█████▊                     | 219/1014 [00:02<00:10, 75.34batch/s] 23%|██████                     | 229/1014 [00:03<00:10, 75.52batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 75.38batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 75.53batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 75.50batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.61batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 75.79batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 75.75batch/s] 29%|███████▉                   | 299/1014 [00:03<00:09, 75.47batch/s] 30%|████████▏                  | 309/1014 [00:04<00:09, 75.42batch/s] 31%|████████▍                  | 319/1014 [00:04<00:09, 74.95batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 75.11batch/s] 33%|█████████                  | 339/1014 [00:04<00:09, 75.00batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 75.27batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 75.09batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 75.12batch/s] 37%|██████████                 | 379/1014 [00:05<00:08, 75.14batch/s] 38%|██████████▎                | 389/1014 [00:05<00:08, 75.43batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 75.54batch/s] 40%|██████████▉                | 409/1014 [00:05<00:07, 75.63batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 75.39batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 75.42batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 75.53batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 75.46batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 75.50batch/s] 46%|████████████▍              | 469/1014 [00:06<00:07, 75.17batch/s] 47%|████████████▊              | 479/1014 [00:06<00:07, 75.42batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 75.42batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 75.43batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 75.36batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 75.32batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 75.48batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 75.28batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 75.13batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:06, 75.12batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 75.18batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 75.19batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 75.16batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 75.06batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 75.01batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 75.05batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 75.07batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 75.11batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 75.21batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 75.25batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 75.05batch/s] 67%|██████████████████         | 679/1014 [00:09<00:04, 74.99batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 75.03batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 74.95batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 74.80batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 74.96batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 74.86batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 74.89batch/s] 74%|███████████████████▉       | 749/1014 [00:10<00:03, 74.85batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 74.76batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 74.60batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 74.61batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:03, 74.63batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 74.62batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 74.60batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 74.65batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 74.52batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 74.65batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 74.65batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 74.64batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 74.62batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 74.71batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 74.75batch/s] 89%|███████████████████████▉   | 899/1014 [00:12<00:01, 74.87batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 74.77batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 74.68batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 74.59batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:01, 74.55batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 74.46batch/s] 95%|█████████████████████████▌ | 959/1014 [00:12<00:00, 74.40batch/s] 96%|█████████████████████████▊ | 969/1014 [00:13<00:00, 74.51batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 74.62batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 74.67batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 74.70batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 74.67batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.69batch/s]
Validation 47 -> LOSS = 1.16
Validation 47 -> BLEU = 55.77, 76.9/61.1/50.0/41.1 (BP=1.000, ratio=1.001, hyp_len=14394, ref_len=14382)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 48
Epoch 48 - update      22440 => loss:   0.565 (#OOM: 0)
Epoch 48 - update      22470 => loss:   0.489 (#OOM: 0)
Epoch 48 - update      22500 => loss:   0.459 (#OOM: 0)
Epoch 48 - update      22530 => loss:   0.885 (#OOM: 0)
Epoch 48 - update      22560 => loss:   0.530 (#OOM: 0)
Epoch 48 - update      22590 => loss:   0.538 (#OOM: 0)
Epoch 48 - update      22620 => loss:   0.539 (#OOM: 0)
Epoch 48 - update      22650 => loss:   0.681 (#OOM: 0)
Epoch 48 - update      22680 => loss:   0.635 (#OOM: 0)
Epoch 48 - update      22710 => loss:   0.476 (#OOM: 0)
Epoch 48 - update      22740 => loss:   0.582 (#OOM: 0)
Epoch 48 - update      22770 => loss:   0.498 (#OOM: 0)
Epoch 48 - update      22800 => loss:   0.536 (#OOM: 0)
Epoch 48 - update      22830 => loss:   0.839 (#OOM: 0)
Epoch 48 - update      22860 => loss:   0.497 (#OOM: 0)
Epoch 48 - update      22890 => loss:   0.838 (#OOM: 0)
--> Epoch 48 finished with mean loss 0.61231
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.69 mins)   (750 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.46batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.72batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 51.84batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 49.78batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.25batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.27batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.67batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.23batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 75.45batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.05batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 76.83batch/s]  5%|█▌                          | 55/1014 [00:00<00:12, 79.22batch/s]  6%|█▊                          | 65/1014 [00:00<00:12, 77.55batch/s]  7%|██                          | 75/1014 [00:00<00:12, 78.23batch/s]  8%|██▎                         | 85/1014 [00:01<00:11, 78.53batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 77.53batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 77.95batch/s] 11%|███                        | 115/1014 [00:01<00:11, 77.60batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 77.80batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.38batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 75.99batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 76.05batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 75.88batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 76.05batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 75.65batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 75.63batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 75.45batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.10batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.82batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 75.21batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 75.02batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 75.20batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.55batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.67batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.73batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.68batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.76batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.62batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 73.99batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.04batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:09, 74.15batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.08batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.08batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.24batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.15batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.27batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.16batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 74.24batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 74.41batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 74.55batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 74.43batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 74.55batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.65batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 74.58batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 74.53batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.67batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 74.81batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 74.80batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 74.85batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 74.83batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 74.84batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 74.79batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 74.70batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.52batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.49batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 74.46batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 74.54batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 74.65batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 74.55batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 74.49batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.58batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.76batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.86batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.06batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.13batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.10batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.04batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 74.89batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.86batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.78batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 74.58batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.45batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.48batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.34batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.29batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.43batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 74.30batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 74.14batch/s] 81%|█████████████████████▉     | 825/1014 [00:11<00:02, 74.06batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.17batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.20batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 74.21batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:02, 74.20batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 74.23batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 74.29batch/s] 88%|███████████████████████▊   | 895/1014 [00:12<00:01, 74.33batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 74.25batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 74.27batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.29batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 74.29batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 74.11batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.15batch/s] 95%|█████████████████████████▋ | 965/1014 [00:13<00:00, 74.22batch/s] 96%|█████████████████████████▉ | 975/1014 [00:13<00:00, 74.32batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 74.28batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 74.34batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 74.43batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.40batch/s]
Validation 48 -> LOSS = 1.16
Validation 48 -> BLEU = 55.82, 77.2/61.4/50.2/41.3 (BP=0.997, ratio=0.997, hyp_len=14332, ref_len=14382)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 49
Epoch 49 - update      22920 => loss:   0.504 (#OOM: 0)
Epoch 49 - update      22950 => loss:   0.775 (#OOM: 0)
Epoch 49 - update      22980 => loss:   0.526 (#OOM: 0)
Epoch 49 - update      23010 => loss:   0.472 (#OOM: 0)
Epoch 49 - update      23040 => loss:   0.625 (#OOM: 0)
Epoch 49 - update      23070 => loss:   0.505 (#OOM: 0)
Epoch 49 - update      23100 => loss:   0.411 (#OOM: 0)
Epoch 49 - update      23130 => loss:   0.571 (#OOM: 0)
Epoch 49 - update      23160 => loss:   0.596 (#OOM: 0)
Epoch 49 - update      23190 => loss:   0.594 (#OOM: 0)
Epoch 49 - update      23220 => loss:   0.703 (#OOM: 0)
Epoch 49 - update      23250 => loss:   0.760 (#OOM: 0)
Epoch 49 - update      23280 => loss:   0.717 (#OOM: 0)
Epoch 49 - update      23310 => loss:   0.719 (#OOM: 0)
Epoch 49 - update      23340 => loss:   0.734 (#OOM: 0)
Epoch 49 - update      23370 => loss:   0.699 (#OOM: 0)
--> Epoch 49 finished with mean loss 0.61380
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (855 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.94batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.16batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 50.80batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.98batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 49.71batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.40batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.91batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 78.44batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 81.20batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 78.65batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 76.75batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 75.29batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 74.69batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 73.57batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 74.68batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 74.33batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 73.64batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 73.28batch/s] 11%|███                        | 115/1014 [00:01<00:12, 73.58batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 74.39batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 74.22batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 73.76batch/s] 15%|████                       | 151/1014 [00:02<00:11, 73.41batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 73.09batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 73.16batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 73.37batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 73.35batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 73.23batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 73.61batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 73.35batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 73.65batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 73.71batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.12batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 74.13batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 73.87batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 74.08batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.06batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 73.87batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.00batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.37batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.55batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.57batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.04batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 74.94batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 74.90batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 74.83batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 74.64batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 74.61batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 74.39batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 74.25batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 74.23batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 74.13batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.32batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 74.11batch/s] 45%|████████████               | 452/1014 [00:06<00:07, 74.01batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 74.18batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 74.39batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.22batch/s] 49%|█████████████              | 492/1014 [00:06<00:07, 74.31batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.34batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 74.19batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 74.21batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 74.02batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 74.10batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 74.03batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:06, 74.10batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.10batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 74.21batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.15batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.29batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.14batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 73.96batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 73.75batch/s] 63%|█████████████████          | 642/1014 [00:08<00:05, 73.77batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 73.95batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 73.92batch/s] 66%|█████████████████▉         | 672/1014 [00:09<00:04, 73.90batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.03batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 74.12batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.09batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:04, 74.11batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 74.11batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 73.98batch/s] 73%|███████████████████▊       | 742/1014 [00:10<00:03, 74.06batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 74.03batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.13batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.32batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 74.29batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 74.42batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 74.42batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 74.42batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 74.35batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 74.48batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 74.41batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.56batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.57batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.62batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.58batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 74.54batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 74.52batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.48batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.43batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 74.40batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.45batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.54batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.65batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 74.61batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.67batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.72batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.75batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.72batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.73batch/s]
Validation 49 -> LOSS = 1.16
Validation 49 -> BLEU = 55.81, 76.9/61.2/50.1/41.2 (BP=1.000, ratio=1.001, hyp_len=14398, ref_len=14382)
** Learning rate changed -> 6.25e-06
Early stopping patience: 1
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 55.99 @ validation 40
Starting Epoch 50
Epoch 50 - update      23400 => loss:   0.673 (#OOM: 0)
Epoch 50 - update      23430 => loss:   0.538 (#OOM: 0)
Epoch 50 - update      23460 => loss:   0.626 (#OOM: 0)
Epoch 50 - update      23490 => loss:   0.486 (#OOM: 0)
Epoch 50 - update      23520 => loss:   0.499 (#OOM: 0)
Epoch 50 - update      23550 => loss:   0.570 (#OOM: 0)
Epoch 50 - update      23580 => loss:   0.569 (#OOM: 0)
Epoch 50 - update      23610 => loss:   0.644 (#OOM: 0)
Epoch 50 - update      23640 => loss:   0.527 (#OOM: 0)
Epoch 50 - update      23670 => loss:   0.313 (#OOM: 0)
Epoch 50 - update      23700 => loss:   0.620 (#OOM: 0)
Epoch 50 - update      23730 => loss:   0.521 (#OOM: 0)
Epoch 50 - update      23760 => loss:   0.553 (#OOM: 0)
Epoch 50 - update      23790 => loss:   0.571 (#OOM: 0)
Epoch 50 - update      23820 => loss:   0.625 (#OOM: 0)
Epoch 50 - update      23850 => loss:   0.598 (#OOM: 0)
--> Epoch 50 finished with mean loss 0.61063
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (773 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.42batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.72batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.97batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.00batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.43batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.07batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.05batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 69.59batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 78.06batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 79.57batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 80.43batch/s]  4%|█▏                          | 43/1014 [00:00<00:11, 81.18batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 78.25batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 77.07batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 78.10batch/s]  8%|██▏                         | 79/1014 [00:00<00:11, 79.23batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 78.70batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 78.52batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 78.16batch/s] 11%|███                        | 115/1014 [00:01<00:11, 77.20batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 76.44batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 76.93batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 77.23batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.98batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 77.01batch/s] 17%|████▌                      | 169/1014 [00:02<00:10, 77.03batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 77.27batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.27batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.19batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.17batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 76.28batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 76.03batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.93batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 75.68batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 75.35batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 75.17batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.00batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.67batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.79batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.91batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.03batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.94batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.87batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 75.19batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.10batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 75.22batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.35batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.32batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.39batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.30batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.18batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.96batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 75.00batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 75.16batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 75.13batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 75.03batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.15batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.06batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 74.97batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.18batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.17batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.06batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 75.21batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 75.08batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 75.23batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 75.41batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.51batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.36batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.42batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.45batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.41batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.34batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 75.26batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 75.21batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 75.42batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.26batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 74.97batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 74.91batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 74.99batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 75.13batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 75.11batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 75.10batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 75.18batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 75.01batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 74.96batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 74.79batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 74.86batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 74.79batch/s] 74%|███████████████████▉       | 751/1014 [00:10<00:03, 74.84batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 74.79batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 74.76batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 74.58batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 74.59batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.56batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 74.49batch/s] 81%|█████████████████████▊     | 821/1014 [00:11<00:02, 74.53batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 74.66batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 74.58batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 74.58batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 74.66batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 74.73batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 74.75batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 74.83batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 74.72batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 74.86batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 74.73batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 74.62batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 74.67batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 74.68batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 74.68batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 74.72batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 74.75batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 74.78batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 74.76batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 74.85batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.83batch/s]
Validation 50 -> LOSS = 1.16
Validation 50 -> BLEU = 56.07, 77.1/61.4/50.4/41.5 (BP=1.000, ratio=1.000, hyp_len=14377, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 51
Epoch 51 - update      23880 => loss:   0.529 (#OOM: 0)
Epoch 51 - update      23910 => loss:   0.461 (#OOM: 0)
Epoch 51 - update      23940 => loss:   0.496 (#OOM: 0)
Epoch 51 - update      23970 => loss:   0.617 (#OOM: 0)
Epoch 51 - update      24000 => loss:   0.401 (#OOM: 0)
Epoch 51 - update      24030 => loss:   0.570 (#OOM: 0)
Epoch 51 - update      24060 => loss:   0.474 (#OOM: 0)
Epoch 51 - update      24090 => loss:   0.364 (#OOM: 0)
Epoch 51 - update      24120 => loss:   0.413 (#OOM: 0)
Epoch 51 - update      24150 => loss:   0.439 (#OOM: 0)
Epoch 51 - update      24180 => loss:   0.612 (#OOM: 0)
Epoch 51 - update      24210 => loss:   0.693 (#OOM: 0)
Epoch 51 - update      24240 => loss:   0.546 (#OOM: 0)
Epoch 51 - update      24270 => loss:   0.384 (#OOM: 0)
Epoch 51 - update      24300 => loss:   0.463 (#OOM: 0)
--> Epoch 51 finished with mean loss 0.60771
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (797 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.09batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 48.29batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 48.02batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 47.44batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 51.83batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.76batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.40batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 70.90batch/s]  2%|▋                           | 25/1014 [00:00<00:13, 73.78batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 71.40batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 70.05batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 71.79batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 69.60batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 70.51batch/s]  8%|██▏                         | 79/1014 [00:01<00:13, 71.31batch/s]  9%|██▍                         | 88/1014 [00:01<00:13, 71.12batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 71.59batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 72.29batch/s] 11%|███                        | 115/1014 [00:01<00:12, 71.86batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 72.19batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 71.62batch/s] 14%|███▊                       | 142/1014 [00:01<00:12, 71.60batch/s] 15%|████                       | 151/1014 [00:02<00:12, 71.48batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 72.20batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 72.89batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 72.28batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 72.70batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 73.06batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 73.58batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 73.71batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 74.14batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 74.21batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.27batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 74.29batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 74.54batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 74.87batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.83batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.72batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.46batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 74.65batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.54batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.38batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 74.48batch/s] 34%|█████████                  | 340/1014 [00:04<00:09, 74.40batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 74.46batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 74.35batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.23batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.51batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.59batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 74.41batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 74.36batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 74.12batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 74.14batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 73.97batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 74.08batch/s] 44%|███████████▉               | 448/1014 [00:06<00:07, 73.90batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 73.97batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 73.92batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 74.13batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 74.23batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:07, 74.12batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 74.13batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 73.98batch/s] 51%|█████████████▊             | 520/1014 [00:07<00:06, 74.08batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 74.06batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 74.10batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 73.90batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 73.97batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 73.83batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 73.88batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 73.89batch/s] 58%|███████████████▊           | 592/1014 [00:08<00:05, 73.93batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 73.81batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 73.71batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 73.63batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 73.55batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 73.44batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:05, 73.45batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 73.49batch/s] 65%|█████████████████▋         | 664/1014 [00:09<00:04, 73.40batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 73.61batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 73.55batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 73.62batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 73.63batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 73.64batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 73.39batch/s] 72%|███████████████████▌       | 734/1014 [00:10<00:03, 73.34batch/s] 73%|███████████████████▊       | 744/1014 [00:10<00:03, 73.33batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 73.38batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 73.39batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 73.39batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 73.46batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 73.60batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 73.64batch/s] 80%|█████████████████████▋     | 814/1014 [00:11<00:02, 73.60batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 73.69batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 73.71batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 73.73batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 73.82batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 73.83batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 73.83batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 73.92batch/s] 88%|███████████████████████▊   | 894/1014 [00:12<00:01, 73.92batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.00batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.11batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.07batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.18batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.11batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.10batch/s] 95%|█████████████████████████▋ | 964/1014 [00:13<00:00, 74.13batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.08batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.17batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.20batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.24batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.09batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.09batch/s]
Validation 51 -> LOSS = 1.16
Validation 51 -> BLEU = 55.87, 77.0/61.3/50.1/41.2 (BP=1.000, ratio=1.001, hyp_len=14401, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 52
Epoch 52 - update      24330 => loss:   0.360 (#OOM: 0)
Epoch 52 - update      24360 => loss:   0.741 (#OOM: 0)
Epoch 52 - update      24390 => loss:   0.373 (#OOM: 0)
Epoch 52 - update      24420 => loss:   0.164 (#OOM: 0)
Epoch 52 - update      24450 => loss:   0.477 (#OOM: 0)
Epoch 52 - update      24480 => loss:   0.793 (#OOM: 0)
Epoch 52 - update      24510 => loss:   0.649 (#OOM: 0)
Epoch 52 - update      24540 => loss:   0.662 (#OOM: 0)
Epoch 52 - update      24570 => loss:   0.627 (#OOM: 0)
Epoch 52 - update      24600 => loss:   0.691 (#OOM: 0)
Epoch 52 - update      24630 => loss:   0.437 (#OOM: 0)
Epoch 52 - update      24660 => loss:   0.602 (#OOM: 0)
Epoch 52 - update      24690 => loss:   0.605 (#OOM: 0)
Epoch 52 - update      24720 => loss:   0.615 (#OOM: 0)
Epoch 52 - update      24750 => loss:   0.538 (#OOM: 0)
Epoch 52 - update      24780 => loss:   0.743 (#OOM: 0)
--> Epoch 52 finished with mean loss 0.61167
--> Overhead/Training/Evaluation: 0.03/0.50/0.00 mins (total: 0.53 mins)   (971 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.00batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.09batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.36batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 51.17batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.25batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.58batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 69.09batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 70.64batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 71.14batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.40batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 74.77batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 78.07batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 78.05batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 77.56batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 78.34batch/s]  9%|██▌                         | 91/1014 [00:01<00:11, 78.04batch/s] 10%|██▋                        | 101/1014 [00:01<00:11, 79.06batch/s] 11%|██▉                        | 111/1014 [00:01<00:11, 78.63batch/s] 12%|███▏                       | 121/1014 [00:01<00:11, 77.35batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 77.25batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 77.08batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.57batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.67batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 76.96batch/s] 18%|████▊                      | 181/1014 [00:02<00:10, 76.85batch/s] 19%|█████                      | 191/1014 [00:02<00:10, 76.75batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 77.05batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 76.96batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 76.85batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 76.67batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 76.21batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 76.09batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 75.80batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 75.93batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 75.99batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 75.94batch/s] 30%|████████                   | 301/1014 [00:03<00:09, 75.89batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 76.28batch/s] 32%|████████▌                  | 321/1014 [00:04<00:09, 76.04batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 75.96batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 76.18batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 76.35batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 76.54batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 76.66batch/s] 38%|██████████▏                | 381/1014 [00:04<00:08, 76.84batch/s] 39%|██████████▍                | 391/1014 [00:05<00:08, 76.42batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 76.16batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 76.03batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 76.03batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 76.16batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 76.30batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 76.32batch/s] 45%|████████████▎              | 461/1014 [00:06<00:07, 76.14batch/s] 46%|████████████▌              | 471/1014 [00:06<00:07, 76.26batch/s] 47%|████████████▊              | 481/1014 [00:06<00:07, 75.96batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 75.97batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 76.17batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 76.08batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 76.21batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 76.33batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 76.18batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 76.04batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 75.88batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 76.00batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 75.64batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 75.45batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 75.54batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 75.71batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 75.52batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 75.49batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 75.47batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 75.34batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 75.25batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 75.11batch/s] 67%|██████████████████▏        | 681/1014 [00:09<00:04, 75.08batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 75.09batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 75.20batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 75.33batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 75.28batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 75.32batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 75.27batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 75.23batch/s] 75%|████████████████████▎      | 761/1014 [00:10<00:03, 75.16batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 75.21batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 75.19batch/s] 78%|█████████████████████      | 791/1014 [00:10<00:02, 75.26batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 75.32batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 75.36batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 75.32batch/s] 82%|██████████████████████▏    | 831/1014 [00:11<00:02, 75.38batch/s] 83%|██████████████████████▍    | 841/1014 [00:11<00:02, 75.43batch/s] 84%|██████████████████████▋    | 851/1014 [00:11<00:02, 75.46batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 75.40batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 75.36batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 75.27batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 75.31batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 75.06batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 75.11batch/s] 91%|████████████████████████▌  | 921/1014 [00:12<00:01, 74.95batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 74.82batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 74.79batch/s] 94%|█████████████████████████▎ | 951/1014 [00:12<00:00, 74.73batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 74.84batch/s] 96%|█████████████████████████▊ | 971/1014 [00:13<00:00, 74.68batch/s] 97%|██████████████████████████ | 981/1014 [00:13<00:00, 74.66batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 74.66batch/s] 99%|█████████████████████████▋| 1001/1014 [00:13<00:00, 74.78batch/s]100%|█████████████████████████▉| 1011/1014 [00:13<00:00, 74.79batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.83batch/s]
Validation 52 -> LOSS = 1.16
Validation 52 -> BLEU = 55.85, 76.9/61.2/50.1/41.2 (BP=1.000, ratio=1.001, hyp_len=14395, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 53
Epoch 53 - update      24810 => loss:   0.150 (#OOM: 0)
Epoch 53 - update      24840 => loss:   0.536 (#OOM: 0)
Epoch 53 - update      24870 => loss:   0.502 (#OOM: 0)
Epoch 53 - update      24900 => loss:   0.534 (#OOM: 0)
Epoch 53 - update      24930 => loss:   0.397 (#OOM: 0)
Epoch 53 - update      24960 => loss:   0.464 (#OOM: 0)
Epoch 53 - update      24990 => loss:   0.557 (#OOM: 0)
Epoch 53 - update      25020 => loss:   0.493 (#OOM: 0)
Epoch 53 - update      25050 => loss:   0.537 (#OOM: 0)
Epoch 53 - update      25080 => loss:   0.580 (#OOM: 0)
Epoch 53 - update      25110 => loss:   0.539 (#OOM: 0)
Epoch 53 - update      25140 => loss:   0.534 (#OOM: 0)
Epoch 53 - update      25170 => loss:   0.661 (#OOM: 0)
Epoch 53 - update      25200 => loss:   0.651 (#OOM: 0)
Epoch 53 - update      25230 => loss:   0.380 (#OOM: 0)
Epoch 53 - update      25260 => loss:   0.676 (#OOM: 0)
--> Epoch 53 finished with mean loss 0.60869
--> Overhead/Training/Evaluation: 0.02/0.46/0.00 mins (total: 0.48 mins)   (1053 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.54batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.69batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.71batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.08batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.46batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.20batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.10batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.40batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.89batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 79.59batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.24batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.64batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.84batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 77.45batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 77.21batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 75.84batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.45batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 75.00batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.43batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.62batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.33batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.40batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.74batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.59batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.59batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.31batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.37batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 74.28batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 74.19batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.40batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.38batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.76batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 75.25batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 75.21batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 75.69batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 75.73batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.73batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.57batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.70batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.47batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.47batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 75.70batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 75.26batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 75.41batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 75.51batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 75.41batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 75.51batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.45batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.50batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.26batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.29batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.48batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.08batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 75.11batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.01batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.69batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 74.85batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 74.98batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.93batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 74.77batch/s] 52%|█████████████▉             | 524/1014 [00:07<00:06, 74.60batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 74.69batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 74.71batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 74.58batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 74.53batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 74.46batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.43batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.26batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 74.25batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 74.35batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 74.42batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 74.40batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.46batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.41batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 74.41batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 74.38batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.41batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 74.42batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 74.38batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 74.44batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.49batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 74.57batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 74.62batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.59batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.49batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 74.56batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.53batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 74.57batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.64batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.58batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.66batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.73batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.71batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.73batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.74batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.74batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.74batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 74.78batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.66batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.40batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.30batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.27batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.34batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.26batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.33batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.40batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.33batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.40batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.36batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.26batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.25batch/s]
Validation 53 -> LOSS = 1.16
Validation 53 -> BLEU = 55.62, 76.8/61.0/49.9/41.0 (BP=1.000, ratio=1.002, hyp_len=14407, ref_len=14382)
** Learning rate changed -> 3.125e-06
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 54
Epoch 54 - update      25290 => loss:   0.814 (#OOM: 0)
Epoch 54 - update      25320 => loss:   0.501 (#OOM: 0)
Epoch 54 - update      25350 => loss:   0.525 (#OOM: 0)
Epoch 54 - update      25380 => loss:   0.594 (#OOM: 0)
Epoch 54 - update      25410 => loss:   0.687 (#OOM: 0)
Epoch 54 - update      25440 => loss:   0.510 (#OOM: 0)
Epoch 54 - update      25470 => loss:   0.384 (#OOM: 0)
Epoch 54 - update      25500 => loss:   0.488 (#OOM: 0)
Epoch 54 - update      25530 => loss:   0.577 (#OOM: 0)
Epoch 54 - update      25560 => loss:   0.579 (#OOM: 0)
Epoch 54 - update      25590 => loss:   0.454 (#OOM: 0)
Epoch 54 - update      25620 => loss:   0.646 (#OOM: 0)
Epoch 54 - update      25650 => loss:   0.444 (#OOM: 0)
Epoch 54 - update      25680 => loss:   0.622 (#OOM: 0)
Epoch 54 - update      25710 => loss:   0.482 (#OOM: 0)
Epoch 54 - update      25740 => loss:   0.849 (#OOM: 0)
--> Epoch 54 finished with mean loss 0.60639
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (814 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.39batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.24batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.82batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.30batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.62batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.18batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.16batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 71.88batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 78.00batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 80.84batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 80.26batch/s]  4%|█▏                          | 44/1014 [00:00<00:11, 81.64batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 79.54batch/s]  6%|█▋                          | 62/1014 [00:00<00:11, 79.77batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 77.54batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 78.21batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 76.24batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 75.66batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 75.63batch/s] 11%|███                        | 116/1014 [00:01<00:11, 75.43batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 75.63batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.12batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.04batch/s] 15%|████                       | 152/1014 [00:02<00:11, 74.70batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 74.74batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 75.03batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 75.58batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.15batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 75.13batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.98batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.48batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.28batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.10batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.02batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.30batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 74.78batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 74.52batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 74.86batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.31batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.61batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 74.59batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.78batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.08batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.23batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 74.89batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 74.75batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 74.90batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 74.96batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.95batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.04batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.18batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.12batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.43batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.52batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.70batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.86batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 75.96batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.77batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.63batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.64batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.58batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.44batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.34batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.34batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 75.23batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.34batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.37batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.45batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.25batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.28batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.25batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 75.19batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.09batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.00batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 74.85batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.94batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.05batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.11batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 74.95batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.90batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 74.94batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 74.90batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 74.85batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.88batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 74.80batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 74.58batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.58batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.75batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 74.78batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.71batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 74.78batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 74.83batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.74batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.78batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.66batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.49batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.55batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.53batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.68batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.75batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 74.79batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.77batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.74batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.64batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.61batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.64batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.72batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.78batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.80batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.76batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.72batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.71batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.66batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.66batch/s]
Validation 54 -> LOSS = 1.16
Validation 54 -> BLEU = 55.78, 77.0/61.2/50.1/41.2 (BP=0.998, ratio=0.998, hyp_len=14357, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 55
Epoch 55 - update      25770 => loss:   0.753 (#OOM: 0)
Epoch 55 - update      25800 => loss:   0.673 (#OOM: 0)
Epoch 55 - update      25830 => loss:   0.844 (#OOM: 0)
Epoch 55 - update      25860 => loss:   0.490 (#OOM: 0)
Epoch 55 - update      25890 => loss:   0.721 (#OOM: 0)
Epoch 55 - update      25920 => loss:   0.560 (#OOM: 0)
Epoch 55 - update      25950 => loss:   0.471 (#OOM: 0)
Epoch 55 - update      25980 => loss:   0.559 (#OOM: 0)
Epoch 55 - update      26010 => loss:   0.497 (#OOM: 0)
Epoch 55 - update      26040 => loss:   0.804 (#OOM: 0)
Epoch 55 - update      26070 => loss:   0.777 (#OOM: 0)
Epoch 55 - update      26100 => loss:   0.563 (#OOM: 0)
Epoch 55 - update      26130 => loss:   0.611 (#OOM: 0)
Epoch 55 - update      26160 => loss:   0.721 (#OOM: 0)
Epoch 55 - update      26190 => loss:   0.385 (#OOM: 0)
Epoch 55 - update      26220 => loss:   0.546 (#OOM: 0)
--> Epoch 55 finished with mean loss 0.60614
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (759 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.59batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.22batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 50.88batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 49.06batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 48.97batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.12batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.61batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 67.87batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 70.60batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 71.20batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 73.67batch/s]  5%|█▍                          | 50/1014 [00:00<00:13, 73.08batch/s]  6%|█▋                          | 59/1014 [00:00<00:13, 73.21batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 73.53batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 74.41batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 74.73batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 75.04batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 75.65batch/s] 11%|███                        | 113/1014 [00:01<00:11, 75.87batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 74.19batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 74.15batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 74.23batch/s] 15%|███▉                       | 149/1014 [00:02<00:11, 74.38batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 74.51batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 73.98batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 74.36batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 73.98batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 74.59batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.60batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 74.92batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 74.43batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 73.92batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 73.89batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 73.80batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 74.14batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 74.57batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.71batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 74.84batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 74.56batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 74.66batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 74.73batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 74.54batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 74.80batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 75.00batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 75.13batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.30batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.11batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.75batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.77batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 74.82batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 74.79batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 74.57batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 74.62batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 74.75batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.76batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 74.59batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 74.46batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 74.40batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 74.47batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 74.69batch/s] 48%|█████████████              | 491/1014 [00:06<00:07, 74.59batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 74.69batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 74.46batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 74.42batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 74.38batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 74.21batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 74.21batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 74.05batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 74.14batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 74.15batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 74.11batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 73.99batch/s] 59%|███████████████▉           | 599/1014 [00:08<00:05, 73.95batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 73.89batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 74.01batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 73.96batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 74.00batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.07batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 74.22batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 74.13batch/s] 66%|█████████████████▊         | 671/1014 [00:09<00:04, 74.09batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 74.05batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 74.03batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 74.04batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.05batch/s] 71%|███████████████████        | 716/1014 [00:09<00:04, 73.95batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 73.99batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 74.13batch/s] 73%|███████████████████▊       | 743/1014 [00:10<00:03, 74.09batch/s] 74%|████████████████████       | 752/1014 [00:10<00:03, 74.05batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 74.23batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.19batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 74.27batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 74.21batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 74.15batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 74.25batch/s] 81%|█████████████████████▉     | 822/1014 [00:11<00:02, 74.31batch/s] 82%|██████████████████████▏    | 832/1014 [00:11<00:02, 74.36batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 74.44batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 74.26batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.26batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 74.35batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 74.44batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 74.42batch/s] 89%|████████████████████████   | 902/1014 [00:12<00:01, 74.45batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 74.52batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.53batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 74.40batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 74.34batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.25batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 74.31batch/s] 96%|█████████████████████████▉ | 972/1014 [00:13<00:00, 74.30batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 74.34batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 74.45batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 74.47batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 74.45batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.49batch/s]
Validation 55 -> LOSS = 1.16
Validation 55 -> BLEU = 55.74, 76.9/61.1/50.0/41.1 (BP=1.000, ratio=1.000, hyp_len=14384, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 56
Epoch 56 - update      26250 => loss:   0.727 (#OOM: 0)
Epoch 56 - update      26280 => loss:   0.493 (#OOM: 0)
Epoch 56 - update      26310 => loss:   0.568 (#OOM: 0)
Epoch 56 - update      26340 => loss:   0.586 (#OOM: 0)
Epoch 56 - update      26370 => loss:   0.672 (#OOM: 0)
Epoch 56 - update      26400 => loss:   0.374 (#OOM: 0)
Epoch 56 - update      26430 => loss:   0.546 (#OOM: 0)
Epoch 56 - update      26460 => loss:   0.845 (#OOM: 0)
Epoch 56 - update      26490 => loss:   0.603 (#OOM: 0)
Epoch 56 - update      26520 => loss:   0.568 (#OOM: 0)
Epoch 56 - update      26550 => loss:   0.547 (#OOM: 0)
Epoch 56 - update      26580 => loss:   0.649 (#OOM: 0)
Epoch 56 - update      26610 => loss:   0.563 (#OOM: 0)
Epoch 56 - update      26640 => loss:   0.585 (#OOM: 0)
Epoch 56 - update      26670 => loss:   0.599 (#OOM: 0)
Epoch 56 - update      26700 => loss:   0.489 (#OOM: 0)
--> Epoch 56 finished with mean loss 0.60708
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (830 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.59batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.14batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.28batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 48.05batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.08batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.32batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 84.18batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.23batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 72.68batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 71.23batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 69.95batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 72.47batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 71.34batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 72.52batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 72.63batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 72.52batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 72.57batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 72.29batch/s] 12%|███                        | 117/1014 [00:01<00:12, 72.13batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 72.69batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 73.26batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.50batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.88batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 73.47batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 73.47batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 72.81batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 72.56batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 72.86batch/s] 20%|█████▌                     | 207/1014 [00:02<00:11, 73.09batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 73.66batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 73.10batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 73.21batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 73.36batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 73.92batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 73.82batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.10batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.24batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 74.63batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 74.66batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 74.67batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 74.33batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 74.34batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 74.20batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.35batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.36batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.36batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.55batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 74.29batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 74.41batch/s] 41%|███████████                | 417/1014 [00:05<00:08, 74.28batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 74.30batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.25batch/s] 44%|███████████▉               | 447/1014 [00:06<00:07, 74.26batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 74.25batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.34batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.08batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 74.16batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.17batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 73.99batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 73.95batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 74.04batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 73.98batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 73.72batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 73.53batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 73.75batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 73.69batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 73.71batch/s] 59%|███████████████▉           | 597/1014 [00:08<00:05, 73.66batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 73.87batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 73.75batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 73.78batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 73.95batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 73.97batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 73.95batch/s] 66%|█████████████████▊         | 667/1014 [00:09<00:04, 74.02batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 74.16batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 74.17batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 74.34batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.40batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 74.34batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.39batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 74.28batch/s] 74%|███████████████████▉       | 747/1014 [00:10<00:03, 74.31batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 74.44batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 74.53batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 74.46batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 74.45batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 74.59batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 74.74batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.79batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 74.88batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 74.83batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 74.93batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 74.91batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 74.96batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 74.93batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.01batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 74.85batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.88batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.88batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.81batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.72batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 74.83batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 74.70batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 74.67batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.68batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.68batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 74.82batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 74.74batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.69batch/s]
Validation 56 -> LOSS = 1.16
Validation 56 -> BLEU = 55.58, 76.8/61.0/49.9/40.9 (BP=1.000, ratio=1.000, hyp_len=14375, ref_len=14382)
** Learning rate changed -> 1.5625e-06
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 57
Epoch 57 - update      26730 => loss:   0.698 (#OOM: 0)
Epoch 57 - update      26760 => loss:   0.468 (#OOM: 0)
Epoch 57 - update      26790 => loss:   0.536 (#OOM: 0)
Epoch 57 - update      26820 => loss:   0.520 (#OOM: 0)
Epoch 57 - update      26850 => loss:   0.803 (#OOM: 0)
Epoch 57 - update      26880 => loss:   0.369 (#OOM: 0)
Epoch 57 - update      26910 => loss:   0.477 (#OOM: 0)
Epoch 57 - update      26940 => loss:   0.578 (#OOM: 0)
Epoch 57 - update      26970 => loss:   0.741 (#OOM: 0)
Epoch 57 - update      27000 => loss:   0.437 (#OOM: 0)
Epoch 57 - update      27030 => loss:   0.460 (#OOM: 0)
Epoch 57 - update      27060 => loss:   0.350 (#OOM: 0)
Epoch 57 - update      27090 => loss:   0.468 (#OOM: 0)
Epoch 57 - update      27120 => loss:   0.509 (#OOM: 0)
Epoch 57 - update      27150 => loss:   0.606 (#OOM: 0)
Epoch 57 - update      27180 => loss:   0.618 (#OOM: 0)
--> Epoch 57 finished with mean loss 0.60581
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (784 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.73batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.31batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.70batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.96batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.23batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.10batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.08batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 71.75batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.44batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.40batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 77.23batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 78.40batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 77.27batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 77.98batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 77.71batch/s]  8%|██▏                         | 79/1014 [00:01<00:11, 78.62batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 77.68batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 76.15batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 76.20batch/s] 11%|███                        | 115/1014 [00:01<00:11, 77.02batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 77.24batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 77.42batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 76.99batch/s] 15%|████                       | 151/1014 [00:01<00:11, 77.08batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.21batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 76.48batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 76.46batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.17batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.17batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.27batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 76.64batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.65batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.52batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 75.47batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 75.46batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 75.55batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.67batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.51batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.41batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.20batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.29batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 75.61batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.41batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 75.56batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.77batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 75.71batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.54batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.57batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.51batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.52batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.67batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.75batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.83batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 75.82batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 75.68batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 75.75batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.72batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.72batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.92batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.82batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.55batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.49batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 75.66batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 75.75batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 75.55batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 75.54batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.38batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.31batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.31batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.49batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.64batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.72batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 75.75batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 75.65batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 75.55batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 75.59batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 75.59batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 75.46batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.52batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.32batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.36batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.20batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 75.18batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 75.29batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.17batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 75.08batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 75.06batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.08batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.00batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.02batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 75.04batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.00batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.94batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 74.86batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 74.82batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 74.81batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 74.92batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.92batch/s] 81%|█████████████████████▉     | 826/1014 [00:11<00:02, 74.71batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 74.75batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.66batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 74.60batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 74.65batch/s] 86%|███████████████████████▏   | 871/1014 [00:11<00:01, 74.60batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 74.60batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 74.58batch/s] 89%|███████████████████████▉   | 898/1014 [00:12<00:01, 74.56batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.39batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 74.43batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 74.43batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.37batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 74.38batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 74.41batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 74.34batch/s] 96%|█████████████████████████▊ | 970/1014 [00:13<00:00, 74.43batch/s] 97%|██████████████████████████ | 979/1014 [00:13<00:00, 74.41batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 74.43batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 74.48batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 74.41batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.49batch/s]
Validation 57 -> LOSS = 1.16
Validation 57 -> BLEU = 55.73, 76.9/61.1/50.0/41.1 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 58
Epoch 58 - update      27210 => loss:   0.516 (#OOM: 0)
Epoch 58 - update      27240 => loss:   0.502 (#OOM: 0)
Epoch 58 - update      27270 => loss:   0.520 (#OOM: 0)
Epoch 58 - update      27300 => loss:   0.482 (#OOM: 0)
Epoch 58 - update      27330 => loss:   0.675 (#OOM: 0)
Epoch 58 - update      27360 => loss:   0.455 (#OOM: 0)
Epoch 58 - update      27390 => loss:   0.652 (#OOM: 0)
Epoch 58 - update      27420 => loss:   0.659 (#OOM: 0)
Epoch 58 - update      27450 => loss:   0.597 (#OOM: 0)
Epoch 58 - update      27480 => loss:   0.792 (#OOM: 0)
Epoch 58 - update      27510 => loss:   0.488 (#OOM: 0)
Epoch 58 - update      27540 => loss:   0.736 (#OOM: 0)
Epoch 58 - update      27570 => loss:   0.749 (#OOM: 0)
Epoch 58 - update      27600 => loss:   0.479 (#OOM: 0)
Epoch 58 - update      27630 => loss:   0.862 (#OOM: 0)
Epoch 58 - update      27660 => loss:   0.419 (#OOM: 0)
--> Epoch 58 finished with mean loss 0.60617
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (790 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 48.45batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.38batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.53batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.86batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.26batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.16batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 71.23batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.54batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.31batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 69.08batch/s]  4%|█                           | 40/1014 [00:00<00:13, 69.93batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 70.62batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 70.76batch/s]  6%|█▊                          | 64/1014 [00:00<00:13, 71.28batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 71.15batch/s]  8%|██▏                         | 80/1014 [00:01<00:13, 70.32batch/s]  9%|██▍                         | 88/1014 [00:01<00:13, 70.38batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 70.88batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 71.10batch/s] 11%|██▉                        | 112/1014 [00:01<00:12, 71.12batch/s] 12%|███▏                       | 120/1014 [00:01<00:12, 71.13batch/s] 13%|███▍                       | 128/1014 [00:01<00:12, 71.48batch/s] 14%|███▋                       | 137/1014 [00:01<00:12, 72.05batch/s] 14%|███▉                       | 147/1014 [00:02<00:11, 73.25batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 73.27batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 72.50batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 72.31batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 72.65batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 73.17batch/s] 20%|█████▌                     | 207/1014 [00:02<00:11, 73.24batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 73.59batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 73.37batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 73.36batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 73.42batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 72.83batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 72.52batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 72.34batch/s] 28%|███████▋                   | 287/1014 [00:03<00:10, 72.26batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 72.79batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 72.76batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 72.73batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 72.74batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 72.74batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:09, 73.16batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 73.55batch/s] 36%|█████████▊                 | 367/1014 [00:05<00:08, 73.24batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 73.24batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 73.27batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 73.36batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 73.20batch/s] 41%|███████████                | 417/1014 [00:05<00:08, 72.97batch/s] 42%|███████████▎               | 427/1014 [00:05<00:08, 72.84batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 73.14batch/s] 44%|███████████▉               | 447/1014 [00:06<00:07, 72.91batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 73.29batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 73.43batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 73.50batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 73.30batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:07, 73.33batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 73.28batch/s] 51%|█████████████▊             | 517/1014 [00:07<00:06, 73.28batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 73.30batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 73.38batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 73.32batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 73.48batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 73.53batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 73.71batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 73.62batch/s] 59%|███████████████▉           | 597/1014 [00:08<00:05, 73.66batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 73.83batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 74.02batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 74.12batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 74.15batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 74.11batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.19batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 74.21batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 74.26batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 74.25batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 74.22batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.27batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 74.28batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.21batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 74.30batch/s] 74%|███████████████████▉       | 747/1014 [00:10<00:03, 74.41batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 74.49batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 74.42batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 74.43batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 74.55batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 74.50batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 74.50batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.58batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 74.54batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 74.51batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 74.53batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 74.48batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 74.50batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 74.56batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 74.49batch/s] 88%|███████████████████████▉   | 897/1014 [00:12<00:01, 74.53batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.55batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.57batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.50batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.51batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 74.59batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 74.50batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 74.60batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.64batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.66batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 74.67batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 74.75batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.62batch/s]
Validation 58 -> LOSS = 1.16
Validation 58 -> BLEU = 55.70, 76.8/61.0/50.0/41.1 (BP=1.000, ratio=1.000, hyp_len=14383, ref_len=14382)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 59
Epoch 59 - update      27690 => loss:   0.538 (#OOM: 0)
Epoch 59 - update      27720 => loss:   0.536 (#OOM: 0)
Epoch 59 - update      27750 => loss:   0.482 (#OOM: 0)
Epoch 59 - update      27780 => loss:   0.373 (#OOM: 0)
Epoch 59 - update      27810 => loss:   0.414 (#OOM: 0)
Epoch 59 - update      27840 => loss:   0.857 (#OOM: 0)
Epoch 59 - update      27870 => loss:   0.692 (#OOM: 0)
Epoch 59 - update      27900 => loss:   0.667 (#OOM: 0)
Epoch 59 - update      27930 => loss:   0.704 (#OOM: 0)
Epoch 59 - update      27960 => loss:   0.531 (#OOM: 0)
Epoch 59 - update      27990 => loss:   0.556 (#OOM: 0)
Epoch 59 - update      28020 => loss:   0.597 (#OOM: 0)
Epoch 59 - update      28050 => loss:   0.368 (#OOM: 0)
Epoch 59 - update      28080 => loss:   0.694 (#OOM: 0)
Epoch 59 - update      28110 => loss:   0.535 (#OOM: 0)
Epoch 59 - update      28140 => loss:   0.561 (#OOM: 0)
--> Epoch 59 finished with mean loss 0.60757
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (808 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.20batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 48.92batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 48.89batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.98batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.12batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.95batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 69.60batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 71.07batch/s]  2%|▋                           | 23/1014 [00:00<00:14, 68.14batch/s]  3%|▊                           | 31/1014 [00:00<00:14, 65.84batch/s]  4%|█                           | 39/1014 [00:00<00:14, 68.11batch/s]  5%|█▎                          | 47/1014 [00:00<00:13, 69.64batch/s]  5%|█▌                          | 55/1014 [00:00<00:13, 69.90batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 69.24batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 70.65batch/s]  8%|██▏                         | 81/1014 [00:01<00:13, 70.36batch/s]  9%|██▍                         | 90/1014 [00:01<00:13, 71.06batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 71.07batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 71.43batch/s] 12%|███                        | 117/1014 [00:01<00:12, 71.16batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 71.05batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 71.32batch/s] 14%|███▊                       | 144/1014 [00:02<00:12, 71.84batch/s] 15%|████                       | 153/1014 [00:02<00:11, 72.00batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 72.32batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 72.25batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 72.87batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 72.96batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 73.14batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 73.62batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 74.34batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 74.70batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 75.24batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 75.42batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.28batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.19batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.16batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.86batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 74.73batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 74.98batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.05batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 75.28batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 75.17batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 75.26batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 75.46batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.16batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 75.00batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.34batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 75.29batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 75.21batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 75.32batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 75.35batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 75.07batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 75.19batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.32batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 75.38batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 75.26batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 75.45batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 75.54batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 75.75batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 75.76batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 75.50batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 75.61batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.69batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 75.58batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.53batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 75.69batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 75.55batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 75.34batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 75.23batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.32batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 75.24batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 75.29batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.46batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.45batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.43batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 75.34batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.34batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.17batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.17batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.12batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.11batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.27batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.25batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 75.20batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.29batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.25batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 75.29batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.37batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.37batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.28batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 75.35batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.21batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.30batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.25batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.25batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.12batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.17batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.13batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 75.14batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 75.11batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.22batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 75.11batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.04batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.06batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.11batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 75.05batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.05batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.04batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.13batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.06batch/s]
Validation 59 -> LOSS = 1.16
Validation 59 -> BLEU = 55.72, 76.8/61.1/50.0/41.1 (BP=1.000, ratio=1.000, hyp_len=14384, ref_len=14382)
** Learning rate changed -> 1e-06
Early stopping patience: 1
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 60
Epoch 60 - update      28170 => loss:   0.432 (#OOM: 0)
Epoch 60 - update      28200 => loss:   0.850 (#OOM: 0)
Epoch 60 - update      28230 => loss:   0.501 (#OOM: 0)
Epoch 60 - update      28260 => loss:   0.673 (#OOM: 0)
Epoch 60 - update      28290 => loss:   0.461 (#OOM: 0)
Epoch 60 - update      28320 => loss:   0.479 (#OOM: 0)
Epoch 60 - update      28350 => loss:   0.716 (#OOM: 0)
Epoch 60 - update      28380 => loss:   0.711 (#OOM: 0)
Epoch 60 - update      28410 => loss:   0.500 (#OOM: 0)
Epoch 60 - update      28440 => loss:   0.613 (#OOM: 0)
Epoch 60 - update      28470 => loss:   0.502 (#OOM: 0)
Epoch 60 - update      28500 => loss:   0.825 (#OOM: 0)
Epoch 60 - update      28530 => loss:   0.588 (#OOM: 0)
Epoch 60 - update      28560 => loss:   0.779 (#OOM: 0)
Epoch 60 - update      28590 => loss:   0.619 (#OOM: 0)
Epoch 60 - update      28620 => loss:   0.534 (#OOM: 0)
--> Epoch 60 finished with mean loss 0.60686
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.62 mins)   (821 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.33batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 49.45batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 49.24batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.93batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.98batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.48batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.45batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.48batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.82batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.39batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 78.28batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 78.71batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 78.35batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 77.95batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 78.37batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 76.35batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 77.32batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 77.15batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 76.27batch/s] 11%|███                        | 115/1014 [00:01<00:11, 75.73batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 75.13batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.10batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 75.45batch/s] 15%|████                       | 151/1014 [00:01<00:11, 76.00batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.45batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 76.27batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 76.54batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.30batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.62batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.70batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 76.70batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 75.98batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 76.24batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 75.90batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 75.75batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 75.66batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.47batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.68batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.58batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.45batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.42batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 75.14batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 74.97batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 75.10batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.29batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 75.54batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.68batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.84batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.95batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.80batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.73batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.60batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 75.81batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 75.62batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 75.55batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 75.42batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.51batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.52batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.33batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.50batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.64batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.73batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 75.59batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 75.48batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 75.59batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 75.25batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.05batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 74.95batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 74.99batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 74.97batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 74.95batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 74.90batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 74.61batch/s] 59%|████████████████           | 601/1014 [00:08<00:05, 74.61batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 74.65batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 74.69batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 74.68batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 74.78batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 74.91batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.85batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 74.74batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.58batch/s] 67%|██████████████████▏        | 682/1014 [00:09<00:04, 74.59batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 74.57batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 74.66batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 74.57batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 74.53batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.54batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 74.58batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 74.59batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.60batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 74.67batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 74.76batch/s] 77%|████████████████████▊      | 781/1014 [00:10<00:03, 74.80batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 74.87batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 75.06batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 75.14batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.20batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 75.07batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 75.13batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.13batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.11batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.21batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.25batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.25batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.11batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.25batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.26batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.22batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.26batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.37batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.36batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.42batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 75.46batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.48batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.31batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 75.30batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.27batch/s]
Validation 60 -> LOSS = 1.16
Validation 60 -> BLEU = 55.67, 76.8/61.0/49.9/41.0 (BP=1.000, ratio=1.001, hyp_len=14390, ref_len=14382)
Early stopping patience: 0
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Starting Epoch 61
Early stopped.
--> This is model: simultaneouswaitknmt-r2844c
--> Best LOSS so far: 1.15 @ validation 29
--> Best BLEU so far: 56.07 @ validation 50
Training finished on 03-06-2020 02:51
Wed Jun  3 02:51:15 2020       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 435.21       Driver Version: 435.21       CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  TITAN Xp            On   | 00000000:1B:00.0 Off |                  N/A |
| 29%   48C    P0    63W / 250W |      0MiB / 12196MiB |     23%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
-------
[train]
-------
         num_workers:0
          pin_memory:False
                seed:1582660384
               gclip:1
              l2_reg:1e-05
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
          model_type:SimultaneousWaitKNMT
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:64
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:
             de-hyphen
     eval_batch_size:32
           eval_freq:0
        eval_max_len:100
          eval_start:1
           eval_zero:False
   save_best_metrics:True
           save_path:/homes/al4616/experiments/simnmt/nmtpy/word2word/en-fr
    save_optim_state:False
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/homes/al4616/experiments/simnmt/nmtpy/word2word/en-fr/tb_dir
     pretrained_file:
   pretrained_layers:
       freeze_layers:
          handle_oom:False
           subfolder:wait7-rnn-unimodal
              exp_id:simultaneouswaitknmt-r6cbf8
------
[vars]
------
                  sl:en
                  tl:fr
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             enc_dim:320
   enc_bidirectional:False
             dec_dim:320
             emb_dim:200
         dropout_emb:0.4
         dropout_ctx:0.5
         dropout_out:0.5
          n_encoders:2
            tied_emb:2way
             max_len:None
           out_logic:deep
           direction:src:Text -> trg:Text
        sampler_type:bucket
           bucket_by:src
     translator_args:
                     k:7
------
[data]
------
            txt_root:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr
           train_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.fr
             val_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.fr
test_2016_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.fr
test_2017_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.fr
------------
[vocabulary]
------------
                 src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.en
                 trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.fr
----------------------------------------------------------------------

Python 3.7.7 -- torch 1.4.0 with CUDA 10.1 (on machine 'kingfisher.doc.ic.ac.uk')
nmtpytorch 4.1.0
DeviceManager(cuda:0, n_gpu=1)
Seed for further reproducibility: 1582660384
SLURM Job ID: 7213
Loading dataset(s)
Initializing dataset for 'src'...
0sents [00:00, ?sents/s]18432sents [00:00, 184281.95sents/s]29000sents [00:00, 179965.64sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]14957sents [00:00, 149540.19sents/s]29000sents [00:00, 147204.90sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'train.lc.norm.tok.en' (29000 sentences)
  Targets:
    --> TextDataset 'train.lc.norm.tok.fr' (29000 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 167034.18sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]1014sents [00:00, 147633.44sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)
  Targets:
    --> TextDataset 'val.lc.norm.tok.fr' (1014 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 168630.28sents/s]
Skipping 'trg' as target
MultimodalDataset - (1 source(s) / 0 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)

Ignoring batch_size 32 for simultaneous greedy search
SimultaneousWaitKNMT(
  (encoders): ModuleDict(
    (src): TextEncoder(
      (do_emb): Dropout(p=0.4, inplace=False)
      (emb): Embedding(9797, 200, padding_idx=0)
      (enc): GRU(200, 320, num_layers=2)
      (output): Sequential(
        (0): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (dec): SimultaneousConditionalDecoder(
    (emb): Embedding(11048, 200, padding_idx=0)
    (att): ModuleDict(
      (src): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
    )
    (dec0): GRUCell(200, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.5, inplace=False)
    (hid2out): FF(in_features=840, out_features=200, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=200, out_features=11048, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss()
  )
)
Vocabulary of 9797 items ('train.lc.norm.tok.vocab.en')
Vocabulary of 11048 items ('train.lc.norm.tok.vocab.fr')
# parameters: 6.89M (6.89M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 1e-05, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Training started on 03-06-2020 02:51:20
Starting Epoch 1
Epoch 1 - update         30 => loss:   6.667 (#OOM: 0)
Epoch 1 - update         60 => loss:   5.761 (#OOM: 0)
Epoch 1 - update         90 => loss:   5.238 (#OOM: 0)
Epoch 1 - update        120 => loss:   5.013 (#OOM: 0)
Epoch 1 - update        150 => loss:   4.441 (#OOM: 0)
Epoch 1 - update        180 => loss:   4.732 (#OOM: 0)
Epoch 1 - update        210 => loss:   4.544 (#OOM: 0)
Epoch 1 - update        240 => loss:   4.439 (#OOM: 0)
Epoch 1 - update        270 => loss:   4.142 (#OOM: 0)
Epoch 1 - update        300 => loss:   4.216 (#OOM: 0)
Epoch 1 - update        330 => loss:   3.970 (#OOM: 0)
Epoch 1 - update        360 => loss:   3.552 (#OOM: 0)
Epoch 1 - update        390 => loss:   4.013 (#OOM: 0)
Epoch 1 - update        420 => loss:   3.875 (#OOM: 0)
Epoch 1 - update        450 => loss:   4.004 (#OOM: 0)
--> Epoch 1 finished with mean loss 4.66741
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.56 mins)   (913 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 38.84batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.00batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.31batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 48.13batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 49.65batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.00batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 84.62batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.62batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.51batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 74.69batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 74.57batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 74.85batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.81batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 77.30batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.88batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.11batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.72batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.10batch/s] 12%|███                        | 117/1014 [00:01<00:12, 73.83batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.54batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 75.26batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 76.15batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 76.65batch/s] 16%|████▍                      | 165/1014 [00:02<00:10, 77.27batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 77.34batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 77.17batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 77.21batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 77.73batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 77.97batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 78.01batch/s] 23%|██████▎                    | 235/1014 [00:02<00:09, 78.42batch/s] 24%|██████▌                    | 245/1014 [00:03<00:09, 78.42batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 78.11batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 78.44batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 78.85batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 79.33batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 79.24batch/s] 30%|████████                   | 305/1014 [00:03<00:08, 79.55batch/s] 31%|████████▍                  | 315/1014 [00:03<00:08, 79.57batch/s] 32%|████████▋                  | 325/1014 [00:04<00:08, 79.19batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 79.48batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 79.58batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 79.77batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 79.73batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:07, 79.90batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 78.80batch/s] 39%|██████████▌                | 395/1014 [00:05<00:07, 78.90batch/s] 40%|██████████▊                | 405/1014 [00:05<00:07, 78.97batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 78.84batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 78.86batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 78.95batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 79.18batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 79.31batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 79.06batch/s] 47%|████████████▋              | 475/1014 [00:06<00:06, 78.96batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 78.95batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 78.18batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 78.27batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 78.32batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 77.98batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:06, 78.04batch/s] 54%|██████████████▌            | 545/1014 [00:06<00:06, 78.04batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:05, 78.18batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 78.30batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 78.53batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 78.62batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 78.62batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 78.66batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:05, 78.74batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 78.59batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 78.62batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 78.71batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 78.79batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 78.82batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 78.73batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 78.76batch/s] 69%|██████████████████▌        | 695/1014 [00:08<00:04, 78.99batch/s] 70%|██████████████████▊        | 705/1014 [00:08<00:03, 79.01batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 79.05batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 79.13batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 79.26batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 79.14batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 79.16batch/s] 75%|████████████████████▎      | 765/1014 [00:09<00:03, 79.06batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:03, 79.01batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 79.10batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 79.00batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 79.05batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 79.17batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 79.27batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 79.43batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 79.54batch/s] 84%|██████████████████████▊    | 855/1014 [00:10<00:02, 79.46batch/s] 85%|███████████████████████    | 865/1014 [00:10<00:01, 79.41batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 79.50batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 79.52batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 79.48batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 79.58batch/s] 90%|████████████████████████▎  | 915/1014 [00:11<00:01, 79.65batch/s] 91%|████████████████████████▋  | 925/1014 [00:11<00:01, 79.75batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 79.86batch/s] 93%|█████████████████████████▏ | 945/1014 [00:11<00:00, 79.95batch/s] 94%|█████████████████████████▍ | 955/1014 [00:11<00:00, 79.88batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 79.90batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 79.91batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 79.53batch/s] 98%|██████████████████████████▍| 995/1014 [00:12<00:00, 79.57batch/s] 99%|█████████████████████████▊| 1005/1014 [00:12<00:00, 79.59batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.48batch/s]
Validation 1 -> LOSS = 3.27
Validation 1 -> BLEU = 12.26, 47.5/19.3/8.5/3.8 (BP=0.931, ratio=0.933, hyp_len=13423, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 3.27 @ validation 1
--> Best BLEU so far: 12.26 @ validation 1
Starting Epoch 2
Epoch 2 - update        480 => loss:   4.150 (#OOM: 0)
Epoch 2 - update        510 => loss:   3.545 (#OOM: 0)
Epoch 2 - update        540 => loss:   3.214 (#OOM: 0)
Epoch 2 - update        570 => loss:   3.189 (#OOM: 0)
Epoch 2 - update        600 => loss:   3.909 (#OOM: 0)
Epoch 2 - update        630 => loss:   3.193 (#OOM: 0)
Epoch 2 - update        660 => loss:   3.296 (#OOM: 0)
Epoch 2 - update        690 => loss:   3.060 (#OOM: 0)
Epoch 2 - update        720 => loss:   3.402 (#OOM: 0)
Epoch 2 - update        750 => loss:   3.228 (#OOM: 0)
Epoch 2 - update        780 => loss:   3.189 (#OOM: 0)
Epoch 2 - update        810 => loss:   3.164 (#OOM: 0)
Epoch 2 - update        840 => loss:   2.967 (#OOM: 0)
Epoch 2 - update        870 => loss:   2.912 (#OOM: 0)
Epoch 2 - update        900 => loss:   2.766 (#OOM: 0)
Epoch 2 - update        930 => loss:   2.827 (#OOM: 0)
--> Epoch 2 finished with mean loss 3.21238
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (782 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.79batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.12batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 53.12batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 50.97batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 52.18batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.63batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.10batch/s]  2%|▍                           | 16/1014 [00:00<00:15, 64.81batch/s]  2%|▋                           | 24/1014 [00:00<00:15, 64.63batch/s]  3%|▉                           | 32/1014 [00:00<00:15, 65.02batch/s]  4%|█                           | 40/1014 [00:00<00:14, 66.14batch/s]  5%|█▎                          | 48/1014 [00:00<00:14, 67.03batch/s]  6%|█▌                          | 56/1014 [00:00<00:14, 65.91batch/s]  6%|█▊                          | 64/1014 [00:01<00:15, 62.52batch/s]  7%|█▉                          | 72/1014 [00:01<00:14, 63.28batch/s]  8%|██▏                         | 80/1014 [00:01<00:14, 64.43batch/s]  9%|██▍                         | 88/1014 [00:01<00:14, 64.67batch/s] 10%|██▋                         | 97/1014 [00:01<00:13, 65.94batch/s] 10%|██▊                        | 106/1014 [00:01<00:13, 66.53batch/s] 11%|███                        | 115/1014 [00:01<00:13, 66.78batch/s] 12%|███▎                       | 124/1014 [00:01<00:13, 67.41batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 67.93batch/s] 14%|███▊                       | 142/1014 [00:02<00:12, 68.55batch/s] 15%|████                       | 151/1014 [00:02<00:12, 69.25batch/s] 16%|████▎                      | 160/1014 [00:02<00:12, 69.61batch/s] 17%|████▌                      | 169/1014 [00:02<00:12, 70.32batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 70.69batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 69.13batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 69.74batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 70.06batch/s] 21%|█████▋                     | 214/1014 [00:03<00:11, 70.59batch/s] 22%|█████▉                     | 223/1014 [00:03<00:11, 69.87batch/s] 23%|██████▏                    | 232/1014 [00:03<00:11, 70.11batch/s] 24%|██████▍                    | 241/1014 [00:03<00:11, 70.19batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 70.40batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 70.44batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 70.21batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 70.37batch/s] 28%|███████▌                   | 286/1014 [00:04<00:10, 70.50batch/s] 29%|███████▊                   | 295/1014 [00:04<00:10, 70.65batch/s] 30%|████████                   | 304/1014 [00:04<00:10, 69.66batch/s] 31%|████████▎                  | 313/1014 [00:04<00:10, 69.58batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 70.00batch/s] 33%|████████▊                  | 331/1014 [00:04<00:09, 70.00batch/s] 34%|█████████                  | 340/1014 [00:04<00:09, 69.34batch/s] 34%|█████████▎                 | 349/1014 [00:05<00:09, 69.28batch/s] 35%|█████████▌                 | 358/1014 [00:05<00:09, 69.35batch/s] 36%|█████████▊                 | 367/1014 [00:05<00:09, 69.34batch/s] 37%|██████████                 | 376/1014 [00:05<00:09, 69.53batch/s] 38%|██████████▎                | 385/1014 [00:05<00:09, 69.76batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 69.29batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 69.53batch/s] 41%|██████████▉                | 412/1014 [00:05<00:08, 69.70batch/s] 42%|███████████▏               | 421/1014 [00:06<00:08, 69.68batch/s] 42%|███████████▍               | 430/1014 [00:06<00:08, 69.93batch/s] 43%|███████████▋               | 439/1014 [00:06<00:08, 69.77batch/s] 44%|███████████▉               | 448/1014 [00:06<00:08, 69.74batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 69.83batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 69.88batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 69.57batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 69.73batch/s] 49%|█████████████▏             | 493/1014 [00:07<00:07, 69.80batch/s] 50%|█████████████▎             | 502/1014 [00:07<00:07, 69.93batch/s] 50%|█████████████▌             | 511/1014 [00:07<00:07, 69.61batch/s] 51%|█████████████▊             | 520/1014 [00:07<00:07, 69.83batch/s] 52%|██████████████             | 529/1014 [00:07<00:06, 70.05batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 70.15batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 70.44batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 70.56batch/s] 56%|███████████████            | 568/1014 [00:08<00:06, 70.71batch/s] 57%|███████████████▍           | 578/1014 [00:08<00:06, 70.69batch/s] 58%|███████████████▋           | 588/1014 [00:08<00:06, 70.66batch/s] 59%|███████████████▉           | 598/1014 [00:08<00:05, 70.58batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 70.60batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 69.80batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 69.82batch/s] 63%|████████████████▉          | 638/1014 [00:09<00:05, 70.02batch/s] 64%|█████████████████▎         | 648/1014 [00:09<00:05, 70.15batch/s] 65%|█████████████████▌         | 658/1014 [00:09<00:05, 70.22batch/s] 66%|█████████████████▊         | 668/1014 [00:09<00:04, 70.19batch/s] 67%|██████████████████         | 678/1014 [00:09<00:04, 70.28batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 70.35batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 70.37batch/s] 70%|██████████████████▊        | 708/1014 [00:10<00:04, 70.39batch/s] 71%|███████████████████        | 718/1014 [00:10<00:04, 70.34batch/s] 72%|███████████████████▍       | 728/1014 [00:10<00:04, 70.32batch/s] 73%|███████████████████▋       | 738/1014 [00:10<00:03, 70.42batch/s] 74%|███████████████████▉       | 748/1014 [00:10<00:03, 70.53batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 70.10batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 70.13batch/s] 77%|████████████████████▋      | 778/1014 [00:11<00:03, 70.04batch/s] 78%|████████████████████▉      | 788/1014 [00:11<00:03, 70.19batch/s] 79%|█████████████████████▏     | 798/1014 [00:11<00:03, 70.28batch/s] 80%|█████████████████████▌     | 808/1014 [00:11<00:02, 70.34batch/s] 81%|█████████████████████▊     | 818/1014 [00:11<00:02, 70.52batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 70.56batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 70.51batch/s] 84%|██████████████████████▌    | 848/1014 [00:12<00:02, 70.66batch/s] 85%|██████████████████████▊    | 858/1014 [00:12<00:02, 70.60batch/s] 86%|███████████████████████    | 868/1014 [00:12<00:02, 70.65batch/s] 87%|███████████████████████▍   | 878/1014 [00:12<00:01, 70.72batch/s] 88%|███████████████████████▋   | 888/1014 [00:12<00:01, 70.34batch/s] 89%|███████████████████████▉   | 898/1014 [00:12<00:01, 70.08batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 70.18batch/s] 91%|████████████████████████▍  | 918/1014 [00:13<00:01, 69.92batch/s] 92%|████████████████████████▋  | 928/1014 [00:13<00:01, 69.88batch/s] 93%|████████████████████████▉  | 938/1014 [00:13<00:01, 69.83batch/s] 93%|█████████████████████████▏ | 948/1014 [00:13<00:00, 69.81batch/s] 94%|█████████████████████████▌ | 958/1014 [00:13<00:00, 69.77batch/s] 95%|█████████████████████████▊ | 968/1014 [00:13<00:00, 69.54batch/s] 96%|██████████████████████████ | 978/1014 [00:14<00:00, 69.63batch/s] 97%|██████████████████████████▎| 988/1014 [00:14<00:00, 69.62batch/s] 98%|██████████████████████████▌| 998/1014 [00:14<00:00, 69.73batch/s] 99%|█████████████████████████▊| 1008/1014 [00:14<00:00, 69.77batch/s]100%|██████████████████████████| 1014/1014 [00:14<00:00, 69.81batch/s]
Validation 2 -> LOSS = 2.56
Validation 2 -> BLEU = 19.77, 48.9/25.6/14.6/8.3 (BP=1.000, ratio=1.110, hyp_len=15961, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 2.56 @ validation 2
--> Best BLEU so far: 19.77 @ validation 2
Starting Epoch 3
Epoch 3 - update        960 => loss:   2.640 (#OOM: 0)
Epoch 3 - update        990 => loss:   2.676 (#OOM: 0)
Epoch 3 - update       1020 => loss:   2.575 (#OOM: 0)
Epoch 3 - update       1050 => loss:   3.020 (#OOM: 0)
Epoch 3 - update       1080 => loss:   2.471 (#OOM: 0)
Epoch 3 - update       1110 => loss:   2.549 (#OOM: 0)
Epoch 3 - update       1140 => loss:   2.607 (#OOM: 0)
Epoch 3 - update       1170 => loss:   2.545 (#OOM: 0)
Epoch 3 - update       1200 => loss:   2.291 (#OOM: 0)
Epoch 3 - update       1230 => loss:   2.869 (#OOM: 0)
Epoch 3 - update       1260 => loss:   2.271 (#OOM: 0)
Epoch 3 - update       1290 => loss:   2.878 (#OOM: 0)
Epoch 3 - update       1320 => loss:   2.499 (#OOM: 0)
Epoch 3 - update       1350 => loss:   2.424 (#OOM: 0)
Epoch 3 - update       1380 => loss:   2.011 (#OOM: 0)
Epoch 3 - update       1410 => loss:   2.319 (#OOM: 0)
--> Epoch 3 finished with mean loss 2.66967
--> Overhead/Training/Evaluation: 0.03/0.52/0.00 mins (total: 0.55 mins)   (927 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 39.82batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.09batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.81batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.56batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 50.21batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 51.19batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.01batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:33, 29.74batch/s]  1%|▎                           | 12/1014 [00:00<00:17, 58.10batch/s]  2%|▌                           | 21/1014 [00:00<00:15, 64.64batch/s]  3%|▊                           | 30/1014 [00:00<00:14, 70.09batch/s]  4%|█                           | 39/1014 [00:00<00:13, 72.45batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 74.90batch/s]  6%|█▌                          | 57/1014 [00:00<00:12, 74.46batch/s]  7%|█▊                          | 66/1014 [00:00<00:12, 74.79batch/s]  7%|██                          | 75/1014 [00:01<00:12, 73.90batch/s]  8%|██▎                         | 84/1014 [00:01<00:12, 74.32batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 75.74batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 76.63batch/s] 11%|███                        | 114/1014 [00:01<00:12, 74.29batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 74.21batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 73.87batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.25batch/s] 15%|████                       | 154/1014 [00:02<00:11, 74.72batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 74.75batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 75.03batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 74.47batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 74.81batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 75.21batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 75.05batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 73.58batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.32batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 73.30batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 73.29batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 73.13batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 73.16batch/s] 28%|███████▌                   | 284/1014 [00:04<00:10, 70.73batch/s] 29%|███████▊                   | 294/1014 [00:04<00:10, 70.60batch/s] 30%|████████                   | 304/1014 [00:04<00:10, 70.76batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 70.75batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 70.90batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 70.93batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:09, 70.77batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:09, 71.27batch/s] 36%|█████████▋                 | 364/1014 [00:05<00:09, 70.58batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:09, 70.46batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 70.31batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 70.54batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 70.76batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 70.66batch/s] 42%|███████████▎               | 424/1014 [00:05<00:08, 70.69batch/s] 43%|███████████▌               | 434/1014 [00:06<00:08, 70.61batch/s] 44%|███████████▊               | 444/1014 [00:06<00:08, 70.92batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 71.13batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 71.11batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 71.18batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 71.45batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 71.22batch/s] 50%|█████████████▍             | 504/1014 [00:07<00:07, 71.23batch/s] 51%|█████████████▋             | 514/1014 [00:07<00:07, 71.25batch/s] 52%|█████████████▉             | 524/1014 [00:07<00:06, 70.96batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 71.11batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 71.46batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 71.60batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 71.70batch/s] 57%|███████████████▎           | 574/1014 [00:08<00:06, 71.63batch/s] 58%|███████████████▌           | 584/1014 [00:08<00:06, 71.58batch/s] 59%|███████████████▊           | 594/1014 [00:08<00:05, 71.81batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 71.91batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 71.78batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 71.88batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 71.95batch/s] 64%|█████████████████▏         | 644/1014 [00:09<00:05, 71.42batch/s] 64%|█████████████████▍         | 654/1014 [00:09<00:05, 71.38batch/s] 65%|█████████████████▋         | 664/1014 [00:09<00:04, 71.51batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 71.55batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 71.58batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 71.52batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 71.63batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 71.68batch/s] 71%|███████████████████▎       | 724/1014 [00:10<00:04, 71.61batch/s] 72%|███████████████████▌       | 734/1014 [00:10<00:03, 71.63batch/s] 73%|███████████████████▊       | 744/1014 [00:10<00:03, 71.68batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 71.84batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 71.80batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 71.65batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 71.64batch/s] 78%|█████████████████████▏     | 794/1014 [00:11<00:03, 71.81batch/s] 79%|█████████████████████▍     | 804/1014 [00:11<00:02, 71.95batch/s] 80%|█████████████████████▋     | 814/1014 [00:11<00:02, 72.11batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 72.12batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 72.19batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 71.97batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 71.89batch/s] 85%|███████████████████████    | 864/1014 [00:12<00:02, 71.99batch/s] 86%|███████████████████████▎   | 874/1014 [00:12<00:01, 72.09batch/s] 87%|███████████████████████▌   | 884/1014 [00:12<00:01, 72.18batch/s] 88%|███████████████████████▊   | 894/1014 [00:12<00:01, 72.12batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 72.16batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 72.28batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 72.24batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 72.21batch/s] 93%|█████████████████████████▏ | 944/1014 [00:13<00:00, 72.25batch/s] 94%|█████████████████████████▍ | 954/1014 [00:13<00:00, 72.41batch/s] 95%|█████████████████████████▋ | 964/1014 [00:13<00:00, 72.04batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 72.12batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 72.21batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 72.27batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 72.29batch/s]100%|██████████████████████████| 1014/1014 [00:14<00:00, 72.37batch/s]100%|██████████████████████████| 1014/1014 [00:14<00:00, 72.36batch/s]
Validation 3 -> LOSS = 2.18
Validation 3 -> BLEU = 26.88, 55.8/33.2/21.0/13.4 (BP=1.000, ratio=1.069, hyp_len=15379, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 2.18 @ validation 3
--> Best BLEU so far: 26.88 @ validation 3
Starting Epoch 4
Epoch 4 - update       1440 => loss:   2.041 (#OOM: 0)
Epoch 4 - update       1470 => loss:   2.172 (#OOM: 0)
Epoch 4 - update       1500 => loss:   2.499 (#OOM: 0)
Epoch 4 - update       1530 => loss:   2.305 (#OOM: 0)
Epoch 4 - update       1560 => loss:   2.469 (#OOM: 0)
Epoch 4 - update       1590 => loss:   2.266 (#OOM: 0)
Epoch 4 - update       1620 => loss:   2.300 (#OOM: 0)
Epoch 4 - update       1650 => loss:   2.191 (#OOM: 0)
Epoch 4 - update       1680 => loss:   2.088 (#OOM: 0)
Epoch 4 - update       1710 => loss:   2.331 (#OOM: 0)
Epoch 4 - update       1740 => loss:   2.029 (#OOM: 0)
Epoch 4 - update       1770 => loss:   2.452 (#OOM: 0)
Epoch 4 - update       1800 => loss:   2.056 (#OOM: 0)
Epoch 4 - update       1830 => loss:   2.631 (#OOM: 0)
Epoch 4 - update       1860 => loss:   2.156 (#OOM: 0)
Epoch 4 - update       1890 => loss:   2.221 (#OOM: 0)
--> Epoch 4 finished with mean loss 2.33222
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (843 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.29batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.02batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.61batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.43batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.72batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.30batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.45batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.96batch/s]  2%|▋                           | 24/1014 [00:00<00:12, 76.54batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.84batch/s]  4%|█                           | 40/1014 [00:00<00:13, 74.72batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 74.46batch/s]  6%|█▌                          | 56/1014 [00:00<00:12, 74.77batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 75.17batch/s]  7%|██                          | 73/1014 [00:00<00:12, 76.17batch/s]  8%|██▎                         | 82/1014 [00:01<00:12, 77.06batch/s]  9%|██▌                         | 91/1014 [00:01<00:11, 77.66batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 77.00batch/s] 11%|██▉                        | 109/1014 [00:01<00:11, 77.41batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 77.88batch/s] 13%|███▍                       | 127/1014 [00:01<00:11, 78.25batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 77.61batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 76.90batch/s] 15%|████                       | 154/1014 [00:01<00:11, 77.41batch/s] 16%|████▎                      | 163/1014 [00:02<00:10, 77.60batch/s] 17%|████▌                      | 172/1014 [00:02<00:10, 77.94batch/s] 18%|████▊                      | 181/1014 [00:02<00:10, 77.90batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 76.73batch/s] 20%|█████▎                     | 199/1014 [00:02<00:10, 76.38batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 75.79batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 72.81batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 72.90batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 73.19batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 72.99batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 72.77batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 72.61batch/s] 27%|███████▏                   | 271/1014 [00:03<00:10, 72.74batch/s] 28%|███████▍                   | 280/1014 [00:03<00:10, 72.71batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 73.02batch/s] 29%|███████▉                   | 298/1014 [00:04<00:09, 73.41batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 73.46batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 73.12batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 73.31batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 73.26batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:09, 73.24batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:09, 73.44batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 73.75batch/s] 36%|█████████▊                 | 370/1014 [00:05<00:08, 73.84batch/s] 37%|██████████                 | 379/1014 [00:05<00:08, 72.84batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 72.82batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 72.93batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 71.94batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 71.88batch/s] 42%|███████████▎               | 424/1014 [00:05<00:08, 71.78batch/s] 43%|███████████▌               | 433/1014 [00:06<00:08, 71.81batch/s] 44%|███████████▊               | 442/1014 [00:06<00:07, 71.92batch/s] 44%|████████████               | 451/1014 [00:06<00:07, 71.98batch/s] 45%|████████████▏              | 460/1014 [00:06<00:07, 71.29batch/s] 46%|████████████▍              | 469/1014 [00:06<00:07, 71.31batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 71.46batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 71.35batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:07, 71.40batch/s] 50%|█████████████▍             | 505/1014 [00:07<00:07, 71.45batch/s] 51%|█████████████▋             | 514/1014 [00:07<00:07, 71.41batch/s] 52%|█████████████▉             | 523/1014 [00:07<00:06, 71.50batch/s] 52%|██████████████▏            | 532/1014 [00:07<00:06, 71.51batch/s] 53%|██████████████▍            | 541/1014 [00:07<00:06, 71.38batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 71.40batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:06, 71.36batch/s] 56%|███████████████            | 568/1014 [00:08<00:06, 70.79batch/s] 57%|███████████████▎           | 577/1014 [00:08<00:06, 70.70batch/s] 58%|███████████████▌           | 586/1014 [00:08<00:06, 70.76batch/s] 59%|███████████████▊           | 595/1014 [00:08<00:05, 70.88batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 70.88batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 70.93batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 71.03batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:05, 71.04batch/s] 63%|█████████████████          | 640/1014 [00:09<00:05, 70.58batch/s] 64%|█████████████████▎         | 649/1014 [00:09<00:05, 70.57batch/s] 65%|█████████████████▌         | 658/1014 [00:09<00:05, 70.64batch/s] 66%|█████████████████▊         | 667/1014 [00:09<00:04, 70.71batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 70.87batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 71.01batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 70.88batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 70.82batch/s] 70%|██████████████████▉        | 712/1014 [00:10<00:04, 70.73batch/s] 71%|███████████████████▏       | 721/1014 [00:10<00:04, 70.78batch/s] 72%|███████████████████▍       | 730/1014 [00:10<00:04, 70.94batch/s] 73%|███████████████████▋       | 739/1014 [00:10<00:03, 70.88batch/s] 74%|███████████████████▉       | 748/1014 [00:10<00:03, 70.83batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 70.99batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 71.05batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 71.07batch/s] 77%|████████████████████▉      | 784/1014 [00:11<00:03, 71.12batch/s] 78%|█████████████████████      | 793/1014 [00:11<00:03, 71.21batch/s] 79%|█████████████████████▎     | 802/1014 [00:11<00:02, 71.35batch/s] 80%|█████████████████████▌     | 811/1014 [00:11<00:02, 70.62batch/s] 81%|█████████████████████▊     | 820/1014 [00:11<00:02, 70.56batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 70.52batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 70.59batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 70.61batch/s] 84%|██████████████████████▊    | 856/1014 [00:12<00:02, 70.33batch/s] 85%|███████████████████████    | 865/1014 [00:12<00:02, 70.36batch/s] 86%|███████████████████████▎   | 874/1014 [00:12<00:01, 70.33batch/s] 87%|███████████████████████▌   | 883/1014 [00:12<00:01, 70.40batch/s] 88%|███████████████████████▊   | 892/1014 [00:12<00:01, 70.43batch/s] 89%|███████████████████████▉   | 901/1014 [00:12<00:01, 70.43batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 70.41batch/s] 91%|████████████████████████▍  | 919/1014 [00:13<00:01, 70.51batch/s] 92%|████████████████████████▋  | 928/1014 [00:13<00:01, 70.56batch/s] 92%|████████████████████████▉  | 937/1014 [00:13<00:01, 70.61batch/s] 93%|█████████████████████████▏ | 946/1014 [00:13<00:00, 70.74batch/s] 94%|█████████████████████████▍ | 955/1014 [00:13<00:00, 70.70batch/s] 95%|█████████████████████████▋ | 964/1014 [00:13<00:00, 70.73batch/s] 96%|█████████████████████████▉ | 973/1014 [00:13<00:00, 70.75batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 70.78batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 70.84batch/s] 99%|█████████████████████████▋| 1000/1014 [00:14<00:00, 70.95batch/s]100%|█████████████████████████▊| 1009/1014 [00:14<00:00, 71.06batch/s]100%|██████████████████████████| 1014/1014 [00:14<00:00, 71.06batch/s]
Validation 4 -> LOSS = 1.94
Validation 4 -> BLEU = 30.93, 58.1/37.0/25.1/17.0 (BP=1.000, ratio=1.092, hyp_len=15704, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.94 @ validation 4
--> Best BLEU so far: 30.93 @ validation 4
Starting Epoch 5
Epoch 5 - update       1920 => loss:   2.560 (#OOM: 0)
Epoch 5 - update       1950 => loss:   2.042 (#OOM: 0)
Epoch 5 - update       1980 => loss:   1.871 (#OOM: 0)
Epoch 5 - update       2010 => loss:   2.083 (#OOM: 0)
Epoch 5 - update       2040 => loss:   1.891 (#OOM: 0)
Epoch 5 - update       2070 => loss:   2.078 (#OOM: 0)
Epoch 5 - update       2100 => loss:   1.816 (#OOM: 0)
Epoch 5 - update       2130 => loss:   2.123 (#OOM: 0)
Epoch 5 - update       2160 => loss:   2.169 (#OOM: 0)
Epoch 5 - update       2190 => loss:   1.845 (#OOM: 0)
Epoch 5 - update       2220 => loss:   1.818 (#OOM: 0)
Epoch 5 - update       2250 => loss:   1.722 (#OOM: 0)
Epoch 5 - update       2280 => loss:   2.414 (#OOM: 0)
Epoch 5 - update       2310 => loss:   2.033 (#OOM: 0)
Epoch 5 - update       2340 => loss:   1.717 (#OOM: 0)
Epoch 5 - update       2370 => loss:   2.416 (#OOM: 0)
--> Epoch 5 finished with mean loss 2.08901
--> Overhead/Training/Evaluation: 0.03/0.52/0.00 mins (total: 0.55 mins)   (932 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.09batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.03batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 47.80batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.11batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 53.26batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.64batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 82.18batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.92batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 83.46batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.59batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 79.67batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.52batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.09batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 77.52batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 77.16batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 76.54batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.84batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 76.77batch/s] 12%|███                        | 117/1014 [00:01<00:11, 77.00batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 77.24batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.46batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 76.57batch/s] 15%|████                       | 153/1014 [00:01<00:11, 76.87batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 76.94batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 77.04batch/s] 18%|████▊                      | 181/1014 [00:02<00:10, 77.50batch/s] 19%|█████                      | 191/1014 [00:02<00:10, 77.54batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 77.55batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 77.82batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 77.93batch/s] 23%|██████▏                    | 231/1014 [00:02<00:10, 78.11batch/s] 24%|██████▍                    | 241/1014 [00:03<00:09, 78.51batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 78.17batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 78.39batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 78.37batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 78.25batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 78.30batch/s] 30%|████████                   | 301/1014 [00:03<00:09, 78.61batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 78.56batch/s] 32%|████████▌                  | 321/1014 [00:04<00:08, 78.27batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 78.16batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 78.18batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 78.32batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 78.36batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 78.01batch/s] 38%|██████████▏                | 381/1014 [00:04<00:08, 78.10batch/s] 39%|██████████▍                | 391/1014 [00:05<00:07, 77.89batch/s] 40%|██████████▋                | 401/1014 [00:05<00:07, 77.96batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 77.91batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 77.87batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 77.99batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 78.05batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 77.99batch/s] 45%|████████████▎              | 461/1014 [00:05<00:07, 78.01batch/s] 46%|████████████▌              | 471/1014 [00:06<00:06, 77.94batch/s] 47%|████████████▊              | 481/1014 [00:06<00:06, 77.86batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 78.04batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 77.99batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 77.84batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 77.84batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 77.67batch/s] 53%|██████████████▍            | 541/1014 [00:06<00:06, 77.30batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:05, 77.45batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 77.21batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 77.27batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 77.35batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 77.32batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 77.42batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:05, 77.44batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 77.26batch/s] 62%|████████████████▊          | 631/1014 [00:08<00:04, 77.16batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 77.37batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 77.38batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 77.25batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 77.24batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 77.38batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:04, 77.52batch/s] 69%|██████████████████▋        | 701/1014 [00:09<00:04, 77.37batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:03, 77.34batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 77.59batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 77.49batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 77.49batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 77.47batch/s] 76%|████████████████████▍      | 766/1014 [00:09<00:03, 77.17batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 77.17batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 77.15batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 77.25batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 77.23batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 77.27batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 77.33batch/s] 83%|██████████████████████▍    | 843/1014 [00:10<00:02, 77.30batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 77.34batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 77.22batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 77.29batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 77.25batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 77.28batch/s] 90%|████████████████████████▏  | 909/1014 [00:11<00:01, 77.03batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 76.95batch/s] 92%|████████████████████████▊  | 931/1014 [00:12<00:01, 76.98batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 76.94batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 76.92batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 76.75batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 76.73batch/s] 97%|██████████████████████████▎| 986/1014 [00:12<00:00, 76.56batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 76.28batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 76.28batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.35batch/s]
Validation 5 -> LOSS = 1.78
Validation 5 -> BLEU = 38.15, 65.8/44.5/31.9/23.0 (BP=0.997, ratio=0.997, hyp_len=14333, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.78 @ validation 5
--> Best BLEU so far: 38.15 @ validation 5
Starting Epoch 6
Epoch 6 - update       2400 => loss:   2.288 (#OOM: 0)
Epoch 6 - update       2430 => loss:   2.151 (#OOM: 0)
Epoch 6 - update       2460 => loss:   1.984 (#OOM: 0)
Epoch 6 - update       2490 => loss:   1.832 (#OOM: 0)
Epoch 6 - update       2520 => loss:   2.034 (#OOM: 0)
Epoch 6 - update       2550 => loss:   1.935 (#OOM: 0)
Epoch 6 - update       2580 => loss:   1.831 (#OOM: 0)
Epoch 6 - update       2610 => loss:   1.950 (#OOM: 0)
Epoch 6 - update       2640 => loss:   1.912 (#OOM: 0)
Epoch 6 - update       2670 => loss:   1.510 (#OOM: 0)
Epoch 6 - update       2700 => loss:   2.883 (#OOM: 0)
Epoch 6 - update       2730 => loss:   1.865 (#OOM: 0)
Epoch 6 - update       2760 => loss:   2.468 (#OOM: 0)
Epoch 6 - update       2790 => loss:   2.032 (#OOM: 0)
Epoch 6 - update       2820 => loss:   2.045 (#OOM: 0)
Epoch 6 - update       2850 => loss:   1.732 (#OOM: 0)
--> Epoch 6 finished with mean loss 1.90421
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.66 mins)   (786 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 42.81batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.79batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 45.49batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.88batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.35batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.20batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.77batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.21batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.50batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 74.29batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.63batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 73.30batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 74.34batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 72.71batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 72.94batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 72.95batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 74.16batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 74.20batch/s] 11%|███                        | 114/1014 [00:01<00:12, 73.80batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 73.68batch/s] 13%|███▌                       | 132/1014 [00:01<00:12, 71.15batch/s] 14%|███▊                       | 141/1014 [00:01<00:12, 71.85batch/s] 15%|███▉                       | 150/1014 [00:02<00:11, 72.64batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 72.04batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 72.53batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 72.72batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 73.13batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 72.64batch/s] 20%|█████▍                     | 204/1014 [00:02<00:11, 72.26batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 72.83batch/s] 22%|█████▉                     | 222/1014 [00:03<00:10, 72.07batch/s] 23%|██████▏                    | 231/1014 [00:03<00:10, 72.39batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 72.91batch/s] 25%|██████▋                    | 249/1014 [00:03<00:10, 73.09batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 73.00batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 73.54batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 73.85batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 73.79batch/s] 29%|███████▉                   | 298/1014 [00:04<00:09, 73.98batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 74.17batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 74.55batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 74.72batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 74.91batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 74.81batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 74.68batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 74.72batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 74.98batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 74.91batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 74.40batch/s] 40%|██████████▊                | 408/1014 [00:05<00:08, 74.49batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 74.53batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 74.70batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.02batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.06batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 74.21batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 74.26batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 74.57batch/s] 48%|████████████▉              | 488/1014 [00:06<00:07, 74.74batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 74.69batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 74.68batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 74.59batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 73.85batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 73.98batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 73.79batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 73.84batch/s] 56%|███████████████            | 568/1014 [00:07<00:06, 74.01batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 74.01batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 74.07batch/s] 59%|███████████████▉           | 598/1014 [00:08<00:05, 74.13batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 74.18batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 74.32batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 74.21batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 74.21batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 74.19batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 74.19batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 74.30batch/s] 67%|██████████████████         | 678/1014 [00:09<00:04, 74.34batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 74.34batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 74.36batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 74.56batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 74.48batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 74.62batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 74.61batch/s] 74%|███████████████████▉       | 748/1014 [00:10<00:03, 74.69batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 74.17batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 74.29batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 74.22batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 74.44batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 74.50batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 74.58batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 74.59batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 74.41batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 74.51batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 74.58batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 74.46batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 74.53batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 74.41batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 74.37batch/s] 89%|███████████████████████▉   | 898/1014 [00:12<00:01, 74.42batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 74.40batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 74.40batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 74.45batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 74.39batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 74.19batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 74.18batch/s] 95%|█████████████████████████▊ | 968/1014 [00:13<00:00, 74.26batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 73.81batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 73.76batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 73.73batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 73.80batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.84batch/s]
Validation 6 -> LOSS = 1.65
Validation 6 -> BLEU = 39.97, 65.7/46.0/33.9/24.9 (BP=1.000, ratio=1.034, hyp_len=14869, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.65 @ validation 6
--> Best BLEU so far: 39.97 @ validation 6
Starting Epoch 7
Epoch 7 - update       2880 => loss:   2.058 (#OOM: 0)
Epoch 7 - update       2910 => loss:   1.665 (#OOM: 0)
Epoch 7 - update       2940 => loss:   1.723 (#OOM: 0)
Epoch 7 - update       2970 => loss:   1.848 (#OOM: 0)
Epoch 7 - update       3000 => loss:   2.105 (#OOM: 0)
Epoch 7 - update       3030 => loss:   1.731 (#OOM: 0)
Epoch 7 - update       3060 => loss:   1.491 (#OOM: 0)
Epoch 7 - update       3090 => loss:   1.399 (#OOM: 0)
Epoch 7 - update       3120 => loss:   1.565 (#OOM: 0)
Epoch 7 - update       3150 => loss:   1.950 (#OOM: 0)
Epoch 7 - update       3180 => loss:   1.731 (#OOM: 0)
Epoch 7 - update       3210 => loss:   1.622 (#OOM: 0)
Epoch 7 - update       3240 => loss:   1.948 (#OOM: 0)
Epoch 7 - update       3270 => loss:   1.608 (#OOM: 0)
Epoch 7 - update       3300 => loss:   1.459 (#OOM: 0)
Epoch 7 - update       3330 => loss:   1.727 (#OOM: 0)
--> Epoch 7 finished with mean loss 1.75932
--> Overhead/Training/Evaluation: 0.02/0.46/0.00 mins (total: 0.49 mins)   (1043 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.43batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 49.15batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 51.51batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 52.10batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 51.09batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 52.45batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.68batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 67.91batch/s]  1%|▍                           | 15/1014 [00:00<00:13, 71.67batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 73.34batch/s]  3%|▉                           | 32/1014 [00:00<00:12, 75.77batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 75.20batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 75.90batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 75.86batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 73.67batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 72.73batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 73.84batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 74.10batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 73.91batch/s] 11%|███                        | 113/1014 [00:01<00:12, 73.68batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 73.71batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 74.70batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 75.40batch/s] 15%|████                       | 152/1014 [00:02<00:11, 74.68batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.88batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 74.62batch/s] 18%|████▊                      | 182/1014 [00:02<00:11, 74.73batch/s] 19%|█████                      | 192/1014 [00:02<00:11, 74.58batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 74.80batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 75.18batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 75.05batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.29batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.34batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 74.63batch/s] 26%|██████▉                    | 262/1014 [00:03<00:10, 75.03batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 75.08batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 74.86batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 75.13batch/s] 30%|████████                   | 302/1014 [00:04<00:09, 75.11batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 75.20batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 75.27batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.35batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 75.52batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 75.75batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 75.84batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 76.32batch/s] 38%|██████████▏                | 382/1014 [00:04<00:08, 76.61batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 76.86batch/s] 40%|██████████▋                | 402/1014 [00:05<00:07, 76.98batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 77.39batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 77.38batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 77.49batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 77.43batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 77.28batch/s] 46%|████████████▎              | 462/1014 [00:05<00:07, 77.25batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 76.93batch/s] 48%|████████████▊              | 482/1014 [00:06<00:06, 76.96batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 77.02batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 77.14batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 77.01batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 77.20batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:06, 77.44batch/s] 53%|██████████████▍            | 542/1014 [00:06<00:06, 77.43batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:05, 77.41batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 77.48batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 77.48batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 77.53batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 77.47batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 77.49batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:05, 77.41batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 77.32batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:04, 77.39batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 77.26batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 77.18batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 77.13batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 77.17batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 77.05batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:04, 77.06batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 77.03batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 76.98batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 76.78batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 76.79batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 76.60batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 76.60batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 76.44batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 76.53batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 76.46batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 76.47batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 76.46batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 76.50batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 76.60batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 76.48batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 76.41batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 76.46batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:01, 76.46batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 76.22batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 76.15batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 76.06batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 76.05batch/s] 90%|████████████████████████▎  | 912/1014 [00:11<00:01, 76.04batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 76.15batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 76.24batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 76.32batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 76.30batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 76.26batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 76.36batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 76.41batch/s] 98%|██████████████████████████▍| 992/1014 [00:12<00:00, 76.33batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 76.26batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 76.15batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.15batch/s]
Validation 7 -> LOSS = 1.56
Validation 7 -> BLEU = 42.81, 69.1/49.1/36.5/27.4 (BP=0.997, ratio=0.997, hyp_len=14339, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.56 @ validation 7
--> Best BLEU so far: 42.81 @ validation 7
Starting Epoch 8
Epoch 8 - update       3360 => loss:   1.844 (#OOM: 0)
Epoch 8 - update       3390 => loss:   1.573 (#OOM: 0)
Epoch 8 - update       3420 => loss:   2.503 (#OOM: 0)
Epoch 8 - update       3450 => loss:   1.654 (#OOM: 0)
Epoch 8 - update       3480 => loss:   1.183 (#OOM: 0)
Epoch 8 - update       3510 => loss:   1.531 (#OOM: 0)
Epoch 8 - update       3540 => loss:   1.344 (#OOM: 0)
Epoch 8 - update       3570 => loss:   1.522 (#OOM: 0)
Epoch 8 - update       3600 => loss:   1.396 (#OOM: 0)
Epoch 8 - update       3630 => loss:   1.711 (#OOM: 0)
Epoch 8 - update       3660 => loss:   1.607 (#OOM: 0)
Epoch 8 - update       3690 => loss:   1.933 (#OOM: 0)
Epoch 8 - update       3720 => loss:   1.637 (#OOM: 0)
Epoch 8 - update       3750 => loss:   1.224 (#OOM: 0)
Epoch 8 - update       3780 => loss:   1.999 (#OOM: 0)
Epoch 8 - update       3810 => loss:   1.556 (#OOM: 0)
--> Epoch 8 finished with mean loss 1.64060
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (788 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.41batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.47batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 46.67batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.21batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 49.70batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.42batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.68batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.12batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 77.59batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 81.51batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 81.54batch/s]  5%|█▌                          | 55/1014 [00:00<00:11, 79.92batch/s]  6%|█▊                          | 65/1014 [00:00<00:12, 79.01batch/s]  7%|██                          | 75/1014 [00:00<00:12, 76.88batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 75.92batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 75.76batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 76.41batch/s] 11%|███                        | 115/1014 [00:01<00:11, 76.02batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 76.35batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.37batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 75.65batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 75.72batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 75.52batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 75.39batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 76.07batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 76.48batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.48batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.50batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 76.83batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 76.68batch/s] 24%|██████▌                    | 245/1014 [00:03<00:09, 76.95batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 77.41batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 77.82batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 77.68batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 77.62batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 77.79batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 77.20batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 77.48batch/s] 32%|████████▋                  | 325/1014 [00:04<00:08, 77.14batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 77.00batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 77.13batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 77.15batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 77.13batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 77.07batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 76.93batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 77.20batch/s] 40%|██████████▊                | 405/1014 [00:05<00:07, 77.00batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 77.27batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 77.21batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 77.24batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 77.00batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 76.72batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 76.78batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 76.61batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 76.44batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 76.47batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 76.50batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 76.54batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 76.65batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:06, 76.54batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 76.47batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 76.34batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 76.28batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 76.39batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 76.30batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 76.25batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 76.19batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 76.28batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 76.08batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 75.92batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.90batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.89batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 76.01batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 76.04batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.92batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.94batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.89batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.87batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.91batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.85batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.81batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 75.79batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.63batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.54batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.54batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.60batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.48batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.49batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.48batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.56batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.54batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.44batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.46batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.35batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.33batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.38batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.44batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.46batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.45batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.46batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.42batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.23batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.10batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.12batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 75.15batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.05batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.12batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.12batch/s]
Validation 8 -> LOSS = 1.48
Validation 8 -> BLEU = 44.34, 69.3/50.3/38.2/29.1 (BP=1.000, ratio=1.016, hyp_len=14619, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.48 @ validation 8
--> Best BLEU so far: 44.34 @ validation 8
Starting Epoch 9
Epoch 9 - update       3840 => loss:   1.570 (#OOM: 0)
Epoch 9 - update       3870 => loss:   1.482 (#OOM: 0)
Epoch 9 - update       3900 => loss:   1.717 (#OOM: 0)
Epoch 9 - update       3930 => loss:   2.421 (#OOM: 0)
Epoch 9 - update       3960 => loss:   1.256 (#OOM: 0)
Epoch 9 - update       3990 => loss:   1.911 (#OOM: 0)
Epoch 9 - update       4020 => loss:   1.259 (#OOM: 0)
Epoch 9 - update       4050 => loss:   1.839 (#OOM: 0)
Epoch 9 - update       4080 => loss:   1.363 (#OOM: 0)
Epoch 9 - update       4110 => loss:   1.188 (#OOM: 0)
Epoch 9 - update       4140 => loss:   1.339 (#OOM: 0)
Epoch 9 - update       4170 => loss:   1.546 (#OOM: 0)
Epoch 9 - update       4200 => loss:   1.311 (#OOM: 0)
Epoch 9 - update       4230 => loss:   1.110 (#OOM: 0)
Epoch 9 - update       4260 => loss:   1.386 (#OOM: 0)
Epoch 9 - update       4290 => loss:   1.547 (#OOM: 0)
--> Epoch 9 finished with mean loss 1.53823
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (793 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 39.96batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 54.12batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.39batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 52.37batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 51.28batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.24batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.76batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 82.66batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 79.68batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 70.77batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 72.01batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 72.74batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 73.56batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 75.29batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 74.74batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 75.66batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 74.91batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 74.58batch/s] 11%|███                        | 116/1014 [00:01<00:12, 72.64batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 73.55batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 72.61batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 72.77batch/s] 15%|████                       | 152/1014 [00:02<00:11, 72.73batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 72.43batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 72.61batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 72.95batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 71.36batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 71.07batch/s] 20%|█████▍                     | 206/1014 [00:02<00:11, 71.66batch/s] 21%|█████▋                     | 215/1014 [00:03<00:11, 71.54batch/s] 22%|█████▉                     | 224/1014 [00:03<00:11, 71.41batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 71.67batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 71.93batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 70.69batch/s] 26%|██████▉                    | 260/1014 [00:03<00:10, 70.94batch/s] 27%|███████▏                   | 269/1014 [00:03<00:10, 71.24batch/s] 27%|███████▍                   | 278/1014 [00:03<00:10, 71.44batch/s] 28%|███████▋                   | 287/1014 [00:04<00:10, 71.33batch/s] 29%|███████▉                   | 296/1014 [00:04<00:10, 71.58batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 71.60batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 71.79batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 71.96batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 72.15batch/s] 34%|█████████                  | 341/1014 [00:04<00:09, 72.36batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:09, 72.45batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:09, 72.55batch/s] 36%|█████████▊                 | 368/1014 [00:05<00:08, 72.63batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 72.65batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 72.66batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 72.95batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 72.23batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 72.32batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 72.19batch/s] 43%|███████████▍               | 431/1014 [00:06<00:08, 71.51batch/s] 43%|███████████▋               | 440/1014 [00:06<00:08, 71.73batch/s] 44%|███████████▉               | 449/1014 [00:06<00:07, 71.72batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 71.95batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 71.97batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 72.00batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 72.14batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 72.32batch/s] 50%|█████████████▍             | 503/1014 [00:07<00:07, 71.85batch/s] 50%|█████████████▋             | 512/1014 [00:07<00:06, 72.02batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 72.17batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 72.13batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 72.12batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 72.14batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 72.11batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 72.02batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:06, 72.04batch/s] 58%|███████████████▌           | 584/1014 [00:08<00:05, 72.12batch/s] 58%|███████████████▊           | 593/1014 [00:08<00:05, 72.07batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 72.13batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 72.23batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 72.43batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 72.63batch/s] 63%|█████████████████          | 640/1014 [00:08<00:05, 72.63batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:05, 72.61batch/s] 65%|█████████████████▌         | 660/1014 [00:09<00:04, 72.74batch/s] 66%|█████████████████▊         | 670/1014 [00:09<00:04, 72.59batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 72.59batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 72.77batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 72.80batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 72.91batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:04, 72.97batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 73.00batch/s] 73%|███████████████████▋       | 740/1014 [00:10<00:03, 73.18batch/s] 74%|███████████████████▉       | 750/1014 [00:10<00:03, 72.75batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 72.92batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 72.96batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 73.00batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:03, 73.09batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 73.06batch/s] 80%|█████████████████████▌     | 810/1014 [00:11<00:02, 73.14batch/s] 81%|█████████████████████▊     | 820/1014 [00:11<00:02, 73.20batch/s] 82%|██████████████████████     | 830/1014 [00:11<00:02, 73.25batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 73.32batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 73.39batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 73.42batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 73.48batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 73.54batch/s] 88%|███████████████████████▋   | 890/1014 [00:12<00:01, 73.62batch/s] 89%|███████████████████████▉   | 900/1014 [00:12<00:01, 73.67batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 73.67batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 73.70batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 73.46batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:01, 73.38batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 73.45batch/s] 95%|█████████████████████████▌ | 960/1014 [00:13<00:00, 73.53batch/s] 96%|█████████████████████████▊ | 970/1014 [00:13<00:00, 73.59batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 73.62batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 73.68batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 73.70batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 73.85batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 73.88batch/s]
Validation 9 -> LOSS = 1.43
Validation 9 -> BLEU = 44.21, 68.0/50.0/38.3/29.3 (BP=1.000, ratio=1.045, hyp_len=15035, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.43 @ validation 9
--> Best BLEU so far: 44.34 @ validation 8
Starting Epoch 10
Epoch 10 - update       4320 => loss:   1.598 (#OOM: 0)
Epoch 10 - update       4350 => loss:   1.359 (#OOM: 0)
Epoch 10 - update       4380 => loss:   1.324 (#OOM: 0)
Epoch 10 - update       4410 => loss:   1.445 (#OOM: 0)
Epoch 10 - update       4440 => loss:   1.593 (#OOM: 0)
Epoch 10 - update       4470 => loss:   1.378 (#OOM: 0)
Epoch 10 - update       4500 => loss:   1.403 (#OOM: 0)
Epoch 10 - update       4530 => loss:   1.502 (#OOM: 0)
Epoch 10 - update       4560 => loss:   1.512 (#OOM: 0)
Epoch 10 - update       4590 => loss:   1.527 (#OOM: 0)
Epoch 10 - update       4620 => loss:   1.404 (#OOM: 0)
Epoch 10 - update       4650 => loss:   1.303 (#OOM: 0)
Epoch 10 - update       4680 => loss:   1.444 (#OOM: 0)
Epoch 10 - update       4710 => loss:   1.251 (#OOM: 0)
Epoch 10 - update       4740 => loss:   1.370 (#OOM: 0)
Epoch 10 - update       4770 => loss:   1.382 (#OOM: 0)
--> Epoch 10 finished with mean loss 1.45495
--> Overhead/Training/Evaluation: 0.03/0.56/0.00 mins (total: 0.59 mins)   (865 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.00batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.93batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 53.59batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.51batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 51.32batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.67batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 80.24batch/s]  2%|▍                           | 18/1014 [00:00<00:15, 63.28batch/s]  3%|▋                           | 27/1014 [00:00<00:15, 64.80batch/s]  4%|▉                           | 36/1014 [00:00<00:15, 64.31batch/s]  4%|█▏                          | 45/1014 [00:00<00:14, 65.53batch/s]  5%|█▍                          | 54/1014 [00:00<00:14, 66.84batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 67.95batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 69.24batch/s]  8%|██▏                         | 81/1014 [00:01<00:13, 69.49batch/s]  9%|██▍                         | 90/1014 [00:01<00:13, 69.80batch/s] 10%|██▋                         | 99/1014 [00:01<00:13, 70.01batch/s] 11%|██▉                        | 108/1014 [00:01<00:13, 69.49batch/s] 12%|███                        | 117/1014 [00:01<00:12, 70.32batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 70.77batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 71.11batch/s] 14%|███▊                       | 144/1014 [00:02<00:12, 71.55batch/s] 15%|████                       | 153/1014 [00:02<00:12, 71.05batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 71.60batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 71.95batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 72.30batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 72.43batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 72.78batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 73.62batch/s] 21%|█████▊                     | 218/1014 [00:03<00:11, 71.90batch/s] 22%|██████                     | 228/1014 [00:03<00:10, 72.18batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 72.35batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 72.31batch/s] 25%|██████▊                    | 258/1014 [00:03<00:10, 72.27batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 71.63batch/s] 27%|███████▍                   | 278/1014 [00:03<00:10, 72.17batch/s] 28%|███████▋                   | 288/1014 [00:03<00:10, 72.25batch/s] 29%|███████▉                   | 298/1014 [00:04<00:09, 72.55batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 72.31batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 72.43batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 72.58batch/s] 33%|█████████                  | 338/1014 [00:04<00:09, 72.60batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:09, 72.83batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 73.03batch/s] 36%|█████████▊                 | 368/1014 [00:05<00:08, 72.89batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 73.03batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 73.17batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 73.36batch/s] 40%|██████████▊                | 408/1014 [00:05<00:08, 73.45batch/s] 41%|███████████▏               | 418/1014 [00:05<00:08, 73.35batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 73.29batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 73.20batch/s] 44%|███████████▉               | 448/1014 [00:06<00:07, 73.14batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 73.33batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 72.92batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 72.93batch/s] 48%|████████████▉              | 488/1014 [00:06<00:07, 72.89batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:07, 73.11batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 73.04batch/s] 51%|█████████████▊             | 518/1014 [00:07<00:06, 73.13batch/s] 52%|██████████████             | 528/1014 [00:07<00:06, 73.13batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 73.20batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 73.27batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 73.27batch/s] 56%|███████████████            | 568/1014 [00:07<00:06, 73.27batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 73.32batch/s] 58%|███████████████▋           | 588/1014 [00:08<00:05, 73.39batch/s] 59%|███████████████▉           | 598/1014 [00:08<00:05, 73.39batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 73.47batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 73.57batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 73.65batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 73.60batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 73.80batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 73.96batch/s] 66%|█████████████████▊         | 669/1014 [00:09<00:04, 74.27batch/s] 67%|██████████████████         | 680/1014 [00:09<00:04, 74.26batch/s] 68%|██████████████████▍        | 691/1014 [00:09<00:04, 74.25batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.41batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:04, 74.51batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.50batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.55batch/s] 74%|███████████████████▊       | 746/1014 [00:10<00:03, 74.43batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 74.47batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 74.43batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 74.25batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:03, 74.28batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 74.19batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 74.18batch/s] 81%|█████████████████████▉     | 823/1014 [00:11<00:02, 74.30batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.22batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 74.33batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 74.41batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 74.41batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 74.44batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 74.39batch/s] 89%|███████████████████████▉   | 900/1014 [00:12<00:01, 74.29batch/s] 90%|████████████████████████▎  | 911/1014 [00:12<00:01, 74.37batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 74.42batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 74.49batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.55batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 74.62batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 74.68batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.67batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 74.69batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 74.56batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 74.59batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.60batch/s]
Validation 10 -> LOSS = 1.38
Validation 10 -> BLEU = 46.51, 70.7/52.4/40.4/31.3 (BP=1.000, ratio=1.023, hyp_len=14716, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.38 @ validation 10
--> Best BLEU so far: 46.51 @ validation 10
Starting Epoch 11
Epoch 11 - update       4800 => loss:   1.297 (#OOM: 0)
Epoch 11 - update       4830 => loss:   1.105 (#OOM: 0)
Epoch 11 - update       4860 => loss:   1.202 (#OOM: 0)
Epoch 11 - update       4890 => loss:   1.183 (#OOM: 0)
Epoch 11 - update       4920 => loss:   1.464 (#OOM: 0)
Epoch 11 - update       4950 => loss:   1.045 (#OOM: 0)
Epoch 11 - update       4980 => loss:   1.369 (#OOM: 0)
Epoch 11 - update       5010 => loss:   1.286 (#OOM: 0)
Epoch 11 - update       5040 => loss:   1.284 (#OOM: 0)
Epoch 11 - update       5070 => loss:   1.314 (#OOM: 0)
Epoch 11 - update       5100 => loss:   1.504 (#OOM: 0)
Epoch 11 - update       5130 => loss:   2.006 (#OOM: 0)
Epoch 11 - update       5160 => loss:   1.309 (#OOM: 0)
Epoch 11 - update       5190 => loss:   1.205 (#OOM: 0)
Epoch 11 - update       5220 => loss:   1.417 (#OOM: 0)
--> Epoch 11 finished with mean loss 1.37894
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.60 mins)   (852 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.01batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.03batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.70batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.20batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.05batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.67batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.09batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.09batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 78.55batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 76.15batch/s]  4%|█▏                          | 43/1014 [00:00<00:13, 73.70batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 72.79batch/s]  6%|█▋                          | 61/1014 [00:00<00:13, 73.04batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 71.94batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 72.43batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 72.46batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 72.42batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 72.96batch/s] 11%|███                        | 115/1014 [00:01<00:12, 72.73batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 71.48batch/s] 13%|███▌                       | 133/1014 [00:01<00:12, 71.94batch/s] 14%|███▊                       | 142/1014 [00:01<00:12, 72.43batch/s] 15%|████                       | 151/1014 [00:02<00:11, 73.21batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 73.44batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 73.00batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 73.52batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 73.93batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 73.91batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.17batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 74.23batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 73.90batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 73.82batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 73.78batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 73.98batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 74.33batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 74.52batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.19batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.29batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 75.47batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 75.31batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 75.67batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 75.44batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 75.27batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 75.47batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.70batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.96batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 75.98batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.67batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 75.65batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 75.88batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 76.16batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 75.95batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.93batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.93batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 76.12batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 76.07batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 76.23batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 76.37batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.60batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 76.60batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.59batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 76.50batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 76.51batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 76.75batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 76.82batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 76.73batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 76.74batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 76.78batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 76.79batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.83batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 76.93batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 76.75batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 76.70batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 76.69batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 76.86batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 76.86batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 76.83batch/s] 68%|██████████████████▎        | 688/1014 [00:08<00:04, 76.93batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 76.94batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:03, 76.75batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 76.75batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 76.78batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 76.86batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 76.87batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 76.92batch/s] 76%|████████████████████▍      | 768/1014 [00:09<00:03, 76.87batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 76.67batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 76.57batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 76.56batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 76.56batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 76.49batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 76.51batch/s] 83%|██████████████████████▎    | 838/1014 [00:10<00:02, 76.57batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 76.35batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 76.25batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 76.13batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 76.16batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 76.16batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 76.24batch/s] 90%|████████████████████████▏  | 908/1014 [00:11<00:01, 76.25batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 76.29batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 76.23batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:00, 76.18batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 76.12batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 76.13batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 76.03batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.99batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.95batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.98batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 76.03batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.96batch/s]
Validation 11 -> LOSS = 1.34
Validation 11 -> BLEU = 48.73, 72.6/54.6/42.6/33.4 (BP=1.000, ratio=1.006, hyp_len=14462, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.34 @ validation 11
--> Best BLEU so far: 48.73 @ validation 11
Starting Epoch 12
Epoch 12 - update       5250 => loss:   1.237 (#OOM: 0)
Epoch 12 - update       5280 => loss:   1.130 (#OOM: 0)
Epoch 12 - update       5310 => loss:   1.346 (#OOM: 0)
Epoch 12 - update       5340 => loss:   1.153 (#OOM: 0)
Epoch 12 - update       5370 => loss:   1.304 (#OOM: 0)
Epoch 12 - update       5400 => loss:   1.366 (#OOM: 0)
Epoch 12 - update       5430 => loss:   1.279 (#OOM: 0)
Epoch 12 - update       5460 => loss:   1.673 (#OOM: 0)
Epoch 12 - update       5490 => loss:   1.195 (#OOM: 0)
Epoch 12 - update       5520 => loss:   1.933 (#OOM: 0)
Epoch 12 - update       5550 => loss:   1.157 (#OOM: 0)
Epoch 12 - update       5580 => loss:   1.111 (#OOM: 0)
Epoch 12 - update       5610 => loss:   1.224 (#OOM: 0)
Epoch 12 - update       5640 => loss:   1.342 (#OOM: 0)
Epoch 12 - update       5670 => loss:   1.730 (#OOM: 0)
Epoch 12 - update       5700 => loss:   1.254 (#OOM: 0)
--> Epoch 12 finished with mean loss 1.31664
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (789 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 39.61batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.93batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 47.72batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 50.22batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.51batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.67batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.95batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.99batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 85.16batch/s]  4%|█                           | 37/1014 [00:00<00:11, 82.59batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 83.96batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 83.74batch/s]  7%|█▊                          | 67/1014 [00:00<00:12, 77.17batch/s]  8%|██▏                         | 77/1014 [00:00<00:12, 77.12batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 76.99batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 76.40batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 76.36batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.18batch/s] 13%|███▍                       | 127/1014 [00:01<00:11, 76.74batch/s] 14%|███▋                       | 137/1014 [00:01<00:11, 76.30batch/s] 14%|███▉                       | 147/1014 [00:01<00:11, 76.63batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 76.18batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 76.44batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 76.49batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 76.28batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 76.69batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 76.47batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 76.73batch/s] 22%|██████                     | 227/1014 [00:02<00:10, 76.50batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 76.41batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 76.51batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 75.97batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.96batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.45batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.03batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.08batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 75.24batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.29batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 75.55batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 75.53batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 75.48batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 75.60batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.85batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 75.97batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 76.01batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 76.03batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 76.07batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 76.35batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 75.32batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 75.35batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 75.40batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.10batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 75.07batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 75.13batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 74.84batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.79batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 74.88batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 74.98batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 75.02batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 75.20batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.34batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 75.39batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.42batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 75.37batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 75.51batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 75.55batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 75.70batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.66batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 75.76batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 75.69batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.71batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.70batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.63batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 75.59batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.50batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.36batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.49batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.63batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.64batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.65batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.63batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 75.73batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.79batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.86batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 75.78batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.77batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.78batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.63batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 75.58batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.58batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.57batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.45batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.37batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.39batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.48batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.45batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 75.45batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 75.40batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.33batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 75.34batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.30batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.34batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.26batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 75.31batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.32batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.39batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.39batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.45batch/s]
Validation 12 -> LOSS = 1.32
Validation 12 -> BLEU = 49.12, 72.5/54.9/43.1/33.9 (BP=1.000, ratio=1.010, hyp_len=14522, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.32 @ validation 12
--> Best BLEU so far: 49.12 @ validation 12
Starting Epoch 13
Epoch 13 - update       5730 => loss:   0.951 (#OOM: 0)
Epoch 13 - update       5760 => loss:   0.947 (#OOM: 0)
Epoch 13 - update       5790 => loss:   1.245 (#OOM: 0)
Epoch 13 - update       5820 => loss:   1.429 (#OOM: 0)
Epoch 13 - update       5850 => loss:   1.154 (#OOM: 0)
Epoch 13 - update       5880 => loss:   1.177 (#OOM: 0)
Epoch 13 - update       5910 => loss:   1.196 (#OOM: 0)
Epoch 13 - update       5940 => loss:   1.209 (#OOM: 0)
Epoch 13 - update       5970 => loss:   1.195 (#OOM: 0)
Epoch 13 - update       6000 => loss:   1.110 (#OOM: 0)
Epoch 13 - update       6030 => loss:   1.064 (#OOM: 0)
Epoch 13 - update       6060 => loss:   1.278 (#OOM: 0)
Epoch 13 - update       6090 => loss:   1.353 (#OOM: 0)
Epoch 13 - update       6120 => loss:   1.121 (#OOM: 0)
Epoch 13 - update       6150 => loss:   1.386 (#OOM: 0)
Epoch 13 - update       6180 => loss:   1.454 (#OOM: 0)
--> Epoch 13 finished with mean loss 1.25382
--> Overhead/Training/Evaluation: 0.03/0.52/0.00 mins (total: 0.55 mins)   (929 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.39batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.24batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 55.88batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 54.03batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 53.63batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.72batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 63.53batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.33batch/s]  2%|▋                           | 25/1014 [00:00<00:14, 67.49batch/s]  3%|▉                           | 34/1014 [00:00<00:14, 66.45batch/s]  4%|█▏                          | 43/1014 [00:00<00:14, 67.86batch/s]  5%|█▍                          | 52/1014 [00:00<00:13, 69.65batch/s]  6%|█▋                          | 61/1014 [00:00<00:14, 66.25batch/s]  7%|█▉                          | 70/1014 [00:01<00:14, 66.74batch/s]  8%|██▏                         | 79/1014 [00:01<00:13, 67.11batch/s]  9%|██▍                         | 88/1014 [00:01<00:13, 67.93batch/s] 10%|██▋                         | 97/1014 [00:01<00:13, 69.01batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 70.09batch/s] 11%|███                        | 115/1014 [00:01<00:12, 70.44batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 71.08batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 72.19batch/s] 14%|███▊                       | 144/1014 [00:01<00:12, 72.13batch/s] 15%|████                       | 154/1014 [00:02<00:11, 72.23batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 72.28batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 72.97batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 73.33batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 73.52batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 73.81batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 74.25batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 73.77batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.88batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 74.02batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 73.77batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 73.87batch/s] 27%|███████▎                   | 274/1014 [00:03<00:10, 73.72batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 73.65batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 74.02batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 73.97batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.36batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.35batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 74.65batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 74.78batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 74.78batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 74.87batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 75.32batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 75.48batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.61batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.84batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.96batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 76.18batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 76.05batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 76.12batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 76.13batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 76.08batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 76.08batch/s] 48%|████████████▉              | 484/1014 [00:06<00:06, 76.30batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 76.21batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 76.11batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.70batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.55batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 75.53batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.56batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.77batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.80batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.75batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.87batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.78batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 75.65batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.76batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.72batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.27batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.26batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.13batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.17batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.24batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.16batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.29batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.41batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.39batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.49batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.38batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.46batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 75.48batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.49batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.61batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.69batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.27batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.27batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 74.86batch/s] 81%|█████████████████████▉     | 824/1014 [00:11<00:02, 74.71batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.84batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 74.72batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.78batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.91batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.90batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.80batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 74.88batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 75.00batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.12batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.04batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.15batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 75.17batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.25batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.22batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.21batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 75.26batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.36batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.31batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.33batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.32batch/s]
Validation 13 -> LOSS = 1.28
Validation 13 -> BLEU = 49.76, 72.7/55.5/43.8/34.7 (BP=1.000, ratio=1.016, hyp_len=14614, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.28 @ validation 13
--> Best BLEU so far: 49.76 @ validation 13
Starting Epoch 14
Epoch 14 - update       6210 => loss:   1.442 (#OOM: 0)
Epoch 14 - update       6240 => loss:   1.205 (#OOM: 0)
Epoch 14 - update       6270 => loss:   0.915 (#OOM: 0)
Epoch 14 - update       6300 => loss:   1.240 (#OOM: 0)
Epoch 14 - update       6330 => loss:   1.063 (#OOM: 0)
Epoch 14 - update       6360 => loss:   1.042 (#OOM: 0)
Epoch 14 - update       6390 => loss:   1.165 (#OOM: 0)
Epoch 14 - update       6420 => loss:   0.766 (#OOM: 0)
Epoch 14 - update       6450 => loss:   1.474 (#OOM: 0)
Epoch 14 - update       6480 => loss:   1.076 (#OOM: 0)
Epoch 14 - update       6510 => loss:   1.165 (#OOM: 0)
Epoch 14 - update       6540 => loss:   1.218 (#OOM: 0)
Epoch 14 - update       6570 => loss:   1.291 (#OOM: 0)
Epoch 14 - update       6600 => loss:   1.043 (#OOM: 0)
Epoch 14 - update       6630 => loss:   1.288 (#OOM: 0)
Epoch 14 - update       6660 => loss:   1.452 (#OOM: 0)
--> Epoch 14 finished with mean loss 1.20171
--> Overhead/Training/Evaluation: 0.03/0.51/0.00 mins (total: 0.54 mins)   (954 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.96batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.17batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.69batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.41batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.17batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.35batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.23batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.11batch/s]  3%|▋                           | 26/1014 [00:00<00:14, 67.73batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 70.11batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 72.28batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 71.83batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 69.58batch/s]  7%|█▉                          | 71/1014 [00:01<00:13, 70.24batch/s]  8%|██▏                         | 80/1014 [00:01<00:13, 70.60batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 71.24batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 72.47batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 72.56batch/s] 11%|███                        | 116/1014 [00:01<00:12, 72.23batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 72.68batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 72.91batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.67batch/s] 15%|████                       | 154/1014 [00:02<00:11, 74.03batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 74.08batch/s] 17%|████▋                      | 174/1014 [00:02<00:11, 74.67batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 74.25batch/s] 19%|█████▏                     | 194/1014 [00:02<00:11, 74.33batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 74.06batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 74.21batch/s] 22%|█████▉                     | 224/1014 [00:03<00:10, 74.02batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.25batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 74.40batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 74.63batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 75.05batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 75.15batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.50batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.47batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.44batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.66batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.82batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 75.93batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 75.80batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 76.03batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 76.12batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 76.30batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 76.46batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 76.58batch/s] 40%|██████████▊                | 404/1014 [00:05<00:07, 76.42batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 76.59batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 76.80batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 76.61batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 76.32batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 76.19batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 76.08batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 76.38batch/s] 48%|████████████▉              | 484/1014 [00:06<00:06, 76.38batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 76.45batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 76.40batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 76.43batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 76.41batch/s] 53%|██████████████▏            | 534/1014 [00:06<00:06, 76.36batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 76.24batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 76.27batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 76.30batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 76.21batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 76.15batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 76.14batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 76.10batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.97batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 76.02batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.97batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 76.06batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 76.15batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 76.23batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 76.32batch/s] 67%|██████████████████▏        | 684/1014 [00:08<00:04, 76.24batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 76.26batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 76.06batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 76.11batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 76.07batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 76.10batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.95batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 75.93batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.91batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.95batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.88batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.79batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.76batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.79batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.97batch/s] 82%|██████████████████████▏    | 834/1014 [00:10<00:02, 75.92batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.91batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.95batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.92batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.88batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.93batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.90batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 75.95batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.54batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.77batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.72batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.75batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.75batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 75.75batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 75.73batch/s] 98%|██████████████████████████▍| 991/1014 [00:13<00:00, 75.75batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.72batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.69batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.70batch/s]
Validation 14 -> LOSS = 1.27
Validation 14 -> BLEU = 51.36, 74.3/57.1/45.4/36.1 (BP=1.000, ratio=1.000, hyp_len=14384, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.27 @ validation 14
--> Best BLEU so far: 51.36 @ validation 14
Starting Epoch 15
Epoch 15 - update       6690 => loss:   1.272 (#OOM: 0)
Epoch 15 - update       6720 => loss:   1.587 (#OOM: 0)
Epoch 15 - update       6750 => loss:   0.959 (#OOM: 0)
Epoch 15 - update       6780 => loss:   1.121 (#OOM: 0)
Epoch 15 - update       6810 => loss:   1.295 (#OOM: 0)
Epoch 15 - update       6840 => loss:   1.120 (#OOM: 0)
Epoch 15 - update       6870 => loss:   1.219 (#OOM: 0)
Epoch 15 - update       6900 => loss:   0.994 (#OOM: 0)
Epoch 15 - update       6930 => loss:   1.097 (#OOM: 0)
Epoch 15 - update       6960 => loss:   0.933 (#OOM: 0)
Epoch 15 - update       6990 => loss:   1.170 (#OOM: 0)
Epoch 15 - update       7020 => loss:   1.161 (#OOM: 0)
Epoch 15 - update       7050 => loss:   1.175 (#OOM: 0)
Epoch 15 - update       7080 => loss:   1.292 (#OOM: 0)
Epoch 15 - update       7110 => loss:   1.050 (#OOM: 0)
Epoch 15 - update       7140 => loss:   1.039 (#OOM: 0)
--> Epoch 15 finished with mean loss 1.15720
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (798 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 49.63batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.25batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.47batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.76batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.88batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.81batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 6/1014 [00:00<00:17, 57.79batch/s]  1%|▍                           | 14/1014 [00:00<00:14, 67.73batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 74.13batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.99batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 76.25batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 75.92batch/s]  6%|█▋                          | 59/1014 [00:00<00:13, 73.06batch/s]  7%|█▉                          | 68/1014 [00:00<00:13, 71.04batch/s]  8%|██▏                         | 77/1014 [00:01<00:13, 70.65batch/s]  8%|██▎                         | 86/1014 [00:01<00:13, 70.87batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 71.86batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 72.13batch/s] 11%|███                        | 113/1014 [00:01<00:12, 71.25batch/s] 12%|███▏                       | 122/1014 [00:01<00:12, 71.04batch/s] 13%|███▍                       | 131/1014 [00:01<00:12, 71.30batch/s] 14%|███▋                       | 140/1014 [00:01<00:12, 71.32batch/s] 15%|███▉                       | 149/1014 [00:02<00:12, 71.91batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 72.02batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 72.35batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 73.15batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 73.66batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 73.65batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 73.72batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 73.95batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 74.38batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 74.30batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 74.31batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 74.58batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 74.86batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.33batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 74.07batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 74.03batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 74.43batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 74.53batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 74.39batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 74.29batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 74.16batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.44batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.56batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.37batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.40batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 74.24batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 74.17batch/s] 41%|███████████                | 417/1014 [00:05<00:08, 74.52batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 74.59batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.30batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 74.50batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 74.59batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.56batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.48batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 74.64batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.74batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 74.65batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 74.79batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 74.81batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 74.76batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 74.72batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 74.81batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 74.63batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 74.40batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 74.21batch/s] 59%|███████████████▉           | 597/1014 [00:08<00:05, 74.21batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 74.32batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 74.38batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 74.39batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 74.19batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 74.22batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.24batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 74.23batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 74.31batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 74.05batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 74.02batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 74.08batch/s] 71%|███████████████████        | 717/1014 [00:09<00:04, 74.18batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 74.18batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 74.13batch/s] 74%|███████████████████▉       | 747/1014 [00:10<00:03, 74.16batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 74.07batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 73.98batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 73.99batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 74.11batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 74.10batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 74.16batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 74.30batch/s] 82%|██████████████████████     | 827/1014 [00:11<00:02, 74.40batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 74.33batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 74.36batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 74.37batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 74.39batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 74.51batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 74.50batch/s] 88%|███████████████████████▉   | 897/1014 [00:12<00:01, 74.44batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 74.44batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 74.48batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 74.58batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 74.52batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 74.58batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 74.66batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 74.56batch/s] 96%|██████████████████████████ | 977/1014 [00:13<00:00, 74.68batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 74.60batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 74.61batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 74.62batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.66batch/s]
Validation 15 -> LOSS = 1.25
Validation 15 -> BLEU = 51.23, 73.6/56.9/45.4/36.2 (BP=1.000, ratio=1.023, hyp_len=14714, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.25 @ validation 15
--> Best BLEU so far: 51.36 @ validation 14
Starting Epoch 16
Epoch 16 - update       7170 => loss:   1.108 (#OOM: 0)
Epoch 16 - update       7200 => loss:   0.961 (#OOM: 0)
Epoch 16 - update       7230 => loss:   1.012 (#OOM: 0)
Epoch 16 - update       7260 => loss:   1.139 (#OOM: 0)
Epoch 16 - update       7290 => loss:   1.060 (#OOM: 0)
Epoch 16 - update       7320 => loss:   1.402 (#OOM: 0)
Epoch 16 - update       7350 => loss:   0.917 (#OOM: 0)
Epoch 16 - update       7380 => loss:   0.936 (#OOM: 0)
Epoch 16 - update       7410 => loss:   1.141 (#OOM: 0)
Epoch 16 - update       7440 => loss:   0.982 (#OOM: 0)
Epoch 16 - update       7470 => loss:   1.585 (#OOM: 0)
Epoch 16 - update       7500 => loss:   1.344 (#OOM: 0)
Epoch 16 - update       7530 => loss:   1.245 (#OOM: 0)
Epoch 16 - update       7560 => loss:   1.095 (#OOM: 0)
Epoch 16 - update       7590 => loss:   0.848 (#OOM: 0)
Epoch 16 - update       7620 => loss:   0.965 (#OOM: 0)
--> Epoch 16 finished with mean loss 1.11297
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (900 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.47batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.30batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.01batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.81batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 52.58batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.45batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.65batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.21batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 74.13batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.65batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 75.80batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 76.60batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 77.73batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 77.51batch/s]  8%|██▏                         | 77/1014 [00:00<00:12, 77.83batch/s]  8%|██▎                         | 86/1014 [00:01<00:11, 78.42batch/s]  9%|██▋                         | 96/1014 [00:01<00:11, 79.60batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 79.97batch/s] 11%|███                        | 116/1014 [00:01<00:11, 79.99batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 79.48batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 79.72batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 79.59batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 79.02batch/s] 16%|████▍                      | 166/1014 [00:02<00:10, 79.85batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 79.93batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 79.11batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 78.73batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 79.23batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 79.27batch/s] 22%|██████                     | 226/1014 [00:02<00:09, 79.37batch/s] 23%|██████▎                    | 236/1014 [00:02<00:09, 79.21batch/s] 24%|██████▌                    | 246/1014 [00:03<00:09, 78.74batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 78.86batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 78.86batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 78.89batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 79.10batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 79.24batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 79.15batch/s] 31%|████████▍                  | 316/1014 [00:04<00:08, 78.71batch/s] 32%|████████▋                  | 326/1014 [00:04<00:08, 78.81batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 78.58batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 78.63batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 78.58batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 78.25batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 78.45batch/s] 38%|██████████▎                | 386/1014 [00:04<00:08, 78.22batch/s] 39%|██████████▌                | 396/1014 [00:05<00:07, 77.87batch/s] 40%|██████████▊                | 406/1014 [00:05<00:07, 77.89batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 77.77batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 77.95batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 77.96batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 77.86batch/s] 45%|████████████▏              | 456/1014 [00:05<00:07, 77.64batch/s] 46%|████████████▍              | 466/1014 [00:05<00:07, 77.88batch/s] 47%|████████████▋              | 476/1014 [00:06<00:06, 77.84batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 77.77batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 77.66batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 77.61batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 77.49batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 77.40batch/s] 53%|██████████████▎            | 536/1014 [00:06<00:06, 77.18batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 76.96batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:05, 77.03batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 76.99batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 76.82batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 76.75batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 76.68batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 76.78batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 76.66batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 76.61batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:04, 76.48batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 76.62batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 76.57batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 76.63batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 76.72batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:04, 76.60batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 76.47batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 76.35batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 76.29batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 76.38batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 76.29batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 76.46batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 76.56batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 76.54batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 76.46batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:02, 76.34batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 76.29batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 76.05batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 76.11batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 76.20batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 76.22batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 76.04batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 76.07batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 76.10batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 76.18batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 76.21batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 76.21batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 76.31batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 76.29batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 76.39batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 76.32batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 76.30batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 76.33batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 76.32batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 76.55batch/s] 97%|██████████████████████████▎| 988/1014 [00:12<00:00, 76.67batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 76.57batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 76.66batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.69batch/s]
Validation 16 -> LOSS = 1.24
Validation 16 -> BLEU = 51.76, 75.4/58.3/46.5/37.2 (BP=0.986, ratio=0.986, hyp_len=14183, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.24 @ validation 16
--> Best BLEU so far: 51.76 @ validation 16
Starting Epoch 17
Epoch 17 - update       7650 => loss:   0.815 (#OOM: 0)
Epoch 17 - update       7680 => loss:   1.497 (#OOM: 0)
Epoch 17 - update       7710 => loss:   1.183 (#OOM: 0)
Epoch 17 - update       7740 => loss:   1.074 (#OOM: 0)
Epoch 17 - update       7770 => loss:   0.754 (#OOM: 0)
Epoch 17 - update       7800 => loss:   1.247 (#OOM: 0)
Epoch 17 - update       7830 => loss:   1.241 (#OOM: 0)
Epoch 17 - update       7860 => loss:   0.954 (#OOM: 0)
Epoch 17 - update       7890 => loss:   0.852 (#OOM: 0)
Epoch 17 - update       7920 => loss:   0.955 (#OOM: 0)
Epoch 17 - update       7950 => loss:   1.083 (#OOM: 0)
Epoch 17 - update       7980 => loss:   1.187 (#OOM: 0)
Epoch 17 - update       8010 => loss:   1.016 (#OOM: 0)
Epoch 17 - update       8040 => loss:   1.070 (#OOM: 0)
Epoch 17 - update       8070 => loss:   1.324 (#OOM: 0)
Epoch 17 - update       8100 => loss:   0.584 (#OOM: 0)
--> Epoch 17 finished with mean loss 1.07417
--> Overhead/Training/Evaluation: 0.03/0.49/0.00 mins (total: 0.52 mins)   (983 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.25batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 53.05batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.95batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.11batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.68batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.37batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.34batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 36.07batch/s]  1%|▎                           | 13/1014 [00:00<00:16, 60.29batch/s]  2%|▌                           | 22/1014 [00:00<00:15, 65.06batch/s]  3%|▊                           | 31/1014 [00:00<00:14, 67.56batch/s]  4%|█                           | 40/1014 [00:00<00:14, 67.82batch/s]  5%|█▎                          | 49/1014 [00:00<00:13, 69.55batch/s]  6%|█▌                          | 58/1014 [00:00<00:14, 64.83batch/s]  7%|█▊                          | 67/1014 [00:01<00:14, 65.90batch/s]  7%|██                          | 76/1014 [00:01<00:13, 67.24batch/s]  8%|██▎                         | 85/1014 [00:01<00:13, 68.92batch/s]  9%|██▌                         | 94/1014 [00:01<00:13, 69.91batch/s] 10%|██▋                        | 103/1014 [00:01<00:12, 70.47batch/s] 11%|██▉                        | 112/1014 [00:01<00:12, 71.48batch/s] 12%|███▏                       | 121/1014 [00:01<00:12, 71.58batch/s] 13%|███▍                       | 130/1014 [00:01<00:12, 71.98batch/s] 14%|███▋                       | 139/1014 [00:01<00:12, 72.72batch/s] 15%|███▉                       | 148/1014 [00:02<00:11, 72.98batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 73.35batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 74.02batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 73.84batch/s] 18%|████▉                      | 184/1014 [00:02<00:11, 73.30batch/s] 19%|█████▏                     | 193/1014 [00:02<00:11, 73.41batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 74.20batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 74.25batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 74.55batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 74.74batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.97batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 75.19batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 75.45batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 75.51batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 75.50batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.98batch/s] 30%|████████                   | 303/1014 [00:03<00:09, 76.34batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 76.53batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.50batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 75.44batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 75.34batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 75.55batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 75.03batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 75.20batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 75.05batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 75.20batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.41batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 75.31batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.26batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.36batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.14batch/s] 45%|████████████               | 453/1014 [00:06<00:07, 75.09batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 75.19batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.37batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 75.51batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.61batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.73batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 75.96batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 75.91batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 75.83batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.91batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 76.11batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 76.11batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 76.07batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 76.09batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 76.06batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 76.09batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 76.13batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 76.12batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.74batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.71batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.67batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 75.68batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 75.82batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.71batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.64batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.74batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 75.89batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.80batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.81batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.95batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 75.84batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.84batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.66batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.79batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.57batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.42batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.46batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.42batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.46batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.32batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.38batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 75.37batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.43batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.43batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.35batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.39batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.37batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.31batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.39batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.36batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.43batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.46batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.39batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.36batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.44batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.40batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.38batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.41batch/s]
Validation 17 -> LOSS = 1.23
Validation 17 -> BLEU = 52.09, 74.4/57.7/46.2/37.1 (BP=1.000, ratio=1.014, hyp_len=14583, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.23 @ validation 17
--> Best BLEU so far: 52.09 @ validation 17
Starting Epoch 18
Epoch 18 - update       8130 => loss:   0.918 (#OOM: 0)
Epoch 18 - update       8160 => loss:   1.146 (#OOM: 0)
Epoch 18 - update       8190 => loss:   1.261 (#OOM: 0)
Epoch 18 - update       8220 => loss:   1.362 (#OOM: 0)
Epoch 18 - update       8250 => loss:   0.816 (#OOM: 0)
Epoch 18 - update       8280 => loss:   0.784 (#OOM: 0)
Epoch 18 - update       8310 => loss:   0.905 (#OOM: 0)
Epoch 18 - update       8340 => loss:   0.955 (#OOM: 0)
Epoch 18 - update       8370 => loss:   0.817 (#OOM: 0)
Epoch 18 - update       8400 => loss:   0.816 (#OOM: 0)
Epoch 18 - update       8430 => loss:   1.015 (#OOM: 0)
Epoch 18 - update       8460 => loss:   0.878 (#OOM: 0)
Epoch 18 - update       8490 => loss:   1.117 (#OOM: 0)
Epoch 18 - update       8520 => loss:   1.013 (#OOM: 0)
Epoch 18 - update       8550 => loss:   1.121 (#OOM: 0)
Epoch 18 - update       8580 => loss:   0.864 (#OOM: 0)
--> Epoch 18 finished with mean loss 1.04221
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.57 mins)   (903 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 47.17batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.38batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.78batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 48.95batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.43batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.00batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.29batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.09batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 77.56batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 73.48batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 74.79batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 75.48batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 75.61batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 76.53batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 77.44batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 77.75batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 78.36batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 78.47batch/s] 11%|███                        | 116/1014 [00:01<00:11, 78.55batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 78.35batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 77.44batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 77.21batch/s] 15%|████                       | 152/1014 [00:01<00:11, 77.37batch/s] 16%|████▎                      | 161/1014 [00:02<00:10, 77.61batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 77.76batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 76.84batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 76.55batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 76.48batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 76.84batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.57batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 76.85batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 77.05batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 76.62batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 76.87batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 76.81batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 76.69batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.16batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.83batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 76.26batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 76.30batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 76.24batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 76.25batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 75.99batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 76.16batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 76.18batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 76.36batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 76.63batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 76.69batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 76.58batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 76.40batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 76.38batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 76.28batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 76.47batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 76.39batch/s] 45%|████████████▏              | 457/1014 [00:05<00:07, 76.58batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 76.65batch/s] 47%|████████████▋              | 477/1014 [00:06<00:06, 76.97batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 77.15batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 77.01batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 76.79batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 76.80batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 76.59batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 76.59batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 76.40batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 76.16batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.87batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 75.88batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 75.98batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 75.82batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 75.82batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 76.00batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 75.86batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 75.94batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.98batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 76.05batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.99batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 75.90batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.75batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.84batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.83batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.94batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.85batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.97batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.85batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 76.00batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 76.14batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 76.21batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 76.36batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 76.27batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 76.14batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 76.15batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 76.05batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 76.07batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 76.18batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.98batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 76.03batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.88batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.88batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.90batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 75.87batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 75.84batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.84batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 75.88batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.85batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.90batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.99batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 76.02batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.72batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.66batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.76batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.77batch/s]
Validation 18 -> LOSS = 1.21
Validation 18 -> BLEU = 52.56, 75.2/58.4/46.6/37.3 (BP=1.000, ratio=1.002, hyp_len=14411, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.21 @ validation 18
--> Best BLEU so far: 52.56 @ validation 18
Starting Epoch 19
Epoch 19 - update       8610 => loss:   1.299 (#OOM: 0)
Epoch 19 - update       8640 => loss:   0.949 (#OOM: 0)
Epoch 19 - update       8670 => loss:   1.173 (#OOM: 0)
Epoch 19 - update       8700 => loss:   0.991 (#OOM: 0)
Epoch 19 - update       8730 => loss:   1.016 (#OOM: 0)
Epoch 19 - update       8760 => loss:   1.193 (#OOM: 0)
Epoch 19 - update       8790 => loss:   1.207 (#OOM: 0)
Epoch 19 - update       8820 => loss:   0.810 (#OOM: 0)
Epoch 19 - update       8850 => loss:   1.106 (#OOM: 0)
Epoch 19 - update       8880 => loss:   0.941 (#OOM: 0)
Epoch 19 - update       8910 => loss:   1.236 (#OOM: 0)
Epoch 19 - update       8940 => loss:   1.244 (#OOM: 0)
Epoch 19 - update       8970 => loss:   0.810 (#OOM: 0)
Epoch 19 - update       9000 => loss:   0.905 (#OOM: 0)
Epoch 19 - update       9030 => loss:   1.022 (#OOM: 0)
Epoch 19 - update       9060 => loss:   0.802 (#OOM: 0)
--> Epoch 19 finished with mean loss 1.00943
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.60 mins)   (850 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.39batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.48batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.80batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 54.08batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 52.42batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.05batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.43batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.84batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.99batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 79.19batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 79.56batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 79.11batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.29batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 77.70batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 73.42batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.91batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 74.81batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 71.37batch/s] 12%|███                        | 117/1014 [00:01<00:12, 71.15batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 69.62batch/s] 13%|███▌                       | 135/1014 [00:01<00:12, 70.39batch/s] 14%|███▊                       | 144/1014 [00:02<00:12, 70.31batch/s] 15%|████                       | 153/1014 [00:02<00:12, 70.73batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 71.01batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 71.49batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 72.01batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 72.30batch/s] 20%|█████▎                     | 198/1014 [00:02<00:11, 72.89batch/s] 20%|█████▌                     | 207/1014 [00:02<00:11, 73.12batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 73.39batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 73.27batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 72.86batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 73.00batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 73.10batch/s] 26%|██████▉                    | 261/1014 [00:03<00:10, 73.35batch/s] 27%|███████▏                   | 270/1014 [00:03<00:10, 73.48batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 73.61batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 73.67batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 73.81batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 73.66batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 73.64batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 73.25batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 73.28batch/s] 34%|█████████                  | 342/1014 [00:04<00:09, 72.98batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:09, 73.04batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 73.36batch/s] 36%|█████████▊                 | 369/1014 [00:05<00:08, 73.42batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 73.54batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 73.54batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 73.77batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 73.85batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 73.74batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 73.90batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 74.00batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 74.12batch/s] 44%|███████████▉               | 450/1014 [00:06<00:07, 74.21batch/s] 45%|████████████▏              | 459/1014 [00:06<00:07, 74.12batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 74.05batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.25batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 74.41batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.30batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.42batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.44batch/s] 51%|█████████████▉             | 522/1014 [00:07<00:06, 74.51batch/s] 52%|██████████████▏            | 531/1014 [00:07<00:06, 74.52batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 74.73batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 74.69batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 74.67batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 74.57batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 74.75batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.71batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.61batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 74.65batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 74.64batch/s] 61%|████████████████▌          | 621/1014 [00:08<00:05, 74.63batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 74.74batch/s] 63%|█████████████████          | 639/1014 [00:08<00:05, 74.58batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 74.46batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 74.45batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.35batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.29batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.42batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 74.56batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 74.56batch/s] 70%|██████████████████▉        | 711/1014 [00:09<00:04, 74.69batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 74.77batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 74.83batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 74.82batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 74.96batch/s] 75%|████████████████████▏      | 758/1014 [00:10<00:03, 74.99batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 75.13batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.22batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:03, 75.19batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.17batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.25batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.15batch/s] 82%|██████████████████████     | 828/1014 [00:11<00:02, 75.24batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.12batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.05batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.10batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.14batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.07batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.14batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.20batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 75.20batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.23batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.28batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.27batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.24batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.23batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.09batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 75.17batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.23batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.19batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.24batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.25batch/s]
Validation 19 -> LOSS = 1.20
Validation 19 -> BLEU = 52.68, 74.7/58.1/46.8/37.9 (BP=1.000, ratio=1.012, hyp_len=14549, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.20 @ validation 19
--> Best BLEU so far: 52.68 @ validation 19
Starting Epoch 20
Epoch 20 - update       9090 => loss:   0.862 (#OOM: 0)
Epoch 20 - update       9120 => loss:   0.887 (#OOM: 0)
Epoch 20 - update       9150 => loss:   0.891 (#OOM: 0)
Epoch 20 - update       9180 => loss:   0.740 (#OOM: 0)
Epoch 20 - update       9210 => loss:   0.682 (#OOM: 0)
Epoch 20 - update       9240 => loss:   1.101 (#OOM: 0)
Epoch 20 - update       9270 => loss:   0.505 (#OOM: 0)
Epoch 20 - update       9300 => loss:   0.987 (#OOM: 0)
Epoch 20 - update       9330 => loss:   1.018 (#OOM: 0)
Epoch 20 - update       9360 => loss:   1.264 (#OOM: 0)
Epoch 20 - update       9390 => loss:   1.138 (#OOM: 0)
Epoch 20 - update       9420 => loss:   1.033 (#OOM: 0)
Epoch 20 - update       9450 => loss:   1.090 (#OOM: 0)
Epoch 20 - update       9480 => loss:   1.211 (#OOM: 0)
Epoch 20 - update       9510 => loss:   0.911 (#OOM: 0)
Epoch 20 - update       9540 => loss:   0.776 (#OOM: 0)
--> Epoch 20 finished with mean loss 0.97879
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.59 mins)   (873 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.50batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.29batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.21batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.06batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.49batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.47batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.03batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.79batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 77.65batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 76.64batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 78.53batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 78.33batch/s]  6%|█▋                          | 62/1014 [00:00<00:11, 79.56batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 81.33batch/s]  8%|██▎                         | 82/1014 [00:01<00:11, 81.61batch/s]  9%|██▌                         | 92/1014 [00:01<00:11, 80.72batch/s] 10%|██▋                        | 102/1014 [00:01<00:11, 79.75batch/s] 11%|██▉                        | 112/1014 [00:01<00:11, 79.76batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 80.22batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 79.81batch/s] 14%|███▊                       | 142/1014 [00:01<00:10, 79.95batch/s] 15%|████                       | 152/1014 [00:01<00:10, 79.33batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 79.23batch/s] 17%|████▌                      | 172/1014 [00:02<00:10, 79.02batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 79.46batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 79.66batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 79.56batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 79.36batch/s] 22%|█████▉                     | 222/1014 [00:02<00:09, 79.38batch/s] 23%|██████▏                    | 232/1014 [00:02<00:09, 78.87batch/s] 24%|██████▍                    | 242/1014 [00:03<00:09, 78.73batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 78.80batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 78.80batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 78.48batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 78.36batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 78.41batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 78.34batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 77.14batch/s] 32%|████████▌                  | 322/1014 [00:04<00:08, 77.22batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 77.22batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 77.39batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 77.55batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 77.52batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 77.33batch/s] 38%|██████████▏                | 382/1014 [00:04<00:08, 77.15batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 77.20batch/s] 40%|██████████▋                | 402/1014 [00:05<00:07, 76.97batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 77.02batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 77.06batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 76.98batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 77.10batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 77.08batch/s] 46%|████████████▎              | 462/1014 [00:05<00:07, 77.28batch/s] 47%|████████████▌              | 472/1014 [00:06<00:06, 77.46batch/s] 48%|████████████▊              | 482/1014 [00:06<00:06, 77.32batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 77.40batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 76.87batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 77.08batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 77.26batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:06, 77.24batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 77.30batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:05, 77.36batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 77.28batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 77.24batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 77.28batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 77.33batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 77.29batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:05, 77.28batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 77.18batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:04, 77.27batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 77.29batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 77.42batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 77.36batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 77.28batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 77.32batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:04, 77.15batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 77.09batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 77.04batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 77.21batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 77.25batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 77.17batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 77.17batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 77.28batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 77.17batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 77.28batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 77.22batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 77.34batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 77.30batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 77.13batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 77.01batch/s] 83%|██████████████████████▍    | 842/1014 [00:10<00:02, 77.02batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 77.17batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:01, 77.27batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 77.23batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 77.16batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 77.18batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 77.29batch/s] 90%|████████████████████████▎  | 912/1014 [00:11<00:01, 77.28batch/s] 91%|████████████████████████▌  | 922/1014 [00:11<00:01, 77.15batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 77.21batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 77.25batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 77.19batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 77.25batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 77.13batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 77.21batch/s] 98%|██████████████████████████▍| 992/1014 [00:12<00:00, 77.18batch/s] 99%|█████████████████████████▋| 1002/1014 [00:12<00:00, 77.19batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 77.13batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 77.12batch/s]
Validation 20 -> LOSS = 1.19
Validation 20 -> BLEU = 53.23, 76.2/59.5/48.0/38.8 (BP=0.988, ratio=0.988, hyp_len=14204, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.19 @ validation 20
--> Best BLEU so far: 53.23 @ validation 20
Starting Epoch 21
Epoch 21 - update       9570 => loss:   0.717 (#OOM: 0)
Epoch 21 - update       9600 => loss:   0.814 (#OOM: 0)
Epoch 21 - update       9630 => loss:   0.778 (#OOM: 0)
Epoch 21 - update       9660 => loss:   0.709 (#OOM: 0)
Epoch 21 - update       9690 => loss:   1.156 (#OOM: 0)
Epoch 21 - update       9720 => loss:   1.175 (#OOM: 0)
Epoch 21 - update       9750 => loss:   1.022 (#OOM: 0)
Epoch 21 - update       9780 => loss:   0.836 (#OOM: 0)
Epoch 21 - update       9810 => loss:   0.535 (#OOM: 0)
Epoch 21 - update       9840 => loss:   1.300 (#OOM: 0)
Epoch 21 - update       9870 => loss:   0.811 (#OOM: 0)
Epoch 21 - update       9900 => loss:   0.913 (#OOM: 0)
Epoch 21 - update       9930 => loss:   0.457 (#OOM: 0)
Epoch 21 - update       9960 => loss:   0.922 (#OOM: 0)
Epoch 21 - update       9990 => loss:   0.842 (#OOM: 0)
--> Epoch 21 finished with mean loss 0.95126
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (818 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.39batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.50batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.71batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.22batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.36batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.23batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.42batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.17batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.64batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 75.27batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.68batch/s]  5%|█▍                          | 51/1014 [00:00<00:13, 73.80batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 73.59batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 74.79batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 75.16batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 75.36batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 75.46batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 73.84batch/s] 11%|███                        | 114/1014 [00:01<00:12, 74.50batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.00batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 75.16batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 76.23batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.80batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.55batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 76.41batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 76.37batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 76.37batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 76.24batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 76.60batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 76.35batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 76.58batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 76.66batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 76.91batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 76.79batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 76.78batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 76.38batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 76.38batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 76.49batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 76.41batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 76.60batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 76.53batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 76.70batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 76.56batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 76.39batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 75.97batch/s] 38%|██████████▏                | 382/1014 [00:05<00:08, 76.15batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 76.27batch/s] 40%|██████████▋                | 402/1014 [00:05<00:08, 76.46batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 76.65batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 76.56batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 76.45batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 76.66batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 76.69batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 76.35batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 76.45batch/s] 48%|████████████▊              | 482/1014 [00:06<00:06, 76.41batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 76.47batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 76.49batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 76.45batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 76.50batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:06, 76.42batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 76.50batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 76.57batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 76.53batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 76.43batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 76.64batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 76.46batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 76.58batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:05, 76.53batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 76.68batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:04, 76.58batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 76.73batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 76.79batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 76.80batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 76.92batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 76.80batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 76.88batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 76.88batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 76.84batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 76.79batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 76.73batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 76.78batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 76.58batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 76.71batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 76.83batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 76.88batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 76.97batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 77.08batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 77.04batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 77.02batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 77.03batch/s] 83%|██████████████████████▍    | 842/1014 [00:10<00:02, 77.07batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 77.06batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:01, 76.94batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 77.05batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 76.90batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 76.91batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 76.89batch/s] 90%|████████████████████████▎  | 912/1014 [00:11<00:01, 76.96batch/s] 91%|████████████████████████▌  | 922/1014 [00:11<00:01, 77.03batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 76.98batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 76.92batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 76.85batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 76.80batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 76.86batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 76.92batch/s] 98%|██████████████████████████▍| 992/1014 [00:12<00:00, 76.97batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 76.90batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 76.76batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.81batch/s]
Validation 21 -> LOSS = 1.19
Validation 21 -> BLEU = 53.35, 76.5/59.8/48.2/39.0 (BP=0.986, ratio=0.986, hyp_len=14177, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.19 @ validation 20
--> Best BLEU so far: 53.35 @ validation 21
Starting Epoch 22
Epoch 22 - update      10020 => loss:   0.833 (#OOM: 0)
Epoch 22 - update      10050 => loss:   0.580 (#OOM: 0)
Epoch 22 - update      10080 => loss:   0.346 (#OOM: 0)
Epoch 22 - update      10110 => loss:   0.712 (#OOM: 0)
Epoch 22 - update      10140 => loss:   0.868 (#OOM: 0)
Epoch 22 - update      10170 => loss:   0.819 (#OOM: 0)
Epoch 22 - update      10200 => loss:   1.227 (#OOM: 0)
Epoch 22 - update      10230 => loss:   0.837 (#OOM: 0)
Epoch 22 - update      10260 => loss:   0.945 (#OOM: 0)
Epoch 22 - update      10290 => loss:   0.994 (#OOM: 0)
Epoch 22 - update      10320 => loss:   0.947 (#OOM: 0)
Epoch 22 - update      10350 => loss:   0.809 (#OOM: 0)
Epoch 22 - update      10380 => loss:   1.013 (#OOM: 0)
Epoch 22 - update      10410 => loss:   0.972 (#OOM: 0)
Epoch 22 - update      10440 => loss:   1.036 (#OOM: 0)
Epoch 22 - update      10470 => loss:   1.112 (#OOM: 0)
--> Epoch 22 finished with mean loss 0.92638
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (847 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 48.69batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 47.78batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.90batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.40batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 51.66batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.46batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 71.59batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.58batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 77.41batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 77.16batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 75.91batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 75.18batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 74.51batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 75.10batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 74.82batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 74.72batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 74.97batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 74.73batch/s] 11%|███                        | 115/1014 [00:01<00:12, 74.58batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 74.02batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 73.63batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 73.83batch/s] 15%|████                       | 151/1014 [00:02<00:11, 73.58batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 73.24batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 73.18batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 72.46batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 71.71batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 72.15batch/s] 20%|█████▍                     | 205/1014 [00:02<00:11, 72.72batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 73.01batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 72.86batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 73.25batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 73.04batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 72.11batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 71.79batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 71.78batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 71.88batch/s] 28%|███████▌                   | 286/1014 [00:04<00:10, 71.45batch/s] 29%|███████▉                   | 296/1014 [00:04<00:09, 71.91batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 72.23batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 72.82batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 73.19batch/s] 33%|████████▉                  | 336/1014 [00:04<00:09, 72.97batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:09, 73.21batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 73.49batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 73.78batch/s] 37%|██████████                 | 376/1014 [00:05<00:08, 74.00batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 74.18batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 74.30batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 74.31batch/s] 41%|███████████                | 416/1014 [00:05<00:08, 74.40batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 74.57batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 74.71batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 74.78batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 74.93batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 74.81batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 74.93batch/s] 48%|████████████▉              | 486/1014 [00:06<00:07, 75.00batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 75.04batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 75.24batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.35batch/s] 52%|██████████████             | 526/1014 [00:07<00:06, 75.13batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.10batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.04batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.23batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.33batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.39batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.58batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.50batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 75.36batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 75.23batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.12batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 75.22batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.28batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.34batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.34batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 75.10batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.01batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.09batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.14batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.27batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.36batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.47batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.38batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.28batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.21batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 75.19batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 75.30batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 75.27batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.40batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 75.49batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.54batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 75.57batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 75.70batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 75.73batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.75batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 75.83batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.94batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 76.00batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 76.04batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.98batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.98batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 76.09batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.99batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 76.02batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.94batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 76.02batch/s] 97%|██████████████████████████▎| 986/1014 [00:12<00:00, 76.06batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 76.11batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.72batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.74batch/s]
Validation 22 -> LOSS = 1.18
Validation 22 -> BLEU = 53.82, 75.7/59.4/47.9/38.9 (BP=1.000, ratio=1.003, hyp_len=14425, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.18 @ validation 22
--> Best BLEU so far: 53.82 @ validation 22
Starting Epoch 23
Epoch 23 - update      10500 => loss:   0.843 (#OOM: 0)
Epoch 23 - update      10530 => loss:   0.763 (#OOM: 0)
Epoch 23 - update      10560 => loss:   1.201 (#OOM: 0)
Epoch 23 - update      10590 => loss:   1.039 (#OOM: 0)
Epoch 23 - update      10620 => loss:   0.698 (#OOM: 0)
Epoch 23 - update      10650 => loss:   0.717 (#OOM: 0)
Epoch 23 - update      10680 => loss:   0.924 (#OOM: 0)
Epoch 23 - update      10710 => loss:   0.691 (#OOM: 0)
Epoch 23 - update      10740 => loss:   0.815 (#OOM: 0)
Epoch 23 - update      10770 => loss:   0.809 (#OOM: 0)
Epoch 23 - update      10800 => loss:   0.732 (#OOM: 0)
Epoch 23 - update      10830 => loss:   0.741 (#OOM: 0)
Epoch 23 - update      10860 => loss:   0.868 (#OOM: 0)
Epoch 23 - update      10890 => loss:   0.675 (#OOM: 0)
Epoch 23 - update      10920 => loss:   0.941 (#OOM: 0)
Epoch 23 - update      10950 => loss:   0.718 (#OOM: 0)
--> Epoch 23 finished with mean loss 0.90027
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (857 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 37.46batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.59batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.09batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.00batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 50.80batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.35batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.30batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 74.70batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 78.60batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 75.04batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.34batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 76.76batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 76.01batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 74.17batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.07batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 73.22batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 73.51batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.78batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.51batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.39batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.92batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.45batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.81batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 76.03batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.87batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.23batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 76.08batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 76.16batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 76.06batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 76.56batch/s] 22%|██████                     | 227/1014 [00:02<00:10, 76.88batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 76.76batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 76.44batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 74.94batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.10batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.26batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.59batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.76batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 75.75batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.83batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 75.81batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 75.52batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 75.61batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 75.54batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 75.59batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 75.64batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 75.72batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 75.87batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 75.97batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 75.65batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 75.84batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 75.93batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 76.10batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.96batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 76.00batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 76.14batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 76.09batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 76.23batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 76.16batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 76.07batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 75.85batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 75.87batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.83batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 75.97batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.93batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 76.04batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 76.13batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 76.07batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 76.09batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 76.36batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 76.35batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 76.37batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 76.22batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 76.23batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 76.22batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 76.21batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 76.29batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 76.30batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 76.35batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 76.34batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 76.34batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 76.18batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 76.17batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 76.28batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 76.12batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 76.20batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 76.21batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 76.18batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 76.20batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 76.17batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 76.22batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 76.18batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 76.23batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 76.20batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 76.19batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 76.17batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 76.25batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 76.27batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 76.25batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 76.28batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 76.42batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 76.41batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 76.39batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 76.48batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 76.50batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 76.57batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 76.60batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 76.49batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 76.59batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.50batch/s]
Validation 23 -> LOSS = 1.17
Validation 23 -> BLEU = 54.11, 75.9/59.6/48.4/39.2 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.17 @ validation 23
--> Best BLEU so far: 54.11 @ validation 23
Starting Epoch 24
Epoch 24 - update      10980 => loss:   0.897 (#OOM: 0)
Epoch 24 - update      11010 => loss:   0.947 (#OOM: 0)
Epoch 24 - update      11040 => loss:   0.871 (#OOM: 0)
Epoch 24 - update      11070 => loss:   0.700 (#OOM: 0)
Epoch 24 - update      11100 => loss:   1.175 (#OOM: 0)
Epoch 24 - update      11130 => loss:   0.860 (#OOM: 0)
Epoch 24 - update      11160 => loss:   0.720 (#OOM: 0)
Epoch 24 - update      11190 => loss:   0.750 (#OOM: 0)
Epoch 24 - update      11220 => loss:   0.746 (#OOM: 0)
Epoch 24 - update      11250 => loss:   0.758 (#OOM: 0)
Epoch 24 - update      11280 => loss:   0.599 (#OOM: 0)
Epoch 24 - update      11310 => loss:   0.887 (#OOM: 0)
Epoch 24 - update      11340 => loss:   1.098 (#OOM: 0)
Epoch 24 - update      11370 => loss:   1.105 (#OOM: 0)
Epoch 24 - update      11400 => loss:   0.985 (#OOM: 0)
Epoch 24 - update      11430 => loss:   0.972 (#OOM: 0)
--> Epoch 24 finished with mean loss 0.88048
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (795 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.60batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.14batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 46.98batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 48.75batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.32batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.51batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 82.20batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 81.66batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.13batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 80.16batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.99batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 76.17batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 78.13batch/s]  7%|██                          | 74/1014 [00:00<00:11, 78.62batch/s]  8%|██▎                         | 84/1014 [00:01<00:11, 77.81batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 78.07batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 77.06batch/s] 11%|███                        | 114/1014 [00:01<00:11, 76.60batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 77.27batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 78.01batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 77.76batch/s] 15%|████                       | 154/1014 [00:01<00:10, 78.19batch/s] 16%|████▎                      | 164/1014 [00:02<00:10, 78.70batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 77.54batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 77.04batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 76.71batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 76.57batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 76.45batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.93batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.33batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 74.88batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 75.12batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 75.35batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 75.54batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.64batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.74batch/s] 30%|████████                   | 304/1014 [00:03<00:09, 76.34batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 76.22batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 76.03batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 75.88batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 76.33batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 75.93batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 75.80batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 76.02batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 76.39batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 76.53batch/s] 40%|██████████▊                | 404/1014 [00:05<00:07, 76.72batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 76.70batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 76.85batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 76.82batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 76.51batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 76.53batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 76.33batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 76.18batch/s] 48%|████████████▉              | 484/1014 [00:06<00:06, 76.27batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 76.21batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 76.28batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 76.06batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 76.12batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 76.24batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 76.25batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 76.38batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 76.26batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 76.40batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 76.41batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 76.40batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 76.38batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 76.42batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 76.50batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:04, 76.60batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 76.48batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 76.43batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 76.53batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 76.39batch/s] 67%|██████████████████▏        | 684/1014 [00:08<00:04, 76.25batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 76.34batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 76.07batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 76.05batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 76.02batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.98batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 76.02batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 76.15batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.97batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.96batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.95batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 76.06batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.53batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.70batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.66batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.61batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.53batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.49batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.50batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.60batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.72batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.88batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 75.85batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.83batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.69batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.66batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 75.66batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.55batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.53batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.63batch/s] 97%|██████████████████████████▏| 984/1014 [00:12<00:00, 75.73batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.68batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.67batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.75batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.75batch/s]
Validation 24 -> LOSS = 1.17
Validation 24 -> BLEU = 55.21, 76.5/60.6/49.4/40.5 (BP=1.000, ratio=1.001, hyp_len=14397, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.17 @ validation 24
--> Best BLEU so far: 55.21 @ validation 24
Starting Epoch 25
Epoch 25 - update      11460 => loss:   0.643 (#OOM: 0)
Epoch 25 - update      11490 => loss:   1.108 (#OOM: 0)
Epoch 25 - update      11520 => loss:   0.646 (#OOM: 0)
Epoch 25 - update      11550 => loss:   0.784 (#OOM: 0)
Epoch 25 - update      11580 => loss:   1.264 (#OOM: 0)
Epoch 25 - update      11610 => loss:   0.814 (#OOM: 0)
Epoch 25 - update      11640 => loss:   0.875 (#OOM: 0)
Epoch 25 - update      11670 => loss:   0.912 (#OOM: 0)
Epoch 25 - update      11700 => loss:   0.732 (#OOM: 0)
Epoch 25 - update      11730 => loss:   0.543 (#OOM: 0)
Epoch 25 - update      11760 => loss:   0.824 (#OOM: 0)
Epoch 25 - update      11790 => loss:   0.786 (#OOM: 0)
Epoch 25 - update      11820 => loss:   0.832 (#OOM: 0)
Epoch 25 - update      11850 => loss:   0.996 (#OOM: 0)
Epoch 25 - update      11880 => loss:   0.944 (#OOM: 0)
Epoch 25 - update      11910 => loss:   0.524 (#OOM: 0)
--> Epoch 25 finished with mean loss 0.85680
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.67 mins)   (774 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.76batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 48.20batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 50.16batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 49.54batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.10batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.02batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.98batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.94batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.26batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 74.70batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 74.11batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 72.39batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 71.80batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 70.03batch/s]  7%|█▉                          | 71/1014 [00:00<00:13, 71.42batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 72.84batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 72.68batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 72.66batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 72.36batch/s] 11%|███                        | 116/1014 [00:01<00:12, 72.38batch/s] 12%|███▎                       | 125/1014 [00:01<00:12, 71.76batch/s] 13%|███▌                       | 134/1014 [00:01<00:12, 72.41batch/s] 14%|███▊                       | 143/1014 [00:01<00:12, 72.29batch/s] 15%|████                       | 152/1014 [00:02<00:11, 72.99batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 73.21batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 73.73batch/s] 18%|████▊                      | 179/1014 [00:02<00:11, 74.01batch/s] 19%|█████                      | 188/1014 [00:02<00:11, 74.51batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 74.83batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.99batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.33batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.40batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 76.02batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 75.91batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 76.18batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 76.08batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 75.93batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 76.12batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 76.27batch/s] 30%|████████                   | 304/1014 [00:03<00:09, 76.33batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 76.36batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 76.23batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 76.35batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 76.53batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 76.62batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 76.85batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 76.92batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 76.75batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 76.23batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 76.03batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.89batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 76.26batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 76.26batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 76.00batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 75.92batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.93batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.97batch/s] 48%|████████████▉              | 484/1014 [00:06<00:06, 75.93batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 76.16batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 76.16batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 76.15batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 76.28batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 76.04batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 76.21batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 76.35batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 76.41batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 76.53batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 76.49batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 76.52batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 76.49batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 76.56batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 76.63batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:04, 76.72batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 76.67batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 76.54batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 76.49batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 76.40batch/s] 67%|██████████████████▏        | 684/1014 [00:08<00:04, 76.48batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 76.47batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 76.52batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 76.40batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 76.45batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 76.49batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 76.67batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 76.50batch/s] 75%|████████████████████▎      | 764/1014 [00:09<00:03, 76.41batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 76.49batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 76.44batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 76.34batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 76.30batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 76.11batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 76.07batch/s] 82%|██████████████████████▏    | 834/1014 [00:10<00:02, 76.01batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.95batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.96batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 76.04batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.88batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.89batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.90batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 76.04batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.95batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.82batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.75batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 75.65batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.68batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.69batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.72batch/s] 97%|██████████████████████████▏| 984/1014 [00:12<00:00, 75.75batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.79batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.71batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.66batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.65batch/s]
Validation 25 -> LOSS = 1.17
Validation 25 -> BLEU = 54.55, 76.3/60.1/48.8/39.7 (BP=0.999, ratio=0.999, hyp_len=14369, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.17 @ validation 24
--> Best BLEU so far: 55.21 @ validation 24
Starting Epoch 26
Epoch 26 - update      11940 => loss:   0.926 (#OOM: 0)
Epoch 26 - update      11970 => loss:   0.724 (#OOM: 0)
Epoch 26 - update      12000 => loss:   0.625 (#OOM: 0)
Epoch 26 - update      12030 => loss:   0.882 (#OOM: 0)
Epoch 26 - update      12060 => loss:   0.918 (#OOM: 0)
Epoch 26 - update      12090 => loss:   0.940 (#OOM: 0)
Epoch 26 - update      12120 => loss:   0.711 (#OOM: 0)
Epoch 26 - update      12150 => loss:   0.687 (#OOM: 0)
Epoch 26 - update      12180 => loss:   0.872 (#OOM: 0)
Epoch 26 - update      12210 => loss:   0.918 (#OOM: 0)
Epoch 26 - update      12240 => loss:   0.800 (#OOM: 0)
Epoch 26 - update      12270 => loss:   0.735 (#OOM: 0)
Epoch 26 - update      12300 => loss:   0.746 (#OOM: 0)
Epoch 26 - update      12330 => loss:   0.902 (#OOM: 0)
Epoch 26 - update      12360 => loss:   0.645 (#OOM: 0)
Epoch 26 - update      12390 => loss:   0.884 (#OOM: 0)
--> Epoch 26 finished with mean loss 0.83946
--> Overhead/Training/Evaluation: 0.02/0.46/0.00 mins (total: 0.48 mins)   (1052 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.32batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 47.86batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 49.74batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 49.72batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.98batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.18batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.77batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.72batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.30batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 75.30batch/s]  4%|█▏                          | 42/1014 [00:00<00:14, 68.59batch/s]  5%|█▍                          | 51/1014 [00:00<00:14, 68.04batch/s]  6%|█▋                          | 60/1014 [00:00<00:13, 70.04batch/s]  7%|█▉                          | 69/1014 [00:00<00:13, 69.97batch/s]  8%|██▏                         | 78/1014 [00:01<00:13, 69.88batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 71.32batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 72.02batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 72.35batch/s] 11%|███                        | 114/1014 [00:01<00:12, 73.43batch/s] 12%|███▎                       | 123/1014 [00:01<00:12, 73.34batch/s] 13%|███▌                       | 132/1014 [00:01<00:12, 72.69batch/s] 14%|███▊                       | 141/1014 [00:01<00:12, 72.36batch/s] 15%|███▉                       | 150/1014 [00:02<00:11, 72.41batch/s] 16%|████▏                      | 159/1014 [00:02<00:11, 72.43batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 72.69batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 72.72batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 73.43batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 74.04batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 74.66batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 74.99batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 75.41batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 75.65batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 75.83batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.51batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 75.36batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 75.55batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.53batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 75.94batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 75.48batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 75.42batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 74.39batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 74.42batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 74.56batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.83batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 74.76batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.79batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 74.90batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 75.00batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 74.79batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 74.68batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 75.10batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 74.92batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 75.00batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.04batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.99batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 75.09batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 75.36batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 75.45batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 75.35batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 75.62batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 75.70batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 75.58batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 75.76batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 75.82batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 75.95batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 76.16batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 76.09batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 76.03batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 76.06batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.98batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 75.93batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 75.88batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.73batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.71batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.63batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 75.35batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.47batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.41batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.52batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.50batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.43batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.65batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.74batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 75.72batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.75batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.70batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 75.79batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.92batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 76.07batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 76.07batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 75.90batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.95batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.93batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.87batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 76.01batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 76.06batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 76.02batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 76.11batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 76.15batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 76.29batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 76.25batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 76.29batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 76.26batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 76.22batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 76.20batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 76.11batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 76.22batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 76.24batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 76.30batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.27batch/s]
Validation 26 -> LOSS = 1.17
Validation 26 -> BLEU = 54.34, 76.3/60.0/48.7/39.6 (BP=0.997, ratio=0.997, hyp_len=14339, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.17 @ validation 24
--> Best BLEU so far: 55.21 @ validation 24
Starting Epoch 27
Epoch 27 - update      12420 => loss:   0.625 (#OOM: 0)
Epoch 27 - update      12450 => loss:   0.767 (#OOM: 0)
Epoch 27 - update      12480 => loss:   0.752 (#OOM: 0)
Epoch 27 - update      12510 => loss:   0.819 (#OOM: 0)
Epoch 27 - update      12540 => loss:   0.707 (#OOM: 0)
Epoch 27 - update      12570 => loss:   0.785 (#OOM: 0)
Epoch 27 - update      12600 => loss:   0.797 (#OOM: 0)
Epoch 27 - update      12630 => loss:   0.536 (#OOM: 0)
Epoch 27 - update      12660 => loss:   0.657 (#OOM: 0)
Epoch 27 - update      12690 => loss:   0.854 (#OOM: 0)
Epoch 27 - update      12720 => loss:   0.674 (#OOM: 0)
Epoch 27 - update      12750 => loss:   1.084 (#OOM: 0)
Epoch 27 - update      12780 => loss:   0.676 (#OOM: 0)
Epoch 27 - update      12810 => loss:   1.257 (#OOM: 0)
Epoch 27 - update      12840 => loss:   0.860 (#OOM: 0)
Epoch 27 - update      12870 => loss:   0.682 (#OOM: 0)
--> Epoch 27 finished with mean loss 0.81877
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (847 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.46batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.01batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.44batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.66batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.74batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.01batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.98batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.72batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 80.66batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 78.81batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 74.77batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 75.14batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 76.38batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 75.05batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 77.30batch/s]  8%|██▎                         | 82/1014 [00:01<00:11, 78.00batch/s]  9%|██▌                         | 92/1014 [00:01<00:11, 79.15batch/s] 10%|██▋                        | 102/1014 [00:01<00:11, 79.43batch/s] 11%|██▉                        | 112/1014 [00:01<00:11, 80.38batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 79.68batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 78.58batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 79.22batch/s] 15%|████                       | 152/1014 [00:01<00:10, 79.98batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 80.54batch/s] 17%|████▌                      | 172/1014 [00:02<00:10, 80.28batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 80.21batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 80.06batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 79.99batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 79.68batch/s] 22%|█████▉                     | 222/1014 [00:02<00:09, 80.11batch/s] 23%|██████▏                    | 232/1014 [00:02<00:09, 79.74batch/s] 24%|██████▍                    | 242/1014 [00:03<00:09, 79.51batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 79.00batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 78.80batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 78.65batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 78.21batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 77.95batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 77.91batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 77.49batch/s] 32%|████████▌                  | 322/1014 [00:04<00:08, 77.66batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 77.29batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 76.82batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 76.76batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 77.02batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 76.75batch/s] 38%|██████████▏                | 382/1014 [00:04<00:08, 76.83batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 76.99batch/s] 40%|██████████▋                | 402/1014 [00:05<00:07, 77.01batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 77.03batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 76.81batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 76.44batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 76.59batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 76.58batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 76.57batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 76.67batch/s] 48%|████████████▊              | 482/1014 [00:06<00:06, 76.67batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 76.83batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 76.81batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 76.77batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 76.80batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:06, 76.95batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 76.80batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 76.84batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 76.75batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 76.70batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 76.67batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 76.77batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 76.68batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:05, 76.64batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 76.58batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:04, 76.48batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 76.56batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 76.46batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 76.49batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 76.40batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 76.55batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 76.04batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 76.03batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 76.06batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 76.19batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 76.37batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 76.37batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 76.14batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 76.22batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 76.36batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 76.31batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 76.15batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 76.24batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 76.31batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 76.21batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 76.16batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 76.22batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 76.02batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:01, 76.05batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 76.11batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 75.73batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 75.70batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 75.81batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.71batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.67batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.62batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.59batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.56batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.58batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.60batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 75.58batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.62batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.59batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.64batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.64batch/s]
Validation 27 -> LOSS = 1.16
Validation 27 -> BLEU = 54.52, 76.1/60.0/48.7/39.7 (BP=1.000, ratio=1.007, hyp_len=14480, ref_len=14382)
** Learning rate changed -> 0.0002
Saving best model based on LOSS
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.16 @ validation 27
--> Best BLEU so far: 55.21 @ validation 24
Starting Epoch 28
Epoch 28 - update      12900 => loss:   0.585 (#OOM: 0)
Epoch 28 - update      12930 => loss:   1.104 (#OOM: 0)
Epoch 28 - update      12960 => loss:   0.547 (#OOM: 0)
Epoch 28 - update      12990 => loss:   0.821 (#OOM: 0)
Epoch 28 - update      13020 => loss:   0.861 (#OOM: 0)
Epoch 28 - update      13050 => loss:   0.800 (#OOM: 0)
Epoch 28 - update      13080 => loss:   0.697 (#OOM: 0)
Epoch 28 - update      13110 => loss:   0.645 (#OOM: 0)
Epoch 28 - update      13140 => loss:   0.718 (#OOM: 0)
Epoch 28 - update      13170 => loss:   0.794 (#OOM: 0)
Epoch 28 - update      13200 => loss:   0.691 (#OOM: 0)
Epoch 28 - update      13230 => loss:   0.600 (#OOM: 0)
Epoch 28 - update      13260 => loss:   0.520 (#OOM: 0)
Epoch 28 - update      13290 => loss:   0.727 (#OOM: 0)
Epoch 28 - update      13320 => loss:   0.624 (#OOM: 0)
Epoch 28 - update      13350 => loss:   0.688 (#OOM: 0)
--> Epoch 28 finished with mean loss 0.76848
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (801 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 41.92batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.67batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.84batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.55batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.19batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.96batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 95.10batch/s]  2%|▌                           | 20/1014 [00:00<00:11, 88.83batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 88.81batch/s]  4%|█                           | 40/1014 [00:00<00:11, 88.42batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 86.50batch/s]  6%|█▋                          | 60/1014 [00:00<00:10, 87.24batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 84.65batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 83.75batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 83.80batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 82.96batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 82.74batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 83.48batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 82.55batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 82.33batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 82.04batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 82.05batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 81.84batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 81.82batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 81.95batch/s] 20%|█████▎                     | 200/1014 [00:02<00:09, 81.94batch/s] 21%|█████▌                     | 210/1014 [00:02<00:09, 81.28batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 81.32batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 81.37batch/s] 24%|██████▍                    | 240/1014 [00:02<00:09, 81.15batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 81.26batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 80.86batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 80.58batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 80.27batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 80.31batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 80.24batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 80.00batch/s] 32%|████████▌                  | 320/1014 [00:04<00:08, 79.73batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 79.52batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 79.29batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 79.48batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 79.39batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 78.81batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 78.69batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 78.87batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 79.01batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 79.14batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 79.19batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 79.10batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 78.97batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 79.22batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 79.23batch/s] 46%|████████████▌              | 470/1014 [00:05<00:06, 79.23batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 79.08batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 78.74batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 78.56batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 78.70batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 78.73batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 78.84batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:06, 78.83batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 79.00batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 79.07batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 78.89batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 78.95batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 78.66batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 78.45batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 78.58batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:05, 78.56batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:04, 78.52batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 78.47batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 78.46batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 78.33batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 78.16batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 77.93batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:04, 78.02batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:04, 77.94batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:03, 77.67batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 77.65batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 77.60batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 77.38batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 77.46batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 77.54batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:03, 77.44batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 77.24batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 77.18batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 77.22batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 77.17batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 77.15batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 77.19batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 77.27batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 77.05batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:01, 77.03batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 77.02batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 77.09batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 77.03batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 77.00batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 76.91batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 76.72batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 76.69batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 76.59batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 76.60batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 76.40batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 76.35batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 76.29batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 76.40batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 76.44batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 76.48batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.43batch/s]
Validation 28 -> LOSS = 1.14
Validation 28 -> BLEU = 55.10, 76.8/60.7/49.3/40.4 (BP=0.998, ratio=0.998, hyp_len=14359, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 55.21 @ validation 24
Starting Epoch 29
Epoch 29 - update      13380 => loss:   0.789 (#OOM: 0)
Epoch 29 - update      13410 => loss:   0.657 (#OOM: 0)
Epoch 29 - update      13440 => loss:   0.734 (#OOM: 0)
Epoch 29 - update      13470 => loss:   0.602 (#OOM: 0)
Epoch 29 - update      13500 => loss:   0.680 (#OOM: 0)
Epoch 29 - update      13530 => loss:   0.903 (#OOM: 0)
Epoch 29 - update      13560 => loss:   0.631 (#OOM: 0)
Epoch 29 - update      13590 => loss:   0.734 (#OOM: 0)
Epoch 29 - update      13620 => loss:   0.855 (#OOM: 0)
Epoch 29 - update      13650 => loss:   0.940 (#OOM: 0)
Epoch 29 - update      13680 => loss:   0.688 (#OOM: 0)
Epoch 29 - update      13710 => loss:   0.656 (#OOM: 0)
Epoch 29 - update      13740 => loss:   0.787 (#OOM: 0)
Epoch 29 - update      13770 => loss:   0.662 (#OOM: 0)
Epoch 29 - update      13800 => loss:   0.644 (#OOM: 0)
Epoch 29 - update      13830 => loss:   0.667 (#OOM: 0)
--> Epoch 29 finished with mean loss 0.74920
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.59 mins)   (875 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.46batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.77batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.68batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.48batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.35batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.61batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 83.07batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 78.14batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.58batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 75.85batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 73.78batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 74.53batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 74.74batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 73.75batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 74.55batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 75.02batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.91batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 76.37batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.56batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.61batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 75.70batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.35batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.38batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.50batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.56batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.70batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.81batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.29batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 75.66batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 75.82batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 75.64batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.75batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 76.21batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 76.29batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 76.62batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 76.29batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 76.50batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 76.74batch/s] 30%|████████                   | 304/1014 [00:03<00:09, 76.89batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 76.46batch/s] 32%|████████▋                  | 324/1014 [00:04<00:08, 76.73batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 76.44batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 76.36batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 76.32batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 76.15batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 76.09batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 75.92batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 76.05batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.93batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.62batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.24batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.53batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.54batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 75.44batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.47batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.56batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.65batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.69batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.67batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.89batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.83batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 76.04batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.86batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 76.00batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 76.09batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 76.13batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 76.08batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.83batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 75.75batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.88batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.87batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.84batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.78batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.73batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.90batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.90batch/s] 67%|██████████████████▏        | 684/1014 [00:08<00:04, 76.03batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 76.11batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 76.22batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 76.25batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 76.41batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 76.44batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 76.21batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 76.17batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.99batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 76.12batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.94batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.88batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.83batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.81batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.81batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.79batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.75batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.65batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.68batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.72batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.66batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.81batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 75.90batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.86batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.93batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.96batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 76.07batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 76.02batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 76.06batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 76.10batch/s] 97%|██████████████████████████▏| 984/1014 [00:12<00:00, 75.98batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 76.07batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 76.13batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.04batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.04batch/s]
Validation 29 -> LOSS = 1.15
Validation 29 -> BLEU = 55.27, 77.0/61.0/49.8/40.7 (BP=0.995, ratio=0.995, hyp_len=14310, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 55.27 @ validation 29
Starting Epoch 30
Epoch 30 - update      13860 => loss:   0.648 (#OOM: 0)
Epoch 30 - update      13890 => loss:   0.967 (#OOM: 0)
Epoch 30 - update      13920 => loss:   0.729 (#OOM: 0)
Epoch 30 - update      13950 => loss:   0.702 (#OOM: 0)
Epoch 30 - update      13980 => loss:   0.898 (#OOM: 0)
Epoch 30 - update      14010 => loss:   0.634 (#OOM: 0)
Epoch 30 - update      14040 => loss:   0.662 (#OOM: 0)
Epoch 30 - update      14070 => loss:   0.619 (#OOM: 0)
Epoch 30 - update      14100 => loss:   0.526 (#OOM: 0)
Epoch 30 - update      14130 => loss:   0.913 (#OOM: 0)
Epoch 30 - update      14160 => loss:   0.847 (#OOM: 0)
Epoch 30 - update      14190 => loss:   0.883 (#OOM: 0)
Epoch 30 - update      14220 => loss:   0.687 (#OOM: 0)
Epoch 30 - update      14250 => loss:   0.933 (#OOM: 0)
Epoch 30 - update      14280 => loss:   0.489 (#OOM: 0)
Epoch 30 - update      14310 => loss:   0.678 (#OOM: 0)
--> Epoch 30 finished with mean loss 0.73548
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (834 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.83batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.27batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.82batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.16batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 52.19batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.37batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:16, 62.12batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 70.22batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 71.41batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 74.09batch/s]  4%|█▏                          | 41/1014 [00:00<00:13, 74.41batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 76.00batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 75.96batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 73.72batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 74.13batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 74.89batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 75.72batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 76.58batch/s] 11%|███                        | 113/1014 [00:01<00:11, 76.64batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 75.86batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 76.35batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 76.18batch/s] 15%|███▉                       | 149/1014 [00:01<00:11, 75.97batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 76.11batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 75.41batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 76.00batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 75.87batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 75.80batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 76.32batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 76.01batch/s] 22%|█████▉                     | 221/1014 [00:02<00:10, 75.43batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 75.59batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 75.33batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 75.52batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 75.42batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.75batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 75.63batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.59batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.51batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 75.86batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 75.67batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 75.85batch/s] 32%|████████▊                  | 329/1014 [00:04<00:09, 75.82batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 76.11batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 75.94batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 76.08batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.95batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 75.92batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 75.85batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 75.84batch/s] 40%|██████████▋                | 401/1014 [00:05<00:08, 75.88batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 76.08batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 76.23batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 76.00batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 75.94batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.91batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.58batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.71batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.90batch/s] 48%|████████████▊              | 482/1014 [00:06<00:07, 75.96batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 75.82batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 75.87batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 75.99batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 75.99batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 76.06batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 76.02batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.97batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.93batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 75.99batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 76.09batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 76.06batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 75.95batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 75.93batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.00batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 75.83batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.91batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 75.94batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.96batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 75.89batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 75.87batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 75.73batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 75.56batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 75.27batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 75.39batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.33batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.39batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.34batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.53batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.25batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 75.36batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.35batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.44batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.53batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.46batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.46batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.66batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.51batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.53batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.67batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.75batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.82batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.75batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.74batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.73batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.91batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.84batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.80batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.73batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.83batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.87batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.90batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.84batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 75.86batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.90batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 76.00batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.99batch/s]
Validation 30 -> LOSS = 1.15
Validation 30 -> BLEU = 55.35, 76.9/60.9/49.7/40.9 (BP=0.997, ratio=0.997, hyp_len=14339, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 55.35 @ validation 30
Starting Epoch 31
Epoch 31 - update      14340 => loss:   0.801 (#OOM: 0)
Epoch 31 - update      14370 => loss:   0.384 (#OOM: 0)
Epoch 31 - update      14400 => loss:   0.689 (#OOM: 0)
Epoch 31 - update      14430 => loss:   0.733 (#OOM: 0)
Epoch 31 - update      14460 => loss:   0.614 (#OOM: 0)
Epoch 31 - update      14490 => loss:   0.514 (#OOM: 0)
Epoch 31 - update      14520 => loss:   0.628 (#OOM: 0)
Epoch 31 - update      14550 => loss:   0.789 (#OOM: 0)
Epoch 31 - update      14580 => loss:   0.757 (#OOM: 0)
Epoch 31 - update      14610 => loss:   0.778 (#OOM: 0)
Epoch 31 - update      14640 => loss:   0.632 (#OOM: 0)
Epoch 31 - update      14670 => loss:   0.715 (#OOM: 0)
Epoch 31 - update      14700 => loss:   0.816 (#OOM: 0)
Epoch 31 - update      14730 => loss:   0.762 (#OOM: 0)
Epoch 31 - update      14760 => loss:   0.518 (#OOM: 0)
--> Epoch 31 finished with mean loss 0.72438
--> Overhead/Training/Evaluation: 0.05/0.64/0.00 mins (total: 0.69 mins)   (753 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.76batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.99batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 49.77batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.60batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.95batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.88batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.85batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 77.91batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 76.20batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 75.26batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 77.02batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.09batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 79.35batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.95batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 75.08batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 75.15batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.69batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.30batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.45batch/s] 12%|███                        | 117/1014 [00:01<00:12, 74.46batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.06batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 75.09batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 76.37batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 76.30batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 76.76batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 76.32batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 75.81batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 75.74batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.91batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 74.42batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.78batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 74.97batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 74.96batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 74.96batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.80batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.66batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 74.68batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.05batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.01batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.05batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 74.82batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.56batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 74.42batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.22batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.24batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.64batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.92batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.14batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.38batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 75.33batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.25batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.34batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.86batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 75.60batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.81batch/s] 47%|████████████▊              | 479/1014 [00:06<00:07, 75.83batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 76.24batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 76.12batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 76.21batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 76.25batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 76.01batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 76.16batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:05, 76.37batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 76.46batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 76.43batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 76.62batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 76.60batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:05, 76.72batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 76.78batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:04, 76.65batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 76.64batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 76.47batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 76.31batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 76.36batch/s] 68%|██████████████████▎        | 688/1014 [00:08<00:04, 76.48batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 76.51batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:03, 76.54batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 76.45batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 76.42batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 76.45batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 76.34batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 76.28batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 76.12batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 76.01batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.84batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 75.87batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 75.95batch/s] 82%|██████████████████████▏    | 831/1014 [00:10<00:02, 75.95batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.96batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.98batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 76.00batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 76.10batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.94batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.97batch/s] 90%|████████████████████████▏  | 908/1014 [00:11<00:01, 76.05batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 75.98batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 76.13batch/s] 93%|█████████████████████████  | 941/1014 [00:12<00:00, 76.00batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 76.06batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 76.16batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 76.28batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 76.16batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 76.22batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 76.26batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.27batch/s]
Validation 31 -> LOSS = 1.15
Validation 31 -> BLEU = 55.88, 77.4/61.6/50.3/41.4 (BP=0.995, ratio=0.995, hyp_len=14312, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 55.88 @ validation 31
Starting Epoch 32
Epoch 32 - update      14790 => loss:   0.988 (#OOM: 0)
Epoch 32 - update      14820 => loss:   0.685 (#OOM: 0)
Epoch 32 - update      14850 => loss:   0.564 (#OOM: 0)
Epoch 32 - update      14880 => loss:   0.549 (#OOM: 0)
Epoch 32 - update      14910 => loss:   0.508 (#OOM: 0)
Epoch 32 - update      14940 => loss:   0.621 (#OOM: 0)
Epoch 32 - update      14970 => loss:   0.829 (#OOM: 0)
Epoch 32 - update      15000 => loss:   0.679 (#OOM: 0)
Epoch 32 - update      15030 => loss:   0.630 (#OOM: 0)
Epoch 32 - update      15060 => loss:   0.622 (#OOM: 0)
Epoch 32 - update      15090 => loss:   0.550 (#OOM: 0)
Epoch 32 - update      15120 => loss:   0.695 (#OOM: 0)
Epoch 32 - update      15150 => loss:   0.377 (#OOM: 0)
Epoch 32 - update      15180 => loss:   0.668 (#OOM: 0)
Epoch 32 - update      15210 => loss:   0.692 (#OOM: 0)
Epoch 32 - update      15240 => loss:   0.575 (#OOM: 0)
--> Epoch 32 finished with mean loss 0.71737
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (792 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.01batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.45batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 49.91batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.27batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 50.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.83batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 77.14batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 80.16batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 73.21batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 75.09batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 72.27batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 71.64batch/s]  6%|█▋                          | 62/1014 [00:00<00:13, 72.08batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 72.69batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 73.80batch/s]  9%|██▍                         | 89/1014 [00:01<00:12, 73.64batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 74.18batch/s] 11%|██▊                        | 107/1014 [00:01<00:12, 74.93batch/s] 11%|███                        | 116/1014 [00:01<00:11, 75.72batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 75.63batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 75.60batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.05batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.54batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 75.69batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 75.88batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 76.04batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.94batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 76.20batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 76.25batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.20batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 75.99batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 76.12batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.75batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 75.94batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 76.18batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 76.01batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 76.33batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 76.60batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 74.76batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.00batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.01batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.07batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.17batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 75.13batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.24batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 74.31batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 74.30batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 74.09batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 73.97batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.16batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.08batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.33batch/s] 42%|███████████▏               | 422/1014 [00:05<00:08, 73.76batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 73.55batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 73.52batch/s] 44%|███████████▉               | 449/1014 [00:06<00:07, 73.67batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 73.64batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 73.43batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 73.54batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 73.49batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:07, 73.39batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 73.62batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 73.79batch/s] 51%|█████████████▊             | 521/1014 [00:07<00:06, 73.96batch/s] 52%|██████████████             | 530/1014 [00:07<00:06, 74.01batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 74.21batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 74.20batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 74.35batch/s] 56%|███████████████            | 566/1014 [00:07<00:06, 74.30batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.10batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.25batch/s] 58%|███████████████▊           | 593/1014 [00:08<00:05, 74.04batch/s] 59%|████████████████           | 602/1014 [00:08<00:05, 74.18batch/s] 60%|████████████████▎          | 611/1014 [00:08<00:05, 74.20batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 74.26batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 74.28batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:05, 74.29batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 74.41batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 74.50batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 74.72batch/s] 67%|██████████████████         | 676/1014 [00:09<00:04, 74.66batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 74.72batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 74.76batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 74.84batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 74.94batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.06batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.12batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.26batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.28batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.28batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 75.12batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 75.18batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 75.16batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.22batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 75.30batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.40batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 75.36batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 75.29batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 75.25batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.14batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 75.20batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.24batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 75.21batch/s] 89%|████████████████████████   | 906/1014 [00:12<00:01, 75.27batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.33batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.24batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.33batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 75.30batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 75.33batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 75.45batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.41batch/s] 97%|██████████████████████████▎| 986/1014 [00:13<00:00, 75.37batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 75.33batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.41batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.49batch/s]
Validation 32 -> LOSS = 1.14
Validation 32 -> BLEU = 55.27, 76.4/60.7/49.5/40.7 (BP=1.000, ratio=1.008, hyp_len=14504, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 55.88 @ validation 31
Starting Epoch 33
Epoch 33 - update      15270 => loss:   0.616 (#OOM: 0)
Epoch 33 - update      15300 => loss:   0.770 (#OOM: 0)
Epoch 33 - update      15330 => loss:   0.851 (#OOM: 0)
Epoch 33 - update      15360 => loss:   0.502 (#OOM: 0)
Epoch 33 - update      15390 => loss:   0.634 (#OOM: 0)
Epoch 33 - update      15420 => loss:   0.539 (#OOM: 0)
Epoch 33 - update      15450 => loss:   0.620 (#OOM: 0)
Epoch 33 - update      15480 => loss:   1.018 (#OOM: 0)
Epoch 33 - update      15510 => loss:   0.594 (#OOM: 0)
Epoch 33 - update      15540 => loss:   0.918 (#OOM: 0)
Epoch 33 - update      15570 => loss:   0.606 (#OOM: 0)
Epoch 33 - update      15600 => loss:   0.832 (#OOM: 0)
Epoch 33 - update      15630 => loss:   0.555 (#OOM: 0)
Epoch 33 - update      15660 => loss:   0.833 (#OOM: 0)
Epoch 33 - update      15690 => loss:   0.721 (#OOM: 0)
Epoch 33 - update      15720 => loss:   0.716 (#OOM: 0)
--> Epoch 33 finished with mean loss 0.70742
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (778 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.62batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.39batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.16batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 50.87batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.33batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.81batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.77batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.97batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 80.63batch/s]  3%|▋                           | 26/1014 [00:00<00:11, 83.40batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 80.05batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 80.50batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 79.75batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 81.53batch/s]  7%|██                          | 73/1014 [00:00<00:11, 79.15batch/s]  8%|██▎                         | 83/1014 [00:01<00:11, 78.32batch/s]  9%|██▌                         | 93/1014 [00:01<00:11, 77.44batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 77.17batch/s] 11%|███                        | 113/1014 [00:01<00:11, 76.27batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 75.52batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.41batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.07batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.81batch/s] 16%|████▎                      | 163/1014 [00:02<00:11, 75.64batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 75.93batch/s] 18%|████▊                      | 183/1014 [00:02<00:10, 75.86batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 76.33batch/s] 20%|█████▍                     | 203/1014 [00:02<00:10, 76.51batch/s] 21%|█████▋                     | 213/1014 [00:02<00:10, 76.55batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 76.77batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 76.69batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 76.81batch/s] 25%|██████▋                    | 253/1014 [00:03<00:09, 76.55batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 76.36batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 76.51batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 76.24batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 76.48batch/s] 30%|████████                   | 303/1014 [00:03<00:09, 76.44batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 76.14batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.98batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 75.83batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 75.86batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 75.91batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 75.69batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 76.01batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 76.37batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 76.35batch/s] 40%|██████████▋                | 403/1014 [00:05<00:07, 76.57batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 76.67batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 76.78batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 76.74batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 76.80batch/s] 45%|████████████               | 453/1014 [00:05<00:07, 76.41batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 76.22batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 76.17batch/s] 48%|████████████▊              | 483/1014 [00:06<00:06, 76.07batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 76.35batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 76.46batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 76.52batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 76.46batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:06, 76.71batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 76.41batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 76.51batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 76.42batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 76.29batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 76.08batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 76.17batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 76.13batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 76.16batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 76.27batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:04, 76.29batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 76.36batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 76.23batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 76.21batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 76.03batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.85batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.87batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.69batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 75.60batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.47batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.56batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.43batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 75.47batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.56batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.53batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.64batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.57batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.58batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.56batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.57batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.61batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.73batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.73batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:01, 75.80batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.74batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.79batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.74batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.79batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.71batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.78batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.70batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.71batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.62batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.60batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.66batch/s] 97%|██████████████████████████▏| 983/1014 [00:12<00:00, 75.73batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.80batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.91batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.84batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.85batch/s]
Validation 33 -> LOSS = 1.15
Validation 33 -> BLEU = 55.75, 76.9/61.2/50.0/41.1 (BP=1.000, ratio=1.001, hyp_len=14395, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 55.88 @ validation 31
Starting Epoch 34
Epoch 34 - update      15750 => loss:   0.662 (#OOM: 0)
Epoch 34 - update      15780 => loss:   0.658 (#OOM: 0)
Epoch 34 - update      15810 => loss:   0.529 (#OOM: 0)
Epoch 34 - update      15840 => loss:   0.745 (#OOM: 0)
Epoch 34 - update      15870 => loss:   0.453 (#OOM: 0)
Epoch 34 - update      15900 => loss:   0.541 (#OOM: 0)
Epoch 34 - update      15930 => loss:   0.604 (#OOM: 0)
Epoch 34 - update      15960 => loss:   0.740 (#OOM: 0)
Epoch 34 - update      15990 => loss:   0.552 (#OOM: 0)
Epoch 34 - update      16020 => loss:   0.994 (#OOM: 0)
Epoch 34 - update      16050 => loss:   0.773 (#OOM: 0)
Epoch 34 - update      16080 => loss:   0.918 (#OOM: 0)
Epoch 34 - update      16110 => loss:   0.436 (#OOM: 0)
Epoch 34 - update      16140 => loss:   0.617 (#OOM: 0)
Epoch 34 - update      16170 => loss:   0.629 (#OOM: 0)
Epoch 34 - update      16200 => loss:   0.590 (#OOM: 0)
--> Epoch 34 finished with mean loss 0.69929
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (810 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 49.67batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.35batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.87batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 52.83batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.05batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.25batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.57batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.01batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.01batch/s]  4%|█                           | 37/1014 [00:00<00:11, 82.56batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 81.60batch/s]  6%|█▌                          | 57/1014 [00:00<00:12, 79.36batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 79.32batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 79.94batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 80.07batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 80.20batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 79.78batch/s] 12%|███                        | 117/1014 [00:01<00:11, 78.93batch/s] 13%|███▍                       | 127/1014 [00:01<00:11, 79.15batch/s] 14%|███▋                       | 137/1014 [00:01<00:11, 78.75batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 79.25batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 78.83batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 78.72batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 79.48batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 78.22batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 78.47batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 78.02batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 78.00batch/s] 22%|██████                     | 227/1014 [00:02<00:10, 78.06batch/s] 23%|██████▎                    | 237/1014 [00:03<00:09, 78.08batch/s] 24%|██████▌                    | 247/1014 [00:03<00:09, 78.21batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 78.70batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 78.72batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 78.40batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 78.14batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 78.22batch/s] 30%|████████▏                  | 307/1014 [00:03<00:09, 78.36batch/s] 31%|████████▍                  | 317/1014 [00:04<00:08, 78.28batch/s] 32%|████████▋                  | 327/1014 [00:04<00:08, 77.49batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 77.51batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 77.48batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 77.52batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 77.36batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 77.43batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 77.40batch/s] 39%|██████████▌                | 397/1014 [00:05<00:07, 77.19batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 77.07batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 77.12batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 77.04batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 77.10batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 77.20batch/s] 45%|████████████▏              | 457/1014 [00:05<00:07, 76.96batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 76.90batch/s] 47%|████████████▋              | 477/1014 [00:06<00:06, 76.76batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 76.62batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 76.57batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 76.68batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 76.76batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 76.64batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 76.66batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 76.84batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:05, 76.81batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 76.68batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 76.79batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 76.92batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 76.96batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 77.05batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 77.05batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 76.99batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:04, 76.89batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 77.05batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 76.95batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 76.91batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 77.05batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:04, 76.93batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 77.08batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:03, 77.03batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 77.04batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 76.98batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 77.10batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 76.95batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 76.87batch/s] 76%|████████████████████▍      | 767/1014 [00:09<00:03, 76.74batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 76.82batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:02, 76.79batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 76.89batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 76.98batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 76.79batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 76.77batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 76.71batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 76.80batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 76.72batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 76.83batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 76.92batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 76.98batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 76.88batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 76.85batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 76.86batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 76.81batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 76.76batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 76.72batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 76.80batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 76.75batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 76.69batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 76.56batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 76.50batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 76.40batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.44batch/s]
Validation 34 -> LOSS = 1.15
Validation 34 -> BLEU = 55.26, 77.1/61.0/49.8/40.9 (BP=0.993, ratio=0.993, hyp_len=14283, ref_len=14382)
** Learning rate changed -> 0.0001
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 55.88 @ validation 31
Starting Epoch 35
Epoch 35 - update      16230 => loss:   0.540 (#OOM: 0)
Epoch 35 - update      16260 => loss:   0.520 (#OOM: 0)
Epoch 35 - update      16290 => loss:   0.450 (#OOM: 0)
Epoch 35 - update      16320 => loss:   0.388 (#OOM: 0)
Epoch 35 - update      16350 => loss:   0.794 (#OOM: 0)
Epoch 35 - update      16380 => loss:   0.453 (#OOM: 0)
Epoch 35 - update      16410 => loss:   0.567 (#OOM: 0)
Epoch 35 - update      16440 => loss:   0.604 (#OOM: 0)
Epoch 35 - update      16470 => loss:   0.686 (#OOM: 0)
Epoch 35 - update      16500 => loss:   0.549 (#OOM: 0)
Epoch 35 - update      16530 => loss:   0.542 (#OOM: 0)
Epoch 35 - update      16560 => loss:   0.466 (#OOM: 0)
Epoch 35 - update      16590 => loss:   0.524 (#OOM: 0)
Epoch 35 - update      16620 => loss:   0.894 (#OOM: 0)
Epoch 35 - update      16650 => loss:   0.486 (#OOM: 0)
Epoch 35 - update      16680 => loss:   0.572 (#OOM: 0)
--> Epoch 35 finished with mean loss 0.67365
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (895 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.46batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.34batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.61batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.30batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 52.53batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.41batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 71.89batch/s]  2%|▍                           | 17/1014 [00:00<00:13, 76.59batch/s]  3%|▋                           | 26/1014 [00:00<00:13, 75.42batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 78.01batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 76.12batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.09batch/s]  6%|█▊                          | 64/1014 [00:00<00:12, 77.09batch/s]  7%|██                          | 74/1014 [00:00<00:12, 76.81batch/s]  8%|██▎                         | 84/1014 [00:01<00:11, 78.33batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 78.11batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 77.73batch/s] 11%|███                        | 114/1014 [00:01<00:11, 76.39batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 77.13batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 77.30batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 76.66batch/s] 15%|████                       | 154/1014 [00:01<00:11, 77.08batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 76.75batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 77.10batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 77.22batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 77.02batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 77.26batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 77.37batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 76.90batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 76.84batch/s] 24%|██████▍                    | 244/1014 [00:03<00:09, 77.22batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 77.32batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 77.31batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 76.87batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 76.62batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 76.90batch/s] 30%|████████                   | 304/1014 [00:03<00:09, 76.61batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 76.36batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 76.57batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 76.54batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 76.25batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 76.47batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 76.19batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 76.12batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 76.25batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 76.28batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 76.24batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 76.43batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 76.69batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 76.63batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 76.86batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 76.74batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 76.73batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 76.63batch/s] 48%|████████████▉              | 484/1014 [00:06<00:06, 76.49batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 76.05batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 76.34batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 76.35batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 76.42batch/s] 53%|██████████████▏            | 534/1014 [00:06<00:06, 76.29batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 76.26batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 76.21batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 76.27batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 76.35batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 76.38batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 76.38batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 76.31batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 76.22batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.97batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:04, 76.18batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 76.13batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.91batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.84batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.64batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.67batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.74batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.82batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.83batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.89batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 76.00batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.96batch/s] 74%|████████████████████       | 754/1014 [00:09<00:03, 75.94batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 76.04batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 76.09batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 76.22batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 76.19batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 76.19batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 76.23batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 76.21batch/s] 82%|██████████████████████▏    | 834/1014 [00:10<00:02, 76.22batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 76.23batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 76.23batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 76.14batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 76.28batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 76.18batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 76.15batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 76.04batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 76.11batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 76.24batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 76.23batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 76.24batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 76.30batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 76.34batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 76.26batch/s] 97%|██████████████████████████▏| 984/1014 [00:12<00:00, 76.20batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 76.26batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 76.27batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.30batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.30batch/s]
Validation 35 -> LOSS = 1.14
Validation 35 -> BLEU = 55.85, 77.2/61.4/50.4/41.6 (BP=0.995, ratio=0.995, hyp_len=14306, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 55.88 @ validation 31
Starting Epoch 36
Epoch 36 - update      16710 => loss:   0.776 (#OOM: 0)
Epoch 36 - update      16740 => loss:   0.418 (#OOM: 0)
Epoch 36 - update      16770 => loss:   0.653 (#OOM: 0)
Epoch 36 - update      16800 => loss:   0.810 (#OOM: 0)
Epoch 36 - update      16830 => loss:   0.810 (#OOM: 0)
Epoch 36 - update      16860 => loss:   0.396 (#OOM: 0)
Epoch 36 - update      16890 => loss:   0.538 (#OOM: 0)
Epoch 36 - update      16920 => loss:   0.531 (#OOM: 0)
Epoch 36 - update      16950 => loss:   0.986 (#OOM: 0)
Epoch 36 - update      16980 => loss:   0.776 (#OOM: 0)
Epoch 36 - update      17010 => loss:   0.734 (#OOM: 0)
Epoch 36 - update      17040 => loss:   0.877 (#OOM: 0)
Epoch 36 - update      17070 => loss:   0.620 (#OOM: 0)
Epoch 36 - update      17100 => loss:   0.720 (#OOM: 0)
Epoch 36 - update      17130 => loss:   0.794 (#OOM: 0)
Epoch 36 - update      17160 => loss:   0.516 (#OOM: 0)
--> Epoch 36 finished with mean loss 0.66542
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.61 mins)   (838 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.38batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.80batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.68batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.25batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.79batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.38batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.35batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 96.75batch/s]  2%|▌                           | 20/1014 [00:00<00:12, 80.50batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 82.88batch/s]  4%|█                           | 40/1014 [00:00<00:11, 83.77batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 80.42batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 80.85batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 81.13batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 80.42batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 80.52batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 80.03batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 79.78batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 79.35batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 79.19batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 79.25batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 78.76batch/s] 16%|████▎                      | 160/1014 [00:02<00:10, 78.51batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 78.95batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 78.31batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 78.39batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 78.65batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 78.85batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 78.81batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 78.46batch/s] 24%|██████▍                    | 240/1014 [00:03<00:09, 78.46batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 78.78batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 79.01batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 78.57batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 78.58batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 78.46batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 78.43batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 78.30batch/s] 32%|████████▌                  | 320/1014 [00:04<00:08, 77.83batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 77.84batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 77.45batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 77.52batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 77.49batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 77.50batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 77.40batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 77.51batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 77.91batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 77.68batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 77.57batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 77.53batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 77.68batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 77.62batch/s] 45%|████████████▏              | 460/1014 [00:05<00:07, 77.58batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 77.69batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 77.69batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 77.59batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 77.24batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 77.28batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 77.24batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 77.27batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:06, 77.21batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 76.95batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 77.00batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 77.14batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 77.18batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 76.99batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 77.12batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 77.27batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 77.22batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:04, 77.07batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 77.15batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 77.00batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 76.75batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 76.80batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 76.66batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 76.60batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 76.70batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:03, 76.76batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 76.76batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 76.82batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 76.65batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 76.70batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 76.88batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 76.88batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 77.08batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 76.96batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 76.95batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 76.93batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 76.80batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 76.64batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 76.64batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 76.53batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 76.62batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 76.57batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 76.45batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 76.53batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 76.48batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 76.52batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 76.61batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 76.64batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 76.58batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 76.52batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 76.47batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 76.48batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 76.46batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 76.53batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 76.40batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 76.35batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.40batch/s]
Validation 36 -> LOSS = 1.14
Validation 36 -> BLEU = 56.06, 77.1/61.4/50.4/41.6 (BP=0.998, ratio=0.998, hyp_len=14360, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 28
--> Best BLEU so far: 56.06 @ validation 36
Starting Epoch 37
Epoch 37 - update      17190 => loss:   0.522 (#OOM: 0)
Epoch 37 - update      17220 => loss:   0.509 (#OOM: 0)
Epoch 37 - update      17250 => loss:   0.507 (#OOM: 0)
Epoch 37 - update      17280 => loss:   0.754 (#OOM: 0)
Epoch 37 - update      17310 => loss:   0.727 (#OOM: 0)
Epoch 37 - update      17340 => loss:   0.847 (#OOM: 0)
Epoch 37 - update      17370 => loss:   0.531 (#OOM: 0)
Epoch 37 - update      17400 => loss:   0.521 (#OOM: 0)
Epoch 37 - update      17430 => loss:   0.504 (#OOM: 0)
Epoch 37 - update      17460 => loss:   0.624 (#OOM: 0)
Epoch 37 - update      17490 => loss:   0.645 (#OOM: 0)
Epoch 37 - update      17520 => loss:   0.819 (#OOM: 0)
Epoch 37 - update      17550 => loss:   0.731 (#OOM: 0)
Epoch 37 - update      17580 => loss:   0.495 (#OOM: 0)
Epoch 37 - update      17610 => loss:   0.786 (#OOM: 0)
Epoch 37 - update      17640 => loss:   0.710 (#OOM: 0)
--> Epoch 37 finished with mean loss 0.65983
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (789 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.04batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.72batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 53.04batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.64batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.07batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.64batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.09batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.00batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.09batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 78.38batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 76.77batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 75.14batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 74.78batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 75.14batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 76.52batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 75.68batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 75.99batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 76.05batch/s] 11%|███                        | 116/1014 [00:01<00:11, 77.02batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.95batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 75.85batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 74.10batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 74.07batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 74.02batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 74.27batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.12batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 73.93batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.26batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.59batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 74.90batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 75.09batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 75.17batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 74.74batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.18batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 74.98batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.41batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 76.03batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.87batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 75.81batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 75.98batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 76.29batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 76.05batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 76.02batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 76.41batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 76.44batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 76.27batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.87batch/s] 40%|██████████▊                | 406/1014 [00:05<00:07, 76.01batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 75.96batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 75.84batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 75.67batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.93batch/s] 45%|████████████▏              | 456/1014 [00:05<00:07, 76.24batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.95batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 76.08batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 76.30batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 76.16batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 76.58batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.64batch/s] 52%|██████████████             | 529/1014 [00:06<00:06, 76.56batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.76batch/s] 54%|██████████████▋            | 551/1014 [00:07<00:06, 76.88batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 76.83batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 76.89batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 76.78batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 76.78batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 76.70batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 76.64batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 76.79batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 76.89batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 76.95batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 76.87batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 76.89batch/s] 67%|██████████████████▏        | 683/1014 [00:08<00:04, 77.01batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 76.89batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 76.97batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 76.97batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 76.94batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 76.92batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 76.90batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 76.84batch/s] 76%|████████████████████▌      | 771/1014 [00:10<00:03, 76.89batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 76.94batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 76.77batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 76.78batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 76.60batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 76.52batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 76.44batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 76.46batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 76.43batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 76.38batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 76.33batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 76.33batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 76.20batch/s] 90%|████████████████████████▎  | 914/1014 [00:11<00:01, 76.35batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 76.37batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 76.35batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 76.25batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 76.31batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 76.29batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 76.28batch/s] 98%|██████████████████████████▍| 991/1014 [00:12<00:00, 76.30batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 76.31batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 76.28batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.29batch/s]
Validation 37 -> LOSS = 1.14
Validation 37 -> BLEU = 55.90, 76.7/61.2/50.2/41.4 (BP=1.000, ratio=1.003, hyp_len=14418, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 37
--> Best BLEU so far: 56.06 @ validation 36
Starting Epoch 38
Epoch 38 - update      17670 => loss:   0.713 (#OOM: 0)
Epoch 38 - update      17700 => loss:   0.584 (#OOM: 0)
Epoch 38 - update      17730 => loss:   0.682 (#OOM: 0)
Epoch 38 - update      17760 => loss:   0.741 (#OOM: 0)
Epoch 38 - update      17790 => loss:   0.499 (#OOM: 0)
Epoch 38 - update      17820 => loss:   0.789 (#OOM: 0)
Epoch 38 - update      17850 => loss:   0.696 (#OOM: 0)
Epoch 38 - update      17880 => loss:   0.731 (#OOM: 0)
Epoch 38 - update      17910 => loss:   0.827 (#OOM: 0)
Epoch 38 - update      17940 => loss:   0.864 (#OOM: 0)
Epoch 38 - update      17970 => loss:   0.817 (#OOM: 0)
Epoch 38 - update      18000 => loss:   0.609 (#OOM: 0)
Epoch 38 - update      18030 => loss:   0.965 (#OOM: 0)
Epoch 38 - update      18060 => loss:   1.063 (#OOM: 0)
Epoch 38 - update      18090 => loss:   0.538 (#OOM: 0)
Epoch 38 - update      18120 => loss:   0.786 (#OOM: 0)
--> Epoch 38 finished with mean loss 0.65362
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (778 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.55batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.13batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.87batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.56batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.87batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.67batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.27batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.26batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 73.85batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 73.38batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 69.79batch/s]  5%|█▍                          | 54/1014 [00:00<00:13, 70.51batch/s]  6%|█▋                          | 63/1014 [00:00<00:13, 69.67batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 70.53batch/s]  8%|██▏                         | 81/1014 [00:01<00:13, 71.76batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 72.37batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 72.80batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 73.35batch/s] 12%|███                        | 117/1014 [00:01<00:12, 72.86batch/s] 12%|███▎                       | 126/1014 [00:01<00:12, 73.17batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.08batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.84batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.26batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.34batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.94batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.61batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 73.99batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 74.29batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 73.62batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 72.58batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 72.77batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 73.26batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 73.86batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 73.94batch/s] 26%|███████                    | 264/1014 [00:03<00:10, 74.36batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 74.76batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.08batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.17batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.09batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 74.99batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 74.94batch/s] 33%|████████▉                  | 334/1014 [00:04<00:09, 74.79batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 75.10batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 75.10batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 74.40batch/s] 37%|█████████▉                 | 374/1014 [00:05<00:08, 74.51batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 74.21batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 74.29batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 74.49batch/s] 41%|███████████                | 414/1014 [00:05<00:08, 74.69batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 74.72batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 74.77batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 74.73batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 74.40batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 74.55batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 74.66batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 74.59batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 74.81batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 74.94batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.00batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 74.89batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 74.76batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 74.74batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 74.77batch/s] 56%|███████████████            | 564/1014 [00:07<00:06, 74.87batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 74.85batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 74.94batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 74.92batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 75.09batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 74.93batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 74.97batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.00batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 74.65batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 74.60batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 74.57batch/s] 66%|█████████████████▉         | 674/1014 [00:09<00:04, 74.56batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 74.54batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 74.40batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 74.46batch/s] 70%|███████████████████        | 714/1014 [00:09<00:04, 74.60batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 74.53batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 74.52batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 74.59batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 74.74batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 74.86batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 74.92batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 74.87batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.03batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.06batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.11batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.00batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 74.97batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.09batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 74.92batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:02, 74.96batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 74.99batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 74.95batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 74.86batch/s] 89%|████████████████████████   | 904/1014 [00:12<00:01, 74.94batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 74.88batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 74.89batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 74.86batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 74.87batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 74.92batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 74.91batch/s] 96%|█████████████████████████▉ | 974/1014 [00:13<00:00, 74.90batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 74.83batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 74.73batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 74.78batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.92batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 74.91batch/s]
Validation 38 -> LOSS = 1.14
Validation 38 -> BLEU = 55.38, 76.2/60.7/49.7/40.9 (BP=1.000, ratio=1.017, hyp_len=14623, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.06 @ validation 36
Starting Epoch 39
Epoch 39 - update      18150 => loss:   0.668 (#OOM: 0)
Epoch 39 - update      18180 => loss:   0.521 (#OOM: 0)
Epoch 39 - update      18210 => loss:   0.882 (#OOM: 0)
Epoch 39 - update      18240 => loss:   0.741 (#OOM: 0)
Epoch 39 - update      18270 => loss:   0.503 (#OOM: 0)
Epoch 39 - update      18300 => loss:   0.582 (#OOM: 0)
Epoch 39 - update      18330 => loss:   0.910 (#OOM: 0)
Epoch 39 - update      18360 => loss:   0.573 (#OOM: 0)
Epoch 39 - update      18390 => loss:   0.507 (#OOM: 0)
Epoch 39 - update      18420 => loss:   0.431 (#OOM: 0)
Epoch 39 - update      18450 => loss:   0.752 (#OOM: 0)
Epoch 39 - update      18480 => loss:   0.519 (#OOM: 0)
Epoch 39 - update      18510 => loss:   0.675 (#OOM: 0)
Epoch 39 - update      18540 => loss:   0.752 (#OOM: 0)
Epoch 39 - update      18570 => loss:   0.623 (#OOM: 0)
Epoch 39 - update      18600 => loss:   0.226 (#OOM: 0)
--> Epoch 39 finished with mean loss 0.65049
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (843 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.03batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.59batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.74batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 48.64batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.98batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.76batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 67.90batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 67.28batch/s]  2%|▋                           | 24/1014 [00:00<00:14, 69.29batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 72.87batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 74.83batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 74.56batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 74.93batch/s]  7%|█▉                          | 69/1014 [00:00<00:12, 75.90batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 76.54batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 75.79batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 75.22batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 76.53batch/s] 11%|███                        | 116/1014 [00:01<00:11, 76.35batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.78batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 76.44batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 76.65batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 77.17batch/s] 16%|████▍                      | 166/1014 [00:02<00:10, 77.51batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 77.12batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 76.67batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.25batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 76.19batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.20batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 76.19batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 76.16batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 76.06batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 76.35batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 76.50batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 76.53batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 76.28batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 76.38batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 76.33batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 75.79batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 75.57batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 76.08batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 76.19batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 76.52batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 76.36batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 76.44batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 76.83batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 76.87batch/s] 40%|██████████▊                | 406/1014 [00:05<00:07, 77.15batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 77.16batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 77.11batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 77.03batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 77.20batch/s] 45%|████████████▏              | 456/1014 [00:05<00:07, 77.44batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 77.42batch/s] 47%|████████████▋              | 476/1014 [00:06<00:06, 77.17batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 77.24batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 77.45batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 77.23batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 77.19batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 77.31batch/s] 53%|██████████████▎            | 536/1014 [00:06<00:06, 77.47batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 77.36batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:05, 77.25batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 77.08batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 77.14batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 77.20batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 77.21batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 77.18batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:05, 77.21batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 77.29batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:04, 77.12batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 77.00batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 76.99batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 77.10batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 77.19batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:04, 77.23batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:04, 77.37batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:03, 77.40batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 77.23batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 77.09batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 77.14batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 76.97batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 76.88batch/s] 76%|████████████████████▍      | 766/1014 [00:09<00:03, 76.90batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 76.76batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:02, 76.77batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 76.56batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 76.51batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 76.46batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 76.54batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 76.58batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 76.59batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 76.64batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 76.61batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 76.72batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 76.59batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 76.49batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 76.32batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 76.29batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 76.20batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 76.21batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 76.27batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 76.29batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 76.27batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 76.20batch/s] 97%|██████████████████████████▎| 986/1014 [00:12<00:00, 76.28batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 76.23batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 76.15batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.23batch/s]
Validation 39 -> LOSS = 1.15
Validation 39 -> BLEU = 56.16, 77.2/61.5/50.4/41.8 (BP=0.999, ratio=0.999, hyp_len=14363, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.16 @ validation 39
Starting Epoch 40
Epoch 40 - update      18630 => loss:   0.454 (#OOM: 0)
Epoch 40 - update      18660 => loss:   0.511 (#OOM: 0)
Epoch 40 - update      18690 => loss:   0.449 (#OOM: 0)
Epoch 40 - update      18720 => loss:   0.541 (#OOM: 0)
Epoch 40 - update      18750 => loss:   0.290 (#OOM: 0)
Epoch 40 - update      18780 => loss:   0.615 (#OOM: 0)
Epoch 40 - update      18810 => loss:   0.377 (#OOM: 0)
Epoch 40 - update      18840 => loss:   0.453 (#OOM: 0)
Epoch 40 - update      18870 => loss:   0.892 (#OOM: 0)
Epoch 40 - update      18900 => loss:   0.658 (#OOM: 0)
Epoch 40 - update      18930 => loss:   0.834 (#OOM: 0)
Epoch 40 - update      18960 => loss:   0.625 (#OOM: 0)
Epoch 40 - update      18990 => loss:   0.533 (#OOM: 0)
Epoch 40 - update      19020 => loss:   0.589 (#OOM: 0)
Epoch 40 - update      19050 => loss:   1.015 (#OOM: 0)
Epoch 40 - update      19080 => loss:   0.481 (#OOM: 0)
--> Epoch 40 finished with mean loss 0.64332
--> Overhead/Training/Evaluation: 0.02/0.46/0.00 mins (total: 0.48 mins)   (1058 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.66batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.27batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 55.02batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.44batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.35batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.06batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.60batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 74.16batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.24batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 74.90batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 77.47batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 79.37batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 79.17batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 78.58batch/s]  8%|██▏                         | 79/1014 [00:01<00:11, 78.74batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 79.04batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 78.78batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 78.96batch/s] 11%|███                        | 115/1014 [00:01<00:11, 78.90batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 78.61batch/s] 13%|███▌                       | 135/1014 [00:01<00:10, 80.02batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 78.65batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 77.69batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 77.90batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 77.27batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 76.61batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 76.67batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 76.41batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 76.46batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 76.84batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 76.40batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 76.77batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 76.82batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 77.27batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 76.70batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 76.77batch/s] 31%|████████▎                  | 311/1014 [00:04<00:09, 76.56batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 76.35batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 76.26batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 76.28batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 76.29batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 76.43batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 76.30batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 76.55batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 76.42batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 76.55batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 76.55batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 76.54batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 76.53batch/s] 45%|████████████               | 454/1014 [00:05<00:07, 76.79batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 76.83batch/s] 47%|████████████▋              | 476/1014 [00:06<00:06, 76.99batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 76.76batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.88batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 76.91batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 76.67batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 76.72batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 76.61batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 76.66batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 76.85batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 76.92batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 77.01batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 76.90batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.95batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 76.91batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:04, 76.86batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 76.69batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 76.58batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 76.77batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 76.69batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 76.65batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 76.72batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 76.66batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 76.66batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 76.52batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 76.60batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 76.58batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 76.35batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 76.30batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 76.11batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 76.00batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.81batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.91batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 76.01batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 75.96batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 75.96batch/s] 85%|██████████████████████▉    | 861/1014 [00:11<00:02, 76.04batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 76.15batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 76.06batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.92batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.90batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.81batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.86batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.87batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 75.93batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.93batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 75.99batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 76.05batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 76.05batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 76.04batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.07batch/s]
Validation 40 -> LOSS = 1.15
Validation 40 -> BLEU = 56.07, 77.0/61.4/50.3/41.5 (BP=1.000, ratio=1.000, hyp_len=14385, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.16 @ validation 39
Starting Epoch 41
Epoch 41 - update      19110 => loss:   0.640 (#OOM: 0)
Epoch 41 - update      19140 => loss:   0.536 (#OOM: 0)
Epoch 41 - update      19170 => loss:   0.871 (#OOM: 0)
Epoch 41 - update      19200 => loss:   0.523 (#OOM: 0)
Epoch 41 - update      19230 => loss:   0.518 (#OOM: 0)
Epoch 41 - update      19260 => loss:   0.528 (#OOM: 0)
Epoch 41 - update      19290 => loss:   0.552 (#OOM: 0)
Epoch 41 - update      19320 => loss:   0.473 (#OOM: 0)
Epoch 41 - update      19350 => loss:   0.844 (#OOM: 0)
Epoch 41 - update      19380 => loss:   0.554 (#OOM: 0)
Epoch 41 - update      19410 => loss:   0.741 (#OOM: 0)
Epoch 41 - update      19440 => loss:   0.663 (#OOM: 0)
Epoch 41 - update      19470 => loss:   0.599 (#OOM: 0)
Epoch 41 - update      19500 => loss:   0.735 (#OOM: 0)
Epoch 41 - update      19530 => loss:   0.716 (#OOM: 0)
--> Epoch 41 finished with mean loss 0.63955
--> Overhead/Training/Evaluation: 0.02/0.44/0.00 mins (total: 0.47 mins)   (1086 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.10batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.56batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.83batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.22batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.49batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.20batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.02batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 78.34batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.69batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 75.71batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.08batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.36batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.95batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 78.52batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 78.17batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 77.30batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.84batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 76.49batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.97batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.95batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 78.22batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 78.08batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 78.14batch/s] 16%|████▍                      | 166/1014 [00:02<00:10, 77.84batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 77.17batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 77.09batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 77.09batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 77.03batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.77batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 76.21batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 76.47batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 76.20batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 76.07batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.90batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 76.22batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 76.18batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.66batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.91batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 76.02batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 75.95batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 75.79batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 75.68batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.72batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 75.87batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.96batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 76.19batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 76.41batch/s] 40%|██████████▊                | 406/1014 [00:05<00:07, 76.57batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 76.36batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 76.27batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 76.28batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 76.31batch/s] 45%|████████████▏              | 456/1014 [00:05<00:07, 76.19batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 76.30batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 76.48batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 76.42batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 76.27batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 76.29batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 76.33batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 76.42batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 76.22batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 76.30batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:05, 76.40batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 76.47batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 76.42batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 76.38batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 76.24batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 76.23batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 76.06batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 76.09batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:04, 75.88batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.94batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.77batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.79batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 75.61batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.55batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.59batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.53batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.72batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.76batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.75batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.70batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 75.67batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.71batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 75.62batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 75.64batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 75.71batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.70batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 75.67batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.72batch/s] 82%|██████████████████████▎    | 836/1014 [00:11<00:02, 75.64batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 75.60batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 75.72batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.76batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 75.75batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.86batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 75.88batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 75.94batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.95batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 76.03batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 76.03batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 76.07batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 76.02batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 76.06batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 75.94batch/s] 97%|██████████████████████████▎| 986/1014 [00:12<00:00, 76.02batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 75.87batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 75.89batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.01batch/s]
Validation 41 -> LOSS = 1.14
Validation 41 -> BLEU = 55.77, 76.8/61.1/50.0/41.3 (BP=1.000, ratio=1.004, hyp_len=14446, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.16 @ validation 39
Starting Epoch 42
Epoch 42 - update      19560 => loss:   0.449 (#OOM: 0)
Epoch 42 - update      19590 => loss:   0.773 (#OOM: 0)
Epoch 42 - update      19620 => loss:   0.528 (#OOM: 0)
Epoch 42 - update      19650 => loss:   0.465 (#OOM: 0)
Epoch 42 - update      19680 => loss:   0.522 (#OOM: 0)
Epoch 42 - update      19710 => loss:   0.477 (#OOM: 0)
Epoch 42 - update      19740 => loss:   0.489 (#OOM: 0)
Epoch 42 - update      19770 => loss:   0.622 (#OOM: 0)
Epoch 42 - update      19800 => loss:   0.568 (#OOM: 0)
Epoch 42 - update      19830 => loss:   0.674 (#OOM: 0)
Epoch 42 - update      19860 => loss:   0.761 (#OOM: 0)
Epoch 42 - update      19890 => loss:   0.495 (#OOM: 0)
Epoch 42 - update      19920 => loss:   0.506 (#OOM: 0)
Epoch 42 - update      19950 => loss:   0.624 (#OOM: 0)
Epoch 42 - update      19980 => loss:   0.567 (#OOM: 0)
Epoch 42 - update      20010 => loss:   0.302 (#OOM: 0)
--> Epoch 42 finished with mean loss 0.63618
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (808 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.29batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.92batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.25batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.49batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.19batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.41batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.38batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.19batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 78.13batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 78.64batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.77batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 75.44batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 75.83batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 75.55batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 75.84batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 75.91batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 75.27batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.51batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 74.98batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.14batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.88batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 75.05batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 74.84batch/s] 15%|████                       | 153/1014 [00:02<00:11, 74.44batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.05batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 74.63batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.59batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.58batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.06batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 74.60batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.65batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.85batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 74.83batch/s] 24%|██████▍                    | 243/1014 [00:03<00:10, 74.49batch/s] 25%|██████▋                    | 253/1014 [00:03<00:10, 74.93batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 75.19batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 75.18batch/s] 28%|███████▌                   | 283/1014 [00:03<00:09, 75.16batch/s] 29%|███████▊                   | 293/1014 [00:03<00:09, 75.03batch/s] 30%|████████                   | 303/1014 [00:04<00:09, 74.39batch/s] 31%|████████▎                  | 313/1014 [00:04<00:09, 74.72batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 74.58batch/s] 33%|████████▊                  | 333/1014 [00:04<00:09, 74.32batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 74.68batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 74.72batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 74.74batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:08, 74.76batch/s] 38%|██████████▏                | 383/1014 [00:05<00:08, 74.70batch/s] 39%|██████████▍                | 393/1014 [00:05<00:08, 74.98batch/s] 40%|██████████▋                | 403/1014 [00:05<00:08, 75.18batch/s] 41%|██████████▉                | 413/1014 [00:05<00:08, 74.96batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 75.15batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 75.40batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 75.78batch/s] 45%|████████████               | 453/1014 [00:05<00:07, 75.77batch/s] 46%|████████████▎              | 463/1014 [00:06<00:07, 75.58batch/s] 47%|████████████▌              | 473/1014 [00:06<00:07, 75.57batch/s] 48%|████████████▊              | 483/1014 [00:06<00:07, 75.45batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 75.51batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 75.59batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 74.90batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 74.91batch/s] 53%|██████████████▏            | 533/1014 [00:07<00:06, 74.92batch/s] 54%|██████████████▍            | 543/1014 [00:07<00:06, 75.20batch/s] 55%|██████████████▋            | 553/1014 [00:07<00:06, 75.14batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:06, 75.04batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 75.34batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 75.16batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 75.38batch/s] 59%|████████████████           | 603/1014 [00:08<00:05, 75.35batch/s] 60%|████████████████▎          | 613/1014 [00:08<00:05, 75.50batch/s] 61%|████████████████▌          | 623/1014 [00:08<00:05, 75.45batch/s] 62%|████████████████▊          | 633/1014 [00:08<00:05, 75.22batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 75.02batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 74.77batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 74.88batch/s] 66%|█████████████████▉         | 673/1014 [00:09<00:04, 74.76batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 74.95batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.04batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.08batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 75.28batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.30batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 75.40batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 75.36batch/s] 74%|████████████████████       | 753/1014 [00:10<00:03, 75.19batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.22batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.17batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.19batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.27batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 75.40batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 75.29batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 75.45batch/s] 82%|██████████████████████▏    | 833/1014 [00:11<00:02, 75.43batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 75.46batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.50batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:02, 75.50batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.50batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.44batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.49batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.59batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 75.58batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.65batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 75.64batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 75.62batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 75.65batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.76batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.58batch/s] 97%|██████████████████████████▏| 983/1014 [00:13<00:00, 75.49batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 75.54batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 75.46batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 75.50batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.51batch/s]
Validation 42 -> LOSS = 1.14
Validation 42 -> BLEU = 56.04, 76.9/61.3/50.3/41.6 (BP=1.000, ratio=1.007, hyp_len=14485, ref_len=14382)
** Learning rate changed -> 5e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.16 @ validation 39
Starting Epoch 43
Epoch 43 - update      20040 => loss:   0.764 (#OOM: 0)
Epoch 43 - update      20070 => loss:   0.553 (#OOM: 0)
Epoch 43 - update      20100 => loss:   0.495 (#OOM: 0)
Epoch 43 - update      20130 => loss:   0.768 (#OOM: 0)
Epoch 43 - update      20160 => loss:   0.630 (#OOM: 0)
Epoch 43 - update      20190 => loss:   0.494 (#OOM: 0)
Epoch 43 - update      20220 => loss:   0.728 (#OOM: 0)
Epoch 43 - update      20250 => loss:   0.610 (#OOM: 0)
Epoch 43 - update      20280 => loss:   0.346 (#OOM: 0)
Epoch 43 - update      20310 => loss:   0.512 (#OOM: 0)
Epoch 43 - update      20340 => loss:   0.492 (#OOM: 0)
Epoch 43 - update      20370 => loss:   0.634 (#OOM: 0)
Epoch 43 - update      20400 => loss:   0.618 (#OOM: 0)
Epoch 43 - update      20430 => loss:   0.681 (#OOM: 0)
Epoch 43 - update      20460 => loss:   0.448 (#OOM: 0)
Epoch 43 - update      20490 => loss:   0.594 (#OOM: 0)
--> Epoch 43 finished with mean loss 0.62370
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.60 mins)   (852 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.27batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.90batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.36batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.14batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 49.18batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.11batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.08batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:13, 76.90batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 78.54batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 82.46batch/s]  4%|█                           | 38/1014 [00:00<00:12, 76.12batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 73.33batch/s]  6%|█▌                          | 58/1014 [00:00<00:13, 73.23batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 73.85batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 72.24batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 73.17batch/s] 10%|██▋                         | 98/1014 [00:01<00:12, 73.67batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 72.75batch/s] 12%|███▏                       | 118/1014 [00:01<00:12, 73.98batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 74.35batch/s] 14%|███▋                       | 138/1014 [00:01<00:11, 74.76batch/s] 15%|███▉                       | 148/1014 [00:01<00:11, 74.82batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 75.22batch/s] 17%|████▍                      | 168/1014 [00:02<00:11, 75.25batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 74.68batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 75.21batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.28batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 75.61batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 75.93batch/s] 22%|██████                     | 228/1014 [00:02<00:10, 76.01batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 75.77batch/s] 24%|██████▌                    | 248/1014 [00:03<00:10, 75.66batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 75.68batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 75.46batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.47batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 75.55batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 75.79batch/s] 30%|████████▏                  | 308/1014 [00:04<00:09, 75.73batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 75.83batch/s] 32%|████████▋                  | 328/1014 [00:04<00:09, 76.22batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 75.40batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 75.40batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 75.43batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.24batch/s] 37%|██████████                 | 378/1014 [00:05<00:08, 75.33batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 75.05batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 75.23batch/s] 40%|██████████▊                | 408/1014 [00:05<00:08, 75.41batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 75.55batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 75.22batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 75.49batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 75.61batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 75.71batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 75.90batch/s] 47%|████████████▋              | 478/1014 [00:06<00:07, 76.05batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 76.05batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 75.57batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 75.69batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 75.80batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 75.86batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 75.95batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 75.98batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:06, 75.77batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 75.77batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 75.96batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 75.89batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 75.83batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 76.02batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 75.94batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 75.97batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 75.98batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.79batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 75.59batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 75.66batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 75.69batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 75.93batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 75.94batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 75.94batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 76.00batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 75.83batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.70batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 75.75batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 75.93batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 75.74batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.62batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 75.64batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 75.52batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 75.45batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 75.39batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 75.37batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 75.45batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 75.48batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 75.53batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 75.43batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 75.45batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 75.46batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 75.38batch/s] 90%|████████████████████████▏  | 908/1014 [00:12<00:01, 75.38batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 75.37batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.28batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.22batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.23batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.15batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.05batch/s] 96%|██████████████████████████ | 978/1014 [00:13<00:00, 75.16batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.16batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.23batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.27batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.21batch/s]
Validation 43 -> LOSS = 1.14
Validation 43 -> BLEU = 55.74, 76.6/61.0/50.0/41.3 (BP=1.000, ratio=1.011, hyp_len=14541, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.16 @ validation 39
Starting Epoch 44
Epoch 44 - update      20520 => loss:   0.313 (#OOM: 0)
Epoch 44 - update      20550 => loss:   0.598 (#OOM: 0)
Epoch 44 - update      20580 => loss:   0.910 (#OOM: 0)
Epoch 44 - update      20610 => loss:   0.448 (#OOM: 0)
Epoch 44 - update      20640 => loss:   0.725 (#OOM: 0)
Epoch 44 - update      20670 => loss:   0.539 (#OOM: 0)
Epoch 44 - update      20700 => loss:   0.708 (#OOM: 0)
Epoch 44 - update      20730 => loss:   0.477 (#OOM: 0)
Epoch 44 - update      20760 => loss:   0.668 (#OOM: 0)
Epoch 44 - update      20790 => loss:   0.450 (#OOM: 0)
Epoch 44 - update      20820 => loss:   0.664 (#OOM: 0)
Epoch 44 - update      20850 => loss:   0.590 (#OOM: 0)
Epoch 44 - update      20880 => loss:   0.485 (#OOM: 0)
Epoch 44 - update      20910 => loss:   0.648 (#OOM: 0)
Epoch 44 - update      20940 => loss:   0.515 (#OOM: 0)
Epoch 44 - update      20970 => loss:   0.655 (#OOM: 0)
--> Epoch 44 finished with mean loss 0.62159
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (801 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.47batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 49.43batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 52.74batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 52.68batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 53.69batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 52.87batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.16batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.03batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.56batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.17batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 69.29batch/s]  4%|█                           | 40/1014 [00:00<00:13, 70.27batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 69.74batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 70.59batch/s]  6%|█▊                          | 64/1014 [00:00<00:13, 70.69batch/s]  7%|██                          | 73/1014 [00:01<00:13, 72.02batch/s]  8%|██▎                         | 82/1014 [00:01<00:12, 73.15batch/s]  9%|██▌                         | 91/1014 [00:01<00:12, 74.09batch/s] 10%|██▋                        | 100/1014 [00:01<00:12, 74.86batch/s] 11%|██▉                        | 109/1014 [00:01<00:12, 73.51batch/s] 12%|███▏                       | 118/1014 [00:01<00:12, 71.84batch/s] 13%|███▍                       | 127/1014 [00:01<00:12, 72.83batch/s] 13%|███▌                       | 136/1014 [00:01<00:12, 72.90batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 74.09batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 74.21batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 74.51batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 74.81batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 74.56batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 74.37batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.53batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.75batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 74.97batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 75.10batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 75.06batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 75.24batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.48batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 76.05batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 76.32batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 76.21batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.94batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 76.29batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 76.09batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 75.90batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 75.83batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.37batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 75.56batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.50batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.68batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.87batch/s] 40%|██████████▊                | 406/1014 [00:05<00:07, 76.11batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 75.93batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 76.04batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 76.25batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 76.27batch/s] 45%|████████████▏              | 456/1014 [00:05<00:07, 76.21batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 76.35batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 76.15batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 76.17batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 75.87batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 75.82batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.51batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 75.52batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.79batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.61batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.58batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.58batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.69batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.81batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.82batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 75.83batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 75.87batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.80batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:04, 75.81batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.76batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.74batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.87batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 75.93batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.81batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.82batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.94batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 76.02batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 76.04batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 76.01batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 76.13batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 76.00batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.99batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 76.09batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:02, 76.04batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 76.04batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 75.96batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 75.87batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 75.99batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 76.03batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 76.05batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 76.03batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 75.97batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 75.95batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 75.91batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 76.00batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 75.95batch/s] 90%|████████████████████████▍  | 916/1014 [00:12<00:01, 75.85batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 75.80batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 75.94batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 76.02batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 76.08batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 76.11batch/s] 96%|█████████████████████████▉ | 976/1014 [00:12<00:00, 76.10batch/s] 97%|██████████████████████████▎| 986/1014 [00:12<00:00, 76.18batch/s] 98%|██████████████████████████▌| 996/1014 [00:13<00:00, 76.03batch/s] 99%|█████████████████████████▊| 1006/1014 [00:13<00:00, 76.08batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.05batch/s]
Validation 44 -> LOSS = 1.14
Validation 44 -> BLEU = 55.88, 76.7/61.2/50.2/41.4 (BP=1.000, ratio=1.009, hyp_len=14507, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.16 @ validation 39
Starting Epoch 45
Epoch 45 - update      21000 => loss:   0.482 (#OOM: 0)
Epoch 45 - update      21030 => loss:   0.407 (#OOM: 0)
Epoch 45 - update      21060 => loss:   0.447 (#OOM: 0)
Epoch 45 - update      21090 => loss:   0.772 (#OOM: 0)
Epoch 45 - update      21120 => loss:   0.460 (#OOM: 0)
Epoch 45 - update      21150 => loss:   0.390 (#OOM: 0)
Epoch 45 - update      21180 => loss:   0.562 (#OOM: 0)
Epoch 45 - update      21210 => loss:   0.554 (#OOM: 0)
Epoch 45 - update      21240 => loss:   0.611 (#OOM: 0)
Epoch 45 - update      21270 => loss:   0.427 (#OOM: 0)
Epoch 45 - update      21300 => loss:   0.533 (#OOM: 0)
Epoch 45 - update      21330 => loss:   0.760 (#OOM: 0)
Epoch 45 - update      21360 => loss:   0.855 (#OOM: 0)
Epoch 45 - update      21390 => loss:   0.653 (#OOM: 0)
Epoch 45 - update      21420 => loss:   0.616 (#OOM: 0)
Epoch 45 - update      21450 => loss:   0.688 (#OOM: 0)
--> Epoch 45 finished with mean loss 0.61521
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (770 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.57batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.97batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.84batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 51.05batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 50.18batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 49.94batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 49.77batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.93batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 73.53batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.08batch/s]  3%|▉                           | 33/1014 [00:00<00:13, 74.55batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.14batch/s]  5%|█▍                          | 51/1014 [00:00<00:12, 75.57batch/s]  6%|█▋                          | 60/1014 [00:00<00:12, 75.37batch/s]  7%|█▉                          | 69/1014 [00:00<00:13, 71.48batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 72.65batch/s]  9%|██▍                         | 87/1014 [00:01<00:12, 72.24batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 73.41batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 74.84batch/s] 11%|███                        | 116/1014 [00:01<00:11, 75.20batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.71batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 75.11batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 75.47batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 75.49batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 75.47batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 75.31batch/s] 18%|████▉                      | 186/1014 [00:02<00:11, 75.20batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 74.97batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 74.49batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.69batch/s] 22%|██████                     | 226/1014 [00:03<00:10, 74.71batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 75.04batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 74.67batch/s] 25%|██████▊                    | 256/1014 [00:03<00:10, 74.67batch/s] 26%|███████                    | 266/1014 [00:03<00:10, 74.78batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.14batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.46batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.42batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.48batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 75.35batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 75.62batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 75.75batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 75.47batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.26batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 75.29batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 75.67batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.70batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.98batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 75.85batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 75.79batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 75.88batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 75.84batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 76.01batch/s] 45%|████████████▏              | 456/1014 [00:05<00:07, 76.24batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 76.17batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 76.03batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 75.90batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 75.98batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 76.23batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 76.28batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 76.56batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 76.52batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 76.42batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:05, 76.54batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 76.31batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 76.37batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 76.49batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 76.53batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 76.13batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 76.26batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 76.26batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:04, 76.35batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 76.45batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 76.41batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 76.37batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 76.53batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:04, 76.53batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 76.46batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 76.49batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 76.42batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 76.45batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 76.39batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 76.45batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 76.45batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 76.57batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 76.46batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:02, 76.45batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 76.46batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 76.46batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 76.59batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 76.58batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 76.58batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 76.46batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 76.37batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 76.47batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 76.45batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 76.42batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 76.45batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 76.44batch/s] 90%|████████████████████████▍  | 916/1014 [00:11<00:01, 76.39batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 76.30batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 76.33batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 76.55batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 76.47batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 76.41batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 76.42batch/s] 98%|██████████████████████████▍| 991/1014 [00:12<00:00, 76.42batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 76.38batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 76.32batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.33batch/s]
Validation 45 -> LOSS = 1.14
Validation 45 -> BLEU = 55.85, 76.7/61.1/50.1/41.5 (BP=1.000, ratio=1.002, hyp_len=14412, ref_len=14382)
** Learning rate changed -> 2.5e-05
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.16 @ validation 39
Starting Epoch 46
Epoch 46 - update      21480 => loss:   0.399 (#OOM: 0)
Epoch 46 - update      21510 => loss:   0.705 (#OOM: 0)
Epoch 46 - update      21540 => loss:   0.488 (#OOM: 0)
Epoch 46 - update      21570 => loss:   0.858 (#OOM: 0)
Epoch 46 - update      21600 => loss:   0.466 (#OOM: 0)
Epoch 46 - update      21630 => loss:   0.551 (#OOM: 0)
Epoch 46 - update      21660 => loss:   0.483 (#OOM: 0)
Epoch 46 - update      21690 => loss:   0.664 (#OOM: 0)
Epoch 46 - update      21720 => loss:   0.830 (#OOM: 0)
Epoch 46 - update      21750 => loss:   0.601 (#OOM: 0)
Epoch 46 - update      21780 => loss:   0.506 (#OOM: 0)
Epoch 46 - update      21810 => loss:   0.721 (#OOM: 0)
Epoch 46 - update      21840 => loss:   0.522 (#OOM: 0)
Epoch 46 - update      21870 => loss:   0.677 (#OOM: 0)
Epoch 46 - update      21900 => loss:   0.547 (#OOM: 0)
Epoch 46 - update      21930 => loss:   0.560 (#OOM: 0)
--> Epoch 46 finished with mean loss 0.61167
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (781 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 39.69batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.36batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 47.15batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 47.67batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.53batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.06batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.03batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.60batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 83.06batch/s]  3%|▋                           | 26/1014 [00:00<00:11, 85.23batch/s]  3%|▉                           | 35/1014 [00:00<00:11, 82.64batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 80.39batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 79.20batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 77.94batch/s]  7%|█▉                          | 71/1014 [00:00<00:11, 78.80batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 77.88batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 78.14batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 78.19batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 77.77batch/s] 11%|███                        | 116/1014 [00:01<00:11, 76.58batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 76.73batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 76.04batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 75.81batch/s] 15%|████                       | 152/1014 [00:01<00:11, 76.19batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 76.47batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.60batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 76.36batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 76.52batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 76.17batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 76.36batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.77batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 77.08batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 77.28batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 77.10batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 77.26batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 77.34batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 77.45batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 77.71batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 77.54batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 77.78batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 77.86batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 77.73batch/s] 32%|████████▌                  | 323/1014 [00:04<00:08, 77.44batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 77.44batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 77.33batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 77.59batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 77.34batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 77.49batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 77.52batch/s] 38%|██████████▎                | 386/1014 [00:04<00:08, 77.21batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 77.17batch/s] 40%|██████████▊                | 404/1014 [00:05<00:07, 77.06batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 77.06batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 77.12batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 77.20batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 77.36batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 77.36batch/s] 45%|████████████▏              | 458/1014 [00:05<00:07, 77.49batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 77.50batch/s] 47%|████████████▋              | 476/1014 [00:06<00:06, 77.41batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 77.30batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 77.35batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 77.29batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 76.96batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 76.90batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 76.80batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 76.97batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 77.00batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:05, 76.97batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 77.08batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 77.12batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 77.22batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 76.96batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 77.00batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:05, 76.78batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 76.11batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 76.15batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 76.04batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.99batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.99batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.57batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.58batch/s] 67%|██████████████████▏        | 683/1014 [00:09<00:04, 75.74batch/s] 68%|██████████████████▍        | 693/1014 [00:09<00:04, 75.92batch/s] 69%|██████████████████▋        | 703/1014 [00:09<00:04, 75.98batch/s] 70%|██████████████████▉        | 713/1014 [00:09<00:03, 76.03batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 75.95batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 76.01batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 76.02batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 75.74batch/s] 75%|████████████████████▎      | 763/1014 [00:10<00:03, 75.83batch/s] 76%|████████████████████▌      | 773/1014 [00:10<00:03, 75.84batch/s] 77%|████████████████████▊      | 783/1014 [00:10<00:03, 75.89batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 75.98batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 76.01batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 76.10batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 76.04batch/s] 82%|██████████████████████▏    | 833/1014 [00:10<00:02, 76.04batch/s] 83%|██████████████████████▍    | 843/1014 [00:11<00:02, 76.00batch/s] 84%|██████████████████████▋    | 853/1014 [00:11<00:02, 75.90batch/s] 85%|██████████████████████▉    | 863/1014 [00:11<00:01, 75.92batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 75.90batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 75.86batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 75.82batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 75.88batch/s] 90%|████████████████████████▎  | 913/1014 [00:12<00:01, 76.05batch/s] 91%|████████████████████████▌  | 923/1014 [00:12<00:01, 75.99batch/s] 92%|████████████████████████▊  | 933/1014 [00:12<00:01, 76.01batch/s] 93%|█████████████████████████  | 943/1014 [00:12<00:00, 76.05batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 76.03batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 75.96batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 75.92batch/s] 97%|██████████████████████████▏| 983/1014 [00:12<00:00, 75.95batch/s] 98%|██████████████████████████▍| 993/1014 [00:13<00:00, 76.00batch/s] 99%|█████████████████████████▋| 1003/1014 [00:13<00:00, 76.03batch/s]100%|█████████████████████████▉| 1013/1014 [00:13<00:00, 76.04batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.05batch/s]
Validation 46 -> LOSS = 1.14
Validation 46 -> BLEU = 56.27, 77.1/61.5/50.5/41.8 (BP=1.000, ratio=1.001, hyp_len=14400, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.27 @ validation 46
Starting Epoch 47
Epoch 47 - update      21960 => loss:   0.418 (#OOM: 0)
Epoch 47 - update      21990 => loss:   0.795 (#OOM: 0)
Epoch 47 - update      22020 => loss:   0.649 (#OOM: 0)
Epoch 47 - update      22050 => loss:   0.684 (#OOM: 0)
Epoch 47 - update      22080 => loss:   0.881 (#OOM: 0)
Epoch 47 - update      22110 => loss:   0.606 (#OOM: 0)
Epoch 47 - update      22140 => loss:   0.759 (#OOM: 0)
Epoch 47 - update      22170 => loss:   0.485 (#OOM: 0)
Epoch 47 - update      22200 => loss:   0.664 (#OOM: 0)
Epoch 47 - update      22230 => loss:   0.451 (#OOM: 0)
Epoch 47 - update      22260 => loss:   0.462 (#OOM: 0)
Epoch 47 - update      22290 => loss:   0.491 (#OOM: 0)
Epoch 47 - update      22320 => loss:   0.664 (#OOM: 0)
Epoch 47 - update      22350 => loss:   0.571 (#OOM: 0)
Epoch 47 - update      22380 => loss:   0.902 (#OOM: 0)
Epoch 47 - update      22410 => loss:   0.437 (#OOM: 0)
--> Epoch 47 finished with mean loss 0.60841
--> Overhead/Training/Evaluation: 0.02/0.47/0.00 mins (total: 0.49 mins)   (1029 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.93batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.27batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.69batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.20batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.82batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.25batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.46batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.86batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.01batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.87batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.60batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.96batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.40batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 78.04batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.13batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 76.02batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 76.71batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 76.22batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.70batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 77.08batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.19batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 75.48batch/s] 15%|████                       | 153/1014 [00:02<00:11, 75.56batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.77batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 76.05batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 76.15batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 76.32batch/s] 20%|█████▎                     | 199/1014 [00:02<00:10, 76.90batch/s] 21%|█████▌                     | 209/1014 [00:02<00:10, 76.82batch/s] 22%|█████▊                     | 219/1014 [00:02<00:10, 77.37batch/s] 23%|██████                     | 229/1014 [00:02<00:10, 77.33batch/s] 24%|██████▎                    | 239/1014 [00:03<00:10, 77.09batch/s] 25%|██████▋                    | 249/1014 [00:03<00:09, 77.21batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 77.01batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 77.09batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 77.10batch/s] 29%|███████▋                   | 289/1014 [00:03<00:09, 77.01batch/s] 29%|███████▉                   | 299/1014 [00:03<00:09, 76.73batch/s] 30%|████████▏                  | 309/1014 [00:04<00:09, 76.49batch/s] 31%|████████▍                  | 319/1014 [00:04<00:09, 75.96batch/s] 32%|████████▊                  | 329/1014 [00:04<00:08, 76.22batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 76.15batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 76.41batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 76.24batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 76.36batch/s] 37%|██████████                 | 379/1014 [00:04<00:08, 76.34batch/s] 38%|██████████▎                | 389/1014 [00:05<00:08, 76.57batch/s] 39%|██████████▌                | 399/1014 [00:05<00:08, 76.65batch/s] 40%|██████████▉                | 409/1014 [00:05<00:07, 76.80batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 76.58batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 76.56batch/s] 43%|███████████▋               | 439/1014 [00:05<00:07, 76.69batch/s] 44%|███████████▉               | 449/1014 [00:05<00:07, 76.63batch/s] 45%|████████████▏              | 459/1014 [00:05<00:07, 76.68batch/s] 46%|████████████▍              | 469/1014 [00:06<00:07, 76.36batch/s] 47%|████████████▊              | 479/1014 [00:06<00:06, 76.53batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 76.60batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 76.63batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 76.59batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 76.53batch/s] 52%|██████████████             | 529/1014 [00:06<00:06, 76.70batch/s] 53%|██████████████▎            | 539/1014 [00:07<00:06, 76.56batch/s] 54%|██████████████▌            | 549/1014 [00:07<00:06, 76.35batch/s] 55%|██████████████▉            | 559/1014 [00:07<00:05, 76.32batch/s] 56%|███████████████▏           | 569/1014 [00:07<00:05, 76.34batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 76.37batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 76.29batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 76.18batch/s] 60%|████████████████▏          | 609/1014 [00:08<00:05, 76.10batch/s] 61%|████████████████▍          | 619/1014 [00:08<00:05, 76.15batch/s] 62%|████████████████▋          | 629/1014 [00:08<00:05, 76.15batch/s] 63%|█████████████████          | 639/1014 [00:08<00:04, 76.17batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 76.30batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 76.36batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 76.31batch/s] 67%|██████████████████         | 679/1014 [00:08<00:04, 76.28batch/s] 68%|██████████████████▎        | 689/1014 [00:09<00:04, 76.31batch/s] 69%|██████████████████▌        | 699/1014 [00:09<00:04, 76.25batch/s] 70%|██████████████████▉        | 709/1014 [00:09<00:04, 76.12batch/s] 71%|███████████████████▏       | 719/1014 [00:09<00:03, 76.27batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 75.77batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 75.78batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 75.73batch/s] 75%|████████████████████▏      | 759/1014 [00:10<00:03, 75.59batch/s] 76%|████████████████████▍      | 769/1014 [00:10<00:03, 75.49batch/s] 77%|████████████████████▋      | 779/1014 [00:10<00:03, 75.47batch/s] 78%|█████████████████████      | 789/1014 [00:10<00:02, 75.44batch/s] 79%|█████████████████████▎     | 799/1014 [00:10<00:02, 75.45batch/s] 80%|█████████████████████▌     | 809/1014 [00:10<00:02, 75.42batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 75.44batch/s] 82%|██████████████████████     | 829/1014 [00:11<00:02, 75.31batch/s] 83%|██████████████████████▎    | 839/1014 [00:11<00:02, 75.44batch/s] 84%|██████████████████████▌    | 849/1014 [00:11<00:02, 75.40batch/s] 85%|██████████████████████▊    | 859/1014 [00:11<00:02, 75.43batch/s] 86%|███████████████████████▏   | 869/1014 [00:11<00:01, 75.46batch/s] 87%|███████████████████████▍   | 879/1014 [00:11<00:01, 75.55batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 75.57batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 75.68batch/s] 90%|████████████████████████▏  | 909/1014 [00:12<00:01, 75.62batch/s] 91%|████████████████████████▍  | 919/1014 [00:12<00:01, 75.56batch/s] 92%|████████████████████████▋  | 929/1014 [00:12<00:01, 75.52batch/s] 93%|█████████████████████████  | 939/1014 [00:12<00:00, 75.47batch/s] 94%|█████████████████████████▎ | 949/1014 [00:12<00:00, 75.37batch/s] 95%|█████████████████████████▌ | 959/1014 [00:12<00:00, 75.28batch/s] 96%|█████████████████████████▊ | 969/1014 [00:12<00:00, 75.37batch/s] 97%|██████████████████████████ | 979/1014 [00:12<00:00, 75.48batch/s] 98%|██████████████████████████▎| 989/1014 [00:13<00:00, 75.53batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 75.58batch/s]100%|█████████████████████████▊| 1009/1014 [00:13<00:00, 75.57batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.59batch/s]
Validation 47 -> LOSS = 1.14
Validation 47 -> BLEU = 56.01, 76.7/61.2/50.3/41.7 (BP=1.000, ratio=1.007, hyp_len=14489, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.27 @ validation 46
Starting Epoch 48
Epoch 48 - update      22440 => loss:   0.544 (#OOM: 0)
Epoch 48 - update      22470 => loss:   0.513 (#OOM: 0)
Epoch 48 - update      22500 => loss:   0.468 (#OOM: 0)
Epoch 48 - update      22530 => loss:   0.864 (#OOM: 0)
Epoch 48 - update      22560 => loss:   0.527 (#OOM: 0)
Epoch 48 - update      22590 => loss:   0.513 (#OOM: 0)
Epoch 48 - update      22620 => loss:   0.537 (#OOM: 0)
Epoch 48 - update      22650 => loss:   0.668 (#OOM: 0)
Epoch 48 - update      22680 => loss:   0.612 (#OOM: 0)
Epoch 48 - update      22710 => loss:   0.474 (#OOM: 0)
Epoch 48 - update      22740 => loss:   0.574 (#OOM: 0)
Epoch 48 - update      22770 => loss:   0.489 (#OOM: 0)
Epoch 48 - update      22800 => loss:   0.518 (#OOM: 0)
Epoch 48 - update      22830 => loss:   0.832 (#OOM: 0)
Epoch 48 - update      22860 => loss:   0.503 (#OOM: 0)
Epoch 48 - update      22890 => loss:   0.824 (#OOM: 0)
--> Epoch 48 finished with mean loss 0.60815
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (831 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 49.99batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 56.57batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 53.25batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 51.22batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 52.81batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.44batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 89.28batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 78.10batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.92batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.87batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.60batch/s]  5%|█▌                          | 55/1014 [00:00<00:11, 80.42batch/s]  6%|█▊                          | 65/1014 [00:00<00:11, 79.47batch/s]  7%|██                          | 75/1014 [00:00<00:11, 80.57batch/s]  8%|██▎                         | 85/1014 [00:01<00:11, 80.67batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 79.92batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 80.35batch/s] 11%|███                        | 115/1014 [00:01<00:11, 79.96batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 80.07batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 78.59batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 78.21batch/s] 15%|████▏                      | 155/1014 [00:01<00:10, 78.41batch/s] 16%|████▍                      | 165/1014 [00:02<00:10, 78.05batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 78.04batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 77.73batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 77.84batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 77.50batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.91batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 76.62batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 77.06batch/s] 24%|██████▌                    | 245/1014 [00:03<00:09, 76.93batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 77.07batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 76.44batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 76.52batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 76.65batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 76.60batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 76.63batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 76.52batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 76.06batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 76.10batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 76.23batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 75.36batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.32batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 75.51batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.44batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.56batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.46batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 75.56batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.78batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.97batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 75.92batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 76.06batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 76.16batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 76.13batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 76.04batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 76.17batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 76.32batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 76.42batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 76.44batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:06, 76.48batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 76.55batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 76.43batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 76.26batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 76.09batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 76.08batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 76.03batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 76.11batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 76.18batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 76.09batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 75.96batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 76.12batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 76.34batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 76.45batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 76.66batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 76.70batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 76.64batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 76.58batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 76.46batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 76.54batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 76.48batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 76.20batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 76.16batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 76.19batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 76.08batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 76.07batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 76.22batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.96batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.84batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.79batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.88batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.92batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.93batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.93batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.96batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 76.04batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 76.10batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.97batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.94batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.95batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.97batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.72batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.74batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.81batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.88batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 75.85batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.96batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 76.03batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.97batch/s]
Validation 48 -> LOSS = 1.14
Validation 48 -> BLEU = 55.88, 76.9/61.1/50.1/41.4 (BP=1.000, ratio=1.003, hyp_len=14427, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.27 @ validation 46
Starting Epoch 49
Epoch 49 - update      22920 => loss:   0.482 (#OOM: 0)
Epoch 49 - update      22950 => loss:   0.746 (#OOM: 0)
Epoch 49 - update      22980 => loss:   0.531 (#OOM: 0)
Epoch 49 - update      23010 => loss:   0.503 (#OOM: 0)
Epoch 49 - update      23040 => loss:   0.645 (#OOM: 0)
Epoch 49 - update      23070 => loss:   0.493 (#OOM: 0)
Epoch 49 - update      23100 => loss:   0.415 (#OOM: 0)
Epoch 49 - update      23130 => loss:   0.547 (#OOM: 0)
Epoch 49 - update      23160 => loss:   0.594 (#OOM: 0)
Epoch 49 - update      23190 => loss:   0.609 (#OOM: 0)
Epoch 49 - update      23220 => loss:   0.695 (#OOM: 0)
Epoch 49 - update      23250 => loss:   0.748 (#OOM: 0)
Epoch 49 - update      23280 => loss:   0.705 (#OOM: 0)
Epoch 49 - update      23310 => loss:   0.718 (#OOM: 0)
Epoch 49 - update      23340 => loss:   0.725 (#OOM: 0)
Epoch 49 - update      23370 => loss:   0.590 (#OOM: 0)
--> Epoch 49 finished with mean loss 0.60671
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (858 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.71batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.65batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.11batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.71batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.16batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.58batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 77.13batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 77.32batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 79.99batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 77.89batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 76.38batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 74.26batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 74.05batch/s]  7%|█▉                          | 70/1014 [00:00<00:13, 72.12batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 73.26batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 73.00batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 72.63batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 72.73batch/s] 11%|███                        | 115/1014 [00:01<00:12, 73.21batch/s] 12%|███▎                       | 124/1014 [00:01<00:12, 74.02batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 73.96batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 73.61batch/s] 15%|████                       | 151/1014 [00:02<00:11, 73.20batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 73.18batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 73.23batch/s] 18%|████▋                      | 178/1014 [00:02<00:11, 73.28batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 73.41batch/s] 19%|█████▏                     | 196/1014 [00:02<00:11, 73.26batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 73.71batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 73.63batch/s] 22%|█████▉                     | 223/1014 [00:03<00:10, 73.76batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 73.93batch/s] 24%|██████▍                    | 241/1014 [00:03<00:10, 74.27batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 74.36batch/s] 26%|██████▉                    | 259/1014 [00:03<00:10, 74.20batch/s] 26%|███████▏                   | 268/1014 [00:03<00:10, 74.51batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 74.49batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 74.52batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 74.68batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.16batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.23batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 75.39batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 75.75batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 75.81batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 75.91batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 75.73batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 75.73batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 75.75batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.57batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 75.52batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 75.63batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 75.66batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 75.78batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 75.59batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 75.58batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.63batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.55batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 75.50batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 75.62batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 75.62batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 75.33batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.44batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 75.33batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.46batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.33batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.48batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.51batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.55batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 75.60batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 75.72batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 75.63batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.54batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.00batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.04batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.17batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.11batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.14batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.27batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.30batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.30batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.34batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.41batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.41batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.43batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 75.50batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.62batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.68batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.72batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.81batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.77batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.79batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.74batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.82batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.82batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.99batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.94batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.87batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.87batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.96batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.86batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.79batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.63batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.62batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.65batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.73batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.81batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.75batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 75.78batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.81batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.83batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.81batch/s]
Validation 49 -> LOSS = 1.14
Validation 49 -> BLEU = 56.04, 76.9/61.2/50.3/41.7 (BP=1.000, ratio=1.004, hyp_len=14445, ref_len=14382)
** Learning rate changed -> 1.25e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.27 @ validation 46
Starting Epoch 50
Epoch 50 - update      23400 => loss:   0.656 (#OOM: 0)
Epoch 50 - update      23430 => loss:   0.540 (#OOM: 0)
Epoch 50 - update      23460 => loss:   0.628 (#OOM: 0)
Epoch 50 - update      23490 => loss:   0.479 (#OOM: 0)
Epoch 50 - update      23520 => loss:   0.507 (#OOM: 0)
Epoch 50 - update      23550 => loss:   0.580 (#OOM: 0)
Epoch 50 - update      23580 => loss:   0.556 (#OOM: 0)
Epoch 50 - update      23610 => loss:   0.638 (#OOM: 0)
Epoch 50 - update      23640 => loss:   0.516 (#OOM: 0)
Epoch 50 - update      23670 => loss:   0.350 (#OOM: 0)
Epoch 50 - update      23700 => loss:   0.599 (#OOM: 0)
Epoch 50 - update      23730 => loss:   0.564 (#OOM: 0)
Epoch 50 - update      23760 => loss:   0.507 (#OOM: 0)
Epoch 50 - update      23790 => loss:   0.562 (#OOM: 0)
Epoch 50 - update      23820 => loss:   0.620 (#OOM: 0)
Epoch 50 - update      23850 => loss:   0.620 (#OOM: 0)
--> Epoch 50 finished with mean loss 0.60375
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (834 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.55batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 52.69batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.74batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.62batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 51.83batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.17batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.54batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.79batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 81.30batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 80.90batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 80.79batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 78.43batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 76.42batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 77.51batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 78.07batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 78.02batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 78.32batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 77.79batch/s] 11%|███                        | 116/1014 [00:01<00:11, 76.86batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 76.66batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 77.49batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 77.08batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 77.44batch/s] 16%|████▍                      | 165/1014 [00:02<00:10, 77.89batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 77.56batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 77.36batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 76.72batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 76.69batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.94batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 76.79batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 76.63batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 76.18batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 75.90batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 76.04batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 75.92batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.90batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 76.15batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 76.25batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 76.32batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 76.33batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 76.50batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 76.35batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 76.55batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 76.50batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 76.48batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 76.40batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 76.36batch/s] 40%|██████████▊                | 405/1014 [00:05<00:07, 76.22batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 76.31batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 76.43batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 76.44batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 76.51batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 76.44batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 76.54batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 76.64batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 76.52batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 76.41batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 76.51batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 76.47batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 76.58batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:06, 76.76batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 76.63batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:05, 76.68batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 76.64batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 76.63batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 76.52batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 76.48batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 76.40batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 76.53batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 76.33batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 76.24batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 76.28batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 76.46batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 76.52batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 76.53batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 76.49batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 76.33batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 76.39batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 76.20batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 76.24batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 76.16batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 76.17batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 76.13batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 76.17batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.95batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.88batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.98batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.74batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.75batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.84batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.84batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.72batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.81batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.88batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.92batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.98batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.95batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.92batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.99batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.67batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.67batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.66batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.73batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.71batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.74batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 75.82batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.81batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.81batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.89batch/s]
Validation 50 -> LOSS = 1.14
Validation 50 -> BLEU = 56.47, 77.2/61.6/50.7/42.1 (BP=1.000, ratio=1.002, hyp_len=14405, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 51
Epoch 51 - update      23880 => loss:   0.535 (#OOM: 0)
Epoch 51 - update      23910 => loss:   0.466 (#OOM: 0)
Epoch 51 - update      23940 => loss:   0.503 (#OOM: 0)
Epoch 51 - update      23970 => loss:   0.616 (#OOM: 0)
Epoch 51 - update      24000 => loss:   0.398 (#OOM: 0)
Epoch 51 - update      24030 => loss:   0.559 (#OOM: 0)
Epoch 51 - update      24060 => loss:   0.478 (#OOM: 0)
Epoch 51 - update      24090 => loss:   0.379 (#OOM: 0)
Epoch 51 - update      24120 => loss:   0.390 (#OOM: 0)
Epoch 51 - update      24150 => loss:   0.436 (#OOM: 0)
Epoch 51 - update      24180 => loss:   0.597 (#OOM: 0)
Epoch 51 - update      24210 => loss:   0.681 (#OOM: 0)
Epoch 51 - update      24240 => loss:   0.542 (#OOM: 0)
Epoch 51 - update      24270 => loss:   0.371 (#OOM: 0)
Epoch 51 - update      24300 => loss:   0.464 (#OOM: 0)
--> Epoch 51 finished with mean loss 0.60050
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.59 mins)   (867 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.47batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 47.55batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 48.94batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.26batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 52.28batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.68batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 83.45batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.49batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 75.93batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 74.26batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 73.31batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 74.98batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 74.56batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 74.50batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 75.42batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 74.74batch/s] 10%|██▋                         | 99/1014 [00:01<00:12, 75.24batch/s] 11%|██▉                        | 108/1014 [00:01<00:12, 75.14batch/s] 12%|███                        | 117/1014 [00:01<00:11, 75.06batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 75.49batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.08batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 73.81batch/s] 15%|████                       | 153/1014 [00:02<00:11, 73.94batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 74.53batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.19batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.73batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 75.29batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 75.45batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 76.09batch/s] 21%|█████▊                     | 218/1014 [00:02<00:10, 76.27batch/s] 22%|██████                     | 228/1014 [00:02<00:10, 76.74batch/s] 23%|██████▎                    | 238/1014 [00:03<00:10, 76.94batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 76.66batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 77.02batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 77.30batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 77.34batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 77.17batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 77.15batch/s] 30%|████████▏                  | 308/1014 [00:03<00:09, 77.37batch/s] 31%|████████▍                  | 318/1014 [00:04<00:09, 77.28batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 77.13batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 77.12batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 77.18batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 76.87batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 76.93batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 77.08batch/s] 38%|██████████▎                | 388/1014 [00:05<00:08, 77.27batch/s] 39%|██████████▌                | 398/1014 [00:05<00:08, 76.99batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 76.77batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 76.66batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 76.63batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 76.42batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 76.23batch/s] 45%|████████████▏              | 458/1014 [00:06<00:07, 76.28batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 76.33batch/s] 47%|████████████▋              | 478/1014 [00:06<00:06, 76.59batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 76.35batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 76.41batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 76.32batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 76.37batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 76.38batch/s] 53%|██████████████▎            | 538/1014 [00:07<00:06, 76.42batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:06, 76.12batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 76.12batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 75.85batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 75.90batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 75.93batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 75.81batch/s] 60%|████████████████▏          | 608/1014 [00:08<00:05, 75.74batch/s] 61%|████████████████▍          | 618/1014 [00:08<00:05, 75.66batch/s] 62%|████████████████▋          | 628/1014 [00:08<00:05, 75.72batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 75.62batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 75.62batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 75.67batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 75.80batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 75.94batch/s] 68%|██████████████████▎        | 688/1014 [00:09<00:04, 75.89batch/s] 69%|██████████████████▌        | 698/1014 [00:09<00:04, 76.02batch/s] 70%|██████████████████▊        | 708/1014 [00:09<00:04, 76.02batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 76.11batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 75.83batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 75.77batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 75.84batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 75.86batch/s] 76%|████████████████████▍      | 768/1014 [00:10<00:03, 75.85batch/s] 77%|████████████████████▋      | 778/1014 [00:10<00:03, 75.86batch/s] 78%|████████████████████▉      | 788/1014 [00:10<00:02, 75.93batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 76.05batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 76.11batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 76.14batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 76.19batch/s] 83%|██████████████████████▎    | 838/1014 [00:11<00:02, 76.16batch/s] 84%|██████████████████████▌    | 848/1014 [00:11<00:02, 76.18batch/s] 85%|██████████████████████▊    | 858/1014 [00:11<00:02, 76.22batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 76.17batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 76.10batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 76.09batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 76.05batch/s] 90%|████████████████████████▏  | 908/1014 [00:11<00:01, 76.11batch/s] 91%|████████████████████████▍  | 918/1014 [00:12<00:01, 76.13batch/s] 92%|████████████████████████▋  | 928/1014 [00:12<00:01, 75.82batch/s] 93%|████████████████████████▉  | 938/1014 [00:12<00:01, 75.78batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 75.77batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 75.69batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 75.68batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 75.78batch/s] 97%|██████████████████████████▎| 988/1014 [00:13<00:00, 75.76batch/s] 98%|██████████████████████████▌| 998/1014 [00:13<00:00, 75.79batch/s] 99%|█████████████████████████▊| 1008/1014 [00:13<00:00, 75.72batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.66batch/s]
Validation 51 -> LOSS = 1.14
Validation 51 -> BLEU = 56.13, 77.0/61.3/50.3/41.8 (BP=1.000, ratio=1.001, hyp_len=14402, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 52
Epoch 52 - update      24330 => loss:   0.335 (#OOM: 0)
Epoch 52 - update      24360 => loss:   0.740 (#OOM: 0)
Epoch 52 - update      24390 => loss:   0.353 (#OOM: 0)
Epoch 52 - update      24420 => loss:   0.206 (#OOM: 0)
Epoch 52 - update      24450 => loss:   0.480 (#OOM: 0)
Epoch 52 - update      24480 => loss:   0.773 (#OOM: 0)
Epoch 52 - update      24510 => loss:   0.648 (#OOM: 0)
Epoch 52 - update      24540 => loss:   0.634 (#OOM: 0)
Epoch 52 - update      24570 => loss:   0.638 (#OOM: 0)
Epoch 52 - update      24600 => loss:   0.709 (#OOM: 0)
Epoch 52 - update      24630 => loss:   0.454 (#OOM: 0)
Epoch 52 - update      24660 => loss:   0.603 (#OOM: 0)
Epoch 52 - update      24690 => loss:   0.600 (#OOM: 0)
Epoch 52 - update      24720 => loss:   0.591 (#OOM: 0)
Epoch 52 - update      24750 => loss:   0.550 (#OOM: 0)
Epoch 52 - update      24780 => loss:   0.719 (#OOM: 0)
--> Epoch 52 finished with mean loss 0.60371
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.58 mins)   (887 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 41.30batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.95batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 51.99batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 51.15batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.18batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.54batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.10batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.80batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 72.83batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 75.90batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 75.89batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 78.85batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 78.15batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 78.53batch/s]  8%|██▎                         | 82/1014 [00:01<00:11, 79.01batch/s]  9%|██▌                         | 92/1014 [00:01<00:11, 78.81batch/s] 10%|██▋                        | 102/1014 [00:01<00:11, 79.74batch/s] 11%|██▉                        | 112/1014 [00:01<00:11, 75.73batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 76.13batch/s] 13%|███▌                       | 132/1014 [00:01<00:11, 76.33batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 76.19batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.99batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.75batch/s] 17%|████▌                      | 172/1014 [00:02<00:11, 75.93batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 75.78batch/s] 19%|█████                      | 192/1014 [00:02<00:10, 75.99batch/s] 20%|█████▍                     | 202/1014 [00:02<00:10, 76.20batch/s] 21%|█████▋                     | 212/1014 [00:02<00:10, 76.13batch/s] 22%|█████▉                     | 222/1014 [00:02<00:10, 76.17batch/s] 23%|██████▏                    | 232/1014 [00:03<00:10, 75.99batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.56batch/s] 25%|██████▋                    | 252/1014 [00:03<00:10, 75.47batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 75.53batch/s] 27%|███████▏                   | 272/1014 [00:03<00:09, 75.92batch/s] 28%|███████▌                   | 282/1014 [00:03<00:09, 76.26batch/s] 29%|███████▊                   | 292/1014 [00:03<00:09, 76.19batch/s] 30%|████████                   | 302/1014 [00:03<00:09, 76.44batch/s] 31%|████████▎                  | 312/1014 [00:04<00:09, 76.69batch/s] 32%|████████▌                  | 322/1014 [00:04<00:09, 76.45batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 76.55batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 76.74batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 76.91batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:08, 77.07batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:08, 76.95batch/s] 38%|██████████▏                | 382/1014 [00:04<00:08, 77.18batch/s] 39%|██████████▍                | 392/1014 [00:05<00:08, 76.86batch/s] 40%|██████████▋                | 402/1014 [00:05<00:07, 76.75batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 76.64batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 76.65batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 76.81batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 76.83batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 76.72batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 76.74batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 76.71batch/s] 48%|████████████▊              | 482/1014 [00:06<00:06, 76.53batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 76.55batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 76.75batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 76.78batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 76.86batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:06, 76.99batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 76.76batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 76.72batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 76.56batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 76.60batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 76.28batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 76.23batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 76.37batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:05, 76.50batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 76.22batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 76.34batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 76.25batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 76.04batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 76.04batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 75.92batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 75.93batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 75.94batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 76.07batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 76.24batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 76.15batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 76.20batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 76.16batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 76.04batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 76.01batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 76.04batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.96batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 76.04batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 76.17batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 76.17batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 76.26batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 76.33batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 76.32batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 76.32batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:01, 76.27batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 76.15batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 76.14batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 76.09batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 75.86batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.88batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.80batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.62batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.61batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.57batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.69batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.60batch/s] 97%|██████████████████████████▏| 982/1014 [00:13<00:00, 75.54batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.61batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.72batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.72batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.75batch/s]
Validation 52 -> LOSS = 1.14
Validation 52 -> BLEU = 55.99, 76.9/61.2/50.2/41.6 (BP=1.000, ratio=1.005, hyp_len=14447, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 53
Epoch 53 - update      24810 => loss:   0.118 (#OOM: 0)
Epoch 53 - update      24840 => loss:   0.515 (#OOM: 0)
Epoch 53 - update      24870 => loss:   0.493 (#OOM: 0)
Epoch 53 - update      24900 => loss:   0.516 (#OOM: 0)
Epoch 53 - update      24930 => loss:   0.402 (#OOM: 0)
Epoch 53 - update      24960 => loss:   0.454 (#OOM: 0)
Epoch 53 - update      24990 => loss:   0.552 (#OOM: 0)
Epoch 53 - update      25020 => loss:   0.486 (#OOM: 0)
Epoch 53 - update      25050 => loss:   0.547 (#OOM: 0)
Epoch 53 - update      25080 => loss:   0.584 (#OOM: 0)
Epoch 53 - update      25110 => loss:   0.524 (#OOM: 0)
Epoch 53 - update      25140 => loss:   0.539 (#OOM: 0)
Epoch 53 - update      25170 => loss:   0.645 (#OOM: 0)
Epoch 53 - update      25200 => loss:   0.695 (#OOM: 0)
Epoch 53 - update      25230 => loss:   0.386 (#OOM: 0)
Epoch 53 - update      25260 => loss:   0.661 (#OOM: 0)
--> Epoch 53 finished with mean loss 0.59919
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (894 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 48.35batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 49.76batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.08batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.73batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.99batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.92batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 85.84batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.96batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 80.73batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.90batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 80.14batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 80.70batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 79.49batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 79.48batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 78.13batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 77.46batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 77.00batch/s] 12%|███                        | 117/1014 [00:01<00:11, 76.32batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 76.38batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 76.08batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 76.03batch/s] 15%|████                       | 153/1014 [00:02<00:11, 76.15batch/s] 16%|████▎                      | 162/1014 [00:02<00:11, 75.78batch/s] 17%|████▌                      | 171/1014 [00:02<00:11, 75.51batch/s] 18%|████▊                      | 180/1014 [00:02<00:11, 74.92batch/s] 19%|█████                      | 189/1014 [00:02<00:11, 74.81batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 74.70batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 74.62batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 74.74batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.73batch/s] 23%|██████▏                    | 234/1014 [00:03<00:10, 75.01batch/s] 24%|██████▍                    | 244/1014 [00:03<00:10, 75.50batch/s] 25%|██████▊                    | 254/1014 [00:03<00:10, 75.50batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 76.00batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 76.05batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 75.99batch/s] 29%|███████▊                   | 294/1014 [00:03<00:09, 75.83batch/s] 30%|████████                   | 304/1014 [00:04<00:09, 75.82batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.53batch/s] 32%|████████▋                  | 324/1014 [00:04<00:09, 75.50batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 75.77batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 75.35batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 75.60batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:08, 75.79batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:08, 75.71batch/s] 38%|██████████▏                | 384/1014 [00:05<00:08, 75.80batch/s] 39%|██████████▍                | 394/1014 [00:05<00:08, 75.71batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.74batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 75.62batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 75.69batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 75.85batch/s] 44%|███████████▊               | 444/1014 [00:05<00:07, 75.45batch/s] 45%|████████████               | 454/1014 [00:06<00:07, 75.65batch/s] 46%|████████████▎              | 464/1014 [00:06<00:07, 75.64batch/s] 47%|████████████▌              | 474/1014 [00:06<00:07, 75.39batch/s] 48%|████████████▉              | 484/1014 [00:06<00:07, 75.56batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 75.71batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 75.66batch/s] 51%|█████████████▋             | 514/1014 [00:06<00:06, 75.50batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:06, 75.34batch/s] 53%|██████████████▏            | 534/1014 [00:07<00:06, 75.46batch/s] 54%|██████████████▍            | 544/1014 [00:07<00:06, 75.50batch/s] 55%|██████████████▊            | 554/1014 [00:07<00:06, 75.43batch/s] 56%|███████████████            | 564/1014 [00:07<00:05, 75.35batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 75.36batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 75.37batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 75.36batch/s] 60%|████████████████           | 604/1014 [00:08<00:05, 75.38batch/s] 61%|████████████████▎          | 614/1014 [00:08<00:05, 75.48batch/s] 62%|████████████████▌          | 624/1014 [00:08<00:05, 75.49batch/s] 63%|████████████████▉          | 634/1014 [00:08<00:05, 75.40batch/s] 64%|█████████████████▏         | 644/1014 [00:08<00:04, 75.43batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 75.42batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 75.39batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 75.33batch/s] 67%|██████████████████▏        | 684/1014 [00:09<00:04, 75.32batch/s] 68%|██████████████████▍        | 694/1014 [00:09<00:04, 75.29batch/s] 69%|██████████████████▋        | 704/1014 [00:09<00:04, 75.27batch/s] 70%|███████████████████        | 714/1014 [00:09<00:03, 75.28batch/s] 71%|███████████████████▎       | 724/1014 [00:09<00:03, 75.35batch/s] 72%|███████████████████▌       | 734/1014 [00:09<00:03, 75.42batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 75.40batch/s] 74%|████████████████████       | 754/1014 [00:10<00:03, 75.33batch/s] 75%|████████████████████▎      | 764/1014 [00:10<00:03, 75.31batch/s] 76%|████████████████████▌      | 774/1014 [00:10<00:03, 75.38batch/s] 77%|████████████████████▉      | 784/1014 [00:10<00:03, 75.32batch/s] 78%|█████████████████████▏     | 794/1014 [00:10<00:02, 75.35batch/s] 79%|█████████████████████▍     | 804/1014 [00:10<00:02, 75.45batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 75.39batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 75.48batch/s] 82%|██████████████████████▏    | 834/1014 [00:11<00:02, 75.51batch/s] 83%|██████████████████████▍    | 844/1014 [00:11<00:02, 75.55batch/s] 84%|██████████████████████▋    | 854/1014 [00:11<00:02, 75.56batch/s] 85%|███████████████████████    | 864/1014 [00:11<00:01, 75.60batch/s] 86%|███████████████████████▎   | 874/1014 [00:11<00:01, 75.59batch/s] 87%|███████████████████████▌   | 884/1014 [00:11<00:01, 75.60batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 75.74batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 75.73batch/s] 90%|████████████████████████▎  | 914/1014 [00:12<00:01, 75.61batch/s] 91%|████████████████████████▌  | 924/1014 [00:12<00:01, 75.56batch/s] 92%|████████████████████████▊  | 934/1014 [00:12<00:01, 75.52batch/s] 93%|█████████████████████████▏ | 944/1014 [00:12<00:00, 75.64batch/s] 94%|█████████████████████████▍ | 954/1014 [00:12<00:00, 75.59batch/s] 95%|█████████████████████████▋ | 964/1014 [00:12<00:00, 75.65batch/s] 96%|█████████████████████████▉ | 974/1014 [00:12<00:00, 75.70batch/s] 97%|██████████████████████████▏| 984/1014 [00:13<00:00, 75.67batch/s] 98%|██████████████████████████▍| 994/1014 [00:13<00:00, 75.77batch/s] 99%|█████████████████████████▋| 1004/1014 [00:13<00:00, 75.80batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.76batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.76batch/s]
Validation 53 -> LOSS = 1.14
Validation 53 -> BLEU = 56.38, 77.2/61.6/50.7/42.0 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
** Learning rate changed -> 6.25e-06
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 54
Epoch 54 - update      25290 => loss:   0.820 (#OOM: 0)
Epoch 54 - update      25320 => loss:   0.529 (#OOM: 0)
Epoch 54 - update      25350 => loss:   0.520 (#OOM: 0)
Epoch 54 - update      25380 => loss:   0.597 (#OOM: 0)
Epoch 54 - update      25410 => loss:   0.663 (#OOM: 0)
Epoch 54 - update      25440 => loss:   0.528 (#OOM: 0)
Epoch 54 - update      25470 => loss:   0.469 (#OOM: 0)
Epoch 54 - update      25500 => loss:   0.475 (#OOM: 0)
Epoch 54 - update      25530 => loss:   0.580 (#OOM: 0)
Epoch 54 - update      25560 => loss:   0.542 (#OOM: 0)
Epoch 54 - update      25590 => loss:   0.466 (#OOM: 0)
Epoch 54 - update      25620 => loss:   0.616 (#OOM: 0)
Epoch 54 - update      25650 => loss:   0.433 (#OOM: 0)
Epoch 54 - update      25680 => loss:   0.567 (#OOM: 0)
Epoch 54 - update      25710 => loss:   0.471 (#OOM: 0)
Epoch 54 - update      25740 => loss:   0.835 (#OOM: 0)
--> Epoch 54 finished with mean loss 0.59857
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (882 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.66batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.35batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.18batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.10batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.68batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.41batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.38batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.95batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 80.06batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 82.01batch/s]  3%|▉                           | 35/1014 [00:00<00:11, 82.72batch/s]  4%|█▏                          | 44/1014 [00:00<00:11, 83.84batch/s]  5%|█▍                          | 53/1014 [00:00<00:11, 80.74batch/s]  6%|█▋                          | 62/1014 [00:00<00:11, 81.07batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 78.55batch/s]  8%|██▏                         | 80/1014 [00:01<00:11, 79.11batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 77.30batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 76.41batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 76.29batch/s] 11%|███                        | 116/1014 [00:01<00:11, 76.23batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 76.52batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 76.13batch/s] 14%|███▊                       | 143/1014 [00:01<00:11, 76.04batch/s] 15%|████                       | 152/1014 [00:02<00:11, 75.63batch/s] 16%|████▎                      | 161/1014 [00:02<00:11, 75.81batch/s] 17%|████▌                      | 170/1014 [00:02<00:11, 76.19batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 76.57batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 76.13batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 76.12batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 75.88batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 76.28batch/s] 22%|█████▉                     | 224/1014 [00:02<00:10, 76.04batch/s] 23%|██████▏                    | 233/1014 [00:03<00:10, 75.77batch/s] 24%|██████▍                    | 242/1014 [00:03<00:10, 75.64batch/s] 25%|██████▋                    | 251/1014 [00:03<00:10, 76.02batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 75.76batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 75.46batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 75.79batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 75.26batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.38batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.22batch/s] 31%|████████▎                  | 314/1014 [00:04<00:09, 75.25batch/s] 32%|████████▌                  | 323/1014 [00:04<00:09, 75.53batch/s] 33%|████████▊                  | 332/1014 [00:04<00:09, 75.61batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 75.07batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.24batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:08, 75.44batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 75.59batch/s] 37%|██████████                 | 377/1014 [00:04<00:08, 75.66batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 75.77batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 75.95batch/s] 40%|██████████▊                | 404/1014 [00:05<00:08, 75.95batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 76.19batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 76.25batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 76.53batch/s] 44%|███████████▊               | 442/1014 [00:05<00:07, 76.64batch/s] 45%|████████████               | 452/1014 [00:05<00:07, 76.70batch/s] 46%|████████████▎              | 462/1014 [00:06<00:07, 76.51batch/s] 47%|████████████▌              | 472/1014 [00:06<00:07, 76.48batch/s] 48%|████████████▊              | 482/1014 [00:06<00:06, 76.34batch/s] 49%|█████████████              | 492/1014 [00:06<00:06, 76.22batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 76.38batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 76.45batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 76.26batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:06, 76.11batch/s] 53%|██████████████▍            | 542/1014 [00:07<00:06, 76.27batch/s] 54%|██████████████▋            | 552/1014 [00:07<00:06, 76.43batch/s] 55%|██████████████▉            | 562/1014 [00:07<00:05, 76.36batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 76.20batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 76.14batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 76.13batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 76.19batch/s] 60%|████████████████▎          | 612/1014 [00:08<00:05, 75.88batch/s] 61%|████████████████▌          | 622/1014 [00:08<00:05, 75.76batch/s] 62%|████████████████▊          | 632/1014 [00:08<00:05, 75.77batch/s] 63%|█████████████████          | 642/1014 [00:08<00:04, 75.80batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 75.83batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 75.95batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 75.87batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 75.93batch/s] 68%|██████████████████▍        | 692/1014 [00:09<00:04, 76.05batch/s] 69%|██████████████████▋        | 702/1014 [00:09<00:04, 76.05batch/s] 70%|██████████████████▉        | 712/1014 [00:09<00:03, 76.05batch/s] 71%|███████████████████▏       | 722/1014 [00:09<00:03, 76.05batch/s] 72%|███████████████████▍       | 732/1014 [00:09<00:03, 75.95batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 75.89batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 75.83batch/s] 75%|████████████████████▎      | 762/1014 [00:10<00:03, 75.86batch/s] 76%|████████████████████▌      | 772/1014 [00:10<00:03, 75.95batch/s] 77%|████████████████████▊      | 782/1014 [00:10<00:03, 75.87batch/s] 78%|█████████████████████      | 792/1014 [00:10<00:02, 75.94batch/s] 79%|█████████████████████▎     | 802/1014 [00:10<00:02, 76.02batch/s] 80%|█████████████████████▌     | 812/1014 [00:10<00:02, 75.99batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 76.00batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 76.02batch/s] 83%|██████████████████████▍    | 842/1014 [00:11<00:02, 75.77batch/s] 84%|██████████████████████▋    | 852/1014 [00:11<00:02, 75.89batch/s] 85%|██████████████████████▉    | 862/1014 [00:11<00:02, 75.82batch/s] 86%|███████████████████████▏   | 872/1014 [00:11<00:01, 75.97batch/s] 87%|███████████████████████▍   | 882/1014 [00:11<00:01, 76.03batch/s] 88%|███████████████████████▊   | 892/1014 [00:11<00:01, 76.04batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 76.01batch/s] 90%|████████████████████████▎  | 912/1014 [00:12<00:01, 75.99batch/s] 91%|████████████████████████▌  | 922/1014 [00:12<00:01, 75.79batch/s] 92%|████████████████████████▊  | 932/1014 [00:12<00:01, 75.70batch/s] 93%|█████████████████████████  | 942/1014 [00:12<00:00, 75.74batch/s] 94%|█████████████████████████▎ | 952/1014 [00:12<00:00, 75.82batch/s] 95%|█████████████████████████▌ | 962/1014 [00:12<00:00, 75.88batch/s] 96%|█████████████████████████▉ | 972/1014 [00:12<00:00, 75.95batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 75.88batch/s] 98%|██████████████████████████▍| 992/1014 [00:13<00:00, 75.78batch/s] 99%|█████████████████████████▋| 1002/1014 [00:13<00:00, 75.82batch/s]100%|█████████████████████████▉| 1012/1014 [00:13<00:00, 75.70batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.70batch/s]
Validation 54 -> LOSS = 1.14
Validation 54 -> BLEU = 56.28, 77.2/61.5/50.5/41.9 (BP=1.000, ratio=1.001, hyp_len=14394, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 55
Epoch 55 - update      25770 => loss:   0.724 (#OOM: 0)
Epoch 55 - update      25800 => loss:   0.660 (#OOM: 0)
Epoch 55 - update      25830 => loss:   0.842 (#OOM: 0)
Epoch 55 - update      25860 => loss:   0.514 (#OOM: 0)
Epoch 55 - update      25890 => loss:   0.759 (#OOM: 0)
Epoch 55 - update      25920 => loss:   0.539 (#OOM: 0)
Epoch 55 - update      25950 => loss:   0.474 (#OOM: 0)
Epoch 55 - update      25980 => loss:   0.553 (#OOM: 0)
Epoch 55 - update      26010 => loss:   0.484 (#OOM: 0)
Epoch 55 - update      26040 => loss:   0.820 (#OOM: 0)
Epoch 55 - update      26070 => loss:   0.745 (#OOM: 0)
Epoch 55 - update      26100 => loss:   0.544 (#OOM: 0)
Epoch 55 - update      26130 => loss:   0.592 (#OOM: 0)
Epoch 55 - update      26160 => loss:   0.695 (#OOM: 0)
Epoch 55 - update      26190 => loss:   0.393 (#OOM: 0)
Epoch 55 - update      26220 => loss:   0.482 (#OOM: 0)
--> Epoch 55 finished with mean loss 0.59778
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.57 mins)   (906 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.34batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.65batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 52.74batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 50.74batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 50.56batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.75batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.68batch/s]  2%|▍                           | 16/1014 [00:00<00:14, 70.72batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 73.25batch/s]  3%|▉                           | 32/1014 [00:00<00:13, 73.51batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 75.64batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 74.33batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 74.66batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 75.42batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 76.00batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 76.33batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 76.88batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 77.69batch/s] 11%|███                        | 113/1014 [00:01<00:11, 78.49batch/s] 12%|███▏                       | 122/1014 [00:01<00:11, 76.01batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 75.97batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 75.79batch/s] 15%|███▉                       | 149/1014 [00:01<00:11, 75.59batch/s] 16%|████▏                      | 158/1014 [00:02<00:11, 75.59batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 75.00batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 75.49batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 75.20batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 75.71batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 75.76batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 75.93batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 75.36batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 74.91batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 74.92batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 75.34batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 75.63batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 75.95batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.87batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.67batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.91batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 75.92batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 76.10batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 76.31batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 76.47batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 76.64batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 76.61batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 76.27batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 76.29batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 76.18batch/s] 40%|██████████▊                | 405/1014 [00:05<00:07, 76.32batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 76.13batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 76.28batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 76.31batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 76.06batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 75.86batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 75.76batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 75.88batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 76.05batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 76.04batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 75.98batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 75.91batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 75.91batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 75.70batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 75.74batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 75.62batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 75.73batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 75.65batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 75.44batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 75.33batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 75.39batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 75.44batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 75.41batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 75.49batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 75.59batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 75.68batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 75.53batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 75.59batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 75.50batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 75.44batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 75.39batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 75.28batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 75.31batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 75.48batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 75.51batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 75.61batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 75.62batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 75.63batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 75.63batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 75.60batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.57batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.63batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.66batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.71batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.67batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.66batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.73batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.83batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.85batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.87batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 75.90batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.92batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.82batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.78batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.83batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.71batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.78batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.81batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 75.88batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.92batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 76.01batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.04batch/s]
Validation 55 -> LOSS = 1.14
Validation 55 -> BLEU = 56.36, 77.4/61.7/50.7/42.1 (BP=0.997, ratio=0.997, hyp_len=14346, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 56
Epoch 56 - update      26250 => loss:   0.720 (#OOM: 0)
Epoch 56 - update      26280 => loss:   0.484 (#OOM: 0)
Epoch 56 - update      26310 => loss:   0.557 (#OOM: 0)
Epoch 56 - update      26340 => loss:   0.570 (#OOM: 0)
Epoch 56 - update      26370 => loss:   0.644 (#OOM: 0)
Epoch 56 - update      26400 => loss:   0.355 (#OOM: 0)
Epoch 56 - update      26430 => loss:   0.521 (#OOM: 0)
Epoch 56 - update      26460 => loss:   0.822 (#OOM: 0)
Epoch 56 - update      26490 => loss:   0.605 (#OOM: 0)
Epoch 56 - update      26520 => loss:   0.597 (#OOM: 0)
Epoch 56 - update      26550 => loss:   0.556 (#OOM: 0)
Epoch 56 - update      26580 => loss:   0.670 (#OOM: 0)
Epoch 56 - update      26610 => loss:   0.565 (#OOM: 0)
Epoch 56 - update      26640 => loss:   0.586 (#OOM: 0)
Epoch 56 - update      26670 => loss:   0.603 (#OOM: 0)
Epoch 56 - update      26700 => loss:   0.489 (#OOM: 0)
--> Epoch 56 finished with mean loss 0.59611
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (822 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.64batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.92batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.73batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 49.97batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.00batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.95batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.37batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 77.43batch/s]  3%|▋                           | 27/1014 [00:00<00:13, 74.61batch/s]  4%|▉                           | 36/1014 [00:00<00:13, 73.70batch/s]  4%|█▏                          | 45/1014 [00:00<00:13, 72.80batch/s]  5%|█▌                          | 55/1014 [00:00<00:12, 74.85batch/s]  6%|█▊                          | 65/1014 [00:00<00:12, 74.03batch/s]  7%|██                          | 75/1014 [00:01<00:12, 74.96batch/s]  8%|██▎                         | 85/1014 [00:01<00:12, 74.47batch/s]  9%|██▌                         | 95/1014 [00:01<00:12, 74.39batch/s] 10%|██▊                        | 105/1014 [00:01<00:12, 74.24batch/s] 11%|███                        | 115/1014 [00:01<00:12, 74.15batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 74.38batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 74.84batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 75.07batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 75.33batch/s] 16%|████▍                      | 165/1014 [00:02<00:11, 74.75batch/s] 17%|████▋                      | 175/1014 [00:02<00:11, 74.28batch/s] 18%|████▉                      | 185/1014 [00:02<00:11, 73.88batch/s] 19%|█████▏                     | 195/1014 [00:02<00:11, 74.07batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 74.32batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 74.80batch/s] 22%|█████▉                     | 225/1014 [00:03<00:10, 74.41batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 74.00batch/s] 24%|██████▌                    | 245/1014 [00:03<00:10, 74.27batch/s] 25%|██████▊                    | 255/1014 [00:03<00:10, 74.87batch/s] 26%|███████                    | 265/1014 [00:03<00:10, 74.80batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 74.84batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 75.06batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 75.43batch/s] 30%|████████                   | 305/1014 [00:04<00:09, 75.56batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 74.93batch/s] 32%|████████▋                  | 325/1014 [00:04<00:09, 74.33batch/s] 33%|████████▉                  | 335/1014 [00:04<00:09, 74.47batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:09, 74.22batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 74.28batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 74.46batch/s] 37%|█████████▉                 | 375/1014 [00:05<00:08, 74.55batch/s] 38%|██████████▎                | 385/1014 [00:05<00:08, 74.74batch/s] 39%|██████████▌                | 395/1014 [00:05<00:08, 74.73batch/s] 40%|██████████▊                | 405/1014 [00:05<00:08, 74.65batch/s] 41%|███████████                | 415/1014 [00:05<00:08, 74.65batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 74.66batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 74.73batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 74.79batch/s] 45%|████████████               | 455/1014 [00:06<00:07, 74.84batch/s] 46%|████████████▍              | 465/1014 [00:06<00:07, 74.83batch/s] 47%|████████████▋              | 475/1014 [00:06<00:07, 74.74batch/s] 48%|████████████▉              | 485/1014 [00:06<00:07, 74.61batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 74.59batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 74.39batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 74.41batch/s] 52%|█████████████▉             | 525/1014 [00:07<00:06, 74.50batch/s] 53%|██████████████▏            | 535/1014 [00:07<00:06, 74.65batch/s] 54%|██████████████▌            | 545/1014 [00:07<00:06, 74.36batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:06, 74.29batch/s] 56%|███████████████            | 565/1014 [00:07<00:06, 74.56batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 74.49batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 74.45batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 74.50batch/s] 60%|████████████████           | 605/1014 [00:08<00:05, 74.49batch/s] 61%|████████████████▍          | 615/1014 [00:08<00:05, 74.49batch/s] 62%|████████████████▋          | 625/1014 [00:08<00:05, 74.37batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:05, 74.44batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 74.54batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 74.37batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 74.47batch/s] 67%|█████████████████▉         | 675/1014 [00:09<00:04, 74.47batch/s] 68%|██████████████████▏        | 685/1014 [00:09<00:04, 74.61batch/s] 69%|██████████████████▌        | 695/1014 [00:09<00:04, 74.73batch/s] 70%|██████████████████▊        | 705/1014 [00:09<00:04, 74.80batch/s] 71%|███████████████████        | 715/1014 [00:09<00:04, 74.70batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 74.80batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 74.78batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 74.73batch/s] 74%|████████████████████       | 755/1014 [00:10<00:03, 74.82batch/s] 75%|████████████████████▎      | 765/1014 [00:10<00:03, 74.97batch/s] 76%|████████████████████▋      | 775/1014 [00:10<00:03, 74.89batch/s] 77%|████████████████████▉      | 785/1014 [00:10<00:03, 74.85batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 74.95batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 75.15batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 75.21batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 75.41batch/s] 82%|██████████████████████▏    | 835/1014 [00:11<00:02, 75.28batch/s] 83%|██████████████████████▌    | 845/1014 [00:11<00:02, 75.41batch/s] 84%|██████████████████████▊    | 855/1014 [00:11<00:02, 75.48batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 75.47batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 75.57batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 75.67batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 75.33batch/s] 89%|████████████████████████   | 905/1014 [00:12<00:01, 75.21batch/s] 90%|████████████████████████▎  | 915/1014 [00:12<00:01, 75.31batch/s] 91%|████████████████████████▋  | 925/1014 [00:12<00:01, 75.40batch/s] 92%|████████████████████████▉  | 935/1014 [00:12<00:01, 75.27batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 75.39batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 75.34batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 75.24batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 75.28batch/s] 97%|██████████████████████████▏| 985/1014 [00:13<00:00, 75.27batch/s] 98%|██████████████████████████▍| 995/1014 [00:13<00:00, 75.35batch/s] 99%|█████████████████████████▊| 1005/1014 [00:13<00:00, 75.38batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.28batch/s]
Validation 56 -> LOSS = 1.14
Validation 56 -> BLEU = 56.01, 76.8/61.2/50.2/41.7 (BP=1.000, ratio=1.004, hyp_len=14441, ref_len=14382)
** Learning rate changed -> 3.125e-06
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 57
Epoch 57 - update      26730 => loss:   0.667 (#OOM: 0)
Epoch 57 - update      26760 => loss:   0.459 (#OOM: 0)
Epoch 57 - update      26790 => loss:   0.533 (#OOM: 0)
Epoch 57 - update      26820 => loss:   0.543 (#OOM: 0)
Epoch 57 - update      26850 => loss:   0.783 (#OOM: 0)
Epoch 57 - update      26880 => loss:   0.385 (#OOM: 0)
Epoch 57 - update      26910 => loss:   0.490 (#OOM: 0)
Epoch 57 - update      26940 => loss:   0.584 (#OOM: 0)
Epoch 57 - update      26970 => loss:   0.756 (#OOM: 0)
Epoch 57 - update      27000 => loss:   0.446 (#OOM: 0)
Epoch 57 - update      27030 => loss:   0.460 (#OOM: 0)
Epoch 57 - update      27060 => loss:   0.360 (#OOM: 0)
Epoch 57 - update      27090 => loss:   0.464 (#OOM: 0)
Epoch 57 - update      27120 => loss:   0.509 (#OOM: 0)
Epoch 57 - update      27150 => loss:   0.607 (#OOM: 0)
Epoch 57 - update      27180 => loss:   0.572 (#OOM: 0)
--> Epoch 57 finished with mean loss 0.59547
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (785 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.75batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.75batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.05batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.18batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.25batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.24batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 71.21batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 71.63batch/s]  2%|▋                           | 25/1014 [00:00<00:13, 73.81batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 76.20batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 77.36batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 77.26batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 78.26batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 78.64batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 80.03batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 78.76batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 77.15batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 77.88batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 78.15batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 77.98batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 77.73batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 77.57batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.98batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 77.38batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 77.29batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 77.51batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 77.00batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 77.38batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 77.05batch/s] 23%|██████                     | 230/1014 [00:02<00:10, 76.93batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 77.09batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 77.13batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 77.11batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 77.25batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 77.27batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 77.33batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 76.71batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 77.00batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 76.98batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 77.18batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 77.33batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 77.10batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 76.97batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 77.05batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 77.15batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 77.21batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 77.10batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 77.08batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 77.09batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 76.98batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 77.12batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 76.99batch/s] 45%|████████████▏              | 460/1014 [00:05<00:07, 77.21batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 77.23batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 77.13batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 77.03batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 77.22batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 77.30batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 77.15batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 77.16batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 76.98batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 76.88batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 76.98batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 77.18batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 77.24batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 77.44batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 77.26batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 77.19batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 77.25batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:04, 77.33batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 77.21batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 77.21batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 77.11batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 76.94batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 76.96batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:04, 77.09batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 77.07batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:03, 76.91batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 76.90batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 76.84batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 76.90batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 76.83batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 76.82batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 76.64batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 76.65batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 76.69batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 76.62batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 76.71batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 76.55batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 76.41batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 76.30batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 76.20batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 76.21batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 76.12batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 76.14batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.79batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.69batch/s] 90%|████████████████████████▏  | 910/1014 [00:12<00:01, 75.48batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.56batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.38batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.39batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.28batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.00batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.09batch/s] 97%|██████████████████████████ | 980/1014 [00:13<00:00, 75.03batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.05batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.01batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 74.97batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.03batch/s]
Validation 57 -> LOSS = 1.14
Validation 57 -> BLEU = 56.03, 76.9/61.2/50.3/41.6 (BP=1.000, ratio=1.004, hyp_len=14436, ref_len=14382)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 58
Epoch 58 - update      27210 => loss:   0.497 (#OOM: 0)
Epoch 58 - update      27240 => loss:   0.511 (#OOM: 0)
Epoch 58 - update      27270 => loss:   0.482 (#OOM: 0)
Epoch 58 - update      27300 => loss:   0.475 (#OOM: 0)
Epoch 58 - update      27330 => loss:   0.682 (#OOM: 0)
Epoch 58 - update      27360 => loss:   0.431 (#OOM: 0)
Epoch 58 - update      27390 => loss:   0.665 (#OOM: 0)
Epoch 58 - update      27420 => loss:   0.679 (#OOM: 0)
Epoch 58 - update      27450 => loss:   0.581 (#OOM: 0)
Epoch 58 - update      27480 => loss:   0.762 (#OOM: 0)
Epoch 58 - update      27510 => loss:   0.478 (#OOM: 0)
Epoch 58 - update      27540 => loss:   0.710 (#OOM: 0)
Epoch 58 - update      27570 => loss:   0.722 (#OOM: 0)
Epoch 58 - update      27600 => loss:   0.474 (#OOM: 0)
Epoch 58 - update      27630 => loss:   0.836 (#OOM: 0)
Epoch 58 - update      27660 => loss:   0.458 (#OOM: 0)
--> Epoch 58 finished with mean loss 0.59543
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.67 mins)   (776 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.89batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 52.56batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.38batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.85batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.94batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.76batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.73batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.62batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.05batch/s]  2%|▋                           | 24/1014 [00:00<00:13, 71.32batch/s]  3%|▉                           | 32/1014 [00:00<00:14, 66.80batch/s]  4%|█                           | 40/1014 [00:00<00:14, 68.12batch/s]  5%|█▎                          | 48/1014 [00:00<00:13, 69.42batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 69.83batch/s]  6%|█▊                          | 64/1014 [00:00<00:13, 70.58batch/s]  7%|█▉                          | 72/1014 [00:01<00:13, 70.95batch/s]  8%|██▏                         | 80/1014 [00:01<00:13, 70.28batch/s]  9%|██▍                         | 88/1014 [00:01<00:13, 69.95batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 70.65batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 71.02batch/s] 11%|██▉                        | 112/1014 [00:01<00:12, 71.29batch/s] 12%|███▏                       | 120/1014 [00:01<00:12, 71.42batch/s] 13%|███▍                       | 128/1014 [00:01<00:12, 71.77batch/s] 14%|███▋                       | 137/1014 [00:01<00:12, 72.21batch/s] 14%|███▉                       | 147/1014 [00:02<00:11, 73.23batch/s] 15%|████▏                      | 157/1014 [00:02<00:11, 73.36batch/s] 16%|████▍                      | 167/1014 [00:02<00:11, 72.82batch/s] 17%|████▋                      | 177/1014 [00:02<00:11, 72.73batch/s] 18%|████▉                      | 187/1014 [00:02<00:11, 72.95batch/s] 19%|█████▏                     | 197/1014 [00:02<00:11, 73.52batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 73.55batch/s] 21%|█████▊                     | 217/1014 [00:02<00:10, 73.70batch/s] 22%|██████                     | 227/1014 [00:03<00:10, 73.54batch/s] 23%|██████▎                    | 237/1014 [00:03<00:10, 73.63batch/s] 24%|██████▌                    | 247/1014 [00:03<00:10, 73.71batch/s] 25%|██████▊                    | 257/1014 [00:03<00:10, 73.41batch/s] 26%|███████                    | 267/1014 [00:03<00:10, 73.40batch/s] 27%|███████▍                   | 277/1014 [00:03<00:10, 73.27batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 73.19batch/s] 29%|███████▉                   | 297/1014 [00:04<00:09, 73.69batch/s] 30%|████████▏                  | 307/1014 [00:04<00:09, 73.69batch/s] 31%|████████▍                  | 317/1014 [00:04<00:09, 73.61batch/s] 32%|████████▋                  | 327/1014 [00:04<00:09, 73.46batch/s] 33%|████████▉                  | 337/1014 [00:04<00:09, 73.41batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:09, 73.86batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 74.21batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 73.86batch/s] 37%|██████████                 | 377/1014 [00:05<00:08, 73.87batch/s] 38%|██████████▎                | 387/1014 [00:05<00:08, 73.85batch/s] 39%|██████████▌                | 397/1014 [00:05<00:08, 74.00batch/s] 40%|██████████▊                | 407/1014 [00:05<00:08, 73.85batch/s] 41%|███████████                | 417/1014 [00:05<00:08, 73.66batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 73.57batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 73.72batch/s] 44%|███████████▉               | 447/1014 [00:06<00:07, 73.55batch/s] 45%|████████████▏              | 457/1014 [00:06<00:07, 73.93batch/s] 46%|████████████▍              | 467/1014 [00:06<00:07, 74.12batch/s] 47%|████████████▋              | 477/1014 [00:06<00:07, 74.29batch/s] 48%|████████████▉              | 487/1014 [00:06<00:07, 74.17batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 74.18batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 74.13batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 73.96batch/s] 52%|██████████████             | 527/1014 [00:07<00:06, 73.97batch/s] 53%|██████████████▎            | 537/1014 [00:07<00:06, 74.05batch/s] 54%|██████████████▌            | 547/1014 [00:07<00:06, 74.09batch/s] 55%|██████████████▊            | 557/1014 [00:07<00:06, 74.28batch/s] 56%|███████████████            | 567/1014 [00:07<00:06, 74.43batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 74.59batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 74.54batch/s] 59%|███████████████▉           | 597/1014 [00:08<00:05, 74.60batch/s] 60%|████████████████▏          | 607/1014 [00:08<00:05, 74.73batch/s] 61%|████████████████▍          | 617/1014 [00:08<00:05, 74.97batch/s] 62%|████████████████▋          | 627/1014 [00:08<00:05, 75.06batch/s] 63%|████████████████▉          | 637/1014 [00:08<00:05, 75.10batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 75.05batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 75.15batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 75.13batch/s] 67%|██████████████████         | 677/1014 [00:09<00:04, 75.18batch/s] 68%|██████████████████▎        | 687/1014 [00:09<00:04, 75.07batch/s] 69%|██████████████████▌        | 697/1014 [00:09<00:04, 75.07batch/s] 70%|██████████████████▊        | 707/1014 [00:09<00:04, 75.13batch/s] 71%|███████████████████        | 717/1014 [00:09<00:03, 75.15batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 75.07batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 75.17batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 75.36batch/s] 75%|████████████████████▏      | 757/1014 [00:10<00:03, 75.46batch/s] 76%|████████████████████▍      | 767/1014 [00:10<00:03, 75.44batch/s] 77%|████████████████████▋      | 777/1014 [00:10<00:03, 75.44batch/s] 78%|████████████████████▉      | 787/1014 [00:10<00:03, 75.56batch/s] 79%|█████████████████████▏     | 797/1014 [00:10<00:02, 75.52batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 75.54batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 75.62batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 75.62batch/s] 83%|██████████████████████▎    | 837/1014 [00:11<00:02, 75.61batch/s] 84%|██████████████████████▌    | 847/1014 [00:11<00:02, 75.66batch/s] 85%|██████████████████████▊    | 857/1014 [00:11<00:02, 75.30batch/s] 86%|███████████████████████    | 867/1014 [00:11<00:01, 75.32batch/s] 86%|███████████████████████▎   | 877/1014 [00:11<00:01, 75.35batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 75.33batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 75.40batch/s] 89%|████████████████████████▏  | 907/1014 [00:12<00:01, 75.42batch/s] 90%|████████████████████████▍  | 917/1014 [00:12<00:01, 75.48batch/s] 91%|████████████████████████▋  | 927/1014 [00:12<00:01, 75.43batch/s] 92%|████████████████████████▉  | 937/1014 [00:12<00:01, 75.41batch/s] 93%|█████████████████████████▏ | 947/1014 [00:12<00:00, 75.51batch/s] 94%|█████████████████████████▍ | 957/1014 [00:12<00:00, 75.42batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 75.54batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 75.59batch/s] 97%|██████████████████████████▎| 987/1014 [00:13<00:00, 75.55batch/s] 98%|██████████████████████████▌| 997/1014 [00:13<00:00, 75.59batch/s] 99%|█████████████████████████▊| 1007/1014 [00:13<00:00, 75.70batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.57batch/s]
Validation 58 -> LOSS = 1.14
Validation 58 -> BLEU = 55.97, 76.8/61.2/50.2/41.6 (BP=1.000, ratio=1.004, hyp_len=14444, ref_len=14382)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 59
Epoch 59 - update      27690 => loss:   0.517 (#OOM: 0)
Epoch 59 - update      27720 => loss:   0.554 (#OOM: 0)
Epoch 59 - update      27750 => loss:   0.486 (#OOM: 0)
Epoch 59 - update      27780 => loss:   0.369 (#OOM: 0)
Epoch 59 - update      27810 => loss:   0.404 (#OOM: 0)
Epoch 59 - update      27840 => loss:   0.839 (#OOM: 0)
Epoch 59 - update      27870 => loss:   0.643 (#OOM: 0)
Epoch 59 - update      27900 => loss:   0.643 (#OOM: 0)
Epoch 59 - update      27930 => loss:   0.694 (#OOM: 0)
Epoch 59 - update      27960 => loss:   0.550 (#OOM: 0)
Epoch 59 - update      27990 => loss:   0.532 (#OOM: 0)
Epoch 59 - update      28020 => loss:   0.573 (#OOM: 0)
Epoch 59 - update      28050 => loss:   0.361 (#OOM: 0)
Epoch 59 - update      28080 => loss:   0.688 (#OOM: 0)
Epoch 59 - update      28110 => loss:   0.505 (#OOM: 0)
Epoch 59 - update      28140 => loss:   0.539 (#OOM: 0)
--> Epoch 59 finished with mean loss 0.59666
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (803 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.83batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 49.64batch/s] 43%|████████████▊                 | 15/35 [00:00<00:00, 49.55batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 48.82batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 49.82batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 50.62batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.68batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 6/1014 [00:00<00:17, 57.06batch/s]  1%|▍                           | 14/1014 [00:00<00:15, 65.88batch/s]  2%|▌                           | 22/1014 [00:00<00:14, 67.16batch/s]  3%|▊                           | 30/1014 [00:00<00:15, 64.57batch/s]  4%|█                           | 38/1014 [00:00<00:14, 66.30batch/s]  5%|█▎                          | 47/1014 [00:00<00:13, 69.29batch/s]  6%|█▌                          | 56/1014 [00:00<00:13, 69.76batch/s]  6%|█▊                          | 65/1014 [00:00<00:13, 69.58batch/s]  7%|██                          | 74/1014 [00:01<00:13, 70.52batch/s]  8%|██▎                         | 83/1014 [00:01<00:12, 72.02batch/s]  9%|██▌                         | 92/1014 [00:01<00:12, 72.56batch/s] 10%|██▋                        | 101/1014 [00:01<00:12, 72.76batch/s] 11%|██▉                        | 110/1014 [00:01<00:12, 72.13batch/s] 12%|███▏                       | 119/1014 [00:01<00:12, 72.16batch/s] 13%|███▍                       | 128/1014 [00:01<00:12, 71.42batch/s] 14%|███▋                       | 137/1014 [00:01<00:12, 72.14batch/s] 14%|███▉                       | 146/1014 [00:02<00:12, 72.32batch/s] 15%|████▏                      | 155/1014 [00:02<00:11, 72.30batch/s] 16%|████▎                      | 164/1014 [00:02<00:11, 72.66batch/s] 17%|████▌                      | 173/1014 [00:02<00:11, 72.56batch/s] 18%|████▊                      | 182/1014 [00:02<00:11, 72.96batch/s] 19%|█████                      | 191/1014 [00:02<00:11, 72.98batch/s] 20%|█████▎                     | 200/1014 [00:02<00:11, 73.08batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 73.79batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 74.56batch/s] 23%|██████                     | 230/1014 [00:03<00:10, 74.82batch/s] 24%|██████▍                    | 240/1014 [00:03<00:10, 75.29batch/s] 25%|██████▋                    | 250/1014 [00:03<00:10, 75.85batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 75.78batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 75.41batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 75.39batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 75.37batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 75.14batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 75.34batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 75.65batch/s] 33%|████████▊                  | 330/1014 [00:04<00:09, 75.90batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 75.82batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 75.74batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 75.90batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 75.36batch/s] 37%|██████████                 | 380/1014 [00:05<00:08, 75.41batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 75.59batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 75.42batch/s] 40%|██████████▉                | 410/1014 [00:05<00:08, 75.37batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 75.47batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 75.35batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 75.20batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 75.17batch/s] 45%|████████████▏              | 460/1014 [00:06<00:07, 75.49batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 75.41batch/s] 47%|████████████▊              | 480/1014 [00:06<00:07, 75.39batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 75.53batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 75.77batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 75.92batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 75.96batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 75.81batch/s] 53%|██████████████▍            | 540/1014 [00:07<00:06, 75.76batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:06, 75.89batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 76.00batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 76.07batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 76.19batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 76.01batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 76.08batch/s] 60%|████████████████▏          | 610/1014 [00:08<00:05, 75.94batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 75.90batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:05, 75.74batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 75.99batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 76.06batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 76.04batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 76.01batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 75.99batch/s] 68%|██████████████████▎        | 690/1014 [00:09<00:04, 76.00batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 75.94batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:04, 75.87batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 75.84batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 75.93batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 76.02batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 75.87batch/s] 75%|████████████████████▏      | 760/1014 [00:10<00:03, 75.90batch/s] 76%|████████████████████▌      | 770/1014 [00:10<00:03, 75.99batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 75.95batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 76.05batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 76.07batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 76.10batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 76.08batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 76.12batch/s] 83%|██████████████████████▎    | 840/1014 [00:11<00:02, 76.00batch/s] 84%|██████████████████████▋    | 850/1014 [00:11<00:02, 76.08batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:02, 75.99batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 75.89batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 75.81batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 75.87batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 75.86batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 75.92batch/s] 91%|████████████████████████▍  | 920/1014 [00:12<00:01, 75.95batch/s] 92%|████████████████████████▊  | 930/1014 [00:12<00:01, 75.94batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 75.89batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 75.77batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 75.93batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 75.94batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 75.86batch/s] 98%|██████████████████████████▎| 990/1014 [00:13<00:00, 75.89batch/s] 99%|█████████████████████████▋| 1000/1014 [00:13<00:00, 75.89batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 75.99batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 75.64batch/s]
Validation 59 -> LOSS = 1.14
Validation 59 -> BLEU = 56.13, 77.0/61.3/50.4/41.7 (BP=1.000, ratio=1.002, hyp_len=14410, ref_len=14382)
** Learning rate changed -> 1.5625e-06
Early stopping patience: 1
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 60
Epoch 60 - update      28170 => loss:   0.448 (#OOM: 0)
Epoch 60 - update      28200 => loss:   0.824 (#OOM: 0)
Epoch 60 - update      28230 => loss:   0.496 (#OOM: 0)
Epoch 60 - update      28260 => loss:   0.641 (#OOM: 0)
Epoch 60 - update      28290 => loss:   0.445 (#OOM: 0)
Epoch 60 - update      28320 => loss:   0.439 (#OOM: 0)
Epoch 60 - update      28350 => loss:   0.697 (#OOM: 0)
Epoch 60 - update      28380 => loss:   0.730 (#OOM: 0)
Epoch 60 - update      28410 => loss:   0.487 (#OOM: 0)
Epoch 60 - update      28440 => loss:   0.623 (#OOM: 0)
Epoch 60 - update      28470 => loss:   0.510 (#OOM: 0)
Epoch 60 - update      28500 => loss:   0.809 (#OOM: 0)
Epoch 60 - update      28530 => loss:   0.566 (#OOM: 0)
Epoch 60 - update      28560 => loss:   0.758 (#OOM: 0)
Epoch 60 - update      28590 => loss:   0.611 (#OOM: 0)
Epoch 60 - update      28620 => loss:   0.549 (#OOM: 0)
--> Epoch 60 finished with mean loss 0.59659
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (856 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.11batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 48.33batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 48.67batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 47.10batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 49.68batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 50.51batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 72.85batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 71.95batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 77.91batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.98batch/s]  5%|█▎                          | 46/1014 [00:00<00:12, 77.32batch/s]  6%|█▌                          | 56/1014 [00:00<00:12, 76.10batch/s]  7%|█▊                          | 66/1014 [00:00<00:12, 76.74batch/s]  7%|██                          | 76/1014 [00:00<00:12, 76.87batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 75.70batch/s]  9%|██▋                         | 96/1014 [00:01<00:12, 75.82batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 75.49batch/s] 11%|███                        | 116/1014 [00:01<00:11, 75.32batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 74.42batch/s] 13%|███▌                       | 136/1014 [00:01<00:11, 74.11batch/s] 14%|███▉                       | 146/1014 [00:01<00:11, 75.02batch/s] 15%|████▏                      | 156/1014 [00:02<00:11, 75.40batch/s] 16%|████▍                      | 166/1014 [00:02<00:11, 75.27batch/s] 17%|████▋                      | 176/1014 [00:02<00:11, 76.01batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 75.82batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 76.36batch/s] 20%|█████▍                     | 206/1014 [00:02<00:10, 76.37batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 76.30batch/s] 22%|██████                     | 226/1014 [00:02<00:10, 76.02batch/s] 23%|██████▎                    | 236/1014 [00:03<00:10, 76.12batch/s] 24%|██████▌                    | 246/1014 [00:03<00:10, 75.80batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 76.02batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 75.52batch/s] 27%|███████▎                   | 276/1014 [00:03<00:09, 75.93batch/s] 28%|███████▌                   | 286/1014 [00:03<00:09, 75.64batch/s] 29%|███████▉                   | 296/1014 [00:03<00:09, 75.55batch/s] 30%|████████▏                  | 306/1014 [00:04<00:09, 75.30batch/s] 31%|████████▍                  | 316/1014 [00:04<00:09, 75.28batch/s] 32%|████████▋                  | 326/1014 [00:04<00:09, 75.25batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 75.39batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 75.79batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 75.82batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:08, 76.00batch/s] 37%|██████████                 | 376/1014 [00:04<00:08, 76.13batch/s] 38%|██████████▎                | 386/1014 [00:05<00:08, 76.01batch/s] 39%|██████████▌                | 396/1014 [00:05<00:08, 75.68batch/s] 40%|██████████▊                | 406/1014 [00:05<00:08, 75.66batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 75.79batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 75.93batch/s] 43%|███████████▌               | 436/1014 [00:05<00:07, 75.70batch/s] 44%|███████████▉               | 446/1014 [00:05<00:07, 75.75batch/s] 45%|████████████▏              | 456/1014 [00:06<00:07, 75.82batch/s] 46%|████████████▍              | 466/1014 [00:06<00:07, 75.69batch/s] 47%|████████████▋              | 476/1014 [00:06<00:07, 75.87batch/s] 48%|████████████▉              | 486/1014 [00:06<00:06, 76.14batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 76.21batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 76.06batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 75.98batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 75.73batch/s] 53%|██████████████▎            | 536/1014 [00:07<00:06, 75.56batch/s] 54%|██████████████▌            | 546/1014 [00:07<00:06, 75.60batch/s] 55%|██████████████▊            | 556/1014 [00:07<00:06, 75.63batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 75.60batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 75.68batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 75.51batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 75.33batch/s] 60%|████████████████▏          | 606/1014 [00:08<00:05, 75.29batch/s] 61%|████████████████▍          | 616/1014 [00:08<00:05, 75.30batch/s] 62%|████████████████▋          | 626/1014 [00:08<00:05, 75.39batch/s] 63%|████████████████▉          | 636/1014 [00:08<00:05, 75.38batch/s] 64%|█████████████████▏         | 646/1014 [00:08<00:04, 75.52batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 75.45batch/s] 66%|█████████████████▋         | 666/1014 [00:08<00:04, 75.47batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 75.48batch/s] 68%|██████████████████▎        | 686/1014 [00:09<00:04, 75.49batch/s] 69%|██████████████████▌        | 696/1014 [00:09<00:04, 75.53batch/s] 70%|██████████████████▊        | 706/1014 [00:09<00:04, 75.44batch/s] 71%|███████████████████        | 716/1014 [00:09<00:03, 75.43batch/s] 72%|███████████████████▎       | 726/1014 [00:09<00:03, 75.44batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 75.45batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 75.47batch/s] 75%|████████████████████▏      | 756/1014 [00:10<00:03, 75.48batch/s] 76%|████████████████████▍      | 766/1014 [00:10<00:03, 75.63batch/s] 77%|████████████████████▋      | 776/1014 [00:10<00:03, 75.74batch/s] 78%|████████████████████▉      | 786/1014 [00:10<00:03, 75.74batch/s] 79%|█████████████████████▏     | 796/1014 [00:10<00:02, 75.89batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 76.03batch/s] 80%|█████████████████████▋     | 816/1014 [00:10<00:02, 76.13batch/s] 81%|█████████████████████▉     | 826/1014 [00:10<00:02, 76.02batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 76.01batch/s] 83%|██████████████████████▌    | 846/1014 [00:11<00:02, 76.14batch/s] 84%|██████████████████████▊    | 856/1014 [00:11<00:02, 76.11batch/s] 85%|███████████████████████    | 866/1014 [00:11<00:01, 76.14batch/s] 86%|███████████████████████▎   | 876/1014 [00:11<00:01, 76.20batch/s] 87%|███████████████████████▌   | 886/1014 [00:11<00:01, 76.22batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 76.11batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 76.22batch/s] 90%|████████████████████████▍  | 916/1014 [00:11<00:01, 76.35batch/s] 91%|████████████████████████▋  | 926/1014 [00:12<00:01, 76.29batch/s] 92%|████████████████████████▉  | 936/1014 [00:12<00:01, 76.30batch/s] 93%|█████████████████████████▏ | 946/1014 [00:12<00:00, 76.41batch/s] 94%|█████████████████████████▍ | 956/1014 [00:12<00:00, 76.47batch/s] 95%|█████████████████████████▋ | 966/1014 [00:12<00:00, 76.39batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 76.62batch/s] 97%|██████████████████████████▎| 988/1014 [00:12<00:00, 76.48batch/s] 99%|██████████████████████████▌| 999/1014 [00:13<00:00, 76.35batch/s]100%|█████████████████████████▉| 1010/1014 [00:13<00:00, 76.33batch/s]100%|██████████████████████████| 1014/1014 [00:13<00:00, 76.30batch/s]
Validation 60 -> LOSS = 1.14
Validation 60 -> BLEU = 56.32, 77.4/61.7/50.6/42.0 (BP=0.998, ratio=0.998, hyp_len=14354, ref_len=14382)
Early stopping patience: 0
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Starting Epoch 61
Early stopped.
--> This is model: simultaneouswaitknmt-r6cbf8
--> Best LOSS so far: 1.14 @ validation 38
--> Best BLEU so far: 56.47 @ validation 50
Training finished on 03-06-2020 03:42
Wed Jun  3 03:42:42 2020       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 435.21       Driver Version: 435.21       CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  TITAN Xp            On   | 00000000:1B:00.0 Off |                  N/A |
| 30%   48C    P0    63W / 250W |      0MiB / 12196MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
 03:42:42 up 14 days, 18:32,  2 users,  load average: 14.52, 15.30, 15.45
