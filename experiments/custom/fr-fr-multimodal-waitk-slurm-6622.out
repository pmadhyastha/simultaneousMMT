-------
[train]
-------
         num_workers:0
          pin_memory:False
                seed:1590425487
               gclip:1
              l2_reg:1e-05
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
          model_type:SimultaneousWaitKNMT
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:64
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:
                de-bpe
             de-hyphen
     eval_batch_size:32
           eval_freq:0
        eval_max_len:100
          eval_start:1
           eval_zero:False
   save_best_metrics:True
           save_path:/homes/al4616/experiments/simnmt/nmtpy/bpe_models/fr-fr
    save_optim_state:False
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/homes/al4616/experiments/simnmt/nmtpy/bpe_models/fr-fr/tb_dir
     pretrained_file:
   pretrained_layers:
       freeze_layers:
          handle_oom:False
           subfolder:fr-fr-multimodal-w2bpe-wait5
              exp_id:simultaneouswaitknmt-r341d4
------
[vars]
------
                  sl:en
                  tl:fr
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             enc_dim:320
   enc_bidirectional:False
             dec_dim:320
             emb_dim:200
         dropout_emb:0.4
         dropout_ctx:0.5
         dropout_out:0.5
          n_encoders:2
            tied_emb:2way
             max_len:None
           out_logic:deep
           direction:src:Text, image:Numpy -> trg:Text
        sampler_type:bucket
           bucket_by:src
     translator_args:
                     k:5
         aux_dropout:0.5
        aux_proj_dim:320
      aux_proj_activ:tanh
             aux_dim:2048
       dec_inp_activ:None
        mm_fusion_op:sum
   mm_fusion_dropout:0.0
------
[data]
------
            txt_root:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr
            img_root:/vol/bitbucket/al4616/simmt/data/resnet50-256x256
           train_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.fr
                 image:/vol/bitbucket/al4616/simmt/data/resnet50-256x256/train-resnet50-res5c_relu-r256-c256-l2norm.npy
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.bpe.fr
             val_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.fr
                 image:/vol/bitbucket/al4616/simmt/data/resnet50-256x256/val-resnet50-res5c_relu-r256-c256-l2norm.npy
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.bpe.fr
test_2016_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.fr
                 image:/vol/bitbucket/al4616/simmt/data/resnet50-256x256/test_2016_flickr-resnet50-res5c_relu-r256-c256-l2norm.npy
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.bpe.fr
test_2017_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.fr
                 image:/vol/bitbucket/al4616/simmt/data/resnet50-256x256/test_2017_flickr-resnet50-res5c_relu-r256-c256-l2norm.npy
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.bpe.fr
------------
[vocabulary]
------------
                 src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.fr
                 trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.bpe.vocab.fr
----------------------------------------------------------------------

Python 3.7.7 -- torch 1.4.0 with CUDA 10.1 (on machine 'cloud-vm-40-190.doc.ic.ac.uk')
nmtpytorch 4.1.0
DeviceManager(cuda:0, n_gpu=1)
Seed for further reproducibility: 1590425487
SLURM Job ID: 6622
Loading dataset(s)
Initializing dataset for 'src'...
Dataset src with revert = False
0sents [00:00, ?sents/s]8423sents [00:00, 84200.77sents/s]23029sents [00:00, 115125.62sents/s]29000sents [00:00, 119213.12sents/s]
Initializing dataset for 'image'...
Dataset image with revert = False
Initializing dataset for 'trg'...
Dataset trg with revert = False
0sents [00:00, ?sents/s]9794sents [00:00, 97909.98sents/s]23134sents [00:00, 115590.05sents/s]29000sents [00:00, 118078.99sents/s]
MultimodalDataset - (2 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'train.lc.norm.tok.fr' (29000 sentences)
    --> NumpyDataset 'train-resnet50-res5c_relu-r256-c256-l2norm.npy' (29000 samples)

  Targets:
    --> TextDataset 'train.lc.norm.tok.bpe.fr' (29000 sentences)

Initializing dataset for 'src'...
Dataset src with revert = False
0sents [00:00, ?sents/s]1014sents [00:00, 123179.66sents/s]
Initializing dataset for 'image'...
Dataset image with revert = False
Initializing dataset for 'trg'...
Dataset trg with revert = False
0sents [00:00, ?sents/s]1014sents [00:00, 95135.31sents/s]
MultimodalDataset - (2 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.fr' (1014 sentences)
    --> NumpyDataset 'val-resnet50-res5c_relu-r256-c256-l2norm.npy' (1014 samples)

  Targets:
    --> TextDataset 'val.lc.norm.tok.bpe.fr' (1014 sentences)

Initializing dataset for 'src'...
Dataset src with revert = False
0sents [00:00, ?sents/s]1014sents [00:00, 13412.50sents/s]
Initializing dataset for 'image'...
Dataset image with revert = False
Skipping 'trg' as target
MultimodalDataset - (2 source(s) / 0 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.fr' (1014 sentences)
    --> NumpyDataset 'val-resnet50-res5c_relu-r256-c256-l2norm.npy' (1014 samples)


Ignoring batch_size 32 for simultaneous greedy search
SimultaneousWaitKNMT(
  (encoders): ModuleDict(
    (image): VisualFeaturesEncoder(
      (output): Sequential(
        (0): FF(in_features=2048, out_features=320, activ=tanh, bias=True, bias_zero=True)
        (1): Dropout(p=0.5, inplace=False)
      )
    )
    (src): TextEncoder(
      (do_emb): Dropout(p=0.4, inplace=False)
      (emb): Embedding(11048, 200, padding_idx=0)
      (enc): GRU(200, 320, num_layers=2)
      (output): Sequential(
        (0): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (dec): SimultaneousConditionalDecoder(
    (emb): Embedding(5874, 200, padding_idx=0)
    (att): ModuleDict(
      (image): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
      (src): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
    )
    (fusion): Sequential(
      (0): Fusion(type=sum, adaptor=<function Fusion.__init__.<locals>.<lambda> at 0x7f0ca019b5f0>, activ=None)
    )
    (dec0): GRUCell(200, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.5, inplace=False)
    (hid2out): FF(in_features=840, out_features=200, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=200, out_features=5874, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss()
  )
)
Vocabulary of 11048 items ('train.lc.norm.tok.vocab.fr')
Vocabulary of 5874 items ('train.lc.norm.tok.bpe.vocab.fr')
# parameters: 7.06M (7.06M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 1e-05, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Training started on 25-05-2020 17:51:44
Starting Epoch 1
Epoch 1 - update         30 => loss:   6.373 (#OOM: 0)
Epoch 1 - update         60 => loss:   5.555 (#OOM: 0)
Epoch 1 - update         90 => loss:   5.945 (#OOM: 0)
Epoch 1 - update        120 => loss:   4.389 (#OOM: 0)
Epoch 1 - update        150 => loss:   4.135 (#OOM: 0)
Epoch 1 - update        180 => loss:   4.314 (#OOM: 0)
Epoch 1 - update        210 => loss:   4.038 (#OOM: 0)
Epoch 1 - update        240 => loss:   3.585 (#OOM: 0)
Epoch 1 - update        270 => loss:   3.388 (#OOM: 0)
Epoch 1 - update        300 => loss:   3.694 (#OOM: 0)
Epoch 1 - update        330 => loss:   3.145 (#OOM: 0)
Epoch 1 - update        360 => loss:   3.132 (#OOM: 0)
Epoch 1 - update        390 => loss:   3.535 (#OOM: 0)
Epoch 1 - update        420 => loss:   3.047 (#OOM: 0)
Epoch 1 - update        450 => loss:   3.193 (#OOM: 0)
Epoch 1 - update        480 => loss:   2.699 (#OOM: 0)
--> Epoch 1 finished with mean loss 4.22172
--> Overhead/Training/Evaluation: 0.67/0.74/0.00 mins (total: 1.41 mins)   (656 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.93batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.75batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 13.14batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.22batch/s] 32%|█████████▋                    | 11/34 [00:00<00:02, 11.40batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.12batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 12.52batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.18batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.57batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.75batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 12.41batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 12.86batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.26batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.18batch/s]  1%|▏                            | 8/1014 [00:00<00:31, 32.23batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 34.11batch/s]  2%|▍                           | 16/1014 [00:00<00:30, 32.68batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 33.70batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.60batch/s]  3%|▊                           | 29/1014 [00:00<00:27, 35.25batch/s]  3%|▉                           | 34/1014 [00:00<00:27, 36.14batch/s]  4%|█                           | 39/1014 [00:01<00:26, 36.19batch/s]  4%|█▏                          | 44/1014 [00:01<00:26, 37.16batch/s]  5%|█▎                          | 49/1014 [00:01<00:26, 37.08batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 36.61batch/s]  6%|█▋                          | 59/1014 [00:01<00:25, 36.86batch/s]  6%|█▊                          | 64/1014 [00:01<00:25, 37.39batch/s]  7%|█▉                          | 69/1014 [00:01<00:25, 37.63batch/s]  7%|██                          | 74/1014 [00:01<00:25, 37.41batch/s]  8%|██▏                         | 79/1014 [00:02<00:25, 37.40batch/s]  8%|██▎                         | 84/1014 [00:02<00:24, 37.70batch/s]  9%|██▍                         | 89/1014 [00:02<00:24, 37.74batch/s]  9%|██▌                         | 95/1014 [00:02<00:23, 38.35batch/s] 10%|██▋                        | 101/1014 [00:02<00:23, 38.10batch/s] 11%|██▊                        | 107/1014 [00:02<00:23, 37.95batch/s] 11%|███                        | 113/1014 [00:02<00:23, 37.80batch/s] 12%|███▏                       | 119/1014 [00:03<00:23, 37.66batch/s] 12%|███▎                       | 125/1014 [00:03<00:23, 37.77batch/s] 13%|███▍                       | 131/1014 [00:03<00:23, 37.69batch/s] 14%|███▋                       | 137/1014 [00:03<00:23, 37.68batch/s] 14%|███▊                       | 143/1014 [00:03<00:23, 37.78batch/s] 15%|███▉                       | 149/1014 [00:03<00:22, 37.74batch/s] 15%|████▏                      | 155/1014 [00:04<00:22, 37.72batch/s] 16%|████▎                      | 161/1014 [00:04<00:22, 37.69batch/s] 16%|████▍                      | 167/1014 [00:04<00:22, 37.60batch/s] 17%|████▌                      | 173/1014 [00:04<00:22, 37.76batch/s] 18%|████▊                      | 179/1014 [00:04<00:22, 37.65batch/s] 18%|████▉                      | 185/1014 [00:04<00:22, 37.64batch/s] 19%|█████                      | 191/1014 [00:05<00:21, 37.84batch/s] 19%|█████▏                     | 197/1014 [00:05<00:21, 37.91batch/s] 20%|█████▍                     | 203/1014 [00:05<00:21, 38.00batch/s] 21%|█████▌                     | 209/1014 [00:05<00:21, 38.01batch/s] 21%|█████▋                     | 215/1014 [00:05<00:21, 37.96batch/s] 22%|█████▉                     | 221/1014 [00:05<00:20, 37.94batch/s] 22%|██████                     | 227/1014 [00:05<00:20, 37.84batch/s] 23%|██████▏                    | 233/1014 [00:06<00:20, 37.78batch/s] 24%|██████▎                    | 239/1014 [00:06<00:20, 37.73batch/s] 24%|██████▌                    | 245/1014 [00:06<00:20, 37.75batch/s] 25%|██████▋                    | 251/1014 [00:06<00:20, 37.79batch/s] 25%|██████▊                    | 257/1014 [00:06<00:20, 37.81batch/s] 26%|███████                    | 263/1014 [00:06<00:19, 37.75batch/s] 27%|███████▏                   | 269/1014 [00:07<00:19, 37.68batch/s] 27%|███████▎                   | 275/1014 [00:07<00:19, 37.75batch/s] 28%|███████▍                   | 281/1014 [00:07<00:19, 37.75batch/s] 28%|███████▋                   | 287/1014 [00:07<00:19, 37.80batch/s] 29%|███████▊                   | 293/1014 [00:07<00:19, 37.67batch/s] 29%|███████▉                   | 299/1014 [00:07<00:18, 37.64batch/s] 30%|████████                   | 305/1014 [00:08<00:18, 37.63batch/s] 31%|████████▎                  | 311/1014 [00:08<00:18, 37.50batch/s] 31%|████████▍                  | 317/1014 [00:08<00:18, 37.57batch/s] 32%|████████▌                  | 323/1014 [00:08<00:18, 37.59batch/s] 32%|████████▊                  | 329/1014 [00:08<00:18, 37.69batch/s] 33%|████████▉                  | 335/1014 [00:08<00:18, 37.66batch/s] 34%|█████████                  | 341/1014 [00:09<00:17, 37.57batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:17, 37.55batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:17, 37.59batch/s] 35%|█████████▌                 | 359/1014 [00:09<00:17, 37.47batch/s] 36%|█████████▋                 | 365/1014 [00:09<00:17, 37.31batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:17, 36.84batch/s] 37%|██████████                 | 377/1014 [00:10<00:17, 36.86batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 36.68batch/s] 38%|██████████▎                | 389/1014 [00:10<00:17, 36.71batch/s] 39%|██████████▌                | 395/1014 [00:10<00:16, 36.73batch/s] 40%|██████████▋                | 401/1014 [00:10<00:16, 36.56batch/s] 40%|██████████▊                | 407/1014 [00:11<00:16, 36.43batch/s] 41%|██████████▉                | 413/1014 [00:11<00:16, 36.44batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 36.45batch/s] 42%|███████████▎               | 425/1014 [00:11<00:16, 36.43batch/s] 43%|███████████▍               | 431/1014 [00:11<00:16, 36.44batch/s] 43%|███████████▋               | 437/1014 [00:11<00:15, 36.45batch/s] 44%|███████████▊               | 443/1014 [00:12<00:15, 36.34batch/s] 44%|███████████▉               | 449/1014 [00:12<00:15, 36.30batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 36.33batch/s] 45%|████████████▎              | 461/1014 [00:12<00:15, 36.25batch/s] 46%|████████████▍              | 467/1014 [00:12<00:15, 36.16batch/s] 47%|████████████▌              | 473/1014 [00:13<00:14, 36.14batch/s] 47%|████████████▊              | 479/1014 [00:13<00:14, 35.94batch/s] 48%|████████████▉              | 485/1014 [00:13<00:14, 35.86batch/s] 48%|█████████████              | 491/1014 [00:13<00:14, 35.81batch/s] 49%|█████████████▏             | 497/1014 [00:13<00:14, 35.75batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.68batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.64batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:13, 35.69batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:13, 35.47batch/s] 52%|██████████████             | 527/1014 [00:14<00:13, 35.39batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 35.38batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.28batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.28batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 35.18batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:13, 35.13batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:12, 35.00batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.99batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.95batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.94batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 34.89batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.82batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.79batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.64batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.77batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.78batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 34.79batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.77batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.76batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.78batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.81batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.80batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.82batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.86batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.85batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.94batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.97batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.99batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 35.03batch/s] 69%|██████████████████▋        | 701/1014 [00:19<00:08, 35.12batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 35.12batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 35.12batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.12batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.17batch/s] 72%|███████████████████▍       | 731/1014 [00:20<00:08, 35.12batch/s] 73%|███████████████████▌       | 737/1014 [00:20<00:07, 35.13batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 35.18batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.15batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.15batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 35.13batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:07, 35.16batch/s] 76%|████████████████████▌      | 773/1014 [00:21<00:06, 35.19batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.22batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.21batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 35.21batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 35.22batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:05, 35.22batch/s] 80%|█████████████████████▌     | 809/1014 [00:22<00:05, 35.18batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 35.18batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 35.22batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 35.21batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.22batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.24batch/s] 83%|██████████████████████▌    | 845/1014 [00:23<00:04, 35.24batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 35.21batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 35.21batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 35.20batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.24batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.30batch/s] 87%|███████████████████████▍   | 881/1014 [00:24<00:03, 35.29batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 35.31batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 35.32batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.35batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.41batch/s] 90%|████████████████████████▎  | 911/1014 [00:25<00:02, 35.38batch/s] 90%|████████████████████████▍  | 917/1014 [00:25<00:02, 35.37batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 35.39batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.42batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.44batch/s] 93%|█████████████████████████  | 941/1014 [00:26<00:02, 35.42batch/s] 93%|█████████████████████████▏ | 947/1014 [00:26<00:01, 35.45batch/s] 94%|█████████████████████████▍ | 953/1014 [00:26<00:01, 35.45batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.48batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.46batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 35.49batch/s] 96%|██████████████████████████ | 977/1014 [00:27<00:01, 35.50batch/s] 97%|██████████████████████████▏| 983/1014 [00:27<00:00, 35.51batch/s] 98%|██████████████████████████▎| 989/1014 [00:27<00:00, 35.50batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 35.50batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 35.47batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 35.50batch/s]100%|█████████████████████████▉| 1013/1014 [00:28<00:00, 35.45batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.45batch/s]
Validation 1 -> LOSS = 2.71
Validation 1 -> BLEU = 29.35, 70.0/39.9/23.3/14.1 (BP=0.948, ratio=0.949, hyp_len=13652, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 2.71 @ validation 1
--> Best BLEU so far: 29.35 @ validation 1
Starting Epoch 2
Epoch 2 - update        510 => loss:   2.331 (#OOM: 0)
Epoch 2 - update        540 => loss:   2.443 (#OOM: 0)
Epoch 2 - update        570 => loss:   3.092 (#OOM: 0)
Epoch 2 - update        600 => loss:   2.813 (#OOM: 0)
Epoch 2 - update        630 => loss:   2.841 (#OOM: 0)
Epoch 2 - update        660 => loss:   3.024 (#OOM: 0)
Epoch 2 - update        690 => loss:   2.608 (#OOM: 0)
Epoch 2 - update        720 => loss:   2.618 (#OOM: 0)
Epoch 2 - update        750 => loss:   2.405 (#OOM: 0)
Epoch 2 - update        780 => loss:   2.563 (#OOM: 0)
Epoch 2 - update        810 => loss:   2.586 (#OOM: 0)
Epoch 2 - update        840 => loss:   2.242 (#OOM: 0)
Epoch 2 - update        870 => loss:   2.234 (#OOM: 0)
Epoch 2 - update        900 => loss:   2.182 (#OOM: 0)
Epoch 2 - update        930 => loss:   1.891 (#OOM: 0)
Epoch 2 - update        960 => loss:   2.654 (#OOM: 0)
--> Epoch 2 finished with mean loss 2.54815
--> Overhead/Training/Evaluation: 0.67/0.74/0.00 mins (total: 1.41 mins)   (651 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  7.79batch/s]  6%|█▊                             | 2/34 [00:00<00:04,  7.77batch/s] 12%|███▋                           | 4/34 [00:00<00:03,  9.96batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 10.26batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.73batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.18batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.69batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.78batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.08batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.67batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.91batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.53batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.36batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.20batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 2/1014 [00:00<01:30, 11.14batch/s]  0%|                             | 4/1014 [00:00<01:12, 13.94batch/s]  1%|▏                            | 7/1014 [00:00<00:56, 17.81batch/s]  1%|▎                           | 11/1014 [00:00<00:45, 22.24batch/s]  1%|▍                           | 15/1014 [00:00<00:42, 23.59batch/s]  2%|▌                           | 19/1014 [00:00<00:40, 24.71batch/s]  2%|▋                           | 24/1014 [00:00<00:36, 27.30batch/s]  3%|▊                           | 29/1014 [00:01<00:34, 28.97batch/s]  3%|▉                           | 34/1014 [00:01<00:33, 29.36batch/s]  4%|█                           | 39/1014 [00:01<00:32, 29.66batch/s]  4%|█▏                          | 44/1014 [00:01<00:31, 31.00batch/s]  5%|█▎                          | 49/1014 [00:01<00:30, 31.49batch/s]  5%|█▍                          | 54/1014 [00:01<00:30, 31.47batch/s]  6%|█▋                          | 59/1014 [00:01<00:30, 31.54batch/s]  6%|█▊                          | 64/1014 [00:02<00:29, 31.95batch/s]  7%|█▉                          | 69/1014 [00:02<00:29, 32.03batch/s]  7%|██                          | 74/1014 [00:02<00:29, 31.88batch/s]  8%|██▏                         | 79/1014 [00:02<00:29, 32.18batch/s]  8%|██▎                         | 84/1014 [00:02<00:28, 32.64batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 33.06batch/s]  9%|██▌                         | 94/1014 [00:02<00:27, 33.35batch/s] 10%|██▋                         | 99/1014 [00:02<00:27, 33.35batch/s] 10%|██▊                        | 104/1014 [00:03<00:27, 33.38batch/s] 11%|██▉                        | 109/1014 [00:03<00:26, 33.78batch/s] 11%|███                        | 114/1014 [00:03<00:26, 33.99batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 34.21batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 34.39batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.26batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.10batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 34.09batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 33.80batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 33.55batch/s] 15%|████                       | 154/1014 [00:04<00:25, 33.63batch/s] 16%|████▏                      | 159/1014 [00:04<00:25, 33.90batch/s] 16%|████▎                      | 164/1014 [00:04<00:25, 33.94batch/s] 17%|████▌                      | 169/1014 [00:05<00:25, 33.09batch/s] 17%|████▋                      | 174/1014 [00:05<00:25, 33.05batch/s] 18%|████▊                      | 179/1014 [00:05<00:25, 33.07batch/s] 18%|████▉                      | 184/1014 [00:05<00:25, 33.11batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 33.26batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 33.30batch/s] 20%|█████▎                     | 199/1014 [00:05<00:24, 33.42batch/s] 20%|█████▍                     | 205/1014 [00:06<00:23, 33.71batch/s] 21%|█████▌                     | 211/1014 [00:06<00:23, 33.82batch/s] 21%|█████▊                     | 217/1014 [00:06<00:23, 33.86batch/s] 22%|█████▉                     | 223/1014 [00:06<00:23, 33.84batch/s] 23%|██████                     | 229/1014 [00:06<00:23, 33.89batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 33.92batch/s] 24%|██████▍                    | 241/1014 [00:07<00:22, 34.03batch/s] 24%|██████▌                    | 247/1014 [00:07<00:22, 34.05batch/s] 25%|██████▋                    | 253/1014 [00:07<00:22, 34.12batch/s] 26%|██████▉                    | 259/1014 [00:07<00:22, 34.14batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.11batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.02batch/s] 27%|███████▍                   | 277/1014 [00:08<00:21, 34.16batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 34.09batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.22batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 34.20batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 34.13batch/s] 30%|████████▏                  | 307/1014 [00:08<00:20, 34.19batch/s] 31%|████████▎                  | 313/1014 [00:09<00:20, 34.34batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.40batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 34.42batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 34.37batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 34.37batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:19, 34.37batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.43batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.49batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 34.53batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.63batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 34.72batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 34.78batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.68batch/s] 39%|██████████▍                | 391/1014 [00:11<00:17, 34.68batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 34.79batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 34.87batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.94batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 34.71batch/s] 42%|███████████▏               | 421/1014 [00:12<00:17, 34.76batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 34.71batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 34.83batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.80batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.84batch/s] 44%|████████████               | 451/1014 [00:12<00:16, 34.86batch/s] 45%|████████████▏              | 457/1014 [00:13<00:15, 34.84batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 34.90batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.87batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.85batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 34.95batch/s] 48%|████████████▉              | 487/1014 [00:13<00:15, 34.97batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:14, 35.01batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.12batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.17batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 35.22batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 35.29batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.34batch/s] 52%|██████████████             | 529/1014 [00:14<00:13, 35.40batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 35.40batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 35.45batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 35.36batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 35.36batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.37batch/s] 56%|███████████████            | 565/1014 [00:15<00:12, 35.40batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 35.39batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 35.40batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.34batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.37batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.37batch/s] 59%|████████████████           | 601/1014 [00:16<00:11, 35.36batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 35.38batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.36batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.33batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:10, 35.40batch/s] 62%|████████████████▊          | 631/1014 [00:17<00:10, 35.38batch/s] 63%|████████████████▉          | 637/1014 [00:17<00:10, 35.41batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.45batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.51batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.46batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:09, 35.36batch/s] 66%|█████████████████▊         | 667/1014 [00:18<00:09, 35.12batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.15batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.17batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.16batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 35.15batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:09, 35.13batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 35.18batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.17batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.22batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 35.24batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 35.29batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:07, 35.26batch/s] 73%|███████████████████▋       | 739/1014 [00:20<00:07, 35.34batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.36batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 35.39batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 35.36batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.42batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.42batch/s] 76%|████████████████████▋      | 775/1014 [00:21<00:06, 35.43batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.43batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.45batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.49batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.49batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.47batch/s] 80%|█████████████████████▌     | 811/1014 [00:22<00:05, 35.51batch/s] 81%|█████████████████████▊     | 817/1014 [00:22<00:05, 35.56batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.59batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.63batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.64batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.67batch/s] 84%|██████████████████████▌    | 847/1014 [00:23<00:04, 35.71batch/s] 84%|██████████████████████▋    | 853/1014 [00:23<00:04, 35.77batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.75batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.69batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.71batch/s] 86%|███████████████████████▎   | 877/1014 [00:24<00:03, 35.74batch/s] 87%|███████████████████████▌   | 883/1014 [00:24<00:03, 35.74batch/s] 88%|███████████████████████▋   | 889/1014 [00:24<00:03, 35.76batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.73batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.75batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:02, 35.71batch/s] 90%|████████████████████████▎  | 913/1014 [00:25<00:02, 35.58batch/s] 91%|████████████████████████▍  | 919/1014 [00:25<00:02, 35.57batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.56batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.54batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.54batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.49batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.49batch/s] 94%|█████████████████████████▍ | 955/1014 [00:26<00:01, 35.53batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.54batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.51batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.55batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.56batch/s] 97%|██████████████████████████▏| 985/1014 [00:27<00:00, 35.57batch/s] 98%|██████████████████████████▍| 991/1014 [00:27<00:00, 35.56batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.59batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.60batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.62batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.60batch/s]
Validation 2 -> LOSS = 1.82
Validation 2 -> BLEU = 50.42, 77.4/57.0/43.6/33.6 (BP=1.000, ratio=1.008, hyp_len=14490, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 1.82 @ validation 2
--> Best BLEU so far: 50.42 @ validation 2
Starting Epoch 3
Epoch 3 - update        990 => loss:   1.940 (#OOM: 0)
Epoch 3 - update       1020 => loss:   1.989 (#OOM: 0)
Epoch 3 - update       1050 => loss:   1.836 (#OOM: 0)
Epoch 3 - update       1080 => loss:   1.946 (#OOM: 0)
Epoch 3 - update       1110 => loss:   1.957 (#OOM: 0)
Epoch 3 - update       1140 => loss:   1.920 (#OOM: 0)
Epoch 3 - update       1170 => loss:   1.759 (#OOM: 0)
Epoch 3 - update       1200 => loss:   1.713 (#OOM: 0)
Epoch 3 - update       1230 => loss:   1.899 (#OOM: 0)
Epoch 3 - update       1260 => loss:   1.596 (#OOM: 0)
Epoch 3 - update       1290 => loss:   1.740 (#OOM: 0)
Epoch 3 - update       1320 => loss:   1.622 (#OOM: 0)
Epoch 3 - update       1350 => loss:   1.647 (#OOM: 0)
Epoch 3 - update       1380 => loss:   1.626 (#OOM: 0)
Epoch 3 - update       1410 => loss:   1.328 (#OOM: 0)
Epoch 3 - update       1440 => loss:   1.468 (#OOM: 0)
--> Epoch 3 finished with mean loss 1.84620
--> Overhead/Training/Evaluation: 0.66/0.75/0.00 mins (total: 1.41 mins)   (647 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.08batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 12.22batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 10.52batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 11.26batch/s] 26%|████████▏                      | 9/34 [00:00<00:02, 11.83batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.35batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 11.67batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.62batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.73batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.55batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.06batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.26batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.11batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.66batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.66batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:23, 42.24batch/s]  1%|▎                           | 10/1014 [00:00<00:26, 37.81batch/s]  1%|▍                           | 15/1014 [00:00<00:26, 37.19batch/s]  2%|▌                           | 20/1014 [00:00<00:26, 37.65batch/s]  2%|▋                           | 25/1014 [00:00<00:25, 38.80batch/s]  3%|▊                           | 30/1014 [00:00<00:24, 39.82batch/s]  3%|▉                           | 35/1014 [00:00<00:25, 38.82batch/s]  4%|█                           | 40/1014 [00:01<00:25, 38.15batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 37.24batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.33batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.17batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 35.58batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 35.57batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 35.07batch/s]  7%|██                          | 75/1014 [00:02<00:26, 35.13batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.60batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.14batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 36.27batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 36.41batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 36.50batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 36.52batch/s] 11%|██▉                        | 110/1014 [00:03<00:24, 36.57batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.77batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 36.53batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 36.50batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 36.41batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 36.38batch/s] 14%|███▋                       | 140/1014 [00:03<00:23, 36.47batch/s] 14%|███▊                       | 145/1014 [00:03<00:23, 36.44batch/s] 15%|███▉                       | 150/1014 [00:04<00:23, 36.35batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 36.33batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 36.21batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 36.23batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 36.23batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 36.30batch/s] 18%|████▊                      | 180/1014 [00:04<00:23, 36.22batch/s] 18%|████▉                      | 185/1014 [00:05<00:22, 36.34batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 36.39batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 36.32batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 36.52batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 36.55batch/s] 21%|█████▌                     | 210/1014 [00:05<00:21, 36.58batch/s] 21%|█████▋                     | 215/1014 [00:05<00:21, 36.61batch/s] 22%|█████▊                     | 220/1014 [00:06<00:21, 36.54batch/s] 22%|█████▉                     | 225/1014 [00:06<00:21, 36.62batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 36.53batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 36.52batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 36.47batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 36.27batch/s] 25%|██████▋                    | 250/1014 [00:06<00:21, 36.32batch/s] 25%|██████▊                    | 255/1014 [00:07<00:20, 36.39batch/s] 26%|██████▉                    | 260/1014 [00:07<00:20, 36.30batch/s] 26%|███████                    | 265/1014 [00:07<00:20, 36.40batch/s] 27%|███████▏                   | 270/1014 [00:07<00:20, 35.84batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.80batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.77batch/s] 28%|███████▌                   | 285/1014 [00:07<00:20, 35.79batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.81batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.88batch/s] 30%|███████▉                   | 300/1014 [00:08<00:19, 35.89batch/s] 30%|████████                   | 305/1014 [00:08<00:19, 35.99batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 35.97batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.93batch/s] 32%|████████▌                  | 320/1014 [00:08<00:19, 35.99batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.99batch/s] 33%|████████▊                  | 330/1014 [00:09<00:18, 36.06batch/s] 33%|████████▉                  | 335/1014 [00:09<00:18, 36.08batch/s] 34%|█████████                  | 340/1014 [00:09<00:18, 36.09batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:18, 36.14batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 36.17batch/s] 35%|█████████▍                 | 355/1014 [00:09<00:18, 36.21batch/s] 36%|█████████▌                 | 360/1014 [00:09<00:18, 36.18batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:17, 36.24batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:17, 36.25batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:17, 36.20batch/s] 37%|██████████                 | 380/1014 [00:10<00:17, 36.29batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 36.26batch/s] 38%|██████████▍                | 390/1014 [00:10<00:17, 36.23batch/s] 39%|██████████▌                | 395/1014 [00:10<00:17, 36.25batch/s] 39%|██████████▋                | 400/1014 [00:11<00:16, 36.26batch/s] 40%|██████████▊                | 405/1014 [00:11<00:16, 36.24batch/s] 40%|██████████▉                | 410/1014 [00:11<00:16, 36.24batch/s] 41%|███████████                | 415/1014 [00:11<00:16, 36.28batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 36.24batch/s] 42%|███████████▎               | 425/1014 [00:11<00:16, 36.25batch/s] 42%|███████████▍               | 430/1014 [00:11<00:16, 36.19batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 36.19batch/s] 43%|███████████▋               | 440/1014 [00:12<00:15, 36.24batch/s] 44%|███████████▊               | 445/1014 [00:12<00:15, 36.19batch/s] 44%|███████████▉               | 450/1014 [00:12<00:15, 36.24batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 36.21batch/s] 45%|████████████▏              | 460/1014 [00:12<00:15, 36.16batch/s] 46%|████████████▍              | 465/1014 [00:12<00:15, 36.17batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 36.04batch/s] 47%|████████████▋              | 475/1014 [00:13<00:14, 36.02batch/s] 47%|████████████▊              | 480/1014 [00:13<00:14, 36.04batch/s] 48%|████████████▉              | 485/1014 [00:13<00:14, 36.11batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 36.02batch/s] 49%|█████████████▏             | 495/1014 [00:13<00:14, 36.03batch/s] 49%|█████████████▎             | 500/1014 [00:13<00:14, 36.08batch/s] 50%|█████████████▍             | 505/1014 [00:13<00:14, 36.08batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:13, 36.05batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:13, 36.07batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:13, 36.10batch/s] 52%|█████████████▉             | 525/1014 [00:14<00:13, 36.09batch/s] 52%|██████████████             | 530/1014 [00:14<00:13, 36.16batch/s] 53%|██████████████▏            | 535/1014 [00:14<00:13, 36.10batch/s] 53%|██████████████▍            | 540/1014 [00:14<00:13, 36.12batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:12, 36.10batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:12, 36.14batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:12, 36.13batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 36.10batch/s] 56%|███████████████            | 565/1014 [00:15<00:12, 36.11batch/s] 56%|███████████████▏           | 570/1014 [00:15<00:12, 36.14batch/s] 57%|███████████████▎           | 575/1014 [00:15<00:12, 36.14batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 36.14batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:11, 36.11batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:11, 36.03batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 36.02batch/s] 59%|███████████████▉           | 600/1014 [00:16<00:11, 35.95batch/s] 60%|████████████████           | 605/1014 [00:16<00:11, 35.99batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.72batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 35.74batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.77batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:10, 35.75batch/s] 62%|████████████████▊          | 630/1014 [00:17<00:10, 35.80batch/s] 63%|████████████████▉          | 635/1014 [00:17<00:10, 35.83batch/s] 63%|█████████████████          | 640/1014 [00:17<00:10, 35.88batch/s] 64%|█████████████████▏         | 645/1014 [00:17<00:10, 35.91batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.90batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.88batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:09, 35.86batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 35.83batch/s] 66%|█████████████████▊         | 670/1014 [00:18<00:09, 35.79batch/s] 67%|█████████████████▉         | 675/1014 [00:18<00:09, 35.83batch/s] 67%|██████████████████         | 680/1014 [00:18<00:09, 35.86batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.86batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 35.81batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:08, 35.81batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.76batch/s] 70%|██████████████████▊        | 705/1014 [00:19<00:08, 35.78batch/s] 70%|██████████████████▉        | 710/1014 [00:19<00:08, 35.80batch/s] 71%|███████████████████        | 715/1014 [00:19<00:08, 35.81batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.83batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.80batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:07, 35.78batch/s] 72%|███████████████████▌       | 735/1014 [00:20<00:07, 35.81batch/s] 73%|███████████████████▋       | 740/1014 [00:20<00:07, 35.77batch/s] 73%|███████████████████▊       | 745/1014 [00:20<00:07, 35.76batch/s] 74%|███████████████████▉       | 750/1014 [00:20<00:07, 35.75batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.78batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.79batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:06, 35.80batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.80batch/s] 76%|████████████████████▋      | 775/1014 [00:21<00:06, 35.81batch/s] 77%|████████████████████▊      | 780/1014 [00:21<00:06, 35.78batch/s] 77%|████████████████████▉      | 785/1014 [00:21<00:06, 35.80batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.82batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 35.83batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:05, 35.79batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.78batch/s] 80%|█████████████████████▌     | 810/1014 [00:22<00:05, 35.76batch/s] 80%|█████████████████████▋     | 815/1014 [00:22<00:05, 35.77batch/s] 81%|█████████████████████▊     | 820/1014 [00:22<00:05, 35.72batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 35.76batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.77batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:04, 35.81batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.78batch/s] 83%|██████████████████████▌    | 845/1014 [00:23<00:04, 35.76batch/s] 84%|██████████████████████▋    | 850/1014 [00:23<00:04, 35.80batch/s] 84%|██████████████████████▊    | 855/1014 [00:23<00:04, 35.75batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 35.76batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.75batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.78batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.78batch/s] 87%|███████████████████████▍   | 880/1014 [00:24<00:03, 35.79batch/s] 87%|███████████████████████▌   | 885/1014 [00:24<00:03, 35.81batch/s] 88%|███████████████████████▋   | 890/1014 [00:24<00:03, 35.76batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.74batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.75batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.79batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.77batch/s] 90%|████████████████████████▎  | 915/1014 [00:25<00:02, 35.75batch/s] 91%|████████████████████████▍  | 920/1014 [00:25<00:02, 35.75batch/s] 91%|████████████████████████▋  | 925/1014 [00:25<00:02, 35.79batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 35.77batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.77batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.75batch/s] 93%|█████████████████████████▏ | 945/1014 [00:26<00:01, 35.75batch/s] 94%|█████████████████████████▎ | 950/1014 [00:26<00:01, 35.78batch/s] 94%|█████████████████████████▍ | 955/1014 [00:26<00:01, 35.81batch/s] 95%|█████████████████████████▌ | 960/1014 [00:26<00:01, 35.83batch/s] 95%|█████████████████████████▋ | 965/1014 [00:26<00:01, 35.86batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.86batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 35.87batch/s] 97%|██████████████████████████ | 980/1014 [00:27<00:00, 35.88batch/s] 97%|██████████████████████████▏| 985/1014 [00:27<00:00, 35.88batch/s] 98%|██████████████████████████▎| 990/1014 [00:27<00:00, 35.87batch/s] 98%|██████████████████████████▍| 995/1014 [00:27<00:00, 35.88batch/s] 99%|█████████████████████████▋| 1000/1014 [00:27<00:00, 35.90batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 35.88batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 35.89batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.90batch/s]
Validation 3 -> LOSS = 1.22
Validation 3 -> BLEU = 69.83, 87.3/74.6/65.2/57.1 (BP=0.995, ratio=0.995, hyp_len=14311, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 1.22 @ validation 3
--> Best BLEU so far: 69.83 @ validation 3
Starting Epoch 4
Epoch 4 - update       1470 => loss:   1.440 (#OOM: 0)
Epoch 4 - update       1500 => loss:   1.759 (#OOM: 0)
Epoch 4 - update       1530 => loss:   1.300 (#OOM: 0)
Epoch 4 - update       1560 => loss:   1.454 (#OOM: 0)
Epoch 4 - update       1590 => loss:   1.501 (#OOM: 0)
Epoch 4 - update       1620 => loss:   1.377 (#OOM: 0)
Epoch 4 - update       1650 => loss:   1.393 (#OOM: 0)
Epoch 4 - update       1680 => loss:   1.229 (#OOM: 0)
Epoch 4 - update       1710 => loss:   1.158 (#OOM: 0)
Epoch 4 - update       1740 => loss:   1.432 (#OOM: 0)
Epoch 4 - update       1770 => loss:   1.246 (#OOM: 0)
Epoch 4 - update       1800 => loss:   1.287 (#OOM: 0)
Epoch 4 - update       1830 => loss:   1.246 (#OOM: 0)
Epoch 4 - update       1860 => loss:   1.040 (#OOM: 0)
Epoch 4 - update       1890 => loss:   1.178 (#OOM: 0)
Epoch 4 - update       1920 => loss:   1.125 (#OOM: 0)
--> Epoch 4 finished with mean loss 1.34523
--> Overhead/Training/Evaluation: 0.67/0.72/0.00 mins (total: 1.39 mins)   (669 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 17.24batch/s] 15%|████▌                          | 5/34 [00:00<00:01, 16.10batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 14.58batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 15.56batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.31batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.75batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.70batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.26batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.78batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.44batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.46batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.57batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.34batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 34.71batch/s]  1%|▎                           | 12/1014 [00:00<00:27, 36.19batch/s]  2%|▍                           | 17/1014 [00:00<00:26, 38.06batch/s]  2%|▌                           | 22/1014 [00:00<00:25, 39.19batch/s]  3%|▋                           | 27/1014 [00:00<00:25, 38.56batch/s]  3%|▉                           | 32/1014 [00:00<00:25, 38.21batch/s]  4%|█                           | 37/1014 [00:00<00:26, 37.57batch/s]  4%|█▏                          | 42/1014 [00:01<00:26, 37.33batch/s]  5%|█▎                          | 47/1014 [00:01<00:26, 37.09batch/s]  5%|█▍                          | 52/1014 [00:01<00:25, 37.26batch/s]  6%|█▌                          | 57/1014 [00:01<00:25, 36.94batch/s]  6%|█▋                          | 62/1014 [00:01<00:25, 37.61batch/s]  7%|█▊                          | 67/1014 [00:01<00:25, 37.06batch/s]  7%|█▉                          | 72/1014 [00:01<00:25, 37.51batch/s]  8%|██▏                         | 77/1014 [00:02<00:25, 37.31batch/s]  8%|██▎                         | 82/1014 [00:02<00:25, 36.68batch/s]  9%|██▍                         | 87/1014 [00:02<00:25, 36.68batch/s]  9%|██▌                         | 92/1014 [00:02<00:25, 36.68batch/s] 10%|██▋                         | 97/1014 [00:02<00:25, 36.54batch/s] 10%|██▋                        | 102/1014 [00:02<00:25, 36.30batch/s] 11%|██▊                        | 107/1014 [00:02<00:25, 36.08batch/s] 11%|██▉                        | 112/1014 [00:03<00:24, 36.37batch/s] 12%|███                        | 117/1014 [00:03<00:24, 36.32batch/s] 12%|███▏                       | 122/1014 [00:03<00:24, 36.40batch/s] 13%|███▍                       | 127/1014 [00:03<00:24, 36.23batch/s] 13%|███▌                       | 132/1014 [00:03<00:24, 36.40batch/s] 14%|███▋                       | 137/1014 [00:03<00:24, 36.47batch/s] 14%|███▊                       | 142/1014 [00:03<00:24, 36.19batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 36.08batch/s] 15%|████                       | 152/1014 [00:04<00:24, 35.86batch/s] 15%|████▏                      | 157/1014 [00:04<00:23, 36.08batch/s] 16%|████▎                      | 162/1014 [00:04<00:23, 35.94batch/s] 16%|████▍                      | 167/1014 [00:04<00:23, 35.64batch/s] 17%|████▌                      | 172/1014 [00:04<00:23, 35.70batch/s] 17%|████▋                      | 177/1014 [00:04<00:23, 35.55batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 35.25batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 35.31batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 35.15batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 35.23batch/s] 20%|█████▍                     | 202/1014 [00:05<00:22, 35.37batch/s] 20%|█████▌                     | 207/1014 [00:05<00:22, 35.31batch/s] 21%|█████▋                     | 212/1014 [00:06<00:22, 35.31batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 35.22batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 35.21batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 35.27batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 35.19batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 35.24batch/s] 24%|██████▍                    | 242/1014 [00:06<00:21, 35.30batch/s] 24%|██████▌                    | 247/1014 [00:07<00:21, 35.19batch/s] 25%|██████▋                    | 252/1014 [00:07<00:21, 35.14batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 35.18batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 35.13batch/s] 26%|███████                    | 267/1014 [00:07<00:21, 35.22batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 35.11batch/s] 27%|███████▍                   | 277/1014 [00:07<00:20, 35.15batch/s] 28%|███████▌                   | 282/1014 [00:07<00:20, 35.29batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.34batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.32batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 35.24batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 35.30batch/s] 30%|████████▏                  | 307/1014 [00:08<00:19, 35.35batch/s] 31%|████████▎                  | 312/1014 [00:08<00:20, 34.94batch/s] 31%|████████▍                  | 317/1014 [00:09<00:19, 34.96batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 34.91batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 34.97batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 34.85batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 34.83batch/s] 34%|█████████                  | 342/1014 [00:09<00:19, 34.86batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:19, 34.85batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:18, 34.88batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 34.89batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 34.98batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 35.06batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 35.13batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 35.16batch/s] 38%|██████████▏                | 382/1014 [00:10<00:17, 35.15batch/s] 38%|██████████▎                | 387/1014 [00:11<00:17, 35.17batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 35.17batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 35.11batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 35.04batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 35.05batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 35.08batch/s] 41%|███████████                | 417/1014 [00:11<00:17, 35.09batch/s] 42%|███████████▏               | 422/1014 [00:12<00:16, 35.12batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 35.23batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 35.27batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 35.28batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 35.32batch/s] 44%|███████████▉               | 447/1014 [00:12<00:16, 35.26batch/s] 45%|████████████               | 452/1014 [00:12<00:15, 35.14batch/s] 45%|████████████▏              | 457/1014 [00:12<00:15, 35.21batch/s] 46%|████████████▎              | 462/1014 [00:13<00:15, 35.24batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 35.13batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.14batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 35.18batch/s] 48%|████████████▊              | 482/1014 [00:13<00:15, 35.19batch/s] 48%|████████████▉              | 487/1014 [00:13<00:15, 35.13batch/s] 49%|█████████████              | 492/1014 [00:13<00:14, 35.15batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 35.06batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 35.14batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 35.24batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 35.21batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 35.18batch/s] 51%|█████████████▉             | 522/1014 [00:14<00:13, 35.24batch/s] 52%|██████████████             | 527/1014 [00:14<00:13, 35.29batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 34.94batch/s] 53%|██████████████▎            | 537/1014 [00:15<00:13, 34.97batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 35.02batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 35.04batch/s] 54%|██████████████▋            | 552/1014 [00:15<00:13, 35.09batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:13, 35.10batch/s] 55%|██████████████▉            | 562/1014 [00:16<00:12, 35.12batch/s] 56%|███████████████            | 567/1014 [00:16<00:12, 35.19batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 35.20batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 35.23batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 35.18batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 35.29batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.24batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 35.20batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 35.18batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 35.21batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 35.21batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 35.22batch/s] 62%|████████████████▊          | 630/1014 [00:17<00:10, 35.21batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:10, 35.19batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 35.22batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 35.23batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.23batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 35.26batch/s] 66%|█████████████████▋         | 666/1014 [00:18<00:09, 35.28batch/s] 66%|█████████████████▉         | 672/1014 [00:19<00:09, 35.29batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 35.35batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.34batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 35.33batch/s] 69%|██████████████████▌        | 696/1014 [00:19<00:08, 35.36batch/s] 69%|██████████████████▋        | 702/1014 [00:19<00:08, 35.39batch/s] 70%|██████████████████▊        | 708/1014 [00:19<00:08, 35.41batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.40batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.39batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 35.40batch/s] 72%|███████████████████▍       | 732/1014 [00:20<00:07, 35.45batch/s] 73%|███████████████████▋       | 738/1014 [00:20<00:07, 35.47batch/s] 73%|███████████████████▊       | 744/1014 [00:20<00:07, 35.49batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 35.53batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 35.54batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 35.51batch/s] 76%|████████████████████▍      | 768/1014 [00:21<00:06, 35.51batch/s] 76%|████████████████████▌      | 774/1014 [00:21<00:06, 35.48batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 35.44batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 35.47batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 35.51batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 35.52batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.51batch/s] 80%|█████████████████████▌     | 810/1014 [00:22<00:05, 35.55batch/s] 80%|█████████████████████▋     | 816/1014 [00:22<00:05, 35.50batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 35.53batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 35.53batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.50batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.50batch/s] 83%|██████████████████████▌    | 846/1014 [00:23<00:04, 35.50batch/s] 84%|██████████████████████▋    | 852/1014 [00:23<00:04, 35.54batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 35.51batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.52batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.54batch/s] 86%|███████████████████████▎   | 876/1014 [00:24<00:03, 35.56batch/s] 87%|███████████████████████▍   | 882/1014 [00:24<00:03, 35.55batch/s] 88%|███████████████████████▋   | 888/1014 [00:24<00:03, 35.56batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.57batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.55batch/s] 89%|████████████████████████   | 906/1014 [00:25<00:03, 35.60batch/s] 90%|████████████████████████▎  | 912/1014 [00:25<00:02, 35.62batch/s] 91%|████████████████████████▍  | 918/1014 [00:25<00:02, 35.64batch/s] 91%|████████████████████████▌  | 924/1014 [00:25<00:02, 35.66batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 35.67batch/s] 92%|████████████████████████▉  | 936/1014 [00:26<00:02, 35.70batch/s] 93%|█████████████████████████  | 942/1014 [00:26<00:02, 35.68batch/s] 93%|█████████████████████████▏ | 948/1014 [00:26<00:01, 35.66batch/s] 94%|█████████████████████████▍ | 954/1014 [00:26<00:01, 35.70batch/s] 95%|█████████████████████████▌ | 960/1014 [00:26<00:01, 35.66batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 35.65batch/s] 96%|█████████████████████████▉ | 972/1014 [00:27<00:01, 35.62batch/s] 96%|██████████████████████████ | 978/1014 [00:27<00:01, 35.64batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.60batch/s] 98%|██████████████████████████▎| 990/1014 [00:27<00:00, 35.64batch/s] 98%|██████████████████████████▌| 996/1014 [00:27<00:00, 35.59batch/s] 99%|█████████████████████████▋| 1002/1014 [00:28<00:00, 35.59batch/s] 99%|█████████████████████████▊| 1008/1014 [00:28<00:00, 35.58batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.61batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.61batch/s]
Validation 4 -> LOSS = 0.89
Validation 4 -> BLEU = 79.66, 91.2/82.8/76.1/70.1 (BP=1.000, ratio=1.005, hyp_len=14450, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.89 @ validation 4
--> Best BLEU so far: 79.66 @ validation 4
Starting Epoch 5
Epoch 5 - update       1950 => loss:   1.012 (#OOM: 0)
Epoch 5 - update       1980 => loss:   0.947 (#OOM: 0)
Epoch 5 - update       2010 => loss:   1.033 (#OOM: 0)
Epoch 5 - update       2040 => loss:   1.049 (#OOM: 0)
Epoch 5 - update       2070 => loss:   0.948 (#OOM: 0)
Epoch 5 - update       2100 => loss:   1.189 (#OOM: 0)
Epoch 5 - update       2130 => loss:   1.183 (#OOM: 0)
Epoch 5 - update       2160 => loss:   0.888 (#OOM: 0)
Epoch 5 - update       2190 => loss:   0.963 (#OOM: 0)
Epoch 5 - update       2220 => loss:   0.956 (#OOM: 0)
Epoch 5 - update       2250 => loss:   1.016 (#OOM: 0)
Epoch 5 - update       2280 => loss:   0.897 (#OOM: 0)
Epoch 5 - update       2310 => loss:   0.977 (#OOM: 0)
Epoch 5 - update       2340 => loss:   1.039 (#OOM: 0)
Epoch 5 - update       2370 => loss:   1.032 (#OOM: 0)
Epoch 5 - update       2400 => loss:   0.846 (#OOM: 0)
--> Epoch 5 finished with mean loss 1.04749
--> Overhead/Training/Evaluation: 0.67/0.73/0.00 mins (total: 1.40 mins)   (664 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  9.69batch/s] 12%|███▋                           | 4/34 [00:00<00:03,  8.51batch/s] 18%|█████▍                         | 6/34 [00:00<00:02,  9.79batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.45batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.00batch/s] 35%|██████████▌                   | 12/34 [00:01<00:02, 10.74batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 10.63batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 10.92batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 11.89batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:01, 11.73batch/s] 74%|██████████████████████        | 25/34 [00:02<00:00, 12.31batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 12.06batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 11.82batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 11.87batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 11.87batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 2/1014 [00:00<01:38, 10.29batch/s]  1%|▏                            | 6/1014 [00:00<00:51, 19.54batch/s]  1%|▎                           | 10/1014 [00:00<00:42, 23.60batch/s]  1%|▍                           | 14/1014 [00:00<00:38, 25.81batch/s]  2%|▍                           | 18/1014 [00:00<00:35, 27.99batch/s]  2%|▌                           | 22/1014 [00:00<00:36, 27.47batch/s]  3%|▋                           | 26/1014 [00:00<00:35, 28.12batch/s]  3%|▊                           | 30/1014 [00:01<00:34, 28.70batch/s]  3%|▉                           | 35/1014 [00:01<00:32, 30.31batch/s]  4%|█                           | 40/1014 [00:01<00:32, 29.81batch/s]  4%|█▏                          | 45/1014 [00:01<00:32, 30.26batch/s]  5%|█▍                          | 50/1014 [00:01<00:31, 30.97batch/s]  5%|█▌                          | 55/1014 [00:01<00:30, 31.01batch/s]  6%|█▋                          | 60/1014 [00:01<00:30, 31.06batch/s]  6%|█▊                          | 65/1014 [00:02<00:30, 31.30batch/s]  7%|█▉                          | 70/1014 [00:02<00:29, 31.95batch/s]  7%|██                          | 75/1014 [00:02<00:29, 32.23batch/s]  8%|██▏                         | 80/1014 [00:02<00:28, 32.54batch/s]  8%|██▎                         | 85/1014 [00:02<00:28, 32.83batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 33.08batch/s]  9%|██▌                         | 95/1014 [00:02<00:27, 33.16batch/s] 10%|██▋                        | 100/1014 [00:03<00:27, 33.12batch/s] 10%|██▊                        | 105/1014 [00:03<00:27, 33.52batch/s] 11%|██▉                        | 110/1014 [00:03<00:27, 33.09batch/s] 11%|███                        | 115/1014 [00:03<00:27, 33.04batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 33.12batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 33.29batch/s] 13%|███▍                       | 130/1014 [00:03<00:26, 33.28batch/s] 13%|███▌                       | 135/1014 [00:04<00:26, 33.46batch/s] 14%|███▋                       | 140/1014 [00:04<00:26, 32.99batch/s] 14%|███▊                       | 145/1014 [00:04<00:26, 32.96batch/s] 15%|███▉                       | 150/1014 [00:04<00:26, 32.78batch/s] 15%|████▏                      | 155/1014 [00:04<00:26, 32.78batch/s] 16%|████▎                      | 160/1014 [00:04<00:26, 32.83batch/s] 16%|████▍                      | 165/1014 [00:05<00:25, 32.92batch/s] 17%|████▌                      | 170/1014 [00:05<00:25, 33.08batch/s] 17%|████▋                      | 175/1014 [00:05<00:25, 33.12batch/s] 18%|████▊                      | 180/1014 [00:05<00:25, 33.17batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 33.34batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 33.61batch/s] 19%|█████▏                     | 195/1014 [00:05<00:24, 33.60batch/s] 20%|█████▎                     | 200/1014 [00:05<00:24, 33.56batch/s] 20%|█████▍                     | 205/1014 [00:06<00:24, 33.48batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 33.53batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 33.49batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 33.37batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 33.38batch/s] 23%|██████                     | 230/1014 [00:06<00:23, 33.43batch/s] 23%|██████▎                    | 235/1014 [00:07<00:23, 33.36batch/s] 24%|██████▍                    | 240/1014 [00:07<00:23, 33.39batch/s] 24%|██████▌                    | 245/1014 [00:07<00:23, 33.39batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 33.26batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 33.30batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 33.24batch/s] 26%|███████                    | 265/1014 [00:07<00:22, 33.36batch/s] 27%|███████▏                   | 270/1014 [00:08<00:22, 33.49batch/s] 27%|███████▎                   | 275/1014 [00:08<00:22, 33.40batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 33.46batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 33.50batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 33.55batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 33.58batch/s] 30%|███████▉                   | 300/1014 [00:08<00:21, 33.67batch/s] 30%|████████                   | 305/1014 [00:09<00:21, 33.64batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 33.57batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 33.71batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 33.71batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 33.66batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 33.79batch/s] 33%|████████▉                  | 335/1014 [00:09<00:20, 33.76batch/s] 34%|█████████                  | 340/1014 [00:10<00:20, 33.69batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 33.71batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 33.81batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 33.78batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 33.74batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:19, 33.76batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:19, 33.73batch/s] 37%|█████████▉                 | 375/1014 [00:11<00:18, 33.65batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 33.75batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 33.75batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 33.84batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 33.75batch/s] 39%|██████████▋                | 400/1014 [00:11<00:18, 33.79batch/s] 40%|██████████▊                | 405/1014 [00:11<00:18, 33.83batch/s] 40%|██████████▉                | 410/1014 [00:12<00:17, 33.88batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 33.89batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 33.91batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.90batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 33.92batch/s] 43%|███████████▌               | 435/1014 [00:12<00:17, 33.92batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.00batch/s] 44%|███████████▊               | 445/1014 [00:13<00:16, 33.96batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 33.94batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.96batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.04batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 34.00batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.05batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 33.99batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 34.05batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.03batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 33.99batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.01batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 33.97batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.03batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.02batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 34.00batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.00batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.00batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.67batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 33.70batch/s] 53%|██████████████▍            | 540/1014 [00:16<00:14, 33.64batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 33.68batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 33.70batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 33.73batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.74batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 33.66batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 33.73batch/s] 57%|███████████████▎           | 575/1014 [00:17<00:13, 33.76batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 33.78batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 33.80batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.81batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 33.86batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 33.90batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 33.90batch/s] 60%|████████████████▏          | 610/1014 [00:18<00:11, 33.87batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 33.93batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 33.86batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 33.88batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 33.86batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 33.88batch/s] 63%|█████████████████          | 640/1014 [00:18<00:11, 33.89batch/s] 64%|█████████████████▏         | 645/1014 [00:19<00:10, 33.91batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 33.92batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 33.92batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 33.96batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.94batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 33.95batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 33.91batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.87batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 33.85batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.80batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 33.79batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 33.76batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 33.72batch/s] 70%|██████████████████▉        | 710/1014 [00:21<00:09, 33.73batch/s] 71%|███████████████████        | 715/1014 [00:21<00:08, 33.76batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 33.76batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 33.76batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 33.81batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 33.84batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:08, 33.83batch/s] 73%|███████████████████▊       | 745/1014 [00:22<00:07, 33.79batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 33.68batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.70batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.71batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 33.70batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.70batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:07, 33.74batch/s] 77%|████████████████████▊      | 780/1014 [00:23<00:06, 33.71batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.67batch/s] 78%|█████████████████████      | 790/1014 [00:23<00:06, 33.65batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 33.65batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 33.64batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 33.65batch/s] 80%|█████████████████████▌     | 810/1014 [00:24<00:06, 33.65batch/s] 80%|█████████████████████▋     | 815/1014 [00:24<00:05, 33.64batch/s] 81%|█████████████████████▊     | 820/1014 [00:24<00:05, 33.60batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 33.61batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 33.65batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 33.67batch/s] 83%|██████████████████████▎    | 840/1014 [00:25<00:05, 33.49batch/s] 83%|██████████████████████▌    | 845/1014 [00:25<00:05, 33.49batch/s] 84%|██████████████████████▋    | 850/1014 [00:25<00:04, 33.47batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 33.49batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 33.46batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 33.42batch/s] 86%|███████████████████████▏   | 870/1014 [00:26<00:04, 33.45batch/s] 86%|███████████████████████▎   | 875/1014 [00:26<00:04, 33.46batch/s] 87%|███████████████████████▍   | 880/1014 [00:26<00:04, 33.46batch/s] 87%|███████████████████████▌   | 885/1014 [00:26<00:03, 33.44batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 33.48batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 33.49batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 33.45batch/s] 89%|████████████████████████   | 905/1014 [00:27<00:03, 33.45batch/s] 90%|████████████████████████▏  | 910/1014 [00:27<00:03, 33.46batch/s] 90%|████████████████████████▎  | 915/1014 [00:27<00:02, 33.46batch/s] 91%|████████████████████████▍  | 920/1014 [00:27<00:02, 33.44batch/s] 91%|████████████████████████▋  | 925/1014 [00:27<00:02, 33.45batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 33.41batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 33.46batch/s] 93%|█████████████████████████  | 940/1014 [00:28<00:02, 33.47batch/s] 93%|█████████████████████████▏ | 945/1014 [00:28<00:02, 33.46batch/s] 94%|█████████████████████████▎ | 950/1014 [00:28<00:01, 33.47batch/s] 94%|█████████████████████████▍ | 955/1014 [00:28<00:01, 33.45batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 33.45batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 33.45batch/s] 96%|█████████████████████████▊ | 970/1014 [00:29<00:01, 33.40batch/s] 96%|█████████████████████████▉ | 975/1014 [00:29<00:01, 33.43batch/s] 97%|██████████████████████████ | 980/1014 [00:29<00:01, 33.45batch/s] 97%|██████████████████████████▏| 985/1014 [00:29<00:00, 33.47batch/s] 98%|██████████████████████████▎| 990/1014 [00:29<00:00, 33.47batch/s] 98%|██████████████████████████▍| 995/1014 [00:29<00:00, 33.41batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 33.41batch/s] 99%|█████████████████████████▊| 1005/1014 [00:30<00:00, 33.38batch/s]100%|█████████████████████████▉| 1010/1014 [00:30<00:00, 33.37batch/s]100%|██████████████████████████| 1014/1014 [00:30<00:00, 33.36batch/s]
Validation 5 -> LOSS = 0.72
Validation 5 -> BLEU = 85.48, 93.8/87.7/82.9/78.3 (BP=1.000, ratio=1.000, hyp_len=14389, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.72 @ validation 5
--> Best BLEU so far: 85.48 @ validation 5
Starting Epoch 6
Epoch 6 - update       2430 => loss:   1.057 (#OOM: 0)
Epoch 6 - update       2460 => loss:   0.771 (#OOM: 0)
Epoch 6 - update       2490 => loss:   0.990 (#OOM: 0)
Epoch 6 - update       2520 => loss:   1.017 (#OOM: 0)
Epoch 6 - update       2550 => loss:   0.657 (#OOM: 0)
Epoch 6 - update       2580 => loss:   0.682 (#OOM: 0)
Epoch 6 - update       2610 => loss:   0.859 (#OOM: 0)
Epoch 6 - update       2640 => loss:   0.932 (#OOM: 0)
Epoch 6 - update       2670 => loss:   0.941 (#OOM: 0)
Epoch 6 - update       2700 => loss:   0.643 (#OOM: 0)
Epoch 6 - update       2730 => loss:   0.871 (#OOM: 0)
Epoch 6 - update       2760 => loss:   0.805 (#OOM: 0)
Epoch 6 - update       2790 => loss:   0.566 (#OOM: 0)
Epoch 6 - update       2820 => loss:   0.947 (#OOM: 0)
Epoch 6 - update       2850 => loss:   0.717 (#OOM: 0)
Epoch 6 - update       2880 => loss:   0.717 (#OOM: 0)
--> Epoch 6 finished with mean loss 0.86676
--> Overhead/Training/Evaluation: 0.65/0.73/0.00 mins (total: 1.39 mins)   (659 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.35batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.02batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.99batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.17batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.35batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.12batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.41batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.43batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.16batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.95batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.15batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.39batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.46batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.46batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:28, 35.29batch/s]  1%|▎                           | 10/1014 [00:00<00:31, 31.40batch/s]  1%|▍                           | 15/1014 [00:00<00:29, 34.22batch/s]  2%|▌                           | 20/1014 [00:00<00:26, 37.02batch/s]  2%|▋                           | 25/1014 [00:00<00:26, 37.06batch/s]  3%|▊                           | 30/1014 [00:00<00:26, 36.98batch/s]  3%|▉                           | 35/1014 [00:00<00:26, 37.20batch/s]  4%|█                           | 40/1014 [00:01<00:26, 37.19batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 37.05batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.81batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.48batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 35.99batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 36.12batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 36.40batch/s]  7%|██                          | 75/1014 [00:02<00:26, 35.92batch/s]  8%|██▏                         | 80/1014 [00:02<00:25, 35.97batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.09batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 35.65batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 35.44batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 35.80batch/s] 10%|██▊                        | 105/1014 [00:02<00:25, 35.77batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 35.82batch/s] 11%|███                        | 115/1014 [00:03<00:25, 35.93batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 35.73batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 35.69batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 35.69batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 35.85batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.64batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.61batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.76batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.73batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 35.84batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 35.85batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 36.03batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.99batch/s] 18%|████▊                      | 180/1014 [00:04<00:23, 36.13batch/s] 18%|████▉                      | 185/1014 [00:05<00:22, 36.11batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 36.03batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 35.94batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.75batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.83batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.92batch/s] 21%|█████▋                     | 215/1014 [00:05<00:22, 35.93batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.84batch/s] 22%|█████▉                     | 225/1014 [00:06<00:21, 35.90batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 35.96batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 35.89batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.93batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.54batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.43batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.47batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.51batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.42batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.39batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.47batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.56batch/s] 28%|███████▌                   | 285/1014 [00:07<00:20, 35.65batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.57batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.34batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 35.23batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 35.06batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 35.09batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.22batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.23batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.07batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.08batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.13batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 35.08batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 35.01batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.92batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 34.93batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.93batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.07batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.03batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.95batch/s] 37%|██████████                 | 380/1014 [00:10<00:18, 34.85batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.89batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 34.85batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.94batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.99batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 35.03batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.03batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 35.00batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.01batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 34.96batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.98batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.91batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.89batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.98batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 34.97batch/s] 45%|████████████               | 455/1014 [00:13<00:15, 35.00batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.09batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 35.16batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 35.21batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 35.15batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 35.19batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 35.16batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.13batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 35.15batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.14batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.19batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 35.21batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 35.19batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 35.13batch/s] 52%|█████████████▉             | 525/1014 [00:14<00:13, 35.13batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 35.10batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 35.10batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 35.07batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.07batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.94batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:13, 34.98batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:12, 34.97batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 34.97batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 35.00batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.03batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.00batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.93batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 34.88batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.87batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.84batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.87batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.80batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.78batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.76batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 34.81batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.74batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.76batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.75batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.70batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.73batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.78batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 34.77batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.74batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.68batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.63batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.67batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.71batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.72batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.74batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.74batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.76batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.77batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.77batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.76batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.77batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 34.82batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.74batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.72batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.72batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.76batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.75batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.74batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.73batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.74batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.75batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.73batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.55batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.52batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 34.56batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.51batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.53batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.54batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.58batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.59batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.61batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.60batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.63batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.48batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.53batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.51batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.52batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.49batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.48batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.49batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.48batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.50batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.50batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.52batch/s] 89%|███████████████████████▉   | 899/1014 [00:26<00:03, 34.55batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.54batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.55batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.53batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.54batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.52batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.55batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.51batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.53batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.52batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.50batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.53batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.51batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.47batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.44batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.47batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.46batch/s] 99%|█████████████████████████▋| 1001/1014 [00:29<00:00, 34.47batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.35batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.33batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.33batch/s]
Validation 6 -> LOSS = 0.63
Validation 6 -> BLEU = 86.86, 93.8/88.8/84.7/80.7 (BP=1.000, ratio=1.013, hyp_len=14573, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.63 @ validation 6
--> Best BLEU so far: 86.86 @ validation 6
Starting Epoch 7
Epoch 7 - update       2910 => loss:   0.892 (#OOM: 0)
Epoch 7 - update       2940 => loss:   0.654 (#OOM: 0)
Epoch 7 - update       2970 => loss:   0.693 (#OOM: 0)
Epoch 7 - update       3000 => loss:   0.550 (#OOM: 0)
Epoch 7 - update       3030 => loss:   0.711 (#OOM: 0)
Epoch 7 - update       3060 => loss:   0.764 (#OOM: 0)
Epoch 7 - update       3090 => loss:   0.805 (#OOM: 0)
Epoch 7 - update       3120 => loss:   0.556 (#OOM: 0)
Epoch 7 - update       3150 => loss:   0.703 (#OOM: 0)
Epoch 7 - update       3180 => loss:   0.689 (#OOM: 0)
Epoch 7 - update       3210 => loss:   0.650 (#OOM: 0)
Epoch 7 - update       3240 => loss:   0.597 (#OOM: 0)
Epoch 7 - update       3270 => loss:   0.810 (#OOM: 0)
Epoch 7 - update       3300 => loss:   0.615 (#OOM: 0)
Epoch 7 - update       3330 => loss:   0.667 (#OOM: 0)
Epoch 7 - update       3360 => loss:   0.670 (#OOM: 0)
--> Epoch 7 finished with mean loss 0.74103
--> Overhead/Training/Evaluation: 0.62/0.73/0.00 mins (total: 1.35 mins)   (666 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.97batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.64batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.73batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.76batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.10batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.75batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.77batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.18batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.33batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.51batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.32batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.51batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.38batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.37batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:35, 28.46batch/s]  1%|▏                            | 7/1014 [00:00<00:30, 33.30batch/s]  1%|▎                           | 11/1014 [00:00<00:31, 31.95batch/s]  1%|▍                           | 15/1014 [00:00<00:30, 33.24batch/s]  2%|▌                           | 19/1014 [00:00<00:29, 33.33batch/s]  2%|▋                           | 23/1014 [00:00<00:30, 32.99batch/s]  3%|▋                           | 27/1014 [00:00<00:29, 33.37batch/s]  3%|▉                           | 32/1014 [00:00<00:28, 34.11batch/s]  4%|█                           | 37/1014 [00:01<00:28, 34.18batch/s]  4%|█▏                          | 42/1014 [00:01<00:29, 33.20batch/s]  5%|█▎                          | 47/1014 [00:01<00:28, 33.99batch/s]  5%|█▍                          | 52/1014 [00:01<00:28, 33.73batch/s]  6%|█▌                          | 57/1014 [00:01<00:28, 33.79batch/s]  6%|█▋                          | 62/1014 [00:01<00:27, 34.29batch/s]  7%|█▊                          | 67/1014 [00:01<00:27, 34.54batch/s]  7%|█▉                          | 72/1014 [00:02<00:27, 34.18batch/s]  8%|██▏                         | 77/1014 [00:02<00:27, 33.90batch/s]  8%|██▎                         | 82/1014 [00:02<00:27, 34.24batch/s]  9%|██▍                         | 87/1014 [00:02<00:27, 33.84batch/s]  9%|██▌                         | 92/1014 [00:02<00:27, 33.40batch/s] 10%|██▋                         | 97/1014 [00:02<00:27, 33.79batch/s] 10%|██▋                        | 102/1014 [00:03<00:26, 33.96batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 34.18batch/s] 11%|██▉                        | 112/1014 [00:03<00:26, 34.15batch/s] 12%|███                        | 117/1014 [00:03<00:26, 34.18batch/s] 12%|███▏                       | 122/1014 [00:03<00:26, 34.28batch/s] 13%|███▍                       | 127/1014 [00:03<00:25, 34.25batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 34.38batch/s] 14%|███▋                       | 137/1014 [00:03<00:25, 34.51batch/s] 14%|███▊                       | 142/1014 [00:04<00:25, 34.63batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 34.87batch/s] 15%|████                       | 152/1014 [00:04<00:24, 34.91batch/s] 15%|████▏                      | 157/1014 [00:04<00:24, 34.84batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.93batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.76batch/s] 17%|████▌                      | 172/1014 [00:04<00:24, 34.62batch/s] 17%|████▋                      | 177/1014 [00:05<00:24, 34.69batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 34.85batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 34.87batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 34.72batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 34.65batch/s] 20%|█████▍                     | 203/1014 [00:05<00:23, 34.97batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.11batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 34.82batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 34.95batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 34.82batch/s] 23%|██████▏                    | 233/1014 [00:06<00:22, 34.93batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 35.03batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.95batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 35.10batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 35.23batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 35.23batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 35.35batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.21batch/s] 28%|███████▍                   | 281/1014 [00:07<00:20, 35.31batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.30batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 35.13batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.34batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 35.34batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 35.16batch/s] 31%|████████▍                  | 317/1014 [00:09<00:19, 35.16batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.31batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.27batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.05batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 35.12batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:18, 35.14batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:18, 35.10batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.13batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.18batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 35.17batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 35.14batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 35.24batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.23batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.81batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 34.85batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.88batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 34.88batch/s] 41%|███████████▏               | 419/1014 [00:11<00:17, 34.94batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 34.92batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 34.95batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 34.89batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.86batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.90batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.90batch/s] 45%|████████████▎              | 461/1014 [00:13<00:15, 34.96batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 34.93batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.97batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.94batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.88batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 34.78batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 34.78batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.78batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.72batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.76batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:14, 34.80batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 34.75batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 34.81batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.83batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.80batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 34.77batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.73batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.69batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.73batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.78batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.79batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 34.79batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.77batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.78batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.73batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.69batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.67batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 34.69batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.71batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.78batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.78batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.75batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.74batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.76batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.75batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.74batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.71batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.70batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.66batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.67batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.65batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.66batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.68batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.66batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.59batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.64batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:07, 34.68batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.68batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.72batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.70batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 34.74batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.67batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.69batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.74batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.75batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.72batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 34.76batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.75batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.81batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.80batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.79batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.76batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 34.77batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.78batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.71batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.71batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.69batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.75batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 34.79batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.80batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.81batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.77batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.74batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.76batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.69batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.67batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.67batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.68batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.67batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.71batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.72batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.70batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.69batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.66batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.63batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.64batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.63batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.65batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.68batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.70batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.69batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.67batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.66batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.66batch/s]
Validation 7 -> LOSS = 0.56
Validation 7 -> BLEU = 89.67, 95.6/91.3/87.8/84.4 (BP=1.000, ratio=1.001, hyp_len=14402, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.56 @ validation 7
--> Best BLEU so far: 89.67 @ validation 7
Starting Epoch 8
Epoch 8 - update       3390 => loss:   0.778 (#OOM: 0)
Epoch 8 - update       3420 => loss:   0.854 (#OOM: 0)
Epoch 8 - update       3450 => loss:   1.124 (#OOM: 0)
Epoch 8 - update       3480 => loss:   0.758 (#OOM: 0)
Epoch 8 - update       3510 => loss:   0.585 (#OOM: 0)
Epoch 8 - update       3540 => loss:   1.488 (#OOM: 0)
Epoch 8 - update       3570 => loss:   0.618 (#OOM: 0)
Epoch 8 - update       3600 => loss:   0.570 (#OOM: 0)
Epoch 8 - update       3630 => loss:   0.493 (#OOM: 0)
Epoch 8 - update       3660 => loss:   0.567 (#OOM: 0)
Epoch 8 - update       3690 => loss:   0.629 (#OOM: 0)
Epoch 8 - update       3720 => loss:   0.500 (#OOM: 0)
Epoch 8 - update       3750 => loss:   0.685 (#OOM: 0)
Epoch 8 - update       3780 => loss:   0.544 (#OOM: 0)
Epoch 8 - update       3810 => loss:   0.766 (#OOM: 0)
Epoch 8 - update       3840 => loss:   0.572 (#OOM: 0)
--> Epoch 8 finished with mean loss 0.65164
--> Overhead/Training/Evaluation: 0.70/0.72/0.00 mins (total: 1.42 mins)   (667 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:03, 10.04batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.71batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.21batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 12.75batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.60batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.74batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.21batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.24batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.75batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 12.34batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 12.59batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.05batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.14batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:37, 27.28batch/s]  1%|▏                            | 7/1014 [00:00<00:34, 29.50batch/s]  1%|▎                           | 11/1014 [00:00<00:32, 30.98batch/s]  1%|▍                           | 15/1014 [00:00<00:30, 32.34batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 32.90batch/s]  2%|▋                           | 25/1014 [00:00<00:29, 33.99batch/s]  3%|▊                           | 30/1014 [00:00<00:28, 34.83batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.84batch/s]  4%|█                           | 40/1014 [00:01<00:28, 34.58batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.09batch/s]  5%|█▍                          | 50/1014 [00:01<00:27, 35.27batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 35.67batch/s]  6%|█▋                          | 60/1014 [00:01<00:27, 35.13batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 34.91batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.89batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.76batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.29batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 35.57batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 35.57batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 35.58batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 35.82batch/s] 10%|██▊                        | 105/1014 [00:02<00:25, 35.90batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 36.05batch/s] 11%|███                        | 115/1014 [00:03<00:25, 35.92batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 35.31batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 35.08batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 35.14batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 35.13batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.94batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.07batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.09batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 33.78batch/s] 16%|████▎                      | 160/1014 [00:04<00:25, 33.82batch/s] 16%|████▍                      | 165/1014 [00:04<00:25, 33.87batch/s] 17%|████▌                      | 170/1014 [00:05<00:24, 33.94batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.07batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.08batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 34.07batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 34.20batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.27batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.29batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.37batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.30batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.26batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.31batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.35batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.38batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.43batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.45batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.49batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.56batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 34.48batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.47batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.64batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.76batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.69batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.70batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 34.70batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.74batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.67batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.65batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.60batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.59batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.54batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.68batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.71batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.80batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.85batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.93batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 34.97batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:18, 34.97batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.53batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 34.36batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.36batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.29batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.18batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.29batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.24batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.33batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 34.37batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.35batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.39batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.42batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 34.37batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.36batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.33batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.37batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.37batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.34batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.25batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.32batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.27batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.17batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 34.17batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.16batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.20batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 34.25batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.28batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.31batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.38batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.45batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.45batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.46batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.47batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.52batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.54batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 34.54batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.52batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.54batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.49batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.50batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.53batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.56batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 34.50batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.50batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.53batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.49batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.55batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.53batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.55batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.57batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.60batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.57batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.55batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.60batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.53batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.53batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.47batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.45batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.37batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.35batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 34.35batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.36batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.35batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 34.40batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.41batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.42batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.39batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 34.45batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.46batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.47batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.47batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.50batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.52batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.47batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.49batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.48batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.45batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.46batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.46batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.42batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.45batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 34.48batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.50batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.47batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.42batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.44batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.46batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.41batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 34.46batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.45batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.44batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.43batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.43batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.40batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.43batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 34.44batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.41batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.43batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.45batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.46batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.46batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.49batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.51batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.51batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.49batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.50batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.48batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.45batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.44batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.49batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.48batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.46batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.47batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.49batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.52batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.51batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.51batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.49batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 34.47batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.46batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.48batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.48batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.48batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.47batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.50batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.50batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.51batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.49batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.47batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.48batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.47batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.44batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.44batch/s]
Validation 8 -> LOSS = 0.50
Validation 8 -> BLEU = 90.42, 95.7/91.9/88.7/85.6 (BP=1.000, ratio=1.006, hyp_len=14464, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.50 @ validation 8
--> Best BLEU so far: 90.42 @ validation 8
Starting Epoch 9
Epoch 9 - update       3870 => loss:   0.664 (#OOM: 0)
Epoch 9 - update       3900 => loss:   0.664 (#OOM: 0)
Epoch 9 - update       3930 => loss:   0.630 (#OOM: 0)
Epoch 9 - update       3960 => loss:   0.570 (#OOM: 0)
Epoch 9 - update       3990 => loss:   0.489 (#OOM: 0)
Epoch 9 - update       4020 => loss:   0.672 (#OOM: 0)
Epoch 9 - update       4050 => loss:   0.606 (#OOM: 0)
Epoch 9 - update       4080 => loss:   0.715 (#OOM: 0)
Epoch 9 - update       4110 => loss:   0.553 (#OOM: 0)
Epoch 9 - update       4140 => loss:   0.649 (#OOM: 0)
Epoch 9 - update       4170 => loss:   0.398 (#OOM: 0)
Epoch 9 - update       4200 => loss:   0.526 (#OOM: 0)
Epoch 9 - update       4230 => loss:   0.512 (#OOM: 0)
Epoch 9 - update       4260 => loss:   0.508 (#OOM: 0)
Epoch 9 - update       4290 => loss:   0.390 (#OOM: 0)
Epoch 9 - update       4320 => loss:   0.545 (#OOM: 0)
--> Epoch 9 finished with mean loss 0.57994
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (672 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.33batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.16batch/s] 12%|███▋                           | 4/34 [00:00<00:03,  9.49batch/s] 18%|█████▍                         | 6/34 [00:00<00:02,  9.86batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.38batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 10.73batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.31batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.83batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.32batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.16batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.32batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.41batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.81batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.56batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.63batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.43batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.56batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:28, 35.93batch/s]  1%|▎                           | 10/1014 [00:00<00:27, 36.10batch/s]  1%|▍                           | 15/1014 [00:00<00:28, 35.34batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 35.38batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 35.14batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 35.18batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.81batch/s]  4%|█                           | 40/1014 [00:01<00:29, 33.49batch/s]  4%|█▏                          | 45/1014 [00:01<00:30, 32.03batch/s]  5%|█▍                          | 50/1014 [00:01<00:31, 30.90batch/s]  5%|█▌                          | 55/1014 [00:01<00:30, 31.04batch/s]  6%|█▋                          | 60/1014 [00:01<00:30, 30.80batch/s]  6%|█▊                          | 65/1014 [00:02<00:30, 30.77batch/s]  7%|█▉                          | 70/1014 [00:02<00:30, 31.37batch/s]  7%|██                          | 75/1014 [00:02<00:29, 32.00batch/s]  8%|██▏                         | 80/1014 [00:02<00:28, 32.27batch/s]  8%|██▎                         | 85/1014 [00:02<00:28, 32.31batch/s]  9%|██▍                         | 90/1014 [00:02<00:28, 31.98batch/s]  9%|██▌                         | 95/1014 [00:03<00:29, 31.63batch/s] 10%|██▋                        | 100/1014 [00:03<00:28, 31.75batch/s] 10%|██▊                        | 105/1014 [00:03<00:28, 31.95batch/s] 11%|██▉                        | 110/1014 [00:03<00:28, 32.14batch/s] 11%|███                        | 115/1014 [00:03<00:28, 32.03batch/s] 12%|███▏                       | 120/1014 [00:03<00:27, 32.24batch/s] 12%|███▎                       | 125/1014 [00:03<00:27, 32.42batch/s] 13%|███▍                       | 130/1014 [00:04<00:27, 32.32batch/s] 13%|███▌                       | 135/1014 [00:04<00:27, 32.38batch/s] 14%|███▋                       | 140/1014 [00:04<00:27, 32.29batch/s] 14%|███▊                       | 145/1014 [00:04<00:26, 32.42batch/s] 15%|███▉                       | 150/1014 [00:04<00:26, 32.56batch/s] 15%|████▏                      | 155/1014 [00:04<00:26, 32.65batch/s] 16%|████▎                      | 160/1014 [00:04<00:26, 32.68batch/s] 16%|████▍                      | 165/1014 [00:05<00:26, 32.48batch/s] 17%|████▌                      | 170/1014 [00:05<00:25, 32.59batch/s] 17%|████▋                      | 175/1014 [00:05<00:25, 32.74batch/s] 18%|████▊                      | 180/1014 [00:05<00:25, 32.72batch/s] 18%|████▉                      | 185/1014 [00:05<00:25, 32.74batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 32.98batch/s] 19%|█████▏                     | 195/1014 [00:05<00:24, 33.07batch/s] 20%|█████▎                     | 200/1014 [00:06<00:24, 32.99batch/s] 20%|█████▍                     | 205/1014 [00:06<00:24, 33.04batch/s] 21%|█████▌                     | 210/1014 [00:06<00:24, 33.07batch/s] 21%|█████▋                     | 215/1014 [00:06<00:24, 33.01batch/s] 22%|█████▊                     | 220/1014 [00:06<00:24, 33.03batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 32.97batch/s] 23%|██████                     | 230/1014 [00:06<00:23, 32.94batch/s] 23%|██████▎                    | 235/1014 [00:07<00:23, 32.96batch/s] 24%|██████▍                    | 240/1014 [00:07<00:23, 32.97batch/s] 24%|██████▌                    | 245/1014 [00:07<00:23, 33.09batch/s] 25%|██████▋                    | 250/1014 [00:07<00:23, 33.10batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 33.26batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 33.33batch/s] 26%|███████                    | 265/1014 [00:07<00:22, 33.35batch/s] 27%|███████▏                   | 270/1014 [00:08<00:22, 33.35batch/s] 27%|███████▎                   | 275/1014 [00:08<00:22, 33.36batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 33.37batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 33.23batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 33.18batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 33.25batch/s] 30%|███████▉                   | 300/1014 [00:08<00:21, 33.38batch/s] 30%|████████                   | 305/1014 [00:09<00:21, 33.38batch/s] 31%|████████▎                  | 310/1014 [00:09<00:21, 33.47batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 33.52batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 33.57batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 33.55batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 33.61batch/s] 33%|████████▉                  | 335/1014 [00:09<00:20, 33.52batch/s] 34%|█████████                  | 340/1014 [00:10<00:20, 33.56batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 33.65batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 33.66batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 33.63batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 33.59batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:19, 33.60batch/s] 36%|█████████▊                 | 370/1014 [00:11<00:19, 33.58batch/s] 37%|█████████▉                 | 375/1014 [00:11<00:19, 33.57batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 33.53batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 33.55batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 33.44batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 33.44batch/s] 39%|██████████▋                | 400/1014 [00:11<00:18, 33.41batch/s] 40%|██████████▊                | 405/1014 [00:12<00:18, 33.44batch/s] 40%|██████████▉                | 410/1014 [00:12<00:18, 33.49batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 33.45batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 33.45batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.45batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 33.45batch/s] 43%|███████████▌               | 435/1014 [00:13<00:17, 33.43batch/s] 43%|███████████▋               | 440/1014 [00:13<00:17, 33.48batch/s] 44%|███████████▊               | 445/1014 [00:13<00:17, 33.34batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 33.34batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.40batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 33.35batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 33.42batch/s] 46%|████████████▌              | 470/1014 [00:14<00:16, 33.44batch/s] 47%|████████████▋              | 475/1014 [00:14<00:16, 33.51batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 33.52batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.50batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 33.40batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 33.37batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 33.34batch/s] 50%|█████████████▍             | 505/1014 [00:15<00:15, 33.44batch/s] 50%|█████████████▌             | 510/1014 [00:15<00:15, 33.51batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 33.45batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 33.43batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 33.42batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.39batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 33.44batch/s] 53%|██████████████▍            | 540/1014 [00:16<00:14, 33.46batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:14, 33.45batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 33.53batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 33.59batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.62batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 33.66batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 33.67batch/s] 57%|███████████████▎           | 575/1014 [00:17<00:13, 33.68batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 33.73batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 33.68batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.66batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 33.67batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 33.63batch/s] 60%|████████████████           | 605/1014 [00:18<00:12, 33.61batch/s] 60%|████████████████▏          | 610/1014 [00:18<00:12, 33.64batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 33.63batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 33.65batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 33.65batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 33.66batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 33.71batch/s] 63%|█████████████████          | 640/1014 [00:19<00:11, 33.66batch/s] 64%|█████████████████▏         | 645/1014 [00:19<00:10, 33.59batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 33.60batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 33.58batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 33.62batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.59batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 33.56batch/s] 67%|█████████████████▉         | 675/1014 [00:20<00:10, 33.60batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.56batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 33.60batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.58batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 33.62batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 33.65batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 33.67batch/s] 70%|██████████████████▉        | 710/1014 [00:21<00:09, 33.74batch/s] 71%|███████████████████        | 715/1014 [00:21<00:08, 33.75batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 33.73batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 33.74batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 33.75batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 33.77batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:08, 33.72batch/s] 73%|███████████████████▊       | 745/1014 [00:22<00:07, 33.66batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 33.68batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.64batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.63batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 33.63batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.66batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:07, 33.70batch/s] 77%|████████████████████▊      | 780/1014 [00:23<00:06, 33.72batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.72batch/s] 78%|█████████████████████      | 790/1014 [00:23<00:06, 33.73batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 33.77batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 33.77batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 33.73batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:06, 33.76batch/s] 80%|█████████████████████▋     | 815/1014 [00:24<00:05, 33.77batch/s] 81%|█████████████████████▊     | 820/1014 [00:24<00:05, 33.74batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 33.76batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 33.78batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 33.74batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 33.78batch/s] 83%|██████████████████████▌    | 845/1014 [00:25<00:05, 33.78batch/s] 84%|██████████████████████▋    | 850/1014 [00:25<00:04, 33.79batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 33.80batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 33.80batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 33.81batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 33.83batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 33.85batch/s] 87%|███████████████████████▍   | 880/1014 [00:26<00:03, 33.66batch/s] 87%|███████████████████████▌   | 885/1014 [00:26<00:03, 33.66batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 33.67batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 33.68batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 33.70batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 33.66batch/s] 90%|████████████████████████▏  | 910/1014 [00:27<00:03, 33.70batch/s] 90%|████████████████████████▎  | 915/1014 [00:27<00:02, 33.69batch/s] 91%|████████████████████████▍  | 920/1014 [00:27<00:02, 33.74batch/s] 91%|████████████████████████▋  | 925/1014 [00:27<00:02, 33.77batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 33.79batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 33.82batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 33.87batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 33.86batch/s] 94%|█████████████████████████▎ | 950/1014 [00:28<00:01, 33.91batch/s] 94%|█████████████████████████▍ | 955/1014 [00:28<00:01, 33.90batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 33.90batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 33.90batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 33.88batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 33.86batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:01, 33.84batch/s] 97%|██████████████████████████▏| 985/1014 [00:29<00:00, 33.87batch/s] 98%|██████████████████████████▎| 990/1014 [00:29<00:00, 33.91batch/s] 98%|██████████████████████████▍| 995/1014 [00:29<00:00, 33.94batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 33.98batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.01batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 33.95batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 33.93batch/s]
Validation 9 -> LOSS = 0.47
Validation 9 -> BLEU = 91.14, 96.1/92.5/89.5/86.7 (BP=1.000, ratio=1.004, hyp_len=14444, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.47 @ validation 9
--> Best BLEU so far: 91.14 @ validation 9
Starting Epoch 10
Epoch 10 - update       4350 => loss:   0.692 (#OOM: 0)
Epoch 10 - update       4380 => loss:   0.670 (#OOM: 0)
Epoch 10 - update       4410 => loss:   0.510 (#OOM: 0)
Epoch 10 - update       4440 => loss:   0.485 (#OOM: 0)
Epoch 10 - update       4470 => loss:   0.481 (#OOM: 0)
Epoch 10 - update       4500 => loss:   0.379 (#OOM: 0)
Epoch 10 - update       4530 => loss:   0.506 (#OOM: 0)
Epoch 10 - update       4560 => loss:   0.459 (#OOM: 0)
Epoch 10 - update       4590 => loss:   0.420 (#OOM: 0)
Epoch 10 - update       4620 => loss:   0.623 (#OOM: 0)
Epoch 10 - update       4650 => loss:   0.420 (#OOM: 0)
Epoch 10 - update       4680 => loss:   0.318 (#OOM: 0)
Epoch 10 - update       4710 => loss:   0.428 (#OOM: 0)
Epoch 10 - update       4740 => loss:   0.377 (#OOM: 0)
Epoch 10 - update       4770 => loss:   0.449 (#OOM: 0)
Epoch 10 - update       4800 => loss:   0.643 (#OOM: 0)
--> Epoch 10 finished with mean loss 0.52184
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (673 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.29batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 10.80batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.89batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 12.73batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 12.87batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.64batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 13.00batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.18batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.29batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.90batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.07batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.39batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.73batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.80batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.00batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 34.32batch/s]  1%|▎                           | 13/1014 [00:00<00:27, 35.98batch/s]  2%|▍                           | 18/1014 [00:00<00:28, 35.11batch/s]  2%|▋                           | 23/1014 [00:00<00:29, 34.00batch/s]  3%|▊                           | 28/1014 [00:00<00:29, 33.48batch/s]  3%|▉                           | 33/1014 [00:00<00:28, 34.31batch/s]  4%|█                           | 38/1014 [00:01<00:28, 34.11batch/s]  4%|█▏                          | 43/1014 [00:01<00:28, 34.39batch/s]  5%|█▎                          | 48/1014 [00:01<00:28, 34.26batch/s]  5%|█▍                          | 53/1014 [00:01<00:28, 34.03batch/s]  6%|█▌                          | 58/1014 [00:01<00:27, 34.45batch/s]  6%|█▋                          | 63/1014 [00:01<00:27, 34.59batch/s]  7%|█▉                          | 68/1014 [00:01<00:27, 34.58batch/s]  7%|██                          | 74/1014 [00:02<00:26, 35.56batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.39batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 35.35batch/s]  9%|██▌                         | 92/1014 [00:02<00:26, 35.27batch/s] 10%|██▋                         | 98/1014 [00:02<00:25, 35.56batch/s] 10%|██▊                        | 104/1014 [00:02<00:25, 35.45batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 35.21batch/s] 11%|███                        | 116/1014 [00:03<00:25, 35.23batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 35.28batch/s] 13%|███▍                       | 128/1014 [00:03<00:25, 35.20batch/s] 13%|███▌                       | 134/1014 [00:03<00:24, 35.21batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.30batch/s] 14%|███▉                       | 146/1014 [00:04<00:24, 35.39batch/s] 15%|████                       | 152/1014 [00:04<00:24, 35.29batch/s] 16%|████▏                      | 158/1014 [00:04<00:24, 35.02batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 35.17batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 35.25batch/s] 17%|████▋                      | 176/1014 [00:05<00:23, 35.19batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 35.27batch/s] 19%|█████                      | 188/1014 [00:05<00:23, 35.10batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.82batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.66batch/s] 20%|█████▍                     | 206/1014 [00:05<00:23, 34.56batch/s] 21%|█████▋                     | 212/1014 [00:06<00:23, 34.77batch/s] 21%|█████▊                     | 218/1014 [00:06<00:22, 34.65batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.48batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.55batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.54batch/s] 24%|██████▍                    | 242/1014 [00:07<00:22, 34.45batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 34.51batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 34.48batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.46batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 34.49batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 34.53batch/s] 27%|███████▍                   | 278/1014 [00:08<00:21, 34.39batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 34.51batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.49batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 34.46batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 34.46batch/s] 30%|████████▏                  | 308/1014 [00:08<00:20, 34.50batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.53batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.62batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 34.61batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 34.65batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 34.70batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 34.64batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.76batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:18, 34.72batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 34.38batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 34.32batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.24batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.27batch/s] 38%|██████████▎                | 386/1014 [00:11<00:18, 34.14batch/s] 39%|██████████▍                | 392/1014 [00:11<00:18, 34.24batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 34.28batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.29batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.20batch/s] 41%|███████████                | 416/1014 [00:12<00:17, 34.14batch/s] 42%|███████████▏               | 422/1014 [00:12<00:17, 34.12batch/s] 42%|███████████▍               | 428/1014 [00:12<00:17, 34.00batch/s] 43%|███████████▌               | 434/1014 [00:12<00:17, 33.98batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.01batch/s] 44%|███████████▉               | 446/1014 [00:13<00:16, 33.94batch/s] 45%|████████████               | 452/1014 [00:13<00:16, 33.98batch/s] 45%|████████████▏              | 458/1014 [00:13<00:16, 33.90batch/s] 46%|████████████▎              | 464/1014 [00:13<00:16, 33.86batch/s] 46%|████████████▌              | 470/1014 [00:13<00:16, 33.83batch/s] 47%|████████████▋              | 476/1014 [00:14<00:15, 33.70batch/s] 48%|████████████▊              | 482/1014 [00:14<00:15, 33.77batch/s] 48%|████████████▉              | 488/1014 [00:14<00:15, 33.82batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:15, 33.77batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 33.80batch/s] 50%|█████████████▍             | 506/1014 [00:15<00:15, 33.57batch/s] 50%|█████████████▋             | 512/1014 [00:15<00:14, 33.62batch/s] 51%|█████████████▊             | 518/1014 [00:15<00:14, 33.68batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 33.52batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.49batch/s] 53%|██████████████▎            | 536/1014 [00:16<00:14, 33.49batch/s] 53%|██████████████▍            | 542/1014 [00:16<00:14, 33.47batch/s] 54%|██████████████▌            | 548/1014 [00:16<00:13, 33.51batch/s] 55%|██████████████▊            | 554/1014 [00:16<00:13, 33.48batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.46batch/s] 56%|███████████████            | 566/1014 [00:16<00:13, 33.46batch/s] 56%|███████████████▏           | 572/1014 [00:17<00:13, 33.50batch/s] 57%|███████████████▍           | 578/1014 [00:17<00:13, 33.48batch/s] 58%|███████████████▌           | 584/1014 [00:17<00:12, 33.40batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.46batch/s] 59%|███████████████▊           | 596/1014 [00:17<00:12, 33.43batch/s] 59%|████████████████           | 602/1014 [00:17<00:12, 33.48batch/s] 60%|████████████████▏          | 608/1014 [00:18<00:12, 33.49batch/s] 61%|████████████████▎          | 614/1014 [00:18<00:11, 33.52batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 33.54batch/s] 62%|████████████████▋          | 626/1014 [00:18<00:11, 33.58batch/s] 62%|████████████████▊          | 632/1014 [00:18<00:11, 33.62batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:11, 33.67batch/s] 64%|█████████████████▏         | 644/1014 [00:19<00:11, 33.63batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 33.68batch/s] 65%|█████████████████▍         | 656/1014 [00:19<00:10, 33.68batch/s] 65%|█████████████████▋         | 662/1014 [00:19<00:10, 33.69batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:10, 33.71batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:10, 33.71batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.71batch/s] 68%|██████████████████▎        | 686/1014 [00:20<00:09, 33.72batch/s] 68%|██████████████████▍        | 692/1014 [00:20<00:09, 33.67batch/s] 69%|██████████████████▌        | 698/1014 [00:20<00:09, 33.65batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:09, 33.64batch/s] 70%|██████████████████▉        | 710/1014 [00:21<00:09, 33.65batch/s] 71%|███████████████████        | 716/1014 [00:21<00:08, 33.66batch/s] 71%|███████████████████▏       | 722/1014 [00:21<00:08, 33.65batch/s] 72%|███████████████████▍       | 728/1014 [00:21<00:08, 33.67batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 33.68batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:08, 33.70batch/s] 74%|███████████████████▊       | 746/1014 [00:22<00:07, 33.69batch/s] 74%|████████████████████       | 752/1014 [00:22<00:07, 33.75batch/s] 75%|████████████████████▏      | 758/1014 [00:22<00:07, 33.76batch/s] 75%|████████████████████▎      | 764/1014 [00:22<00:07, 33.77batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.73batch/s] 77%|████████████████████▋      | 776/1014 [00:23<00:07, 33.73batch/s] 77%|████████████████████▊      | 782/1014 [00:23<00:06, 33.69batch/s] 78%|████████████████████▉      | 788/1014 [00:23<00:06, 33.69batch/s] 78%|█████████████████████▏     | 794/1014 [00:23<00:06, 33.67batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 33.70batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:06, 33.67batch/s] 80%|█████████████████████▌     | 812/1014 [00:24<00:05, 33.67batch/s] 81%|█████████████████████▊     | 818/1014 [00:24<00:05, 33.65batch/s] 81%|█████████████████████▉     | 824/1014 [00:24<00:05, 33.65batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 33.65batch/s] 82%|██████████████████████▎    | 836/1014 [00:24<00:05, 33.61batch/s] 83%|██████████████████████▍    | 842/1014 [00:25<00:05, 33.62batch/s] 84%|██████████████████████▌    | 848/1014 [00:25<00:04, 33.60batch/s] 84%|██████████████████████▋    | 854/1014 [00:25<00:04, 33.66batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 33.66batch/s] 85%|███████████████████████    | 866/1014 [00:25<00:04, 33.70batch/s] 86%|███████████████████████▏   | 872/1014 [00:25<00:04, 33.68batch/s] 87%|███████████████████████▍   | 878/1014 [00:26<00:04, 33.74batch/s] 87%|███████████████████████▌   | 884/1014 [00:26<00:03, 33.70batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 33.74batch/s] 88%|███████████████████████▊   | 896/1014 [00:26<00:03, 33.71batch/s] 89%|████████████████████████   | 902/1014 [00:26<00:03, 33.71batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 33.70batch/s] 90%|████████████████████████▎  | 914/1014 [00:27<00:02, 33.73batch/s] 91%|████████████████████████▍  | 920/1014 [00:27<00:02, 33.73batch/s] 91%|████████████████████████▋  | 926/1014 [00:27<00:02, 33.77batch/s] 92%|████████████████████████▊  | 932/1014 [00:27<00:02, 33.81batch/s] 93%|████████████████████████▉  | 938/1014 [00:27<00:02, 33.82batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 33.88batch/s] 94%|█████████████████████████▎ | 950/1014 [00:28<00:01, 33.84batch/s] 94%|█████████████████████████▍ | 956/1014 [00:28<00:01, 33.89batch/s] 95%|█████████████████████████▌ | 962/1014 [00:28<00:01, 33.87batch/s] 95%|█████████████████████████▊ | 968/1014 [00:28<00:01, 33.87batch/s] 96%|█████████████████████████▉ | 974/1014 [00:28<00:01, 33.88batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:01, 33.88batch/s] 97%|██████████████████████████▎| 986/1014 [00:29<00:00, 33.92batch/s] 98%|██████████████████████████▍| 992/1014 [00:29<00:00, 33.94batch/s] 98%|██████████████████████████▌| 998/1014 [00:29<00:00, 33.95batch/s] 99%|█████████████████████████▋| 1004/1014 [00:29<00:00, 34.00batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 33.99batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.02batch/s]
Validation 10 -> LOSS = 0.43
Validation 10 -> BLEU = 91.97, 96.7/93.3/90.4/87.7 (BP=1.000, ratio=1.000, hyp_len=14382, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.43 @ validation 10
--> Best BLEU so far: 91.97 @ validation 10
Starting Epoch 11
Epoch 11 - update       4830 => loss:   0.555 (#OOM: 0)
Epoch 11 - update       4860 => loss:   0.495 (#OOM: 0)
Epoch 11 - update       4890 => loss:   0.516 (#OOM: 0)
Epoch 11 - update       4920 => loss:   0.469 (#OOM: 0)
Epoch 11 - update       4950 => loss:   0.396 (#OOM: 0)
Epoch 11 - update       4980 => loss:   0.317 (#OOM: 0)
Epoch 11 - update       5010 => loss:   0.513 (#OOM: 0)
Epoch 11 - update       5040 => loss:   0.402 (#OOM: 0)
Epoch 11 - update       5070 => loss:   0.426 (#OOM: 0)
Epoch 11 - update       5100 => loss:   0.552 (#OOM: 0)
Epoch 11 - update       5130 => loss:   0.477 (#OOM: 0)
Epoch 11 - update       5160 => loss:   0.279 (#OOM: 0)
Epoch 11 - update       5190 => loss:   0.538 (#OOM: 0)
Epoch 11 - update       5220 => loss:   0.563 (#OOM: 0)
Epoch 11 - update       5250 => loss:   0.471 (#OOM: 0)
Epoch 11 - update       5280 => loss:   0.506 (#OOM: 0)
--> Epoch 11 finished with mean loss 0.47081
--> Overhead/Training/Evaluation: 0.64/0.73/0.00 mins (total: 1.37 mins)   (661 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 17.37batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.45batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 12.90batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.32batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.70batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.29batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.54batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.27batch/s] 74%|██████████████████████        | 25/34 [00:02<00:00, 12.31batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 12.77batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.33batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.48batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.48batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:24, 41.90batch/s]  1%|▎                           | 10/1014 [00:00<00:24, 41.50batch/s]  1%|▍                           | 15/1014 [00:00<00:28, 35.00batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 34.63batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.85batch/s]  3%|▊                           | 30/1014 [00:00<00:29, 33.69batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.66batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.60batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.06batch/s]  5%|█▍                          | 50/1014 [00:01<00:27, 35.66batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.20batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.25batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 36.41batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 37.02batch/s]  7%|██                          | 75/1014 [00:02<00:25, 36.58batch/s]  8%|██▏                         | 80/1014 [00:02<00:25, 36.55batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 35.91batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 36.25batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 35.94batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 36.35batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 36.64batch/s] 11%|██▉                        | 110/1014 [00:03<00:24, 36.21batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.14batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 36.03batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 36.05batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 36.30batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 36.48batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 36.10batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.87batch/s] 15%|███▉                       | 150/1014 [00:04<00:23, 36.13batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 36.22batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 36.19batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 36.22batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 36.22batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 36.30batch/s] 18%|████▊                      | 180/1014 [00:04<00:22, 36.36batch/s] 18%|████▉                      | 185/1014 [00:05<00:22, 36.24batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 36.02batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 35.93batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.84batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.78batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.58batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.65batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.51batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 35.57batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 35.70batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 35.75batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.69batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.49batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.53batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.36batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.31batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.32batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.31batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.35batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.39batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 35.38batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.38batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.34batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 35.38batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 35.37batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 35.30batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.34batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.29batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.33batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.40batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.41batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 35.42batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:18, 35.40batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.40batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 35.37batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 35.39batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.42batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.41batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 35.36batch/s] 37%|██████████                 | 380/1014 [00:10<00:17, 35.35batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 35.29batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 35.33batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.44batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.30batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 35.35batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.29batch/s] 41%|███████████                | 415/1014 [00:11<00:16, 35.29batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.31batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.30batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.35batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 35.32batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.19batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.23batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 35.15batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 35.16batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.21batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 35.16batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 35.21batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 35.04batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 35.10batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 35.06batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.06batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 35.05batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.04batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.11batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 35.12batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 35.14batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 35.04batch/s] 52%|█████████████▉             | 525/1014 [00:14<00:13, 35.09batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 35.08batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.98batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.92batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.88batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.82batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:13, 34.74batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.66batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 34.69batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.69batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.70batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.66batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.68batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.64batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.63batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.63batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.59batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.64batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.62batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.63batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.64batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.64batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.64batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.62batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.63batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.49batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 34.44batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.43batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.45batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.44batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.48batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.46batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.46batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 34.47batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.50batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.54batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.53batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.49batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.48batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.50batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.47batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.49batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.47batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.46batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.46batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.43batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.44batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 34.47batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.51batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.50batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.55batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.57batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.61batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.58batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.60batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.56batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.54batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.54batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.55batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.51batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.54batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 34.50batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.45batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.42batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.45batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.45batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.46batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 34.40batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.36batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.35batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.36batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.33batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.30batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.28batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 34.25batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.26batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.28batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.28batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.31batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.34batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.36batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 34.37batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.37batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.35batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 34.33batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.35batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.37batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.37batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 34.36batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.35batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.36batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.38batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.37batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.38batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.36batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.34batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.34batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.35batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.36batch/s]
Validation 11 -> LOSS = 0.40
Validation 11 -> BLEU = 92.44, 96.9/93.7/91.0/88.4 (BP=1.000, ratio=1.000, hyp_len=14379, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.40 @ validation 11
--> Best BLEU so far: 92.44 @ validation 11
Starting Epoch 12
Epoch 12 - update       5310 => loss:   0.296 (#OOM: 0)
Epoch 12 - update       5340 => loss:   0.427 (#OOM: 0)
Epoch 12 - update       5370 => loss:   0.453 (#OOM: 0)
Epoch 12 - update       5400 => loss:   0.490 (#OOM: 0)
Epoch 12 - update       5430 => loss:   0.361 (#OOM: 0)
Epoch 12 - update       5460 => loss:   0.358 (#OOM: 0)
Epoch 12 - update       5490 => loss:   0.521 (#OOM: 0)
Epoch 12 - update       5520 => loss:   0.542 (#OOM: 0)
Epoch 12 - update       5550 => loss:   0.544 (#OOM: 0)
Epoch 12 - update       5580 => loss:   0.407 (#OOM: 0)
Epoch 12 - update       5610 => loss:   0.446 (#OOM: 0)
Epoch 12 - update       5640 => loss:   0.267 (#OOM: 0)
Epoch 12 - update       5670 => loss:   0.350 (#OOM: 0)
Epoch 12 - update       5700 => loss:   0.301 (#OOM: 0)
Epoch 12 - update       5730 => loss:   0.481 (#OOM: 0)
Epoch 12 - update       5760 => loss:   0.612 (#OOM: 0)
--> Epoch 12 finished with mean loss 0.42773
--> Overhead/Training/Evaluation: 0.66/0.73/0.00 mins (total: 1.39 mins)   (661 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 16.13batch/s] 15%|████▌                          | 5/34 [00:00<00:01, 18.81batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 18.78batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 15.58batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.99batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 15.08batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:00, 14.87batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 14.46batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.05batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.95batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.50batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.57batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:37, 27.03batch/s]  1%|▏                            | 7/1014 [00:00<00:32, 30.55batch/s]  1%|▎                           | 11/1014 [00:00<00:30, 32.68batch/s]  1%|▍                           | 15/1014 [00:00<00:29, 33.48batch/s]  2%|▌                           | 19/1014 [00:00<00:28, 34.35batch/s]  2%|▋                           | 23/1014 [00:00<00:29, 33.21batch/s]  3%|▋                           | 27/1014 [00:00<00:30, 32.84batch/s]  3%|▊                           | 31/1014 [00:00<00:29, 33.39batch/s]  3%|▉                           | 35/1014 [00:01<00:29, 33.65batch/s]  4%|█                           | 39/1014 [00:01<00:29, 32.83batch/s]  4%|█▏                          | 43/1014 [00:01<00:29, 32.75batch/s]  5%|█▎                          | 48/1014 [00:01<00:29, 33.15batch/s]  5%|█▍                          | 53/1014 [00:01<00:29, 32.89batch/s]  6%|█▌                          | 58/1014 [00:01<00:28, 33.07batch/s]  6%|█▋                          | 63/1014 [00:01<00:29, 32.64batch/s]  7%|█▉                          | 68/1014 [00:02<00:28, 32.83batch/s]  7%|██                          | 73/1014 [00:02<00:28, 33.24batch/s]  8%|██▏                         | 78/1014 [00:02<00:28, 32.88batch/s]  8%|██▎                         | 83/1014 [00:02<00:28, 32.31batch/s]  9%|██▍                         | 88/1014 [00:02<00:28, 32.54batch/s]  9%|██▌                         | 93/1014 [00:02<00:28, 32.65batch/s] 10%|██▋                         | 98/1014 [00:02<00:27, 32.77batch/s] 10%|██▋                        | 103/1014 [00:03<00:27, 33.10batch/s] 11%|██▉                        | 108/1014 [00:03<00:27, 33.18batch/s] 11%|███                        | 113/1014 [00:03<00:26, 33.53batch/s] 12%|███▏                       | 118/1014 [00:03<00:26, 33.57batch/s] 12%|███▎                       | 123/1014 [00:03<00:26, 33.61batch/s] 13%|███▍                       | 128/1014 [00:03<00:26, 33.67batch/s] 13%|███▌                       | 133/1014 [00:03<00:26, 33.70batch/s] 14%|███▋                       | 138/1014 [00:04<00:25, 33.80batch/s] 14%|███▊                       | 143/1014 [00:04<00:25, 33.90batch/s] 15%|███▉                       | 148/1014 [00:04<00:25, 33.94batch/s] 15%|████                       | 153/1014 [00:04<00:25, 33.98batch/s] 16%|████▏                      | 158/1014 [00:04<00:25, 33.99batch/s] 16%|████▎                      | 163/1014 [00:04<00:25, 33.92batch/s] 17%|████▍                      | 168/1014 [00:04<00:24, 33.97batch/s] 17%|████▌                      | 173/1014 [00:05<00:24, 33.97batch/s] 18%|████▋                      | 178/1014 [00:05<00:24, 33.87batch/s] 18%|████▊                      | 183/1014 [00:05<00:24, 33.79batch/s] 19%|█████                      | 188/1014 [00:05<00:24, 33.93batch/s] 19%|█████▏                     | 193/1014 [00:05<00:24, 33.89batch/s] 20%|█████▎                     | 198/1014 [00:05<00:24, 33.95batch/s] 20%|█████▍                     | 203/1014 [00:05<00:23, 34.02batch/s] 21%|█████▌                     | 208/1014 [00:06<00:23, 33.95batch/s] 21%|█████▋                     | 213/1014 [00:06<00:23, 33.95batch/s] 21%|█████▊                     | 218/1014 [00:06<00:23, 33.95batch/s] 22%|█████▉                     | 223/1014 [00:06<00:23, 33.79batch/s] 22%|██████                     | 228/1014 [00:06<00:23, 33.82batch/s] 23%|██████▏                    | 233/1014 [00:06<00:23, 33.88batch/s] 23%|██████▎                    | 238/1014 [00:07<00:22, 33.90batch/s] 24%|██████▍                    | 243/1014 [00:07<00:22, 33.87batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 33.85batch/s] 25%|██████▋                    | 253/1014 [00:07<00:22, 33.91batch/s] 25%|██████▊                    | 258/1014 [00:07<00:22, 33.82batch/s] 26%|███████                    | 263/1014 [00:07<00:22, 33.86batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 33.97batch/s] 27%|███████▎                   | 273/1014 [00:08<00:21, 34.03batch/s] 27%|███████▍                   | 278/1014 [00:08<00:21, 33.92batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 33.86batch/s] 28%|███████▋                   | 288/1014 [00:08<00:21, 33.85batch/s] 29%|███████▊                   | 293/1014 [00:08<00:21, 34.00batch/s] 29%|███████▉                   | 298/1014 [00:08<00:21, 33.86batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 33.87batch/s] 30%|████████▏                  | 308/1014 [00:09<00:20, 33.67batch/s] 31%|████████▎                  | 313/1014 [00:09<00:20, 33.76batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 33.78batch/s] 32%|████████▌                  | 323/1014 [00:09<00:20, 33.85batch/s] 32%|████████▋                  | 328/1014 [00:09<00:20, 33.85batch/s] 33%|████████▊                  | 333/1014 [00:09<00:20, 33.85batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 33.93batch/s] 34%|█████████▏                 | 343/1014 [00:10<00:19, 33.95batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 33.91batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 33.83batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:19, 33.91batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:19, 33.75batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:19, 33.73batch/s] 37%|█████████▉                 | 373/1014 [00:11<00:18, 33.78batch/s] 37%|██████████                 | 378/1014 [00:11<00:18, 33.80batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 33.80batch/s] 38%|██████████▎                | 388/1014 [00:11<00:18, 33.87batch/s] 39%|██████████▍                | 393/1014 [00:11<00:18, 33.96batch/s] 39%|██████████▌                | 398/1014 [00:11<00:18, 33.86batch/s] 40%|██████████▋                | 403/1014 [00:11<00:18, 33.86batch/s] 40%|██████████▊                | 408/1014 [00:12<00:17, 33.87batch/s] 41%|██████████▉                | 413/1014 [00:12<00:17, 33.87batch/s] 41%|███████████▏               | 418/1014 [00:12<00:17, 33.78batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 33.81batch/s] 42%|███████████▍               | 428/1014 [00:12<00:17, 33.77batch/s] 43%|███████████▌               | 433/1014 [00:12<00:17, 33.84batch/s] 43%|███████████▋               | 438/1014 [00:12<00:17, 33.85batch/s] 44%|███████████▊               | 443/1014 [00:13<00:16, 33.73batch/s] 44%|███████████▉               | 448/1014 [00:13<00:16, 33.72batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 33.74batch/s] 45%|████████████▏              | 458/1014 [00:13<00:16, 33.74batch/s] 46%|████████████▎              | 463/1014 [00:13<00:16, 33.78batch/s] 46%|████████████▍              | 468/1014 [00:13<00:16, 33.82batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 33.85batch/s] 47%|████████████▋              | 478/1014 [00:14<00:15, 33.83batch/s] 48%|████████████▊              | 483/1014 [00:14<00:15, 33.83batch/s] 48%|████████████▉              | 488/1014 [00:14<00:15, 33.88batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:15, 33.85batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:15, 33.93batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:15, 33.95batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 33.97batch/s] 51%|█████████████▋             | 513/1014 [00:15<00:14, 33.98batch/s] 51%|█████████████▊             | 518/1014 [00:15<00:14, 33.95batch/s] 52%|█████████████▉             | 523/1014 [00:15<00:14, 34.00batch/s] 52%|██████████████             | 528/1014 [00:15<00:14, 34.04batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:14, 33.98batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 34.02batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.02batch/s] 54%|██████████████▌            | 548/1014 [00:16<00:13, 33.99batch/s] 55%|██████████████▋            | 553/1014 [00:16<00:13, 34.00batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 33.98batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 33.99batch/s] 56%|███████████████            | 568/1014 [00:16<00:13, 34.00batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.02batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 34.04batch/s] 57%|███████████████▌           | 583/1014 [00:17<00:12, 34.03batch/s] 58%|███████████████▋           | 588/1014 [00:17<00:12, 34.09batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.03batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:12, 34.01batch/s] 59%|████████████████           | 603/1014 [00:17<00:12, 34.01batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 34.02batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 34.07batch/s] 61%|████████████████▍          | 618/1014 [00:18<00:11, 34.10batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 34.11batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 34.10batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:11, 34.11batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:11, 34.12batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 34.11batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 34.13batch/s] 64%|█████████████████▍         | 653/1014 [00:19<00:10, 34.17batch/s] 65%|█████████████████▌         | 658/1014 [00:19<00:10, 34.21batch/s] 65%|█████████████████▋         | 663/1014 [00:19<00:10, 34.23batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:10, 34.29batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 34.29batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.24batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.20batch/s] 68%|██████████████████▎        | 688/1014 [00:20<00:09, 34.16batch/s] 68%|██████████████████▍        | 693/1014 [00:20<00:09, 34.21batch/s] 69%|██████████████████▌        | 698/1014 [00:20<00:09, 34.21batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:09, 34.22batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.26batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.26batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 34.26batch/s] 71%|███████████████████▎       | 723/1014 [00:21<00:08, 34.27batch/s] 72%|███████████████████▍       | 728/1014 [00:21<00:08, 34.27batch/s] 72%|███████████████████▌       | 733/1014 [00:21<00:08, 34.31batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:08, 34.34batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.35batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.31batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.34batch/s] 75%|████████████████████▏      | 758/1014 [00:22<00:07, 34.32batch/s] 75%|████████████████████▎      | 763/1014 [00:22<00:07, 34.34batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.36batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:07, 34.33batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.33batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 34.33batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 34.38batch/s] 78%|█████████████████████      | 793/1014 [00:23<00:06, 34.39batch/s] 79%|█████████████████████▏     | 798/1014 [00:23<00:06, 34.42batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.47batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 34.49batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.47batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.44batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 34.42batch/s] 82%|██████████████████████     | 828/1014 [00:24<00:05, 34.40batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.40batch/s] 83%|██████████████████████▎    | 838/1014 [00:24<00:05, 34.40batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 34.42batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.45batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.45batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 34.44batch/s] 85%|██████████████████████▉    | 863/1014 [00:25<00:04, 34.43batch/s] 86%|███████████████████████    | 868/1014 [00:25<00:04, 34.42batch/s] 86%|███████████████████████▏   | 873/1014 [00:25<00:04, 34.43batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.48batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.50batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.50batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.49batch/s] 89%|███████████████████████▉   | 898/1014 [00:26<00:03, 34.47batch/s] 89%|████████████████████████   | 903/1014 [00:26<00:03, 34.46batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.45batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.46batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.48batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.46batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.47batch/s] 92%|████████████████████████▊  | 933/1014 [00:27<00:02, 34.44batch/s] 93%|████████████████████████▉  | 938/1014 [00:27<00:02, 34.47batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 34.44batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.46batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.50batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.43batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 34.42batch/s] 95%|█████████████████████████▊ | 968/1014 [00:28<00:01, 34.40batch/s] 96%|█████████████████████████▉ | 973/1014 [00:28<00:01, 34.37batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.38batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.42batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.43batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 34.44batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 34.44batch/s] 99%|█████████████████████████▋| 1003/1014 [00:29<00:00, 34.45batch/s] 99%|█████████████████████████▊| 1008/1014 [00:29<00:00, 34.47batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.48batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.48batch/s]
Validation 12 -> LOSS = 0.38
Validation 12 -> BLEU = 92.79, 97.1/94.0/91.4/88.9 (BP=1.000, ratio=1.000, hyp_len=14377, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.38 @ validation 12
--> Best BLEU so far: 92.79 @ validation 12
Starting Epoch 13
Epoch 13 - update       5790 => loss:   0.417 (#OOM: 0)
Epoch 13 - update       5820 => loss:   0.565 (#OOM: 0)
Epoch 13 - update       5850 => loss:   0.491 (#OOM: 0)
Epoch 13 - update       5880 => loss:   0.467 (#OOM: 0)
Epoch 13 - update       5910 => loss:   0.383 (#OOM: 0)
Epoch 13 - update       5940 => loss:   0.236 (#OOM: 0)
Epoch 13 - update       5970 => loss:   0.426 (#OOM: 0)
Epoch 13 - update       6000 => loss:   0.318 (#OOM: 0)
Epoch 13 - update       6030 => loss:   0.397 (#OOM: 0)
Epoch 13 - update       6060 => loss:   0.383 (#OOM: 0)
Epoch 13 - update       6090 => loss:   0.556 (#OOM: 0)
Epoch 13 - update       6120 => loss:   0.406 (#OOM: 0)
Epoch 13 - update       6150 => loss:   0.332 (#OOM: 0)
Epoch 13 - update       6180 => loss:   0.232 (#OOM: 0)
Epoch 13 - update       6210 => loss:   0.279 (#OOM: 0)
Epoch 13 - update       6240 => loss:   0.293 (#OOM: 0)
--> Epoch 13 finished with mean loss 0.39065
--> Overhead/Training/Evaluation: 0.62/0.73/0.00 mins (total: 1.36 mins)   (658 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:01, 16.74batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 14.05batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.93batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.19batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 14.58batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 14.16batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.50batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.49batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.27batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.30batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.57batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.65batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:24, 40.88batch/s]  1%|▎                           | 10/1014 [00:00<00:23, 43.12batch/s]  1%|▍                           | 15/1014 [00:00<00:25, 39.34batch/s]  2%|▌                           | 20/1014 [00:00<00:24, 40.33batch/s]  2%|▋                           | 25/1014 [00:00<00:25, 39.21batch/s]  3%|▊                           | 30/1014 [00:00<00:25, 38.82batch/s]  3%|▉                           | 35/1014 [00:00<00:25, 38.22batch/s]  4%|█                           | 40/1014 [00:01<00:26, 37.10batch/s]  4%|█▏                          | 45/1014 [00:01<00:25, 37.49batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 37.04batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.77batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.52batch/s]  6%|█▊                          | 65/1014 [00:01<00:25, 37.13batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 36.52batch/s]  7%|██                          | 75/1014 [00:02<00:25, 37.13batch/s]  8%|██▏                         | 80/1014 [00:02<00:25, 37.19batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.33batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 36.27batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 36.50batch/s] 10%|██▋                        | 100/1014 [00:02<00:24, 36.57batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 36.59batch/s] 11%|██▉                        | 110/1014 [00:02<00:24, 36.78batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.85batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 36.88batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 36.82batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 36.18batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 36.04batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 36.17batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 36.17batch/s] 15%|███▉                       | 150/1014 [00:04<00:23, 36.12batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 35.83batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 35.62batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 35.44batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 35.62batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.50batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.53batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.48batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.54batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.41batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.44batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.59batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.49batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.50batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.71batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 35.70batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 35.75batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 35.66batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.73batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.68batch/s] 25%|██████▋                    | 250/1014 [00:06<00:21, 35.75batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.57batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.63batch/s] 26%|███████                    | 265/1014 [00:07<00:20, 35.68batch/s] 27%|███████▏                   | 270/1014 [00:07<00:20, 35.68batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.59batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.56batch/s] 28%|███████▌                   | 285/1014 [00:07<00:20, 35.69batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.78batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.57batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 35.54batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 35.42batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 35.45batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.39batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.43batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.37batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.39batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.30batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 35.37batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:18, 35.32batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.33batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 35.22batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 35.18batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.25batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.29batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 35.17batch/s] 37%|██████████                 | 380/1014 [00:10<00:17, 35.22batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 35.24batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 35.20batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.25batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.07batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 35.12batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.11batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 35.13batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.14batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.09batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.14batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 35.03batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.00batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.75batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 34.66batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.70batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 34.72batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.77batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.81batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.82batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.84batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.78batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.77batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 34.74batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.75batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.75batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.75batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.77batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.66batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.71batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 34.66batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.66batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.63batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.65batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.58batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.54batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.60batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 34.60batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.55batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.59batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.63batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.60batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.56batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.64batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.63batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.56batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.54batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.52batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.58batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.57batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.49batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.52batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.60batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.56batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.57batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.55batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.57batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.55batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.58batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.61batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.62batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.67batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.69batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.72batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.74batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.74batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.74batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.68batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.66batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.67batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.66batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.69batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.65batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.71batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.73batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.71batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.68batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.65batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.67batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.70batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.68batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.70batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.73batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.72batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.70batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.69batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.67batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.65batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.63batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.62batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.60batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.58batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.59batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.62batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.63batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.64batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.66batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 34.66batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.64batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.63batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.68batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.66batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.70batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.71batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 34.72batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.76batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.77batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.79batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.82batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.84batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.79batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.79batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.79batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.79batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.82batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.81batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.82batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.79batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 34.81batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.81batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.79batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.81batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.83batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.82batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.78batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 34.80batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 34.84batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.81batch/s]
Validation 13 -> LOSS = 0.36
Validation 13 -> BLEU = 92.68, 96.9/93.8/91.3/88.9 (BP=1.000, ratio=1.003, hyp_len=14422, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.36 @ validation 13
--> Best BLEU so far: 92.79 @ validation 12
Starting Epoch 14
Epoch 14 - update       6270 => loss:   0.360 (#OOM: 0)
Epoch 14 - update       6300 => loss:   0.281 (#OOM: 0)
Epoch 14 - update       6330 => loss:   0.373 (#OOM: 0)
Epoch 14 - update       6360 => loss:   0.590 (#OOM: 0)
Epoch 14 - update       6390 => loss:   0.381 (#OOM: 0)
Epoch 14 - update       6420 => loss:   0.341 (#OOM: 0)
Epoch 14 - update       6450 => loss:   0.272 (#OOM: 0)
Epoch 14 - update       6480 => loss:   0.262 (#OOM: 0)
Epoch 14 - update       6510 => loss:   0.365 (#OOM: 0)
Epoch 14 - update       6540 => loss:   0.335 (#OOM: 0)
Epoch 14 - update       6570 => loss:   0.393 (#OOM: 0)
Epoch 14 - update       6600 => loss:   0.510 (#OOM: 0)
Epoch 14 - update       6630 => loss:   0.354 (#OOM: 0)
Epoch 14 - update       6660 => loss:   0.371 (#OOM: 0)
Epoch 14 - update       6690 => loss:   0.315 (#OOM: 0)
Epoch 14 - update       6720 => loss:   0.406 (#OOM: 0)
--> Epoch 14 finished with mean loss 0.36162
--> Overhead/Training/Evaluation: 0.60/0.73/0.00 mins (total: 1.33 mins)   (663 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 13.33batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.85batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.27batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 14.93batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.02batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 14.50batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 14.32batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 14.28batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 14.61batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.89batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.73batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.14batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.96batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:23, 43.69batch/s]  1%|▎                           | 10/1014 [00:00<00:24, 40.65batch/s]  1%|▍                           | 15/1014 [00:00<00:26, 38.01batch/s]  2%|▌                           | 20/1014 [00:00<00:25, 38.67batch/s]  2%|▋                           | 25/1014 [00:00<00:27, 35.45batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 35.26batch/s]  3%|▉                           | 35/1014 [00:00<00:27, 36.10batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.28batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.23batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 35.74batch/s]  5%|█▌                          | 55/1014 [00:01<00:27, 35.35batch/s]  6%|█▋                          | 60/1014 [00:01<00:27, 35.08batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 35.07batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 35.32batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.66batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 34.77batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 34.71batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 33.63batch/s]  9%|██▌                         | 95/1014 [00:02<00:27, 34.02batch/s] 10%|██▋                        | 100/1014 [00:02<00:27, 33.61batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 33.67batch/s] 11%|██▉                        | 110/1014 [00:03<00:27, 33.42batch/s] 11%|███                        | 115/1014 [00:03<00:26, 33.45batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 33.87batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 33.98batch/s] 13%|███▍                       | 130/1014 [00:03<00:26, 33.99batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.02batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 33.98batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 33.98batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.16batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 33.97batch/s] 16%|████▎                      | 160/1014 [00:04<00:25, 33.97batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.13batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.24batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.40batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.56batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 34.54batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.58batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.48batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.52batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.37batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.48batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.59batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.44batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.57batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.45batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.43batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.39batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.46batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.46batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 34.34batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.48batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.55batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.45batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.57batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.66batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 34.66batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.69batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.58batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.53batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.57batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.64batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.45batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.51batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.46batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.57batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.60batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.73batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 34.72batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.83batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.63batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.47batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.56batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.55batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.49batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.51batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.47batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.43batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.45batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.45batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.35batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.24batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 33.89batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 33.94batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.97batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 33.99batch/s] 43%|███████████▌               | 435/1014 [00:12<00:17, 34.01batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 33.96batch/s] 44%|███████████▊               | 445/1014 [00:13<00:16, 34.01batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 33.92batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.81batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 33.89batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 33.89batch/s] 46%|████████████▌              | 470/1014 [00:13<00:16, 33.86batch/s] 47%|████████████▋              | 475/1014 [00:14<00:15, 33.85batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 33.61batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.49batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 33.28batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 33.27batch/s] 49%|█████████████▎             | 500/1014 [00:15<00:15, 33.22batch/s] 50%|█████████████▍             | 505/1014 [00:15<00:15, 33.25batch/s] 50%|█████████████▌             | 510/1014 [00:15<00:15, 33.26batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:15, 33.22batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 33.24batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 33.25batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.28batch/s] 53%|██████████████▏            | 535/1014 [00:16<00:14, 33.32batch/s] 53%|██████████████▍            | 540/1014 [00:16<00:14, 33.30batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:14, 33.29batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 33.26batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 33.30batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.31batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 33.32batch/s] 56%|███████████████▏           | 570/1014 [00:17<00:13, 33.28batch/s] 57%|███████████████▎           | 575/1014 [00:17<00:13, 33.25batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:13, 33.27batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 33.23batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.29batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 33.31batch/s] 59%|███████████████▉           | 600/1014 [00:18<00:12, 33.29batch/s] 60%|████████████████           | 605/1014 [00:18<00:12, 33.20batch/s] 60%|████████████████▏          | 610/1014 [00:18<00:12, 33.17batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:12, 33.19batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 33.22batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 33.27batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 33.27batch/s] 63%|████████████████▉          | 635/1014 [00:19<00:11, 33.22batch/s] 63%|█████████████████          | 640/1014 [00:19<00:11, 33.26batch/s] 64%|█████████████████▏         | 645/1014 [00:19<00:11, 33.28batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 33.28batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 33.31batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 33.37batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.37batch/s] 66%|█████████████████▊         | 670/1014 [00:20<00:10, 33.40batch/s] 67%|█████████████████▉         | 675/1014 [00:20<00:10, 33.41batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.41batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 33.40batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.45batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 33.47batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 33.51batch/s] 70%|██████████████████▊        | 705/1014 [00:21<00:09, 33.53batch/s] 70%|██████████████████▉        | 710/1014 [00:21<00:09, 33.54batch/s] 71%|███████████████████        | 715/1014 [00:21<00:08, 33.53batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 33.55batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 33.57batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 33.56batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 33.56batch/s] 73%|███████████████████▋       | 740/1014 [00:22<00:08, 33.52batch/s] 73%|███████████████████▊       | 745/1014 [00:22<00:08, 33.59batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 33.59batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.57batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.60batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 33.63batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.66batch/s] 76%|████████████████████▋      | 775/1014 [00:23<00:07, 33.68batch/s] 77%|████████████████████▊      | 780/1014 [00:23<00:06, 33.66batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.67batch/s] 78%|█████████████████████      | 790/1014 [00:23<00:06, 33.70batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 33.71batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 33.73batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 33.75batch/s] 80%|█████████████████████▌     | 810/1014 [00:24<00:06, 33.73batch/s] 80%|█████████████████████▋     | 815/1014 [00:24<00:05, 33.69batch/s] 81%|█████████████████████▊     | 820/1014 [00:24<00:05, 33.71batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 33.75batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 33.76batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 33.75batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 33.72batch/s] 83%|██████████████████████▌    | 845/1014 [00:25<00:05, 33.74batch/s] 84%|██████████████████████▋    | 850/1014 [00:25<00:04, 33.71batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 33.70batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 33.72batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 33.74batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 33.79batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 33.81batch/s] 87%|███████████████████████▍   | 880/1014 [00:26<00:03, 33.79batch/s] 87%|███████████████████████▌   | 885/1014 [00:26<00:03, 33.83batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 33.81batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 33.77batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 33.77batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 33.79batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 33.81batch/s] 90%|████████████████████████▎  | 915/1014 [00:27<00:02, 33.85batch/s] 91%|████████████████████████▍  | 920/1014 [00:27<00:02, 33.85batch/s] 91%|████████████████████████▋  | 925/1014 [00:27<00:02, 33.87batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 33.88batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 33.89batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 33.88batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 33.93batch/s] 94%|█████████████████████████▎ | 950/1014 [00:28<00:01, 33.91batch/s] 94%|█████████████████████████▍ | 955/1014 [00:28<00:01, 33.93batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 33.96batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 33.96batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 33.97batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 33.96batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:01, 33.99batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.04batch/s] 98%|██████████████████████████▎| 990/1014 [00:29<00:00, 34.01batch/s] 98%|██████████████████████████▍| 995/1014 [00:29<00:00, 34.01batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.01batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.00batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.03batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.03batch/s]
Validation 14 -> LOSS = 0.35
Validation 14 -> BLEU = 92.81, 96.8/93.9/91.5/89.2 (BP=1.000, ratio=1.005, hyp_len=14448, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.35 @ validation 14
--> Best BLEU so far: 92.81 @ validation 14
Starting Epoch 15
Epoch 15 - update       6750 => loss:   0.276 (#OOM: 0)
Epoch 15 - update       6780 => loss:   0.254 (#OOM: 0)
Epoch 15 - update       6810 => loss:   0.283 (#OOM: 0)
Epoch 15 - update       6840 => loss:   0.278 (#OOM: 0)
Epoch 15 - update       6870 => loss:   0.369 (#OOM: 0)
Epoch 15 - update       6900 => loss:   0.302 (#OOM: 0)
Epoch 15 - update       6930 => loss:   0.313 (#OOM: 0)
Epoch 15 - update       6960 => loss:   0.276 (#OOM: 0)
Epoch 15 - update       6990 => loss:   0.449 (#OOM: 0)
Epoch 15 - update       7020 => loss:   0.203 (#OOM: 0)
Epoch 15 - update       7050 => loss:   0.326 (#OOM: 0)
Epoch 15 - update       7080 => loss:   0.342 (#OOM: 0)
Epoch 15 - update       7110 => loss:   0.362 (#OOM: 0)
Epoch 15 - update       7140 => loss:   0.206 (#OOM: 0)
Epoch 15 - update       7170 => loss:   0.233 (#OOM: 0)
Epoch 15 - update       7200 => loss:   0.259 (#OOM: 0)
Epoch 15 - update       7230 => loss:   0.402 (#OOM: 0)
--> Epoch 15 finished with mean loss 0.33312
--> Overhead/Training/Evaluation: 0.64/0.72/0.00 mins (total: 1.36 mins)   (668 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  8.08batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.81batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.16batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.94batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 14.25batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.05batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 13.80batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 14.55batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.40batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.24batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.75batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.86batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.80batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.84batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:22, 45.56batch/s]  1%|▎                           | 10/1014 [00:00<00:25, 38.91batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 36.02batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 33.07batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.18batch/s]  3%|▊                           | 30/1014 [00:00<00:28, 34.44batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.91batch/s]  4%|█                           | 40/1014 [00:01<00:27, 34.93batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 34.63batch/s]  5%|█▍                          | 50/1014 [00:01<00:27, 35.30batch/s]  5%|█▌                          | 55/1014 [00:01<00:27, 34.87batch/s]  6%|█▋                          | 60/1014 [00:01<00:27, 34.96batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 34.85batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.81batch/s]  7%|██                          | 75/1014 [00:02<00:26, 35.17batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.06batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 34.86batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 35.00batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.85batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.33batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.17batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.30batch/s] 11%|███                        | 115/1014 [00:03<00:26, 34.15batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 34.34batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.43batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.62batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.58batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.63batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.69batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 34.81batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 34.61batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.52batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.57batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.77batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.58batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.55batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 34.49batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.44batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.30batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.30batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.33batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.45batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 33.96batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.08batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 34.13batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.33batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.34batch/s] 24%|██████▍                    | 240/1014 [00:07<00:22, 34.28batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.15batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.29batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 34.43batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.47batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.50batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.50batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.54batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.29batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 34.25batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 34.34batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.45batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.45batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.49batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.56batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.54batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.50batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.45batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.47batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.48batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.43batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 34.50batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.56batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.54batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.52batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.60batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.58batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.45batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.35batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.11batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.00batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 34.04batch/s] 39%|██████████▋                | 400/1014 [00:11<00:18, 33.98batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 33.97batch/s] 40%|██████████▉                | 410/1014 [00:12<00:17, 33.88batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 33.86batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 33.78batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.81batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 33.87batch/s] 43%|███████████▌               | 435/1014 [00:12<00:17, 33.79batch/s] 43%|███████████▋               | 440/1014 [00:13<00:17, 33.76batch/s] 44%|███████████▊               | 445/1014 [00:13<00:16, 33.72batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 33.67batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.72batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 33.64batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 33.65batch/s] 46%|████████████▌              | 470/1014 [00:13<00:16, 33.65batch/s] 47%|████████████▋              | 475/1014 [00:14<00:16, 33.63batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 33.61batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.61batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 33.55batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 33.53batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 33.57batch/s] 50%|█████████████▍             | 505/1014 [00:15<00:15, 33.55batch/s] 50%|█████████████▌             | 510/1014 [00:15<00:15, 33.55batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 33.57batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 33.58batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 33.59batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.63batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 33.62batch/s] 53%|██████████████▍            | 540/1014 [00:16<00:14, 33.62batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 33.60batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 33.59batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 33.60batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.63batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 33.53batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 33.55batch/s] 57%|███████████████▎           | 575/1014 [00:17<00:13, 33.45batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 33.48batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 33.46batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.45batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 33.50batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 33.51batch/s] 60%|████████████████           | 605/1014 [00:18<00:12, 33.51batch/s] 60%|████████████████▏          | 610/1014 [00:18<00:12, 33.55batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 33.54batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 33.61batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 33.58batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 33.63batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 33.65batch/s] 63%|█████████████████          | 640/1014 [00:19<00:11, 33.68batch/s] 64%|█████████████████▏         | 645/1014 [00:19<00:10, 33.71batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 33.71batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 33.75batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 33.78batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.77batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 33.81batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:10, 33.81batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.87batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 33.91batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.88batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 33.92batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.00batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 34.02batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.00batch/s] 71%|███████████████████        | 715/1014 [00:21<00:08, 33.97batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 33.98batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 33.97batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.00batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.02batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:08, 34.06batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 33.99batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 33.96batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.95batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.99batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 33.98batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.96batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:07, 33.96batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 33.96batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.98batch/s] 78%|█████████████████████      | 790/1014 [00:23<00:06, 33.99batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 34.02batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.06batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.11batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.13batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.16batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.18batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 34.14batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 34.17batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.16batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.19batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.14batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.14batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 34.14batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 34.16batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.19batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.20batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.22batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.26batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.24batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 34.19batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 34.20batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.24batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.23batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.26batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.24batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.23batch/s] 91%|████████████████████████▋  | 925/1014 [00:27<00:02, 34.19batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 34.18batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.14batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.16batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 34.17batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.14batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.15batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 34.18batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 34.18batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.15batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.20batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.23batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.22batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.18batch/s] 98%|██████████████████████████▍| 995/1014 [00:29<00:00, 34.15batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.13batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.15batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.12batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.13batch/s]
Validation 15 -> LOSS = 0.33
Validation 15 -> BLEU = 93.65, 97.4/94.7/92.5/90.2 (BP=1.000, ratio=1.000, hyp_len=14388, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.33 @ validation 15
--> Best BLEU so far: 93.65 @ validation 15
Starting Epoch 16
Epoch 16 - update       7260 => loss:   0.348 (#OOM: 0)
Epoch 16 - update       7290 => loss:   0.409 (#OOM: 0)
Epoch 16 - update       7320 => loss:   0.277 (#OOM: 0)
Epoch 16 - update       7350 => loss:   0.338 (#OOM: 0)
Epoch 16 - update       7380 => loss:   0.265 (#OOM: 0)
Epoch 16 - update       7410 => loss:   0.327 (#OOM: 0)
Epoch 16 - update       7440 => loss:   0.291 (#OOM: 0)
Epoch 16 - update       7470 => loss:   0.214 (#OOM: 0)
Epoch 16 - update       7500 => loss:   0.289 (#OOM: 0)
Epoch 16 - update       7530 => loss:   0.222 (#OOM: 0)
Epoch 16 - update       7560 => loss:   0.433 (#OOM: 0)
Epoch 16 - update       7590 => loss:   0.250 (#OOM: 0)
Epoch 16 - update       7620 => loss:   0.286 (#OOM: 0)
Epoch 16 - update       7650 => loss:   0.202 (#OOM: 0)
Epoch 16 - update       7680 => loss:   0.304 (#OOM: 0)
Epoch 16 - update       7710 => loss:   0.391 (#OOM: 0)
--> Epoch 16 finished with mean loss 0.30684
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.33 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 13.91batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.23batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 14.71batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 14.47batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.52batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.83batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.18batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.24batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.23batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 12.82batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.41batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.80batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.80batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:31, 32.53batch/s]  1%|▏                            | 8/1014 [00:00<00:32, 30.57batch/s]  1%|▎                           | 12/1014 [00:00<00:33, 29.89batch/s]  2%|▍                           | 16/1014 [00:00<00:31, 31.26batch/s]  2%|▌                           | 20/1014 [00:00<00:31, 31.19batch/s]  2%|▋                           | 25/1014 [00:00<00:30, 32.46batch/s]  3%|▊                           | 30/1014 [00:00<00:31, 31.70batch/s]  3%|▉                           | 35/1014 [00:01<00:31, 31.27batch/s]  4%|█                           | 40/1014 [00:01<00:30, 31.44batch/s]  4%|█▏                          | 45/1014 [00:01<00:30, 32.29batch/s]  5%|█▍                          | 50/1014 [00:01<00:29, 32.41batch/s]  5%|█▌                          | 55/1014 [00:01<00:29, 32.29batch/s]  6%|█▋                          | 60/1014 [00:01<00:29, 32.46batch/s]  6%|█▊                          | 65/1014 [00:01<00:28, 32.84batch/s]  7%|█▉                          | 70/1014 [00:02<00:28, 33.06batch/s]  7%|██                          | 75/1014 [00:02<00:28, 33.43batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 33.53batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 33.75batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 33.87batch/s]  9%|██▌                         | 95/1014 [00:02<00:27, 34.01batch/s] 10%|██▋                        | 100/1014 [00:02<00:27, 33.73batch/s] 10%|██▊                        | 105/1014 [00:03<00:27, 33.56batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 33.75batch/s] 11%|███                        | 115/1014 [00:03<00:26, 33.88batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 33.68batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 33.62batch/s] 13%|███▍                       | 130/1014 [00:03<00:26, 33.74batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.00batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.10batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.13batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.06batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 34.27batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.26batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.10batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.07batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.14batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.28batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 34.50batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.70batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.82batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.94batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.92batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.88batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 34.83batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 34.78batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.85batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.71batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.83batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.87batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.95batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.36batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 34.27batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 34.18batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.13batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.13batch/s] 27%|███████▎                   | 275/1014 [00:08<00:21, 34.15batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.23batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 34.29batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 34.31batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 34.22batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.06batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.02batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 34.02batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.07batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.04batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 34.12batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 34.14batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.17batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.22batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 34.16batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.23batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.22batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 34.27batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.24batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.17batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.14batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.18batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.23batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.31batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 34.29batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.25batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.18batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.18batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 34.26batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.24batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.11batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 34.16batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.21batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.22batch/s] 44%|███████████▊               | 445/1014 [00:13<00:16, 34.20batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.15batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.17batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.19batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 34.18batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.15batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.11batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 34.13batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.04batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.07batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.10batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 34.15batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.14batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.18batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 34.17batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.15batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.16batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 34.25batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.22batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.27batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.31batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 34.32batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.33batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.34batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 34.31batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.35batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.32batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.31batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 34.35batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.33batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.35batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 34.37batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.36batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.37batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.46batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.46batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.41batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.43batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.46batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.49batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.53batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.50batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.48batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.48batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.53batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.54batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.58batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.55batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.56batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 34.47batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.48batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.47batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.47batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.43batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.45batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.46batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.45batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.47batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.39batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.35batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.36batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.38batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.39batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 34.31batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.33batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.32batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.32batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.34batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.35batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.39batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 34.40batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.41batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.43batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.42batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.42batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.38batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 34.37batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 34.34batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.37batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.35batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.39batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.39batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.42batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.45batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.47batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.49batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.51batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.53batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.55batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.54batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.55batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.55batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.52batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.49batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.50batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.48batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.48batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.50batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.50batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.52batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.55batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.55batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.58batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.59batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.61batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.61batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.61batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.63batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.64batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.65batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.66batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.67batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 34.67batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.69batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.71batch/s]
Validation 16 -> LOSS = 0.32
Validation 16 -> BLEU = 93.72, 97.2/94.7/92.6/90.5 (BP=1.000, ratio=1.003, hyp_len=14431, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.32 @ validation 16
--> Best BLEU so far: 93.72 @ validation 16
Starting Epoch 17
Epoch 17 - update       7740 => loss:   0.323 (#OOM: 0)
Epoch 17 - update       7770 => loss:   0.212 (#OOM: 0)
Epoch 17 - update       7800 => loss:   0.243 (#OOM: 0)
Epoch 17 - update       7830 => loss:   0.264 (#OOM: 0)
Epoch 17 - update       7860 => loss:   0.196 (#OOM: 0)
Epoch 17 - update       7890 => loss:   0.286 (#OOM: 0)
Epoch 17 - update       7920 => loss:   0.329 (#OOM: 0)
Epoch 17 - update       7950 => loss:   0.339 (#OOM: 0)
Epoch 17 - update       7980 => loss:   0.213 (#OOM: 0)
Epoch 17 - update       8010 => loss:   0.235 (#OOM: 0)
Epoch 17 - update       8040 => loss:   0.223 (#OOM: 0)
Epoch 17 - update       8070 => loss:   0.326 (#OOM: 0)
Epoch 17 - update       8100 => loss:   0.435 (#OOM: 0)
Epoch 17 - update       8130 => loss:   0.254 (#OOM: 0)
Epoch 17 - update       8160 => loss:   0.275 (#OOM: 0)
Epoch 17 - update       8190 => loss:   0.235 (#OOM: 0)
--> Epoch 17 finished with mean loss 0.28482
--> Overhead/Training/Evaluation: 0.60/0.72/0.00 mins (total: 1.32 mins)   (671 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 13.46batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.18batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.92batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.79batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.80batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.97batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.29batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.65batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.40batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 14.16batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.28batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.28batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:34, 29.61batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 35.51batch/s]  1%|▎                           | 13/1014 [00:00<00:30, 32.68batch/s]  2%|▍                           | 18/1014 [00:00<00:29, 33.44batch/s]  2%|▋                           | 23/1014 [00:00<00:28, 34.35batch/s]  3%|▊                           | 28/1014 [00:00<00:28, 34.44batch/s]  3%|▉                           | 33/1014 [00:00<00:28, 34.93batch/s]  4%|█                           | 38/1014 [00:01<00:27, 35.45batch/s]  4%|█▏                          | 43/1014 [00:01<00:27, 35.32batch/s]  5%|█▎                          | 48/1014 [00:01<00:27, 35.39batch/s]  5%|█▍                          | 53/1014 [00:01<00:27, 35.44batch/s]  6%|█▌                          | 58/1014 [00:01<00:26, 35.49batch/s]  6%|█▋                          | 63/1014 [00:01<00:26, 35.99batch/s]  7%|█▉                          | 68/1014 [00:01<00:26, 36.23batch/s]  7%|██                          | 73/1014 [00:02<00:26, 35.52batch/s]  8%|██▏                         | 78/1014 [00:02<00:26, 35.66batch/s]  8%|██▎                         | 83/1014 [00:02<00:26, 35.60batch/s]  9%|██▍                         | 88/1014 [00:02<00:25, 35.72batch/s]  9%|██▌                         | 93/1014 [00:02<00:25, 35.70batch/s] 10%|██▋                         | 98/1014 [00:02<00:25, 35.89batch/s] 10%|██▋                        | 103/1014 [00:02<00:25, 35.88batch/s] 11%|██▉                        | 108/1014 [00:02<00:25, 36.22batch/s] 11%|███                        | 113/1014 [00:03<00:24, 36.31batch/s] 12%|███▏                       | 118/1014 [00:03<00:24, 35.88batch/s] 12%|███▎                       | 123/1014 [00:03<00:24, 35.91batch/s] 13%|███▍                       | 128/1014 [00:03<00:24, 35.93batch/s] 13%|███▌                       | 133/1014 [00:03<00:24, 36.02batch/s] 14%|███▋                       | 138/1014 [00:03<00:24, 35.98batch/s] 14%|███▊                       | 143/1014 [00:04<00:24, 35.71batch/s] 15%|███▉                       | 148/1014 [00:04<00:24, 35.50batch/s] 15%|████                       | 153/1014 [00:04<00:24, 35.60batch/s] 16%|████▏                      | 158/1014 [00:04<00:23, 35.71batch/s] 16%|████▎                      | 163/1014 [00:04<00:24, 35.42batch/s] 17%|████▍                      | 168/1014 [00:04<00:23, 35.53batch/s] 17%|████▌                      | 173/1014 [00:04<00:23, 35.56batch/s] 18%|████▋                      | 178/1014 [00:05<00:23, 35.38batch/s] 18%|████▊                      | 183/1014 [00:05<00:23, 35.40batch/s] 19%|█████                      | 188/1014 [00:05<00:23, 35.36batch/s] 19%|█████▏                     | 193/1014 [00:05<00:23, 35.36batch/s] 20%|█████▎                     | 198/1014 [00:05<00:23, 35.39batch/s] 20%|█████▍                     | 203/1014 [00:05<00:22, 35.40batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 35.30batch/s] 21%|█████▋                     | 213/1014 [00:06<00:22, 35.15batch/s] 21%|█████▊                     | 218/1014 [00:06<00:22, 35.30batch/s] 22%|█████▉                     | 223/1014 [00:06<00:22, 35.44batch/s] 22%|██████                     | 228/1014 [00:06<00:22, 35.48batch/s] 23%|██████▏                    | 233/1014 [00:06<00:21, 35.67batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 35.61batch/s] 24%|██████▍                    | 243/1014 [00:06<00:21, 35.37batch/s] 24%|██████▌                    | 248/1014 [00:06<00:21, 35.50batch/s] 25%|██████▋                    | 253/1014 [00:07<00:21, 35.45batch/s] 25%|██████▊                    | 258/1014 [00:07<00:21, 35.50batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 35.54batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 35.41batch/s] 27%|███████▎                   | 273/1014 [00:07<00:20, 35.50batch/s] 27%|███████▍                   | 278/1014 [00:07<00:20, 35.53batch/s] 28%|███████▌                   | 283/1014 [00:07<00:20, 35.60batch/s] 28%|███████▋                   | 288/1014 [00:08<00:20, 35.51batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 35.59batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 35.63batch/s] 30%|████████                   | 303/1014 [00:08<00:19, 35.61batch/s] 30%|████████▏                  | 308/1014 [00:08<00:19, 35.63batch/s] 31%|████████▎                  | 313/1014 [00:08<00:19, 35.64batch/s] 31%|████████▍                  | 318/1014 [00:08<00:19, 35.53batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.53batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 35.51batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 35.51batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 35.53batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:18, 35.55batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:18, 35.56batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:18, 35.62batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 35.69batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 35.64batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 35.66batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:17, 35.64batch/s] 37%|██████████                 | 378/1014 [00:10<00:17, 35.68batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 35.59batch/s] 38%|██████████▎                | 388/1014 [00:10<00:17, 35.68batch/s] 39%|██████████▍                | 393/1014 [00:11<00:17, 35.61batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 35.57batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 35.61batch/s] 40%|██████████▊                | 408/1014 [00:11<00:16, 35.68batch/s] 41%|██████████▉                | 413/1014 [00:11<00:16, 35.70batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 35.59batch/s] 42%|███████████▎               | 423/1014 [00:11<00:16, 35.62batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 35.64batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 35.70batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 35.66batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 35.66batch/s] 44%|███████████▉               | 448/1014 [00:12<00:15, 35.72batch/s] 45%|████████████               | 453/1014 [00:12<00:15, 35.77batch/s] 45%|████████████▏              | 458/1014 [00:12<00:15, 35.74batch/s] 46%|████████████▎              | 463/1014 [00:12<00:15, 35.84batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 35.81batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 35.85batch/s] 47%|████████████▋              | 478/1014 [00:13<00:14, 35.74batch/s] 48%|████████████▊              | 483/1014 [00:13<00:14, 35.67batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 35.63batch/s] 49%|█████████████▏             | 493/1014 [00:13<00:14, 35.61batch/s] 49%|█████████████▎             | 498/1014 [00:13<00:14, 35.59batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.57batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.53batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 35.53batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:13, 35.47batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.35batch/s] 52%|██████████████             | 528/1014 [00:14<00:13, 35.27batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 35.20batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.20batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 35.17batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.13batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 35.16batch/s] 55%|██████████████▊            | 558/1014 [00:15<00:12, 35.15batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:12, 35.18batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 35.18batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 35.14batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.15batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.12batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 35.17batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 35.21batch/s] 59%|███████████████▉           | 598/1014 [00:16<00:11, 35.21batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 35.24batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.25batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.30batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 35.25batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 35.13batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:10, 35.17batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:10, 35.12batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.13batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.12batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 35.11batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 35.14batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 35.20batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:09, 35.15batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:09, 35.13batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.15batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 35.17batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 35.17batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.22batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:09, 35.21batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.24batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 35.26batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 35.24batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 35.23batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.20batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 35.16batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.18batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:07, 35.19batch/s] 73%|███████████████████▋       | 738/1014 [00:20<00:07, 35.20batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 35.14batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.12batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 35.10batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.12batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.13batch/s] 76%|████████████████████▍      | 768/1014 [00:21<00:07, 35.13batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 35.08batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 35.09batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 35.09batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 35.10batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.08batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 35.11batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:06, 35.12batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 35.11batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 35.13batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 35.11batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.11batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 35.10batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.06batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:05, 35.06batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 35.09batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 35.05batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.01batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 35.02batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.99batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 34.96batch/s] 86%|███████████████████████▏   | 873/1014 [00:24<00:04, 34.95batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.94batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.98batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.94batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.94batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.90batch/s] 89%|████████████████████████   | 903/1014 [00:25<00:03, 34.90batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.91batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.92batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.91batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.91batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.93batch/s] 92%|████████████████████████▊  | 933/1014 [00:26<00:02, 34.90batch/s] 93%|████████████████████████▉  | 938/1014 [00:26<00:02, 34.86batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 34.88batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.81batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.81batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.81batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 34.82batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 34.82batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 34.82batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.81batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.79batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.79batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 34.80batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 34.76batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 34.71batch/s] 99%|█████████████████████████▊| 1008/1014 [00:29<00:00, 34.72batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.69batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.69batch/s]
Validation 17 -> LOSS = 0.31
Validation 17 -> BLEU = 94.20, 97.7/95.2/93.1/91.0 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.31 @ validation 17
--> Best BLEU so far: 94.20 @ validation 17
Starting Epoch 18
Epoch 18 - update       8220 => loss:   0.195 (#OOM: 0)
Epoch 18 - update       8250 => loss:   0.198 (#OOM: 0)
Epoch 18 - update       8280 => loss:   0.254 (#OOM: 0)
Epoch 18 - update       8310 => loss:   0.302 (#OOM: 0)
Epoch 18 - update       8340 => loss:   0.173 (#OOM: 0)
Epoch 18 - update       8370 => loss:   0.209 (#OOM: 0)
Epoch 18 - update       8400 => loss:   0.231 (#OOM: 0)
Epoch 18 - update       8430 => loss:   0.370 (#OOM: 0)
Epoch 18 - update       8460 => loss:   0.217 (#OOM: 0)
Epoch 18 - update       8490 => loss:   0.258 (#OOM: 0)
Epoch 18 - update       8520 => loss:   0.361 (#OOM: 0)
Epoch 18 - update       8550 => loss:   0.315 (#OOM: 0)
Epoch 18 - update       8580 => loss:   0.332 (#OOM: 0)
Epoch 18 - update       8610 => loss:   0.260 (#OOM: 0)
Epoch 18 - update       8640 => loss:   0.255 (#OOM: 0)
Epoch 18 - update       8670 => loss:   0.345 (#OOM: 0)
--> Epoch 18 finished with mean loss 0.26572
--> Overhead/Training/Evaluation: 0.64/0.73/0.00 mins (total: 1.36 mins)   (666 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  7.43batch/s]  9%|██▋                            | 3/34 [00:00<00:03,  8.48batch/s] 15%|████▌                          | 5/34 [00:00<00:03,  9.23batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.46batch/s] 32%|█████████▋                    | 11/34 [00:00<00:02, 11.31batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.24batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 11.62batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.53batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.44batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.13batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.00batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.16batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.37batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:33, 30.02batch/s]  1%|▏                            | 8/1014 [00:00<00:31, 31.98batch/s]  1%|▎                           | 12/1014 [00:00<00:30, 32.66batch/s]  2%|▍                           | 16/1014 [00:00<00:29, 33.62batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 34.28batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.69batch/s]  3%|▊                           | 29/1014 [00:00<00:27, 35.35batch/s]  3%|▉                           | 34/1014 [00:00<00:27, 35.29batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.02batch/s]  4%|█▏                          | 44/1014 [00:01<00:28, 34.32batch/s]  5%|█▎                          | 49/1014 [00:01<00:28, 34.20batch/s]  5%|█▍                          | 54/1014 [00:01<00:27, 34.30batch/s]  6%|█▋                          | 59/1014 [00:01<00:27, 34.22batch/s]  6%|█▊                          | 64/1014 [00:01<00:27, 34.10batch/s]  7%|█▉                          | 69/1014 [00:02<00:27, 33.90batch/s]  7%|██                          | 74/1014 [00:02<00:27, 34.09batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 34.39batch/s]  8%|██▎                         | 84/1014 [00:02<00:26, 34.80batch/s]  9%|██▍                         | 89/1014 [00:02<00:26, 34.77batch/s]  9%|██▌                         | 94/1014 [00:02<00:26, 34.78batch/s] 10%|██▋                         | 99/1014 [00:02<00:26, 34.67batch/s] 10%|██▊                        | 104/1014 [00:03<00:26, 34.27batch/s] 11%|██▉                        | 109/1014 [00:03<00:26, 34.39batch/s] 11%|███                        | 114/1014 [00:03<00:26, 34.14batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 34.40batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 34.42batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.48batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.78batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 34.70batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.77batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 34.83batch/s] 15%|████                       | 154/1014 [00:04<00:24, 34.87batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 35.16batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 35.13batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.85batch/s] 17%|████▋                      | 174/1014 [00:04<00:24, 34.84batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 34.80batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 34.91batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 34.84batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.88batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.79batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.83batch/s] 21%|█████▌                     | 209/1014 [00:05<00:23, 34.84batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.74batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 34.58batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.74batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.47batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.44batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.37batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.48batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 34.59batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 34.71batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.69batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.72batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.58batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 34.50batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.47batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 34.32batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.35batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.29batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.26batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.14batch/s] 30%|████████▏                  | 309/1014 [00:09<00:20, 34.03batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.07batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.08batch/s] 32%|████████▋                  | 324/1014 [00:09<00:20, 34.02batch/s] 32%|████████▊                  | 329/1014 [00:09<00:20, 33.98batch/s] 33%|████████▉                  | 334/1014 [00:09<00:20, 33.84batch/s] 33%|█████████                  | 339/1014 [00:10<00:20, 33.64batch/s] 34%|█████████▏                 | 344/1014 [00:10<00:20, 32.89batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:20, 32.52batch/s] 35%|█████████▍                 | 354/1014 [00:11<00:20, 32.16batch/s] 35%|█████████▌                 | 359/1014 [00:11<00:20, 31.97batch/s] 36%|█████████▋                 | 364/1014 [00:11<00:20, 31.85batch/s] 36%|█████████▊                 | 369/1014 [00:11<00:20, 31.69batch/s] 37%|█████████▉                 | 374/1014 [00:11<00:20, 31.56batch/s] 37%|██████████                 | 379/1014 [00:12<00:20, 31.27batch/s] 38%|██████████▏                | 384/1014 [00:12<00:20, 31.18batch/s] 38%|██████████▎                | 389/1014 [00:12<00:20, 30.99batch/s] 39%|██████████▍                | 394/1014 [00:12<00:20, 30.89batch/s] 39%|██████████▌                | 399/1014 [00:12<00:19, 30.76batch/s] 40%|██████████▊                | 404/1014 [00:13<00:19, 30.61batch/s] 40%|██████████▉                | 409/1014 [00:13<00:19, 30.57batch/s] 41%|███████████                | 414/1014 [00:13<00:19, 30.61batch/s] 41%|███████████▏               | 419/1014 [00:13<00:19, 30.57batch/s] 42%|███████████▎               | 424/1014 [00:13<00:19, 30.44batch/s] 42%|███████████▍               | 429/1014 [00:14<00:19, 30.35batch/s] 43%|███████████▌               | 434/1014 [00:14<00:19, 30.25batch/s] 43%|███████████▋               | 439/1014 [00:14<00:19, 30.22batch/s] 44%|███████████▊               | 444/1014 [00:14<00:18, 30.03batch/s] 44%|███████████▉               | 449/1014 [00:14<00:18, 30.08batch/s] 45%|████████████               | 454/1014 [00:15<00:18, 30.15batch/s] 45%|████████████▏              | 459/1014 [00:15<00:18, 30.15batch/s] 46%|████████████▎              | 464/1014 [00:15<00:18, 30.23batch/s] 46%|████████████▍              | 469/1014 [00:15<00:17, 30.30batch/s] 47%|████████████▌              | 474/1014 [00:15<00:17, 30.18batch/s] 47%|████████████▊              | 479/1014 [00:15<00:17, 30.22batch/s] 48%|████████████▉              | 484/1014 [00:16<00:17, 30.23batch/s] 48%|█████████████              | 489/1014 [00:16<00:17, 30.24batch/s] 49%|█████████████▏             | 494/1014 [00:16<00:17, 30.27batch/s] 49%|█████████████▎             | 499/1014 [00:16<00:16, 30.36batch/s] 50%|█████████████▍             | 504/1014 [00:16<00:16, 30.39batch/s] 50%|█████████████▌             | 509/1014 [00:16<00:16, 30.44batch/s] 51%|█████████████▋             | 514/1014 [00:16<00:16, 30.48batch/s] 51%|█████████████▊             | 519/1014 [00:17<00:16, 30.49batch/s] 52%|█████████████▉             | 524/1014 [00:17<00:16, 30.53batch/s] 52%|██████████████             | 529/1014 [00:17<00:15, 30.62batch/s] 53%|██████████████▏            | 534/1014 [00:17<00:15, 30.66batch/s] 53%|██████████████▎            | 539/1014 [00:17<00:15, 30.71batch/s] 54%|██████████████▍            | 544/1014 [00:17<00:15, 30.70batch/s] 54%|██████████████▌            | 549/1014 [00:17<00:15, 30.74batch/s] 55%|██████████████▊            | 554/1014 [00:17<00:14, 30.79batch/s] 55%|██████████████▉            | 559/1014 [00:18<00:14, 30.85batch/s] 56%|███████████████            | 564/1014 [00:18<00:14, 30.88batch/s] 56%|███████████████▏           | 569/1014 [00:18<00:14, 30.93batch/s] 57%|███████████████▎           | 574/1014 [00:18<00:14, 30.93batch/s] 57%|███████████████▍           | 579/1014 [00:18<00:14, 31.01batch/s] 58%|███████████████▌           | 584/1014 [00:18<00:13, 30.98batch/s] 58%|███████████████▋           | 589/1014 [00:19<00:13, 30.99batch/s] 59%|███████████████▊           | 594/1014 [00:19<00:13, 30.99batch/s] 59%|███████████████▉           | 599/1014 [00:19<00:13, 31.04batch/s] 60%|████████████████           | 604/1014 [00:19<00:13, 31.08batch/s] 60%|████████████████▏          | 609/1014 [00:19<00:13, 31.12batch/s] 61%|████████████████▎          | 614/1014 [00:19<00:12, 31.15batch/s] 61%|████████████████▍          | 619/1014 [00:19<00:12, 31.17batch/s] 62%|████████████████▌          | 624/1014 [00:19<00:12, 31.21batch/s] 62%|████████████████▋          | 629/1014 [00:20<00:12, 31.26batch/s] 63%|████████████████▉          | 634/1014 [00:20<00:12, 31.29batch/s] 63%|█████████████████          | 639/1014 [00:20<00:11, 31.34batch/s] 64%|█████████████████▏         | 644/1014 [00:20<00:11, 31.40batch/s] 64%|█████████████████▎         | 649/1014 [00:20<00:11, 31.44batch/s] 64%|█████████████████▍         | 654/1014 [00:20<00:11, 31.44batch/s] 65%|█████████████████▌         | 659/1014 [00:20<00:11, 31.42batch/s] 65%|█████████████████▋         | 664/1014 [00:21<00:11, 31.48batch/s] 66%|█████████████████▊         | 669/1014 [00:21<00:10, 31.51batch/s] 66%|█████████████████▉         | 674/1014 [00:21<00:10, 31.52batch/s] 67%|██████████████████         | 679/1014 [00:21<00:10, 31.54batch/s] 67%|██████████████████▏        | 684/1014 [00:21<00:10, 31.55batch/s] 68%|██████████████████▎        | 689/1014 [00:21<00:10, 31.59batch/s] 68%|██████████████████▍        | 694/1014 [00:21<00:10, 31.60batch/s] 69%|██████████████████▌        | 699/1014 [00:22<00:09, 31.56batch/s] 69%|██████████████████▋        | 704/1014 [00:22<00:09, 31.50batch/s] 70%|██████████████████▉        | 709/1014 [00:22<00:09, 31.52batch/s] 70%|███████████████████        | 714/1014 [00:22<00:09, 31.57batch/s] 71%|███████████████████▏       | 719/1014 [00:22<00:09, 31.58batch/s] 71%|███████████████████▎       | 724/1014 [00:22<00:09, 31.60batch/s] 72%|███████████████████▍       | 729/1014 [00:23<00:09, 31.62batch/s] 72%|███████████████████▌       | 734/1014 [00:23<00:08, 31.62batch/s] 73%|███████████████████▋       | 739/1014 [00:23<00:08, 31.62batch/s] 73%|███████████████████▊       | 744/1014 [00:23<00:08, 31.64batch/s] 74%|███████████████████▉       | 749/1014 [00:23<00:08, 31.65batch/s] 74%|████████████████████       | 754/1014 [00:23<00:08, 31.65batch/s] 75%|████████████████████▏      | 759/1014 [00:24<00:08, 31.62batch/s] 75%|████████████████████▎      | 764/1014 [00:24<00:07, 31.61batch/s] 76%|████████████████████▍      | 769/1014 [00:24<00:07, 31.63batch/s] 76%|████████████████████▌      | 774/1014 [00:24<00:07, 31.69batch/s] 77%|████████████████████▋      | 779/1014 [00:24<00:07, 31.68batch/s] 77%|████████████████████▉      | 784/1014 [00:24<00:07, 31.73batch/s] 78%|█████████████████████      | 789/1014 [00:24<00:07, 31.76batch/s] 78%|█████████████████████▏     | 794/1014 [00:24<00:06, 31.80batch/s] 79%|█████████████████████▎     | 799/1014 [00:25<00:06, 31.80batch/s] 79%|█████████████████████▍     | 804/1014 [00:25<00:06, 31.79batch/s] 80%|█████████████████████▌     | 809/1014 [00:25<00:06, 31.78batch/s] 80%|█████████████████████▋     | 814/1014 [00:25<00:06, 31.82batch/s] 81%|█████████████████████▊     | 819/1014 [00:25<00:06, 31.83batch/s] 81%|█████████████████████▉     | 824/1014 [00:25<00:05, 31.88batch/s] 82%|██████████████████████     | 829/1014 [00:25<00:05, 31.89batch/s] 82%|██████████████████████▏    | 834/1014 [00:26<00:05, 31.89batch/s] 83%|██████████████████████▎    | 839/1014 [00:26<00:05, 31.89batch/s] 83%|██████████████████████▍    | 844/1014 [00:26<00:05, 31.90batch/s] 84%|██████████████████████▌    | 849/1014 [00:26<00:05, 31.89batch/s] 84%|██████████████████████▋    | 854/1014 [00:26<00:05, 31.92batch/s] 85%|██████████████████████▊    | 859/1014 [00:26<00:04, 31.95batch/s] 85%|███████████████████████    | 864/1014 [00:27<00:04, 31.98batch/s] 86%|███████████████████████▏   | 869/1014 [00:27<00:04, 32.00batch/s] 86%|███████████████████████▎   | 874/1014 [00:27<00:04, 31.99batch/s] 87%|███████████████████████▍   | 879/1014 [00:27<00:04, 32.01batch/s] 87%|███████████████████████▌   | 884/1014 [00:27<00:04, 32.02batch/s] 88%|███████████████████████▋   | 889/1014 [00:27<00:03, 32.08batch/s] 88%|███████████████████████▊   | 894/1014 [00:27<00:03, 32.14batch/s] 89%|███████████████████████▉   | 899/1014 [00:27<00:03, 32.17batch/s] 89%|████████████████████████   | 904/1014 [00:28<00:03, 32.16batch/s] 90%|████████████████████████▏  | 909/1014 [00:28<00:03, 32.13batch/s] 90%|████████████████████████▎  | 914/1014 [00:28<00:03, 32.12batch/s] 91%|████████████████████████▍  | 919/1014 [00:28<00:02, 32.15batch/s] 91%|████████████████████████▌  | 924/1014 [00:28<00:02, 32.19batch/s] 92%|████████████████████████▋  | 929/1014 [00:28<00:02, 32.21batch/s] 92%|████████████████████████▊  | 934/1014 [00:28<00:02, 32.25batch/s] 93%|█████████████████████████  | 939/1014 [00:29<00:02, 32.27batch/s] 93%|█████████████████████████▏ | 944/1014 [00:29<00:02, 32.31batch/s] 94%|█████████████████████████▎ | 949/1014 [00:29<00:02, 32.31batch/s] 94%|█████████████████████████▍ | 954/1014 [00:29<00:01, 32.32batch/s] 95%|█████████████████████████▌ | 959/1014 [00:29<00:01, 32.33batch/s] 95%|█████████████████████████▋ | 964/1014 [00:29<00:01, 32.35batch/s] 96%|█████████████████████████▊ | 969/1014 [00:29<00:01, 32.33batch/s] 96%|█████████████████████████▉ | 974/1014 [00:30<00:01, 32.33batch/s] 97%|██████████████████████████ | 979/1014 [00:30<00:01, 32.31batch/s] 97%|██████████████████████████▏| 984/1014 [00:30<00:00, 32.30batch/s] 98%|██████████████████████████▎| 989/1014 [00:30<00:00, 32.30batch/s] 98%|██████████████████████████▍| 994/1014 [00:30<00:00, 32.33batch/s] 99%|██████████████████████████▌| 999/1014 [00:30<00:00, 32.37batch/s] 99%|█████████████████████████▋| 1004/1014 [00:31<00:00, 32.36batch/s]100%|█████████████████████████▊| 1009/1014 [00:31<00:00, 32.39batch/s]100%|██████████████████████████| 1014/1014 [00:31<00:00, 32.43batch/s]100%|██████████████████████████| 1014/1014 [00:31<00:00, 32.43batch/s]
Validation 18 -> LOSS = 0.30
Validation 18 -> BLEU = 93.80, 97.1/94.7/92.8/90.8 (BP=1.000, ratio=1.006, hyp_len=14474, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.30 @ validation 18
--> Best BLEU so far: 94.20 @ validation 17
Starting Epoch 19
Epoch 19 - update       8700 => loss:   0.236 (#OOM: 0)
Epoch 19 - update       8730 => loss:   0.290 (#OOM: 0)
Epoch 19 - update       8760 => loss:   0.178 (#OOM: 0)
Epoch 19 - update       8790 => loss:   0.276 (#OOM: 0)
Epoch 19 - update       8820 => loss:   0.164 (#OOM: 0)
Epoch 19 - update       8850 => loss:   0.236 (#OOM: 0)
Epoch 19 - update       8880 => loss:   0.208 (#OOM: 0)
Epoch 19 - update       8910 => loss:   0.317 (#OOM: 0)
Epoch 19 - update       8940 => loss:   0.261 (#OOM: 0)
Epoch 19 - update       8970 => loss:   0.245 (#OOM: 0)
Epoch 19 - update       9000 => loss:   0.165 (#OOM: 0)
Epoch 19 - update       9030 => loss:   0.245 (#OOM: 0)
Epoch 19 - update       9060 => loss:   0.212 (#OOM: 0)
Epoch 19 - update       9090 => loss:   0.364 (#OOM: 0)
Epoch 19 - update       9120 => loss:   0.194 (#OOM: 0)
Epoch 19 - update       9150 => loss:   0.185 (#OOM: 0)
--> Epoch 19 finished with mean loss 0.24881
--> Overhead/Training/Evaluation: 0.61/0.72/0.00 mins (total: 1.34 mins)   (669 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.26batch/s]  9%|██▋                            | 3/34 [00:00<00:03, 10.14batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.12batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 11.42batch/s] 26%|████████▏                      | 9/34 [00:00<00:02, 11.55batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.96batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.29batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.47batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.26batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.61batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.97batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.08batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:21, 47.02batch/s]  1%|▎                           | 10/1014 [00:00<00:28, 35.78batch/s]  1%|▍                           | 15/1014 [00:00<00:28, 35.23batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 34.77batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 35.12batch/s]  3%|▊                           | 30/1014 [00:00<00:28, 34.94batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.29batch/s]  4%|█                           | 40/1014 [00:01<00:28, 34.33batch/s]  4%|█▏                          | 45/1014 [00:01<00:28, 34.37batch/s]  5%|█▍                          | 50/1014 [00:01<00:27, 34.56batch/s]  5%|█▌                          | 55/1014 [00:01<00:27, 34.33batch/s]  6%|█▋                          | 60/1014 [00:01<00:27, 34.78batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 34.37batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.07batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.03batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 34.33batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 33.95batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 33.35batch/s]  9%|██▌                         | 95/1014 [00:02<00:27, 33.10batch/s] 10%|██▋                        | 100/1014 [00:03<00:27, 33.18batch/s] 10%|██▊                        | 105/1014 [00:03<00:27, 33.26batch/s] 11%|██▉                        | 110/1014 [00:03<00:27, 33.45batch/s] 11%|███                        | 115/1014 [00:03<00:26, 33.47batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 33.60batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 33.38batch/s] 13%|███▍                       | 130/1014 [00:03<00:26, 33.47batch/s] 13%|███▌                       | 135/1014 [00:04<00:26, 33.71batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 33.83batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.00batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.10batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 34.19batch/s] 16%|████▎                      | 160/1014 [00:04<00:25, 34.01batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.08batch/s] 17%|████▌                      | 170/1014 [00:05<00:24, 33.85batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 33.96batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.19batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 34.33batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.39batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.29batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.27batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.32batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.38batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.33batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.39batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 34.22batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.26batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.26batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.29batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.38batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.33batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 34.22batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.34batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.30batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.37batch/s] 27%|███████▎                   | 275/1014 [00:08<00:21, 34.35batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.15batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 34.03batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 34.00batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 34.05batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.07batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.12batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 34.14batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.14batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.24batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 34.25batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.33batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.31batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.30batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 34.32batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.32batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.21batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 34.25batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.23batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.25batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.22batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.21batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.20batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.23batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 34.25batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.15batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.16batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.21batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 34.22batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.17batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.08batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 34.12batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.16batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.19batch/s] 44%|███████████▊               | 445/1014 [00:13<00:16, 34.01batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.06batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.98batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 33.89batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 33.89batch/s] 46%|████████████▌              | 470/1014 [00:13<00:16, 33.92batch/s] 47%|████████████▋              | 475/1014 [00:14<00:15, 33.87batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 33.92batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.92batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 33.95batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 33.91batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 33.89batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:15, 33.84batch/s] 50%|█████████████▌             | 510/1014 [00:15<00:14, 33.83batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 33.79batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 33.88batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 33.91batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.88batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 33.85batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 33.86batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 33.93batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 33.91batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 33.94batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.95batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 34.01batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 34.04batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.05batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 34.03batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 33.97batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.95batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 33.99batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 33.93batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 33.83batch/s] 60%|████████████████▏          | 610/1014 [00:18<00:11, 33.83batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 33.80batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 33.84batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 33.87batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 33.88batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 33.87batch/s] 63%|█████████████████          | 640/1014 [00:18<00:11, 33.85batch/s] 64%|█████████████████▏         | 645/1014 [00:19<00:10, 33.87batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 33.88batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 33.85batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 33.81batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.75batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 33.71batch/s] 67%|█████████████████▉         | 675/1014 [00:20<00:10, 33.66batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.67batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 33.65batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.59batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 33.58batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 33.59batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 33.58batch/s] 70%|██████████████████▉        | 710/1014 [00:21<00:09, 33.51batch/s] 71%|███████████████████        | 715/1014 [00:21<00:08, 33.38batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 33.16batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 33.11batch/s] 72%|███████████████████▍       | 730/1014 [00:22<00:08, 33.03batch/s] 72%|███████████████████▌       | 735/1014 [00:22<00:08, 32.92batch/s] 73%|███████████████████▋       | 740/1014 [00:22<00:08, 32.84batch/s] 73%|███████████████████▊       | 745/1014 [00:22<00:08, 32.71batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:08, 32.64batch/s] 74%|████████████████████       | 755/1014 [00:23<00:07, 32.64batch/s] 75%|████████████████████▏      | 760/1014 [00:23<00:07, 32.60batch/s] 75%|████████████████████▎      | 765/1014 [00:23<00:07, 32.61batch/s] 76%|████████████████████▌      | 770/1014 [00:23<00:07, 32.62batch/s] 76%|████████████████████▋      | 775/1014 [00:23<00:07, 32.64batch/s] 77%|████████████████████▊      | 780/1014 [00:23<00:07, 32.67batch/s] 77%|████████████████████▉      | 785/1014 [00:24<00:07, 32.70batch/s] 78%|█████████████████████      | 790/1014 [00:24<00:06, 32.75batch/s] 78%|█████████████████████▏     | 795/1014 [00:24<00:06, 32.75batch/s] 79%|█████████████████████▎     | 800/1014 [00:24<00:06, 32.72batch/s] 79%|█████████████████████▍     | 805/1014 [00:24<00:06, 32.67batch/s] 80%|█████████████████████▌     | 810/1014 [00:24<00:06, 32.70batch/s] 80%|█████████████████████▋     | 815/1014 [00:24<00:06, 32.65batch/s] 81%|█████████████████████▊     | 820/1014 [00:25<00:05, 32.66batch/s] 81%|█████████████████████▉     | 825/1014 [00:25<00:05, 32.45batch/s] 82%|██████████████████████     | 830/1014 [00:25<00:05, 32.45batch/s] 82%|██████████████████████▏    | 835/1014 [00:25<00:05, 32.48batch/s] 83%|██████████████████████▎    | 840/1014 [00:25<00:05, 32.51batch/s] 83%|██████████████████████▌    | 845/1014 [00:25<00:05, 32.51batch/s] 84%|██████████████████████▋    | 850/1014 [00:26<00:05, 32.57batch/s] 84%|██████████████████████▊    | 855/1014 [00:26<00:04, 32.61batch/s] 85%|██████████████████████▉    | 860/1014 [00:26<00:04, 32.61batch/s] 85%|███████████████████████    | 865/1014 [00:26<00:04, 32.62batch/s] 86%|███████████████████████▏   | 870/1014 [00:26<00:04, 32.57batch/s] 86%|███████████████████████▎   | 875/1014 [00:26<00:04, 32.58batch/s] 87%|███████████████████████▍   | 880/1014 [00:26<00:04, 32.63batch/s] 87%|███████████████████████▌   | 885/1014 [00:27<00:03, 32.64batch/s] 88%|███████████████████████▋   | 890/1014 [00:27<00:03, 32.63batch/s] 88%|███████████████████████▊   | 895/1014 [00:27<00:03, 32.67batch/s] 89%|███████████████████████▉   | 900/1014 [00:27<00:03, 32.64batch/s] 89%|████████████████████████   | 905/1014 [00:27<00:03, 32.67batch/s] 90%|████████████████████████▏  | 910/1014 [00:27<00:03, 32.67batch/s] 90%|████████████████████████▎  | 915/1014 [00:27<00:03, 32.72batch/s] 91%|████████████████████████▍  | 920/1014 [00:28<00:02, 32.77batch/s] 91%|████████████████████████▋  | 925/1014 [00:28<00:02, 32.81batch/s] 92%|████████████████████████▊  | 930/1014 [00:28<00:02, 32.83batch/s] 92%|████████████████████████▉  | 935/1014 [00:28<00:02, 32.86batch/s] 93%|█████████████████████████  | 940/1014 [00:28<00:02, 32.72batch/s] 93%|█████████████████████████▏ | 945/1014 [00:28<00:02, 32.71batch/s] 94%|█████████████████████████▎ | 950/1014 [00:29<00:01, 32.73batch/s] 94%|█████████████████████████▍ | 955/1014 [00:29<00:01, 32.75batch/s] 95%|█████████████████████████▌ | 960/1014 [00:29<00:01, 32.78batch/s] 95%|█████████████████████████▋ | 965/1014 [00:29<00:01, 32.77batch/s] 96%|█████████████████████████▊ | 970/1014 [00:29<00:01, 32.77batch/s] 96%|█████████████████████████▉ | 975/1014 [00:29<00:01, 32.78batch/s] 97%|██████████████████████████ | 980/1014 [00:29<00:01, 32.80batch/s] 97%|██████████████████████████▏| 985/1014 [00:30<00:00, 32.82batch/s] 98%|██████████████████████████▎| 990/1014 [00:30<00:00, 32.82batch/s] 98%|██████████████████████████▍| 995/1014 [00:30<00:00, 32.83batch/s] 99%|█████████████████████████▋| 1000/1014 [00:30<00:00, 32.83batch/s] 99%|█████████████████████████▊| 1005/1014 [00:30<00:00, 32.83batch/s]100%|█████████████████████████▉| 1010/1014 [00:30<00:00, 32.84batch/s]100%|██████████████████████████| 1014/1014 [00:30<00:00, 32.82batch/s]
Validation 19 -> LOSS = 0.29
Validation 19 -> BLEU = 94.36, 97.5/95.2/93.4/91.4 (BP=1.000, ratio=1.003, hyp_len=14423, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.29 @ validation 19
--> Best BLEU so far: 94.36 @ validation 19
Starting Epoch 20
Epoch 20 - update       9180 => loss:   0.207 (#OOM: 0)
Epoch 20 - update       9210 => loss:   0.255 (#OOM: 0)
Epoch 20 - update       9240 => loss:   0.222 (#OOM: 0)
Epoch 20 - update       9270 => loss:   0.256 (#OOM: 0)
Epoch 20 - update       9300 => loss:   0.198 (#OOM: 0)
Epoch 20 - update       9330 => loss:   0.206 (#OOM: 0)
Epoch 20 - update       9360 => loss:   0.188 (#OOM: 0)
Epoch 20 - update       9390 => loss:   0.339 (#OOM: 0)
Epoch 20 - update       9420 => loss:   0.270 (#OOM: 0)
Epoch 20 - update       9450 => loss:   0.267 (#OOM: 0)
Epoch 20 - update       9480 => loss:   0.138 (#OOM: 0)
Epoch 20 - update       9510 => loss:   0.184 (#OOM: 0)
Epoch 20 - update       9540 => loss:   0.243 (#OOM: 0)
Epoch 20 - update       9570 => loss:   0.287 (#OOM: 0)
Epoch 20 - update       9600 => loss:   0.254 (#OOM: 0)
Epoch 20 - update       9630 => loss:   0.319 (#OOM: 0)
--> Epoch 20 finished with mean loss 0.23014
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.34 mins)   (676 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.70batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 16.39batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 13.21batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.64batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.05batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.38batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.92batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.21batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.83batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.76batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.76batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.94batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.94batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 34.82batch/s]  1%|▎                            | 9/1014 [00:00<00:26, 37.74batch/s]  1%|▍                           | 14/1014 [00:00<00:24, 40.21batch/s]  2%|▌                           | 19/1014 [00:00<00:25, 39.21batch/s]  2%|▋                           | 24/1014 [00:00<00:26, 38.03batch/s]  3%|▊                           | 29/1014 [00:00<00:26, 37.09batch/s]  3%|▉                           | 34/1014 [00:00<00:27, 36.00batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.43batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.14batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 34.92batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 35.63batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 35.86batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 35.43batch/s]  7%|█▉                          | 69/1014 [00:01<00:27, 34.53batch/s]  7%|██                          | 74/1014 [00:02<00:27, 34.48batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 34.14batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 34.23batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 34.09batch/s]  9%|██▌                         | 94/1014 [00:02<00:27, 33.90batch/s] 10%|██▋                         | 99/1014 [00:02<00:27, 33.80batch/s] 10%|██▊                        | 104/1014 [00:03<00:27, 33.67batch/s] 11%|██▉                        | 109/1014 [00:03<00:27, 33.39batch/s] 11%|███                        | 114/1014 [00:03<00:26, 33.57batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 33.75batch/s] 12%|███▎                       | 124/1014 [00:03<00:26, 34.02batch/s] 13%|███▍                       | 129/1014 [00:03<00:26, 33.95batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.04batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 33.89batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.00batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 34.21batch/s] 15%|████                       | 154/1014 [00:04<00:25, 34.28batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.44batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.61batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.79batch/s] 17%|████▋                      | 174/1014 [00:04<00:24, 34.87batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 34.84batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 34.89batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 34.87batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 35.09batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.96batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 35.08batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.02batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.72batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 34.58batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.64batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.55batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.52batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.51batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.62batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 34.59batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 34.68batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.84batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.95batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.97batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 34.83batch/s] 28%|███████▍                   | 279/1014 [00:07<00:21, 34.92batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 34.87batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 34.96batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.03batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.05batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.02batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 35.13batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.20batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 35.27batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.23batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.25batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.32batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.23batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 35.25batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.33batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 35.31batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.43batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.44batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 35.36batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.32batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 35.24batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.21batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.26batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.29batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.25batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.29batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.27batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.19batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.24batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.17batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.10batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.17batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.11batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 35.20batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 35.16batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.17batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 35.25batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.23batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.23batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.31batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 35.30batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 35.31batch/s] 48%|█████████████              | 489/1014 [00:13<00:14, 35.29batch/s] 49%|█████████████▏             | 494/1014 [00:13<00:14, 35.31batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.35batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 35.37batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.28batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.19batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 35.20batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.22batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 35.21batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 35.22batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.24batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.17batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.16batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.15batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.18batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 35.20batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.23batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.14batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.18batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.21batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.18batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.15batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 35.14batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.01batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.94batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.87batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.89batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.87batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.87batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.91batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.93batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.92batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 34.90batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.95batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.93batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:10, 34.95batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.96batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.00batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.89batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.90batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.91batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.88batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.91batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.89batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.93batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.89batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.85batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.75batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 34.80batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 34.80batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.81batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.83batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.85batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.84batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.83batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 34.80batch/s] 76%|████████████████████▍      | 769/1014 [00:22<00:07, 34.83batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 34.86batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.87batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.85batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.85batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.83batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.78batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.80batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.84batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.88batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 34.88batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.83batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 34.86batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 34.90batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.87batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.89batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.82batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.86batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.87batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 34.84batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 34.84batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.82batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.84batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.86batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.87batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 34.87batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.86batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 34.85batch/s] 90%|████████████████████████▏  | 909/1014 [00:26<00:03, 34.82batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.81batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.83batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.85batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.85batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.85batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 34.86batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.87batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.88batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.87batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.78batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.79batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.77batch/s] 96%|█████████████████████████▉ | 974/1014 [00:28<00:01, 34.78batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.82batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.80batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.77batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.77batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 34.77batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.76batch/s]100%|█████████████████████████▊| 1009/1014 [00:29<00:00, 34.78batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.79batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.79batch/s]
Validation 20 -> LOSS = 0.29
Validation 20 -> BLEU = 94.88, 97.9/95.7/93.9/92.1 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.29 @ validation 20
--> Best BLEU so far: 94.88 @ validation 20
Starting Epoch 21
Epoch 21 - update       9660 => loss:   0.141 (#OOM: 0)
Epoch 21 - update       9690 => loss:   0.121 (#OOM: 0)
Epoch 21 - update       9720 => loss:   0.301 (#OOM: 0)
Epoch 21 - update       9750 => loss:   0.267 (#OOM: 0)
Epoch 21 - update       9780 => loss:   0.195 (#OOM: 0)
Epoch 21 - update       9810 => loss:   0.157 (#OOM: 0)
Epoch 21 - update       9840 => loss:   0.263 (#OOM: 0)
Epoch 21 - update       9870 => loss:   0.170 (#OOM: 0)
Epoch 21 - update       9900 => loss:   0.250 (#OOM: 0)
Epoch 21 - update       9930 => loss:   0.312 (#OOM: 0)
Epoch 21 - update       9960 => loss:   0.202 (#OOM: 0)
Epoch 21 - update       9990 => loss:   0.198 (#OOM: 0)
Epoch 21 - update      10020 => loss:   0.290 (#OOM: 0)
Epoch 21 - update      10050 => loss:   0.208 (#OOM: 0)
Epoch 21 - update      10080 => loss:   0.123 (#OOM: 0)
Epoch 21 - update      10110 => loss:   0.288 (#OOM: 0)
--> Epoch 21 finished with mean loss 0.21786
--> Overhead/Training/Evaluation: 0.64/0.72/0.00 mins (total: 1.36 mins)   (667 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.65batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.23batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 10.59batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.27batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.24batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.32batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.43batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.83batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.85batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.96batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.89batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.01batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.33batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.62batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.79batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.62batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.85batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.21batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.21batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:27, 36.55batch/s]  1%|▎                           | 10/1014 [00:00<00:29, 33.94batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 36.39batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 35.25batch/s]  2%|▋                           | 25/1014 [00:00<00:26, 36.97batch/s]  3%|▊                           | 30/1014 [00:00<00:26, 37.37batch/s]  3%|▉                           | 35/1014 [00:00<00:26, 36.89batch/s]  4%|█                           | 40/1014 [00:01<00:26, 36.46batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 36.96batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.83batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.04batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.46batch/s]  6%|█▊                          | 65/1014 [00:01<00:25, 36.53batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 36.57batch/s]  7%|██                          | 75/1014 [00:02<00:25, 36.89batch/s]  8%|██▏                         | 80/1014 [00:02<00:25, 36.83batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.72batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 36.79batch/s]  9%|██▌                         | 95/1014 [00:02<00:24, 36.76batch/s] 10%|██▋                        | 100/1014 [00:02<00:24, 36.98batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 37.18batch/s] 11%|██▉                        | 110/1014 [00:02<00:24, 37.26batch/s] 11%|███                        | 115/1014 [00:03<00:24, 37.13batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 37.08batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 36.85batch/s] 13%|███▍                       | 130/1014 [00:03<00:23, 37.07batch/s] 13%|███▌                       | 135/1014 [00:03<00:23, 36.98batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 36.13batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.85batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 34.72batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 34.86batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.69batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.50batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.16batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.06batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.03batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 34.11batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 34.05batch/s] 19%|█████▏                     | 195/1014 [00:05<00:24, 33.98batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.17batch/s] 20%|█████▍                     | 205/1014 [00:06<00:23, 34.09batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.25batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.29batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.23batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.40batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.39batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.40batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.42batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.50batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.55batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 34.56batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.48batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.33batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.23batch/s] 27%|███████▎                   | 275/1014 [00:08<00:21, 34.32batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.35batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 34.36batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 34.30batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.40batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.33batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.22batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 34.18batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.18batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.14batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 34.19batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 34.13batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 33.97batch/s] 34%|█████████                  | 340/1014 [00:10<00:19, 33.99batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 33.91batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.04batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.02batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 33.94batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:19, 33.91batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:19, 33.84batch/s] 37%|█████████▉                 | 375/1014 [00:11<00:18, 33.68batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 33.75batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 33.63batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 33.62batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 33.58batch/s] 39%|██████████▋                | 400/1014 [00:11<00:18, 33.60batch/s] 40%|██████████▊                | 405/1014 [00:12<00:18, 33.69batch/s] 40%|██████████▉                | 410/1014 [00:12<00:17, 33.71batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 33.77batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 33.81batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.79batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 33.77batch/s] 43%|███████████▌               | 435/1014 [00:12<00:17, 33.79batch/s] 43%|███████████▋               | 440/1014 [00:13<00:16, 33.85batch/s] 44%|███████████▊               | 445/1014 [00:13<00:16, 33.84batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 33.88batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.93batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.02batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 34.03batch/s] 46%|████████████▌              | 470/1014 [00:13<00:16, 33.98batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 33.94batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 33.81batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.88batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 33.88batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 33.89batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 33.90batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:15, 33.85batch/s] 50%|█████████████▌             | 510/1014 [00:15<00:14, 33.85batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 33.88batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 33.88batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 33.92batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.91batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 33.85batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 33.87batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 33.84batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 33.85batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 33.91batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.89batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 33.86batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 33.88batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 33.92batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 33.90batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 33.92batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.94batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 33.87batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 33.91batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 33.95batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 33.98batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 34.03batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 34.04batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.06batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.08batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 34.12batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.10batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.08batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 34.07batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 34.04batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.10batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.15batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 34.14batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 33.91batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.91batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 33.96batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.93batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 33.91batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 33.95batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 33.99batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.02batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.06batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 34.09batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.07batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.09batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.03batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:08, 34.03batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.02batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 34.01batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.99batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.97batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 33.94batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.97batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:07, 33.96batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.00batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.97batch/s] 78%|█████████████████████      | 790/1014 [00:23<00:06, 33.97batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 33.98batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.00batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.04batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.05batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.08batch/s] 81%|█████████████████████▊     | 820/1014 [00:24<00:05, 34.06batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 34.05batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 34.06batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.07batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.08batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.05batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.08batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 34.12batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 34.12batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.11batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.06batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.10batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.09batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.09batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 34.12batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 34.08batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.07batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.09batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.05batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.06batch/s] 91%|████████████████████████▍  | 920/1014 [00:27<00:02, 34.05batch/s] 91%|████████████████████████▋  | 925/1014 [00:27<00:02, 34.06batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 34.07batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.08batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.12batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 34.10batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.03batch/s] 94%|█████████████████████████▍ | 955/1014 [00:28<00:01, 33.98batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 34.00batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 33.97batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 33.94batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 33.94batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:01, 33.94batch/s] 97%|██████████████████████████▏| 985/1014 [00:29<00:00, 33.95batch/s] 98%|██████████████████████████▎| 990/1014 [00:29<00:00, 33.93batch/s] 98%|██████████████████████████▍| 995/1014 [00:29<00:00, 33.93batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 33.94batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 33.96batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 33.97batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 33.99batch/s]
Validation 21 -> LOSS = 0.28
Validation 21 -> BLEU = 94.16, 97.1/95.0/93.2/91.4 (BP=1.000, ratio=1.009, hyp_len=14514, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.28 @ validation 21
--> Best BLEU so far: 94.88 @ validation 20
Starting Epoch 22
Epoch 22 - update      10140 => loss:   0.154 (#OOM: 0)
Epoch 22 - update      10170 => loss:   0.212 (#OOM: 0)
Epoch 22 - update      10200 => loss:   0.244 (#OOM: 0)
Epoch 22 - update      10230 => loss:   0.183 (#OOM: 0)
Epoch 22 - update      10260 => loss:   0.174 (#OOM: 0)
Epoch 22 - update      10290 => loss:   0.190 (#OOM: 0)
Epoch 22 - update      10320 => loss:   0.230 (#OOM: 0)
Epoch 22 - update      10350 => loss:   0.136 (#OOM: 0)
Epoch 22 - update      10380 => loss:   0.199 (#OOM: 0)
Epoch 22 - update      10410 => loss:   0.197 (#OOM: 0)
Epoch 22 - update      10440 => loss:   0.251 (#OOM: 0)
Epoch 22 - update      10470 => loss:   0.095 (#OOM: 0)
Epoch 22 - update      10500 => loss:   0.246 (#OOM: 0)
Epoch 22 - update      10530 => loss:   0.148 (#OOM: 0)
Epoch 22 - update      10560 => loss:   0.236 (#OOM: 0)
Epoch 22 - update      10590 => loss:   0.130 (#OOM: 0)
--> Epoch 22 finished with mean loss 0.20747
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (670 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.06batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.73batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 15.98batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 16.86batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 14.37batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.52batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.35batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.97batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.46batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.28batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.41batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.78batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.78batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:34, 28.88batch/s]  1%|▎                            | 9/1014 [00:00<00:28, 34.90batch/s]  1%|▍                           | 14/1014 [00:00<00:27, 35.72batch/s]  2%|▌                           | 19/1014 [00:00<00:27, 35.68batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 35.12batch/s]  3%|▊                           | 29/1014 [00:00<00:27, 35.54batch/s]  3%|▉                           | 34/1014 [00:00<00:27, 35.28batch/s]  4%|█                           | 39/1014 [00:01<00:27, 34.95batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.30batch/s]  5%|█▎                          | 49/1014 [00:01<00:26, 35.99batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 35.91batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 35.66batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 35.61batch/s]  7%|█▉                          | 69/1014 [00:01<00:26, 35.11batch/s]  7%|██                          | 74/1014 [00:02<00:26, 35.69batch/s]  8%|██▏                         | 79/1014 [00:02<00:26, 35.27batch/s]  8%|██▎                         | 84/1014 [00:02<00:26, 35.29batch/s]  9%|██▍                         | 89/1014 [00:02<00:26, 34.97batch/s]  9%|██▌                         | 94/1014 [00:02<00:26, 34.95batch/s] 10%|██▋                         | 99/1014 [00:02<00:26, 34.89batch/s] 10%|██▊                        | 104/1014 [00:03<00:26, 34.66batch/s] 11%|██▉                        | 109/1014 [00:03<00:26, 34.72batch/s] 11%|███                        | 114/1014 [00:03<00:25, 35.00batch/s] 12%|███▏                       | 119/1014 [00:03<00:25, 35.24batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 35.15batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 35.13batch/s] 13%|███▌                       | 134/1014 [00:03<00:24, 35.22batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 35.44batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 35.22batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 35.21batch/s] 15%|████                       | 154/1014 [00:04<00:24, 34.81batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.68batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.50batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.71batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.63batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 34.45batch/s] 18%|████▉                      | 184/1014 [00:05<00:24, 34.45batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 34.37batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.30batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.38batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.27batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.34batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.26batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 34.23batch/s] 22%|█████▉                     | 224/1014 [00:06<00:23, 34.28batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.41batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.45batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.65batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.59batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 34.49batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 34.38batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.44batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.54batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.39batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 34.44batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.45batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 34.41batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.35batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.39batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.41batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.43batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 34.48batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.47batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.45batch/s] 32%|████████▋                  | 324/1014 [00:09<00:20, 34.45batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.53batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 34.53batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.64batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 34.64batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.65batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 34.58batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:19, 34.39batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.31batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.24batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.20batch/s] 37%|██████████                 | 379/1014 [00:11<00:18, 34.13batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.11batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.17batch/s] 39%|██████████▍                | 394/1014 [00:11<00:18, 34.15batch/s] 39%|██████████▌                | 399/1014 [00:11<00:18, 34.13batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.07batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.15batch/s] 41%|███████████                | 414/1014 [00:12<00:17, 34.16batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.13batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 34.22batch/s] 42%|███████████▍               | 429/1014 [00:12<00:17, 34.17batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.21batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.31batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.40batch/s] 44%|███████████▉               | 449/1014 [00:13<00:16, 34.40batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.35batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.38batch/s] 46%|████████████▎              | 464/1014 [00:13<00:16, 34.33batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.44batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.44batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.47batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.61batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 34.58batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 34.58batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.60batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.54batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.44batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 34.41batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 34.42batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 34.46batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.48batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.44batch/s] 54%|██████████████▋            | 551/1014 [00:16<00:13, 34.41batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.44batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.50batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.52batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.52batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.55batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 34.54batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.58batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:12, 34.51batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.55batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.59batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.53batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 34.51batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.51batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.48batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.42batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.40batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.42batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 34.47batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.49batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.53batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.51batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.48batch/s] 68%|██████████████████▎        | 689/1014 [00:20<00:09, 34.43batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.40batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.43batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.37batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.38batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.41batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.41batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.42batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:08, 34.39batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.43batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.37batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.34batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.37batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.42batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:07, 34.42batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.45batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.47batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.48batch/s] 79%|█████████████████████▏     | 797/1014 [00:23<00:06, 34.47batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.50batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.51batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.52batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.52batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.51batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.51batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.52batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.54batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.56batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.52batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.52batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.54batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.55batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.58batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.58batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.60batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.63batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.59batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.57batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.61batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.61batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.59batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.58batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.64batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.60batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.56batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.59batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.58batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.61batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.62batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.63batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.65batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.64batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.63batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.56batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.58batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.57batch/s]
Validation 22 -> LOSS = 0.28
Validation 22 -> BLEU = 95.28, 98.1/96.0/94.4/92.7 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.28 @ validation 22
--> Best BLEU so far: 95.28 @ validation 22
Starting Epoch 23
Epoch 23 - update      10620 => loss:   0.185 (#OOM: 0)
Epoch 23 - update      10650 => loss:   0.204 (#OOM: 0)
Epoch 23 - update      10680 => loss:   0.199 (#OOM: 0)
Epoch 23 - update      10710 => loss:   0.122 (#OOM: 0)
Epoch 23 - update      10740 => loss:   0.255 (#OOM: 0)
Epoch 23 - update      10770 => loss:   0.305 (#OOM: 0)
Epoch 23 - update      10800 => loss:   0.226 (#OOM: 0)
Epoch 23 - update      10830 => loss:   0.268 (#OOM: 0)
Epoch 23 - update      10860 => loss:   0.181 (#OOM: 0)
Epoch 23 - update      10890 => loss:   0.207 (#OOM: 0)
Epoch 23 - update      10920 => loss:   0.134 (#OOM: 0)
Epoch 23 - update      10950 => loss:   0.168 (#OOM: 0)
Epoch 23 - update      10980 => loss:   0.184 (#OOM: 0)
Epoch 23 - update      11010 => loss:   0.173 (#OOM: 0)
Epoch 23 - update      11040 => loss:   0.152 (#OOM: 0)
Epoch 23 - update      11070 => loss:   0.160 (#OOM: 0)
--> Epoch 23 finished with mean loss 0.19667
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (668 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.36batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.35batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 10.86batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.18batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 14.18batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.84batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.18batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.40batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.47batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.86batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.21batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.39batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.57batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.11batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 33.87batch/s]  1%|▎                           | 12/1014 [00:00<00:30, 33.30batch/s]  2%|▍                           | 16/1014 [00:00<00:32, 30.72batch/s]  2%|▌                           | 21/1014 [00:00<00:29, 33.46batch/s]  3%|▋                           | 26/1014 [00:00<00:29, 33.37batch/s]  3%|▊                           | 31/1014 [00:00<00:30, 32.62batch/s]  4%|▉                           | 36/1014 [00:01<00:29, 32.90batch/s]  4%|█▏                          | 41/1014 [00:01<00:28, 33.58batch/s]  5%|█▎                          | 46/1014 [00:01<00:28, 33.81batch/s]  5%|█▍                          | 51/1014 [00:01<00:28, 33.94batch/s]  6%|█▌                          | 56/1014 [00:01<00:28, 33.50batch/s]  6%|█▋                          | 61/1014 [00:01<00:28, 34.00batch/s]  7%|█▊                          | 66/1014 [00:01<00:27, 34.44batch/s]  7%|█▉                          | 71/1014 [00:02<00:27, 33.81batch/s]  7%|██                          | 76/1014 [00:02<00:28, 33.44batch/s]  8%|██▏                         | 81/1014 [00:02<00:27, 33.52batch/s]  8%|██▎                         | 86/1014 [00:02<00:27, 33.77batch/s]  9%|██▌                         | 91/1014 [00:02<00:27, 33.66batch/s]  9%|██▋                         | 96/1014 [00:02<00:27, 33.29batch/s] 10%|██▋                        | 101/1014 [00:03<00:27, 33.45batch/s] 10%|██▊                        | 106/1014 [00:03<00:27, 33.58batch/s] 11%|██▉                        | 111/1014 [00:03<00:26, 33.59batch/s] 11%|███                        | 116/1014 [00:03<00:26, 33.74batch/s] 12%|███▏                       | 121/1014 [00:03<00:26, 33.42batch/s] 12%|███▎                       | 126/1014 [00:03<00:26, 33.40batch/s] 13%|███▍                       | 131/1014 [00:03<00:26, 33.70batch/s] 13%|███▌                       | 136/1014 [00:04<00:26, 33.65batch/s] 14%|███▊                       | 141/1014 [00:04<00:25, 33.81batch/s] 14%|███▉                       | 146/1014 [00:04<00:25, 33.73batch/s] 15%|████                       | 151/1014 [00:04<00:25, 33.82batch/s] 15%|████▏                      | 156/1014 [00:04<00:25, 33.82batch/s] 16%|████▎                      | 161/1014 [00:04<00:25, 33.76batch/s] 16%|████▍                      | 166/1014 [00:04<00:25, 33.89batch/s] 17%|████▌                      | 171/1014 [00:05<00:24, 33.81batch/s] 17%|████▋                      | 176/1014 [00:05<00:24, 33.93batch/s] 18%|████▊                      | 181/1014 [00:05<00:24, 33.92batch/s] 18%|████▉                      | 186/1014 [00:05<00:24, 34.03batch/s] 19%|█████                      | 191/1014 [00:05<00:24, 34.22batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 34.29batch/s] 20%|█████▎                     | 201/1014 [00:05<00:23, 34.19batch/s] 20%|█████▍                     | 206/1014 [00:06<00:23, 34.23batch/s] 21%|█████▌                     | 211/1014 [00:06<00:23, 34.43batch/s] 21%|█████▊                     | 216/1014 [00:06<00:23, 34.33batch/s] 22%|█████▉                     | 221/1014 [00:06<00:23, 34.23batch/s] 22%|██████                     | 226/1014 [00:06<00:23, 34.23batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 34.23batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.39batch/s] 24%|██████▍                    | 241/1014 [00:07<00:22, 34.24batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.14batch/s] 25%|██████▋                    | 251/1014 [00:07<00:22, 34.23batch/s] 25%|██████▊                    | 256/1014 [00:07<00:22, 34.08batch/s] 26%|██████▉                    | 261/1014 [00:07<00:22, 33.50batch/s] 26%|███████                    | 266/1014 [00:07<00:22, 33.63batch/s] 27%|███████▏                   | 271/1014 [00:08<00:22, 33.68batch/s] 27%|███████▎                   | 276/1014 [00:08<00:21, 33.70batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 33.65batch/s] 28%|███████▌                   | 286/1014 [00:08<00:21, 33.55batch/s] 29%|███████▋                   | 291/1014 [00:08<00:21, 33.63batch/s] 29%|███████▉                   | 296/1014 [00:08<00:21, 33.64batch/s] 30%|████████                   | 301/1014 [00:08<00:21, 33.70batch/s] 30%|████████▏                  | 306/1014 [00:09<00:21, 33.70batch/s] 31%|████████▎                  | 311/1014 [00:09<00:20, 33.60batch/s] 31%|████████▍                  | 316/1014 [00:09<00:20, 33.67batch/s] 32%|████████▌                  | 321/1014 [00:09<00:20, 33.61batch/s] 32%|████████▋                  | 326/1014 [00:09<00:20, 33.54batch/s] 33%|████████▊                  | 331/1014 [00:09<00:20, 33.53batch/s] 33%|████████▉                  | 336/1014 [00:10<00:20, 33.51batch/s] 34%|█████████                  | 341/1014 [00:10<00:20, 33.56batch/s] 34%|█████████▏                 | 346/1014 [00:10<00:19, 33.56batch/s] 35%|█████████▎                 | 351/1014 [00:10<00:19, 33.49batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:19, 33.50batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:19, 33.50batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:19, 33.49batch/s] 37%|█████████▉                 | 371/1014 [00:11<00:19, 33.47batch/s] 37%|██████████                 | 376/1014 [00:11<00:19, 33.50batch/s] 38%|██████████▏                | 381/1014 [00:11<00:18, 33.51batch/s] 38%|██████████▎                | 386/1014 [00:11<00:18, 33.55batch/s] 39%|██████████▍                | 391/1014 [00:11<00:18, 33.56batch/s] 39%|██████████▌                | 396/1014 [00:11<00:18, 33.56batch/s] 40%|██████████▋                | 401/1014 [00:11<00:18, 33.55batch/s] 40%|██████████▊                | 406/1014 [00:12<00:18, 33.57batch/s] 41%|██████████▉                | 411/1014 [00:12<00:17, 33.59batch/s] 41%|███████████                | 416/1014 [00:12<00:17, 33.62batch/s] 42%|███████████▏               | 421/1014 [00:12<00:17, 33.74batch/s] 42%|███████████▎               | 426/1014 [00:12<00:17, 33.73batch/s] 43%|███████████▍               | 431/1014 [00:12<00:17, 33.83batch/s] 43%|███████████▌               | 436/1014 [00:12<00:17, 33.87batch/s] 43%|███████████▋               | 441/1014 [00:13<00:16, 33.85batch/s] 44%|███████████▉               | 446/1014 [00:13<00:16, 33.89batch/s] 44%|████████████               | 451/1014 [00:13<00:16, 33.91batch/s] 45%|████████████▏              | 456/1014 [00:13<00:16, 33.96batch/s] 45%|████████████▎              | 461/1014 [00:13<00:16, 33.96batch/s] 46%|████████████▍              | 466/1014 [00:13<00:16, 33.93batch/s] 46%|████████████▌              | 471/1014 [00:13<00:16, 33.93batch/s] 47%|████████████▋              | 476/1014 [00:14<00:15, 33.96batch/s] 47%|████████████▊              | 481/1014 [00:14<00:15, 33.99batch/s] 48%|████████████▉              | 486/1014 [00:14<00:15, 33.99batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 33.99batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:15, 34.04batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:15, 34.04batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 33.97batch/s] 50%|█████████████▌             | 511/1014 [00:15<00:14, 34.00batch/s] 51%|█████████████▋             | 516/1014 [00:15<00:14, 33.99batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 33.96batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 34.03batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:14, 34.04batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 33.98batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 34.06batch/s] 54%|██████████████▋            | 551/1014 [00:16<00:13, 34.08batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.07batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.03batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:13, 34.02batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.03batch/s] 57%|███████████████▍           | 581/1014 [00:17<00:12, 34.01batch/s] 58%|███████████████▋           | 587/1014 [00:17<00:12, 33.98batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 33.97batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:12, 33.95batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 33.97batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 33.99batch/s] 61%|████████████████▍          | 617/1014 [00:18<00:11, 33.97batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 33.96batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.01batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 34.02batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.03batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.06batch/s] 64%|█████████████████▍         | 653/1014 [00:19<00:10, 34.11batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 34.14batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.13batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:10, 34.13batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.09batch/s] 67%|██████████████████▏        | 683/1014 [00:20<00:09, 34.11batch/s] 68%|██████████████████▎        | 689/1014 [00:20<00:09, 34.16batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.17batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.19batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.22batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.19batch/s] 71%|███████████████████▏       | 719/1014 [00:21<00:08, 34.21batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.24batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.24batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:08, 34.27batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.29batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.31batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 34.28batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.29batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.30batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:07, 34.31batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.32batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.32batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.39batch/s] 79%|█████████████████████▏     | 797/1014 [00:23<00:06, 34.43batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.41batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.41batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.43batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.44batch/s] 82%|██████████████████████     | 827/1014 [00:24<00:05, 34.41batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.43batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.45batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.46batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.48batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.48batch/s] 85%|██████████████████████▉    | 863/1014 [00:25<00:04, 34.49batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.52batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.54batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.51batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.50batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.49batch/s] 89%|███████████████████████▉   | 899/1014 [00:26<00:03, 34.53batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.55batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.49batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.45batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.45batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.44batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.46batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.49batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.50batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.49batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.48batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.51batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.51batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.55batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.57batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.57batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.55batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.54batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.52batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.48batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.48batch/s]
Validation 23 -> LOSS = 0.27
Validation 23 -> BLEU = 94.82, 97.6/95.6/94.0/92.3 (BP=1.000, ratio=1.006, hyp_len=14462, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.27 @ validation 23
--> Best BLEU so far: 95.28 @ validation 22
Starting Epoch 24
Epoch 24 - update      11100 => loss:   0.115 (#OOM: 0)
Epoch 24 - update      11130 => loss:   0.124 (#OOM: 0)
Epoch 24 - update      11160 => loss:   0.238 (#OOM: 0)
Epoch 24 - update      11190 => loss:   0.087 (#OOM: 0)
Epoch 24 - update      11220 => loss:   0.137 (#OOM: 0)
Epoch 24 - update      11250 => loss:   0.223 (#OOM: 0)
Epoch 24 - update      11280 => loss:   0.168 (#OOM: 0)
Epoch 24 - update      11310 => loss:   0.125 (#OOM: 0)
Epoch 24 - update      11340 => loss:   0.162 (#OOM: 0)
Epoch 24 - update      11370 => loss:   0.168 (#OOM: 0)
Epoch 24 - update      11400 => loss:   0.266 (#OOM: 0)
Epoch 24 - update      11430 => loss:   0.124 (#OOM: 0)
Epoch 24 - update      11460 => loss:   0.219 (#OOM: 0)
Epoch 24 - update      11490 => loss:   0.163 (#OOM: 0)
Epoch 24 - update      11520 => loss:   0.210 (#OOM: 0)
Epoch 24 - update      11550 => loss:   0.194 (#OOM: 0)
--> Epoch 24 finished with mean loss 0.18726
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (672 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 10.93batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.30batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 14.02batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 15.90batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 14.06batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.22batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.16batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.80batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.00batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.38batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.62batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.91batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.91batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:33, 30.00batch/s]  1%|▏                            | 8/1014 [00:00<00:31, 31.64batch/s]  1%|▎                           | 12/1014 [00:00<00:30, 33.26batch/s]  2%|▍                           | 16/1014 [00:00<00:30, 32.86batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 32.83batch/s]  2%|▋                           | 25/1014 [00:00<00:29, 33.49batch/s]  3%|▊                           | 30/1014 [00:00<00:29, 33.50batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.32batch/s]  4%|█                           | 40/1014 [00:01<00:27, 34.82batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 34.97batch/s]  5%|█▍                          | 50/1014 [00:01<00:27, 34.94batch/s]  5%|█▌                          | 55/1014 [00:01<00:27, 34.39batch/s]  6%|█▋                          | 60/1014 [00:01<00:27, 34.20batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 34.13batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.01batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.10batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 34.13batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 34.27batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 34.29batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.60batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.85batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.85batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 35.27batch/s] 11%|███                        | 115/1014 [00:03<00:25, 35.34batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 35.19batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 35.11batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.92batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.75batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.54batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.43batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.40batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 34.45batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.38batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.45batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.61batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.72batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 34.79batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 34.80batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.78batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.71batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.65batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.65batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.66batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.51batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.33batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.45batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.26batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.24batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.34batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.28batch/s] 25%|██████▋                    | 251/1014 [00:07<00:22, 34.61batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 34.58batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 34.42batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.45batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.48batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.50batch/s] 28%|███████▋                   | 287/1014 [00:08<00:21, 34.44batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 34.40batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.35batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.39batch/s] 31%|████████▎                  | 311/1014 [00:09<00:20, 34.44batch/s] 31%|████████▍                  | 317/1014 [00:09<00:20, 34.40batch/s] 32%|████████▌                  | 323/1014 [00:09<00:20, 34.41batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.52batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.57batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 34.57batch/s] 34%|█████████▏                 | 347/1014 [00:10<00:19, 34.45batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 34.43batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:19, 34.32batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.29batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 34.08batch/s] 37%|██████████                 | 377/1014 [00:11<00:18, 34.22batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 34.28batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.34batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.42batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 34.36batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.31batch/s] 41%|██████████▉                | 413/1014 [00:12<00:17, 34.33batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.39batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.36batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 34.33batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 34.38batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.36batch/s] 44%|███████████▉               | 449/1014 [00:13<00:16, 34.29batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.36batch/s] 45%|████████████▎              | 461/1014 [00:13<00:16, 34.36batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 34.34batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.32batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.28batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.22batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 34.25batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:15, 34.25batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.23batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.26batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 34.26batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 34.27batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 34.25batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:14, 34.30batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.36batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.42batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 34.45batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.40batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.41batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.45batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.46batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.46batch/s] 58%|███████████████▋           | 587/1014 [00:17<00:12, 34.43batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.45batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:12, 34.42batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.43batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.35batch/s] 61%|████████████████▍          | 617/1014 [00:18<00:11, 34.10batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 34.11batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.16batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 34.22batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.26batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.26batch/s] 64%|█████████████████▍         | 653/1014 [00:19<00:10, 34.28batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 34.27batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.29batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:10, 34.29batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.32batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.35batch/s] 68%|██████████████████▎        | 689/1014 [00:20<00:09, 34.33batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.39batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.44batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.41batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.42batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.39batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.37batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.36batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:08, 34.42batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.43batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.42batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.42batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.42batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.46batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.45batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.41batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.44batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.46batch/s] 79%|█████████████████████▏     | 797/1014 [00:23<00:06, 34.43batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.46batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.47batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.48batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.51batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.58batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.61batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.62batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.60batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.60batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.61batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.54batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.54batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.50batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.54batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.54batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.55batch/s] 89%|███████████████████████▉   | 899/1014 [00:26<00:03, 34.50batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.51batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.53batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.57batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.56batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.60batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.59batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.57batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.56batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.51batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.55batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.56batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.54batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.50batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.51batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.52batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.51batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.55batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.55batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.56batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.55batch/s]
Validation 24 -> LOSS = 0.27
Validation 24 -> BLEU = 95.49, 98.2/96.2/94.7/93.0 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.27 @ validation 24
--> Best BLEU so far: 95.49 @ validation 24
Starting Epoch 25
Epoch 25 - update      11580 => loss:   0.077 (#OOM: 0)
Epoch 25 - update      11610 => loss:   0.194 (#OOM: 0)
Epoch 25 - update      11640 => loss:   0.180 (#OOM: 0)
Epoch 25 - update      11670 => loss:   0.169 (#OOM: 0)
Epoch 25 - update      11700 => loss:   0.185 (#OOM: 0)
Epoch 25 - update      11730 => loss:   0.160 (#OOM: 0)
Epoch 25 - update      11760 => loss:   0.260 (#OOM: 0)
Epoch 25 - update      11790 => loss:   0.139 (#OOM: 0)
Epoch 25 - update      11820 => loss:   0.211 (#OOM: 0)
Epoch 25 - update      11850 => loss:   0.085 (#OOM: 0)
Epoch 25 - update      11880 => loss:   0.243 (#OOM: 0)
Epoch 25 - update      11910 => loss:   0.106 (#OOM: 0)
Epoch 25 - update      11940 => loss:   0.224 (#OOM: 0)
Epoch 25 - update      11970 => loss:   0.133 (#OOM: 0)
Epoch 25 - update      12000 => loss:   0.045 (#OOM: 0)
Epoch 25 - update      12030 => loss:   0.250 (#OOM: 0)
--> Epoch 25 finished with mean loss 0.17949
--> Overhead/Training/Evaluation: 0.60/0.72/0.00 mins (total: 1.32 mins)   (672 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.41batch/s]  9%|██▋                            | 3/34 [00:00<00:03,  9.61batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.92batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 11.73batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 12.75batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.67batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.00batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.92batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 12.32batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.70batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.13batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.11batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.27batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.77batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.67batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.07batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 34.76batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.48batch/s]  1%|▎                           | 13/1014 [00:00<00:27, 36.73batch/s]  2%|▍                           | 18/1014 [00:00<00:29, 34.14batch/s]  2%|▋                           | 24/1014 [00:00<00:27, 36.55batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 36.30batch/s]  4%|▉                           | 36/1014 [00:01<00:27, 35.07batch/s]  4%|█▏                          | 42/1014 [00:01<00:27, 35.09batch/s]  5%|█▎                          | 48/1014 [00:01<00:27, 35.12batch/s]  5%|█▍                          | 54/1014 [00:01<00:27, 34.60batch/s]  6%|█▋                          | 60/1014 [00:01<00:28, 34.04batch/s]  7%|█▊                          | 66/1014 [00:01<00:27, 34.02batch/s]  7%|█▉                          | 72/1014 [00:02<00:27, 34.21batch/s]  8%|██▏                         | 78/1014 [00:02<00:27, 33.91batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 33.41batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 33.62batch/s]  9%|██▋                         | 96/1014 [00:02<00:27, 33.83batch/s] 10%|██▋                        | 102/1014 [00:03<00:26, 33.92batch/s] 11%|██▉                        | 108/1014 [00:03<00:26, 33.85batch/s] 11%|███                        | 114/1014 [00:03<00:26, 34.06batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 34.04batch/s] 12%|███▎                       | 126/1014 [00:03<00:26, 34.05batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 34.34batch/s] 14%|███▋                       | 138/1014 [00:04<00:25, 34.26batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.53batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 34.56batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 34.54batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.89batch/s] 17%|████▍                      | 168/1014 [00:04<00:24, 34.87batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.75batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 34.97batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 34.91batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 34.97batch/s] 20%|█████▎                     | 198/1014 [00:05<00:23, 35.01batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.77batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.71batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 34.78batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 34.74batch/s] 22%|██████                     | 228/1014 [00:06<00:22, 34.51batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.62batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.67batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.57batch/s] 25%|██████▋                    | 252/1014 [00:07<00:22, 34.52batch/s] 25%|██████▊                    | 258/1014 [00:07<00:21, 34.40batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.25batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.28batch/s] 27%|███████▎                   | 276/1014 [00:08<00:21, 34.29batch/s] 28%|███████▌                   | 282/1014 [00:08<00:21, 34.25batch/s] 28%|███████▋                   | 288/1014 [00:08<00:21, 34.33batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.29batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.22batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 34.22batch/s] 31%|████████▎                  | 312/1014 [00:09<00:20, 34.13batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 34.15batch/s] 32%|████████▋                  | 324/1014 [00:09<00:20, 34.08batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 34.14batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 34.10batch/s] 34%|█████████                  | 342/1014 [00:10<00:19, 34.11batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 34.05batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 34.06batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 34.22batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 34.27batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 34.29batch/s] 37%|██████████                 | 378/1014 [00:10<00:18, 34.38batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.42batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.40batch/s] 39%|██████████▌                | 396/1014 [00:11<00:17, 34.46batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 34.42batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 34.45batch/s] 41%|███████████                | 414/1014 [00:12<00:17, 34.40batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.47batch/s] 42%|███████████▎               | 426/1014 [00:12<00:17, 34.47batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 34.46batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 34.46batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.46batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.41batch/s] 45%|████████████▏              | 456/1014 [00:13<00:16, 34.36batch/s] 46%|████████████▎              | 462/1014 [00:13<00:16, 34.41batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 34.36batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.41batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.48batch/s] 48%|████████████▉              | 486/1014 [00:14<00:15, 34.52batch/s] 49%|█████████████              | 492/1014 [00:14<00:15, 34.48batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 34.52batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.51batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.50batch/s] 51%|█████████████▋             | 516/1014 [00:14<00:14, 34.57batch/s] 51%|█████████████▉             | 522/1014 [00:15<00:14, 34.55batch/s] 52%|██████████████             | 528/1014 [00:15<00:14, 34.55batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.62batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.65batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 34.63batch/s] 54%|██████████████▋            | 552/1014 [00:15<00:13, 34.56batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 34.59batch/s] 56%|███████████████            | 564/1014 [00:16<00:13, 34.61batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.65batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 34.67batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 34.74batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 34.77batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.77batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.73batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 34.80batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 34.76batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 34.76batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.77batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.68batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:10, 34.71batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 34.78batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 34.77batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.81batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 34.79batch/s] 66%|█████████████████▋         | 666/1014 [00:19<00:10, 34.79batch/s] 66%|█████████████████▉         | 672/1014 [00:19<00:09, 34.76batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.76batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.76batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.76batch/s] 69%|██████████████████▌        | 696/1014 [00:20<00:09, 34.80batch/s] 69%|██████████████████▋        | 702/1014 [00:20<00:08, 34.77batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.76batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.76batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.76batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 34.76batch/s] 72%|███████████████████▍       | 732/1014 [00:21<00:08, 34.78batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:07, 34.80batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.80batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.80batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 34.85batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 34.81batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.76batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 34.73batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.72batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 34.74batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 34.78batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 34.75batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.70batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.73batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 34.66batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 34.60batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 34.61batch/s] 82%|██████████████████████▏    | 834/1014 [00:24<00:05, 34.61batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.59batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 34.58batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 34.61batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 34.59batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 34.56batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.53batch/s] 86%|███████████████████████▎   | 876/1014 [00:25<00:03, 34.50batch/s] 87%|███████████████████████▍   | 882/1014 [00:25<00:03, 34.48batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.45batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 34.45batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.46batch/s] 89%|████████████████████████   | 906/1014 [00:26<00:03, 34.41batch/s] 90%|████████████████████████▎  | 912/1014 [00:26<00:02, 34.44batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.43batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.41batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 34.39batch/s] 92%|████████████████████████▉  | 936/1014 [00:27<00:02, 34.34batch/s] 93%|█████████████████████████  | 942/1014 [00:27<00:02, 34.37batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.39batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.42batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.39batch/s] 95%|█████████████████████████▋ | 966/1014 [00:28<00:01, 34.39batch/s] 96%|█████████████████████████▉ | 972/1014 [00:28<00:01, 34.44batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.44batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.48batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.52batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 34.53batch/s] 99%|█████████████████████████▋| 1002/1014 [00:29<00:00, 34.50batch/s] 99%|█████████████████████████▊| 1008/1014 [00:29<00:00, 34.54batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.57batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.57batch/s]
Validation 25 -> LOSS = 0.26
Validation 25 -> BLEU = 95.65, 98.2/96.4/94.9/93.3 (BP=1.000, ratio=1.000, hyp_len=14379, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.26 @ validation 25
--> Best BLEU so far: 95.65 @ validation 25
Starting Epoch 26
Epoch 26 - update      12060 => loss:   0.227 (#OOM: 0)
Epoch 26 - update      12090 => loss:   0.235 (#OOM: 0)
Epoch 26 - update      12120 => loss:   0.210 (#OOM: 0)
Epoch 26 - update      12150 => loss:   0.144 (#OOM: 0)
Epoch 26 - update      12180 => loss:   0.134 (#OOM: 0)
Epoch 26 - update      12210 => loss:   0.094 (#OOM: 0)
Epoch 26 - update      12240 => loss:   0.158 (#OOM: 0)
Epoch 26 - update      12270 => loss:   0.173 (#OOM: 0)
Epoch 26 - update      12300 => loss:   0.219 (#OOM: 0)
Epoch 26 - update      12330 => loss:   0.171 (#OOM: 0)
Epoch 26 - update      12360 => loss:   0.119 (#OOM: 0)
Epoch 26 - update      12390 => loss:   0.155 (#OOM: 0)
Epoch 26 - update      12420 => loss:   0.178 (#OOM: 0)
Epoch 26 - update      12450 => loss:   0.170 (#OOM: 0)
Epoch 26 - update      12480 => loss:   0.146 (#OOM: 0)
Epoch 26 - update      12510 => loss:   0.218 (#OOM: 0)
--> Epoch 26 finished with mean loss 0.17024
--> Overhead/Training/Evaluation: 0.61/0.71/0.00 mins (total: 1.33 mins)   (676 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.89batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.24batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.97batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.75batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.64batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 14.20batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 15.22batch/s] 56%|████████████████▊             | 19/34 [00:01<00:00, 15.14batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.90batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 14.63batch/s] 82%|████████████████████████▋     | 28/34 [00:01<00:00, 14.68batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.46batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.89batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.88batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 36.03batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 34.77batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 34.42batch/s]  2%|▍                           | 17/1014 [00:00<00:27, 36.86batch/s]  2%|▌                           | 22/1014 [00:00<00:29, 33.10batch/s]  3%|▋                           | 27/1014 [00:00<00:29, 33.09batch/s]  3%|▉                           | 32/1014 [00:00<00:29, 33.78batch/s]  4%|█                           | 37/1014 [00:01<00:28, 34.11batch/s]  4%|█▏                          | 42/1014 [00:01<00:28, 34.44batch/s]  5%|█▎                          | 47/1014 [00:01<00:28, 34.20batch/s]  5%|█▍                          | 52/1014 [00:01<00:28, 33.83batch/s]  6%|█▌                          | 57/1014 [00:01<00:28, 33.83batch/s]  6%|█▋                          | 62/1014 [00:01<00:28, 33.62batch/s]  7%|█▊                          | 67/1014 [00:01<00:27, 33.90batch/s]  7%|█▉                          | 72/1014 [00:02<00:27, 34.42batch/s]  8%|██▏                         | 77/1014 [00:02<00:27, 34.53batch/s]  8%|██▎                         | 82/1014 [00:02<00:27, 34.49batch/s]  9%|██▍                         | 87/1014 [00:02<00:26, 34.66batch/s]  9%|██▌                         | 92/1014 [00:02<00:26, 34.87batch/s] 10%|██▋                         | 97/1014 [00:02<00:26, 34.37batch/s] 10%|██▋                        | 102/1014 [00:02<00:26, 34.43batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 34.62batch/s] 11%|██▉                        | 112/1014 [00:03<00:26, 34.48batch/s] 12%|███                        | 117/1014 [00:03<00:26, 34.45batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 34.60batch/s] 13%|███▍                       | 127/1014 [00:03<00:25, 34.96batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 34.62batch/s] 14%|███▋                       | 137/1014 [00:03<00:25, 34.50batch/s] 14%|███▊                       | 142/1014 [00:04<00:25, 34.57batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 34.82batch/s] 15%|████                       | 152/1014 [00:04<00:24, 34.71batch/s] 15%|████▏                      | 157/1014 [00:04<00:24, 34.77batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.75batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.51batch/s] 17%|████▌                      | 172/1014 [00:05<00:24, 34.40batch/s] 17%|████▋                      | 177/1014 [00:05<00:24, 34.64batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 34.82batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 34.78batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 34.83batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 34.56batch/s] 20%|█████▍                     | 202/1014 [00:05<00:23, 34.60batch/s] 20%|█████▌                     | 207/1014 [00:05<00:23, 34.58batch/s] 21%|█████▋                     | 212/1014 [00:06<00:23, 34.59batch/s] 21%|█████▊                     | 217/1014 [00:06<00:23, 34.52batch/s] 22%|█████▉                     | 222/1014 [00:06<00:23, 34.42batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 34.34batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 34.40batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 34.47batch/s] 24%|██████▍                    | 242/1014 [00:07<00:22, 34.46batch/s] 24%|██████▌                    | 247/1014 [00:07<00:22, 34.36batch/s] 25%|██████▋                    | 252/1014 [00:07<00:22, 34.50batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 34.47batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 34.45batch/s] 26%|███████                    | 267/1014 [00:07<00:21, 34.49batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 34.44batch/s] 27%|███████▍                   | 277/1014 [00:08<00:21, 34.36batch/s] 28%|███████▌                   | 282/1014 [00:08<00:21, 34.24batch/s] 28%|███████▋                   | 287/1014 [00:08<00:21, 34.26batch/s] 29%|███████▊                   | 292/1014 [00:08<00:21, 34.22batch/s] 29%|███████▉                   | 297/1014 [00:08<00:21, 34.09batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 34.17batch/s] 30%|████████▏                  | 307/1014 [00:08<00:20, 34.18batch/s] 31%|████████▎                  | 312/1014 [00:09<00:20, 34.22batch/s] 31%|████████▍                  | 317/1014 [00:09<00:20, 34.12batch/s] 32%|████████▌                  | 322/1014 [00:09<00:20, 34.12batch/s] 32%|████████▋                  | 327/1014 [00:09<00:20, 34.16batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 34.12batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 34.13batch/s] 34%|█████████                  | 342/1014 [00:10<00:19, 34.16batch/s] 34%|█████████▏                 | 347/1014 [00:10<00:19, 34.08batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:19, 34.14batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:19, 34.19batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:19, 34.23batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.24batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 34.29batch/s] 37%|██████████                 | 377/1014 [00:11<00:18, 34.18batch/s] 38%|██████████▏                | 382/1014 [00:11<00:18, 34.23batch/s] 38%|██████████▎                | 387/1014 [00:11<00:18, 34.17batch/s] 39%|██████████▍                | 392/1014 [00:11<00:18, 34.09batch/s] 39%|██████████▌                | 397/1014 [00:11<00:18, 34.10batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 34.10batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.02batch/s] 41%|██████████▉                | 412/1014 [00:12<00:17, 34.07batch/s] 41%|███████████                | 417/1014 [00:12<00:17, 34.06batch/s] 42%|███████████▏               | 422/1014 [00:12<00:17, 33.96batch/s] 42%|███████████▎               | 427/1014 [00:12<00:17, 33.87batch/s] 43%|███████████▌               | 432/1014 [00:12<00:17, 33.89batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 34.00batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 34.07batch/s] 44%|███████████▉               | 447/1014 [00:13<00:16, 34.09batch/s] 45%|████████████               | 452/1014 [00:13<00:16, 34.04batch/s] 45%|████████████▏              | 457/1014 [00:13<00:16, 34.10batch/s] 46%|████████████▎              | 462/1014 [00:13<00:16, 34.09batch/s] 46%|████████████▍              | 467/1014 [00:13<00:16, 34.10batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 34.15batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 34.21batch/s] 48%|████████████▊              | 482/1014 [00:14<00:15, 34.15batch/s] 48%|████████████▉              | 487/1014 [00:14<00:15, 34.13batch/s] 49%|█████████████              | 492/1014 [00:14<00:15, 34.16batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:15, 34.25batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 34.19batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 34.21batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 34.25batch/s] 51%|█████████████▊             | 517/1014 [00:15<00:14, 34.21batch/s] 51%|█████████████▉             | 522/1014 [00:15<00:14, 34.24batch/s] 52%|██████████████             | 528/1014 [00:15<00:14, 34.36batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.40batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.46batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 34.41batch/s] 54%|██████████████▋            | 552/1014 [00:16<00:13, 34.42batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 34.49batch/s] 56%|███████████████            | 564/1014 [00:16<00:13, 34.55batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.52batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 34.55batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 34.50batch/s] 58%|███████████████▋           | 588/1014 [00:17<00:12, 34.49batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.40batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 34.39batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 34.38batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 34.36batch/s] 61%|████████████████▍          | 618/1014 [00:18<00:11, 34.32batch/s] 62%|████████████████▌          | 624/1014 [00:18<00:11, 34.15batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.08batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:11, 33.98batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 34.04batch/s] 64%|█████████████████▎         | 648/1014 [00:19<00:10, 34.01batch/s] 64%|█████████████████▍         | 654/1014 [00:19<00:10, 33.94batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 33.94batch/s] 66%|█████████████████▋         | 666/1014 [00:19<00:10, 33.86batch/s] 66%|█████████████████▉         | 672/1014 [00:19<00:10, 33.91batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 33.94batch/s] 67%|██████████████████▏        | 684/1014 [00:20<00:09, 33.91batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.96batch/s] 69%|██████████████████▌        | 696/1014 [00:20<00:09, 34.00batch/s] 69%|██████████████████▋        | 702/1014 [00:20<00:09, 33.97batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.02batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.02batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 34.02batch/s] 72%|███████████████████▎       | 726/1014 [00:21<00:08, 34.05batch/s] 72%|███████████████████▍       | 732/1014 [00:21<00:08, 34.06batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:08, 34.11batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.16batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.14batch/s] 75%|████████████████████▏      | 756/1014 [00:22<00:07, 34.16batch/s] 75%|████████████████████▎      | 762/1014 [00:22<00:07, 34.14batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.13batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:07, 34.10batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.11batch/s] 78%|████████████████████▉      | 786/1014 [00:23<00:06, 34.10batch/s] 78%|█████████████████████      | 792/1014 [00:23<00:06, 34.10batch/s] 79%|█████████████████████▏     | 798/1014 [00:23<00:06, 34.11batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.14batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.18batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 34.26batch/s] 81%|█████████████████████▉     | 822/1014 [00:24<00:05, 34.21batch/s] 82%|██████████████████████     | 828/1014 [00:24<00:05, 34.21batch/s] 82%|██████████████████████▏    | 834/1014 [00:24<00:05, 34.24batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.14batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 34.12batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 34.20batch/s] 85%|██████████████████████▊    | 858/1014 [00:25<00:04, 34.21batch/s] 85%|███████████████████████    | 864/1014 [00:25<00:04, 34.18batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.16batch/s] 86%|███████████████████████▎   | 876/1014 [00:25<00:04, 34.18batch/s] 87%|███████████████████████▍   | 882/1014 [00:25<00:03, 34.23batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.23batch/s] 88%|███████████████████████▊   | 894/1014 [00:26<00:03, 34.25batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.20batch/s] 89%|████████████████████████   | 906/1014 [00:26<00:03, 34.20batch/s] 90%|████████████████████████▎  | 912/1014 [00:26<00:02, 34.23batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.17batch/s] 91%|████████████████████████▌  | 924/1014 [00:27<00:02, 34.20batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 34.22batch/s] 92%|████████████████████████▉  | 936/1014 [00:27<00:02, 34.24batch/s] 93%|█████████████████████████  | 942/1014 [00:27<00:02, 34.25batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.27batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.28batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 34.26batch/s] 95%|█████████████████████████▋ | 966/1014 [00:28<00:01, 34.29batch/s] 96%|█████████████████████████▉ | 972/1014 [00:28<00:01, 34.26batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.25batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.26batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.25batch/s] 98%|██████████████████████████▌| 996/1014 [00:29<00:00, 34.22batch/s] 99%|█████████████████████████▋| 1002/1014 [00:29<00:00, 34.25batch/s] 99%|█████████████████████████▊| 1008/1014 [00:29<00:00, 34.26batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.26batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.26batch/s]
Validation 26 -> LOSS = 0.26
Validation 26 -> BLEU = 95.76, 98.3/96.4/95.0/93.4 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.26 @ validation 26
--> Best BLEU so far: 95.76 @ validation 26
Starting Epoch 27
Epoch 27 - update      12540 => loss:   0.176 (#OOM: 0)
Epoch 27 - update      12570 => loss:   0.157 (#OOM: 0)
Epoch 27 - update      12600 => loss:   0.109 (#OOM: 0)
Epoch 27 - update      12630 => loss:   0.170 (#OOM: 0)
Epoch 27 - update      12660 => loss:   0.156 (#OOM: 0)
Epoch 27 - update      12690 => loss:   0.215 (#OOM: 0)
Epoch 27 - update      12720 => loss:   0.155 (#OOM: 0)
Epoch 27 - update      12750 => loss:   0.209 (#OOM: 0)
Epoch 27 - update      12780 => loss:   0.132 (#OOM: 0)
Epoch 27 - update      12810 => loss:   0.143 (#OOM: 0)
Epoch 27 - update      12840 => loss:   0.158 (#OOM: 0)
Epoch 27 - update      12870 => loss:   0.202 (#OOM: 0)
Epoch 27 - update      12900 => loss:   0.167 (#OOM: 0)
Epoch 27 - update      12930 => loss:   0.171 (#OOM: 0)
Epoch 27 - update      12960 => loss:   0.179 (#OOM: 0)
Epoch 27 - update      12990 => loss:   0.138 (#OOM: 0)
--> Epoch 27 finished with mean loss 0.16404
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.58batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 13.84batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.40batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 11.52batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.49batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.58batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.64batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.22batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.33batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.81batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.46batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.65batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.89batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.89batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.47batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 34.85batch/s]  1%|▎                           | 12/1014 [00:00<00:31, 31.98batch/s]  2%|▍                           | 16/1014 [00:00<00:31, 32.05batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 32.83batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.22batch/s]  3%|▊                           | 30/1014 [00:00<00:29, 33.85batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.21batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.00batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.82batch/s]  5%|█▍                          | 50/1014 [00:01<00:27, 35.41batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 35.59batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.03batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 36.47batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 36.16batch/s]  7%|██                          | 75/1014 [00:02<00:25, 36.17batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.80batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 35.84batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 35.72batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 35.67batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.93batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.66batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 34.85batch/s] 11%|███                        | 115/1014 [00:03<00:25, 34.77batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 34.52batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.77batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.99batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 35.12batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.34batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.31batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.33batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.18batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 35.43batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 35.35batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 35.14batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.32batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.18batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.08batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.11batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.14batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 35.05batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 35.00batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.93batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 34.88batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 34.74batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.69batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.71batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.88batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 35.03batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.95batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.03batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.08batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.08batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.00batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.80batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.89batch/s] 28%|███████▍                   | 280/1014 [00:08<00:20, 34.98batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 34.72batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.56batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.43batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.33batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.15batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 34.04batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 33.80batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 33.78batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 33.66batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 33.71batch/s] 33%|████████▉                  | 335/1014 [00:09<00:20, 33.74batch/s] 34%|█████████                  | 340/1014 [00:10<00:20, 33.69batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 33.73batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 33.68batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 33.63batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 33.61batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:19, 33.54batch/s] 36%|█████████▊                 | 370/1014 [00:11<00:19, 33.57batch/s] 37%|█████████▉                 | 375/1014 [00:11<00:19, 33.44batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 33.50batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 33.43batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 33.46batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 33.52batch/s] 39%|██████████▋                | 400/1014 [00:11<00:18, 33.53batch/s] 40%|██████████▊                | 405/1014 [00:12<00:18, 33.57batch/s] 40%|██████████▉                | 410/1014 [00:12<00:17, 33.63batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 33.74batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 33.77batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.85batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 33.86batch/s] 43%|███████████▌               | 435/1014 [00:12<00:17, 33.84batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 33.92batch/s] 44%|███████████▊               | 445/1014 [00:13<00:16, 33.97batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.02batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.00batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 33.95batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 33.93batch/s] 46%|████████████▌              | 470/1014 [00:13<00:16, 33.90batch/s] 47%|████████████▋              | 475/1014 [00:14<00:15, 33.92batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 33.96batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.99batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.01batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.00batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 34.08batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.06batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.00batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 34.04batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.07batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.02batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 34.03batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 34.02batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.04batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 33.99batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 34.00batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.02batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.06batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 34.05batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 34.07batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.03batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 33.95batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 33.94batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.91batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 33.81batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 33.76batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 33.71batch/s] 60%|████████████████▏          | 610/1014 [00:18<00:11, 33.74batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 33.76batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 33.74batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 33.74batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 33.73batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 33.69batch/s] 63%|█████████████████          | 640/1014 [00:19<00:11, 33.65batch/s] 64%|█████████████████▏         | 645/1014 [00:19<00:10, 33.67batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 33.67batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 33.71batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 33.72batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.77batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 33.74batch/s] 67%|█████████████████▉         | 675/1014 [00:20<00:10, 33.70batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.71batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 33.73batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.74batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 33.80batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 33.81batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 33.84batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 33.85batch/s] 71%|███████████████████        | 715/1014 [00:21<00:08, 33.86batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 33.85batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 33.87batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 33.84batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 33.85batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:08, 33.89batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 33.91batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 33.91batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.86batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.87batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 33.86batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.89batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:07, 33.93batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 33.95batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.96batch/s] 78%|█████████████████████      | 790/1014 [00:23<00:06, 33.93batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 33.96batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.01batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.01batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:06, 33.90batch/s] 80%|█████████████████████▋     | 815/1014 [00:24<00:05, 33.90batch/s] 81%|█████████████████████▊     | 820/1014 [00:24<00:05, 33.89batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 33.90batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 33.87batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 33.88batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 33.91batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 33.90batch/s] 84%|██████████████████████▋    | 850/1014 [00:25<00:04, 33.83batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 33.86batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 33.89batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 33.88batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 33.89batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 33.89batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 33.94batch/s] 87%|███████████████████████▌   | 885/1014 [00:26<00:03, 33.92batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 33.88batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 33.91batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 33.89batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 33.91batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 33.94batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 33.92batch/s] 91%|████████████████████████▍  | 920/1014 [00:27<00:02, 33.87batch/s] 91%|████████████████████████▋  | 925/1014 [00:27<00:02, 33.89batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 33.90batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 33.91batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 33.87batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 33.88batch/s] 94%|█████████████████████████▎ | 950/1014 [00:28<00:01, 33.87batch/s] 94%|█████████████████████████▍ | 955/1014 [00:28<00:01, 33.83batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 33.81batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 33.84batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 33.87batch/s] 96%|█████████████████████████▉ | 976/1014 [00:28<00:01, 33.93batch/s] 97%|██████████████████████████▏| 982/1014 [00:28<00:00, 33.95batch/s] 97%|██████████████████████████▎| 988/1014 [00:29<00:00, 33.96batch/s] 98%|██████████████████████████▍| 994/1014 [00:29<00:00, 33.99batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.02batch/s] 99%|█████████████████████████▊| 1006/1014 [00:29<00:00, 34.03batch/s]100%|█████████████████████████▉| 1012/1014 [00:29<00:00, 34.00batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 33.98batch/s]
Validation 27 -> LOSS = 0.26
Validation 27 -> BLEU = 95.75, 98.3/96.5/95.1/93.5 (BP=0.999, ratio=0.999, hyp_len=14371, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.26 @ validation 26
--> Best BLEU so far: 95.76 @ validation 26
Starting Epoch 28
Epoch 28 - update      13020 => loss:   0.135 (#OOM: 0)
Epoch 28 - update      13050 => loss:   0.140 (#OOM: 0)
Epoch 28 - update      13080 => loss:   0.184 (#OOM: 0)
Epoch 28 - update      13110 => loss:   0.092 (#OOM: 0)
Epoch 28 - update      13140 => loss:   0.099 (#OOM: 0)
Epoch 28 - update      13170 => loss:   0.149 (#OOM: 0)
Epoch 28 - update      13200 => loss:   0.174 (#OOM: 0)
Epoch 28 - update      13230 => loss:   0.083 (#OOM: 0)
Epoch 28 - update      13260 => loss:   0.097 (#OOM: 0)
Epoch 28 - update      13290 => loss:   0.131 (#OOM: 0)
Epoch 28 - update      13320 => loss:   0.115 (#OOM: 0)
Epoch 28 - update      13350 => loss:   0.153 (#OOM: 0)
Epoch 28 - update      13380 => loss:   0.222 (#OOM: 0)
Epoch 28 - update      13410 => loss:   0.128 (#OOM: 0)
Epoch 28 - update      13440 => loss:   0.160 (#OOM: 0)
Epoch 28 - update      13470 => loss:   0.006 (#OOM: 0)
--> Epoch 28 finished with mean loss 0.15714
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.33 mins)   (681 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.64batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 16.53batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 14.01batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.62batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.68batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.17batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.97batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.00batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.90batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.59batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.73batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.05batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.05batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:24, 41.47batch/s]  1%|▎                           | 10/1014 [00:00<00:28, 35.68batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 36.41batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 35.59batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.93batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 36.07batch/s]  3%|▉                           | 35/1014 [00:00<00:26, 36.40batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.32batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.78batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.80batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.33batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.31batch/s]  6%|█▊                          | 65/1014 [00:01<00:25, 36.59batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 35.92batch/s]  7%|██                          | 75/1014 [00:02<00:26, 35.90batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.36batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 35.24batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 34.84batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.94batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.80batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.93batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.56batch/s] 11%|███                        | 115/1014 [00:03<00:25, 34.64batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 34.77batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.59batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.77batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.91batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.04batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 34.78batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 34.67batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 34.69batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.57batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.75batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.53batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.59batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.60batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 34.43batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.55batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.43batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.48batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.57batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.63batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.54batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.39batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.47batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.56batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.66batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.64batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.58batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.20batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 34.16batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 34.26batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.10batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.23batch/s] 27%|███████▎                   | 275/1014 [00:08<00:21, 34.27batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.31batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 34.22batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 34.31batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.27batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.26batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.25batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 34.22batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.23batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.36batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 34.44batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.54batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.56batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.61batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 34.73batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.68batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.66batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.64batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.58batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.56batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.51batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.50batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.50batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.47batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.43batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.44batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.31batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.30batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 34.31batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.37batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.30batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 34.34batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.38batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.34batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.27batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.28batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.39batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.35batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 34.27batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.25batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.20batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 34.17batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.13batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.11batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.15batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 34.20batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.19batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.08batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 34.11batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.15batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.12batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 34.07batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 34.07batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.06batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 34.06batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 34.11batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.11batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.08batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 33.99batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 33.91batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 33.94batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 33.97batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 34.01batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.00batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.03batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 34.03batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 34.01batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.03batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 34.00batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 34.01batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 33.99batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.03batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 34.04batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.00batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.01batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 34.01batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 34.05batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.02batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.99batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 33.97batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 33.96batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.00batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 34.02batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 34.00batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.04batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.06batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 33.95batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 33.93batch/s] 71%|███████████████████        | 715/1014 [00:21<00:08, 33.98batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 33.95batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 33.95batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 33.97batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 33.99batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:08, 33.97batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 33.95batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 33.98batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.99batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.99batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 33.96batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.95batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:07, 33.96batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 33.97batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.97batch/s] 78%|█████████████████████      | 790/1014 [00:23<00:06, 33.97batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 33.97batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 33.99batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.00batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.00batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 33.97batch/s] 81%|█████████████████████▊     | 820/1014 [00:24<00:05, 33.94batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 33.93batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 33.88batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 33.87batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 33.88batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 33.91batch/s] 84%|██████████████████████▋    | 850/1014 [00:25<00:04, 33.93batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 33.95batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 33.97batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 33.99batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.02batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.02batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.03batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.07batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 34.06batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 34.01batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.03batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.05batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.06batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.10batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.08batch/s] 91%|████████████████████████▋  | 925/1014 [00:27<00:02, 34.08batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 34.10batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.06batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.07batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 34.10batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.09batch/s] 94%|█████████████████████████▍ | 955/1014 [00:28<00:01, 34.08batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 34.08batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 34.06batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.05batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.10batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.06batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.03batch/s] 98%|██████████████████████████▎| 990/1014 [00:29<00:00, 34.02batch/s] 98%|██████████████████████████▍| 995/1014 [00:29<00:00, 34.00batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.00batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.03batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.05batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.04batch/s]
Validation 28 -> LOSS = 0.25
Validation 28 -> BLEU = 95.78, 98.3/96.5/95.0/93.4 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 28
--> Best BLEU so far: 95.78 @ validation 28
Starting Epoch 29
Epoch 29 - update      13500 => loss:   0.151 (#OOM: 0)
Epoch 29 - update      13530 => loss:   0.199 (#OOM: 0)
Epoch 29 - update      13560 => loss:   0.103 (#OOM: 0)
Epoch 29 - update      13590 => loss:   0.111 (#OOM: 0)
Epoch 29 - update      13620 => loss:   0.114 (#OOM: 0)
Epoch 29 - update      13650 => loss:   0.078 (#OOM: 0)
Epoch 29 - update      13680 => loss:   0.144 (#OOM: 0)
Epoch 29 - update      13710 => loss:   0.089 (#OOM: 0)
Epoch 29 - update      13740 => loss:   0.057 (#OOM: 0)
Epoch 29 - update      13770 => loss:   0.115 (#OOM: 0)
Epoch 29 - update      13800 => loss:   0.157 (#OOM: 0)
Epoch 29 - update      13830 => loss:   0.055 (#OOM: 0)
Epoch 29 - update      13860 => loss:   0.056 (#OOM: 0)
Epoch 29 - update      13890 => loss:   0.128 (#OOM: 0)
Epoch 29 - update      13920 => loss:   0.156 (#OOM: 0)
Epoch 29 - update      13950 => loss:   0.155 (#OOM: 0)
--> Epoch 29 finished with mean loss 0.14859
--> Overhead/Training/Evaluation: 0.59/0.71/0.00 mins (total: 1.30 mins)   (679 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  9.63batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.85batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 10.52batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.47batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.08batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.56batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.87batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.13batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.50batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.75batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.88batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.95batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.19batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.02batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.17batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.25batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:34, 29.06batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.46batch/s]  1%|▎                           | 13/1014 [00:00<00:29, 33.82batch/s]  2%|▍                           | 18/1014 [00:00<00:29, 33.84batch/s]  2%|▋                           | 23/1014 [00:00<00:29, 33.10batch/s]  3%|▊                           | 28/1014 [00:00<00:29, 33.13batch/s]  3%|▉                           | 33/1014 [00:01<00:30, 31.65batch/s]  4%|█                           | 38/1014 [00:01<00:31, 31.40batch/s]  4%|█▏                          | 43/1014 [00:01<00:31, 30.76batch/s]  5%|█▎                          | 48/1014 [00:01<00:31, 30.71batch/s]  5%|█▍                          | 53/1014 [00:01<00:30, 31.22batch/s]  6%|█▌                          | 58/1014 [00:01<00:30, 31.81batch/s]  6%|█▋                          | 63/1014 [00:01<00:29, 32.21batch/s]  7%|█▉                          | 68/1014 [00:02<00:29, 32.00batch/s]  7%|██                          | 73/1014 [00:02<00:29, 31.90batch/s]  8%|██▏                         | 78/1014 [00:02<00:29, 31.21batch/s]  8%|██▎                         | 83/1014 [00:02<00:29, 31.60batch/s]  9%|██▍                         | 88/1014 [00:02<00:29, 31.47batch/s]  9%|██▌                         | 93/1014 [00:02<00:29, 31.73batch/s] 10%|██▋                         | 98/1014 [00:03<00:28, 31.64batch/s] 10%|██▋                        | 103/1014 [00:03<00:28, 32.05batch/s] 11%|██▉                        | 108/1014 [00:03<00:28, 32.13batch/s] 11%|███                        | 113/1014 [00:03<00:27, 32.45batch/s] 12%|███▏                       | 118/1014 [00:03<00:27, 32.61batch/s] 12%|███▎                       | 123/1014 [00:03<00:27, 32.55batch/s] 13%|███▍                       | 128/1014 [00:03<00:27, 32.50batch/s] 13%|███▌                       | 133/1014 [00:04<00:26, 32.66batch/s] 14%|███▋                       | 138/1014 [00:04<00:26, 32.46batch/s] 14%|███▊                       | 143/1014 [00:04<00:26, 32.67batch/s] 15%|███▉                       | 148/1014 [00:04<00:26, 32.67batch/s] 15%|████                       | 153/1014 [00:04<00:26, 32.87batch/s] 16%|████▏                      | 158/1014 [00:04<00:26, 32.88batch/s] 16%|████▎                      | 163/1014 [00:04<00:25, 32.87batch/s] 17%|████▍                      | 168/1014 [00:05<00:25, 33.07batch/s] 17%|████▌                      | 173/1014 [00:05<00:25, 33.04batch/s] 18%|████▋                      | 178/1014 [00:05<00:25, 33.19batch/s] 18%|████▊                      | 183/1014 [00:05<00:24, 33.29batch/s] 19%|█████                      | 188/1014 [00:05<00:24, 33.46batch/s] 19%|█████▏                     | 193/1014 [00:05<00:24, 33.49batch/s] 20%|█████▎                     | 198/1014 [00:05<00:24, 33.45batch/s] 20%|█████▍                     | 203/1014 [00:06<00:24, 33.46batch/s] 21%|█████▌                     | 208/1014 [00:06<00:24, 33.52batch/s] 21%|█████▋                     | 213/1014 [00:06<00:23, 33.56batch/s] 21%|█████▊                     | 218/1014 [00:06<00:23, 33.40batch/s] 22%|█████▉                     | 223/1014 [00:06<00:23, 33.39batch/s] 22%|██████                     | 228/1014 [00:06<00:23, 33.33batch/s] 23%|██████▏                    | 233/1014 [00:06<00:23, 33.42batch/s] 23%|██████▎                    | 238/1014 [00:07<00:23, 33.36batch/s] 24%|██████▍                    | 243/1014 [00:07<00:23, 33.52batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 33.58batch/s] 25%|██████▋                    | 253/1014 [00:07<00:22, 33.47batch/s] 25%|██████▊                    | 258/1014 [00:07<00:22, 33.46batch/s] 26%|███████                    | 263/1014 [00:07<00:22, 33.51batch/s] 26%|███████▏                   | 268/1014 [00:07<00:22, 33.64batch/s] 27%|███████▎                   | 273/1014 [00:08<00:22, 33.56batch/s] 27%|███████▍                   | 278/1014 [00:08<00:21, 33.59batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 33.70batch/s] 28%|███████▋                   | 288/1014 [00:08<00:21, 33.58batch/s] 29%|███████▊                   | 293/1014 [00:08<00:21, 33.50batch/s] 29%|███████▉                   | 298/1014 [00:08<00:21, 33.52batch/s] 30%|████████                   | 303/1014 [00:09<00:21, 33.44batch/s] 30%|████████▏                  | 308/1014 [00:09<00:21, 33.44batch/s] 31%|████████▎                  | 313/1014 [00:09<00:20, 33.45batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 33.59batch/s] 32%|████████▌                  | 323/1014 [00:09<00:20, 33.62batch/s] 32%|████████▋                  | 328/1014 [00:09<00:20, 33.73batch/s] 33%|████████▊                  | 333/1014 [00:09<00:20, 33.79batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 33.80batch/s] 34%|█████████▏                 | 343/1014 [00:10<00:19, 33.83batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 33.85batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 33.78batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:19, 33.81batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:19, 33.86batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:19, 33.85batch/s] 37%|█████████▉                 | 373/1014 [00:11<00:19, 33.51batch/s] 37%|██████████                 | 378/1014 [00:11<00:18, 33.49batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 33.49batch/s] 38%|██████████▎                | 388/1014 [00:11<00:18, 33.57batch/s] 39%|██████████▍                | 393/1014 [00:11<00:18, 33.48batch/s] 39%|██████████▌                | 398/1014 [00:11<00:18, 33.54batch/s] 40%|██████████▋                | 403/1014 [00:12<00:18, 33.52batch/s] 40%|██████████▊                | 408/1014 [00:12<00:18, 33.58batch/s] 41%|██████████▉                | 413/1014 [00:12<00:17, 33.54batch/s] 41%|███████████▏               | 418/1014 [00:12<00:17, 33.59batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 33.53batch/s] 42%|███████████▍               | 428/1014 [00:12<00:17, 33.60batch/s] 43%|███████████▌               | 433/1014 [00:12<00:17, 33.49batch/s] 43%|███████████▋               | 438/1014 [00:13<00:17, 33.53batch/s] 44%|███████████▊               | 443/1014 [00:13<00:17, 33.53batch/s] 44%|███████████▉               | 448/1014 [00:13<00:16, 33.53batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 33.50batch/s] 45%|████████████▏              | 458/1014 [00:13<00:16, 33.48batch/s] 46%|████████████▎              | 463/1014 [00:13<00:16, 33.41batch/s] 46%|████████████▍              | 468/1014 [00:14<00:16, 33.41batch/s] 47%|████████████▌              | 473/1014 [00:14<00:16, 33.38batch/s] 47%|████████████▋              | 478/1014 [00:14<00:16, 33.48batch/s] 48%|████████████▊              | 483/1014 [00:14<00:15, 33.47batch/s] 48%|████████████▉              | 488/1014 [00:14<00:15, 33.51batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:15, 33.48batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:15, 33.53batch/s] 50%|█████████████▍             | 503/1014 [00:15<00:15, 33.50batch/s] 50%|█████████████▌             | 508/1014 [00:15<00:15, 33.43batch/s] 51%|█████████████▋             | 513/1014 [00:15<00:14, 33.41batch/s] 51%|█████████████▊             | 518/1014 [00:15<00:14, 33.51batch/s] 52%|█████████████▉             | 523/1014 [00:15<00:14, 33.51batch/s] 52%|██████████████             | 528/1014 [00:15<00:14, 33.56batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:14, 33.59batch/s] 53%|██████████████▎            | 538/1014 [00:16<00:14, 33.61batch/s] 54%|██████████████▍            | 543/1014 [00:16<00:14, 33.63batch/s] 54%|██████████████▌            | 548/1014 [00:16<00:13, 33.63batch/s] 55%|██████████████▋            | 553/1014 [00:16<00:13, 33.62batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 33.65batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 33.65batch/s] 56%|███████████████            | 568/1014 [00:16<00:13, 33.66batch/s] 57%|███████████████▎           | 573/1014 [00:17<00:13, 33.68batch/s] 57%|███████████████▍           | 578/1014 [00:17<00:12, 33.73batch/s] 57%|███████████████▌           | 583/1014 [00:17<00:12, 33.75batch/s] 58%|███████████████▋           | 588/1014 [00:17<00:12, 33.77batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 33.80batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:12, 33.78batch/s] 59%|████████████████           | 603/1014 [00:17<00:12, 33.80batch/s] 60%|████████████████▏          | 608/1014 [00:18<00:12, 33.77batch/s] 60%|████████████████▎          | 613/1014 [00:18<00:11, 33.81batch/s] 61%|████████████████▍          | 618/1014 [00:18<00:11, 33.85batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 33.88batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 33.87batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:11, 33.90batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:11, 33.92batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 33.93batch/s] 64%|█████████████████▎         | 648/1014 [00:19<00:10, 33.93batch/s] 64%|█████████████████▍         | 653/1014 [00:19<00:10, 33.94batch/s] 65%|█████████████████▌         | 658/1014 [00:19<00:10, 33.96batch/s] 65%|█████████████████▋         | 663/1014 [00:19<00:10, 33.93batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:10, 33.98batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:10, 34.05batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.04batch/s] 67%|██████████████████▏        | 683/1014 [00:20<00:09, 34.04batch/s] 68%|██████████████████▎        | 688/1014 [00:20<00:09, 34.03batch/s] 68%|██████████████████▍        | 693/1014 [00:20<00:09, 34.02batch/s] 69%|██████████████████▌        | 698/1014 [00:20<00:09, 33.98batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:09, 33.99batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.03batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.09batch/s] 71%|███████████████████        | 718/1014 [00:21<00:08, 34.09batch/s] 71%|███████████████████▎       | 723/1014 [00:21<00:08, 34.11batch/s] 72%|███████████████████▍       | 728/1014 [00:21<00:08, 34.15batch/s] 72%|███████████████████▌       | 733/1014 [00:21<00:08, 34.17batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:08, 34.18batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.17batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.21batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.23batch/s] 75%|████████████████████▏      | 758/1014 [00:22<00:07, 34.25batch/s] 75%|████████████████████▎      | 763/1014 [00:22<00:07, 34.24batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.22batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:07, 34.23batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.27batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 34.31batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 34.34batch/s] 78%|█████████████████████      | 793/1014 [00:23<00:06, 34.35batch/s] 79%|█████████████████████▏     | 798/1014 [00:23<00:06, 34.35batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.33batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:06, 34.33batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.29batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.29batch/s] 81%|█████████████████████▉     | 823/1014 [00:24<00:05, 34.25batch/s] 82%|██████████████████████     | 828/1014 [00:24<00:05, 34.31batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.36batch/s] 83%|██████████████████████▎    | 838/1014 [00:24<00:05, 34.32batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 34.31batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.32batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.31batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 34.34batch/s] 85%|██████████████████████▉    | 863/1014 [00:25<00:04, 34.36batch/s] 86%|███████████████████████    | 868/1014 [00:25<00:04, 34.38batch/s] 86%|███████████████████████▏   | 873/1014 [00:25<00:04, 34.34batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.29batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.19batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.21batch/s] 88%|███████████████████████▊   | 893/1014 [00:26<00:03, 34.19batch/s] 89%|███████████████████████▉   | 898/1014 [00:26<00:03, 34.13batch/s] 89%|████████████████████████   | 903/1014 [00:26<00:03, 34.08batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.04batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 33.98batch/s] 91%|████████████████████████▍  | 918/1014 [00:27<00:02, 33.96batch/s] 91%|████████████████████████▌  | 923/1014 [00:27<00:02, 33.95batch/s] 92%|████████████████████████▋  | 928/1014 [00:27<00:02, 33.94batch/s] 92%|████████████████████████▊  | 933/1014 [00:27<00:02, 33.96batch/s] 93%|████████████████████████▉  | 938/1014 [00:27<00:02, 33.96batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 33.96batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 33.96batch/s] 94%|█████████████████████████▍ | 953/1014 [00:28<00:01, 33.96batch/s] 94%|█████████████████████████▌ | 958/1014 [00:28<00:01, 33.95batch/s] 95%|█████████████████████████▋ | 963/1014 [00:28<00:01, 33.95batch/s] 95%|█████████████████████████▊ | 968/1014 [00:28<00:01, 33.97batch/s] 96%|█████████████████████████▉ | 973/1014 [00:28<00:01, 33.98batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 33.98batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 33.99batch/s] 97%|██████████████████████████▎| 988/1014 [00:29<00:00, 33.98batch/s] 98%|██████████████████████████▍| 993/1014 [00:29<00:00, 33.97batch/s] 98%|██████████████████████████▌| 998/1014 [00:29<00:00, 33.93batch/s] 99%|█████████████████████████▋| 1003/1014 [00:29<00:00, 33.90batch/s] 99%|█████████████████████████▊| 1008/1014 [00:29<00:00, 33.90batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 33.87batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 33.87batch/s]
Validation 29 -> LOSS = 0.26
Validation 29 -> BLEU = 96.00, 98.4/96.7/95.3/93.9 (BP=1.000, ratio=1.000, hyp_len=14376, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 28
--> Best BLEU so far: 96.00 @ validation 29
Starting Epoch 30
Epoch 30 - update      13980 => loss:   0.068 (#OOM: 0)
Epoch 30 - update      14010 => loss:   0.125 (#OOM: 0)
Epoch 30 - update      14040 => loss:   0.142 (#OOM: 0)
Epoch 30 - update      14070 => loss:   0.065 (#OOM: 0)
Epoch 30 - update      14100 => loss:   0.114 (#OOM: 0)
Epoch 30 - update      14130 => loss:   0.119 (#OOM: 0)
Epoch 30 - update      14160 => loss:   0.147 (#OOM: 0)
Epoch 30 - update      14190 => loss:   0.051 (#OOM: 0)
Epoch 30 - update      14220 => loss:   0.189 (#OOM: 0)
Epoch 30 - update      14250 => loss:   0.147 (#OOM: 0)
Epoch 30 - update      14280 => loss:   0.132 (#OOM: 0)
Epoch 30 - update      14310 => loss:   0.161 (#OOM: 0)
Epoch 30 - update      14340 => loss:   0.072 (#OOM: 0)
Epoch 30 - update      14370 => loss:   0.133 (#OOM: 0)
Epoch 30 - update      14400 => loss:   0.094 (#OOM: 0)
Epoch 30 - update      14430 => loss:   0.142 (#OOM: 0)
Epoch 30 - update      14460 => loss:   0.161 (#OOM: 0)
--> Epoch 30 finished with mean loss 0.14534
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (670 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 18.17batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 14.42batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 15.75batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 15.28batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 14.57batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.23batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.31batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 15.67batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:00, 15.20batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 15.00batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.77batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 14.47batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.92batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.84batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.47batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 33.95batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 34.92batch/s]  2%|▍                           | 16/1014 [00:00<00:29, 33.99batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 34.53batch/s]  2%|▋                           | 24/1014 [00:00<00:29, 33.59batch/s]  3%|▊                           | 28/1014 [00:00<00:29, 33.64batch/s]  3%|▉                           | 32/1014 [00:00<00:29, 33.18batch/s]  4%|▉                           | 36/1014 [00:01<00:29, 33.68batch/s]  4%|█▏                          | 41/1014 [00:01<00:28, 34.62batch/s]  5%|█▎                          | 46/1014 [00:01<00:28, 34.56batch/s]  5%|█▍                          | 51/1014 [00:01<00:27, 34.73batch/s]  6%|█▌                          | 56/1014 [00:01<00:27, 34.92batch/s]  6%|█▋                          | 61/1014 [00:01<00:27, 34.86batch/s]  7%|█▊                          | 66/1014 [00:01<00:27, 34.57batch/s]  7%|█▉                          | 71/1014 [00:02<00:27, 34.71batch/s]  7%|██                          | 76/1014 [00:02<00:27, 34.47batch/s]  8%|██▏                         | 81/1014 [00:02<00:27, 34.46batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 34.77batch/s]  9%|██▌                         | 91/1014 [00:02<00:26, 34.71batch/s]  9%|██▋                         | 96/1014 [00:02<00:26, 34.31batch/s] 10%|██▋                        | 101/1014 [00:02<00:26, 34.63batch/s] 10%|██▊                        | 106/1014 [00:03<00:26, 34.68batch/s] 11%|██▉                        | 111/1014 [00:03<00:25, 34.82batch/s] 11%|███                        | 116/1014 [00:03<00:25, 34.96batch/s] 12%|███▏                       | 121/1014 [00:03<00:25, 35.09batch/s] 12%|███▎                       | 126/1014 [00:03<00:25, 34.95batch/s] 13%|███▍                       | 131/1014 [00:03<00:25, 34.62batch/s] 13%|███▌                       | 136/1014 [00:03<00:25, 34.71batch/s] 14%|███▊                       | 141/1014 [00:04<00:25, 34.75batch/s] 14%|███▉                       | 146/1014 [00:04<00:25, 34.67batch/s] 15%|████                       | 151/1014 [00:04<00:24, 34.56batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 34.57batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 34.50batch/s] 16%|████▍                      | 166/1014 [00:04<00:24, 34.48batch/s] 17%|████▌                      | 171/1014 [00:04<00:24, 34.53batch/s] 17%|████▋                      | 176/1014 [00:05<00:24, 34.36batch/s] 18%|████▊                      | 181/1014 [00:05<00:24, 34.25batch/s] 18%|████▉                      | 186/1014 [00:05<00:24, 34.20batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 34.40batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 34.39batch/s] 20%|█████▎                     | 201/1014 [00:05<00:23, 34.46batch/s] 20%|█████▍                     | 206/1014 [00:05<00:23, 34.58batch/s] 21%|█████▌                     | 211/1014 [00:06<00:23, 34.64batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 34.74batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 34.77batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 34.63batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 34.64batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.69batch/s] 24%|██████▍                    | 241/1014 [00:06<00:22, 34.78batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.68batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 34.76batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 34.53batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 34.60batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 34.62batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.63batch/s] 27%|███████▎                   | 276/1014 [00:07<00:21, 34.59batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.68batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 34.75batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 34.71batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 34.68batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 34.70batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 34.70batch/s] 31%|████████▎                  | 311/1014 [00:08<00:20, 34.65batch/s] 31%|████████▍                  | 316/1014 [00:09<00:20, 34.70batch/s] 32%|████████▌                  | 321/1014 [00:09<00:19, 34.83batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 34.80batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 34.80batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 34.74batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 34.80batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:19, 34.81batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:18, 34.96batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 35.03batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.01batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.03batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 35.07batch/s] 38%|██████████▏                | 382/1014 [00:10<00:18, 35.09batch/s] 38%|██████████▎                | 388/1014 [00:11<00:17, 35.09batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.16batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.18batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 35.21batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 35.21batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 35.14batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.15batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.18batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 35.18batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 35.20batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 35.12batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.20batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.11batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 35.11batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.02batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 35.06batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 35.13batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.12batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 35.18batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 35.15batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.12batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.03batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 35.03batch/s] 52%|██████████████             | 526/1014 [00:15<00:13, 35.04batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 35.02batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.05batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.00batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 35.00batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:13, 35.00batch/s] 55%|██████████████▉            | 562/1014 [00:16<00:12, 35.08batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 34.98batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.93batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.96batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 34.89batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:12, 34.89batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:11, 34.90batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.85batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.81batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 34.88batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 34.87batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 34.80batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.83batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.80batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 34.83batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 34.83batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 34.85batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.83batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.78batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 34.80batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 34.78batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 34.79batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.72batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.69batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 34.71batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 34.76batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 34.73batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.75batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.74batch/s] 73%|███████████████████▌       | 736/1014 [00:21<00:08, 34.73batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 34.76batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.71batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.60batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.59batch/s] 76%|████████████████████▍      | 766/1014 [00:22<00:07, 34.61batch/s] 76%|████████████████████▌      | 772/1014 [00:22<00:06, 34.62batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.64batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.68batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.72batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 34.72batch/s] 79%|█████████████████████▎     | 802/1014 [00:23<00:06, 34.74batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 34.75batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.67batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.64batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 34.64batch/s] 82%|██████████████████████▏    | 832/1014 [00:24<00:05, 34.67batch/s] 83%|██████████████████████▎    | 838/1014 [00:24<00:05, 34.65batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.68batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.63batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 34.63batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 34.63batch/s] 86%|███████████████████████    | 868/1014 [00:25<00:04, 34.64batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.63batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.62batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 34.65batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 34.69batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.69batch/s] 89%|████████████████████████   | 904/1014 [00:26<00:03, 34.72batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.71batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.68batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 34.72batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.74batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.71batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.70batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.70batch/s] 94%|█████████████████████████▎ | 952/1014 [00:27<00:01, 34.70batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.71batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.70batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 34.71batch/s] 96%|█████████████████████████▉ | 976/1014 [00:28<00:01, 34.72batch/s] 97%|██████████████████████████▏| 982/1014 [00:28<00:00, 34.72batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.74batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.72batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.74batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 34.75batch/s]100%|█████████████████████████▉| 1012/1014 [00:29<00:00, 34.75batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.75batch/s]
Validation 30 -> LOSS = 0.26
Validation 30 -> BLEU = 95.97, 98.3/96.6/95.2/93.8 (BP=1.000, ratio=1.000, hyp_len=14386, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 28
--> Best BLEU so far: 96.00 @ validation 29
Starting Epoch 31
Epoch 31 - update      14490 => loss:   0.195 (#OOM: 0)
Epoch 31 - update      14520 => loss:   0.113 (#OOM: 0)
Epoch 31 - update      14550 => loss:   0.201 (#OOM: 0)
Epoch 31 - update      14580 => loss:   0.150 (#OOM: 0)
Epoch 31 - update      14610 => loss:   0.153 (#OOM: 0)
Epoch 31 - update      14640 => loss:   0.136 (#OOM: 0)
Epoch 31 - update      14670 => loss:   0.131 (#OOM: 0)
Epoch 31 - update      14700 => loss:   0.206 (#OOM: 0)
Epoch 31 - update      14730 => loss:   0.157 (#OOM: 0)
Epoch 31 - update      14760 => loss:   0.078 (#OOM: 0)
Epoch 31 - update      14790 => loss:   0.201 (#OOM: 0)
Epoch 31 - update      14820 => loss:   0.113 (#OOM: 0)
Epoch 31 - update      14850 => loss:   0.147 (#OOM: 0)
Epoch 31 - update      14880 => loss:   0.106 (#OOM: 0)
Epoch 31 - update      14910 => loss:   0.198 (#OOM: 0)
Epoch 31 - update      14940 => loss:   0.137 (#OOM: 0)
--> Epoch 31 finished with mean loss 0.14071
--> Overhead/Training/Evaluation: 0.66/0.72/0.00 mins (total: 1.38 mins)   (670 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.64batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 16.19batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 14.83batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.05batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.69batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.40batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.26batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.12batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.51batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 12.64batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.06batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.08batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.08batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:35, 28.38batch/s]  1%|▏                            | 7/1014 [00:00<00:31, 32.42batch/s]  1%|▎                           | 11/1014 [00:00<00:30, 32.86batch/s]  2%|▍                           | 16/1014 [00:00<00:28, 35.32batch/s]  2%|▌                           | 21/1014 [00:00<00:28, 34.29batch/s]  3%|▋                           | 26/1014 [00:00<00:28, 34.60batch/s]  3%|▊                           | 31/1014 [00:00<00:28, 34.08batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 33.82batch/s]  4%|█▏                          | 41/1014 [00:01<00:28, 34.37batch/s]  5%|█▎                          | 46/1014 [00:01<00:27, 34.92batch/s]  5%|█▍                          | 51/1014 [00:01<00:27, 35.49batch/s]  6%|█▌                          | 56/1014 [00:01<00:27, 34.29batch/s]  6%|█▋                          | 61/1014 [00:01<00:27, 34.46batch/s]  7%|█▊                          | 66/1014 [00:01<00:27, 34.97batch/s]  7%|█▉                          | 71/1014 [00:02<00:27, 34.64batch/s]  7%|██                          | 76/1014 [00:02<00:27, 34.52batch/s]  8%|██▏                         | 81/1014 [00:02<00:27, 34.24batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 34.52batch/s]  9%|██▌                         | 91/1014 [00:02<00:26, 34.50batch/s]  9%|██▋                         | 96/1014 [00:02<00:26, 34.53batch/s] 10%|██▋                        | 101/1014 [00:02<00:26, 34.36batch/s] 10%|██▊                        | 106/1014 [00:03<00:26, 34.42batch/s] 11%|██▉                        | 111/1014 [00:03<00:26, 34.13batch/s] 11%|███                        | 116/1014 [00:03<00:26, 34.08batch/s] 12%|███▏                       | 121/1014 [00:03<00:26, 34.27batch/s] 12%|███▎                       | 126/1014 [00:03<00:25, 34.51batch/s] 13%|███▍                       | 131/1014 [00:03<00:25, 34.56batch/s] 13%|███▌                       | 136/1014 [00:03<00:25, 34.58batch/s] 14%|███▊                       | 141/1014 [00:04<00:25, 34.68batch/s] 14%|███▉                       | 146/1014 [00:04<00:24, 34.94batch/s] 15%|████                       | 151/1014 [00:04<00:24, 34.76batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 34.82batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 34.76batch/s] 16%|████▍                      | 166/1014 [00:04<00:24, 34.84batch/s] 17%|████▌                      | 171/1014 [00:04<00:24, 34.97batch/s] 17%|████▋                      | 176/1014 [00:05<00:23, 35.19batch/s] 18%|████▊                      | 181/1014 [00:05<00:23, 35.07batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 35.10batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 35.17batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 35.04batch/s] 20%|█████▎                     | 201/1014 [00:05<00:23, 35.03batch/s] 20%|█████▍                     | 206/1014 [00:05<00:23, 35.02batch/s] 21%|█████▌                     | 211/1014 [00:06<00:22, 35.08batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 35.08batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 34.76batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 34.73batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 34.85batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.76batch/s] 24%|██████▍                    | 241/1014 [00:06<00:22, 34.86batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.68batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 34.72batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 34.67batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 34.71batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 34.90batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.98batch/s] 27%|███████▎                   | 276/1014 [00:07<00:21, 34.99batch/s] 28%|███████▍                   | 281/1014 [00:08<00:20, 35.10batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 35.17batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 35.27batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 35.28batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 35.32batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 35.28batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 35.31batch/s] 31%|████████▍                  | 316/1014 [00:08<00:19, 35.20batch/s] 32%|████████▌                  | 321/1014 [00:09<00:19, 35.18batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 35.16batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 35.16batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 35.18batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 35.03batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:19, 35.07batch/s] 35%|█████████▎                 | 351/1014 [00:10<00:18, 35.03batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:18, 35.00batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 35.01batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 35.06batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 35.09batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 35.16batch/s] 38%|██████████▏                | 381/1014 [00:10<00:17, 35.19batch/s] 38%|██████████▎                | 386/1014 [00:10<00:17, 35.14batch/s] 39%|██████████▍                | 391/1014 [00:11<00:17, 35.14batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 35.31batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 35.36batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.32batch/s] 41%|███████████                | 415/1014 [00:11<00:16, 35.30batch/s] 42%|███████████▏               | 421/1014 [00:11<00:16, 35.15batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 35.15batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 35.14batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.21batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.22batch/s] 44%|████████████               | 451/1014 [00:12<00:15, 35.22batch/s] 45%|████████████▏              | 457/1014 [00:12<00:15, 35.24batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 35.30batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.35batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 35.29batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 35.39batch/s] 48%|████████████▉              | 487/1014 [00:13<00:14, 35.38batch/s] 49%|█████████████▏             | 493/1014 [00:13<00:14, 35.31batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.39batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.32batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 35.26batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 35.20batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.19batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 35.23batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 35.20batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 35.23batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 35.26batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 35.30batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.26batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 35.26batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 35.23batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 35.24batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.19batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.21batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.16batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 35.19batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 35.15batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.17batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.26batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 35.25batch/s] 62%|████████████████▊          | 631/1014 [00:17<00:10, 35.28batch/s] 63%|████████████████▉          | 637/1014 [00:18<00:10, 35.25batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.21batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.22batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.21batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:10, 35.23batch/s] 66%|█████████████████▊         | 667/1014 [00:18<00:09, 35.25batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.23batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.26batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.28batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 35.23batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:08, 35.22batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 35.19batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.14batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.13batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 35.11batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 35.13batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:08, 35.11batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 35.09batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.09batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 35.11batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 35.07batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.11batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.09batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 35.08batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.09batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.11batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.10batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.10batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.05batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 35.04batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 35.04batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.07batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.06batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.08batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.09batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 35.05batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.03batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.03batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.02batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.02batch/s] 86%|███████████████████████▎   | 877/1014 [00:25<00:03, 35.07batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 35.04batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.06batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.07batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.05batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 35.07batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 35.08batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.05batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.07batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.07batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.07batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.09batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 35.14batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.14batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.12batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.09batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.11batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.15batch/s] 97%|██████████████████████████▏| 985/1014 [00:27<00:00, 35.19batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 35.16batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.10batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.08batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.10batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.09batch/s]
Validation 31 -> LOSS = 0.26
Validation 31 -> BLEU = 96.12, 98.4/96.8/95.5/94.0 (BP=1.000, ratio=1.000, hyp_len=14376, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 28
--> Best BLEU so far: 96.12 @ validation 31
Starting Epoch 32
Epoch 32 - update      14970 => loss:   0.120 (#OOM: 0)
Epoch 32 - update      15000 => loss:   0.128 (#OOM: 0)
Epoch 32 - update      15030 => loss:   0.139 (#OOM: 0)
Epoch 32 - update      15060 => loss:   0.138 (#OOM: 0)
Epoch 32 - update      15090 => loss:   0.145 (#OOM: 0)
Epoch 32 - update      15120 => loss:   0.070 (#OOM: 0)
Epoch 32 - update      15150 => loss:   0.152 (#OOM: 0)
Epoch 32 - update      15180 => loss:   0.133 (#OOM: 0)
Epoch 32 - update      15210 => loss:   0.135 (#OOM: 0)
Epoch 32 - update      15240 => loss:   0.130 (#OOM: 0)
Epoch 32 - update      15270 => loss:   0.220 (#OOM: 0)
Epoch 32 - update      15300 => loss:   0.127 (#OOM: 0)
Epoch 32 - update      15330 => loss:   0.155 (#OOM: 0)
Epoch 32 - update      15360 => loss:   0.106 (#OOM: 0)
Epoch 32 - update      15390 => loss:   0.123 (#OOM: 0)
Epoch 32 - update      15420 => loss:   0.104 (#OOM: 0)
--> Epoch 32 finished with mean loss 0.13530
--> Overhead/Training/Evaluation: 0.67/0.72/0.00 mins (total: 1.39 mins)   (675 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:01, 18.26batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 15.08batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 15.36batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.00batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 14.54batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.76batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.72batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.98batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.15batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.13batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 12.86batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 12.98batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:34, 29.55batch/s]  1%|▏                            | 8/1014 [00:00<00:26, 37.90batch/s]  1%|▎                           | 13/1014 [00:00<00:27, 35.97batch/s]  2%|▍                           | 18/1014 [00:00<00:28, 35.26batch/s]  2%|▋                           | 23/1014 [00:00<00:27, 36.61batch/s]  3%|▊                           | 28/1014 [00:00<00:26, 37.61batch/s]  3%|▉                           | 33/1014 [00:00<00:26, 37.42batch/s]  4%|█                           | 38/1014 [00:01<00:25, 37.99batch/s]  4%|█▏                          | 43/1014 [00:01<00:25, 37.54batch/s]  5%|█▎                          | 48/1014 [00:01<00:26, 36.79batch/s]  5%|█▍                          | 53/1014 [00:01<00:26, 35.92batch/s]  6%|█▌                          | 58/1014 [00:01<00:26, 35.70batch/s]  6%|█▋                          | 63/1014 [00:01<00:26, 35.93batch/s]  7%|█▉                          | 68/1014 [00:01<00:26, 36.12batch/s]  7%|██                          | 73/1014 [00:02<00:26, 35.95batch/s]  8%|██▏                         | 78/1014 [00:02<00:26, 35.97batch/s]  8%|██▎                         | 83/1014 [00:02<00:26, 35.75batch/s]  9%|██▍                         | 88/1014 [00:02<00:25, 35.75batch/s]  9%|██▌                         | 93/1014 [00:02<00:25, 35.61batch/s] 10%|██▋                         | 98/1014 [00:02<00:25, 35.69batch/s] 10%|██▋                        | 103/1014 [00:02<00:25, 35.36batch/s] 11%|██▉                        | 108/1014 [00:03<00:25, 35.33batch/s] 11%|███                        | 113/1014 [00:03<00:25, 34.90batch/s] 12%|███▏                       | 118/1014 [00:03<00:25, 35.10batch/s] 12%|███▎                       | 123/1014 [00:03<00:25, 35.29batch/s] 13%|███▍                       | 128/1014 [00:03<00:25, 35.24batch/s] 13%|███▌                       | 133/1014 [00:03<00:24, 35.49batch/s] 14%|███▋                       | 138/1014 [00:03<00:24, 35.23batch/s] 14%|███▊                       | 143/1014 [00:04<00:25, 34.75batch/s] 15%|███▉                       | 148/1014 [00:04<00:24, 34.75batch/s] 15%|████                       | 153/1014 [00:04<00:24, 34.71batch/s] 16%|████▏                      | 158/1014 [00:04<00:24, 34.68batch/s] 16%|████▎                      | 163/1014 [00:04<00:24, 34.81batch/s] 17%|████▍                      | 168/1014 [00:04<00:24, 34.75batch/s] 17%|████▌                      | 173/1014 [00:05<00:24, 34.54batch/s] 18%|████▋                      | 178/1014 [00:05<00:24, 34.22batch/s] 18%|████▊                      | 183/1014 [00:05<00:24, 34.25batch/s] 19%|█████                      | 188/1014 [00:05<00:24, 34.16batch/s] 19%|█████▏                     | 193/1014 [00:05<00:23, 34.27batch/s] 20%|█████▎                     | 198/1014 [00:05<00:23, 34.03batch/s] 20%|█████▍                     | 203/1014 [00:05<00:23, 33.94batch/s] 21%|█████▌                     | 208/1014 [00:06<00:23, 33.90batch/s] 21%|█████▋                     | 213/1014 [00:06<00:23, 33.75batch/s] 21%|█████▊                     | 218/1014 [00:06<00:23, 33.90batch/s] 22%|█████▉                     | 223/1014 [00:06<00:23, 33.87batch/s] 22%|██████                     | 228/1014 [00:06<00:23, 33.85batch/s] 23%|██████▏                    | 233/1014 [00:06<00:23, 33.79batch/s] 23%|██████▎                    | 238/1014 [00:07<00:22, 33.88batch/s] 24%|██████▍                    | 243/1014 [00:07<00:22, 33.92batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 33.79batch/s] 25%|██████▋                    | 253/1014 [00:07<00:22, 33.91batch/s] 25%|██████▊                    | 258/1014 [00:07<00:22, 33.93batch/s] 26%|███████                    | 263/1014 [00:07<00:22, 33.85batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 34.00batch/s] 27%|███████▎                   | 273/1014 [00:07<00:21, 34.15batch/s] 27%|███████▍                   | 278/1014 [00:08<00:21, 34.15batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 34.07batch/s] 28%|███████▋                   | 288/1014 [00:08<00:21, 34.12batch/s] 29%|███████▊                   | 293/1014 [00:08<00:21, 34.20batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 34.20batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 34.22batch/s] 30%|████████▏                  | 308/1014 [00:09<00:20, 34.19batch/s] 31%|████████▎                  | 313/1014 [00:09<00:20, 34.17batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 34.18batch/s] 32%|████████▌                  | 323/1014 [00:09<00:20, 34.20batch/s] 32%|████████▋                  | 328/1014 [00:09<00:20, 34.24batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 34.26batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 34.13batch/s] 34%|█████████▏                 | 343/1014 [00:10<00:19, 34.26batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 34.28batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 34.27batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:19, 34.23batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 34.29batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 34.21batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 34.19batch/s] 37%|██████████                 | 378/1014 [00:11<00:18, 34.27batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 34.26batch/s] 38%|██████████▎                | 388/1014 [00:11<00:18, 34.31batch/s] 39%|██████████▍                | 393/1014 [00:11<00:18, 34.19batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 34.23batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 34.20batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 34.21batch/s] 41%|██████████▉                | 413/1014 [00:12<00:17, 34.22batch/s] 41%|███████████▏               | 418/1014 [00:12<00:17, 34.20batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 34.22batch/s] 42%|███████████▍               | 428/1014 [00:12<00:17, 34.21batch/s] 43%|███████████▌               | 433/1014 [00:12<00:17, 34.17batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 34.22batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.18batch/s] 44%|███████████▉               | 448/1014 [00:13<00:16, 34.07batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 34.16batch/s] 45%|████████████▏              | 458/1014 [00:13<00:16, 34.14batch/s] 46%|████████████▎              | 463/1014 [00:13<00:16, 34.21batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 34.25batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.22batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 34.17batch/s] 48%|████████████▊              | 483/1014 [00:14<00:15, 34.21batch/s] 48%|████████████▉              | 488/1014 [00:14<00:15, 34.20batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:15, 34.21batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:15, 34.22batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.23batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 34.28batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 34.32batch/s] 51%|█████████████▊             | 518/1014 [00:15<00:14, 34.33batch/s] 52%|█████████████▉             | 523/1014 [00:15<00:14, 34.38batch/s] 52%|██████████████             | 528/1014 [00:15<00:14, 34.30batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:14, 34.30batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 34.33batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.36batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 34.33batch/s] 55%|██████████████▋            | 553/1014 [00:16<00:13, 34.23batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 34.17batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.18batch/s] 56%|███████████████            | 568/1014 [00:16<00:13, 34.15batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.23batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 34.25batch/s] 57%|███████████████▌           | 583/1014 [00:17<00:12, 34.27batch/s] 58%|███████████████▋           | 588/1014 [00:17<00:12, 34.32batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.35batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:12, 34.35batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 34.40batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 34.39batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 34.38batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 34.43batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 34.43batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 34.38batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:11, 34.41batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 34.35batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 34.38batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 34.41batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.46batch/s] 65%|█████████████████▌         | 658/1014 [00:19<00:10, 34.48batch/s] 65%|█████████████████▋         | 663/1014 [00:19<00:10, 34.54batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:10, 34.56batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 34.59batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.60batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.54batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 34.55batch/s] 68%|██████████████████▍        | 693/1014 [00:20<00:09, 34.54batch/s] 69%|██████████████████▌        | 698/1014 [00:20<00:09, 34.53batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:09, 34.50batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.49batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.54batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 34.56batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 34.56batch/s] 72%|███████████████████▍       | 728/1014 [00:21<00:08, 34.56batch/s] 72%|███████████████████▌       | 733/1014 [00:21<00:08, 34.55batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:07, 34.53batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.57batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.56batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.57batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 34.53batch/s] 75%|████████████████████▎      | 763/1014 [00:22<00:07, 34.53batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.53batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.51batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.50batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 34.46batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 34.49batch/s] 78%|█████████████████████      | 793/1014 [00:23<00:06, 34.41batch/s] 79%|█████████████████████▏     | 798/1014 [00:23<00:06, 34.41batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.37batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 34.34batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.36batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.42batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 34.43batch/s] 82%|██████████████████████     | 828/1014 [00:24<00:05, 34.46batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.46batch/s] 83%|██████████████████████▎    | 838/1014 [00:24<00:05, 34.51batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 34.49batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.49batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.49batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 34.45batch/s] 85%|██████████████████████▉    | 863/1014 [00:25<00:04, 34.48batch/s] 86%|███████████████████████    | 868/1014 [00:25<00:04, 34.50batch/s] 86%|███████████████████████▏   | 873/1014 [00:25<00:04, 34.54batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.56batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.56batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.57batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.58batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.56batch/s] 89%|████████████████████████   | 903/1014 [00:26<00:03, 34.59batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.57batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.58batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.55batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.58batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.62batch/s] 92%|████████████████████████▊  | 933/1014 [00:26<00:02, 34.60batch/s] 93%|████████████████████████▉  | 938/1014 [00:27<00:02, 34.55batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 34.56batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.52batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.52batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.55batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 34.53batch/s] 95%|█████████████████████████▊ | 968/1014 [00:28<00:01, 34.57batch/s] 96%|█████████████████████████▉ | 973/1014 [00:28<00:01, 34.55batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.54batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.57batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.58batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 34.58batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 34.59batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 34.60batch/s] 99%|█████████████████████████▊| 1008/1014 [00:29<00:00, 34.61batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.62batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.62batch/s]
Validation 32 -> LOSS = 0.25
Validation 32 -> BLEU = 96.12, 98.5/96.8/95.5/94.0 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 32
--> Best BLEU so far: 96.12 @ validation 31
Starting Epoch 33
Epoch 33 - update      15450 => loss:   0.110 (#OOM: 0)
Epoch 33 - update      15480 => loss:   0.213 (#OOM: 0)
Epoch 33 - update      15510 => loss:   0.080 (#OOM: 0)
Epoch 33 - update      15540 => loss:   0.105 (#OOM: 0)
Epoch 33 - update      15570 => loss:   0.114 (#OOM: 0)
Epoch 33 - update      15600 => loss:   0.090 (#OOM: 0)
Epoch 33 - update      15630 => loss:   0.143 (#OOM: 0)
Epoch 33 - update      15660 => loss:   0.109 (#OOM: 0)
Epoch 33 - update      15690 => loss:   0.163 (#OOM: 0)
Epoch 33 - update      15720 => loss:   0.082 (#OOM: 0)
Epoch 33 - update      15750 => loss:   0.148 (#OOM: 0)
Epoch 33 - update      15780 => loss:   0.140 (#OOM: 0)
Epoch 33 - update      15810 => loss:   0.093 (#OOM: 0)
Epoch 33 - update      15840 => loss:   0.166 (#OOM: 0)
Epoch 33 - update      15870 => loss:   0.100 (#OOM: 0)
Epoch 33 - update      15900 => loss:   0.122 (#OOM: 0)
--> Epoch 33 finished with mean loss 0.13433
--> Overhead/Training/Evaluation: 0.66/0.72/0.00 mins (total: 1.38 mins)   (668 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:01, 15.65batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 16.53batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 14.82batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 16.10batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 14.17batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 14.19batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 14.47batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.70batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.67batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.75batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.01batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.15batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.23batch/s]  1%|▎                            | 9/1014 [00:00<00:26, 38.37batch/s]  1%|▍                           | 14/1014 [00:00<00:25, 39.10batch/s]  2%|▌                           | 19/1014 [00:00<00:26, 38.02batch/s]  2%|▋                           | 24/1014 [00:00<00:25, 38.36batch/s]  3%|▊                           | 29/1014 [00:00<00:27, 36.27batch/s]  3%|▉                           | 34/1014 [00:00<00:26, 36.52batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.31batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.12batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 35.31batch/s]  5%|█▍                          | 54/1014 [00:01<00:27, 34.34batch/s]  6%|█▋                          | 59/1014 [00:01<00:27, 34.64batch/s]  6%|█▊                          | 64/1014 [00:01<00:27, 34.86batch/s]  7%|█▉                          | 69/1014 [00:02<00:27, 34.26batch/s]  7%|██                          | 74/1014 [00:02<00:27, 34.56batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 34.46batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 34.33batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 34.18batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.75batch/s] 10%|██▋                        | 101/1014 [00:02<00:26, 34.76batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 34.79batch/s] 11%|███                        | 113/1014 [00:03<00:25, 34.72batch/s] 12%|███▏                       | 119/1014 [00:03<00:25, 34.74batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.84batch/s] 13%|███▍                       | 131/1014 [00:03<00:25, 34.90batch/s] 14%|███▋                       | 137/1014 [00:03<00:25, 34.88batch/s] 14%|███▊                       | 143/1014 [00:04<00:24, 35.06batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 35.07batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.18batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 35.31batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 35.01batch/s] 17%|████▌                      | 173/1014 [00:04<00:24, 34.91batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 35.21batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.38batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 35.44batch/s] 19%|█████▏                     | 197/1014 [00:05<00:22, 35.55batch/s] 20%|█████▍                     | 203/1014 [00:05<00:22, 35.79batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.90batch/s] 21%|█████▋                     | 215/1014 [00:05<00:22, 36.14batch/s] 22%|█████▉                     | 221/1014 [00:06<00:21, 36.05batch/s] 22%|██████                     | 227/1014 [00:06<00:21, 36.14batch/s] 23%|██████▏                    | 233/1014 [00:06<00:21, 36.19batch/s] 24%|██████▎                    | 239/1014 [00:06<00:21, 36.12batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 36.15batch/s] 25%|██████▋                    | 251/1014 [00:06<00:21, 36.23batch/s] 25%|██████▊                    | 257/1014 [00:07<00:20, 36.15batch/s] 26%|███████                    | 263/1014 [00:07<00:20, 35.96batch/s] 27%|███████▏                   | 269/1014 [00:07<00:20, 35.77batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.81batch/s] 28%|███████▍                   | 281/1014 [00:07<00:20, 35.78batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.68batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 35.80batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.68batch/s] 30%|████████                   | 305/1014 [00:08<00:19, 35.85batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 35.80batch/s] 31%|████████▍                  | 317/1014 [00:08<00:19, 35.73batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.77batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.77batch/s] 33%|████████▉                  | 335/1014 [00:09<00:18, 35.84batch/s] 34%|█████████                  | 341/1014 [00:09<00:18, 35.84batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:18, 35.77batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:18, 35.86batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.65batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.70batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 35.62batch/s] 37%|██████████                 | 377/1014 [00:10<00:17, 35.57batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 35.66batch/s] 38%|██████████▎                | 389/1014 [00:10<00:17, 35.63batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.64batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 35.55batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 35.56batch/s] 41%|██████████▉                | 413/1014 [00:11<00:16, 35.59batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.65batch/s] 42%|███████████▎               | 425/1014 [00:11<00:16, 35.70batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 35.61batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 35.62batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 35.68batch/s] 44%|███████████▉               | 449/1014 [00:12<00:15, 35.65batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 35.70batch/s] 45%|████████████▎              | 461/1014 [00:12<00:15, 35.75batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 35.81batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 35.79batch/s] 47%|████████████▊              | 479/1014 [00:13<00:14, 35.79batch/s] 48%|████████████▉              | 485/1014 [00:13<00:14, 35.77batch/s] 48%|█████████████              | 491/1014 [00:13<00:14, 35.79batch/s] 49%|█████████████▏             | 497/1014 [00:13<00:14, 35.82batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.75batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.66batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:13, 35.66batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:13, 35.71batch/s] 52%|██████████████             | 527/1014 [00:14<00:13, 35.67batch/s] 53%|██████████████▏            | 533/1014 [00:14<00:13, 35.76batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.75batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.72batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:12, 35.65batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:12, 35.64batch/s] 56%|██████████████▉            | 563/1014 [00:15<00:12, 35.58batch/s] 56%|███████████████▏           | 569/1014 [00:15<00:12, 35.58batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.56batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 35.51batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 35.53batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 35.53batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.56batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 35.58batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 35.55batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 35.47batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 35.50batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.45batch/s] 63%|████████████████▉          | 635/1014 [00:17<00:10, 35.46batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 35.42batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 35.42batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 35.42batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.40batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 35.43batch/s] 66%|█████████████████▊         | 671/1014 [00:18<00:09, 35.45batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 35.49batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 35.49batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.45batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:08, 35.48batch/s] 69%|██████████████████▋        | 701/1014 [00:19<00:08, 35.46batch/s] 70%|██████████████████▊        | 707/1014 [00:19<00:08, 35.45batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 35.44batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.48batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.41batch/s] 72%|███████████████████▍       | 731/1014 [00:20<00:08, 35.32batch/s] 73%|███████████████████▌       | 737/1014 [00:20<00:07, 35.26batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 35.25batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.28batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.28batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 35.27batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:07, 35.25batch/s] 76%|████████████████████▌      | 773/1014 [00:21<00:06, 35.27batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.27batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.27batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 35.28batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 35.29batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:05, 35.28batch/s] 80%|█████████████████████▌     | 809/1014 [00:22<00:05, 35.26batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 35.28batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 35.31batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 35.32batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.37batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.39batch/s] 83%|██████████████████████▌    | 845/1014 [00:23<00:04, 35.32batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 35.33batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 35.31batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 35.28batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.26batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.29batch/s] 87%|███████████████████████▍   | 881/1014 [00:24<00:03, 35.26batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 35.28batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 35.24batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.26batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.29batch/s] 90%|████████████████████████▎  | 911/1014 [00:25<00:02, 35.27batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 35.23batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 35.20batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.22batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.24batch/s] 93%|█████████████████████████  | 941/1014 [00:26<00:02, 35.26batch/s] 93%|█████████████████████████▏ | 947/1014 [00:26<00:01, 35.25batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 35.23batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.27batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.27batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 35.29batch/s] 96%|██████████████████████████ | 977/1014 [00:27<00:01, 35.30batch/s] 97%|██████████████████████████▏| 983/1014 [00:27<00:00, 35.27batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.26batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 35.24batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 35.20batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 35.24batch/s]100%|█████████████████████████▉| 1013/1014 [00:28<00:00, 35.22batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.21batch/s]
Validation 33 -> LOSS = 0.25
Validation 33 -> BLEU = 96.21, 98.5/96.8/95.6/94.1 (BP=1.000, ratio=1.000, hyp_len=14377, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 32
--> Best BLEU so far: 96.21 @ validation 33
Starting Epoch 34
Epoch 34 - update      15930 => loss:   0.142 (#OOM: 0)
Epoch 34 - update      15960 => loss:   0.077 (#OOM: 0)
Epoch 34 - update      15990 => loss:   0.031 (#OOM: 0)
Epoch 34 - update      16020 => loss:   0.153 (#OOM: 0)
Epoch 34 - update      16050 => loss:   0.140 (#OOM: 0)
Epoch 34 - update      16080 => loss:   0.161 (#OOM: 0)
Epoch 34 - update      16110 => loss:   0.113 (#OOM: 0)
Epoch 34 - update      16140 => loss:   0.130 (#OOM: 0)
Epoch 34 - update      16170 => loss:   0.167 (#OOM: 0)
Epoch 34 - update      16200 => loss:   0.077 (#OOM: 0)
Epoch 34 - update      16230 => loss:   0.146 (#OOM: 0)
Epoch 34 - update      16260 => loss:   0.139 (#OOM: 0)
Epoch 34 - update      16290 => loss:   0.105 (#OOM: 0)
Epoch 34 - update      16320 => loss:   0.091 (#OOM: 0)
Epoch 34 - update      16350 => loss:   0.087 (#OOM: 0)
Epoch 34 - update      16380 => loss:   0.044 (#OOM: 0)
--> Epoch 34 finished with mean loss 0.12714
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (671 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.91batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.65batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.68batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.71batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.02batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 11.80batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.72batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.41batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.41batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.15batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.69batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.02batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.00batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:27, 36.70batch/s]  1%|▎                            | 9/1014 [00:00<00:25, 39.80batch/s]  1%|▍                           | 14/1014 [00:00<00:26, 37.81batch/s]  2%|▌                           | 19/1014 [00:00<00:26, 37.02batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.41batch/s]  3%|▊                           | 29/1014 [00:00<00:28, 34.31batch/s]  3%|▉                           | 34/1014 [00:00<00:28, 34.42batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.01batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.02batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 35.66batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 35.96batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 36.41batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 36.41batch/s]  7%|█▉                          | 69/1014 [00:01<00:25, 36.36batch/s]  7%|██                          | 74/1014 [00:02<00:26, 35.90batch/s]  8%|██▏                         | 79/1014 [00:02<00:25, 36.07batch/s]  8%|██▎                         | 84/1014 [00:02<00:26, 35.61batch/s]  9%|██▍                         | 89/1014 [00:02<00:25, 35.94batch/s]  9%|██▌                         | 94/1014 [00:02<00:25, 35.92batch/s] 10%|██▋                         | 99/1014 [00:02<00:25, 35.75batch/s] 10%|██▊                        | 104/1014 [00:02<00:25, 35.93batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 36.19batch/s] 11%|███                        | 114/1014 [00:03<00:24, 36.20batch/s] 12%|███▏                       | 119/1014 [00:03<00:24, 36.33batch/s] 12%|███▎                       | 124/1014 [00:03<00:24, 36.28batch/s] 13%|███▍                       | 129/1014 [00:03<00:24, 36.28batch/s] 13%|███▌                       | 134/1014 [00:03<00:24, 36.34batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 36.41batch/s] 14%|███▊                       | 144/1014 [00:03<00:23, 36.59batch/s] 15%|███▉                       | 149/1014 [00:04<00:23, 36.30batch/s] 15%|████                       | 154/1014 [00:04<00:23, 36.28batch/s] 16%|████▏                      | 159/1014 [00:04<00:23, 36.27batch/s] 16%|████▎                      | 164/1014 [00:04<00:23, 35.91batch/s] 17%|████▌                      | 169/1014 [00:04<00:23, 35.83batch/s] 17%|████▋                      | 174/1014 [00:04<00:23, 35.67batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 35.52batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.47batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 34.93batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.96batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.87batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 35.02batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.10batch/s] 21%|█████▋                     | 214/1014 [00:06<00:22, 35.00batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 34.99batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 35.06batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.96batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 35.05batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.86batch/s] 24%|██████▍                    | 244/1014 [00:06<00:22, 34.91batch/s] 25%|██████▋                    | 249/1014 [00:07<00:21, 34.96batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 35.06batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.11batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 35.09batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 35.16batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 35.09batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 35.05batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 35.01batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 34.98batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.06batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.13batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.23batch/s] 30%|████████▏                  | 309/1014 [00:08<00:19, 35.33batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.40batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 35.32batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.34batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.23batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.17batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.30batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:18, 35.38batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.34batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 35.36batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.31batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.20batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 35.23batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.21batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 35.20batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.25batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.21batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.11batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.13batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.18batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.23batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.22batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.22batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.22batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.12batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.01batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.05batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 35.12batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 35.09batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.12batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 35.07batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.96batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.93batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.90batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.97batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.94batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.86batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 34.93batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.90batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.90batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.86batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.92batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 34.93batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.93batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.90batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.92batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.93batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.94batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.92batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.95batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.91batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.88batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.88batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.94batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.87batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.80batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.80batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.85batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.84batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.83batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.81batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.86batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.83batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.83batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.80batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.82batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.73batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.73batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 34.74batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.74batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.76batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.80batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.75batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.80batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.85batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.85batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.78batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.80batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.84batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.89batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.85batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.85batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.85batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.83batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 34.83batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 34.87batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.89batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.92batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.92batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.94batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.94batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 34.96batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:07, 34.97batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 34.99batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.99batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.02batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.01batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.05batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.05batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.06batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 35.09batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.08batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.01batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.02batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 34.99batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 34.98batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.96batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.94batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.94batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.96batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.98batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 34.98batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.02batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.04batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 35.06batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 35.09batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.10batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.08batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.06batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.04batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.04batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 35.04batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.10batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.06batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.08batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.05batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 34.99batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.01batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.98batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.97batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.94batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.92batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.92batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 34.93batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:01, 34.97batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.97batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.96batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.95batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 34.91batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.95batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 34.95batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 34.97batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 34.97batch/s]
Validation 34 -> LOSS = 0.25
Validation 34 -> BLEU = 96.28, 98.5/96.9/95.6/94.2 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 32
--> Best BLEU so far: 96.28 @ validation 34
Starting Epoch 35
Epoch 35 - update      16410 => loss:   0.173 (#OOM: 0)
Epoch 35 - update      16440 => loss:   0.125 (#OOM: 0)
Epoch 35 - update      16470 => loss:   0.085 (#OOM: 0)
Epoch 35 - update      16500 => loss:   0.192 (#OOM: 0)
Epoch 35 - update      16530 => loss:   0.089 (#OOM: 0)
Epoch 35 - update      16560 => loss:   0.098 (#OOM: 0)
Epoch 35 - update      16590 => loss:   0.131 (#OOM: 0)
Epoch 35 - update      16620 => loss:   0.088 (#OOM: 0)
Epoch 35 - update      16650 => loss:   0.091 (#OOM: 0)
Epoch 35 - update      16680 => loss:   0.145 (#OOM: 0)
Epoch 35 - update      16710 => loss:   0.077 (#OOM: 0)
Epoch 35 - update      16740 => loss:   0.120 (#OOM: 0)
Epoch 35 - update      16770 => loss:   0.127 (#OOM: 0)
Epoch 35 - update      16800 => loss:   0.114 (#OOM: 0)
Epoch 35 - update      16830 => loss:   0.103 (#OOM: 0)
Epoch 35 - update      16860 => loss:   0.158 (#OOM: 0)
--> Epoch 35 finished with mean loss 0.12318
--> Overhead/Training/Evaluation: 0.61/0.72/0.00 mins (total: 1.33 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 15.03batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.77batch/s] 26%|████████▏                      | 9/34 [00:00<00:02, 11.43batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.11batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.50batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.45batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.74batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.82batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.50batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.88batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.23batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.15batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:25, 38.94batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.04batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 34.80batch/s]  2%|▍                           | 16/1014 [00:00<00:28, 34.86batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 33.67batch/s]  2%|▋                           | 24/1014 [00:00<00:30, 32.91batch/s]  3%|▊                           | 29/1014 [00:00<00:29, 33.69batch/s]  3%|▉                           | 34/1014 [00:01<00:29, 32.80batch/s]  4%|█                           | 39/1014 [00:01<00:30, 32.43batch/s]  4%|█▏                          | 44/1014 [00:01<00:29, 33.43batch/s]  5%|█▎                          | 49/1014 [00:01<00:28, 33.83batch/s]  5%|█▍                          | 54/1014 [00:01<00:28, 34.07batch/s]  6%|█▋                          | 59/1014 [00:01<00:27, 34.29batch/s]  6%|█▊                          | 64/1014 [00:01<00:27, 34.01batch/s]  7%|█▉                          | 69/1014 [00:02<00:28, 33.74batch/s]  7%|██                          | 74/1014 [00:02<00:27, 33.67batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 33.41batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 33.61batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 33.26batch/s]  9%|██▌                         | 94/1014 [00:02<00:27, 33.40batch/s] 10%|██▋                         | 99/1014 [00:02<00:27, 33.51batch/s] 10%|██▊                        | 104/1014 [00:03<00:27, 33.46batch/s] 11%|██▉                        | 109/1014 [00:03<00:27, 33.37batch/s] 11%|███                        | 114/1014 [00:03<00:26, 33.39batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 33.51batch/s] 12%|███▎                       | 124/1014 [00:03<00:26, 33.64batch/s] 13%|███▍                       | 129/1014 [00:03<00:26, 33.62batch/s] 13%|███▌                       | 134/1014 [00:03<00:26, 33.77batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 33.94batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.27batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 34.35batch/s] 15%|████                       | 154/1014 [00:04<00:25, 34.35batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.40batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.52batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.57batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.49batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 34.56batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 34.66batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 34.70batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.86batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.79batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.78batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.69batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.74batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 34.72batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.54batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.58batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.65batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.83batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.80batch/s] 25%|██████▋                    | 249/1014 [00:07<00:21, 34.90batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 34.93batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.92batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 35.02batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 35.03batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 35.05batch/s] 28%|███████▍                   | 279/1014 [00:07<00:21, 34.96batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 34.83batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 34.89batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.98batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.10batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.03batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 35.02batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.11batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 35.22batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.22batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.23batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.31batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.15batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 35.20batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.09batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 35.17batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.05batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.97batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.97batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.04batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 35.05batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.14batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.16batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.10batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.12batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.16batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.07batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.17batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.18batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.21batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.22batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.23batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.18batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 35.14batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 35.12batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.07batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 35.05batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.03batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.98batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.01batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.91batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.95batch/s] 48%|█████████████              | 489/1014 [00:13<00:15, 34.94batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 34.88batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.84batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.85batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.88batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.78batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 34.80batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.89batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.84batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.90batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.87batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.93batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.93batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.00batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:13, 35.00batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 35.00batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.03batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.07batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.06batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.04batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.05batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.01batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 35.03batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.02batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.03batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.10batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.12batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 35.09batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.03batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 35.04batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 35.06batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.11batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.10batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.10batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.09batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.13batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 35.06batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.01batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.98batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.99batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.01batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.06batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.09batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 35.08batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.12batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.13batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.09batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.14batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 35.10batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.10batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 35.13batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 35.11batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.09batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.11batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.13batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.13batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.10batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 35.09batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.06batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.02batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.97batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.96batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.97batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.02batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 35.06batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.08batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 34.98batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.00batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.01batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.02batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.04batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 35.06batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 35.02batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.05batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.03batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.04batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.02batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.01batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 35.00batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.98batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.00batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.01batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.05batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.04batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.01batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.94batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.94batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.94batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.97batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.95batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 34.91batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.88batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.89batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.85batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.85batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.84batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.82batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 34.83batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.85batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.88batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.87batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.83batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 34.84batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.86batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 34.87batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.87batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.87batch/s]
Validation 35 -> LOSS = 0.25
Validation 35 -> BLEU = 96.27, 98.5/96.9/95.6/94.2 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.28 @ validation 34
Starting Epoch 36
Epoch 36 - update      16890 => loss:   0.141 (#OOM: 0)
Epoch 36 - update      16920 => loss:   0.144 (#OOM: 0)
Epoch 36 - update      16950 => loss:   0.096 (#OOM: 0)
Epoch 36 - update      16980 => loss:   0.062 (#OOM: 0)
Epoch 36 - update      17010 => loss:   0.105 (#OOM: 0)
Epoch 36 - update      17040 => loss:   0.127 (#OOM: 0)
Epoch 36 - update      17070 => loss:   0.103 (#OOM: 0)
Epoch 36 - update      17100 => loss:   0.118 (#OOM: 0)
Epoch 36 - update      17130 => loss:   0.088 (#OOM: 0)
Epoch 36 - update      17160 => loss:   0.129 (#OOM: 0)
Epoch 36 - update      17190 => loss:   0.108 (#OOM: 0)
Epoch 36 - update      17220 => loss:   0.118 (#OOM: 0)
Epoch 36 - update      17250 => loss:   0.087 (#OOM: 0)
Epoch 36 - update      17280 => loss:   0.146 (#OOM: 0)
Epoch 36 - update      17310 => loss:   0.156 (#OOM: 0)
Epoch 36 - update      17340 => loss:   0.077 (#OOM: 0)
--> Epoch 36 finished with mean loss 0.12073
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (673 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 18.70batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 14.47batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 15.32batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 14.12batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.87batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.83batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.58batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.05batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.20batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.65batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.85batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.47batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.52batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.77batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.05batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:39, 25.52batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 35.31batch/s]  1%|▎                           | 13/1014 [00:00<00:30, 32.86batch/s]  2%|▍                           | 18/1014 [00:00<00:30, 32.28batch/s]  2%|▋                           | 23/1014 [00:00<00:31, 31.84batch/s]  3%|▊                           | 28/1014 [00:00<00:31, 30.83batch/s]  3%|▉                           | 33/1014 [00:01<00:30, 32.31batch/s]  4%|█                           | 38/1014 [00:01<00:30, 32.46batch/s]  4%|█▏                          | 43/1014 [00:01<00:28, 33.67batch/s]  5%|█▎                          | 48/1014 [00:01<00:29, 33.29batch/s]  5%|█▍                          | 53/1014 [00:01<00:28, 33.28batch/s]  6%|█▌                          | 58/1014 [00:01<00:28, 33.54batch/s]  6%|█▋                          | 63/1014 [00:01<00:28, 33.16batch/s]  7%|█▉                          | 68/1014 [00:02<00:28, 33.40batch/s]  7%|██                          | 73/1014 [00:02<00:27, 33.78batch/s]  8%|██▏                         | 78/1014 [00:02<00:27, 34.27batch/s]  8%|██▎                         | 83/1014 [00:02<00:27, 34.33batch/s]  9%|██▍                         | 88/1014 [00:02<00:27, 34.25batch/s]  9%|██▌                         | 93/1014 [00:02<00:27, 34.06batch/s] 10%|██▋                         | 98/1014 [00:02<00:26, 33.96batch/s] 10%|██▋                        | 103/1014 [00:03<00:26, 33.90batch/s] 11%|██▉                        | 108/1014 [00:03<00:26, 33.90batch/s] 11%|███                        | 113/1014 [00:03<00:26, 33.84batch/s] 12%|███▏                       | 118/1014 [00:03<00:26, 34.18batch/s] 12%|███▎                       | 123/1014 [00:03<00:25, 34.36batch/s] 13%|███▍                       | 128/1014 [00:03<00:25, 34.43batch/s] 13%|███▌                       | 133/1014 [00:03<00:25, 34.48batch/s] 14%|███▋                       | 138/1014 [00:03<00:25, 34.79batch/s] 14%|███▊                       | 143/1014 [00:04<00:24, 34.90batch/s] 15%|███▉                       | 148/1014 [00:04<00:24, 35.06batch/s] 15%|████                       | 153/1014 [00:04<00:24, 34.98batch/s] 16%|████▏                      | 158/1014 [00:04<00:24, 35.05batch/s] 16%|████▎                      | 163/1014 [00:04<00:24, 35.09batch/s] 17%|████▍                      | 168/1014 [00:04<00:24, 35.11batch/s] 17%|████▌                      | 173/1014 [00:04<00:23, 35.16batch/s] 18%|████▋                      | 178/1014 [00:05<00:23, 35.09batch/s] 18%|████▊                      | 183/1014 [00:05<00:23, 34.95batch/s] 19%|█████                      | 188/1014 [00:05<00:23, 35.06batch/s] 19%|█████▏                     | 193/1014 [00:05<00:23, 35.29batch/s] 20%|█████▎                     | 198/1014 [00:05<00:23, 35.24batch/s] 20%|█████▍                     | 203/1014 [00:05<00:22, 35.27batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 35.38batch/s] 21%|█████▋                     | 213/1014 [00:06<00:22, 35.13batch/s] 21%|█████▊                     | 218/1014 [00:06<00:22, 35.19batch/s] 22%|█████▉                     | 223/1014 [00:06<00:22, 35.20batch/s] 22%|██████                     | 228/1014 [00:06<00:22, 35.30batch/s] 23%|██████▏                    | 233/1014 [00:06<00:22, 35.37batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 35.44batch/s] 24%|██████▍                    | 243/1014 [00:06<00:21, 35.52batch/s] 24%|██████▌                    | 248/1014 [00:07<00:21, 35.38batch/s] 25%|██████▋                    | 253/1014 [00:07<00:21, 35.51batch/s] 25%|██████▊                    | 258/1014 [00:07<00:21, 35.45batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 35.30batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 35.28batch/s] 27%|███████▎                   | 273/1014 [00:07<00:21, 35.27batch/s] 27%|███████▍                   | 278/1014 [00:07<00:20, 35.36batch/s] 28%|███████▌                   | 283/1014 [00:07<00:20, 35.39batch/s] 28%|███████▋                   | 288/1014 [00:08<00:20, 35.14batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 35.03batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 35.10batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 35.18batch/s] 30%|████████▏                  | 308/1014 [00:08<00:20, 35.11batch/s] 31%|████████▎                  | 313/1014 [00:08<00:19, 35.20batch/s] 31%|████████▍                  | 318/1014 [00:09<00:19, 35.24batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.19batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 35.09batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 35.03batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 34.91batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:19, 34.91batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:19, 34.94batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:18, 34.96batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 34.96batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 34.98batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 35.01batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 34.82batch/s] 37%|██████████                 | 378/1014 [00:10<00:18, 34.68batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 34.61batch/s] 38%|██████████▎                | 388/1014 [00:11<00:18, 34.62batch/s] 39%|██████████▍                | 393/1014 [00:11<00:17, 34.72batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 34.78batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 34.83batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 34.86batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 34.85batch/s] 41%|███████████▏               | 418/1014 [00:11<00:17, 34.89batch/s] 42%|███████████▎               | 423/1014 [00:12<00:16, 34.92batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 34.90batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 34.96batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 34.90batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.94batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 34.88batch/s] 45%|████████████               | 453/1014 [00:12<00:16, 34.91batch/s] 45%|████████████▏              | 458/1014 [00:13<00:15, 34.96batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 34.96batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 34.90batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.96batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 35.00batch/s] 48%|████████████▊              | 483/1014 [00:13<00:15, 34.99batch/s] 48%|████████████▉              | 488/1014 [00:13<00:15, 35.03batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:14, 35.06batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 35.10batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.12batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.11batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 35.09batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:14, 35.08batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.11batch/s] 52%|██████████████             | 528/1014 [00:15<00:13, 35.09batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 35.05batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.12batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 35.13batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.11batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 35.11batch/s] 55%|██████████████▊            | 558/1014 [00:15<00:12, 35.14batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:12, 35.07batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 35.04batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 35.04batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.00batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 34.98batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 34.96batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:12, 35.00batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:11, 34.99batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 34.95batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.00batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 34.99batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 35.02batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 35.02batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:11, 35.00batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:10, 35.03batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.00batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 34.99batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 35.00batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.98batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 35.04batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:10, 35.03batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:09, 34.99batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.00batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 35.02batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 35.04batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.05batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:09, 35.08batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.11batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:08, 35.13batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 35.11batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 35.06batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.09batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 35.06batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.00batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:08, 34.99batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:07, 34.96batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.95batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.94batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.96batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 34.99batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 34.93batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.01batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.98batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.00batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.05batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.04batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.06batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.10batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 35.08batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 35.09batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.03batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 34.99batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 34.97batch/s] 83%|██████████████████████▍    | 841/1014 [00:24<00:04, 35.02batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 35.02batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.97batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.96batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 34.96batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 34.91batch/s] 86%|███████████████████████▎   | 877/1014 [00:25<00:03, 34.92batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.93batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.84batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.90batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 34.92batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 34.90batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.91batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.94batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.86batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 34.84batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 34.85batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 34.80batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.86batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.87batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 34.91batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 34.94batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 34.94batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.96batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.95batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 34.95batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 34.92batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 34.93batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 34.92batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.90batch/s]
Validation 36 -> LOSS = 0.25
Validation 36 -> BLEU = 96.35, 98.5/97.0/95.7/94.3 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.35 @ validation 36
Starting Epoch 37
Epoch 37 - update      17370 => loss:   0.110 (#OOM: 0)
Epoch 37 - update      17400 => loss:   0.102 (#OOM: 0)
Epoch 37 - update      17430 => loss:   0.099 (#OOM: 0)
Epoch 37 - update      17460 => loss:   0.201 (#OOM: 0)
Epoch 37 - update      17490 => loss:   0.069 (#OOM: 0)
Epoch 37 - update      17520 => loss:   0.135 (#OOM: 0)
Epoch 37 - update      17550 => loss:   0.102 (#OOM: 0)
Epoch 37 - update      17580 => loss:   0.154 (#OOM: 0)
Epoch 37 - update      17610 => loss:   0.068 (#OOM: 0)
Epoch 37 - update      17640 => loss:   0.158 (#OOM: 0)
Epoch 37 - update      17670 => loss:   0.112 (#OOM: 0)
Epoch 37 - update      17700 => loss:   0.185 (#OOM: 0)
Epoch 37 - update      17730 => loss:   0.071 (#OOM: 0)
Epoch 37 - update      17760 => loss:   0.121 (#OOM: 0)
Epoch 37 - update      17790 => loss:   0.119 (#OOM: 0)
Epoch 37 - update      17820 => loss:   0.096 (#OOM: 0)
--> Epoch 37 finished with mean loss 0.11714
--> Overhead/Training/Evaluation: 0.64/0.72/0.00 mins (total: 1.36 mins)   (672 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 14.55batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.05batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.59batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.68batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.45batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.82batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.05batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.39batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.58batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.69batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.03batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.01batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.28batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.28batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:33, 29.99batch/s]  1%|▏                            | 8/1014 [00:00<00:31, 32.33batch/s]  1%|▎                           | 12/1014 [00:00<00:30, 33.27batch/s]  2%|▍                           | 16/1014 [00:00<00:30, 32.91batch/s]  2%|▌                           | 21/1014 [00:00<00:28, 34.44batch/s]  3%|▋                           | 26/1014 [00:00<00:28, 34.24batch/s]  3%|▊                           | 31/1014 [00:00<00:28, 34.46batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 34.22batch/s]  4%|█▏                          | 41/1014 [00:01<00:28, 33.58batch/s]  5%|█▎                          | 46/1014 [00:01<00:29, 33.36batch/s]  5%|█▍                          | 51/1014 [00:01<00:29, 33.04batch/s]  6%|█▌                          | 56/1014 [00:01<00:28, 33.86batch/s]  6%|█▋                          | 61/1014 [00:01<00:27, 34.12batch/s]  7%|█▊                          | 66/1014 [00:01<00:27, 34.33batch/s]  7%|█▉                          | 71/1014 [00:02<00:27, 34.61batch/s]  7%|██                          | 76/1014 [00:02<00:27, 34.54batch/s]  8%|██▏                         | 81/1014 [00:02<00:26, 34.60batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 34.84batch/s]  9%|██▌                         | 91/1014 [00:02<00:26, 34.83batch/s]  9%|██▋                         | 96/1014 [00:02<00:26, 35.03batch/s] 10%|██▋                        | 101/1014 [00:02<00:25, 35.30batch/s] 10%|██▊                        | 106/1014 [00:02<00:25, 35.53batch/s] 11%|██▉                        | 111/1014 [00:03<00:25, 35.33batch/s] 11%|███                        | 116/1014 [00:03<00:25, 35.46batch/s] 12%|███▏                       | 121/1014 [00:03<00:25, 35.50batch/s] 12%|███▎                       | 126/1014 [00:03<00:25, 35.37batch/s] 13%|███▍                       | 131/1014 [00:03<00:25, 35.00batch/s] 13%|███▌                       | 136/1014 [00:03<00:24, 35.17batch/s] 14%|███▊                       | 141/1014 [00:04<00:24, 35.06batch/s] 14%|███▉                       | 146/1014 [00:04<00:24, 35.21batch/s] 15%|████                       | 151/1014 [00:04<00:24, 35.46batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 35.41batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 35.34batch/s] 16%|████▍                      | 166/1014 [00:04<00:24, 35.31batch/s] 17%|████▌                      | 171/1014 [00:04<00:23, 35.50batch/s] 17%|████▋                      | 176/1014 [00:04<00:23, 35.59batch/s] 18%|████▊                      | 181/1014 [00:05<00:23, 35.58batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 35.72batch/s] 19%|█████                      | 191/1014 [00:05<00:22, 35.79batch/s] 19%|█████▏                     | 196/1014 [00:05<00:22, 35.61batch/s] 20%|█████▎                     | 201/1014 [00:05<00:22, 35.51batch/s] 20%|█████▍                     | 206/1014 [00:05<00:22, 35.57batch/s] 21%|█████▌                     | 211/1014 [00:05<00:22, 35.70batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 35.78batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 35.97batch/s] 22%|██████                     | 226/1014 [00:06<00:21, 35.95batch/s] 23%|██████▏                    | 231/1014 [00:06<00:21, 36.02batch/s] 23%|██████▎                    | 236/1014 [00:06<00:21, 36.12batch/s] 24%|██████▍                    | 241/1014 [00:06<00:21, 36.17batch/s] 24%|██████▌                    | 246/1014 [00:06<00:21, 35.98batch/s] 25%|██████▋                    | 251/1014 [00:06<00:21, 36.09batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 36.04batch/s] 26%|██████▉                    | 261/1014 [00:07<00:20, 36.00batch/s] 26%|███████                    | 266/1014 [00:07<00:20, 36.06batch/s] 27%|███████▏                   | 271/1014 [00:07<00:20, 36.14batch/s] 27%|███████▎                   | 276/1014 [00:07<00:20, 36.15batch/s] 28%|███████▍                   | 281/1014 [00:07<00:20, 36.08batch/s] 28%|███████▌                   | 286/1014 [00:07<00:20, 36.14batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 36.11batch/s] 29%|███████▉                   | 296/1014 [00:08<00:19, 36.09batch/s] 30%|████████                   | 301/1014 [00:08<00:19, 36.08batch/s] 30%|████████▏                  | 306/1014 [00:08<00:19, 36.01batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 36.03batch/s] 31%|████████▍                  | 316/1014 [00:08<00:19, 36.13batch/s] 32%|████████▌                  | 321/1014 [00:08<00:19, 36.13batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 36.16batch/s] 33%|████████▊                  | 331/1014 [00:09<00:18, 36.25batch/s] 33%|████████▉                  | 336/1014 [00:09<00:18, 36.05batch/s] 34%|█████████                  | 341/1014 [00:09<00:18, 36.07batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:18, 36.16batch/s] 35%|█████████▎                 | 351/1014 [00:09<00:18, 36.21batch/s] 35%|█████████▍                 | 356/1014 [00:09<00:18, 36.25batch/s] 36%|█████████▌                 | 361/1014 [00:09<00:18, 36.19batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:17, 36.16batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:17, 36.22batch/s] 37%|██████████                 | 376/1014 [00:10<00:17, 36.18batch/s] 38%|██████████▏                | 381/1014 [00:10<00:17, 36.11batch/s] 38%|██████████▎                | 386/1014 [00:10<00:17, 36.13batch/s] 39%|██████████▍                | 391/1014 [00:10<00:17, 36.08batch/s] 39%|██████████▌                | 396/1014 [00:10<00:17, 36.10batch/s] 40%|██████████▋                | 401/1014 [00:11<00:16, 36.14batch/s] 40%|██████████▊                | 406/1014 [00:11<00:16, 36.04batch/s] 41%|██████████▉                | 411/1014 [00:11<00:16, 36.07batch/s] 41%|███████████                | 416/1014 [00:11<00:16, 36.04batch/s] 42%|███████████▏               | 421/1014 [00:11<00:16, 36.11batch/s] 42%|███████████▎               | 426/1014 [00:11<00:16, 36.11batch/s] 43%|███████████▍               | 431/1014 [00:11<00:16, 36.13batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 36.04batch/s] 43%|███████████▋               | 441/1014 [00:12<00:15, 36.09batch/s] 44%|███████████▉               | 446/1014 [00:12<00:15, 36.08batch/s] 44%|████████████               | 451/1014 [00:12<00:15, 36.11batch/s] 45%|████████████▏              | 456/1014 [00:12<00:15, 36.06batch/s] 45%|████████████▎              | 461/1014 [00:12<00:15, 36.11batch/s] 46%|████████████▍              | 466/1014 [00:12<00:15, 36.10batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 35.98batch/s] 47%|████████████▋              | 476/1014 [00:13<00:14, 35.94batch/s] 47%|████████████▊              | 481/1014 [00:13<00:14, 35.97batch/s] 48%|████████████▉              | 486/1014 [00:13<00:14, 35.93batch/s] 48%|█████████████              | 491/1014 [00:13<00:14, 35.93batch/s] 49%|█████████████▏             | 496/1014 [00:13<00:14, 35.94batch/s] 49%|█████████████▎             | 501/1014 [00:13<00:14, 35.95batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 35.98batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:13, 35.95batch/s] 51%|█████████████▋             | 516/1014 [00:14<00:13, 35.95batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:13, 35.99batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 36.03batch/s] 52%|██████████████▏            | 531/1014 [00:14<00:13, 36.04batch/s] 53%|██████████████▎            | 536/1014 [00:14<00:13, 35.98batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 35.96batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 35.99batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:12, 35.81batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:12, 35.81batch/s] 55%|██████████████▉            | 561/1014 [00:15<00:12, 35.84batch/s] 56%|███████████████            | 566/1014 [00:15<00:12, 35.86batch/s] 56%|███████████████▏           | 571/1014 [00:15<00:12, 35.89batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 35.91batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 35.91batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:11, 35.79batch/s] 58%|███████████████▋           | 591/1014 [00:16<00:11, 35.79batch/s] 59%|███████████████▊           | 596/1014 [00:16<00:11, 35.84batch/s] 59%|████████████████           | 601/1014 [00:16<00:11, 35.82batch/s] 60%|████████████████▏          | 606/1014 [00:16<00:11, 35.86batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 35.84batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 35.82batch/s] 61%|████████████████▌          | 621/1014 [00:17<00:10, 35.83batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:10, 35.88batch/s] 62%|████████████████▊          | 631/1014 [00:17<00:10, 35.84batch/s] 63%|████████████████▉          | 636/1014 [00:17<00:10, 35.83batch/s] 63%|█████████████████          | 641/1014 [00:17<00:10, 35.86batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 35.85batch/s] 64%|█████████████████▎         | 651/1014 [00:18<00:10, 35.75batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 35.78batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:09, 35.76batch/s] 66%|█████████████████▋         | 666/1014 [00:18<00:09, 35.71batch/s] 66%|█████████████████▊         | 671/1014 [00:18<00:09, 35.69batch/s] 67%|██████████████████         | 676/1014 [00:18<00:09, 35.63batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 35.66batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 35.64batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 35.58batch/s] 69%|██████████████████▌        | 696/1014 [00:19<00:08, 35.57batch/s] 69%|██████████████████▋        | 701/1014 [00:19<00:08, 35.61batch/s] 70%|██████████████████▊        | 706/1014 [00:19<00:08, 35.61batch/s] 70%|██████████████████▉        | 711/1014 [00:19<00:08, 35.61batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 35.58batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 35.51batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 35.49batch/s] 72%|███████████████████▍       | 731/1014 [00:20<00:07, 35.50batch/s] 73%|███████████████████▌       | 736/1014 [00:20<00:07, 35.52batch/s] 73%|███████████████████▋       | 741/1014 [00:20<00:07, 35.50batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 35.50batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 35.49batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 35.44batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 35.45batch/s] 76%|████████████████████▍      | 766/1014 [00:21<00:06, 35.44batch/s] 76%|████████████████████▌      | 771/1014 [00:21<00:06, 35.43batch/s] 77%|████████████████████▋      | 776/1014 [00:21<00:06, 35.41batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.40batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 35.39batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 35.39batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 35.38batch/s] 79%|█████████████████████▎     | 801/1014 [00:22<00:06, 35.37batch/s] 79%|█████████████████████▍     | 806/1014 [00:22<00:05, 35.30batch/s] 80%|█████████████████████▌     | 811/1014 [00:22<00:05, 35.30batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 35.30batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 35.29batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 35.29batch/s] 82%|██████████████████████▏    | 831/1014 [00:23<00:05, 35.23batch/s] 82%|██████████████████████▎    | 836/1014 [00:23<00:05, 35.27batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.30batch/s] 83%|██████████████████████▌    | 846/1014 [00:23<00:04, 35.29batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 35.27batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 35.28batch/s] 85%|██████████████████████▉    | 861/1014 [00:24<00:04, 35.28batch/s] 85%|███████████████████████    | 866/1014 [00:24<00:04, 35.26batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.26batch/s] 86%|███████████████████████▎   | 876/1014 [00:24<00:03, 35.25batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 35.24batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 35.20batch/s] 88%|███████████████████████▋   | 891/1014 [00:25<00:03, 35.20batch/s] 88%|███████████████████████▊   | 896/1014 [00:25<00:03, 35.23batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.24batch/s] 89%|████████████████████████   | 906/1014 [00:25<00:03, 35.22batch/s] 90%|████████████████████████▎  | 911/1014 [00:25<00:02, 35.23batch/s] 90%|████████████████████████▍  | 916/1014 [00:25<00:02, 35.25batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 35.23batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 35.22batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.20batch/s] 92%|████████████████████████▉  | 936/1014 [00:26<00:02, 35.24batch/s] 93%|█████████████████████████  | 941/1014 [00:26<00:02, 35.24batch/s] 93%|█████████████████████████▏ | 946/1014 [00:26<00:01, 35.25batch/s] 94%|█████████████████████████▎ | 951/1014 [00:26<00:01, 35.26batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 35.23batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.17batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 35.18batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 35.16batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 35.14batch/s] 97%|██████████████████████████ | 981/1014 [00:27<00:00, 35.14batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 35.13batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 35.15batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 35.17batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 35.18batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 35.19batch/s]100%|█████████████████████████▉| 1011/1014 [00:28<00:00, 35.19batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.21batch/s]
Validation 37 -> LOSS = 0.25
Validation 37 -> BLEU = 96.37, 98.5/97.0/95.8/94.4 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.37 @ validation 37
Starting Epoch 38
Epoch 38 - update      17850 => loss:   0.051 (#OOM: 0)
Epoch 38 - update      17880 => loss:   0.119 (#OOM: 0)
Epoch 38 - update      17910 => loss:   0.106 (#OOM: 0)
Epoch 38 - update      17940 => loss:   0.140 (#OOM: 0)
Epoch 38 - update      17970 => loss:   0.076 (#OOM: 0)
Epoch 38 - update      18000 => loss:   0.109 (#OOM: 0)
Epoch 38 - update      18030 => loss:   0.155 (#OOM: 0)
Epoch 38 - update      18060 => loss:   0.071 (#OOM: 0)
Epoch 38 - update      18090 => loss:   0.085 (#OOM: 0)
Epoch 38 - update      18120 => loss:   0.066 (#OOM: 0)
Epoch 38 - update      18150 => loss:   0.092 (#OOM: 0)
Epoch 38 - update      18180 => loss:   0.143 (#OOM: 0)
Epoch 38 - update      18210 => loss:   0.104 (#OOM: 0)
Epoch 38 - update      18240 => loss:   0.158 (#OOM: 0)
Epoch 38 - update      18270 => loss:   0.196 (#OOM: 0)
Epoch 38 - update      18300 => loss:   0.107 (#OOM: 0)
--> Epoch 38 finished with mean loss 0.11387
--> Overhead/Training/Evaluation: 0.66/0.73/0.00 mins (total: 1.39 mins)   (665 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.95batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 14.26batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.53batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.30batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.79batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 13.59batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.51batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 14.47batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:00, 14.02batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 14.01batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.28batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 14.48batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 14.46batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.96batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:31, 32.56batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.42batch/s]  1%|▎                           | 12/1014 [00:00<00:30, 33.38batch/s]  2%|▍                           | 17/1014 [00:00<00:28, 34.80batch/s]  2%|▌                           | 22/1014 [00:00<00:27, 35.91batch/s]  3%|▋                           | 27/1014 [00:00<00:27, 35.86batch/s]  3%|▉                           | 32/1014 [00:00<00:27, 36.00batch/s]  4%|█                           | 37/1014 [00:01<00:27, 35.96batch/s]  4%|█▏                          | 42/1014 [00:01<00:27, 35.98batch/s]  5%|█▎                          | 47/1014 [00:01<00:27, 35.55batch/s]  5%|█▍                          | 52/1014 [00:01<00:27, 35.56batch/s]  6%|█▌                          | 57/1014 [00:01<00:26, 35.77batch/s]  6%|█▋                          | 62/1014 [00:01<00:27, 34.98batch/s]  7%|█▊                          | 67/1014 [00:01<00:27, 34.91batch/s]  7%|█▉                          | 72/1014 [00:02<00:27, 34.23batch/s]  8%|██▏                         | 77/1014 [00:02<00:27, 34.40batch/s]  8%|██▎                         | 82/1014 [00:02<00:27, 34.39batch/s]  9%|██▍                         | 87/1014 [00:02<00:26, 34.67batch/s]  9%|██▌                         | 92/1014 [00:02<00:26, 34.39batch/s] 10%|██▋                         | 97/1014 [00:02<00:26, 34.34batch/s] 10%|██▋                        | 102/1014 [00:02<00:26, 34.48batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 34.42batch/s] 11%|██▉                        | 112/1014 [00:03<00:26, 34.63batch/s] 12%|███                        | 117/1014 [00:03<00:25, 34.52batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 34.60batch/s] 13%|███▍                       | 127/1014 [00:03<00:25, 34.89batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 34.97batch/s] 14%|███▋                       | 137/1014 [00:03<00:24, 35.15batch/s] 14%|███▊                       | 142/1014 [00:04<00:25, 34.82batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 34.76batch/s] 15%|████                       | 152/1014 [00:04<00:24, 34.91batch/s] 15%|████▏                      | 157/1014 [00:04<00:24, 34.82batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.79batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 35.00batch/s] 17%|████▌                      | 172/1014 [00:04<00:24, 35.00batch/s] 17%|████▋                      | 177/1014 [00:05<00:23, 35.08batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 35.17batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 35.03batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 34.99batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 34.98batch/s] 20%|█████▍                     | 202/1014 [00:05<00:23, 34.95batch/s] 20%|█████▌                     | 207/1014 [00:05<00:23, 34.95batch/s] 21%|█████▋                     | 212/1014 [00:06<00:22, 34.91batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 34.89batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 34.98batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 34.65batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 34.76batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 34.88batch/s] 24%|██████▍                    | 242/1014 [00:06<00:22, 34.94batch/s] 24%|██████▌                    | 247/1014 [00:07<00:22, 34.86batch/s] 25%|██████▋                    | 252/1014 [00:07<00:22, 34.63batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 34.55batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 34.45batch/s] 26%|███████                    | 267/1014 [00:07<00:21, 34.48batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 34.56batch/s] 27%|███████▍                   | 277/1014 [00:08<00:21, 34.57batch/s] 28%|███████▌                   | 282/1014 [00:08<00:21, 34.65batch/s] 28%|███████▋                   | 287/1014 [00:08<00:21, 34.55batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 34.51batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 34.51batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 34.61batch/s] 30%|████████▏                  | 307/1014 [00:08<00:20, 34.62batch/s] 31%|████████▎                  | 312/1014 [00:09<00:20, 34.63batch/s] 31%|████████▍                  | 317/1014 [00:09<00:20, 34.62batch/s] 32%|████████▌                  | 322/1014 [00:09<00:20, 34.57batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 34.55batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 34.52batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 34.57batch/s] 34%|█████████                  | 342/1014 [00:09<00:19, 34.51batch/s] 34%|█████████▏                 | 347/1014 [00:10<00:19, 34.57batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:19, 34.68batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 34.72batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 34.77batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.80batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 34.80batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 34.79batch/s] 38%|██████████▏                | 382/1014 [00:10<00:18, 34.83batch/s] 38%|██████████▎                | 387/1014 [00:11<00:17, 34.85batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 34.82batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 34.76batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 34.74batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.84batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 34.94batch/s] 41%|███████████                | 417/1014 [00:11<00:17, 34.96batch/s] 42%|███████████▏               | 422/1014 [00:12<00:16, 34.91batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 34.99batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 34.99batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 35.00batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 35.03batch/s] 44%|███████████▉               | 447/1014 [00:12<00:16, 35.04batch/s] 45%|████████████               | 452/1014 [00:12<00:16, 35.04batch/s] 45%|████████████▏              | 457/1014 [00:13<00:15, 34.98batch/s] 46%|████████████▎              | 462/1014 [00:13<00:15, 34.97batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 35.00batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.00batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 35.00batch/s] 48%|████████████▊              | 482/1014 [00:13<00:15, 34.96batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 35.10batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 35.11batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.16batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 35.15batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 35.16batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:14, 35.21batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.22batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 35.16batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 35.22batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 35.23batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.29batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.27batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.27batch/s] 56%|███████████████            | 566/1014 [00:16<00:12, 35.22batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 35.22batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.21batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.18batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 35.17batch/s] 59%|███████████████▊           | 596/1014 [00:16<00:11, 35.13batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 35.14batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.06batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.03batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.07batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:11, 35.10batch/s] 62%|████████████████▊          | 632/1014 [00:18<00:10, 35.05batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.00batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.02batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.08batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 35.03batch/s] 65%|█████████████████▋         | 662/1014 [00:18<00:10, 34.91batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:09, 34.88batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.90batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.91batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 34.94batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 34.94batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:09, 34.96batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.95batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.95batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 34.98batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 34.99batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.00batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.03batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 35.00batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 35.05batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 35.01batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.00batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.02batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.04batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 35.06batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 35.06batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 35.05batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.92batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 34.81batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:05, 34.70batch/s] 80%|█████████████████████▌     | 812/1014 [00:23<00:05, 34.51batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.50batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.50batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 34.51batch/s] 82%|██████████████████████▎    | 836/1014 [00:24<00:05, 34.52batch/s] 83%|██████████████████████▍    | 842/1014 [00:24<00:04, 34.50batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.48batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.50batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.50batch/s] 85%|███████████████████████    | 866/1014 [00:25<00:04, 34.47batch/s] 86%|███████████████████████▏   | 872/1014 [00:25<00:04, 34.38batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.32batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.24batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.26batch/s] 88%|███████████████████████▊   | 896/1014 [00:26<00:03, 34.26batch/s] 89%|████████████████████████   | 902/1014 [00:26<00:03, 34.29batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.30batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.30batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.30batch/s] 91%|████████████████████████▋  | 926/1014 [00:27<00:02, 34.30batch/s] 92%|████████████████████████▊  | 932/1014 [00:27<00:02, 34.31batch/s] 93%|████████████████████████▉  | 938/1014 [00:27<00:02, 34.25batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.12batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.14batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 34.15batch/s] 95%|█████████████████████████▌ | 962/1014 [00:28<00:01, 34.14batch/s] 95%|█████████████████████████▊ | 968/1014 [00:28<00:01, 34.20batch/s] 96%|█████████████████████████▉ | 974/1014 [00:28<00:01, 34.15batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.13batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 34.09batch/s] 98%|██████████████████████████▍| 992/1014 [00:29<00:00, 34.08batch/s] 98%|██████████████████████████▌| 998/1014 [00:29<00:00, 34.10batch/s] 99%|█████████████████████████▋| 1004/1014 [00:29<00:00, 34.13batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.15batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.13batch/s]
Validation 38 -> LOSS = 0.25
Validation 38 -> BLEU = 96.28, 98.5/96.9/95.6/94.2 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.37 @ validation 37
Starting Epoch 39
Epoch 39 - update      18330 => loss:   0.116 (#OOM: 0)
Epoch 39 - update      18360 => loss:   0.079 (#OOM: 0)
Epoch 39 - update      18390 => loss:   0.131 (#OOM: 0)
Epoch 39 - update      18420 => loss:   0.078 (#OOM: 0)
Epoch 39 - update      18450 => loss:   0.072 (#OOM: 0)
Epoch 39 - update      18480 => loss:   0.073 (#OOM: 0)
Epoch 39 - update      18510 => loss:   0.096 (#OOM: 0)
Epoch 39 - update      18540 => loss:   0.116 (#OOM: 0)
Epoch 39 - update      18570 => loss:   0.075 (#OOM: 0)
Epoch 39 - update      18600 => loss:   0.065 (#OOM: 0)
Epoch 39 - update      18630 => loss:   0.159 (#OOM: 0)
Epoch 39 - update      18660 => loss:   0.135 (#OOM: 0)
Epoch 39 - update      18690 => loss:   0.112 (#OOM: 0)
Epoch 39 - update      18720 => loss:   0.099 (#OOM: 0)
Epoch 39 - update      18750 => loss:   0.134 (#OOM: 0)
Epoch 39 - update      18780 => loss:   0.073 (#OOM: 0)
--> Epoch 39 finished with mean loss 0.11373
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (672 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.70batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 14.02batch/s] 15%|████▌                          | 5/34 [00:00<00:01, 15.13batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 16.92batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 16.06batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 14.88batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 14.64batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.31batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.58batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.14batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.02batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 33.90batch/s]  1%|▎                            | 9/1014 [00:00<00:29, 33.79batch/s]  1%|▍                           | 14/1014 [00:00<00:26, 38.10batch/s]  2%|▌                           | 19/1014 [00:00<00:29, 33.97batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.66batch/s]  3%|▊                           | 29/1014 [00:00<00:27, 35.22batch/s]  3%|▉                           | 34/1014 [00:00<00:27, 36.10batch/s]  4%|█                           | 39/1014 [00:01<00:26, 36.55batch/s]  4%|█▏                          | 44/1014 [00:01<00:26, 36.30batch/s]  5%|█▎                          | 49/1014 [00:01<00:26, 36.84batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 36.04batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 36.23batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 35.85batch/s]  7%|█▉                          | 69/1014 [00:01<00:26, 35.58batch/s]  7%|██                          | 74/1014 [00:02<00:26, 35.44batch/s]  8%|██▏                         | 79/1014 [00:02<00:26, 35.56batch/s]  8%|██▎                         | 84/1014 [00:02<00:25, 36.10batch/s]  9%|██▍                         | 89/1014 [00:02<00:25, 35.96batch/s]  9%|██▌                         | 94/1014 [00:02<00:25, 35.93batch/s] 10%|██▋                         | 99/1014 [00:02<00:25, 35.78batch/s] 10%|██▊                        | 104/1014 [00:02<00:25, 36.01batch/s] 11%|██▉                        | 109/1014 [00:03<00:24, 36.21batch/s] 11%|███                        | 114/1014 [00:03<00:24, 36.30batch/s] 12%|███▏                       | 119/1014 [00:03<00:24, 36.13batch/s] 12%|███▎                       | 124/1014 [00:03<00:24, 35.76batch/s] 13%|███▍                       | 129/1014 [00:03<00:24, 35.99batch/s] 13%|███▌                       | 134/1014 [00:03<00:24, 35.98batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 35.65batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 35.61batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 35.67batch/s] 15%|████                       | 154/1014 [00:04<00:24, 35.78batch/s] 16%|████▏                      | 159/1014 [00:04<00:23, 35.85batch/s] 16%|████▎                      | 164/1014 [00:04<00:23, 35.93batch/s] 17%|████▌                      | 169/1014 [00:04<00:23, 35.93batch/s] 17%|████▋                      | 174/1014 [00:04<00:23, 36.09batch/s] 18%|████▊                      | 179/1014 [00:04<00:23, 36.06batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 36.03batch/s] 19%|█████                      | 189/1014 [00:05<00:22, 35.91batch/s] 19%|█████▏                     | 194/1014 [00:05<00:22, 35.85batch/s] 20%|█████▎                     | 199/1014 [00:05<00:22, 35.84batch/s] 20%|█████▍                     | 204/1014 [00:05<00:22, 35.79batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.84batch/s] 21%|█████▋                     | 214/1014 [00:05<00:22, 35.97batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 36.00batch/s] 22%|█████▉                     | 224/1014 [00:06<00:21, 36.03batch/s] 23%|██████                     | 229/1014 [00:06<00:21, 36.12batch/s] 23%|██████▏                    | 234/1014 [00:06<00:21, 36.13batch/s] 24%|██████▎                    | 239/1014 [00:06<00:21, 35.91batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.85batch/s] 25%|██████▋                    | 249/1014 [00:06<00:21, 35.96batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 36.06batch/s] 26%|██████▉                    | 259/1014 [00:07<00:20, 35.97batch/s] 26%|███████                    | 264/1014 [00:07<00:20, 35.86batch/s] 27%|███████▏                   | 269/1014 [00:07<00:20, 35.84batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.92batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 35.86batch/s] 28%|███████▌                   | 284/1014 [00:07<00:20, 35.83batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 35.78batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.78batch/s] 29%|███████▉                   | 299/1014 [00:08<00:19, 35.80batch/s] 30%|████████                   | 304/1014 [00:08<00:19, 35.66batch/s] 30%|████████▏                  | 309/1014 [00:08<00:19, 35.62batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.59batch/s] 31%|████████▍                  | 319/1014 [00:08<00:19, 35.50batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.53batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.37batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.45batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.50batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:18, 35.32batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.30batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 35.29batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.24batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.24batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 35.14batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.17batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 35.15batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.14batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.05batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 34.89batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.94batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.91batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.91batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.00batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.90batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 34.91batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.85batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.74batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.74batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.73batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.71batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.71batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 34.71batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.66batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.59batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.57batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.55batch/s] 48%|████████████▉              | 484/1014 [00:14<00:15, 34.45batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.34batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:15, 34.42batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.47batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.47batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.51batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.51batch/s] 51%|█████████████▊             | 519/1014 [00:15<00:14, 34.53batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.50batch/s] 52%|██████████████             | 529/1014 [00:15<00:14, 34.56batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.60batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.63batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.66batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.59batch/s] 55%|██████████████▊            | 554/1014 [00:16<00:13, 34.62batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.62batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.65batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.69batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.71batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.68batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.68batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.71batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.68batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.62batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.61batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.64batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.63batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.61batch/s] 62%|████████████████▌          | 624/1014 [00:18<00:11, 34.62batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.62batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.61batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.62batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.60batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 34.56batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.59batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 34.57batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.57batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.53batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.54batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.55batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.54batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.59batch/s] 68%|██████████████████▍        | 694/1014 [00:20<00:09, 34.59batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.57batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.58batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.61batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.63batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.61batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.68batch/s] 72%|███████████████████▍       | 729/1014 [00:21<00:08, 34.70batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 34.71batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.72batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.74batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.71batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.72batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.75batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 34.75batch/s] 76%|████████████████████▍      | 769/1014 [00:22<00:07, 34.75batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 34.76batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.75batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.76batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.73batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.75batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.76batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.68batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.67batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.64batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 34.63batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.64batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 34.62batch/s] 82%|██████████████████████▏    | 834/1014 [00:24<00:05, 34.63batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.62batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.65batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.67batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.63batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.67batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 34.67batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.64batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.63batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.66batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.68batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.72batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 34.76batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.76batch/s] 89%|████████████████████████   | 904/1014 [00:26<00:03, 34.77batch/s] 90%|████████████████████████▏  | 909/1014 [00:26<00:03, 34.76batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.71batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.75batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.77batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.77batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.79batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 34.79batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.74batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.75batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.76batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.78batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.79batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.76batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 34.80batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.82batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.85batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.86batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.87batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 34.82batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.84batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 34.84batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.86batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.86batch/s]
Validation 39 -> LOSS = 0.25
Validation 39 -> BLEU = 96.44, 98.6/97.0/95.8/94.5 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.44 @ validation 39
Starting Epoch 40
Epoch 40 - update      18810 => loss:   0.087 (#OOM: 0)
Epoch 40 - update      18840 => loss:   0.083 (#OOM: 0)
Epoch 40 - update      18870 => loss:   0.087 (#OOM: 0)
Epoch 40 - update      18900 => loss:   0.078 (#OOM: 0)
Epoch 40 - update      18930 => loss:   0.062 (#OOM: 0)
Epoch 40 - update      18960 => loss:   0.169 (#OOM: 0)
Epoch 40 - update      18990 => loss:   0.086 (#OOM: 0)
Epoch 40 - update      19020 => loss:   0.117 (#OOM: 0)
Epoch 40 - update      19050 => loss:   0.081 (#OOM: 0)
Epoch 40 - update      19080 => loss:   0.139 (#OOM: 0)
Epoch 40 - update      19110 => loss:   0.117 (#OOM: 0)
Epoch 40 - update      19140 => loss:   0.081 (#OOM: 0)
Epoch 40 - update      19170 => loss:   0.113 (#OOM: 0)
Epoch 40 - update      19200 => loss:   0.094 (#OOM: 0)
Epoch 40 - update      19230 => loss:   0.237 (#OOM: 0)
Epoch 40 - update      19260 => loss:   0.187 (#OOM: 0)
--> Epoch 40 finished with mean loss 0.11229
--> Overhead/Training/Evaluation: 0.58/0.71/0.00 mins (total: 1.30 mins)   (676 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.50batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 10.22batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 10.83batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.79batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 10.34batch/s] 35%|██████████▌                   | 12/34 [00:01<00:02, 10.23batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 10.76batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 10.84batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 11.40batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 11.86batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.28batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.84batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.68batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.23batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.34batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.34batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.66batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 35.75batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 34.64batch/s]  2%|▍                           | 16/1014 [00:00<00:31, 31.83batch/s]  2%|▌                           | 20/1014 [00:00<00:32, 30.74batch/s]  2%|▋                           | 24/1014 [00:00<00:31, 31.67batch/s]  3%|▊                           | 29/1014 [00:00<00:29, 33.28batch/s]  3%|▉                           | 34/1014 [00:01<00:28, 33.82batch/s]  4%|█                           | 39/1014 [00:01<00:29, 33.34batch/s]  4%|█▏                          | 44/1014 [00:01<00:28, 34.34batch/s]  5%|█▎                          | 49/1014 [00:01<00:28, 34.10batch/s]  5%|█▍                          | 54/1014 [00:01<00:28, 33.58batch/s]  6%|█▋                          | 59/1014 [00:01<00:28, 33.42batch/s]  6%|█▊                          | 64/1014 [00:01<00:28, 33.86batch/s]  7%|█▉                          | 69/1014 [00:02<00:27, 34.12batch/s]  7%|██                          | 74/1014 [00:02<00:27, 34.10batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 33.86batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 34.20batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 34.25batch/s]  9%|██▌                         | 94/1014 [00:02<00:26, 34.57batch/s] 10%|██▋                         | 99/1014 [00:02<00:26, 34.70batch/s] 10%|██▊                        | 104/1014 [00:03<00:26, 34.61batch/s] 11%|██▉                        | 109/1014 [00:03<00:26, 34.60batch/s] 11%|███                        | 114/1014 [00:03<00:26, 34.22batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 34.10batch/s] 12%|███▎                       | 124/1014 [00:03<00:26, 34.04batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.12batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.20batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 34.22batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.25batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 34.18batch/s] 15%|████                       | 154/1014 [00:04<00:25, 34.21batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.22batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.27batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.32batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.56batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 34.64batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 34.79batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 35.02batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 35.00batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 35.19batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 35.11batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.17batch/s] 21%|█████▋                     | 214/1014 [00:06<00:22, 35.23batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 35.32batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 35.20batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 35.23batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 35.41batch/s] 24%|██████▎                    | 239/1014 [00:06<00:21, 35.40batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.27batch/s] 25%|██████▋                    | 249/1014 [00:07<00:21, 35.24batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 35.25batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.24batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 35.31batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 35.25batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.25batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 35.07batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 35.15batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 34.92batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.95batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.00batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.04batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 35.06batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.07batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 35.05batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.00batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.04batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.04batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.00batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 35.02batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:19, 34.94batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 34.97batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.05batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.09batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 35.15batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.20batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 35.25batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.22batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.20batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.20batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.15batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.18batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.16batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.09batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.05batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.02batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.94batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.99batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.02batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 35.00batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 35.06batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.09batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 35.14batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.13batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.94batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.94batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.95batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.90batch/s] 48%|█████████████              | 489/1014 [00:13<00:15, 34.95batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 34.97batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.97batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.94batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.96batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.98batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 35.01batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.01batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.89batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.93batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.95batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.00batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.02batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.94batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:13, 34.99batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 35.06batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.95batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.87batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.90batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.94batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.94batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:12, 34.95batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.90batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.89batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.89batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.84batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.80batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.79batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.77batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.77batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.80batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.82batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 34.80batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.78batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.81batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.80batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.76batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.76batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.74batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.74batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.70batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.73batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.74batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.77batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.79batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.81batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.77batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.80batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 34.80batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 34.81batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.83batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.77batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.76batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.71batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.73batch/s] 75%|████████████████████▎      | 764/1014 [00:22<00:07, 34.72batch/s] 76%|████████████████████▍      | 769/1014 [00:22<00:07, 34.69batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 34.66batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.70batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.73batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.74batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.68batch/s] 79%|█████████████████████▎     | 799/1014 [00:23<00:06, 34.69batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.73batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.77batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.75batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 34.76batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.76batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 34.76batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 34.79batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.79batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.81batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.84batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.83batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.82batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 34.81batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 34.78batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.80batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.80batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.79batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.77batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 34.75batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.72batch/s] 89%|████████████████████████   | 904/1014 [00:26<00:03, 34.69batch/s] 90%|████████████████████████▏  | 909/1014 [00:26<00:03, 34.73batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.72batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.71batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.70batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.73batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.67batch/s] 93%|█████████████████████████  | 939/1014 [00:27<00:02, 34.63batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.65batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.68batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.71batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.72batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.73batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.76batch/s] 96%|█████████████████████████▉ | 974/1014 [00:28<00:01, 34.77batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.70batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.70batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.71batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.71batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 34.73batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.77batch/s]100%|█████████████████████████▊| 1009/1014 [00:29<00:00, 34.75batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.75batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.75batch/s]
Validation 40 -> LOSS = 0.25
Validation 40 -> BLEU = 96.35, 98.5/97.0/95.7/94.3 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.44 @ validation 39
Starting Epoch 41
Epoch 41 - update      19290 => loss:   0.112 (#OOM: 0)
Epoch 41 - update      19320 => loss:   0.082 (#OOM: 0)
Epoch 41 - update      19350 => loss:   0.147 (#OOM: 0)
Epoch 41 - update      19380 => loss:   0.087 (#OOM: 0)
Epoch 41 - update      19410 => loss:   0.097 (#OOM: 0)
Epoch 41 - update      19440 => loss:   0.125 (#OOM: 0)
Epoch 41 - update      19470 => loss:   0.063 (#OOM: 0)
Epoch 41 - update      19500 => loss:   0.122 (#OOM: 0)
Epoch 41 - update      19530 => loss:   0.127 (#OOM: 0)
Epoch 41 - update      19560 => loss:   0.113 (#OOM: 0)
Epoch 41 - update      19590 => loss:   0.134 (#OOM: 0)
Epoch 41 - update      19620 => loss:   0.096 (#OOM: 0)
Epoch 41 - update      19650 => loss:   0.148 (#OOM: 0)
Epoch 41 - update      19680 => loss:   0.105 (#OOM: 0)
Epoch 41 - update      19710 => loss:   0.054 (#OOM: 0)
Epoch 41 - update      19740 => loss:   0.148 (#OOM: 0)
--> Epoch 41 finished with mean loss 0.10598
--> Overhead/Training/Evaluation: 0.63/0.71/0.00 mins (total: 1.34 mins)   (677 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.28batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 14.50batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 13.48batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.73batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.28batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.29batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.95batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.96batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.97batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.88batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.04batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.28batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.28batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:27, 36.45batch/s]  1%|▏                            | 8/1014 [00:00<00:34, 28.77batch/s]  1%|▎                           | 12/1014 [00:00<00:33, 30.13batch/s]  2%|▍                           | 17/1014 [00:00<00:30, 33.16batch/s]  2%|▌                           | 22/1014 [00:00<00:28, 34.61batch/s]  3%|▋                           | 27/1014 [00:00<00:29, 33.65batch/s]  3%|▉                           | 32/1014 [00:00<00:29, 32.77batch/s]  4%|█                           | 37/1014 [00:01<00:29, 33.21batch/s]  4%|█▏                          | 42/1014 [00:01<00:29, 32.85batch/s]  5%|█▎                          | 47/1014 [00:01<00:30, 32.04batch/s]  5%|█▍                          | 52/1014 [00:01<00:29, 32.20batch/s]  6%|█▌                          | 57/1014 [00:01<00:29, 32.44batch/s]  6%|█▋                          | 62/1014 [00:01<00:28, 32.88batch/s]  7%|█▊                          | 67/1014 [00:02<00:28, 33.03batch/s]  7%|█▉                          | 72/1014 [00:02<00:28, 33.33batch/s]  8%|██▏                         | 77/1014 [00:02<00:27, 33.89batch/s]  8%|██▎                         | 82/1014 [00:02<00:27, 34.24batch/s]  9%|██▍                         | 87/1014 [00:02<00:27, 34.27batch/s]  9%|██▌                         | 92/1014 [00:02<00:26, 34.68batch/s] 10%|██▋                         | 97/1014 [00:02<00:26, 34.48batch/s] 10%|██▋                        | 102/1014 [00:02<00:26, 34.28batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 34.60batch/s] 11%|██▉                        | 112/1014 [00:03<00:25, 34.86batch/s] 12%|███                        | 117/1014 [00:03<00:25, 34.90batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 34.88batch/s] 13%|███▍                       | 127/1014 [00:03<00:25, 35.03batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 35.03batch/s] 14%|███▋                       | 137/1014 [00:03<00:24, 35.14batch/s] 14%|███▊                       | 142/1014 [00:04<00:24, 34.93batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 34.97batch/s] 15%|████                       | 152/1014 [00:04<00:24, 35.00batch/s] 15%|████▏                      | 157/1014 [00:04<00:24, 34.93batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.91batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.76batch/s] 17%|████▌                      | 172/1014 [00:04<00:24, 34.76batch/s] 17%|████▋                      | 177/1014 [00:05<00:23, 34.94batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 35.01batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 35.07batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 34.99batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 34.92batch/s] 20%|█████▍                     | 202/1014 [00:05<00:23, 34.72batch/s] 20%|█████▌                     | 207/1014 [00:05<00:23, 34.73batch/s] 21%|█████▋                     | 212/1014 [00:06<00:22, 34.89batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 34.80batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 34.89batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 35.00batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 35.10batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 35.12batch/s] 24%|██████▍                    | 242/1014 [00:06<00:22, 35.06batch/s] 24%|██████▌                    | 247/1014 [00:07<00:21, 35.00batch/s] 25%|██████▋                    | 252/1014 [00:07<00:21, 34.99batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 34.93batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 34.92batch/s] 26%|███████                    | 267/1014 [00:07<00:21, 35.04batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 35.08batch/s] 27%|███████▍                   | 277/1014 [00:07<00:21, 34.87batch/s] 28%|███████▌                   | 282/1014 [00:08<00:21, 34.73batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 34.85batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 34.85batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 34.84batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 34.97batch/s] 30%|████████▏                  | 307/1014 [00:08<00:20, 35.00batch/s] 31%|████████▎                  | 312/1014 [00:08<00:20, 34.95batch/s] 31%|████████▍                  | 317/1014 [00:09<00:20, 34.84batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 34.86batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 34.94batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 34.97batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 34.90batch/s] 34%|█████████                  | 342/1014 [00:09<00:19, 34.91batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:19, 34.84batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:18, 34.85batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 34.83batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 34.80batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.64batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 34.68batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 34.67batch/s] 38%|██████████▏                | 382/1014 [00:11<00:18, 34.71batch/s] 38%|██████████▎                | 387/1014 [00:11<00:18, 34.78batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 34.84batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 34.84batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 34.86batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.80batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 34.82batch/s] 41%|███████████                | 417/1014 [00:11<00:17, 34.93batch/s] 42%|███████████▏               | 422/1014 [00:12<00:16, 34.93batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 34.88batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 34.87batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 34.92batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 34.84batch/s] 44%|███████████▉               | 447/1014 [00:12<00:16, 34.80batch/s] 45%|████████████               | 452/1014 [00:12<00:16, 34.85batch/s] 45%|████████████▏              | 457/1014 [00:13<00:15, 34.93batch/s] 46%|████████████▎              | 462/1014 [00:13<00:15, 34.93batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 34.87batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 34.93batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 34.88batch/s] 48%|████████████▊              | 482/1014 [00:13<00:15, 34.87batch/s] 48%|████████████▉              | 487/1014 [00:13<00:15, 34.86batch/s] 49%|█████████████              | 492/1014 [00:14<00:14, 34.83batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 34.83batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 34.88batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 34.91batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 34.97batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 35.00batch/s] 51%|█████████████▉             | 522/1014 [00:14<00:14, 34.94batch/s] 52%|██████████████             | 527/1014 [00:15<00:13, 34.98batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 34.99batch/s] 53%|██████████████▎            | 537/1014 [00:15<00:13, 34.92batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 34.83batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 34.85batch/s] 54%|██████████████▋            | 552/1014 [00:15<00:13, 34.78batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.77batch/s] 55%|██████████████▉            | 562/1014 [00:16<00:13, 34.76batch/s] 56%|███████████████            | 567/1014 [00:16<00:12, 34.84batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 34.79batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 34.77batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 34.76batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 34.75batch/s] 58%|███████████████▊           | 592/1014 [00:17<00:12, 34.73batch/s] 59%|███████████████▉           | 597/1014 [00:17<00:12, 34.75batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 34.68batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 34.67batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 34.72batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.73batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 34.77batch/s] 62%|████████████████▋          | 627/1014 [00:18<00:11, 34.80batch/s] 62%|████████████████▊          | 632/1014 [00:18<00:10, 34.80batch/s] 63%|████████████████▉          | 637/1014 [00:18<00:10, 34.77batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 34.80batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.82batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 34.83batch/s] 65%|█████████████████▍         | 657/1014 [00:18<00:10, 34.89batch/s] 65%|█████████████████▋         | 662/1014 [00:19<00:10, 34.84batch/s] 66%|█████████████████▊         | 667/1014 [00:19<00:09, 34.85batch/s] 66%|█████████████████▉         | 672/1014 [00:19<00:09, 34.87batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.87batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 34.90batch/s] 68%|██████████████████▎        | 687/1014 [00:19<00:09, 34.93batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 34.88batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:09, 34.85batch/s] 69%|██████████████████▋        | 702/1014 [00:20<00:08, 34.83batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.88batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 34.89batch/s] 71%|███████████████████        | 717/1014 [00:20<00:08, 34.90batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 34.89batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 34.88batch/s] 72%|███████████████████▍       | 732/1014 [00:20<00:08, 34.92batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:07, 34.95batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 34.99batch/s] 74%|███████████████████▉       | 747/1014 [00:21<00:07, 35.02batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 35.01batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 35.04batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 34.98batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:07, 35.00batch/s] 76%|████████████████████▌      | 772/1014 [00:22<00:06, 34.95batch/s] 77%|████████████████████▋      | 777/1014 [00:22<00:06, 34.91batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 34.88batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 34.83batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 34.84batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 34.83batch/s] 79%|█████████████████████▎     | 802/1014 [00:23<00:06, 34.85batch/s] 80%|█████████████████████▍     | 807/1014 [00:23<00:05, 34.82batch/s] 80%|█████████████████████▌     | 812/1014 [00:23<00:05, 34.86batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 34.84batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 34.87batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.85batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 34.78batch/s] 83%|██████████████████████▎    | 837/1014 [00:24<00:05, 34.82batch/s] 83%|██████████████████████▍    | 842/1014 [00:24<00:04, 34.84batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 34.78batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 34.82batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.80batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 34.82batch/s] 86%|███████████████████████    | 867/1014 [00:24<00:04, 34.77batch/s] 86%|███████████████████████▏   | 872/1014 [00:25<00:04, 34.81batch/s] 86%|███████████████████████▎   | 877/1014 [00:25<00:03, 34.82batch/s] 87%|███████████████████████▍   | 882/1014 [00:25<00:03, 34.82batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.80batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 34.79batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.85batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 34.84batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.87batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.86batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 34.91batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.87batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.84batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.81batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.81batch/s] 94%|█████████████████████████▎ | 952/1014 [00:27<00:01, 34.82batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.80batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.79batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 34.82batch/s] 96%|█████████████████████████▉ | 976/1014 [00:28<00:01, 34.84batch/s] 97%|██████████████████████████▏| 982/1014 [00:28<00:00, 34.82batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.78batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.76batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.79batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 34.83batch/s]100%|█████████████████████████▉| 1012/1014 [00:29<00:00, 34.88batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.89batch/s]
Validation 41 -> LOSS = 0.25
Validation 41 -> BLEU = 96.44, 98.6/97.0/95.8/94.4 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.44 @ validation 39
Starting Epoch 42
Epoch 42 - update      19770 => loss:   0.131 (#OOM: 0)
Epoch 42 - update      19800 => loss:   0.050 (#OOM: 0)
Epoch 42 - update      19830 => loss:   0.068 (#OOM: 0)
Epoch 42 - update      19860 => loss:   0.102 (#OOM: 0)
Epoch 42 - update      19890 => loss:   0.124 (#OOM: 0)
Epoch 42 - update      19920 => loss:   0.117 (#OOM: 0)
Epoch 42 - update      19950 => loss:   0.107 (#OOM: 0)
Epoch 42 - update      19980 => loss:   0.117 (#OOM: 0)
Epoch 42 - update      20010 => loss:   0.111 (#OOM: 0)
Epoch 42 - update      20040 => loss:   0.139 (#OOM: 0)
Epoch 42 - update      20070 => loss:   0.087 (#OOM: 0)
Epoch 42 - update      20100 => loss:   0.051 (#OOM: 0)
Epoch 42 - update      20130 => loss:   0.067 (#OOM: 0)
Epoch 42 - update      20160 => loss:   0.095 (#OOM: 0)
Epoch 42 - update      20190 => loss:   0.056 (#OOM: 0)
Epoch 42 - update      20220 => loss:   0.152 (#OOM: 0)
--> Epoch 42 finished with mean loss 0.10433
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (671 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 18.36batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.32batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.38batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.18batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.31batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.76batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.71batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.24batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.73batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.67batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.05batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.34batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.60batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 12.77batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.47batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.87batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.87batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:31, 31.73batch/s]  1%|▏                            | 8/1014 [00:00<00:31, 32.02batch/s]  1%|▎                           | 12/1014 [00:00<00:30, 32.67batch/s]  2%|▍                           | 16/1014 [00:00<00:30, 33.12batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 32.21batch/s]  2%|▋                           | 24/1014 [00:00<00:30, 32.68batch/s]  3%|▊                           | 28/1014 [00:00<00:30, 32.55batch/s]  3%|▉                           | 32/1014 [00:00<00:29, 33.16batch/s]  4%|▉                           | 36/1014 [00:01<00:29, 33.30batch/s]  4%|█                           | 40/1014 [00:01<00:30, 32.31batch/s]  4%|█▏                          | 44/1014 [00:01<00:30, 32.22batch/s]  5%|█▎                          | 48/1014 [00:01<00:30, 32.17batch/s]  5%|█▍                          | 53/1014 [00:01<00:29, 32.49batch/s]  6%|█▌                          | 58/1014 [00:01<00:29, 32.82batch/s]  6%|█▋                          | 63/1014 [00:01<00:28, 32.98batch/s]  7%|█▉                          | 68/1014 [00:02<00:28, 33.11batch/s]  7%|██                          | 73/1014 [00:02<00:28, 33.54batch/s]  8%|██▏                         | 78/1014 [00:02<00:27, 33.86batch/s]  8%|██▎                         | 83/1014 [00:02<00:27, 33.38batch/s]  9%|██▍                         | 88/1014 [00:02<00:27, 33.49batch/s]  9%|██▌                         | 93/1014 [00:02<00:27, 33.82batch/s] 10%|██▋                         | 98/1014 [00:02<00:27, 33.92batch/s] 10%|██▋                        | 103/1014 [00:03<00:26, 34.13batch/s] 11%|██▉                        | 108/1014 [00:03<00:26, 34.43batch/s] 11%|███                        | 113/1014 [00:03<00:26, 34.60batch/s] 12%|███▏                       | 118/1014 [00:03<00:25, 34.54batch/s] 12%|███▎                       | 123/1014 [00:03<00:25, 34.53batch/s] 13%|███▍                       | 128/1014 [00:03<00:26, 33.88batch/s] 13%|███▌                       | 133/1014 [00:03<00:25, 34.06batch/s] 14%|███▋                       | 138/1014 [00:04<00:25, 34.14batch/s] 14%|███▊                       | 143/1014 [00:04<00:25, 34.28batch/s] 15%|███▉                       | 148/1014 [00:04<00:25, 34.26batch/s] 15%|████                       | 153/1014 [00:04<00:25, 34.29batch/s] 16%|████▏                      | 158/1014 [00:04<00:24, 34.37batch/s] 16%|████▎                      | 163/1014 [00:04<00:24, 34.51batch/s] 17%|████▍                      | 168/1014 [00:04<00:24, 34.27batch/s] 17%|████▌                      | 173/1014 [00:05<00:24, 34.29batch/s] 18%|████▋                      | 178/1014 [00:05<00:24, 34.52batch/s] 18%|████▊                      | 183/1014 [00:05<00:24, 34.43batch/s] 19%|█████                      | 188/1014 [00:05<00:24, 34.35batch/s] 19%|█████▏                     | 193/1014 [00:05<00:23, 34.39batch/s] 20%|█████▎                     | 198/1014 [00:05<00:23, 34.42batch/s] 20%|█████▍                     | 203/1014 [00:05<00:23, 34.51batch/s] 21%|█████▌                     | 208/1014 [00:06<00:23, 34.42batch/s] 21%|█████▋                     | 213/1014 [00:06<00:23, 34.54batch/s] 21%|█████▊                     | 218/1014 [00:06<00:23, 34.54batch/s] 22%|█████▉                     | 223/1014 [00:06<00:22, 34.54batch/s] 22%|██████                     | 228/1014 [00:06<00:22, 34.59batch/s] 23%|██████▏                    | 233/1014 [00:06<00:22, 34.49batch/s] 23%|██████▎                    | 238/1014 [00:06<00:22, 34.52batch/s] 24%|██████▍                    | 243/1014 [00:07<00:22, 34.57batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 34.75batch/s] 25%|██████▋                    | 253/1014 [00:07<00:21, 34.80batch/s] 25%|██████▊                    | 258/1014 [00:07<00:21, 34.62batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 34.66batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 34.67batch/s] 27%|███████▎                   | 273/1014 [00:07<00:21, 34.60batch/s] 27%|███████▍                   | 278/1014 [00:08<00:21, 34.65batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 34.75batch/s] 28%|███████▋                   | 288/1014 [00:08<00:20, 34.64batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 34.54batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 34.59batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 34.58batch/s] 30%|████████▏                  | 308/1014 [00:08<00:20, 34.64batch/s] 31%|████████▎                  | 313/1014 [00:08<00:20, 34.80batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 34.72batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 34.69batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 34.72batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 34.75batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 34.78batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:19, 34.88batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:19, 34.85batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:18, 34.92batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 34.97batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 35.03batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 35.02batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 35.07batch/s] 37%|██████████                 | 378/1014 [00:10<00:18, 35.01batch/s] 38%|██████████▏                | 383/1014 [00:10<00:18, 35.01batch/s] 38%|██████████▎                | 388/1014 [00:11<00:17, 35.07batch/s] 39%|██████████▍                | 393/1014 [00:11<00:17, 35.05batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 34.90batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 34.89batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 34.83batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 34.89batch/s] 41%|███████████▏               | 418/1014 [00:11<00:17, 34.92batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 34.72batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 34.69batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 34.65batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 34.67batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.75batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 34.66batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 34.67batch/s] 45%|████████████▏              | 458/1014 [00:13<00:16, 34.62batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 34.66batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 34.68batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.67batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 34.65batch/s] 48%|████████████▊              | 483/1014 [00:13<00:15, 34.70batch/s] 48%|████████████▉              | 488/1014 [00:14<00:15, 34.69batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:14, 34.79batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 34.85batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.82batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 34.80batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 34.71batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:14, 34.75batch/s] 52%|█████████████▉             | 523/1014 [00:15<00:14, 34.75batch/s] 52%|██████████████             | 528/1014 [00:15<00:13, 34.77batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 34.75batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 34.72batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.70batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 34.69batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 34.75batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 34.63batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:12, 34.71batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 34.74batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.71batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 34.76batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 34.80batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 34.74batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.75batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:11, 34.70batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 34.70batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 34.71batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 34.78batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 34.73batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 34.75batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 34.75batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:10, 34.81batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 34.79batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 34.78batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 34.74batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.74batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 34.76batch/s] 65%|█████████████████▋         | 663/1014 [00:19<00:10, 34.78batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:09, 34.77batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 34.80batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.79batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.74batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 34.67batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:09, 34.67batch/s] 69%|██████████████████▌        | 698/1014 [00:20<00:09, 34.69batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:08, 34.65batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.63batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.57batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 34.51batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 34.46batch/s] 72%|███████████████████▍       | 728/1014 [00:21<00:08, 34.47batch/s] 72%|███████████████████▌       | 733/1014 [00:21<00:08, 34.47batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:08, 34.49batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.48batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.47batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.52batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 34.50batch/s] 75%|████████████████████▎      | 763/1014 [00:22<00:07, 34.51batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.47batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.48batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.49batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 34.47batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 34.44batch/s] 78%|█████████████████████      | 793/1014 [00:23<00:06, 34.44batch/s] 79%|█████████████████████▏     | 798/1014 [00:23<00:06, 34.44batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.43batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 34.42batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.41batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.44batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 34.42batch/s] 82%|██████████████████████     | 828/1014 [00:24<00:05, 34.44batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.47batch/s] 83%|██████████████████████▎    | 838/1014 [00:24<00:05, 34.47batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 34.45batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.46batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.45batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 34.47batch/s] 85%|██████████████████████▉    | 863/1014 [00:25<00:04, 34.46batch/s] 86%|███████████████████████    | 868/1014 [00:25<00:04, 34.46batch/s] 86%|███████████████████████▏   | 873/1014 [00:25<00:04, 34.47batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.50batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.53batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.48batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.48batch/s] 89%|███████████████████████▉   | 898/1014 [00:26<00:03, 34.48batch/s] 89%|████████████████████████   | 903/1014 [00:26<00:03, 34.46batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.42batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.37batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.41batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.45batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.48batch/s] 92%|████████████████████████▊  | 933/1014 [00:27<00:02, 34.51batch/s] 93%|████████████████████████▉  | 938/1014 [00:27<00:02, 34.52batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 34.50batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.48batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.49batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.47batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 34.49batch/s] 95%|█████████████████████████▊ | 968/1014 [00:28<00:01, 34.43batch/s] 96%|█████████████████████████▉ | 973/1014 [00:28<00:01, 34.45batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.44batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.47batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.48batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 34.47batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 34.49batch/s] 99%|█████████████████████████▋| 1003/1014 [00:29<00:00, 34.52batch/s] 99%|█████████████████████████▊| 1008/1014 [00:29<00:00, 34.52batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.49batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.50batch/s]
Validation 42 -> LOSS = 0.25
Validation 42 -> BLEU = 96.47, 98.6/97.1/95.9/94.6 (BP=1.000, ratio=1.000, hyp_len=14375, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.25 @ validation 42
--> Best BLEU so far: 96.47 @ validation 42
Starting Epoch 43
Epoch 43 - update      20250 => loss:   0.084 (#OOM: 0)
Epoch 43 - update      20280 => loss:   0.092 (#OOM: 0)
Epoch 43 - update      20310 => loss:   0.135 (#OOM: 0)
Epoch 43 - update      20340 => loss:   0.079 (#OOM: 0)
Epoch 43 - update      20370 => loss:   0.070 (#OOM: 0)
Epoch 43 - update      20400 => loss:   0.078 (#OOM: 0)
Epoch 43 - update      20430 => loss:   0.029 (#OOM: 0)
Epoch 43 - update      20460 => loss:   0.130 (#OOM: 0)
Epoch 43 - update      20490 => loss:   0.094 (#OOM: 0)
Epoch 43 - update      20520 => loss:   0.101 (#OOM: 0)
Epoch 43 - update      20550 => loss:   0.083 (#OOM: 0)
Epoch 43 - update      20580 => loss:   0.062 (#OOM: 0)
Epoch 43 - update      20610 => loss:   0.103 (#OOM: 0)
Epoch 43 - update      20640 => loss:   0.007 (#OOM: 0)
Epoch 43 - update      20670 => loss:   0.128 (#OOM: 0)
Epoch 43 - update      20700 => loss:   0.047 (#OOM: 0)
--> Epoch 43 finished with mean loss 0.10194
--> Overhead/Training/Evaluation: 0.61/0.71/0.00 mins (total: 1.32 mins)   (676 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.99batch/s]  9%|██▋                            | 3/34 [00:00<00:03,  9.72batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.81batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.35batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.74batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.31batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.19batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.85batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.24batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.58batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.63batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.87batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.60batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:34, 29.66batch/s]  1%|▏                            | 7/1014 [00:00<00:31, 31.57batch/s]  1%|▎                           | 11/1014 [00:00<00:31, 31.62batch/s]  1%|▍                           | 15/1014 [00:00<00:30, 32.90batch/s]  2%|▌                           | 19/1014 [00:00<00:29, 33.48batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.87batch/s]  3%|▊                           | 29/1014 [00:00<00:28, 34.33batch/s]  3%|▉                           | 34/1014 [00:00<00:28, 34.89batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.35batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.12batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 35.28batch/s]  5%|█▍                          | 54/1014 [00:01<00:27, 34.61batch/s]  6%|█▋                          | 59/1014 [00:01<00:28, 33.75batch/s]  6%|█▊                          | 64/1014 [00:01<00:28, 33.01batch/s]  7%|█▉                          | 69/1014 [00:02<00:28, 32.62batch/s]  7%|██                          | 74/1014 [00:02<00:28, 32.69batch/s]  8%|██▏                         | 79/1014 [00:02<00:28, 33.13batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 33.41batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 33.56batch/s]  9%|██▌                         | 94/1014 [00:02<00:27, 33.67batch/s] 10%|██▋                         | 99/1014 [00:02<00:27, 33.82batch/s] 10%|██▊                        | 104/1014 [00:03<00:26, 33.84batch/s] 11%|██▉                        | 109/1014 [00:03<00:26, 34.16batch/s] 11%|███                        | 114/1014 [00:03<00:26, 34.31batch/s] 12%|███▏                       | 119/1014 [00:03<00:25, 34.67batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 34.47batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.57batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.56batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 34.48batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.45batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 34.23batch/s] 15%|████                       | 154/1014 [00:04<00:24, 34.46batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.58batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.70batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.44batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.41batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 34.53batch/s] 18%|████▉                      | 184/1014 [00:05<00:24, 34.48batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 34.46batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.46batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.37batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.32batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.44batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.43batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 34.39batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.41batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.36batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.52batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.56batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.66batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 34.61batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 34.71batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.75batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.75batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.79batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 34.70batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.70batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 34.80batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 34.83batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.91batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.88batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.95batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 34.97batch/s] 31%|████████▎                  | 314/1014 [00:08<00:20, 34.94batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 34.91batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 34.90batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.80batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 34.70batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.64batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 34.72batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.69batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 34.74batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 34.68batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.69batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.65batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.72batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 34.69batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.62batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.66batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 34.67batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.68batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.72batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.74batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 34.69batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.66batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 34.55batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.56batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.61batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.65batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.69batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.68batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.72batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 34.70batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.60batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.61batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.60batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.50batch/s] 48%|████████████▉              | 484/1014 [00:14<00:15, 34.52batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.60batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:15, 34.54batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.56batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.59batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.66batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.73batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 34.72batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.81batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.82batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.75batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.80batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.80batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.75batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.84batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.75batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.80batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.85batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.80batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.84batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.86batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.87batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.88batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.88batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.88batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.93batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.97batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.97batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 35.03batch/s] 62%|████████████████▊          | 631/1014 [00:17<00:10, 35.09batch/s] 63%|████████████████▉          | 637/1014 [00:18<00:10, 35.07batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.09batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.08batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.11batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:10, 35.16batch/s] 66%|█████████████████▊         | 667/1014 [00:18<00:09, 35.11batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.10batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.12batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.11batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 35.17batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:09, 35.13batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 35.17batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.16batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.16batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 35.11batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 35.12batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:07, 35.13batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 35.17batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.14batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 35.16batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 35.14batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.17batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.21batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 35.01batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 34.98batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.05batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.08batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.07batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.05batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 35.01batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 34.93batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 34.95batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.01batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 34.98batch/s] 83%|██████████████████████▍    | 841/1014 [00:24<00:04, 35.01batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 34.98batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.95batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.99batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 34.99batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.04batch/s] 86%|███████████████████████▎   | 877/1014 [00:25<00:03, 35.03batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 35.02batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.98batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.99batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 34.95batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 34.99batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.97batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.00batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.01batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.02batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 34.99batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 34.98batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.96batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.95batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 34.95batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 34.95batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 34.97batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.95batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.98batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 34.98batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.00batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 34.97batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 34.92batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.95batch/s]
Validation 43 -> LOSS = 0.24
Validation 43 -> BLEU = 96.41, 98.5/97.0/95.8/94.4 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 43
--> Best BLEU so far: 96.47 @ validation 42
Starting Epoch 44
Epoch 44 - update      20730 => loss:   0.108 (#OOM: 0)
Epoch 44 - update      20760 => loss:   0.095 (#OOM: 0)
Epoch 44 - update      20790 => loss:   0.136 (#OOM: 0)
Epoch 44 - update      20820 => loss:   0.087 (#OOM: 0)
Epoch 44 - update      20850 => loss:   0.076 (#OOM: 0)
Epoch 44 - update      20880 => loss:   0.142 (#OOM: 0)
Epoch 44 - update      20910 => loss:   0.076 (#OOM: 0)
Epoch 44 - update      20940 => loss:   0.152 (#OOM: 0)
Epoch 44 - update      20970 => loss:   0.114 (#OOM: 0)
Epoch 44 - update      21000 => loss:   0.121 (#OOM: 0)
Epoch 44 - update      21030 => loss:   0.072 (#OOM: 0)
Epoch 44 - update      21060 => loss:   0.145 (#OOM: 0)
Epoch 44 - update      21090 => loss:   0.073 (#OOM: 0)
Epoch 44 - update      21120 => loss:   0.040 (#OOM: 0)
Epoch 44 - update      21150 => loss:   0.123 (#OOM: 0)
Epoch 44 - update      21180 => loss:   0.067 (#OOM: 0)
--> Epoch 44 finished with mean loss 0.10081
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (667 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  8.17batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.06batch/s]  9%|██▋                            | 3/34 [00:00<00:03,  8.44batch/s] 12%|███▋                           | 4/34 [00:00<00:03,  8.60batch/s] 15%|████▌                          | 5/34 [00:00<00:03,  8.71batch/s] 21%|██████▍                        | 7/34 [00:00<00:02,  9.57batch/s] 26%|████████▏                      | 9/34 [00:00<00:02, 10.63batch/s] 32%|█████████▋                    | 11/34 [00:00<00:02, 11.03batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 11.39batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 11.89batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 11.78batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 11.43batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 11.59batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 11.92batch/s] 74%|██████████████████████        | 25/34 [00:02<00:00, 12.12batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 11.79batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 11.79batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 12.56batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 12.73batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:27, 36.09batch/s]  1%|▎                            | 9/1014 [00:00<00:25, 39.26batch/s]  1%|▍                           | 14/1014 [00:00<00:26, 37.69batch/s]  2%|▌                           | 19/1014 [00:00<00:27, 35.71batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 35.32batch/s]  3%|▊                           | 29/1014 [00:00<00:28, 34.54batch/s]  3%|▉                           | 34/1014 [00:00<00:28, 34.20batch/s]  4%|█                           | 39/1014 [00:01<00:28, 34.34batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.24batch/s]  5%|█▎                          | 49/1014 [00:01<00:28, 33.75batch/s]  5%|█▍                          | 54/1014 [00:01<00:28, 33.46batch/s]  6%|█▋                          | 59/1014 [00:01<00:28, 33.32batch/s]  6%|█▊                          | 64/1014 [00:01<00:28, 33.66batch/s]  7%|█▉                          | 69/1014 [00:02<00:27, 33.83batch/s]  7%|██                          | 74/1014 [00:02<00:27, 34.06batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 33.63batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 33.70batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 33.57batch/s]  9%|██▌                         | 94/1014 [00:02<00:26, 34.11batch/s] 10%|██▋                         | 99/1014 [00:02<00:26, 34.27batch/s] 10%|██▊                        | 104/1014 [00:03<00:26, 34.21batch/s] 11%|██▉                        | 109/1014 [00:03<00:26, 34.20batch/s] 11%|███                        | 114/1014 [00:03<00:26, 34.23batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 34.19batch/s] 12%|███▎                       | 124/1014 [00:03<00:26, 34.19batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.17batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.49batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 34.27batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.24batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 34.27batch/s] 15%|████                       | 154/1014 [00:04<00:25, 34.35batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.34batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.33batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.50batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.43batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 34.38batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 34.62batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 34.89batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.72batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.56batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.71batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.51batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.56batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 34.68batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.57batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.65batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.74batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.74batch/s] 24%|██████▍                    | 244/1014 [00:06<00:22, 34.86batch/s] 25%|██████▋                    | 249/1014 [00:07<00:21, 34.97batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 35.01batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.14batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 35.09batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 35.11batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 35.23batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 35.28batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 35.20batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 35.19batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.22batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.24batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.30batch/s] 30%|████████▏                  | 309/1014 [00:08<00:19, 35.29batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.30batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 35.23batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.26batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.21batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.15batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.10batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 35.12batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.12batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 35.10batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.04batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.07batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 35.11batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.13batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 35.09batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.01batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.08batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.12batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.12batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.06batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.08batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.16batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.15batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.18batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.21batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.21batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.20batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 35.09batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.89batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.76batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.63batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.69batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.72batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.68batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.65batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.67batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.74batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 34.80batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.84batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.94batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.97batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.92batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 34.92batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.84batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.88batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.91batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.94batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.01batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.05batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.06batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.00batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 35.03batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.03batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.11batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.15batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.12batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.13batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.19batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 35.19batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.16batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.16batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.13batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.09batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 35.08batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.14batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 35.08batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 35.11batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.05batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.08batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.12batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.07batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.11batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 35.14batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.12batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.17batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.23batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.22batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.19batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.23batch/s] 69%|██████████████████▋        | 704/1014 [00:19<00:08, 35.21batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.19batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.23batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.25batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.25batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 35.16batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.05batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 35.01batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 35.00batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.99batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.02batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.03batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.07batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.03batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 35.03batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.99batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.98batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.96batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.98batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.97batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.02batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 35.01batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.04batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.02batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.99batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.02batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.02batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:05, 34.99batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.94batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.96batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.99batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.01batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 34.96batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 34.91batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.93batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.94batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.96batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.91batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 34.90batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.91batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 34.91batch/s] 90%|████████████████████████▏  | 909/1014 [00:26<00:03, 34.92batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.96batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.99batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.00batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.01batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.99batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 34.99batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.01batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 35.02batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 35.00batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.99batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.98batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.97batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 34.99batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.00batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 35.00batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.00batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.02batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.03batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.99batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.01batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.00batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.00batch/s]
Validation 44 -> LOSS = 0.25
Validation 44 -> BLEU = 96.50, 98.6/97.1/95.9/94.6 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 43
--> Best BLEU so far: 96.50 @ validation 44
Starting Epoch 45
Epoch 45 - update      21210 => loss:   0.150 (#OOM: 0)
Epoch 45 - update      21240 => loss:   0.065 (#OOM: 0)
Epoch 45 - update      21270 => loss:   0.093 (#OOM: 0)
Epoch 45 - update      21300 => loss:   0.058 (#OOM: 0)
Epoch 45 - update      21330 => loss:   0.097 (#OOM: 0)
Epoch 45 - update      21360 => loss:   0.147 (#OOM: 0)
Epoch 45 - update      21390 => loss:   0.096 (#OOM: 0)
Epoch 45 - update      21420 => loss:   0.047 (#OOM: 0)
Epoch 45 - update      21450 => loss:   0.082 (#OOM: 0)
Epoch 45 - update      21480 => loss:   0.065 (#OOM: 0)
Epoch 45 - update      21510 => loss:   0.132 (#OOM: 0)
Epoch 45 - update      21540 => loss:   0.064 (#OOM: 0)
Epoch 45 - update      21570 => loss:   0.092 (#OOM: 0)
Epoch 45 - update      21600 => loss:   0.080 (#OOM: 0)
Epoch 45 - update      21630 => loss:   0.073 (#OOM: 0)
Epoch 45 - update      21660 => loss:   0.148 (#OOM: 0)
Epoch 45 - update      21690 => loss:   0.080 (#OOM: 0)
--> Epoch 45 finished with mean loss 0.09706
--> Overhead/Training/Evaluation: 0.60/0.72/0.00 mins (total: 1.32 mins)   (673 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.20batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.68batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.37batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.24batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.75batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.59batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.94batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.96batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.89batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.30batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.62batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.04batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.13batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.95batch/s]  1%|▎                            | 9/1014 [00:00<00:26, 37.61batch/s]  1%|▍                           | 14/1014 [00:00<00:27, 36.54batch/s]  2%|▌                           | 19/1014 [00:00<00:30, 32.89batch/s]  2%|▋                           | 24/1014 [00:00<00:30, 32.49batch/s]  3%|▊                           | 29/1014 [00:00<00:29, 33.56batch/s]  3%|▉                           | 34/1014 [00:00<00:28, 34.19batch/s]  4%|█                           | 39/1014 [00:01<00:28, 33.91batch/s]  4%|█▏                          | 44/1014 [00:01<00:28, 33.85batch/s]  5%|█▎                          | 49/1014 [00:01<00:28, 34.15batch/s]  5%|█▍                          | 54/1014 [00:01<00:29, 32.90batch/s]  6%|█▋                          | 59/1014 [00:01<00:29, 32.33batch/s]  6%|█▊                          | 64/1014 [00:02<00:29, 31.98batch/s]  7%|█▉                          | 69/1014 [00:02<00:29, 31.57batch/s]  7%|██                          | 74/1014 [00:02<00:29, 32.01batch/s]  8%|██▏                         | 79/1014 [00:02<00:28, 32.41batch/s]  8%|██▎                         | 84/1014 [00:02<00:28, 32.63batch/s]  9%|██▍                         | 89/1014 [00:02<00:28, 32.51batch/s]  9%|██▌                         | 94/1014 [00:02<00:28, 32.49batch/s] 10%|██▋                         | 99/1014 [00:03<00:28, 32.39batch/s] 10%|██▊                        | 104/1014 [00:03<00:28, 32.34batch/s] 11%|██▉                        | 109/1014 [00:03<00:28, 32.31batch/s] 11%|███                        | 114/1014 [00:03<00:27, 32.54batch/s] 12%|███▏                       | 119/1014 [00:03<00:27, 32.76batch/s] 12%|███▎                       | 124/1014 [00:03<00:27, 32.88batch/s] 13%|███▍                       | 129/1014 [00:03<00:26, 32.89batch/s] 13%|███▌                       | 134/1014 [00:04<00:26, 32.78batch/s] 14%|███▋                       | 139/1014 [00:04<00:26, 32.57batch/s] 14%|███▊                       | 144/1014 [00:04<00:26, 32.79batch/s] 15%|███▉                       | 149/1014 [00:04<00:26, 32.94batch/s] 15%|████                       | 154/1014 [00:04<00:25, 33.12batch/s] 16%|████▏                      | 159/1014 [00:04<00:25, 32.99batch/s] 16%|████▎                      | 164/1014 [00:04<00:25, 33.07batch/s] 17%|████▌                      | 169/1014 [00:05<00:25, 33.13batch/s] 17%|████▋                      | 174/1014 [00:05<00:25, 33.18batch/s] 18%|████▊                      | 179/1014 [00:05<00:25, 33.36batch/s] 18%|████▉                      | 184/1014 [00:05<00:24, 33.36batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 33.43batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 33.49batch/s] 20%|█████▎                     | 199/1014 [00:05<00:24, 33.63batch/s] 20%|█████▍                     | 204/1014 [00:06<00:24, 33.60batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 33.59batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 33.40batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 33.30batch/s] 22%|█████▉                     | 224/1014 [00:06<00:23, 33.44batch/s] 23%|██████                     | 229/1014 [00:06<00:23, 33.24batch/s] 23%|██████▏                    | 234/1014 [00:07<00:23, 33.16batch/s] 24%|██████▎                    | 239/1014 [00:07<00:23, 33.31batch/s] 24%|██████▍                    | 244/1014 [00:07<00:23, 33.25batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 33.30batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 33.28batch/s] 26%|██████▉                    | 259/1014 [00:07<00:22, 33.22batch/s] 26%|███████                    | 264/1014 [00:07<00:22, 33.32batch/s] 27%|███████▏                   | 269/1014 [00:08<00:22, 33.27batch/s] 27%|███████▎                   | 274/1014 [00:08<00:22, 33.35batch/s] 28%|███████▍                   | 279/1014 [00:08<00:22, 33.39batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 33.48batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 33.42batch/s] 29%|███████▊                   | 294/1014 [00:08<00:21, 33.47batch/s] 29%|███████▉                   | 299/1014 [00:08<00:21, 33.48batch/s] 30%|████████                   | 304/1014 [00:09<00:21, 33.44batch/s] 30%|████████▏                  | 309/1014 [00:09<00:21, 33.45batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 33.47batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 33.51batch/s] 32%|████████▋                  | 324/1014 [00:09<00:20, 33.55batch/s] 32%|████████▊                  | 329/1014 [00:09<00:20, 33.46batch/s] 33%|████████▉                  | 334/1014 [00:09<00:20, 33.43batch/s] 33%|█████████                  | 339/1014 [00:10<00:20, 33.45batch/s] 34%|█████████▏                 | 344/1014 [00:10<00:20, 33.45batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 33.47batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 33.55batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:19, 33.61batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:19, 33.66batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:19, 33.66batch/s] 37%|█████████▉                 | 374/1014 [00:11<00:19, 33.63batch/s] 37%|██████████                 | 379/1014 [00:11<00:18, 33.66batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 33.74batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 33.65batch/s] 39%|██████████▍                | 394/1014 [00:11<00:18, 33.67batch/s] 39%|██████████▌                | 399/1014 [00:11<00:18, 33.71batch/s] 40%|██████████▊                | 404/1014 [00:11<00:18, 33.73batch/s] 40%|██████████▉                | 409/1014 [00:12<00:17, 33.78batch/s] 41%|███████████                | 414/1014 [00:12<00:17, 33.71batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 33.74batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 33.74batch/s] 42%|███████████▍               | 429/1014 [00:12<00:17, 33.78batch/s] 43%|███████████▌               | 434/1014 [00:12<00:17, 33.70batch/s] 43%|███████████▋               | 439/1014 [00:13<00:17, 33.73batch/s] 44%|███████████▊               | 444/1014 [00:13<00:16, 33.73batch/s] 44%|███████████▉               | 449/1014 [00:13<00:16, 33.75batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 33.77batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 33.83batch/s] 46%|████████████▎              | 464/1014 [00:13<00:16, 33.88batch/s] 46%|████████████▍              | 469/1014 [00:13<00:16, 33.90batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 33.99batch/s] 47%|████████████▊              | 479/1014 [00:14<00:15, 34.02batch/s] 48%|████████████▉              | 484/1014 [00:14<00:15, 34.04batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.01batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:15, 34.05batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:15, 34.06batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.05batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 33.98batch/s] 51%|█████████████▋             | 514/1014 [00:15<00:14, 33.98batch/s] 51%|█████████████▊             | 519/1014 [00:15<00:14, 34.00batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.00batch/s] 52%|██████████████             | 529/1014 [00:15<00:14, 33.95batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:14, 33.95batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 33.93batch/s] 54%|██████████████▍            | 544/1014 [00:16<00:13, 33.94batch/s] 54%|██████████████▌            | 549/1014 [00:16<00:13, 33.98batch/s] 55%|██████████████▊            | 554/1014 [00:16<00:13, 33.94batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 33.92batch/s] 56%|███████████████            | 564/1014 [00:16<00:13, 33.90batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:13, 33.95batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.00batch/s] 57%|███████████████▍           | 579/1014 [00:17<00:12, 33.96batch/s] 58%|███████████████▌           | 584/1014 [00:17<00:12, 33.99batch/s] 58%|███████████████▋           | 589/1014 [00:17<00:12, 33.99batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.06batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:12, 34.04batch/s] 60%|████████████████           | 604/1014 [00:17<00:12, 34.05batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.02batch/s] 61%|████████████████▎          | 614/1014 [00:18<00:11, 34.02batch/s] 61%|████████████████▍          | 619/1014 [00:18<00:11, 34.01batch/s] 62%|████████████████▌          | 624/1014 [00:18<00:11, 33.98batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 33.93batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:11, 33.94batch/s] 63%|█████████████████          | 639/1014 [00:18<00:11, 34.01batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.03batch/s] 64%|█████████████████▎         | 649/1014 [00:19<00:10, 34.00batch/s] 64%|█████████████████▍         | 654/1014 [00:19<00:10, 34.01batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 34.02batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.02batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:10, 34.07batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.02batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 33.97batch/s] 67%|██████████████████▏        | 684/1014 [00:20<00:09, 33.95batch/s] 68%|██████████████████▎        | 689/1014 [00:20<00:09, 33.88batch/s] 68%|██████████████████▍        | 694/1014 [00:20<00:09, 33.93batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 33.93batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:09, 33.86batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:09, 33.86batch/s] 70%|███████████████████        | 714/1014 [00:21<00:08, 33.88batch/s] 71%|███████████████████▏       | 719/1014 [00:21<00:08, 33.86batch/s] 71%|███████████████████▎       | 724/1014 [00:21<00:08, 33.87batch/s] 72%|███████████████████▍       | 729/1014 [00:21<00:08, 33.91batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 33.95batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:08, 33.97batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.01batch/s] 74%|███████████████████▉       | 749/1014 [00:22<00:07, 34.01batch/s] 74%|████████████████████       | 754/1014 [00:22<00:07, 34.03batch/s] 75%|████████████████████▏      | 759/1014 [00:22<00:07, 34.04batch/s] 75%|████████████████████▎      | 764/1014 [00:22<00:07, 34.05batch/s] 76%|████████████████████▍      | 769/1014 [00:22<00:07, 34.03batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:07, 34.03batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.03batch/s] 77%|████████████████████▉      | 784/1014 [00:23<00:06, 34.00batch/s] 78%|█████████████████████      | 789/1014 [00:23<00:06, 34.02batch/s] 78%|█████████████████████▏     | 794/1014 [00:23<00:06, 34.04batch/s] 79%|█████████████████████▎     | 799/1014 [00:23<00:06, 34.04batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.02batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:06, 34.05batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.05batch/s] 81%|█████████████████████▊     | 819/1014 [00:24<00:05, 34.06batch/s] 81%|█████████████████████▉     | 824/1014 [00:24<00:05, 34.05batch/s] 82%|██████████████████████     | 829/1014 [00:24<00:05, 34.09batch/s] 82%|██████████████████████▏    | 834/1014 [00:24<00:05, 34.11batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.15batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.17batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.20batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.25batch/s] 85%|██████████████████████▊    | 859/1014 [00:25<00:04, 34.28batch/s] 85%|███████████████████████    | 864/1014 [00:25<00:04, 34.30batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.34batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.36batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.37batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.35batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.36batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 34.39batch/s] 89%|███████████████████████▉   | 899/1014 [00:26<00:03, 34.35batch/s] 89%|████████████████████████   | 904/1014 [00:26<00:03, 34.34batch/s] 90%|████████████████████████▏  | 909/1014 [00:26<00:03, 34.38batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.38batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.37batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.35batch/s] 92%|████████████████████████▋  | 929/1014 [00:27<00:02, 34.31batch/s] 92%|████████████████████████▊  | 934/1014 [00:27<00:02, 34.33batch/s] 93%|█████████████████████████  | 939/1014 [00:27<00:02, 34.34batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.32batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.36batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.36batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.34batch/s] 95%|█████████████████████████▋ | 964/1014 [00:28<00:01, 34.31batch/s] 96%|█████████████████████████▊ | 969/1014 [00:28<00:01, 34.30batch/s] 96%|█████████████████████████▉ | 974/1014 [00:28<00:01, 34.28batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.31batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.34batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.35batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.39batch/s] 99%|██████████████████████████▌| 999/1014 [00:29<00:00, 34.37batch/s] 99%|█████████████████████████▋| 1004/1014 [00:29<00:00, 34.38batch/s]100%|█████████████████████████▊| 1009/1014 [00:29<00:00, 34.38batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.40batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.40batch/s]
Validation 45 -> LOSS = 0.25
Validation 45 -> BLEU = 96.50, 98.6/97.1/95.9/94.6 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 43
--> Best BLEU so far: 96.50 @ validation 44
Starting Epoch 46
Epoch 46 - update      21720 => loss:   0.115 (#OOM: 0)
Epoch 46 - update      21750 => loss:   0.125 (#OOM: 0)
Epoch 46 - update      21780 => loss:   0.101 (#OOM: 0)
Epoch 46 - update      21810 => loss:   0.062 (#OOM: 0)
Epoch 46 - update      21840 => loss:   0.094 (#OOM: 0)
Epoch 46 - update      21870 => loss:   0.070 (#OOM: 0)
Epoch 46 - update      21900 => loss:   0.055 (#OOM: 0)
Epoch 46 - update      21930 => loss:   0.073 (#OOM: 0)
Epoch 46 - update      21960 => loss:   0.054 (#OOM: 0)
Epoch 46 - update      21990 => loss:   0.075 (#OOM: 0)
Epoch 46 - update      22020 => loss:   0.159 (#OOM: 0)
Epoch 46 - update      22050 => loss:   0.075 (#OOM: 0)
Epoch 46 - update      22080 => loss:   0.084 (#OOM: 0)
Epoch 46 - update      22110 => loss:   0.071 (#OOM: 0)
Epoch 46 - update      22140 => loss:   0.070 (#OOM: 0)
Epoch 46 - update      22170 => loss:   0.082 (#OOM: 0)
--> Epoch 46 finished with mean loss 0.09803
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (671 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 18.19batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 17.36batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 14.43batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 15.91batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 15.73batch/s] 44%|█████████████▏                | 15/34 [00:00<00:01, 16.33batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 15.54batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 15.08batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 14.24batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 14.10batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.68batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.16batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.94batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:31, 31.88batch/s]  1%|▎                            | 9/1014 [00:00<00:29, 34.25batch/s]  1%|▍                           | 14/1014 [00:00<00:27, 36.96batch/s]  2%|▌                           | 19/1014 [00:00<00:26, 36.97batch/s]  2%|▋                           | 24/1014 [00:00<00:27, 35.65batch/s]  3%|▊                           | 29/1014 [00:00<00:28, 34.68batch/s]  3%|▉                           | 34/1014 [00:01<00:31, 30.75batch/s]  4%|█                           | 39/1014 [00:01<00:30, 31.86batch/s]  4%|█▏                          | 44/1014 [00:01<00:29, 32.52batch/s]  5%|█▎                          | 49/1014 [00:01<00:29, 32.76batch/s]  5%|█▍                          | 54/1014 [00:01<00:29, 32.63batch/s]  6%|█▋                          | 59/1014 [00:01<00:29, 32.82batch/s]  6%|█▊                          | 64/1014 [00:01<00:28, 33.03batch/s]  7%|█▉                          | 69/1014 [00:02<00:28, 32.83batch/s]  7%|██                          | 74/1014 [00:02<00:28, 33.08batch/s]  8%|██▏                         | 79/1014 [00:02<00:28, 33.19batch/s]  8%|██▎                         | 84/1014 [00:02<00:28, 33.19batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 33.21batch/s]  9%|██▌                         | 94/1014 [00:02<00:27, 33.14batch/s] 10%|██▋                         | 99/1014 [00:02<00:27, 33.58batch/s] 10%|██▊                        | 104/1014 [00:03<00:27, 33.50batch/s] 11%|██▉                        | 109/1014 [00:03<00:27, 33.51batch/s] 11%|███                        | 114/1014 [00:03<00:26, 33.89batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 33.73batch/s] 12%|███▎                       | 124/1014 [00:03<00:26, 33.99batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.08batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.11batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 34.21batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.46batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 34.74batch/s] 15%|████                       | 154/1014 [00:04<00:24, 34.88batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.74batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.79batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.85batch/s] 17%|████▋                      | 174/1014 [00:04<00:24, 34.85batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 34.89batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.05batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 35.03batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 35.03batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 35.05batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 35.02batch/s] 21%|█████▌                     | 209/1014 [00:05<00:23, 34.94batch/s] 21%|█████▋                     | 214/1014 [00:06<00:22, 35.00batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 35.01batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 35.02batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 35.10batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.95batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.96batch/s] 24%|██████▍                    | 244/1014 [00:06<00:22, 34.97batch/s] 25%|██████▋                    | 249/1014 [00:07<00:21, 34.97batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 34.97batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.02batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 35.12batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 35.20batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.29batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 35.29batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 35.24batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 35.19batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.21batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.24batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.22batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 35.24batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.22batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 35.22batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.21batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.21batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.15batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.14batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 35.19batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.24batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 35.32batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.34batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.45batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 35.47batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.44batch/s] 37%|██████████                 | 379/1014 [00:10<00:17, 35.39batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.37batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.32batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.33batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.31batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.27batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.15batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.16batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.16batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.18batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.19batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.25batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.28batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 35.28batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 35.26batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.30batch/s] 45%|████████████▏              | 459/1014 [00:12<00:15, 35.31batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.31batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.37batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.31batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 35.25batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 35.15batch/s] 48%|█████████████              | 489/1014 [00:13<00:14, 35.23batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 35.21batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.21batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 35.25batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.28batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.30batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 35.24batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.24batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 35.20batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 35.19batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.21batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.19batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.20batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.18batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.18batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 35.22batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.29batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.31batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.27batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.25batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.24batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.19batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.24batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.15batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.13batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.19batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.18batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 35.23batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.20batch/s] 63%|████████████████▉          | 634/1014 [00:17<00:10, 35.26batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 35.26batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.21batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.25batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.32batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.34batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.34batch/s] 66%|█████████████████▊         | 669/1014 [00:18<00:09, 35.29batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.30batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.31batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.35batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.39batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.43batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.47batch/s] 69%|██████████████████▋        | 704/1014 [00:19<00:08, 35.48batch/s] 70%|██████████████████▉        | 709/1014 [00:19<00:08, 35.47batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.50batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.48batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.51batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 35.50batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.55batch/s] 73%|███████████████████▋       | 739/1014 [00:20<00:07, 35.53batch/s] 73%|███████████████████▊       | 744/1014 [00:20<00:07, 35.55batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.58batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.57batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.50batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.49batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.48batch/s] 76%|████████████████████▌      | 774/1014 [00:21<00:06, 35.47batch/s] 77%|████████████████████▋      | 779/1014 [00:21<00:06, 35.45batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.44batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.42batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.40batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.39batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.41batch/s] 80%|█████████████████████▌     | 809/1014 [00:22<00:05, 35.40batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.35batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.37batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.40batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.44batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.38batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.35batch/s] 83%|██████████████████████▍    | 844/1014 [00:23<00:04, 35.34batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 35.37batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.37batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.34batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.37batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.36batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.35batch/s] 87%|███████████████████████▍   | 879/1014 [00:24<00:03, 35.34batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 35.30batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.27batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.29batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.28batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.33batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.34batch/s] 90%|████████████████████████▎  | 914/1014 [00:25<00:02, 35.31batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.31batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.31batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.30batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.30batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 35.34batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.32batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.29batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 35.26batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.27batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 35.26batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 35.27batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 35.30batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.33batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.31batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.29batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.33batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.36batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 35.38batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.41batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.42batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.42batch/s]
Validation 46 -> LOSS = 0.24
Validation 46 -> BLEU = 95.93, 98.1/96.5/95.3/93.9 (BP=1.000, ratio=1.004, hyp_len=14436, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 43
--> Best BLEU so far: 96.50 @ validation 44
Starting Epoch 47
Epoch 47 - update      22200 => loss:   0.059 (#OOM: 0)
Epoch 47 - update      22230 => loss:   0.075 (#OOM: 0)
Epoch 47 - update      22260 => loss:   0.074 (#OOM: 0)
Epoch 47 - update      22290 => loss:   0.123 (#OOM: 0)
Epoch 47 - update      22320 => loss:   0.082 (#OOM: 0)
Epoch 47 - update      22350 => loss:   0.092 (#OOM: 0)
Epoch 47 - update      22380 => loss:   0.143 (#OOM: 0)
Epoch 47 - update      22410 => loss:   0.101 (#OOM: 0)
Epoch 47 - update      22440 => loss:   0.118 (#OOM: 0)
Epoch 47 - update      22470 => loss:   0.105 (#OOM: 0)
Epoch 47 - update      22500 => loss:   0.105 (#OOM: 0)
Epoch 47 - update      22530 => loss:   0.128 (#OOM: 0)
Epoch 47 - update      22560 => loss:   0.108 (#OOM: 0)
Epoch 47 - update      22590 => loss:   0.133 (#OOM: 0)
Epoch 47 - update      22620 => loss:   0.101 (#OOM: 0)
Epoch 47 - update      22650 => loss:   0.130 (#OOM: 0)
--> Epoch 47 finished with mean loss 0.09615
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.34 mins)   (676 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 13.93batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.29batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.19batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.15batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.04batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.64batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.76batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.42batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.76batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 14.39batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 14.31batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 14.25batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.63batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.55batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.11batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 37.06batch/s]  1%|▎                           | 12/1014 [00:00<00:27, 36.92batch/s]  2%|▍                           | 17/1014 [00:00<00:26, 37.10batch/s]  2%|▌                           | 22/1014 [00:00<00:26, 37.04batch/s]  3%|▋                           | 27/1014 [00:00<00:26, 37.10batch/s]  3%|▉                           | 32/1014 [00:00<00:27, 35.24batch/s]  4%|█                           | 37/1014 [00:01<00:28, 34.28batch/s]  4%|█▏                          | 42/1014 [00:01<00:29, 33.25batch/s]  5%|█▎                          | 47/1014 [00:01<00:28, 33.69batch/s]  5%|█▍                          | 52/1014 [00:01<00:29, 32.96batch/s]  6%|█▌                          | 57/1014 [00:01<00:28, 33.42batch/s]  6%|█▋                          | 62/1014 [00:01<00:28, 33.26batch/s]  7%|█▊                          | 67/1014 [00:02<00:28, 33.41batch/s]  7%|█▉                          | 72/1014 [00:02<00:28, 33.41batch/s]  8%|██▏                         | 77/1014 [00:02<00:28, 33.42batch/s]  8%|██▎                         | 82/1014 [00:02<00:27, 33.37batch/s]  9%|██▍                         | 87/1014 [00:02<00:27, 33.35batch/s]  9%|██▌                         | 92/1014 [00:02<00:27, 33.61batch/s] 10%|██▋                         | 97/1014 [00:02<00:27, 33.62batch/s] 10%|██▋                        | 102/1014 [00:03<00:27, 33.69batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 33.72batch/s] 11%|██▉                        | 112/1014 [00:03<00:26, 33.90batch/s] 12%|███                        | 117/1014 [00:03<00:26, 33.50batch/s] 12%|███▏                       | 122/1014 [00:03<00:26, 33.47batch/s] 13%|███▍                       | 127/1014 [00:03<00:26, 33.63batch/s] 13%|███▌                       | 132/1014 [00:03<00:26, 33.76batch/s] 14%|███▋                       | 137/1014 [00:04<00:25, 33.81batch/s] 14%|███▊                       | 142/1014 [00:04<00:25, 34.07batch/s] 14%|███▉                       | 147/1014 [00:04<00:25, 34.20batch/s] 15%|████                       | 152/1014 [00:04<00:25, 34.17batch/s] 15%|████▏                      | 157/1014 [00:04<00:25, 34.12batch/s] 16%|████▎                      | 162/1014 [00:04<00:25, 34.07batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.18batch/s] 17%|████▌                      | 172/1014 [00:05<00:24, 34.23batch/s] 17%|████▋                      | 177/1014 [00:05<00:24, 34.35batch/s] 18%|████▊                      | 182/1014 [00:05<00:24, 34.44batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 34.53batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 34.28batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 34.38batch/s] 20%|█████▍                     | 202/1014 [00:05<00:23, 34.38batch/s] 20%|█████▌                     | 207/1014 [00:06<00:23, 34.38batch/s] 21%|█████▋                     | 212/1014 [00:06<00:23, 34.32batch/s] 21%|█████▊                     | 217/1014 [00:06<00:23, 34.43batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 34.50batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 34.56batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 34.69batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 34.52batch/s] 24%|██████▍                    | 242/1014 [00:07<00:22, 34.54batch/s] 24%|██████▌                    | 247/1014 [00:07<00:22, 34.64batch/s] 25%|██████▋                    | 252/1014 [00:07<00:22, 34.55batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 34.63batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 34.70batch/s] 26%|███████                    | 267/1014 [00:07<00:21, 34.71batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 34.66batch/s] 27%|███████▍                   | 277/1014 [00:07<00:21, 34.78batch/s] 28%|███████▌                   | 282/1014 [00:08<00:21, 34.69batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 34.81batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 34.79batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 34.73batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 34.64batch/s] 30%|████████▏                  | 307/1014 [00:08<00:20, 34.67batch/s] 31%|████████▎                  | 312/1014 [00:08<00:20, 34.75batch/s] 31%|████████▍                  | 317/1014 [00:09<00:20, 34.76batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 34.85batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 34.75batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 34.76batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 34.65batch/s] 34%|█████████                  | 342/1014 [00:09<00:19, 34.72batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:19, 34.79batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:18, 34.87batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 34.88batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 34.91batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.90batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 35.10batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 35.11batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 35.16batch/s] 39%|██████████▍                | 391/1014 [00:11<00:17, 35.19batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 35.28batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 35.27batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.34batch/s] 41%|███████████                | 415/1014 [00:11<00:16, 35.39batch/s] 42%|███████████▏               | 421/1014 [00:11<00:16, 35.42batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 35.42batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 35.41batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.31batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.37batch/s] 44%|████████████               | 451/1014 [00:12<00:15, 35.38batch/s] 45%|████████████▏              | 457/1014 [00:12<00:15, 35.41batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 35.39batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.35batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 35.35batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 35.37batch/s] 48%|████████████▉              | 487/1014 [00:13<00:14, 35.39batch/s] 49%|█████████████▏             | 493/1014 [00:13<00:14, 35.39batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.38batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.41batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 35.41batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 35.41batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.33batch/s] 52%|██████████████             | 529/1014 [00:14<00:13, 35.29batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 35.28batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 35.25batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 35.22batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 35.23batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.32batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 35.21batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 35.23batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 35.24batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.18batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.14batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.09batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 35.02batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 35.00batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 34.98batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.02batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 34.98batch/s] 62%|████████████████▊          | 631/1014 [00:18<00:10, 35.00batch/s] 63%|████████████████▉          | 637/1014 [00:18<00:10, 35.05batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.01batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.03batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.04batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:10, 35.04batch/s] 66%|█████████████████▊         | 667/1014 [00:19<00:09, 35.04batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.11batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.03batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.98batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 35.01batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:09, 35.02batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:08, 35.08batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.09batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.11batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 35.18batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 35.21batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:07, 35.19batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 35.09batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.06batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 35.10batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 35.11batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.14batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.11batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 35.13batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.17batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.11batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.11batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.12batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.10batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 35.06batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 35.07batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.03batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.07batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.07batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.11batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 35.11batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.16batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.19batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.18batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.20batch/s] 86%|███████████████████████▎   | 877/1014 [00:24<00:03, 35.17batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 35.14batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.12batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.11batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.14batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 35.14batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 35.10batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.14batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.14batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.14batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.15batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.16batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 35.13batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.14batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.13batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.11batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.09batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.13batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 35.12batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 35.15batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.13batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.13batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.14batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.12batch/s]
Validation 47 -> LOSS = 0.25
Validation 47 -> BLEU = 96.52, 98.6/97.1/95.9/94.6 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 43
--> Best BLEU so far: 96.52 @ validation 47
Starting Epoch 48
Epoch 48 - update      22680 => loss:   0.127 (#OOM: 0)
Epoch 48 - update      22710 => loss:   0.079 (#OOM: 0)
Epoch 48 - update      22740 => loss:   0.087 (#OOM: 0)
Epoch 48 - update      22770 => loss:   0.075 (#OOM: 0)
Epoch 48 - update      22800 => loss:   0.067 (#OOM: 0)
Epoch 48 - update      22830 => loss:   0.175 (#OOM: 0)
Epoch 48 - update      22860 => loss:   0.070 (#OOM: 0)
Epoch 48 - update      22890 => loss:   0.077 (#OOM: 0)
Epoch 48 - update      22920 => loss:   0.067 (#OOM: 0)
Epoch 48 - update      22950 => loss:   0.081 (#OOM: 0)
Epoch 48 - update      22980 => loss:   0.153 (#OOM: 0)
Epoch 48 - update      23010 => loss:   0.102 (#OOM: 0)
Epoch 48 - update      23040 => loss:   0.045 (#OOM: 0)
Epoch 48 - update      23070 => loss:   0.110 (#OOM: 0)
Epoch 48 - update      23100 => loss:   0.073 (#OOM: 0)
Epoch 48 - update      23130 => loss:   0.000 (#OOM: 0)
--> Epoch 48 finished with mean loss 0.09399
--> Overhead/Training/Evaluation: 0.64/0.73/0.00 mins (total: 1.37 mins)   (662 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.74batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  9.08batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.15batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 13.17batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.07batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.33batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.40batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.72batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.65batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.76batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.19batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.11batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.02batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.01batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:37, 26.70batch/s]  1%|▏                            | 7/1014 [00:00<00:34, 29.03batch/s]  1%|▎                           | 11/1014 [00:00<00:31, 31.46batch/s]  2%|▍                           | 16/1014 [00:00<00:29, 34.04batch/s]  2%|▌                           | 21/1014 [00:00<00:30, 32.96batch/s]  3%|▋                           | 26/1014 [00:00<00:30, 31.92batch/s]  3%|▊                           | 31/1014 [00:00<00:30, 31.97batch/s]  4%|▉                           | 36/1014 [00:01<00:30, 32.40batch/s]  4%|█▏                          | 41/1014 [00:01<00:30, 32.43batch/s]  5%|█▎                          | 46/1014 [00:01<00:30, 32.25batch/s]  5%|█▍                          | 51/1014 [00:01<00:29, 32.31batch/s]  6%|█▌                          | 56/1014 [00:01<00:29, 32.06batch/s]  6%|█▋                          | 61/1014 [00:01<00:29, 32.49batch/s]  7%|█▊                          | 66/1014 [00:02<00:28, 32.97batch/s]  7%|█▉                          | 71/1014 [00:02<00:28, 33.16batch/s]  7%|██                          | 76/1014 [00:02<00:28, 32.96batch/s]  8%|██▏                         | 81/1014 [00:02<00:28, 33.31batch/s]  8%|██▎                         | 86/1014 [00:02<00:28, 32.80batch/s]  9%|██▌                         | 91/1014 [00:02<00:28, 32.76batch/s]  9%|██▋                         | 96/1014 [00:02<00:27, 33.02batch/s] 10%|██▋                        | 101/1014 [00:03<00:27, 33.07batch/s] 10%|██▊                        | 106/1014 [00:03<00:27, 33.42batch/s] 11%|██▉                        | 111/1014 [00:03<00:27, 33.44batch/s] 11%|███                        | 116/1014 [00:03<00:26, 33.42batch/s] 12%|███▏                       | 121/1014 [00:03<00:26, 33.35batch/s] 12%|███▎                       | 126/1014 [00:03<00:26, 33.39batch/s] 13%|███▍                       | 131/1014 [00:03<00:26, 33.62batch/s] 13%|███▌                       | 136/1014 [00:04<00:26, 33.25batch/s] 14%|███▊                       | 141/1014 [00:04<00:26, 33.18batch/s] 14%|███▉                       | 146/1014 [00:04<00:26, 33.12batch/s] 15%|████                       | 151/1014 [00:04<00:26, 33.03batch/s] 15%|████▏                      | 156/1014 [00:04<00:25, 33.17batch/s] 16%|████▎                      | 161/1014 [00:04<00:25, 33.38batch/s] 16%|████▍                      | 166/1014 [00:04<00:25, 33.41batch/s] 17%|████▌                      | 171/1014 [00:05<00:25, 33.46batch/s] 17%|████▋                      | 176/1014 [00:05<00:25, 33.44batch/s] 18%|████▊                      | 181/1014 [00:05<00:24, 33.38batch/s] 18%|████▉                      | 186/1014 [00:05<00:24, 33.39batch/s] 19%|█████                      | 191/1014 [00:05<00:24, 33.46batch/s] 19%|█████▏                     | 196/1014 [00:05<00:24, 33.45batch/s] 20%|█████▎                     | 201/1014 [00:05<00:24, 33.60batch/s] 20%|█████▍                     | 206/1014 [00:06<00:24, 33.59batch/s] 21%|█████▌                     | 211/1014 [00:06<00:23, 33.69batch/s] 21%|█████▊                     | 216/1014 [00:06<00:23, 33.68batch/s] 22%|█████▉                     | 221/1014 [00:06<00:23, 33.87batch/s] 22%|██████                     | 226/1014 [00:06<00:23, 33.44batch/s] 23%|██████▏                    | 231/1014 [00:06<00:23, 33.48batch/s] 23%|██████▎                    | 236/1014 [00:07<00:23, 33.53batch/s] 24%|██████▍                    | 241/1014 [00:07<00:23, 33.53batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 33.65batch/s] 25%|██████▋                    | 251/1014 [00:07<00:22, 33.76batch/s] 25%|██████▊                    | 256/1014 [00:07<00:22, 33.74batch/s] 26%|██████▉                    | 261/1014 [00:07<00:22, 33.84batch/s] 26%|███████                    | 266/1014 [00:07<00:22, 33.87batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.03batch/s] 27%|███████▎                   | 276/1014 [00:08<00:21, 34.14batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.23batch/s] 28%|███████▌                   | 286/1014 [00:08<00:21, 34.24batch/s] 29%|███████▋                   | 291/1014 [00:08<00:21, 34.30batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 34.22batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 34.25batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 34.36batch/s] 31%|████████▎                  | 311/1014 [00:09<00:20, 34.34batch/s] 31%|████████▍                  | 316/1014 [00:09<00:20, 34.38batch/s] 32%|████████▌                  | 321/1014 [00:09<00:20, 34.53batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 34.53batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 34.42batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 34.53batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 34.53batch/s] 34%|█████████▏                 | 346/1014 [00:10<00:19, 34.56batch/s] 35%|█████████▎                 | 351/1014 [00:10<00:19, 34.60batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:19, 34.52batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 34.47batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 34.53batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 34.52batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 34.51batch/s] 38%|██████████▏                | 381/1014 [00:11<00:18, 34.54batch/s] 38%|██████████▎                | 386/1014 [00:11<00:18, 34.57batch/s] 39%|██████████▍                | 391/1014 [00:11<00:18, 34.47batch/s] 39%|██████████▌                | 396/1014 [00:11<00:17, 34.45batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 34.47batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 34.56batch/s] 41%|██████████▉                | 411/1014 [00:11<00:17, 34.57batch/s] 41%|███████████                | 416/1014 [00:12<00:17, 34.41batch/s] 42%|███████████▏               | 421/1014 [00:12<00:17, 34.50batch/s] 42%|███████████▎               | 426/1014 [00:12<00:17, 34.49batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 34.57batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 34.65batch/s] 43%|███████████▋               | 441/1014 [00:12<00:16, 34.64batch/s] 44%|███████████▉               | 446/1014 [00:12<00:16, 34.73batch/s] 44%|████████████               | 451/1014 [00:12<00:16, 34.76batch/s] 45%|████████████▏              | 456/1014 [00:13<00:16, 34.81batch/s] 45%|████████████▎              | 461/1014 [00:13<00:15, 34.77batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 34.75batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 34.71batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 34.60batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 34.62batch/s] 48%|████████████▉              | 486/1014 [00:14<00:15, 34.54batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 34.62batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 34.61batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:14, 34.60batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 34.65batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 34.64batch/s] 51%|█████████████▋             | 516/1014 [00:14<00:14, 34.70batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:14, 34.74batch/s] 52%|██████████████             | 526/1014 [00:15<00:14, 34.81batch/s] 52%|██████████████▏            | 531/1014 [00:15<00:13, 34.83batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 34.84batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 34.85batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 34.92batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 34.92batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:13, 34.87batch/s] 55%|██████████████▉            | 561/1014 [00:16<00:12, 34.90batch/s] 56%|███████████████            | 566/1014 [00:16<00:12, 34.85batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 34.89batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 34.89batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.91batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 34.92batch/s] 58%|███████████████▋           | 591/1014 [00:17<00:12, 34.70batch/s] 59%|███████████████▊           | 596/1014 [00:17<00:12, 34.76batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 34.70batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 34.74batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.76batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 34.77batch/s] 61%|████████████████▌          | 621/1014 [00:17<00:11, 34.75batch/s] 62%|████████████████▋          | 626/1014 [00:18<00:11, 34.77batch/s] 62%|████████████████▊          | 631/1014 [00:18<00:11, 34.76batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:10, 34.80batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.84batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 34.89batch/s] 64%|█████████████████▎         | 651/1014 [00:18<00:10, 34.89batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 34.80batch/s] 65%|█████████████████▌         | 661/1014 [00:19<00:10, 34.78batch/s] 66%|█████████████████▋         | 666/1014 [00:19<00:10, 34.79batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.77batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 34.74batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 34.79batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 34.76batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 34.76batch/s] 69%|██████████████████▌        | 696/1014 [00:20<00:09, 34.77batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.75batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 34.73batch/s] 70%|██████████████████▉        | 711/1014 [00:20<00:08, 34.77batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 34.77batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 34.71batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 34.71batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.69batch/s] 73%|███████████████████▌       | 736/1014 [00:21<00:08, 34.68batch/s] 73%|███████████████████▋       | 741/1014 [00:21<00:07, 34.66batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 34.61batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 34.56batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 34.58batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 34.65batch/s] 76%|████████████████████▍      | 766/1014 [00:22<00:07, 34.68batch/s] 76%|████████████████████▌      | 771/1014 [00:22<00:07, 34.71batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 34.72batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 34.72batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 34.75batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.77batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 34.79batch/s] 79%|█████████████████████▎     | 801/1014 [00:23<00:06, 34.79batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:05, 34.78batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 34.82batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 34.86batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.89batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 34.89batch/s] 82%|██████████████████████▏    | 831/1014 [00:23<00:05, 34.86batch/s] 82%|██████████████████████▎    | 836/1014 [00:24<00:05, 34.82batch/s] 83%|██████████████████████▍    | 841/1014 [00:24<00:04, 34.82batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 34.83batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.84batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 34.82batch/s] 85%|██████████████████████▉    | 861/1014 [00:24<00:04, 34.78batch/s] 85%|███████████████████████    | 866/1014 [00:24<00:04, 34.74batch/s] 86%|███████████████████████▏   | 871/1014 [00:25<00:04, 34.73batch/s] 86%|███████████████████████▎   | 876/1014 [00:25<00:03, 34.75batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.74batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 34.75batch/s] 88%|███████████████████████▋   | 891/1014 [00:25<00:03, 34.74batch/s] 88%|███████████████████████▊   | 896/1014 [00:25<00:03, 34.67batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 34.73batch/s] 89%|████████████████████████   | 906/1014 [00:26<00:03, 34.75batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.73batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.77batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 34.73batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 34.67batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 34.66batch/s] 92%|████████████████████████▉  | 936/1014 [00:27<00:02, 34.64batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.67batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.67batch/s] 94%|█████████████████████████▎ | 951/1014 [00:27<00:01, 34.64batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 34.64batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 34.61batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 34.58batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.60batch/s] 96%|█████████████████████████▉ | 976/1014 [00:28<00:01, 34.61batch/s] 97%|██████████████████████████ | 981/1014 [00:28<00:00, 34.62batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 34.61batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 34.59batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 34.62batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.64batch/s] 99%|█████████████████████████▊| 1006/1014 [00:29<00:00, 34.64batch/s]100%|█████████████████████████▉| 1011/1014 [00:29<00:00, 34.65batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.67batch/s]
Validation 48 -> LOSS = 0.24
Validation 48 -> BLEU = 96.65, 98.6/97.2/96.0/94.8 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 48
--> Best BLEU so far: 96.65 @ validation 48
Starting Epoch 49
Epoch 49 - update      23160 => loss:   0.072 (#OOM: 0)
Epoch 49 - update      23190 => loss:   0.067 (#OOM: 0)
Epoch 49 - update      23220 => loss:   0.055 (#OOM: 0)
Epoch 49 - update      23250 => loss:   0.055 (#OOM: 0)
Epoch 49 - update      23280 => loss:   0.101 (#OOM: 0)
Epoch 49 - update      23310 => loss:   0.103 (#OOM: 0)
Epoch 49 - update      23340 => loss:   0.122 (#OOM: 0)
Epoch 49 - update      23370 => loss:   0.069 (#OOM: 0)
Epoch 49 - update      23400 => loss:   0.099 (#OOM: 0)
Epoch 49 - update      23430 => loss:   0.120 (#OOM: 0)
Epoch 49 - update      23460 => loss:   0.106 (#OOM: 0)
Epoch 49 - update      23490 => loss:   0.086 (#OOM: 0)
Epoch 49 - update      23520 => loss:   0.088 (#OOM: 0)
Epoch 49 - update      23550 => loss:   0.088 (#OOM: 0)
Epoch 49 - update      23580 => loss:   0.234 (#OOM: 0)
Epoch 49 - update      23610 => loss:   0.053 (#OOM: 0)
--> Epoch 49 finished with mean loss 0.09437
--> Overhead/Training/Evaluation: 0.67/0.72/0.00 mins (total: 1.40 mins)   (667 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.81batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.71batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.68batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.72batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.06batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.87batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.83batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.23batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.70batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.98batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.84batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.29batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.64batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.88batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.07batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:27, 36.67batch/s]  1%|▎                           | 10/1014 [00:00<00:29, 34.36batch/s]  1%|▍                           | 15/1014 [00:00<00:28, 35.35batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 35.65batch/s]  2%|▋                           | 25/1014 [00:00<00:29, 34.10batch/s]  3%|▊                           | 30/1014 [00:00<00:29, 33.77batch/s]  3%|▉                           | 35/1014 [00:01<00:29, 32.86batch/s]  4%|█                           | 40/1014 [00:01<00:29, 33.58batch/s]  4%|█▏                          | 45/1014 [00:01<00:28, 33.96batch/s]  5%|█▍                          | 50/1014 [00:01<00:28, 33.30batch/s]  5%|█▌                          | 55/1014 [00:01<00:28, 33.85batch/s]  6%|█▋                          | 60/1014 [00:01<00:27, 34.48batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 34.54batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.59batch/s]  7%|██                          | 75/1014 [00:02<00:26, 34.80batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 34.50batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 34.49batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 34.44batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.34batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.25batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.37batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.42batch/s] 11%|███                        | 115/1014 [00:03<00:26, 34.55batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 34.67batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.64batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.32batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.54batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.60batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 34.84batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.06batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.12batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 35.07batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 35.04batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.78batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.62batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 34.87batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 34.91batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.93batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.02batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 35.18batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.24batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.27batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.02batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.01batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.96batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 35.06batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 35.11batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 35.00batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.91batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 35.16batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 35.13batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 35.34batch/s] 27%|███████▏                   | 269/1014 [00:07<00:20, 35.51batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.56batch/s] 28%|███████▍                   | 281/1014 [00:07<00:20, 35.61batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.60batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 35.49batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.68batch/s] 30%|████████                   | 305/1014 [00:08<00:19, 35.55batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 35.62batch/s] 31%|████████▍                  | 317/1014 [00:08<00:19, 35.56batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.65batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.72batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.66batch/s] 34%|█████████                  | 341/1014 [00:09<00:18, 35.60batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:18, 35.60batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:18, 35.70batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.63batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.66batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:17, 35.73batch/s] 37%|██████████                 | 377/1014 [00:10<00:17, 35.68batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 35.68batch/s] 38%|██████████▎                | 389/1014 [00:10<00:17, 35.59batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.60batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 35.46batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 35.51batch/s] 41%|██████████▉                | 413/1014 [00:11<00:16, 35.49batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.37batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.40batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 35.42batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 35.38batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 35.38batch/s] 44%|███████████▉               | 449/1014 [00:12<00:15, 35.32batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 35.30batch/s] 45%|████████████▎              | 461/1014 [00:13<00:15, 35.29batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 35.35batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 35.36batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 35.28batch/s] 48%|████████████▉              | 485/1014 [00:13<00:14, 35.32batch/s] 48%|█████████████              | 491/1014 [00:13<00:14, 35.30batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 35.24batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.24batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.23batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 35.28batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:13, 35.26batch/s] 52%|██████████████             | 527/1014 [00:14<00:13, 35.31batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 35.37batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.41batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.45batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 35.43batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:12, 35.44batch/s] 56%|██████████████▉            | 563/1014 [00:15<00:12, 35.35batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.47batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.48batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 35.37batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 35.36batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 35.39batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.31batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 35.41batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 35.35batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 35.30batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 35.34batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.33batch/s] 63%|████████████████▉          | 635/1014 [00:17<00:10, 35.31batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 35.26batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 35.26batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 35.30batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.30batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 35.31batch/s] 66%|█████████████████▊         | 671/1014 [00:18<00:09, 35.34batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 35.38batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 35.39batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.26batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 35.25batch/s] 69%|██████████████████▋        | 701/1014 [00:19<00:08, 35.08batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 35.02batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.95batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.01batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.05batch/s] 72%|███████████████████▍       | 731/1014 [00:20<00:08, 34.98batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:07, 35.02batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 35.02batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.99batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.00batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 34.93batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:07, 34.96batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.96batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.00batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.05batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 35.09batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 35.09batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:06, 35.09batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 35.08batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 35.09batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 35.07batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 35.03batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.04batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:05, 34.98batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.95batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.95batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.95batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.95batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 34.90batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.92batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.91batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.89batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.84batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.84batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 34.83batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.85batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.85batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.83batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.78batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.83batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.82batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.83batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.84batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.85batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.82batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 34.84batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.85batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.88batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.85batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.87batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.87batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 34.87batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.84batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.80batch/s]
Validation 49 -> LOSS = 0.25
Validation 49 -> BLEU = 96.48, 98.6/97.1/96.0/94.7 (BP=0.999, ratio=0.999, hyp_len=14367, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 48
--> Best BLEU so far: 96.65 @ validation 48
Starting Epoch 50
Epoch 50 - update      23640 => loss:   0.066 (#OOM: 0)
Epoch 50 - update      23670 => loss:   0.088 (#OOM: 0)
Epoch 50 - update      23700 => loss:   0.137 (#OOM: 0)
Epoch 50 - update      23730 => loss:   0.052 (#OOM: 0)
Epoch 50 - update      23760 => loss:   0.085 (#OOM: 0)
Epoch 50 - update      23790 => loss:   0.084 (#OOM: 0)
Epoch 50 - update      23820 => loss:   0.070 (#OOM: 0)
Epoch 50 - update      23850 => loss:   0.085 (#OOM: 0)
Epoch 50 - update      23880 => loss:   0.047 (#OOM: 0)
Epoch 50 - update      23910 => loss:   0.084 (#OOM: 0)
Epoch 50 - update      23940 => loss:   0.095 (#OOM: 0)
Epoch 50 - update      23970 => loss:   0.070 (#OOM: 0)
Epoch 50 - update      24000 => loss:   0.087 (#OOM: 0)
Epoch 50 - update      24030 => loss:   0.110 (#OOM: 0)
Epoch 50 - update      24060 => loss:   0.188 (#OOM: 0)
Epoch 50 - update      24090 => loss:   0.161 (#OOM: 0)
--> Epoch 50 finished with mean loss 0.09200
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (668 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 13.97batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 15.25batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.91batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 14.60batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 14.00batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.45batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.91batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.03batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.43batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.92batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.78batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.31batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 14.05batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 14.09batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.98batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:25, 39.97batch/s]  1%|▏                            | 8/1014 [00:00<00:26, 38.62batch/s]  1%|▎                           | 12/1014 [00:00<00:26, 37.54batch/s]  2%|▍                           | 16/1014 [00:00<00:26, 37.59batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 34.02batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.39batch/s]  3%|▊                           | 28/1014 [00:00<00:28, 34.19batch/s]  3%|▉                           | 32/1014 [00:00<00:28, 34.19batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 34.36batch/s]  4%|█                           | 40/1014 [00:01<00:28, 34.43batch/s]  4%|█▏                          | 44/1014 [00:01<00:28, 34.46batch/s]  5%|█▎                          | 48/1014 [00:01<00:28, 34.27batch/s]  5%|█▍                          | 52/1014 [00:01<00:28, 33.28batch/s]  6%|█▌                          | 56/1014 [00:01<00:28, 33.37batch/s]  6%|█▋                          | 60/1014 [00:01<00:28, 33.71batch/s]  6%|█▊                          | 65/1014 [00:01<00:28, 33.56batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 33.79batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.00batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 34.07batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 33.52batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 33.87batch/s]  9%|██▌                         | 95/1014 [00:02<00:27, 33.59batch/s] 10%|██▋                        | 100/1014 [00:02<00:27, 33.55batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 33.87batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 33.60batch/s] 11%|███                        | 115/1014 [00:03<00:26, 33.47batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 33.46batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 33.38batch/s] 13%|███▍                       | 130/1014 [00:03<00:26, 33.53batch/s] 13%|███▌                       | 135/1014 [00:04<00:26, 33.45batch/s] 14%|███▋                       | 140/1014 [00:04<00:26, 33.54batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 33.54batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 33.51batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 33.48batch/s] 16%|████▎                      | 160/1014 [00:04<00:25, 33.54batch/s] 16%|████▍                      | 165/1014 [00:04<00:25, 33.42batch/s] 17%|████▌                      | 170/1014 [00:05<00:25, 33.63batch/s] 17%|████▋                      | 175/1014 [00:05<00:25, 33.39batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 33.43batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 33.62batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 33.66batch/s] 19%|█████▏                     | 195/1014 [00:05<00:24, 33.66batch/s] 20%|█████▎                     | 200/1014 [00:05<00:24, 33.64batch/s] 20%|█████▍                     | 205/1014 [00:06<00:23, 33.86batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 33.90batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 33.88batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 33.93batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 34.05batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.14batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.17batch/s] 24%|██████▍                    | 240/1014 [00:07<00:22, 34.18batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.18batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.15batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 34.11batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 34.04batch/s] 26%|███████                    | 265/1014 [00:07<00:22, 33.95batch/s] 27%|███████▏                   | 270/1014 [00:08<00:22, 33.36batch/s] 27%|███████▎                   | 275/1014 [00:08<00:22, 33.36batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 33.44batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 33.50batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 33.56batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 33.55batch/s] 30%|███████▉                   | 300/1014 [00:08<00:21, 33.70batch/s] 30%|████████                   | 305/1014 [00:09<00:21, 33.71batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 33.71batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 33.65batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 33.53batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 33.58batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 33.46batch/s] 33%|████████▉                  | 335/1014 [00:10<00:20, 33.50batch/s] 34%|█████████                  | 340/1014 [00:10<00:20, 33.52batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 33.52batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 33.56batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 33.51batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 33.57batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:19, 33.55batch/s] 36%|█████████▊                 | 370/1014 [00:11<00:19, 33.59batch/s] 37%|█████████▉                 | 375/1014 [00:11<00:19, 33.62batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 33.63batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 33.68batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 33.72batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 33.65batch/s] 39%|██████████▋                | 400/1014 [00:11<00:18, 33.69batch/s] 40%|██████████▊                | 405/1014 [00:12<00:18, 33.67batch/s] 40%|██████████▉                | 410/1014 [00:12<00:17, 33.71batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 33.79batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 33.80batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.75batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 33.70batch/s] 43%|███████████▌               | 435/1014 [00:12<00:17, 33.66batch/s] 43%|███████████▋               | 440/1014 [00:13<00:17, 33.75batch/s] 44%|███████████▊               | 445/1014 [00:13<00:16, 33.79batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 33.83batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.89batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 33.81batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 33.72batch/s] 46%|████████████▌              | 470/1014 [00:13<00:16, 33.59batch/s] 47%|████████████▋              | 475/1014 [00:14<00:16, 33.53batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 33.61batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.57batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 33.58batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 33.60batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 33.55batch/s] 50%|█████████████▍             | 505/1014 [00:15<00:15, 33.63batch/s] 50%|█████████████▌             | 510/1014 [00:15<00:14, 33.60batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 33.65batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 33.73batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 33.78batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.81batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 33.76batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:14, 33.76batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 33.80batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 33.82batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 33.86batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.92batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 33.95batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 33.96batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.04batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 34.03batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 34.09batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.08batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.09batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 34.09batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.13batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.17batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.19batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 34.20batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.22batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.26batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 34.27batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.18batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.23batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.22batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 34.19batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.15batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.18batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 34.14batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.16batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.20batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 34.23batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 34.24batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.26batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.24batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 34.28batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.29batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.29batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.29batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.31batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.36batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.39batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.40batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.43batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.47batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.50batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 34.52batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.51batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.51batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.51batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.55batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.61batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.62batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.63batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.63batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.62batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.64batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.69batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.73batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.70batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.74batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.76batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.80batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.83batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.78batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.79batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.83batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 34.80batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.79batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.81batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.83batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.82batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.88batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.90batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 34.91batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 34.95batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.93batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.95batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.97batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.98batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.97batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.98batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 34.99batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.99batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 35.01batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.03batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 35.03batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.05batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.03batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 35.05batch/s] 97%|██████████████████████████ | 980/1014 [00:27<00:00, 35.04batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 35.02batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 35.03batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 35.01batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 35.02batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 35.03batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 35.06batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.06batch/s]
Validation 50 -> LOSS = 0.24
Validation 50 -> BLEU = 96.14, 98.2/96.7/95.5/94.2 (BP=1.000, ratio=1.005, hyp_len=14452, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 48
--> Best BLEU so far: 96.65 @ validation 48
Starting Epoch 51
Epoch 51 - update      24120 => loss:   0.146 (#OOM: 0)
Epoch 51 - update      24150 => loss:   0.062 (#OOM: 0)
Epoch 51 - update      24180 => loss:   0.047 (#OOM: 0)
Epoch 51 - update      24210 => loss:   0.055 (#OOM: 0)
Epoch 51 - update      24240 => loss:   0.073 (#OOM: 0)
Epoch 51 - update      24270 => loss:   0.091 (#OOM: 0)
Epoch 51 - update      24300 => loss:   0.059 (#OOM: 0)
Epoch 51 - update      24330 => loss:   0.100 (#OOM: 0)
Epoch 51 - update      24360 => loss:   0.054 (#OOM: 0)
Epoch 51 - update      24390 => loss:   0.063 (#OOM: 0)
Epoch 51 - update      24420 => loss:   0.151 (#OOM: 0)
Epoch 51 - update      24450 => loss:   0.079 (#OOM: 0)
Epoch 51 - update      24480 => loss:   0.087 (#OOM: 0)
Epoch 51 - update      24510 => loss:   0.058 (#OOM: 0)
Epoch 51 - update      24540 => loss:   0.077 (#OOM: 0)
Epoch 51 - update      24570 => loss:   0.114 (#OOM: 0)
--> Epoch 51 finished with mean loss 0.08885
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (672 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 15.82batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 16.16batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 16.32batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.39batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.92batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.68batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.86batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 11.41batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 11.90batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.20batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.16batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.72batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.06batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.76batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.84batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.83batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 38.84batch/s]  1%|▏                            | 8/1014 [00:00<00:32, 31.38batch/s]  1%|▎                           | 12/1014 [00:00<00:31, 32.01batch/s]  2%|▍                           | 16/1014 [00:00<00:30, 33.04batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 34.04batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.90batch/s]  3%|▊                           | 28/1014 [00:00<00:28, 34.72batch/s]  3%|▉                           | 32/1014 [00:00<00:28, 35.06batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 34.27batch/s]  4%|█                           | 40/1014 [00:01<00:28, 34.69batch/s]  4%|█▏                          | 44/1014 [00:01<00:28, 34.23batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 34.86batch/s]  5%|█▍                          | 54/1014 [00:01<00:27, 35.30batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 35.74batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 35.86batch/s]  7%|█▉                          | 69/1014 [00:01<00:26, 35.78batch/s]  7%|██                          | 74/1014 [00:02<00:26, 36.14batch/s]  8%|██▏                         | 79/1014 [00:02<00:25, 36.46batch/s]  8%|██▎                         | 84/1014 [00:02<00:25, 36.60batch/s]  9%|██▍                         | 89/1014 [00:02<00:25, 36.22batch/s]  9%|██▌                         | 94/1014 [00:02<00:25, 35.85batch/s] 10%|██▋                         | 99/1014 [00:02<00:25, 35.99batch/s] 10%|██▊                        | 104/1014 [00:02<00:25, 36.10batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 35.89batch/s] 11%|███                        | 114/1014 [00:03<00:25, 35.89batch/s] 12%|███▏                       | 119/1014 [00:03<00:24, 36.05batch/s] 12%|███▎                       | 124/1014 [00:03<00:24, 35.87batch/s] 13%|███▍                       | 129/1014 [00:03<00:24, 35.97batch/s] 13%|███▌                       | 134/1014 [00:03<00:24, 36.04batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 36.06batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 35.81batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 35.86batch/s] 15%|████                       | 154/1014 [00:04<00:23, 35.97batch/s] 16%|████▏                      | 159/1014 [00:04<00:23, 36.02batch/s] 16%|████▎                      | 164/1014 [00:04<00:23, 35.76batch/s] 17%|████▌                      | 169/1014 [00:04<00:23, 35.78batch/s] 17%|████▋                      | 174/1014 [00:04<00:23, 35.75batch/s] 18%|████▊                      | 179/1014 [00:04<00:23, 35.84batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.94batch/s] 19%|█████                      | 189/1014 [00:05<00:22, 36.13batch/s] 19%|█████▏                     | 194/1014 [00:05<00:22, 35.79batch/s] 20%|█████▎                     | 199/1014 [00:05<00:22, 35.80batch/s] 20%|█████▍                     | 204/1014 [00:05<00:22, 35.83batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.86batch/s] 21%|█████▋                     | 214/1014 [00:05<00:22, 35.80batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 35.68batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 35.61batch/s] 23%|██████                     | 229/1014 [00:06<00:21, 35.76batch/s] 23%|██████▏                    | 234/1014 [00:06<00:21, 35.82batch/s] 24%|██████▎                    | 239/1014 [00:06<00:21, 35.69batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.66batch/s] 25%|██████▋                    | 249/1014 [00:06<00:21, 35.74batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 35.62batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.50batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 35.61batch/s] 27%|███████▏                   | 269/1014 [00:07<00:20, 35.78batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.87batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 36.00batch/s] 28%|███████▌                   | 284/1014 [00:07<00:20, 36.14batch/s] 29%|███████▋                   | 289/1014 [00:07<00:20, 36.16batch/s] 29%|███████▊                   | 294/1014 [00:08<00:19, 36.13batch/s] 29%|███████▉                   | 299/1014 [00:08<00:19, 36.08batch/s] 30%|████████                   | 304/1014 [00:08<00:19, 36.06batch/s] 30%|████████▏                  | 309/1014 [00:08<00:19, 36.23batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 36.21batch/s] 31%|████████▍                  | 319/1014 [00:08<00:19, 36.18batch/s] 32%|████████▋                  | 324/1014 [00:08<00:19, 36.05batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.98batch/s] 33%|████████▉                  | 334/1014 [00:09<00:18, 36.01batch/s] 33%|█████████                  | 339/1014 [00:09<00:18, 36.08batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:18, 36.07batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.98batch/s] 35%|█████████▍                 | 354/1014 [00:09<00:18, 35.93batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.87batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.84batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:17, 35.85batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:17, 35.95batch/s] 37%|██████████                 | 379/1014 [00:10<00:17, 35.85batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.87batch/s] 38%|██████████▎                | 389/1014 [00:10<00:17, 35.88batch/s] 39%|██████████▍                | 394/1014 [00:10<00:17, 35.95batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.92batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.79batch/s] 40%|██████████▉                | 409/1014 [00:11<00:16, 35.81batch/s] 41%|███████████                | 414/1014 [00:11<00:16, 35.82batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.78batch/s] 42%|███████████▎               | 424/1014 [00:11<00:16, 35.84batch/s] 42%|███████████▍               | 429/1014 [00:11<00:16, 35.80batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.83batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.85batch/s] 44%|███████████▊               | 444/1014 [00:12<00:15, 35.72batch/s] 44%|███████████▉               | 449/1014 [00:12<00:15, 35.73batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.68batch/s] 45%|████████████▏              | 459/1014 [00:12<00:15, 35.67batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.63batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.52batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.45batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 35.43batch/s] 48%|████████████▉              | 484/1014 [00:13<00:14, 35.37batch/s] 48%|█████████████              | 489/1014 [00:13<00:14, 35.36batch/s] 49%|█████████████▏             | 494/1014 [00:13<00:14, 35.29batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.35batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 35.42batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.45batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.43batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:13, 35.38batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.44batch/s] 52%|██████████████             | 529/1014 [00:14<00:13, 35.51batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 35.48batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.51batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.53batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.54batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:12, 35.48batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.50batch/s] 56%|███████████████            | 564/1014 [00:15<00:12, 35.48batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.51batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.49batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.53batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.53batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:11, 35.53batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.55batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.52batch/s] 60%|████████████████           | 604/1014 [00:16<00:11, 35.58batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.59batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.62batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.64batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:10, 35.68batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.72batch/s] 63%|████████████████▉          | 634/1014 [00:17<00:10, 35.68batch/s] 63%|█████████████████          | 639/1014 [00:17<00:10, 35.69batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.67batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.64batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.62batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:09, 35.60batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.58batch/s] 66%|█████████████████▊         | 669/1014 [00:18<00:09, 35.58batch/s] 66%|█████████████████▉         | 674/1014 [00:18<00:09, 35.55batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.60batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.57batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.57batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:08, 35.58batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.60batch/s] 69%|██████████████████▋        | 704/1014 [00:19<00:08, 35.58batch/s] 70%|██████████████████▉        | 709/1014 [00:19<00:08, 35.52batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.50batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.52batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.48batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 35.41batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.46batch/s] 73%|███████████████████▋       | 739/1014 [00:20<00:07, 35.46batch/s] 73%|███████████████████▊       | 744/1014 [00:20<00:07, 35.44batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 35.48batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 35.48batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 35.52batch/s] 76%|████████████████████▍      | 768/1014 [00:21<00:06, 35.54batch/s] 76%|████████████████████▌      | 774/1014 [00:21<00:06, 35.56batch/s] 77%|████████████████████▊      | 780/1014 [00:21<00:06, 35.56batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 35.59batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 35.59batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 35.59batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.60batch/s] 80%|█████████████████████▌     | 810/1014 [00:22<00:05, 35.59batch/s] 80%|█████████████████████▋     | 816/1014 [00:22<00:05, 35.61batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 35.63batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 35.54batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.55batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.55batch/s] 83%|██████████████████████▌    | 846/1014 [00:23<00:04, 35.58batch/s] 84%|██████████████████████▋    | 852/1014 [00:23<00:04, 35.60batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 35.60batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.60batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.58batch/s] 86%|███████████████████████▎   | 876/1014 [00:24<00:03, 35.58batch/s] 87%|███████████████████████▍   | 882/1014 [00:24<00:03, 35.57batch/s] 88%|███████████████████████▋   | 888/1014 [00:24<00:03, 35.58batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.58batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.62batch/s] 89%|████████████████████████   | 906/1014 [00:25<00:03, 35.60batch/s] 90%|████████████████████████▎  | 912/1014 [00:25<00:02, 35.59batch/s] 91%|████████████████████████▍  | 918/1014 [00:25<00:02, 35.59batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.49batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 35.52batch/s] 92%|████████████████████████▉  | 936/1014 [00:26<00:02, 35.51batch/s] 93%|█████████████████████████  | 942/1014 [00:26<00:02, 35.51batch/s] 93%|█████████████████████████▏ | 948/1014 [00:26<00:01, 35.53batch/s] 94%|█████████████████████████▍ | 954/1014 [00:26<00:01, 35.52batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 35.52batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 35.52batch/s] 96%|█████████████████████████▉ | 972/1014 [00:27<00:01, 35.52batch/s] 96%|██████████████████████████ | 978/1014 [00:27<00:01, 35.51batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.48batch/s] 98%|██████████████████████████▎| 990/1014 [00:27<00:00, 35.50batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 35.51batch/s] 99%|█████████████████████████▋| 1002/1014 [00:28<00:00, 35.51batch/s] 99%|█████████████████████████▊| 1008/1014 [00:28<00:00, 35.51batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.52batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.51batch/s]
Validation 51 -> LOSS = 0.25
Validation 51 -> BLEU = 96.71, 98.7/97.2/96.1/94.9 (BP=1.000, ratio=1.000, hyp_len=14379, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 48
--> Best BLEU so far: 96.71 @ validation 51
Starting Epoch 52
Epoch 52 - update      24600 => loss:   0.064 (#OOM: 0)
Epoch 52 - update      24630 => loss:   0.128 (#OOM: 0)
Epoch 52 - update      24660 => loss:   0.083 (#OOM: 0)
Epoch 52 - update      24690 => loss:   0.067 (#OOM: 0)
Epoch 52 - update      24720 => loss:   0.022 (#OOM: 0)
Epoch 52 - update      24750 => loss:   0.092 (#OOM: 0)
Epoch 52 - update      24780 => loss:   0.092 (#OOM: 0)
Epoch 52 - update      24810 => loss:   0.076 (#OOM: 0)
Epoch 52 - update      24840 => loss:   0.066 (#OOM: 0)
Epoch 52 - update      24870 => loss:   0.088 (#OOM: 0)
Epoch 52 - update      24900 => loss:   0.043 (#OOM: 0)
Epoch 52 - update      24930 => loss:   0.088 (#OOM: 0)
Epoch 52 - update      24960 => loss:   0.083 (#OOM: 0)
Epoch 52 - update      24990 => loss:   0.090 (#OOM: 0)
Epoch 52 - update      25020 => loss:   0.069 (#OOM: 0)
Epoch 52 - update      25050 => loss:   0.082 (#OOM: 0)
--> Epoch 52 finished with mean loss 0.08812
--> Overhead/Training/Evaluation: 0.63/0.71/0.00 mins (total: 1.34 mins)   (678 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 13.42batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.12batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 13.47batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.32batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.61batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 14.52batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.93batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.58batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 14.00batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.80batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.77batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.96batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.96batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.96batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.56batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 35.75batch/s]  2%|▍                           | 16/1014 [00:00<00:28, 35.34batch/s]  2%|▌                           | 21/1014 [00:00<00:27, 36.10batch/s]  3%|▋                           | 26/1014 [00:00<00:28, 34.73batch/s]  3%|▊                           | 31/1014 [00:00<00:28, 34.10batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 33.88batch/s]  4%|█▏                          | 41/1014 [00:01<00:28, 34.17batch/s]  5%|█▎                          | 46/1014 [00:01<00:27, 34.99batch/s]  5%|█▍                          | 51/1014 [00:01<00:27, 34.70batch/s]  6%|█▌                          | 56/1014 [00:01<00:27, 34.50batch/s]  6%|█▋                          | 61/1014 [00:01<00:27, 34.52batch/s]  7%|█▊                          | 66/1014 [00:01<00:27, 34.98batch/s]  7%|█▉                          | 71/1014 [00:02<00:27, 34.82batch/s]  7%|██                          | 76/1014 [00:02<00:26, 35.04batch/s]  8%|██▏                         | 81/1014 [00:02<00:26, 35.29batch/s]  8%|██▎                         | 86/1014 [00:02<00:25, 35.77batch/s]  9%|██▌                         | 91/1014 [00:02<00:25, 35.51batch/s]  9%|██▋                         | 96/1014 [00:02<00:25, 35.76batch/s] 10%|██▋                        | 101/1014 [00:02<00:25, 35.69batch/s] 10%|██▊                        | 106/1014 [00:02<00:25, 35.77batch/s] 11%|██▉                        | 111/1014 [00:03<00:25, 35.56batch/s] 11%|███                        | 116/1014 [00:03<00:25, 35.66batch/s] 12%|███▏                       | 121/1014 [00:03<00:25, 35.31batch/s] 12%|███▎                       | 126/1014 [00:03<00:24, 35.54batch/s] 13%|███▍                       | 131/1014 [00:03<00:24, 35.65batch/s] 13%|███▌                       | 136/1014 [00:03<00:24, 35.56batch/s] 14%|███▊                       | 141/1014 [00:03<00:24, 35.53batch/s] 14%|███▉                       | 146/1014 [00:04<00:24, 35.81batch/s] 15%|████                       | 151/1014 [00:04<00:23, 36.11batch/s] 15%|████▏                      | 156/1014 [00:04<00:23, 35.84batch/s] 16%|████▎                      | 161/1014 [00:04<00:23, 35.89batch/s] 16%|████▍                      | 166/1014 [00:04<00:23, 35.98batch/s] 17%|████▌                      | 171/1014 [00:04<00:23, 35.89batch/s] 17%|████▋                      | 176/1014 [00:04<00:23, 35.95batch/s] 18%|████▊                      | 181/1014 [00:05<00:23, 35.83batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 35.79batch/s] 19%|█████                      | 191/1014 [00:05<00:22, 35.78batch/s] 19%|█████▏                     | 196/1014 [00:05<00:22, 35.82batch/s] 20%|█████▎                     | 201/1014 [00:05<00:22, 35.69batch/s] 20%|█████▍                     | 206/1014 [00:05<00:22, 35.66batch/s] 21%|█████▌                     | 211/1014 [00:05<00:22, 35.65batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 35.59batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 35.40batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 35.47batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 35.48batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 35.32batch/s] 24%|██████▍                    | 241/1014 [00:06<00:21, 35.30batch/s] 24%|██████▌                    | 246/1014 [00:06<00:21, 35.27batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 35.27batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 35.34batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 35.40batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 35.33batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 35.19batch/s] 27%|███████▎                   | 276/1014 [00:07<00:21, 35.13batch/s] 28%|███████▍                   | 281/1014 [00:07<00:20, 35.22batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 35.19batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 35.12batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 35.13batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 35.27batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 35.30batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 35.25batch/s] 31%|████████▍                  | 316/1014 [00:08<00:19, 35.34batch/s] 32%|████████▌                  | 321/1014 [00:09<00:19, 35.20batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 35.05batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 35.20batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 35.17batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 35.13batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:18, 35.17batch/s] 35%|█████████▎                 | 351/1014 [00:09<00:18, 35.16batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:18, 35.11batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 35.17batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 35.16batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 35.16batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 35.15batch/s] 38%|██████████▏                | 381/1014 [00:10<00:17, 35.17batch/s] 38%|██████████▎                | 386/1014 [00:10<00:17, 35.13batch/s] 39%|██████████▍                | 391/1014 [00:11<00:17, 35.15batch/s] 39%|██████████▌                | 396/1014 [00:11<00:17, 35.13batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 35.11batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 35.13batch/s] 41%|██████████▉                | 411/1014 [00:11<00:17, 34.99batch/s] 41%|███████████                | 416/1014 [00:11<00:17, 34.99batch/s] 42%|███████████▏               | 421/1014 [00:12<00:16, 34.90batch/s] 42%|███████████▎               | 426/1014 [00:12<00:16, 34.96batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 34.86batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 34.85batch/s] 43%|███████████▋               | 441/1014 [00:12<00:16, 34.86batch/s] 44%|███████████▉               | 446/1014 [00:12<00:16, 34.89batch/s] 44%|████████████               | 451/1014 [00:12<00:16, 34.94batch/s] 45%|████████████▏              | 456/1014 [00:13<00:15, 34.95batch/s] 45%|████████████▎              | 461/1014 [00:13<00:15, 34.97batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 34.97batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 34.95batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 35.02batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 35.07batch/s] 48%|████████████▉              | 486/1014 [00:13<00:15, 35.09batch/s] 48%|█████████████              | 491/1014 [00:13<00:14, 35.14batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 35.16batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:14, 35.17batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 35.12batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 35.10batch/s] 51%|█████████████▋             | 516/1014 [00:14<00:14, 35.09batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:14, 35.07batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 35.12batch/s] 52%|██████████████▏            | 531/1014 [00:15<00:13, 35.15batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 35.20batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 35.21batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 35.16batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 35.15batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:13, 35.15batch/s] 55%|██████████████▉            | 561/1014 [00:15<00:12, 35.13batch/s] 56%|███████████████            | 566/1014 [00:16<00:12, 35.04batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 35.01batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 35.00batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 35.00batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 35.01batch/s] 58%|███████████████▋           | 591/1014 [00:16<00:12, 34.99batch/s] 59%|███████████████▊           | 596/1014 [00:17<00:11, 34.98batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 34.98batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 34.95batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.97batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 34.99batch/s] 61%|████████████████▌          | 621/1014 [00:17<00:11, 34.96batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:11, 35.00batch/s] 62%|████████████████▊          | 631/1014 [00:18<00:10, 34.98batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:10, 35.02batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 35.01batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 34.97batch/s] 64%|█████████████████▎         | 651/1014 [00:18<00:10, 35.00batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 35.06batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:10, 35.08batch/s] 66%|█████████████████▋         | 666/1014 [00:18<00:09, 35.11batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 35.06batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 35.12batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 35.05batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 35.01batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 35.03batch/s] 69%|██████████████████▌        | 696/1014 [00:19<00:09, 35.06batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:08, 35.04batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 35.00batch/s] 70%|██████████████████▉        | 711/1014 [00:20<00:08, 34.99batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 35.06batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 35.08batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 35.07batch/s] 72%|███████████████████▍       | 731/1014 [00:20<00:08, 35.09batch/s] 73%|███████████████████▌       | 736/1014 [00:20<00:07, 35.09batch/s] 73%|███████████████████▋       | 741/1014 [00:21<00:07, 35.08batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 35.06batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 35.05batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 35.05batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 35.02batch/s] 76%|████████████████████▍      | 766/1014 [00:21<00:07, 35.04batch/s] 76%|████████████████████▌      | 771/1014 [00:21<00:06, 35.06batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 35.09batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.13batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 35.17batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 35.17batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 35.17batch/s] 79%|█████████████████████▎     | 801/1014 [00:22<00:06, 35.22batch/s] 79%|█████████████████████▍     | 806/1014 [00:22<00:05, 35.15batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 35.14batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 35.16batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 35.15batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 35.08batch/s] 82%|██████████████████████▏    | 831/1014 [00:23<00:05, 35.11batch/s] 82%|██████████████████████▎    | 836/1014 [00:23<00:05, 35.08batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.11batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 35.17batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 35.16batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 35.18batch/s] 85%|██████████████████████▉    | 861/1014 [00:24<00:04, 35.21batch/s] 85%|███████████████████████    | 866/1014 [00:24<00:04, 35.19batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.18batch/s] 86%|███████████████████████▎   | 876/1014 [00:24<00:03, 35.22batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 35.21batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 35.19batch/s] 88%|███████████████████████▋   | 891/1014 [00:25<00:03, 35.17batch/s] 88%|███████████████████████▊   | 896/1014 [00:25<00:03, 35.17batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.17batch/s] 89%|████████████████████████   | 906/1014 [00:25<00:03, 35.17batch/s] 90%|████████████████████████▎  | 911/1014 [00:25<00:02, 35.15batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 35.19batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 35.21batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 35.24batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.18batch/s] 92%|████████████████████████▉  | 936/1014 [00:26<00:02, 35.17batch/s] 93%|█████████████████████████  | 941/1014 [00:26<00:02, 35.16batch/s] 93%|█████████████████████████▏ | 946/1014 [00:26<00:01, 35.15batch/s] 94%|█████████████████████████▎ | 951/1014 [00:27<00:01, 35.12batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 35.16batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.16batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 35.15batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 35.15batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 35.16batch/s] 97%|██████████████████████████ | 981/1014 [00:27<00:00, 35.18batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 35.18batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 35.19batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 35.20batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 35.20batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 35.21batch/s]100%|█████████████████████████▉| 1011/1014 [00:28<00:00, 35.19batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.19batch/s]
Validation 52 -> LOSS = 0.25
Validation 52 -> BLEU = 96.66, 98.6/97.2/96.1/94.8 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 48
--> Best BLEU so far: 96.71 @ validation 51
Starting Epoch 53
Epoch 53 - update      25080 => loss:   0.121 (#OOM: 0)
Epoch 53 - update      25110 => loss:   0.083 (#OOM: 0)
Epoch 53 - update      25140 => loss:   0.057 (#OOM: 0)
Epoch 53 - update      25170 => loss:   0.048 (#OOM: 0)
Epoch 53 - update      25200 => loss:   0.072 (#OOM: 0)
Epoch 53 - update      25230 => loss:   0.082 (#OOM: 0)
Epoch 53 - update      25260 => loss:   0.101 (#OOM: 0)
Epoch 53 - update      25290 => loss:   0.063 (#OOM: 0)
Epoch 53 - update      25320 => loss:   0.072 (#OOM: 0)
Epoch 53 - update      25350 => loss:   0.093 (#OOM: 0)
Epoch 53 - update      25380 => loss:   0.077 (#OOM: 0)
Epoch 53 - update      25410 => loss:   0.085 (#OOM: 0)
Epoch 53 - update      25440 => loss:   0.046 (#OOM: 0)
Epoch 53 - update      25470 => loss:   0.091 (#OOM: 0)
Epoch 53 - update      25500 => loss:   0.085 (#OOM: 0)
Epoch 53 - update      25530 => loss:   0.065 (#OOM: 0)
--> Epoch 53 finished with mean loss 0.08627
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (670 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.77batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.59batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 13.53batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.55batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.51batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.50batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 14.14batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.68batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.67batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.63batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.58batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.08batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.07batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.63batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 35.08batch/s]  1%|▎                           | 13/1014 [00:00<00:28, 35.47batch/s]  2%|▍                           | 18/1014 [00:00<00:28, 34.92batch/s]  2%|▋                           | 23/1014 [00:00<00:28, 35.27batch/s]  3%|▊                           | 28/1014 [00:00<00:27, 35.87batch/s]  3%|▉                           | 33/1014 [00:00<00:26, 36.79batch/s]  4%|█                           | 38/1014 [00:01<00:25, 37.55batch/s]  4%|█▏                          | 43/1014 [00:01<00:25, 37.61batch/s]  5%|█▎                          | 48/1014 [00:01<00:25, 38.27batch/s]  5%|█▍                          | 53/1014 [00:01<00:25, 37.30batch/s]  6%|█▌                          | 58/1014 [00:01<00:25, 37.33batch/s]  6%|█▋                          | 63/1014 [00:01<00:25, 37.38batch/s]  7%|█▉                          | 68/1014 [00:01<00:25, 36.84batch/s]  7%|██                          | 73/1014 [00:01<00:25, 36.67batch/s]  8%|██▏                         | 78/1014 [00:02<00:26, 35.60batch/s]  8%|██▎                         | 83/1014 [00:02<00:26, 35.76batch/s]  9%|██▍                         | 88/1014 [00:02<00:25, 36.23batch/s]  9%|██▌                         | 93/1014 [00:02<00:25, 36.42batch/s] 10%|██▋                         | 98/1014 [00:02<00:25, 35.85batch/s] 10%|██▋                        | 103/1014 [00:02<00:25, 36.10batch/s] 11%|██▉                        | 108/1014 [00:02<00:25, 36.22batch/s] 11%|███                        | 113/1014 [00:03<00:24, 36.44batch/s] 12%|███▏                       | 118/1014 [00:03<00:24, 36.43batch/s] 12%|███▎                       | 123/1014 [00:03<00:24, 36.13batch/s] 13%|███▍                       | 128/1014 [00:03<00:24, 36.09batch/s] 13%|███▌                       | 133/1014 [00:03<00:24, 36.10batch/s] 14%|███▋                       | 138/1014 [00:03<00:24, 36.40batch/s] 14%|███▊                       | 143/1014 [00:03<00:23, 36.42batch/s] 15%|███▉                       | 148/1014 [00:04<00:23, 36.59batch/s] 15%|████                       | 153/1014 [00:04<00:23, 36.48batch/s] 16%|████▏                      | 158/1014 [00:04<00:23, 36.20batch/s] 16%|████▎                      | 163/1014 [00:04<00:23, 36.24batch/s] 17%|████▍                      | 168/1014 [00:04<00:23, 36.13batch/s] 17%|████▌                      | 173/1014 [00:04<00:23, 36.14batch/s] 18%|████▋                      | 178/1014 [00:04<00:23, 36.13batch/s] 18%|████▊                      | 183/1014 [00:05<00:23, 36.13batch/s] 19%|█████                      | 188/1014 [00:05<00:22, 36.15batch/s] 19%|█████▏                     | 193/1014 [00:05<00:22, 36.17batch/s] 20%|█████▎                     | 198/1014 [00:05<00:22, 36.32batch/s] 20%|█████▍                     | 203/1014 [00:05<00:22, 36.29batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 36.28batch/s] 21%|█████▋                     | 213/1014 [00:05<00:22, 36.19batch/s] 21%|█████▊                     | 218/1014 [00:05<00:21, 36.34batch/s] 22%|█████▉                     | 223/1014 [00:06<00:21, 36.46batch/s] 22%|██████                     | 228/1014 [00:06<00:21, 36.47batch/s] 23%|██████▏                    | 233/1014 [00:06<00:21, 36.49batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 36.23batch/s] 24%|██████▍                    | 243/1014 [00:06<00:21, 36.03batch/s] 24%|██████▌                    | 248/1014 [00:06<00:21, 35.88batch/s] 25%|██████▋                    | 253/1014 [00:07<00:21, 35.93batch/s] 25%|██████▊                    | 258/1014 [00:07<00:21, 35.94batch/s] 26%|███████                    | 263/1014 [00:07<00:20, 35.89batch/s] 26%|███████▏                   | 268/1014 [00:07<00:20, 35.72batch/s] 27%|███████▎                   | 273/1014 [00:07<00:20, 35.73batch/s] 27%|███████▍                   | 278/1014 [00:07<00:20, 35.70batch/s] 28%|███████▌                   | 283/1014 [00:07<00:20, 35.77batch/s] 28%|███████▋                   | 288/1014 [00:08<00:20, 35.77batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 35.80batch/s] 29%|███████▉                   | 298/1014 [00:08<00:19, 35.83batch/s] 30%|████████                   | 303/1014 [00:08<00:19, 35.94batch/s] 30%|████████▏                  | 308/1014 [00:08<00:19, 36.00batch/s] 31%|████████▎                  | 313/1014 [00:08<00:19, 35.93batch/s] 31%|████████▍                  | 318/1014 [00:08<00:19, 35.68batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.62batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 35.59batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 35.49batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 35.48batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:18, 35.56batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:18, 35.69batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:18, 35.71batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 35.74batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 35.75batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 35.74batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 35.60batch/s] 37%|██████████                 | 378/1014 [00:10<00:17, 35.58batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 35.48batch/s] 38%|██████████▎                | 388/1014 [00:10<00:17, 35.53batch/s] 39%|██████████▍                | 393/1014 [00:11<00:17, 35.46batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 35.47batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 35.26batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 35.21batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 35.15batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 35.20batch/s] 42%|███████████▎               | 423/1014 [00:12<00:16, 35.22batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 35.13batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 35.11batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 34.92batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.91batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 34.94batch/s] 45%|████████████               | 453/1014 [00:12<00:16, 34.99batch/s] 45%|████████████▏              | 458/1014 [00:13<00:15, 35.04batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 34.97batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 34.98batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.98batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 35.02batch/s] 48%|████████████▊              | 483/1014 [00:13<00:15, 35.04batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 35.08batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:14, 35.10batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 35.13batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.04batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.03batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 35.02batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:14, 35.08batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:14, 35.05batch/s] 52%|██████████████             | 528/1014 [00:15<00:13, 34.96batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 34.96batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 34.92batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.95batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 34.99batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 34.96batch/s] 55%|██████████████▊            | 558/1014 [00:15<00:13, 34.96batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:12, 34.97batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 35.00batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.99batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 34.97batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.04batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 35.00batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:12, 34.96batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:11, 34.98batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 35.04batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.08batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.12batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 35.12batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 35.13batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:10, 35.19batch/s] 62%|████████████████▊          | 633/1014 [00:17<00:10, 35.19batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.19batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.22batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 35.18batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 35.19batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 35.18batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:09, 35.19batch/s] 66%|█████████████████▊         | 668/1014 [00:18<00:09, 35.17batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.17batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 35.12batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 35.19batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.24batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:09, 35.19batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.15batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 35.19batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 35.17batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 35.20batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.20batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 35.17batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.19batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:07, 35.18batch/s] 73%|███████████████████▋       | 738/1014 [00:20<00:07, 35.15batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 35.18batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.14batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 35.15batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.16batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.17batch/s] 76%|████████████████████▍      | 768/1014 [00:21<00:06, 35.18batch/s] 76%|████████████████████▌      | 773/1014 [00:21<00:06, 35.22batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 35.22batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 35.21batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 35.19batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.19batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 35.21batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:05, 35.24batch/s] 80%|█████████████████████▌     | 808/1014 [00:22<00:05, 35.23batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 35.23batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 35.23batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.19batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 35.18batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.20batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:04, 35.25batch/s] 83%|██████████████████████▍    | 843/1014 [00:23<00:04, 35.25batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 35.25batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.24batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 35.27batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 35.27batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 35.21batch/s] 86%|███████████████████████▏   | 873/1014 [00:24<00:04, 35.13batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 35.11batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 35.10batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 35.11batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 35.11batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 35.11batch/s] 89%|████████████████████████   | 903/1014 [00:25<00:03, 35.14batch/s] 90%|████████████████████████▏  | 908/1014 [00:25<00:03, 35.13batch/s] 90%|████████████████████████▎  | 913/1014 [00:25<00:02, 35.12batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 35.16batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 35.20batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 35.20batch/s] 92%|████████████████████████▊  | 933/1014 [00:26<00:02, 35.21batch/s] 93%|████████████████████████▉  | 938/1014 [00:26<00:02, 35.24batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.21batch/s] 93%|█████████████████████████▏ | 948/1014 [00:26<00:01, 35.23batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 35.22batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 35.24batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 35.26batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 35.25batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.19batch/s] 96%|██████████████████████████ | 978/1014 [00:27<00:01, 35.19batch/s] 97%|██████████████████████████▏| 983/1014 [00:27<00:00, 35.21batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 35.22batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 35.21batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 35.24batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.21batch/s] 99%|█████████████████████████▊| 1008/1014 [00:28<00:00, 35.19batch/s]100%|█████████████████████████▉| 1013/1014 [00:28<00:00, 35.21batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.20batch/s]
Validation 53 -> LOSS = 0.25
Validation 53 -> BLEU = 96.64, 98.6/97.2/96.0/94.8 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 48
--> Best BLEU so far: 96.71 @ validation 51
Starting Epoch 54
Epoch 54 - update      25560 => loss:   0.057 (#OOM: 0)
Epoch 54 - update      25590 => loss:   0.061 (#OOM: 0)
Epoch 54 - update      25620 => loss:   0.060 (#OOM: 0)
Epoch 54 - update      25650 => loss:   0.095 (#OOM: 0)
Epoch 54 - update      25680 => loss:   0.103 (#OOM: 0)
Epoch 54 - update      25710 => loss:   0.079 (#OOM: 0)
Epoch 54 - update      25740 => loss:   0.083 (#OOM: 0)
Epoch 54 - update      25770 => loss:   0.128 (#OOM: 0)
Epoch 54 - update      25800 => loss:   0.087 (#OOM: 0)
Epoch 54 - update      25830 => loss:   0.076 (#OOM: 0)
Epoch 54 - update      25860 => loss:   0.058 (#OOM: 0)
Epoch 54 - update      25890 => loss:   0.079 (#OOM: 0)
Epoch 54 - update      25920 => loss:   0.094 (#OOM: 0)
Epoch 54 - update      25950 => loss:   0.062 (#OOM: 0)
Epoch 54 - update      25980 => loss:   0.112 (#OOM: 0)
Epoch 54 - update      26010 => loss:   0.095 (#OOM: 0)
--> Epoch 54 finished with mean loss 0.08623
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (671 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:01, 19.10batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 14.83batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.83batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.02batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 13.81batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.26batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.84batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.95batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 12.80batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.11batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.70batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.57batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:21, 46.24batch/s]  1%|▎                           | 10/1014 [00:00<00:25, 39.50batch/s]  1%|▍                           | 15/1014 [00:00<00:25, 38.49batch/s]  2%|▌                           | 20/1014 [00:00<00:25, 38.27batch/s]  2%|▋                           | 25/1014 [00:00<00:26, 37.56batch/s]  3%|▊                           | 30/1014 [00:00<00:26, 37.43batch/s]  3%|▉                           | 35/1014 [00:00<00:26, 36.45batch/s]  4%|█                           | 40/1014 [00:01<00:26, 37.07batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 36.81batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.58batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.56batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.63batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 36.46batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 35.96batch/s]  7%|██                          | 75/1014 [00:02<00:26, 36.04batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.91batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.11batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 36.37batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 36.34batch/s] 10%|██▋                        | 100/1014 [00:02<00:24, 36.58batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 36.69batch/s] 11%|██▉                        | 110/1014 [00:03<00:24, 36.56batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.67batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 36.23batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 36.10batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 36.31batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 36.13batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 36.21batch/s] 14%|███▊                       | 145/1014 [00:03<00:23, 36.26batch/s] 15%|███▉                       | 150/1014 [00:04<00:23, 36.39batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 35.96batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 35.95batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 35.66batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 35.08batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.87batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 34.85batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 34.92batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.87batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.98batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 35.03batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.78batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.64batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.62batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 34.58batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.63batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.75batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.61batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.56batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.73batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 34.82batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 34.87batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.90batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.67batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.74batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.73batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.75batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 34.88batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.95batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.86batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.85batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.87batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.84batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.92batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 34.88batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.87batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.87batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.87batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.86batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 34.79batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.80batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 34.73batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.64batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.67batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.67batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.65batch/s] 37%|██████████                 | 380/1014 [00:10<00:18, 34.74batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.73batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 34.70batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.71batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.77batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.85batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.90batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 34.93batch/s] 41%|███████████▏               | 420/1014 [00:12<00:16, 34.97batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 34.98batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.94batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.98batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.01batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.03batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 35.02batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.93batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 34.89batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.91batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.87batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.83batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.87batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.81batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.87batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 34.86batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.90batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.83batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.88batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.84batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 34.82batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.73batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 34.70batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.70batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.63batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.69batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.66batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.60batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.56batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 34.55batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.56batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.56batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.52batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.53batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.54batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.50batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.53batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.56batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.57batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.55batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.60batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.65batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.62batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.58batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.55batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.52batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.49batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.50batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.50batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.47batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.50batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.50batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.49batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.49batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 34.45batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.48batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.54batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.55batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.53batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.54batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.59batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.61batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.64batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.64batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.68batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.71batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.69batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.66batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.67batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.67batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.70batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.68batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.66batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.64batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.66batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.62batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.59batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.52batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.53batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.55batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.56batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.58batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.59batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.54batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.53batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.52batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.52batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.52batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.53batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.53batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.50batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.51batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.53batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.51batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.50batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.52batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.52batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.47batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.47batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.46batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.45batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.49batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.52batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.53batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.50batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.53batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.50batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.48batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.48batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.50batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.51batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.51batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.51batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.48batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.49batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.46batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.47batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.50batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.49batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.51batch/s]
Validation 54 -> LOSS = 0.24
Validation 54 -> BLEU = 96.70, 98.7/97.3/96.1/94.9 (BP=1.000, ratio=1.000, hyp_len=14379, ref_len=14382)
** Learning rate changed -> 0.0002
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 48
--> Best BLEU so far: 96.71 @ validation 51
Starting Epoch 55
Epoch 55 - update      26040 => loss:   0.074 (#OOM: 0)
Epoch 55 - update      26070 => loss:   0.081 (#OOM: 0)
Epoch 55 - update      26100 => loss:   0.036 (#OOM: 0)
Epoch 55 - update      26130 => loss:   0.126 (#OOM: 0)
Epoch 55 - update      26160 => loss:   0.088 (#OOM: 0)
Epoch 55 - update      26190 => loss:   0.042 (#OOM: 0)
Epoch 55 - update      26220 => loss:   0.045 (#OOM: 0)
Epoch 55 - update      26250 => loss:   0.037 (#OOM: 0)
Epoch 55 - update      26280 => loss:   0.069 (#OOM: 0)
Epoch 55 - update      26310 => loss:   0.080 (#OOM: 0)
Epoch 55 - update      26340 => loss:   0.027 (#OOM: 0)
Epoch 55 - update      26370 => loss:   0.065 (#OOM: 0)
Epoch 55 - update      26400 => loss:   0.074 (#OOM: 0)
Epoch 55 - update      26430 => loss:   0.043 (#OOM: 0)
Epoch 55 - update      26460 => loss:   0.037 (#OOM: 0)
Epoch 55 - update      26490 => loss:   0.066 (#OOM: 0)
--> Epoch 55 finished with mean loss 0.07816
--> Overhead/Training/Evaluation: 0.60/0.72/0.00 mins (total: 1.32 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 19.36batch/s] 15%|████▌                          | 5/34 [00:00<00:01, 15.75batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.88batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.49batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.06batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.46batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.52batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.50batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.14batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 14.06batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.99batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.26batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:50, 20.21batch/s]  1%|▏                            | 6/1014 [00:00<00:48, 20.74batch/s]  1%|▎                           | 10/1014 [00:00<00:39, 25.40batch/s]  1%|▍                           | 14/1014 [00:00<00:37, 26.79batch/s]  2%|▌                           | 19/1014 [00:00<00:33, 29.32batch/s]  2%|▋                           | 24/1014 [00:00<00:32, 30.68batch/s]  3%|▊                           | 29/1014 [00:00<00:31, 31.75batch/s]  3%|▉                           | 34/1014 [00:01<00:31, 30.82batch/s]  4%|█                           | 39/1014 [00:01<00:30, 32.09batch/s]  4%|█▏                          | 44/1014 [00:01<00:29, 32.40batch/s]  5%|█▎                          | 49/1014 [00:01<00:29, 32.56batch/s]  5%|█▍                          | 54/1014 [00:01<00:29, 32.09batch/s]  6%|█▋                          | 59/1014 [00:01<00:29, 31.90batch/s]  6%|█▊                          | 64/1014 [00:01<00:29, 32.30batch/s]  7%|█▉                          | 69/1014 [00:02<00:29, 32.46batch/s]  7%|██                          | 74/1014 [00:02<00:29, 32.37batch/s]  8%|██▏                         | 79/1014 [00:02<00:28, 32.68batch/s]  8%|██▎                         | 84/1014 [00:02<00:28, 32.36batch/s]  9%|██▍                         | 89/1014 [00:02<00:28, 32.78batch/s]  9%|██▌                         | 94/1014 [00:02<00:28, 32.81batch/s] 10%|██▋                         | 99/1014 [00:03<00:28, 32.51batch/s] 10%|██▊                        | 104/1014 [00:03<00:27, 32.52batch/s] 11%|██▉                        | 109/1014 [00:03<00:27, 32.54batch/s] 11%|███                        | 114/1014 [00:03<00:27, 32.60batch/s] 12%|███▏                       | 119/1014 [00:03<00:27, 32.68batch/s] 12%|███▎                       | 124/1014 [00:03<00:27, 32.81batch/s] 13%|███▍                       | 129/1014 [00:03<00:26, 32.94batch/s] 13%|███▌                       | 134/1014 [00:04<00:26, 33.06batch/s] 14%|███▋                       | 139/1014 [00:04<00:26, 33.11batch/s] 14%|███▊                       | 144/1014 [00:04<00:26, 33.25batch/s] 15%|███▉                       | 149/1014 [00:04<00:26, 33.21batch/s] 15%|████                       | 154/1014 [00:04<00:25, 33.34batch/s] 16%|████▏                      | 159/1014 [00:04<00:25, 33.69batch/s] 16%|████▎                      | 164/1014 [00:04<00:25, 33.67batch/s] 17%|████▌                      | 169/1014 [00:05<00:25, 33.65batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 33.79batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 33.65batch/s] 18%|████▉                      | 184/1014 [00:05<00:24, 33.89batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 34.02batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 34.07batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.07batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.04batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 33.95batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.04batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 33.94batch/s] 22%|█████▉                     | 224/1014 [00:06<00:23, 33.96batch/s] 23%|██████                     | 229/1014 [00:06<00:23, 33.88batch/s] 23%|██████▏                    | 234/1014 [00:06<00:23, 33.89batch/s] 24%|██████▎                    | 239/1014 [00:07<00:22, 33.97batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.05batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 34.12batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 34.25batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.34batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.41batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.53batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 34.46batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.32batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 34.32batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.34batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.42batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.21batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.35batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 34.39batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.48batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.54batch/s] 32%|████████▋                  | 324/1014 [00:09<00:20, 34.49batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.47batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 34.48batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.45batch/s] 34%|█████████▏                 | 344/1014 [00:10<00:19, 34.38batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.41batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 34.50batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 34.53batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.59batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.69batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.69batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 34.73batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.76batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 34.77batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 34.77batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.68batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.62batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.51batch/s] 41%|███████████                | 414/1014 [00:12<00:17, 34.46batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.47batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 34.49batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.47batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.53batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.57batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.55batch/s] 44%|███████████▉               | 449/1014 [00:13<00:16, 34.52batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.60batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.55batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.57batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.58batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.53batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.56batch/s] 48%|████████████▉              | 484/1014 [00:14<00:15, 34.54batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.55batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:15, 34.56batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.60batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.63batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.66batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.67batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 34.70batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.76batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.70batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.69batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.73batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.79batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.80batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.84batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.87batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.86batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.85batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.88batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.87batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.88batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.88batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.91batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.93batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.00batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.03batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.05batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.06batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 35.09batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.13batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 35.16batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 35.18batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.18batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.18batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.19batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.15batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.15batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 35.20batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.17batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.17batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.23batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.27batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.28batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.34batch/s] 69%|██████████████████▋        | 704/1014 [00:19<00:08, 35.35batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.30batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.33batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.33batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.29batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 35.33batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.33batch/s] 73%|███████████████████▋       | 739/1014 [00:20<00:07, 35.28batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 35.28batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.30batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.32batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.32batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.31batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.31batch/s] 76%|████████████████████▌      | 774/1014 [00:21<00:06, 35.21batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.24batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.23batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.22batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.24batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.27batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.26batch/s] 80%|█████████████████████▌     | 809/1014 [00:22<00:05, 35.28batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.29batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.28batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.29batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.31batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.29batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.23batch/s] 83%|██████████████████████▍    | 844/1014 [00:23<00:04, 35.25batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 35.24batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.28batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.27batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.28batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.27batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.27batch/s] 87%|███████████████████████▍   | 879/1014 [00:24<00:03, 35.32batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 35.34batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.37batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.37batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.36batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.37batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.39batch/s] 90%|████████████████████████▎  | 914/1014 [00:25<00:02, 35.42batch/s] 91%|████████████████████████▍  | 919/1014 [00:25<00:02, 35.43batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.46batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.48batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.45batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 35.43batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.40batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.41batch/s] 94%|█████████████████████████▍ | 954/1014 [00:26<00:01, 35.38batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.41batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 35.39batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 35.34batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 35.29batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.32batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.28batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.27batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.26batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.27batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 35.26batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.29batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.31batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.31batch/s]
Validation 55 -> LOSS = 0.24
Validation 55 -> BLEU = 96.79, 98.7/97.4/96.3/95.1 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 55
--> Best BLEU so far: 96.79 @ validation 55
Starting Epoch 56
Epoch 56 - update      26520 => loss:   0.046 (#OOM: 0)
Epoch 56 - update      26550 => loss:   0.077 (#OOM: 0)
Epoch 56 - update      26580 => loss:   0.031 (#OOM: 0)
Epoch 56 - update      26610 => loss:   0.036 (#OOM: 0)
Epoch 56 - update      26640 => loss:   0.091 (#OOM: 0)
Epoch 56 - update      26670 => loss:   0.065 (#OOM: 0)
Epoch 56 - update      26700 => loss:   0.067 (#OOM: 0)
Epoch 56 - update      26730 => loss:   0.043 (#OOM: 0)
Epoch 56 - update      26760 => loss:   0.068 (#OOM: 0)
Epoch 56 - update      26790 => loss:   0.068 (#OOM: 0)
Epoch 56 - update      26820 => loss:   0.068 (#OOM: 0)
Epoch 56 - update      26850 => loss:   0.091 (#OOM: 0)
Epoch 56 - update      26880 => loss:   0.108 (#OOM: 0)
Epoch 56 - update      26910 => loss:   0.057 (#OOM: 0)
Epoch 56 - update      26940 => loss:   0.073 (#OOM: 0)
Epoch 56 - update      26970 => loss:   0.092 (#OOM: 0)
--> Epoch 56 finished with mean loss 0.07144
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.65batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 10.68batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.50batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.47batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.75batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.00batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.50batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.87batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.28batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 14.38batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 14.45batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 14.15batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 14.28batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.45batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.19batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:33, 30.54batch/s]  1%|▎                            | 9/1014 [00:00<00:28, 35.77batch/s]  1%|▍                           | 14/1014 [00:00<00:27, 36.52batch/s]  2%|▌                           | 19/1014 [00:00<00:27, 36.73batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 35.36batch/s]  3%|▊                           | 29/1014 [00:00<00:26, 37.20batch/s]  3%|▉                           | 34/1014 [00:00<00:26, 36.53batch/s]  4%|█                           | 39/1014 [00:01<00:26, 36.18batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.81batch/s]  5%|█▎                          | 49/1014 [00:01<00:26, 35.80batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 35.76batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 35.77batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 35.69batch/s]  7%|█▉                          | 69/1014 [00:01<00:26, 35.04batch/s]  7%|██                          | 74/1014 [00:02<00:26, 35.15batch/s]  8%|██▏                         | 79/1014 [00:02<00:26, 35.53batch/s]  8%|██▎                         | 84/1014 [00:02<00:25, 36.06batch/s]  9%|██▍                         | 89/1014 [00:02<00:25, 35.79batch/s]  9%|██▌                         | 94/1014 [00:02<00:25, 35.88batch/s] 10%|██▋                         | 99/1014 [00:02<00:25, 35.79batch/s] 10%|██▊                        | 104/1014 [00:02<00:25, 35.41batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 35.89batch/s] 11%|███                        | 114/1014 [00:03<00:25, 35.78batch/s] 12%|███▏                       | 119/1014 [00:03<00:25, 35.50batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 35.06batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.98batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.86batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 34.72batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 34.93batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 34.64batch/s] 15%|████                       | 154/1014 [00:04<00:24, 34.71batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.68batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.74batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.82batch/s] 17%|████▋                      | 174/1014 [00:04<00:23, 35.07batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 34.90batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.02batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 34.92batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 35.00batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 35.06batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 35.16batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.00batch/s] 21%|█████▋                     | 214/1014 [00:06<00:22, 34.96batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 34.93batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 35.03batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 35.06batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 35.22batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 35.14batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.12batch/s] 25%|██████▋                    | 249/1014 [00:07<00:21, 35.15batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 35.15batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.95batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.92batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.93batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 34.98batch/s] 28%|███████▍                   | 279/1014 [00:07<00:21, 34.90batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 34.93batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 35.02batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.09batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.06batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.02batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 35.11batch/s] 31%|████████▎                  | 314/1014 [00:08<00:20, 34.98batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 35.06batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.08batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.16batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.18batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.25batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 35.20batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.14batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 35.05batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.07batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.04batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.84batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.84batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 34.85batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.83batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 34.86batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 34.91batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.95batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.90batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.93batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 34.89batch/s] 41%|███████████▏               | 419/1014 [00:11<00:17, 34.94batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.01batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.06batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.09batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.11batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.98batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.93batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.89batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 34.86batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.94batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.96batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.02batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.93batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.89batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.86batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 34.89batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.90batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.91batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.92batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.97batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 34.94batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.93batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.88batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.84batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.88batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.86batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.89batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.94batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.93batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.96batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.95batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.94batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.90batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.93batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.92batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:12, 34.99batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.95batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.95batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.99batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.97batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.95batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.99batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.94batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.98batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 35.01batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.06batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.05batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.01batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.00batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:10, 34.99batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.92batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.91batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.92batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.90batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.94batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.98batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.93batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.97batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.96batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.00batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.02batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.03batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 35.04batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.07batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 35.11batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 35.12batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.12batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.09batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.11batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.13batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.17batch/s] 76%|████████████████████▌      | 774/1014 [00:21<00:06, 35.20batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.22batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.20batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.21batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.19batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.21batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.19batch/s] 80%|█████████████████████▌     | 809/1014 [00:22<00:05, 35.20batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.21batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.24batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.20batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.24batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.22batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.24batch/s] 83%|██████████████████████▍    | 844/1014 [00:23<00:04, 35.26batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 35.25batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.17batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.16batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.19batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.22batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.19batch/s] 87%|███████████████████████▍   | 879/1014 [00:24<00:03, 35.17batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 35.19batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.22batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.23batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.24batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.25batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.27batch/s] 90%|████████████████████████▎  | 914/1014 [00:25<00:02, 35.26batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.30batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.34batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.37batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.36batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 35.36batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.33batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.35batch/s] 94%|█████████████████████████▍ | 954/1014 [00:26<00:01, 35.38batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.40batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 35.37batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 35.38batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 35.36batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.40batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.41batch/s] 98%|██████████████████████████▎| 989/1014 [00:27<00:00, 35.45batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.45batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.48batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 35.48batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.44batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.42batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.42batch/s]
Validation 56 -> LOSS = 0.24
Validation 56 -> BLEU = 96.86, 98.7/97.4/96.3/95.2 (BP=1.000, ratio=1.000, hyp_len=14377, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 55
--> Best BLEU so far: 96.86 @ validation 56
Starting Epoch 57
Epoch 57 - update      27000 => loss:   0.071 (#OOM: 0)
Epoch 57 - update      27030 => loss:   0.067 (#OOM: 0)
Epoch 57 - update      27060 => loss:   0.094 (#OOM: 0)
Epoch 57 - update      27090 => loss:   0.046 (#OOM: 0)
Epoch 57 - update      27120 => loss:   0.037 (#OOM: 0)
Epoch 57 - update      27150 => loss:   0.085 (#OOM: 0)
Epoch 57 - update      27180 => loss:   0.088 (#OOM: 0)
Epoch 57 - update      27210 => loss:   0.051 (#OOM: 0)
Epoch 57 - update      27240 => loss:   0.047 (#OOM: 0)
Epoch 57 - update      27270 => loss:   0.103 (#OOM: 0)
Epoch 57 - update      27300 => loss:   0.095 (#OOM: 0)
Epoch 57 - update      27330 => loss:   0.214 (#OOM: 0)
Epoch 57 - update      27360 => loss:   0.074 (#OOM: 0)
Epoch 57 - update      27390 => loss:   0.045 (#OOM: 0)
Epoch 57 - update      27420 => loss:   0.062 (#OOM: 0)
Epoch 57 - update      27450 => loss:   0.025 (#OOM: 0)
--> Epoch 57 finished with mean loss 0.06741
--> Overhead/Training/Evaluation: 0.67/0.73/0.00 mins (total: 1.40 mins)   (660 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.74batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 11.71batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.99batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 13.23batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 15.49batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.94batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.84batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.45batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.08batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.21batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.45batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.44batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.45batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.45batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 34.42batch/s]  1%|▏                            | 8/1014 [00:00<00:32, 31.21batch/s]  1%|▎                           | 12/1014 [00:00<00:31, 31.55batch/s]  2%|▍                           | 16/1014 [00:00<00:32, 30.87batch/s]  2%|▌                           | 20/1014 [00:00<00:31, 32.05batch/s]  2%|▋                           | 24/1014 [00:00<00:30, 32.62batch/s]  3%|▊                           | 28/1014 [00:00<00:29, 33.22batch/s]  3%|▉                           | 32/1014 [00:00<00:29, 33.05batch/s]  4%|▉                           | 36/1014 [00:01<00:29, 32.84batch/s]  4%|█                           | 40/1014 [00:01<00:29, 33.13batch/s]  4%|█▏                          | 44/1014 [00:01<00:29, 32.96batch/s]  5%|█▎                          | 48/1014 [00:01<00:29, 32.97batch/s]  5%|█▍                          | 52/1014 [00:01<00:29, 32.81batch/s]  6%|█▌                          | 56/1014 [00:01<00:28, 33.13batch/s]  6%|█▋                          | 62/1014 [00:01<00:28, 33.98batch/s]  7%|█▉                          | 68/1014 [00:02<00:28, 33.74batch/s]  7%|██                          | 74/1014 [00:02<00:28, 33.40batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 34.06batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 34.39batch/s]  9%|██▌                         | 92/1014 [00:02<00:26, 34.54batch/s] 10%|██▋                         | 98/1014 [00:02<00:26, 34.44batch/s] 10%|██▊                        | 104/1014 [00:02<00:26, 34.73batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.51batch/s] 11%|███                        | 116/1014 [00:03<00:26, 34.45batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 34.47batch/s] 13%|███▍                       | 128/1014 [00:03<00:25, 34.65batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.83batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.61batch/s] 14%|███▉                       | 146/1014 [00:04<00:24, 34.95batch/s] 15%|████                       | 152/1014 [00:04<00:24, 35.33batch/s] 16%|████▏                      | 158/1014 [00:04<00:24, 35.07batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 35.11batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.81batch/s] 17%|████▋                      | 176/1014 [00:05<00:24, 34.88batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 34.85batch/s] 19%|█████                      | 188/1014 [00:05<00:23, 34.86batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.63batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.70batch/s] 20%|█████▍                     | 206/1014 [00:05<00:23, 34.86batch/s] 21%|█████▋                     | 212/1014 [00:06<00:23, 34.71batch/s] 21%|█████▊                     | 218/1014 [00:06<00:23, 34.55batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.63batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.62batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.70batch/s] 24%|██████▍                    | 242/1014 [00:06<00:22, 34.75batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 34.76batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 34.70batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.77batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 34.80batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 34.91batch/s] 27%|███████▍                   | 278/1014 [00:07<00:21, 34.98batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 34.88batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.91batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 34.92batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 34.94batch/s] 30%|████████▏                  | 308/1014 [00:08<00:20, 35.00batch/s] 31%|████████▎                  | 314/1014 [00:08<00:20, 34.99batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.06batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 35.06batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 34.97batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 35.00batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 35.07batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.13batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:18, 35.11batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 35.21batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 35.20batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.25batch/s] 37%|██████████                 | 380/1014 [00:10<00:18, 35.19batch/s] 38%|██████████▎                | 386/1014 [00:10<00:17, 35.20batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 35.21batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 35.26batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.29batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.34batch/s] 41%|███████████                | 416/1014 [00:11<00:16, 35.35batch/s] 42%|███████████▏               | 422/1014 [00:11<00:16, 35.44batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 35.35batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.33batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.36batch/s] 44%|███████████▉               | 446/1014 [00:12<00:16, 35.34batch/s] 45%|████████████               | 452/1014 [00:12<00:15, 35.38batch/s] 45%|████████████▏              | 458/1014 [00:12<00:15, 35.32batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.32batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 35.28batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 35.30batch/s] 48%|████████████▊              | 482/1014 [00:13<00:15, 35.34batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 35.27batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 35.28batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.35batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 35.33batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 35.28batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:14, 35.29batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.29batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 35.23batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 35.25batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 35.29batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.24batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.24batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.27batch/s] 56%|███████████████            | 566/1014 [00:15<00:12, 35.38batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 35.30batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.36batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.29batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 35.27batch/s] 59%|███████████████▊           | 596/1014 [00:16<00:11, 35.27batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 35.29batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.28batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.23batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.25batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:10, 35.30batch/s] 62%|████████████████▊          | 632/1014 [00:17<00:10, 35.28batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.26batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.28batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.33batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 35.38batch/s] 65%|█████████████████▋         | 662/1014 [00:18<00:09, 35.38batch/s] 66%|█████████████████▊         | 668/1014 [00:18<00:09, 35.26batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.28batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 35.25batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 35.18batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 35.24batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.25batch/s] 69%|██████████████████▋        | 704/1014 [00:19<00:08, 35.26batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.27batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 35.24batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 35.24batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.28batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.27batch/s] 73%|███████████████████▋       | 740/1014 [00:20<00:07, 35.29batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 35.30batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 35.31batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.37batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.36batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.36batch/s] 77%|████████████████████▋      | 776/1014 [00:21<00:06, 35.36batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 35.34batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 35.33batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.39batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 35.42batch/s] 79%|█████████████████████▍     | 806/1014 [00:22<00:05, 35.47batch/s] 80%|█████████████████████▌     | 812/1014 [00:22<00:05, 35.44batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 35.41batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.43batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.47batch/s] 82%|██████████████████████▎    | 836/1014 [00:23<00:05, 35.41batch/s] 83%|██████████████████████▍    | 842/1014 [00:23<00:04, 35.43batch/s] 84%|██████████████████████▌    | 848/1014 [00:23<00:04, 35.44batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.46batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 35.48batch/s] 85%|███████████████████████    | 866/1014 [00:24<00:04, 35.44batch/s] 86%|███████████████████████▏   | 872/1014 [00:24<00:04, 35.45batch/s] 87%|███████████████████████▍   | 878/1014 [00:24<00:03, 35.42batch/s] 87%|███████████████████████▌   | 884/1014 [00:24<00:03, 35.43batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 35.41batch/s] 88%|███████████████████████▊   | 896/1014 [00:25<00:03, 35.41batch/s] 89%|████████████████████████   | 902/1014 [00:25<00:03, 35.39batch/s] 90%|████████████████████████▏  | 908/1014 [00:25<00:02, 35.41batch/s] 90%|████████████████████████▎  | 914/1014 [00:25<00:02, 35.40batch/s] 91%|████████████████████████▍  | 920/1014 [00:25<00:02, 35.42batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 35.37batch/s] 92%|████████████████████████▊  | 932/1014 [00:26<00:02, 35.38batch/s] 93%|████████████████████████▉  | 938/1014 [00:26<00:02, 35.40batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.38batch/s] 94%|█████████████████████████▎ | 950/1014 [00:26<00:01, 35.41batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 35.39batch/s] 95%|█████████████████████████▌ | 962/1014 [00:27<00:01, 35.39batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 35.40batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 35.35batch/s] 97%|██████████████████████████ | 980/1014 [00:27<00:00, 35.35batch/s] 97%|██████████████████████████▎| 986/1014 [00:27<00:00, 35.29batch/s] 98%|██████████████████████████▍| 992/1014 [00:28<00:00, 35.27batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 35.23batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 35.18batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 35.21batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.25batch/s]
Validation 57 -> LOSS = 0.24
Validation 57 -> BLEU = 96.78, 98.7/97.3/96.2/95.0 (BP=1.000, ratio=1.000, hyp_len=14377, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 57
--> Best BLEU so far: 96.86 @ validation 56
Starting Epoch 58
Epoch 58 - update      27480 => loss:   0.057 (#OOM: 0)
Epoch 58 - update      27510 => loss:   0.126 (#OOM: 0)
Epoch 58 - update      27540 => loss:   0.087 (#OOM: 0)
Epoch 58 - update      27570 => loss:   0.092 (#OOM: 0)
Epoch 58 - update      27600 => loss:   0.050 (#OOM: 0)
Epoch 58 - update      27630 => loss:   0.095 (#OOM: 0)
Epoch 58 - update      27660 => loss:   0.063 (#OOM: 0)
Epoch 58 - update      27690 => loss:   0.062 (#OOM: 0)
Epoch 58 - update      27720 => loss:   0.067 (#OOM: 0)
Epoch 58 - update      27750 => loss:   0.101 (#OOM: 0)
Epoch 58 - update      27780 => loss:   0.047 (#OOM: 0)
Epoch 58 - update      27810 => loss:   0.055 (#OOM: 0)
Epoch 58 - update      27840 => loss:   0.089 (#OOM: 0)
Epoch 58 - update      27870 => loss:   0.085 (#OOM: 0)
Epoch 58 - update      27900 => loss:   0.056 (#OOM: 0)
Epoch 58 - update      27930 => loss:   0.047 (#OOM: 0)
--> Epoch 58 finished with mean loss 0.06715
--> Overhead/Training/Evaluation: 0.65/0.72/0.00 mins (total: 1.37 mins)   (668 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  8.00batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.53batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.86batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.44batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 14.43batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 14.07batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 13.76batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.95batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.27batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.63batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.25batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:01, 11.83batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.15batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.40batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 12.62batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.31batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.56batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.56batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:40, 24.75batch/s]  1%|▏                            | 7/1014 [00:00<00:32, 31.22batch/s]  1%|▎                           | 11/1014 [00:00<00:31, 31.86batch/s]  2%|▍                           | 16/1014 [00:00<00:28, 34.87batch/s]  2%|▌                           | 21/1014 [00:00<00:28, 35.40batch/s]  3%|▋                           | 26/1014 [00:00<00:27, 35.44batch/s]  3%|▊                           | 31/1014 [00:00<00:28, 34.92batch/s]  4%|▉                           | 36/1014 [00:01<00:27, 35.08batch/s]  4%|█▏                          | 41/1014 [00:01<00:27, 35.44batch/s]  5%|█▎                          | 46/1014 [00:01<00:27, 35.44batch/s]  5%|█▍                          | 51/1014 [00:01<00:26, 35.76batch/s]  6%|█▌                          | 56/1014 [00:01<00:26, 36.36batch/s]  6%|█▋                          | 61/1014 [00:01<00:25, 36.82batch/s]  7%|█▊                          | 66/1014 [00:01<00:25, 37.40batch/s]  7%|█▉                          | 71/1014 [00:01<00:25, 36.73batch/s]  7%|██                          | 76/1014 [00:02<00:25, 37.04batch/s]  8%|██▏                         | 81/1014 [00:02<00:25, 37.01batch/s]  8%|██▎                         | 86/1014 [00:02<00:25, 36.77batch/s]  9%|██▌                         | 91/1014 [00:02<00:24, 37.18batch/s]  9%|██▋                         | 96/1014 [00:02<00:24, 36.90batch/s] 10%|██▋                        | 101/1014 [00:02<00:24, 36.79batch/s] 10%|██▊                        | 106/1014 [00:02<00:24, 37.16batch/s] 11%|██▉                        | 111/1014 [00:02<00:24, 37.49batch/s] 11%|███                        | 116/1014 [00:03<00:24, 37.39batch/s] 12%|███▏                       | 121/1014 [00:03<00:23, 37.39batch/s] 12%|███▎                       | 126/1014 [00:03<00:23, 37.14batch/s] 13%|███▍                       | 131/1014 [00:03<00:23, 36.90batch/s] 13%|███▌                       | 136/1014 [00:03<00:23, 36.87batch/s] 14%|███▊                       | 141/1014 [00:03<00:23, 36.89batch/s] 14%|███▉                       | 146/1014 [00:03<00:23, 36.85batch/s] 15%|████                       | 151/1014 [00:04<00:23, 36.78batch/s] 15%|████▏                      | 156/1014 [00:04<00:23, 36.45batch/s] 16%|████▎                      | 161/1014 [00:04<00:23, 36.42batch/s] 16%|████▍                      | 166/1014 [00:04<00:23, 35.92batch/s] 17%|████▌                      | 171/1014 [00:04<00:23, 35.93batch/s] 17%|████▋                      | 176/1014 [00:04<00:23, 36.01batch/s] 18%|████▊                      | 181/1014 [00:05<00:23, 36.07batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 35.49batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 35.47batch/s] 19%|█████▏                     | 196/1014 [00:05<00:22, 35.58batch/s] 20%|█████▎                     | 201/1014 [00:05<00:22, 35.59batch/s] 20%|█████▍                     | 206/1014 [00:05<00:22, 35.37batch/s] 21%|█████▌                     | 211/1014 [00:05<00:22, 35.29batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 35.14batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 35.04batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 35.25batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 35.40batch/s] 23%|██████▎                    | 236/1014 [00:06<00:21, 35.44batch/s] 24%|██████▍                    | 241/1014 [00:06<00:21, 35.42batch/s] 24%|██████▌                    | 246/1014 [00:06<00:21, 35.44batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 35.60batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 35.45batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 35.32batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 35.23batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 35.11batch/s] 27%|███████▎                   | 276/1014 [00:07<00:20, 35.16batch/s] 28%|███████▍                   | 281/1014 [00:07<00:20, 35.24batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 35.22batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 35.25batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 35.17batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 35.14batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 35.09batch/s] 31%|████████▎                  | 311/1014 [00:08<00:20, 35.05batch/s] 31%|████████▍                  | 316/1014 [00:09<00:19, 35.09batch/s] 32%|████████▌                  | 321/1014 [00:09<00:19, 35.07batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 35.12batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 35.00batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 34.99batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 35.10batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:19, 35.12batch/s] 35%|█████████▎                 | 351/1014 [00:09<00:18, 35.13batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:18, 35.14batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 35.13batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 35.15batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 35.16batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 35.18batch/s] 38%|██████████▏                | 381/1014 [00:10<00:17, 35.18batch/s] 38%|██████████▎                | 386/1014 [00:10<00:17, 35.23batch/s] 39%|██████████▍                | 391/1014 [00:11<00:17, 35.16batch/s] 39%|██████████▌                | 396/1014 [00:11<00:17, 35.16batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 35.20batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 35.22batch/s] 41%|██████████▉                | 411/1014 [00:11<00:17, 35.25batch/s] 41%|███████████                | 416/1014 [00:11<00:16, 35.35batch/s] 42%|███████████▏               | 421/1014 [00:11<00:16, 35.29batch/s] 42%|███████████▎               | 426/1014 [00:12<00:16, 35.30batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 35.33batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 35.36batch/s] 43%|███████████▋               | 441/1014 [00:12<00:16, 35.20batch/s] 44%|███████████▉               | 446/1014 [00:12<00:16, 35.23batch/s] 44%|████████████               | 451/1014 [00:12<00:15, 35.28batch/s] 45%|████████████▏              | 456/1014 [00:12<00:15, 35.24batch/s] 45%|████████████▎              | 461/1014 [00:13<00:15, 35.19batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 35.15batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 35.21batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 35.22batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 35.26batch/s] 48%|████████████▉              | 486/1014 [00:13<00:14, 35.28batch/s] 48%|█████████████              | 491/1014 [00:13<00:14, 35.29batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 35.31batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:14, 35.25batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 35.25batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 35.26batch/s] 51%|█████████████▋             | 516/1014 [00:14<00:14, 35.16batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:14, 35.12batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 35.14batch/s] 52%|██████████████▏            | 531/1014 [00:15<00:13, 35.09batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 35.03batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 35.10batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 34.97batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 35.04batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:13, 35.02batch/s] 55%|██████████████▉            | 561/1014 [00:16<00:12, 35.04batch/s] 56%|███████████████            | 566/1014 [00:16<00:12, 35.03batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 34.98batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 35.02batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 35.05batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 35.06batch/s] 58%|███████████████▋           | 591/1014 [00:16<00:12, 35.03batch/s] 59%|███████████████▊           | 596/1014 [00:17<00:11, 34.93batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 34.98batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 34.95batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.99batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 34.93batch/s] 61%|████████████████▌          | 621/1014 [00:17<00:11, 34.93batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:11, 34.95batch/s] 62%|████████████████▊          | 631/1014 [00:18<00:10, 34.85batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:10, 34.87batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.85batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 34.86batch/s] 64%|█████████████████▎         | 651/1014 [00:18<00:10, 34.85batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 34.85batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:10, 34.86batch/s] 66%|█████████████████▋         | 666/1014 [00:19<00:09, 34.90batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.83batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 34.81batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 34.72batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 34.68batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 34.62batch/s] 69%|██████████████████▌        | 696/1014 [00:20<00:09, 34.64batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.60batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 34.62batch/s] 70%|██████████████████▉        | 711/1014 [00:20<00:08, 34.65batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 34.69batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 34.70batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 34.61batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.64batch/s] 73%|███████████████████▌       | 736/1014 [00:21<00:08, 34.60batch/s] 73%|███████████████████▋       | 741/1014 [00:21<00:07, 34.59batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 34.64batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 34.60batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 34.53batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.54batch/s] 76%|████████████████████▍      | 766/1014 [00:22<00:07, 34.50batch/s] 76%|████████████████████▌      | 771/1014 [00:22<00:07, 34.53batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 34.55batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 34.52batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 34.50batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.50batch/s] 79%|█████████████████████▏     | 796/1014 [00:23<00:06, 34.52batch/s] 79%|█████████████████████▎     | 801/1014 [00:23<00:06, 34.49batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:06, 34.52batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 34.50batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 34.50batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.48batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 34.47batch/s] 82%|██████████████████████▏    | 831/1014 [00:24<00:05, 34.50batch/s] 82%|██████████████████████▎    | 836/1014 [00:24<00:05, 34.48batch/s] 83%|██████████████████████▍    | 841/1014 [00:24<00:05, 34.49batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 34.49batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.49batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 34.49batch/s] 85%|██████████████████████▉    | 861/1014 [00:24<00:04, 34.52batch/s] 85%|███████████████████████    | 866/1014 [00:25<00:04, 34.53batch/s] 86%|███████████████████████▏   | 871/1014 [00:25<00:04, 34.50batch/s] 86%|███████████████████████▎   | 876/1014 [00:25<00:03, 34.51batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.48batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 34.45batch/s] 88%|███████████████████████▋   | 891/1014 [00:25<00:03, 34.40batch/s] 88%|███████████████████████▊   | 896/1014 [00:26<00:03, 34.41batch/s] 89%|███████████████████████▉   | 901/1014 [00:26<00:03, 34.41batch/s] 89%|████████████████████████   | 906/1014 [00:26<00:03, 34.42batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.44batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.45batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 34.47batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 34.50batch/s] 92%|████████████████████████▊  | 931/1014 [00:27<00:02, 34.48batch/s] 92%|████████████████████████▉  | 936/1014 [00:27<00:02, 34.54batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.54batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.54batch/s] 94%|█████████████████████████▎ | 951/1014 [00:27<00:01, 34.57batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 34.59batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 34.61batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 34.63batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.65batch/s] 96%|█████████████████████████▉ | 976/1014 [00:28<00:01, 34.67batch/s] 97%|██████████████████████████ | 981/1014 [00:28<00:00, 34.69batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 34.71batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 34.69batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 34.72batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.69batch/s] 99%|█████████████████████████▊| 1006/1014 [00:29<00:00, 34.69batch/s]100%|█████████████████████████▉| 1011/1014 [00:29<00:00, 34.73batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.74batch/s]
Validation 58 -> LOSS = 0.24
Validation 58 -> BLEU = 96.85, 98.7/97.4/96.3/95.1 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 57
--> Best BLEU so far: 96.86 @ validation 56
Starting Epoch 59
Epoch 59 - update      27960 => loss:   0.067 (#OOM: 0)
Epoch 59 - update      27990 => loss:   0.063 (#OOM: 0)
Epoch 59 - update      28020 => loss:   0.066 (#OOM: 0)
Epoch 59 - update      28050 => loss:   0.049 (#OOM: 0)
Epoch 59 - update      28080 => loss:   0.064 (#OOM: 0)
Epoch 59 - update      28110 => loss:   0.041 (#OOM: 0)
Epoch 59 - update      28140 => loss:   0.066 (#OOM: 0)
Epoch 59 - update      28170 => loss:   0.079 (#OOM: 0)
Epoch 59 - update      28200 => loss:   0.053 (#OOM: 0)
Epoch 59 - update      28230 => loss:   0.066 (#OOM: 0)
Epoch 59 - update      28260 => loss:   0.050 (#OOM: 0)
Epoch 59 - update      28290 => loss:   0.052 (#OOM: 0)
Epoch 59 - update      28320 => loss:   0.065 (#OOM: 0)
Epoch 59 - update      28350 => loss:   0.027 (#OOM: 0)
Epoch 59 - update      28380 => loss:   0.098 (#OOM: 0)
Epoch 59 - update      28410 => loss:   0.038 (#OOM: 0)
--> Epoch 59 finished with mean loss 0.06581
--> Overhead/Training/Evaluation: 0.67/0.73/0.00 mins (total: 1.40 mins)   (660 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.79batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 13.16batch/s] 15%|████▌                          | 5/34 [00:00<00:01, 15.00batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 15.57batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 14.63batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 13.24batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.87batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 13.55batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.19batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.81batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.94batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.45batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.02batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.23batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.59batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.70batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:23, 42.57batch/s]  1%|▎                           | 10/1014 [00:00<00:26, 38.08batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 36.12batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 32.50batch/s]  2%|▋                           | 25/1014 [00:00<00:32, 30.87batch/s]  3%|▊                           | 30/1014 [00:00<00:30, 32.08batch/s]  3%|▉                           | 35/1014 [00:01<00:29, 32.64batch/s]  4%|█                           | 40/1014 [00:01<00:29, 33.12batch/s]  4%|█▏                          | 45/1014 [00:01<00:29, 32.56batch/s]  5%|█▍                          | 50/1014 [00:01<00:29, 33.09batch/s]  5%|█▌                          | 55/1014 [00:01<00:29, 33.02batch/s]  6%|█▋                          | 60/1014 [00:01<00:28, 33.46batch/s]  6%|█▊                          | 65/1014 [00:01<00:28, 33.79batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.10batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.70batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 33.87batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 33.99batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 34.13batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.06batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.44batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.64batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.60batch/s] 11%|███                        | 115/1014 [00:03<00:26, 34.45batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 34.17batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.22batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.25batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.42batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.55batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.37batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.29batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 34.31batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 34.71batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.35batch/s] 17%|████▌                      | 173/1014 [00:05<00:24, 34.21batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 33.96batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 34.04batch/s] 19%|█████                      | 191/1014 [00:05<00:24, 33.94batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 34.10batch/s] 20%|█████▍                     | 203/1014 [00:05<00:23, 34.09batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.20batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.18batch/s] 22%|█████▉                     | 221/1014 [00:06<00:23, 34.31batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 34.34batch/s] 23%|██████▏                    | 233/1014 [00:06<00:22, 34.21batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.31batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.30batch/s] 25%|██████▋                    | 251/1014 [00:07<00:22, 34.08batch/s] 25%|██████▊                    | 257/1014 [00:07<00:22, 34.18batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 34.21batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.25batch/s] 27%|███████▎                   | 275/1014 [00:08<00:21, 34.26batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.23batch/s] 28%|███████▋                   | 287/1014 [00:08<00:21, 34.10batch/s] 29%|███████▊                   | 293/1014 [00:08<00:21, 34.14batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.21batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.21batch/s] 31%|████████▎                  | 311/1014 [00:09<00:20, 34.14batch/s] 31%|████████▍                  | 317/1014 [00:09<00:20, 34.28batch/s] 32%|████████▌                  | 323/1014 [00:09<00:20, 34.34batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.44batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.45batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 34.46batch/s] 34%|█████████▏                 | 347/1014 [00:10<00:19, 34.44batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 34.49batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:19, 34.43batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.37batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 34.44batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 34.39batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 34.35batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.32batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 34.26batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 34.22batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.19batch/s] 41%|██████████▉                | 413/1014 [00:12<00:17, 34.19batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.22batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.94batch/s] 43%|███████████▍               | 431/1014 [00:12<00:17, 33.90batch/s] 43%|███████████▋               | 437/1014 [00:12<00:17, 33.83batch/s] 44%|███████████▊               | 443/1014 [00:13<00:16, 33.68batch/s] 44%|███████████▉               | 449/1014 [00:13<00:16, 33.61batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.54batch/s] 45%|████████████▎              | 461/1014 [00:13<00:16, 33.43batch/s] 46%|████████████▍              | 467/1014 [00:14<00:16, 33.29batch/s] 47%|████████████▌              | 473/1014 [00:14<00:16, 33.26batch/s] 47%|████████████▊              | 479/1014 [00:14<00:16, 33.27batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.29batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 33.29batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:15, 33.34batch/s] 50%|█████████████▍             | 503/1014 [00:15<00:15, 33.38batch/s] 50%|█████████████▌             | 509/1014 [00:15<00:15, 33.42batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 33.40batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 33.42batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 33.44batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:14, 33.46batch/s] 53%|██████████████▎            | 539/1014 [00:16<00:14, 33.43batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:14, 33.49batch/s] 54%|██████████████▋            | 551/1014 [00:16<00:13, 33.53batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 33.59batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 33.58batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:13, 33.57batch/s] 57%|███████████████▎           | 575/1014 [00:17<00:13, 33.63batch/s] 57%|███████████████▍           | 581/1014 [00:17<00:12, 33.64batch/s] 58%|███████████████▋           | 587/1014 [00:17<00:12, 33.65batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 33.71batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:12, 33.67batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 33.71batch/s] 60%|████████████████▎          | 611/1014 [00:18<00:11, 33.73batch/s] 61%|████████████████▍          | 617/1014 [00:18<00:11, 33.78batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 33.82batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 33.86batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 33.90batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 33.91batch/s] 64%|█████████████████▏         | 647/1014 [00:19<00:10, 33.90batch/s] 64%|█████████████████▍         | 653/1014 [00:19<00:10, 33.92batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 33.90batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.89batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:10, 33.85batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 33.90batch/s] 67%|██████████████████▏        | 683/1014 [00:20<00:09, 33.94batch/s] 68%|██████████████████▎        | 689/1014 [00:20<00:09, 33.97batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.01batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.07batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:09, 34.09batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.05batch/s] 71%|███████████████████▏       | 719/1014 [00:21<00:08, 34.02batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.05batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.06batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:08, 34.04batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.08batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.06batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 34.02batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.04batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.01batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:07, 34.00batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 33.99batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.96batch/s] 78%|█████████████████████      | 791/1014 [00:23<00:06, 33.94batch/s] 79%|█████████████████████▏     | 797/1014 [00:23<00:06, 33.95batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.00batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:06, 34.05batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.09batch/s] 81%|█████████████████████▊     | 821/1014 [00:24<00:05, 34.15batch/s] 82%|██████████████████████     | 827/1014 [00:24<00:05, 34.15batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.19batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.20batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.18batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.21batch/s] 85%|██████████████████████▊    | 857/1014 [00:25<00:04, 34.22batch/s] 85%|██████████████████████▉    | 863/1014 [00:25<00:04, 34.24batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.25batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.23batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.27batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.29batch/s] 88%|███████████████████████▊   | 893/1014 [00:26<00:03, 34.31batch/s] 89%|███████████████████████▉   | 899/1014 [00:26<00:03, 34.31batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.34batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:03, 34.33batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.33batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.36batch/s] 92%|████████████████████████▋  | 929/1014 [00:27<00:02, 34.37batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.41batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.41batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.43batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.39batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.32batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 34.24batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.28batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.26batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.28batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.29batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.33batch/s] 99%|█████████████████████████▋| 1001/1014 [00:29<00:00, 34.29batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.29batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.32batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.33batch/s]
Validation 59 -> LOSS = 0.24
Validation 59 -> BLEU = 96.89, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14370, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 57
--> Best BLEU so far: 96.89 @ validation 59
Starting Epoch 60
Epoch 60 - update      28440 => loss:   0.070 (#OOM: 0)
Epoch 60 - update      28470 => loss:   0.066 (#OOM: 0)
Epoch 60 - update      28500 => loss:   0.089 (#OOM: 0)
Epoch 60 - update      28530 => loss:   0.072 (#OOM: 0)
Epoch 60 - update      28560 => loss:   0.084 (#OOM: 0)
Epoch 60 - update      28590 => loss:   0.086 (#OOM: 0)
Epoch 60 - update      28620 => loss:   0.026 (#OOM: 0)
Epoch 60 - update      28650 => loss:   0.056 (#OOM: 0)
Epoch 60 - update      28680 => loss:   0.042 (#OOM: 0)
Epoch 60 - update      28710 => loss:   0.053 (#OOM: 0)
Epoch 60 - update      28740 => loss:   0.105 (#OOM: 0)
Epoch 60 - update      28770 => loss:   0.058 (#OOM: 0)
Epoch 60 - update      28800 => loss:   0.071 (#OOM: 0)
Epoch 60 - update      28830 => loss:   0.058 (#OOM: 0)
Epoch 60 - update      28860 => loss:   0.029 (#OOM: 0)
Epoch 60 - update      28890 => loss:   0.073 (#OOM: 0)
Epoch 60 - update      28920 => loss:   0.079 (#OOM: 0)
--> Epoch 60 finished with mean loss 0.06452
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (667 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.26batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.06batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 10.04batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.37batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.32batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.93batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.80batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.41batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.88batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.95batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.51batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.34batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.34batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 12.83batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.20batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.60batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 38.24batch/s]  1%|▏                            | 8/1014 [00:00<00:26, 38.28batch/s]  1%|▎                           | 12/1014 [00:00<00:26, 37.26batch/s]  2%|▍                           | 16/1014 [00:00<00:28, 34.72batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 34.24batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 35.02batch/s]  3%|▊                           | 28/1014 [00:00<00:27, 35.30batch/s]  3%|▉                           | 32/1014 [00:00<00:27, 35.45batch/s]  4%|█                           | 37/1014 [00:01<00:27, 36.10batch/s]  4%|█▏                          | 42/1014 [00:01<00:27, 35.57batch/s]  5%|█▎                          | 47/1014 [00:01<00:26, 36.10batch/s]  5%|█▍                          | 52/1014 [00:01<00:26, 35.98batch/s]  6%|█▌                          | 57/1014 [00:01<00:26, 35.80batch/s]  6%|█▋                          | 62/1014 [00:01<00:26, 36.08batch/s]  7%|█▊                          | 67/1014 [00:01<00:26, 36.42batch/s]  7%|█▉                          | 72/1014 [00:01<00:25, 36.57batch/s]  8%|██▏                         | 77/1014 [00:02<00:25, 36.30batch/s]  8%|██▎                         | 82/1014 [00:02<00:25, 36.56batch/s]  9%|██▍                         | 87/1014 [00:02<00:25, 36.96batch/s]  9%|██▌                         | 92/1014 [00:02<00:25, 36.85batch/s] 10%|██▋                         | 97/1014 [00:02<00:25, 36.55batch/s] 10%|██▋                        | 102/1014 [00:02<00:25, 35.98batch/s] 11%|██▊                        | 107/1014 [00:02<00:24, 36.35batch/s] 11%|██▉                        | 112/1014 [00:03<00:24, 36.17batch/s] 12%|███                        | 117/1014 [00:03<00:24, 36.46batch/s] 12%|███▏                       | 122/1014 [00:03<00:24, 36.79batch/s] 13%|███▍                       | 127/1014 [00:03<00:23, 37.07batch/s] 13%|███▌                       | 132/1014 [00:03<00:23, 36.97batch/s] 14%|███▋                       | 137/1014 [00:03<00:23, 36.80batch/s] 14%|███▊                       | 142/1014 [00:03<00:23, 36.77batch/s] 14%|███▉                       | 147/1014 [00:03<00:23, 36.81batch/s] 15%|████                       | 152/1014 [00:04<00:23, 37.06batch/s] 15%|████▏                      | 157/1014 [00:04<00:23, 36.99batch/s] 16%|████▎                      | 162/1014 [00:04<00:23, 36.94batch/s] 16%|████▍                      | 167/1014 [00:04<00:22, 37.03batch/s] 17%|████▌                      | 172/1014 [00:04<00:22, 37.00batch/s] 17%|████▋                      | 177/1014 [00:04<00:22, 36.96batch/s] 18%|████▊                      | 182/1014 [00:04<00:22, 36.81batch/s] 18%|████▉                      | 187/1014 [00:05<00:22, 36.62batch/s] 19%|█████                      | 192/1014 [00:05<00:22, 36.54batch/s] 19%|█████▏                     | 197/1014 [00:05<00:22, 36.38batch/s] 20%|█████▍                     | 202/1014 [00:05<00:22, 36.26batch/s] 20%|█████▌                     | 207/1014 [00:05<00:22, 35.80batch/s] 21%|█████▋                     | 212/1014 [00:05<00:22, 35.83batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 35.75batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 35.75batch/s] 22%|██████                     | 227/1014 [00:06<00:21, 35.84batch/s] 23%|██████▏                    | 232/1014 [00:06<00:21, 35.91batch/s] 23%|██████▎                    | 237/1014 [00:06<00:21, 35.73batch/s] 24%|██████▍                    | 242/1014 [00:06<00:21, 35.67batch/s] 24%|██████▌                    | 247/1014 [00:06<00:21, 35.68batch/s] 25%|██████▋                    | 252/1014 [00:07<00:21, 35.71batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 35.71batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 35.68batch/s] 26%|███████                    | 267/1014 [00:07<00:20, 35.72batch/s] 27%|███████▏                   | 272/1014 [00:07<00:20, 35.52batch/s] 27%|███████▍                   | 277/1014 [00:07<00:20, 35.55batch/s] 28%|███████▌                   | 282/1014 [00:07<00:20, 35.52batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.57batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.50batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 35.61batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 35.52batch/s] 30%|████████▏                  | 307/1014 [00:08<00:19, 35.55batch/s] 31%|████████▎                  | 312/1014 [00:08<00:19, 35.55batch/s] 31%|████████▍                  | 317/1014 [00:08<00:19, 35.52batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 35.49batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 35.55batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 35.60batch/s] 33%|████████▉                  | 337/1014 [00:09<00:18, 35.65batch/s] 34%|█████████                  | 342/1014 [00:09<00:18, 35.40batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:18, 35.48batch/s] 35%|█████████▎                 | 352/1014 [00:09<00:18, 35.35batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 35.28batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 35.30batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 35.30batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 35.30batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 35.31batch/s] 38%|██████████▏                | 382/1014 [00:10<00:17, 35.35batch/s] 38%|██████████▎                | 387/1014 [00:10<00:17, 35.41batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 35.43batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 35.25batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 35.23batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 35.19batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 35.19batch/s] 41%|███████████                | 417/1014 [00:11<00:16, 35.29batch/s] 42%|███████████▏               | 422/1014 [00:11<00:16, 35.28batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 35.34batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 35.33batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 35.24batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 35.28batch/s] 44%|███████████▉               | 447/1014 [00:12<00:16, 35.35batch/s] 45%|████████████               | 452/1014 [00:12<00:15, 35.42batch/s] 45%|████████████▏              | 457/1014 [00:12<00:15, 35.38batch/s] 46%|████████████▎              | 462/1014 [00:13<00:15, 35.38batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 35.25batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.22batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 35.24batch/s] 48%|████████████▊              | 482/1014 [00:13<00:15, 35.29batch/s] 48%|████████████▉              | 487/1014 [00:13<00:14, 35.30batch/s] 49%|█████████████              | 492/1014 [00:13<00:14, 35.33batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 35.31batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 35.32batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 35.25batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 35.29batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 35.29batch/s] 51%|█████████████▉             | 522/1014 [00:14<00:13, 35.29batch/s] 52%|██████████████             | 527/1014 [00:14<00:13, 35.26batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 35.30batch/s] 53%|██████████████▎            | 537/1014 [00:15<00:13, 35.33batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 35.33batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 35.35batch/s] 54%|██████████████▋            | 552/1014 [00:15<00:13, 35.40batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:12, 35.32batch/s] 55%|██████████████▉            | 562/1014 [00:15<00:12, 35.25batch/s] 56%|███████████████            | 567/1014 [00:16<00:12, 35.31batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 35.30batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 35.31batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 35.24batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 35.24batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:11, 35.23batch/s] 59%|███████████████▉           | 597/1014 [00:16<00:11, 35.23batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 35.20batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 35.21batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 35.22batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 35.25batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 35.23batch/s] 62%|████████████████▋          | 627/1014 [00:17<00:10, 35.25batch/s] 62%|████████████████▊          | 632/1014 [00:17<00:10, 35.29batch/s] 63%|████████████████▉          | 637/1014 [00:18<00:10, 35.32batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 35.31batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 35.33batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 35.38batch/s] 65%|█████████████████▍         | 657/1014 [00:18<00:10, 35.38batch/s] 65%|█████████████████▋         | 662/1014 [00:18<00:09, 35.42batch/s] 66%|█████████████████▊         | 667/1014 [00:18<00:09, 35.41batch/s] 66%|█████████████████▉         | 672/1014 [00:18<00:09, 35.44batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 35.45batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 35.45batch/s] 68%|██████████████████▎        | 687/1014 [00:19<00:09, 35.39batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 35.34batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:08, 35.32batch/s] 69%|██████████████████▋        | 702/1014 [00:19<00:08, 35.31batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 35.30batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 35.35batch/s] 71%|███████████████████        | 717/1014 [00:20<00:08, 35.36batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 35.40batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 35.35batch/s] 72%|███████████████████▍       | 732/1014 [00:20<00:07, 35.32batch/s] 73%|███████████████████▌       | 737/1014 [00:20<00:07, 35.32batch/s] 73%|███████████████████▊       | 742/1014 [00:20<00:07, 35.35batch/s] 74%|███████████████████▉       | 747/1014 [00:21<00:07, 35.40batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 35.44batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 35.46batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 35.48batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:06, 35.51batch/s] 76%|████████████████████▌      | 772/1014 [00:21<00:06, 35.51batch/s] 77%|████████████████████▋      | 777/1014 [00:21<00:06, 35.53batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 35.54batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.53batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 35.49batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 35.45batch/s] 79%|█████████████████████▎     | 802/1014 [00:22<00:05, 35.44batch/s] 80%|█████████████████████▍     | 807/1014 [00:22<00:05, 35.44batch/s] 80%|█████████████████████▌     | 812/1014 [00:22<00:05, 35.40batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 35.42batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 35.37batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 35.34batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 35.31batch/s] 83%|██████████████████████▎    | 837/1014 [00:23<00:05, 35.33batch/s] 83%|██████████████████████▍    | 842/1014 [00:23<00:04, 35.31batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 35.29batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 35.31batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 35.33batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 35.33batch/s] 86%|███████████████████████    | 867/1014 [00:24<00:04, 35.33batch/s] 86%|███████████████████████▏   | 872/1014 [00:24<00:04, 35.33batch/s] 86%|███████████████████████▎   | 877/1014 [00:24<00:03, 35.32batch/s] 87%|███████████████████████▍   | 882/1014 [00:24<00:03, 35.33batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 35.34batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 35.33batch/s] 88%|███████████████████████▉   | 897/1014 [00:25<00:03, 35.30batch/s] 89%|████████████████████████   | 902/1014 [00:25<00:03, 35.32batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 35.31batch/s] 90%|████████████████████████▎  | 912/1014 [00:25<00:02, 35.29batch/s] 90%|████████████████████████▍  | 917/1014 [00:25<00:02, 35.31batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 35.31batch/s] 91%|████████████████████████▋  | 927/1014 [00:26<00:02, 35.32batch/s] 92%|████████████████████████▊  | 932/1014 [00:26<00:02, 35.31batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.33batch/s] 93%|█████████████████████████  | 942/1014 [00:26<00:02, 35.37batch/s] 93%|█████████████████████████▏ | 947/1014 [00:26<00:01, 35.40batch/s] 94%|█████████████████████████▎ | 952/1014 [00:26<00:01, 35.33batch/s] 94%|█████████████████████████▍ | 957/1014 [00:27<00:01, 35.34batch/s] 95%|█████████████████████████▌ | 962/1014 [00:27<00:01, 35.34batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.36batch/s] 96%|█████████████████████████▉ | 972/1014 [00:27<00:01, 35.38batch/s] 96%|██████████████████████████ | 977/1014 [00:27<00:01, 35.33batch/s] 97%|██████████████████████████▏| 982/1014 [00:27<00:00, 35.33batch/s] 97%|██████████████████████████▎| 987/1014 [00:27<00:00, 35.29batch/s] 98%|██████████████████████████▍| 992/1014 [00:28<00:00, 35.27batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.27batch/s] 99%|█████████████████████████▋| 1002/1014 [00:28<00:00, 35.28batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 35.27batch/s]100%|█████████████████████████▉| 1012/1014 [00:28<00:00, 35.25batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.26batch/s]
Validation 60 -> LOSS = 0.24
Validation 60 -> BLEU = 96.92, 98.7/97.4/96.4/95.2 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 57
--> Best BLEU so far: 96.92 @ validation 60
Starting Epoch 61
Epoch 61 - update      28950 => loss:   0.064 (#OOM: 0)
Epoch 61 - update      28980 => loss:   0.039 (#OOM: 0)
Epoch 61 - update      29010 => loss:   0.066 (#OOM: 0)
Epoch 61 - update      29040 => loss:   0.038 (#OOM: 0)
Epoch 61 - update      29070 => loss:   0.100 (#OOM: 0)
Epoch 61 - update      29100 => loss:   0.078 (#OOM: 0)
Epoch 61 - update      29130 => loss:   0.030 (#OOM: 0)
Epoch 61 - update      29160 => loss:   0.039 (#OOM: 0)
Epoch 61 - update      29190 => loss:   0.040 (#OOM: 0)
Epoch 61 - update      29220 => loss:   0.070 (#OOM: 0)
Epoch 61 - update      29250 => loss:   0.068 (#OOM: 0)
Epoch 61 - update      29280 => loss:   0.062 (#OOM: 0)
Epoch 61 - update      29310 => loss:   0.058 (#OOM: 0)
Epoch 61 - update      29340 => loss:   0.053 (#OOM: 0)
Epoch 61 - update      29370 => loss:   0.051 (#OOM: 0)
Epoch 61 - update      29400 => loss:   0.079 (#OOM: 0)
--> Epoch 61 finished with mean loss 0.06341
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (668 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  9.82batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 10.73batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.18batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.43batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.08batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.59batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.21batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 12.75batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.95batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.05batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.78batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 12.61batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 12.99batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.22batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:32, 31.13batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 33.93batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 34.75batch/s]  2%|▍                           | 16/1014 [00:00<00:28, 35.47batch/s]  2%|▌                           | 21/1014 [00:00<00:27, 35.92batch/s]  3%|▋                           | 26/1014 [00:00<00:27, 36.30batch/s]  3%|▊                           | 31/1014 [00:00<00:27, 36.00batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 34.58batch/s]  4%|█▏                          | 41/1014 [00:01<00:28, 34.34batch/s]  5%|█▎                          | 46/1014 [00:01<00:28, 34.50batch/s]  5%|█▍                          | 51/1014 [00:01<00:28, 34.27batch/s]  6%|█▌                          | 56/1014 [00:01<00:27, 34.77batch/s]  6%|█▋                          | 61/1014 [00:01<00:27, 34.75batch/s]  7%|█▊                          | 66/1014 [00:01<00:26, 35.24batch/s]  7%|█▉                          | 71/1014 [00:02<00:26, 35.08batch/s]  7%|██                          | 76/1014 [00:02<00:26, 35.60batch/s]  8%|██▏                         | 81/1014 [00:02<00:26, 35.15batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 35.11batch/s]  9%|██▌                         | 91/1014 [00:02<00:25, 35.53batch/s]  9%|██▋                         | 96/1014 [00:02<00:25, 35.55batch/s] 10%|██▋                        | 101/1014 [00:02<00:25, 35.53batch/s] 10%|██▊                        | 106/1014 [00:02<00:25, 35.78batch/s] 11%|██▉                        | 111/1014 [00:03<00:25, 36.03batch/s] 11%|███                        | 116/1014 [00:03<00:25, 35.71batch/s] 12%|███▏                       | 121/1014 [00:03<00:25, 35.47batch/s] 12%|███▎                       | 126/1014 [00:03<00:25, 35.44batch/s] 13%|███▍                       | 131/1014 [00:03<00:25, 35.30batch/s] 13%|███▌                       | 136/1014 [00:03<00:24, 35.51batch/s] 14%|███▊                       | 141/1014 [00:03<00:24, 35.40batch/s] 14%|███▉                       | 146/1014 [00:04<00:24, 35.10batch/s] 15%|████                       | 151/1014 [00:04<00:24, 34.79batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 34.82batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 34.88batch/s] 16%|████▍                      | 166/1014 [00:04<00:24, 34.53batch/s] 17%|████▌                      | 171/1014 [00:04<00:24, 34.52batch/s] 17%|████▋                      | 176/1014 [00:05<00:24, 34.43batch/s] 18%|████▊                      | 181/1014 [00:05<00:24, 34.34batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 34.61batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 34.69batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 34.61batch/s] 20%|█████▎                     | 201/1014 [00:05<00:23, 34.53batch/s] 20%|█████▍                     | 206/1014 [00:06<00:23, 34.29batch/s] 21%|█████▌                     | 211/1014 [00:06<00:23, 34.25batch/s] 21%|█████▊                     | 216/1014 [00:06<00:23, 34.34batch/s] 22%|█████▉                     | 221/1014 [00:06<00:23, 34.32batch/s] 22%|██████                     | 226/1014 [00:06<00:23, 34.23batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 34.24batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.33batch/s] 24%|██████▍                    | 241/1014 [00:07<00:22, 34.36batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.43batch/s] 25%|██████▋                    | 251/1014 [00:07<00:22, 34.34batch/s] 25%|██████▊                    | 256/1014 [00:07<00:22, 34.40batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 34.47batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 34.45batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.35batch/s] 27%|███████▎                   | 276/1014 [00:08<00:21, 34.12batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.21batch/s] 28%|███████▌                   | 286/1014 [00:08<00:21, 34.11batch/s] 29%|███████▋                   | 291/1014 [00:08<00:21, 34.07batch/s] 29%|███████▉                   | 296/1014 [00:08<00:21, 34.11batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 34.13batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 34.19batch/s] 31%|████████▎                  | 311/1014 [00:09<00:20, 34.15batch/s] 31%|████████▍                  | 316/1014 [00:09<00:20, 34.20batch/s] 32%|████████▌                  | 321/1014 [00:09<00:20, 34.31batch/s] 32%|████████▋                  | 326/1014 [00:09<00:20, 34.30batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 34.38batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 34.35batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 34.28batch/s] 34%|█████████▏                 | 346/1014 [00:10<00:19, 34.30batch/s] 35%|█████████▎                 | 351/1014 [00:10<00:19, 34.37batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:19, 34.26batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:19, 34.28batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 34.30batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 34.34batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 34.38batch/s] 38%|██████████▏                | 381/1014 [00:11<00:18, 34.36batch/s] 38%|██████████▎                | 386/1014 [00:11<00:18, 34.33batch/s] 39%|██████████▍                | 391/1014 [00:11<00:18, 34.38batch/s] 39%|██████████▌                | 396/1014 [00:11<00:17, 34.42batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 34.39batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 34.20batch/s] 41%|██████████▉                | 411/1014 [00:12<00:17, 34.21batch/s] 41%|███████████                | 416/1014 [00:12<00:17, 34.12batch/s] 42%|███████████▏               | 421/1014 [00:12<00:17, 34.07batch/s] 42%|███████████▎               | 426/1014 [00:12<00:17, 34.05batch/s] 43%|███████████▍               | 431/1014 [00:12<00:17, 34.10batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 34.09batch/s] 43%|███████████▋               | 441/1014 [00:12<00:16, 34.09batch/s] 44%|███████████▉               | 446/1014 [00:13<00:16, 34.17batch/s] 44%|████████████               | 451/1014 [00:13<00:16, 34.15batch/s] 45%|████████████▏              | 456/1014 [00:13<00:16, 34.06batch/s] 45%|████████████▎              | 461/1014 [00:13<00:16, 34.03batch/s] 46%|████████████▍              | 466/1014 [00:13<00:16, 34.01batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 34.05batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 34.11batch/s] 47%|████████████▊              | 481/1014 [00:14<00:15, 34.08batch/s] 48%|████████████▉              | 486/1014 [00:14<00:15, 33.89batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 33.90batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:15, 33.89batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:15, 33.91batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 33.90batch/s] 50%|█████████████▌             | 511/1014 [00:15<00:14, 33.96batch/s] 51%|█████████████▋             | 516/1014 [00:15<00:14, 34.01batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 34.08batch/s] 52%|██████████████             | 526/1014 [00:15<00:14, 34.12batch/s] 52%|██████████████▏            | 531/1014 [00:15<00:14, 34.19batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 34.21batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 34.20batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 34.25batch/s] 54%|██████████████▋            | 551/1014 [00:16<00:13, 34.23batch/s] 55%|██████████████▊            | 556/1014 [00:16<00:13, 34.23batch/s] 55%|██████████████▉            | 561/1014 [00:16<00:13, 34.24batch/s] 56%|███████████████            | 566/1014 [00:16<00:13, 34.28batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 34.23batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 34.25batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.24batch/s] 58%|███████████████▌           | 586/1014 [00:17<00:12, 34.24batch/s] 58%|███████████████▋           | 591/1014 [00:17<00:12, 34.28batch/s] 59%|███████████████▊           | 596/1014 [00:17<00:12, 34.24batch/s] 59%|████████████████           | 601/1014 [00:17<00:12, 34.27batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 34.27batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.32batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 34.27batch/s] 61%|████████████████▌          | 621/1014 [00:18<00:11, 34.21batch/s] 62%|████████████████▋          | 626/1014 [00:18<00:11, 34.21batch/s] 62%|████████████████▊          | 631/1014 [00:18<00:11, 34.17batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:11, 34.11batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.08batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 34.10batch/s] 64%|█████████████████▎         | 651/1014 [00:19<00:10, 34.08batch/s] 65%|█████████████████▍         | 656/1014 [00:19<00:10, 34.14batch/s] 65%|█████████████████▌         | 661/1014 [00:19<00:10, 34.15batch/s] 66%|█████████████████▋         | 666/1014 [00:19<00:10, 34.12batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:10, 34.13batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 34.17batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 34.18batch/s] 68%|██████████████████▎        | 686/1014 [00:20<00:09, 34.19batch/s] 68%|██████████████████▍        | 691/1014 [00:20<00:09, 34.19batch/s] 69%|██████████████████▌        | 696/1014 [00:20<00:09, 34.18batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.18batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 34.26batch/s] 70%|██████████████████▉        | 711/1014 [00:20<00:08, 34.27batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 34.30batch/s] 71%|███████████████████▏       | 721/1014 [00:21<00:08, 34.30batch/s] 72%|███████████████████▎       | 726/1014 [00:21<00:08, 34.34batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.33batch/s] 73%|███████████████████▌       | 736/1014 [00:21<00:08, 34.29batch/s] 73%|███████████████████▋       | 741/1014 [00:21<00:07, 34.31batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 34.34batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 34.35batch/s] 75%|████████████████████▏      | 756/1014 [00:22<00:07, 34.27batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.25batch/s] 76%|████████████████████▍      | 766/1014 [00:22<00:07, 34.24batch/s] 76%|████████████████████▌      | 771/1014 [00:22<00:07, 34.23batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 34.23batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 34.26batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 34.25batch/s] 78%|█████████████████████      | 791/1014 [00:23<00:06, 34.21batch/s] 79%|█████████████████████▏     | 796/1014 [00:23<00:06, 34.20batch/s] 79%|█████████████████████▎     | 801/1014 [00:23<00:06, 34.14batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:06, 34.08batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 34.08batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 34.11batch/s] 81%|█████████████████████▊     | 821/1014 [00:24<00:05, 34.10batch/s] 81%|█████████████████████▉     | 826/1014 [00:24<00:05, 34.10batch/s] 82%|██████████████████████▏    | 831/1014 [00:24<00:05, 34.10batch/s] 82%|██████████████████████▎    | 836/1014 [00:24<00:05, 34.13batch/s] 83%|██████████████████████▍    | 841/1014 [00:24<00:05, 34.13batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 34.17batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.14batch/s] 84%|██████████████████████▊    | 856/1014 [00:25<00:04, 34.17batch/s] 85%|██████████████████████▉    | 861/1014 [00:25<00:04, 34.19batch/s] 85%|███████████████████████    | 866/1014 [00:25<00:04, 34.22batch/s] 86%|███████████████████████▏   | 871/1014 [00:25<00:04, 34.26batch/s] 86%|███████████████████████▎   | 876/1014 [00:25<00:04, 34.28batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.28batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 34.27batch/s] 88%|███████████████████████▋   | 891/1014 [00:26<00:03, 34.25batch/s] 88%|███████████████████████▊   | 896/1014 [00:26<00:03, 34.23batch/s] 89%|███████████████████████▉   | 901/1014 [00:26<00:03, 34.24batch/s] 89%|████████████████████████   | 906/1014 [00:26<00:03, 34.27batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:03, 34.26batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.27batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 34.26batch/s] 91%|████████████████████████▋  | 926/1014 [00:27<00:02, 34.24batch/s] 92%|████████████████████████▊  | 931/1014 [00:27<00:02, 34.26batch/s] 92%|████████████████████████▉  | 936/1014 [00:27<00:02, 34.26batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.24batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.27batch/s] 94%|█████████████████████████▎ | 951/1014 [00:27<00:01, 34.28batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 34.28batch/s] 95%|█████████████████████████▌ | 961/1014 [00:28<00:01, 34.30batch/s] 95%|█████████████████████████▋ | 966/1014 [00:28<00:01, 34.29batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.32batch/s] 96%|█████████████████████████▉ | 976/1014 [00:28<00:01, 34.32batch/s] 97%|██████████████████████████ | 981/1014 [00:28<00:00, 34.30batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 34.26batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 34.27batch/s] 98%|██████████████████████████▌| 996/1014 [00:29<00:00, 34.30batch/s] 99%|█████████████████████████▋| 1001/1014 [00:29<00:00, 34.30batch/s] 99%|█████████████████████████▊| 1006/1014 [00:29<00:00, 34.30batch/s]100%|█████████████████████████▉| 1011/1014 [00:29<00:00, 34.32batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.33batch/s]
Validation 61 -> LOSS = 0.24
Validation 61 -> BLEU = 96.80, 98.7/97.4/96.3/95.1 (BP=0.999, ratio=0.999, hyp_len=14371, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 57
--> Best BLEU so far: 96.92 @ validation 60
Starting Epoch 62
Epoch 62 - update      29430 => loss:   0.033 (#OOM: 0)
Epoch 62 - update      29460 => loss:   0.079 (#OOM: 0)
Epoch 62 - update      29490 => loss:   0.072 (#OOM: 0)
Epoch 62 - update      29520 => loss:   0.050 (#OOM: 0)
Epoch 62 - update      29550 => loss:   0.042 (#OOM: 0)
Epoch 62 - update      29580 => loss:   0.059 (#OOM: 0)
Epoch 62 - update      29610 => loss:   0.093 (#OOM: 0)
Epoch 62 - update      29640 => loss:   0.068 (#OOM: 0)
Epoch 62 - update      29670 => loss:   0.019 (#OOM: 0)
Epoch 62 - update      29700 => loss:   0.044 (#OOM: 0)
Epoch 62 - update      29730 => loss:   0.041 (#OOM: 0)
Epoch 62 - update      29760 => loss:   0.050 (#OOM: 0)
Epoch 62 - update      29790 => loss:   0.022 (#OOM: 0)
Epoch 62 - update      29820 => loss:   0.058 (#OOM: 0)
Epoch 62 - update      29850 => loss:   0.060 (#OOM: 0)
Epoch 62 - update      29880 => loss:   0.057 (#OOM: 0)
--> Epoch 62 finished with mean loss 0.06308
--> Overhead/Training/Evaluation: 0.61/0.72/0.00 mins (total: 1.33 mins)   (675 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.91batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.60batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.58batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.37batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.46batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.58batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.82batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.92batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.09batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.36batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.52batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.96batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 12.91batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.36batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.97batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.00batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:28, 34.93batch/s]  1%|▎                           | 10/1014 [00:00<00:29, 34.22batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 35.98batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 33.96batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.29batch/s]  3%|▊                           | 30/1014 [00:00<00:28, 34.95batch/s]  3%|▉                           | 35/1014 [00:00<00:27, 35.38batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.86batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 36.31batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 35.95batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 35.91batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 35.70batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 36.20batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 36.39batch/s]  7%|██                          | 75/1014 [00:02<00:26, 36.10batch/s]  8%|██▏                         | 80/1014 [00:02<00:25, 35.99batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.16batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 35.68batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 35.26batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.76batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.73batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 34.88batch/s] 11%|███                        | 115/1014 [00:03<00:25, 34.98batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 35.09batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 35.23batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 35.39batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 35.62batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.75batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.85batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.93batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 35.79batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 35.76batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 35.73batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 35.71batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.70batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.61batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.67batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.64batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 35.64batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.48batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.55batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.52batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.63batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.81batch/s] 22%|█████▉                     | 225/1014 [00:06<00:21, 35.96batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 35.75batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 35.78batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.75batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.61batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.47batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.50batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.34batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.16batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.27batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.20batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.23batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 35.30batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.13batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.51batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.51batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.49batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 34.36batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.43batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.45batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.50batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.56batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.52batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.53batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 34.42batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.37batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.48batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.52batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.59batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.57batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.49batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.52batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.61batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.60batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.52batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.53batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.45batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.53batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 34.51batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.47batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.49batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.60batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.63batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.66batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.63batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 34.72batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.76batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 34.84batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.84batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.86batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.86batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.88batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.87batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.85batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 34.88batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.87batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.87batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.87batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.91batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 34.91batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.90batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 34.90batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.94batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.99batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.04batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 35.07batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:13, 35.09batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.17batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 35.25batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 35.23batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.14batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.11batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 35.17batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 35.19batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.16batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 35.16batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 35.19batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.23batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 35.27batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.28batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 35.27batch/s] 62%|████████████████▊          | 630/1014 [00:17<00:10, 35.28batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 35.19batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 35.22batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 35.29batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.24batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.21batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 35.23batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 35.25batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 35.25batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 35.28batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 35.29batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.34batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 35.29batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 35.35batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.30batch/s] 70%|██████████████████▊        | 705/1014 [00:19<00:08, 35.28batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.25batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.25batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.23batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.15batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.11batch/s] 72%|███████████████████▌       | 735/1014 [00:20<00:07, 35.05batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 35.04batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.08batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 35.15batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.07batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.04batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:07, 35.04batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.01batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 35.00batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 35.03batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.06batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.10batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 35.04batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 35.01batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.00batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.99batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.99batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.00batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 35.00batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.96batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 34.97batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:04, 34.93batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.94batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.93batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.91batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.93batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 34.89batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 34.85batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.82batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.84batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.82batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.83batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.82batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 34.78batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.79batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.80batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.79batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.73batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.73batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.66batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.64batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.63batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.61batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.66batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.64batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.65batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.61batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.64batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.60batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.62batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.47batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.49batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.49batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.49batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.49batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.47batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.48batch/s]
Validation 62 -> LOSS = 0.24
Validation 62 -> BLEU = 96.35, 98.2/96.9/95.8/94.6 (BP=1.000, ratio=1.004, hyp_len=14433, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 57
--> Best BLEU so far: 96.92 @ validation 60
Starting Epoch 63
Epoch 63 - update      29910 => loss:   0.063 (#OOM: 0)
Epoch 63 - update      29940 => loss:   0.069 (#OOM: 0)
Epoch 63 - update      29970 => loss:   0.051 (#OOM: 0)
Epoch 63 - update      30000 => loss:   0.061 (#OOM: 0)
Epoch 63 - update      30030 => loss:   0.077 (#OOM: 0)
Epoch 63 - update      30060 => loss:   0.061 (#OOM: 0)
Epoch 63 - update      30090 => loss:   0.054 (#OOM: 0)
Epoch 63 - update      30120 => loss:   0.051 (#OOM: 0)
Epoch 63 - update      30150 => loss:   0.076 (#OOM: 0)
Epoch 63 - update      30180 => loss:   0.050 (#OOM: 0)
Epoch 63 - update      30210 => loss:   0.061 (#OOM: 0)
Epoch 63 - update      30240 => loss:   0.064 (#OOM: 0)
Epoch 63 - update      30270 => loss:   0.075 (#OOM: 0)
Epoch 63 - update      30300 => loss:   0.073 (#OOM: 0)
Epoch 63 - update      30330 => loss:   0.076 (#OOM: 0)
Epoch 63 - update      30360 => loss:   0.028 (#OOM: 0)
--> Epoch 63 finished with mean loss 0.06185
--> Overhead/Training/Evaluation: 0.67/0.73/0.00 mins (total: 1.40 mins)   (662 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  7.71batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 12.38batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 14.06batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 14.61batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.93batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.76batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.44batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 13.51batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.61batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.88batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.70batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.78batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 14.02batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.94batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.59batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.34batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.45batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.53batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 36.04batch/s]  1%|▎                            | 9/1014 [00:00<00:24, 40.20batch/s]  1%|▍                           | 14/1014 [00:00<00:24, 40.10batch/s]  2%|▌                           | 19/1014 [00:00<00:26, 37.64batch/s]  2%|▋                           | 24/1014 [00:00<00:25, 38.20batch/s]  3%|▊                           | 29/1014 [00:00<00:25, 37.91batch/s]  3%|▉                           | 34/1014 [00:00<00:26, 37.31batch/s]  4%|█                           | 39/1014 [00:01<00:26, 36.38batch/s]  4%|█▏                          | 44/1014 [00:01<00:26, 36.04batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 35.63batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 36.11batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 36.16batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 36.45batch/s]  7%|█▉                          | 69/1014 [00:01<00:26, 36.02batch/s]  7%|██                          | 74/1014 [00:02<00:26, 35.89batch/s]  8%|██▏                         | 79/1014 [00:02<00:26, 35.58batch/s]  8%|██▎                         | 84/1014 [00:02<00:26, 34.63batch/s]  9%|██▍                         | 89/1014 [00:02<00:26, 34.58batch/s]  9%|██▌                         | 94/1014 [00:02<00:26, 34.53batch/s] 10%|██▋                         | 99/1014 [00:02<00:26, 34.61batch/s] 10%|██▊                        | 104/1014 [00:02<00:26, 34.89batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 35.00batch/s] 11%|███                        | 114/1014 [00:03<00:25, 34.93batch/s] 12%|███▏                       | 119/1014 [00:03<00:25, 35.03batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 34.75batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.50batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.44batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 34.37batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.44batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 34.32batch/s] 15%|████                       | 154/1014 [00:04<00:25, 34.01batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.20batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.29batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.46batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.18batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 34.12batch/s] 18%|████▉                      | 184/1014 [00:05<00:24, 34.23batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 34.08batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 34.08batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.22batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.39batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.38batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.45batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 34.52batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.62batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.64batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.59batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.68batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.69batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 34.74batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 34.79batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.64batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.69batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.72batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 34.59batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.44batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 34.46batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.30batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.40batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.47batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.44batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 34.46batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.49batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.38batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 34.51batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.52batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 34.55batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.63batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 34.63batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.74batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 34.84batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 34.88batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.88batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.89batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.81batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 34.88batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.89batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 34.97batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 34.94batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.02batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.02batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.03batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.02batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.00batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.01batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.04batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.00batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.98batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.94batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.97batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.89batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 35.00batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.02batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.09batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.16batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 35.17batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 35.23batch/s] 48%|█████████████              | 489/1014 [00:13<00:14, 35.24batch/s] 49%|█████████████▏             | 494/1014 [00:13<00:14, 35.29batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.25batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 35.30batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.28batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.21batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 35.24batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.26batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 35.22batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 35.18batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.23batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.27batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.29batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.32batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.30batch/s] 56%|███████████████            | 564/1014 [00:15<00:12, 35.26batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.23batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.21batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.12batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.10batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.18batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.27batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.27batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.23batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.13batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.19batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.14batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 35.21batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.19batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 35.20batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 35.25batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.28batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.32batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.30batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.31batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.29batch/s] 66%|█████████████████▊         | 669/1014 [00:18<00:09, 35.28batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.25batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.27batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.22batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.21batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.26batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.20batch/s] 69%|██████████████████▋        | 704/1014 [00:19<00:08, 35.21batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.19batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.19batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.19batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.19batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 35.20batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.19batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 35.16batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 35.17batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.18batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.18batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.17batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.20batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.20batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 35.17batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.22batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.17batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.20batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.18batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.17batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.16batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 35.13batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.12batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.09batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.15batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.18batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.17batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.11batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 35.13batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 35.14batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.13batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.16batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.17batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.16batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.16batch/s] 87%|███████████████████████▍   | 879/1014 [00:24<00:03, 35.16batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 35.17batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.22batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.24batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.22batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.18batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.21batch/s] 90%|████████████████████████▎  | 914/1014 [00:25<00:02, 35.17batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.21batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.24batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.22batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.22batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 35.21batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.17batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.20batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 35.23batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.23batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 35.24batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 35.26batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 35.23batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.19batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.19batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.21batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.19batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.19batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 35.18batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.16batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.16batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.16batch/s]
Validation 63 -> LOSS = 0.24
Validation 63 -> BLEU = 96.87, 98.7/97.4/96.3/95.2 (BP=1.000, ratio=1.000, hyp_len=14376, ref_len=14382)
** Learning rate changed -> 0.0001
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 57
--> Best BLEU so far: 96.92 @ validation 60
Starting Epoch 64
Epoch 64 - update      30390 => loss:   0.050 (#OOM: 0)
Epoch 64 - update      30420 => loss:   0.076 (#OOM: 0)
Epoch 64 - update      30450 => loss:   0.052 (#OOM: 0)
Epoch 64 - update      30480 => loss:   0.063 (#OOM: 0)
Epoch 64 - update      30510 => loss:   0.068 (#OOM: 0)
Epoch 64 - update      30540 => loss:   0.076 (#OOM: 0)
Epoch 64 - update      30570 => loss:   0.083 (#OOM: 0)
Epoch 64 - update      30600 => loss:   0.057 (#OOM: 0)
Epoch 64 - update      30630 => loss:   0.053 (#OOM: 0)
Epoch 64 - update      30660 => loss:   0.067 (#OOM: 0)
Epoch 64 - update      30690 => loss:   0.045 (#OOM: 0)
Epoch 64 - update      30720 => loss:   0.072 (#OOM: 0)
Epoch 64 - update      30750 => loss:   0.042 (#OOM: 0)
Epoch 64 - update      30780 => loss:   0.071 (#OOM: 0)
Epoch 64 - update      30810 => loss:   0.044 (#OOM: 0)
Epoch 64 - update      30840 => loss:   0.057 (#OOM: 0)
--> Epoch 64 finished with mean loss 0.05861
--> Overhead/Training/Evaluation: 0.67/0.72/0.00 mins (total: 1.40 mins)   (667 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.60batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 13.42batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 14.05batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.74batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.62batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.88batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.07batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.20batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.66batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 14.18batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.83batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.10batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.98batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:36, 27.79batch/s]  1%|▏                            | 7/1014 [00:00<00:33, 30.06batch/s]  1%|▎                           | 11/1014 [00:00<00:32, 30.89batch/s]  1%|▍                           | 15/1014 [00:00<00:33, 29.87batch/s]  2%|▌                           | 19/1014 [00:00<00:32, 30.49batch/s]  2%|▋                           | 23/1014 [00:00<00:32, 30.91batch/s]  3%|▋                           | 27/1014 [00:00<00:31, 30.92batch/s]  3%|▊                           | 31/1014 [00:01<00:32, 30.62batch/s]  3%|▉                           | 35/1014 [00:01<00:31, 30.99batch/s]  4%|█                           | 39/1014 [00:01<00:31, 31.44batch/s]  4%|█▏                          | 43/1014 [00:01<00:31, 31.21batch/s]  5%|█▎                          | 47/1014 [00:01<00:30, 31.57batch/s]  5%|█▍                          | 51/1014 [00:01<00:30, 31.80batch/s]  5%|█▌                          | 55/1014 [00:01<00:29, 32.03batch/s]  6%|█▋                          | 59/1014 [00:01<00:29, 32.07batch/s]  6%|█▋                          | 63/1014 [00:01<00:29, 32.21batch/s]  7%|█▊                          | 67/1014 [00:02<00:29, 32.26batch/s]  7%|█▉                          | 71/1014 [00:02<00:30, 31.33batch/s]  7%|██                          | 75/1014 [00:02<00:29, 31.47batch/s]  8%|██▏                         | 80/1014 [00:02<00:29, 31.97batch/s]  8%|██▎                         | 85/1014 [00:02<00:29, 31.86batch/s]  9%|██▍                         | 90/1014 [00:02<00:29, 31.68batch/s]  9%|██▌                         | 95/1014 [00:02<00:28, 31.69batch/s] 10%|██▋                        | 100/1014 [00:03<00:28, 31.72batch/s] 10%|██▊                        | 105/1014 [00:03<00:28, 31.96batch/s] 11%|██▉                        | 110/1014 [00:03<00:28, 32.17batch/s] 11%|███                        | 115/1014 [00:03<00:27, 32.26batch/s] 12%|███▏                       | 120/1014 [00:03<00:27, 32.52batch/s] 12%|███▎                       | 125/1014 [00:03<00:27, 32.30batch/s] 13%|███▍                       | 130/1014 [00:03<00:27, 32.57batch/s] 13%|███▌                       | 135/1014 [00:04<00:26, 32.82batch/s] 14%|███▋                       | 140/1014 [00:04<00:26, 32.80batch/s] 14%|███▊                       | 145/1014 [00:04<00:26, 32.80batch/s] 15%|███▉                       | 150/1014 [00:04<00:26, 32.79batch/s] 15%|████▏                      | 155/1014 [00:04<00:26, 33.00batch/s] 16%|████▎                      | 160/1014 [00:04<00:25, 33.18batch/s] 16%|████▍                      | 165/1014 [00:04<00:25, 33.29batch/s] 17%|████▌                      | 170/1014 [00:05<00:25, 33.41batch/s] 17%|████▋                      | 175/1014 [00:05<00:25, 33.39batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 33.52batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 33.46batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 33.53batch/s] 19%|█████▏                     | 195/1014 [00:05<00:24, 33.50batch/s] 20%|█████▎                     | 200/1014 [00:05<00:24, 33.43batch/s] 20%|█████▍                     | 205/1014 [00:06<00:24, 33.46batch/s] 21%|█████▌                     | 210/1014 [00:06<00:24, 33.44batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 33.44batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 33.55batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 33.54batch/s] 23%|██████                     | 230/1014 [00:06<00:23, 33.46batch/s] 23%|██████▎                    | 235/1014 [00:07<00:23, 33.50batch/s] 24%|██████▍                    | 240/1014 [00:07<00:23, 33.51batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 33.53batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 33.43batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 33.47batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 33.55batch/s] 26%|███████                    | 265/1014 [00:07<00:22, 33.72batch/s] 27%|███████▏                   | 270/1014 [00:08<00:22, 33.71batch/s] 27%|███████▎                   | 275/1014 [00:08<00:21, 33.77batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 33.80batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 33.84batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 33.72batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 33.78batch/s] 30%|███████▉                   | 300/1014 [00:08<00:21, 33.87batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 33.98batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 34.07batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.14batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.04batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 34.00batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 34.10batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.12batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.20batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 34.29batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.28batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.28batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 34.28batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.33batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.41batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.42batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.51batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.44batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.44batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.43batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.39batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.33batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.45batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 34.52batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.52batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.51batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.54batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.53batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.40batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.40batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.46batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.43batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.36batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.37batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.40batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.47batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.46batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.55batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.56batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.58batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.57batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.44batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.40batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.43batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.44batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.53batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 34.56batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.60batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.63batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.57batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.57batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.58batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.57batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 34.64batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.67batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.71batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.70batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.70batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.70batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.66batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.67batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.72batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.75batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.75batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.79batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 34.82batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.84batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.89batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.91batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.93batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.92batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.92batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 34.96batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:09, 34.90batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.83batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.85batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.88batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.88batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.87batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 34.90batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:08, 34.92batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.92batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.87batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.88batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.89batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.90batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 34.90batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:07, 34.88batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.88batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.92batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.91batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.94batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.98batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:07, 34.96batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:06, 34.87batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.83batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.87batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.88batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.89batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.83batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.78batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.73batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.73batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.74batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.73batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.66batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.60batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.65batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.66batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.56batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.56batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.58batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.55batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.58batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.56batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.58batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.60batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.59batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.60batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.61batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.60batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.60batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.63batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.62batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.62batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.62batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.64batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.66batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.64batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.65batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.63batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.64batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.63batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.62batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.60batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.59batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.57batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.57batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.58batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.60batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.63batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.59batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.59batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.60batch/s]
Validation 64 -> LOSS = 0.24
Validation 64 -> BLEU = 96.89, 98.7/97.4/96.3/95.2 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 64
--> Best BLEU so far: 96.92 @ validation 60
Starting Epoch 65
Epoch 65 - update      30870 => loss:   0.037 (#OOM: 0)
Epoch 65 - update      30900 => loss:   0.040 (#OOM: 0)
Epoch 65 - update      30930 => loss:   0.070 (#OOM: 0)
Epoch 65 - update      30960 => loss:   0.058 (#OOM: 0)
Epoch 65 - update      30990 => loss:   0.033 (#OOM: 0)
Epoch 65 - update      31020 => loss:   0.040 (#OOM: 0)
Epoch 65 - update      31050 => loss:   0.049 (#OOM: 0)
Epoch 65 - update      31080 => loss:   0.057 (#OOM: 0)
Epoch 65 - update      31110 => loss:   0.049 (#OOM: 0)
Epoch 65 - update      31140 => loss:   0.050 (#OOM: 0)
Epoch 65 - update      31170 => loss:   0.014 (#OOM: 0)
Epoch 65 - update      31200 => loss:   0.078 (#OOM: 0)
Epoch 65 - update      31230 => loss:   0.039 (#OOM: 0)
Epoch 65 - update      31260 => loss:   0.052 (#OOM: 0)
Epoch 65 - update      31290 => loss:   0.061 (#OOM: 0)
Epoch 65 - update      31320 => loss:   0.055 (#OOM: 0)
--> Epoch 65 finished with mean loss 0.05645
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.33 mins)   (679 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 14.34batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 15.99batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.61batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.45batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 10.91batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 11.68batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.74batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.85batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.99batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.00batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.70batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.12batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.16batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.16batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.30batch/s]  1%|▏                            | 8/1014 [00:00<00:31, 31.54batch/s]  1%|▎                           | 12/1014 [00:00<00:31, 32.31batch/s]  2%|▍                           | 17/1014 [00:00<00:28, 34.68batch/s]  2%|▌                           | 22/1014 [00:00<00:27, 35.85batch/s]  3%|▋                           | 27/1014 [00:00<00:26, 36.60batch/s]  3%|▉                           | 32/1014 [00:00<00:25, 38.15batch/s]  4%|█                           | 37/1014 [00:01<00:26, 36.74batch/s]  4%|█▏                          | 42/1014 [00:01<00:26, 36.59batch/s]  5%|█▎                          | 47/1014 [00:01<00:27, 35.78batch/s]  5%|█▍                          | 52/1014 [00:01<00:26, 36.31batch/s]  6%|█▌                          | 57/1014 [00:01<00:25, 36.83batch/s]  6%|█▋                          | 62/1014 [00:01<00:26, 36.31batch/s]  7%|█▊                          | 67/1014 [00:01<00:26, 35.97batch/s]  7%|█▉                          | 72/1014 [00:01<00:26, 36.21batch/s]  8%|██▏                         | 77/1014 [00:02<00:25, 36.06batch/s]  8%|██▎                         | 82/1014 [00:02<00:25, 36.52batch/s]  9%|██▍                         | 87/1014 [00:02<00:25, 36.15batch/s]  9%|██▌                         | 92/1014 [00:02<00:25, 35.79batch/s] 10%|██▋                         | 97/1014 [00:02<00:25, 35.56batch/s] 10%|██▋                        | 102/1014 [00:02<00:25, 35.13batch/s] 11%|██▊                        | 107/1014 [00:03<00:25, 35.18batch/s] 11%|██▉                        | 112/1014 [00:03<00:25, 35.46batch/s] 12%|███                        | 117/1014 [00:03<00:25, 35.71batch/s] 12%|███▏                       | 122/1014 [00:03<00:24, 36.00batch/s] 13%|███▍                       | 127/1014 [00:03<00:24, 35.75batch/s] 13%|███▌                       | 132/1014 [00:03<00:24, 35.70batch/s] 14%|███▋                       | 137/1014 [00:03<00:24, 35.64batch/s] 14%|███▊                       | 142/1014 [00:03<00:24, 35.80batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 35.83batch/s] 15%|████                       | 152/1014 [00:04<00:24, 35.92batch/s] 15%|████▏                      | 157/1014 [00:04<00:23, 35.93batch/s] 16%|████▎                      | 162/1014 [00:04<00:23, 36.16batch/s] 16%|████▍                      | 167/1014 [00:04<00:23, 36.17batch/s] 17%|████▌                      | 172/1014 [00:04<00:23, 36.20batch/s] 17%|████▋                      | 177/1014 [00:04<00:23, 36.17batch/s] 18%|████▊                      | 182/1014 [00:05<00:22, 36.33batch/s] 18%|████▉                      | 187/1014 [00:05<00:22, 36.16batch/s] 19%|█████                      | 192/1014 [00:05<00:22, 36.25batch/s] 19%|█████▏                     | 197/1014 [00:05<00:22, 36.04batch/s] 20%|█████▍                     | 202/1014 [00:05<00:22, 36.06batch/s] 20%|█████▌                     | 207/1014 [00:05<00:22, 35.99batch/s] 21%|█████▋                     | 212/1014 [00:05<00:22, 35.98batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 35.90batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 35.96batch/s] 22%|██████                     | 227/1014 [00:06<00:21, 36.01batch/s] 23%|██████▏                    | 232/1014 [00:06<00:21, 36.18batch/s] 23%|██████▎                    | 237/1014 [00:06<00:21, 36.18batch/s] 24%|██████▍                    | 242/1014 [00:06<00:21, 36.21batch/s] 24%|██████▌                    | 247/1014 [00:06<00:21, 36.37batch/s] 25%|██████▋                    | 252/1014 [00:06<00:20, 36.32batch/s] 25%|██████▊                    | 257/1014 [00:07<00:20, 36.47batch/s] 26%|██████▉                    | 262/1014 [00:07<00:20, 36.43batch/s] 26%|███████                    | 267/1014 [00:07<00:20, 36.32batch/s] 27%|███████▏                   | 272/1014 [00:07<00:20, 36.22batch/s] 27%|███████▍                   | 277/1014 [00:07<00:20, 36.04batch/s] 28%|███████▌                   | 282/1014 [00:07<00:20, 36.19batch/s] 28%|███████▋                   | 287/1014 [00:07<00:20, 35.97batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.90batch/s] 29%|███████▉                   | 297/1014 [00:08<00:19, 35.94batch/s] 30%|████████                   | 302/1014 [00:08<00:19, 35.94batch/s] 30%|████████▏                  | 307/1014 [00:08<00:19, 36.07batch/s] 31%|████████▎                  | 312/1014 [00:08<00:19, 36.09batch/s] 31%|████████▍                  | 317/1014 [00:08<00:19, 36.08batch/s] 32%|████████▌                  | 322/1014 [00:08<00:19, 36.15batch/s] 32%|████████▋                  | 327/1014 [00:09<00:18, 36.22batch/s] 33%|████████▊                  | 332/1014 [00:09<00:18, 36.20batch/s] 33%|████████▉                  | 337/1014 [00:09<00:18, 36.14batch/s] 34%|█████████                  | 342/1014 [00:09<00:18, 36.18batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:18, 36.26batch/s] 35%|█████████▎                 | 352/1014 [00:09<00:18, 36.14batch/s] 35%|█████████▌                 | 357/1014 [00:09<00:18, 36.12batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 36.07batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:17, 36.04batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:17, 36.00batch/s] 37%|██████████                 | 377/1014 [00:10<00:17, 36.01batch/s] 38%|██████████▏                | 382/1014 [00:10<00:17, 36.07batch/s] 38%|██████████▎                | 387/1014 [00:10<00:17, 36.11batch/s] 39%|██████████▍                | 392/1014 [00:10<00:17, 36.10batch/s] 39%|██████████▌                | 397/1014 [00:10<00:17, 36.20batch/s] 40%|██████████▋                | 402/1014 [00:11<00:16, 36.19batch/s] 40%|██████████▊                | 407/1014 [00:11<00:16, 36.18batch/s] 41%|██████████▉                | 412/1014 [00:11<00:16, 36.20batch/s] 41%|███████████                | 417/1014 [00:11<00:16, 36.05batch/s] 42%|███████████▏               | 422/1014 [00:11<00:16, 36.01batch/s] 42%|███████████▎               | 427/1014 [00:11<00:16, 35.98batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 35.96batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 35.92batch/s] 44%|███████████▊               | 442/1014 [00:12<00:15, 35.93batch/s] 44%|███████████▉               | 447/1014 [00:12<00:15, 35.92batch/s] 45%|████████████               | 452/1014 [00:12<00:15, 35.90batch/s] 45%|████████████▏              | 457/1014 [00:12<00:15, 35.82batch/s] 46%|████████████▎              | 462/1014 [00:12<00:15, 35.72batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 35.74batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.73batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 35.75batch/s] 48%|████████████▊              | 482/1014 [00:13<00:14, 35.80batch/s] 48%|████████████▉              | 487/1014 [00:13<00:14, 35.84batch/s] 49%|█████████████              | 492/1014 [00:13<00:14, 35.82batch/s] 49%|█████████████▏             | 497/1014 [00:13<00:14, 35.86batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 35.83batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 35.71batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 35.76batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:13, 35.71batch/s] 51%|█████████████▉             | 522/1014 [00:14<00:13, 35.73batch/s] 52%|██████████████             | 527/1014 [00:14<00:13, 35.74batch/s] 52%|██████████████▏            | 532/1014 [00:14<00:13, 35.76batch/s] 53%|██████████████▎            | 537/1014 [00:15<00:13, 35.79batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 35.84batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 35.76batch/s] 54%|██████████████▋            | 552/1014 [00:15<00:12, 35.81batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:12, 35.82batch/s] 55%|██████████████▉            | 562/1014 [00:15<00:12, 35.82batch/s] 56%|███████████████            | 567/1014 [00:15<00:12, 35.81batch/s] 56%|███████████████▏           | 572/1014 [00:15<00:12, 35.78batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 35.81batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 35.80batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:11, 35.76batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:11, 35.79batch/s] 59%|███████████████▉           | 597/1014 [00:16<00:11, 35.82batch/s] 59%|████████████████           | 602/1014 [00:16<00:11, 35.83batch/s] 60%|████████████████▏          | 607/1014 [00:16<00:11, 35.83batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 35.82batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 35.85batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:10, 35.79batch/s] 62%|████████████████▋          | 627/1014 [00:17<00:10, 35.77batch/s] 62%|████████████████▊          | 632/1014 [00:17<00:10, 35.74batch/s] 63%|████████████████▉          | 637/1014 [00:17<00:10, 35.77batch/s] 63%|█████████████████          | 642/1014 [00:17<00:10, 35.75batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 35.70batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 35.69batch/s] 65%|█████████████████▍         | 657/1014 [00:18<00:09, 35.73batch/s] 65%|█████████████████▋         | 662/1014 [00:18<00:09, 35.65batch/s] 66%|█████████████████▊         | 667/1014 [00:18<00:09, 35.64batch/s] 66%|█████████████████▉         | 672/1014 [00:18<00:09, 35.60batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 35.54batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 35.50batch/s] 68%|██████████████████▎        | 687/1014 [00:19<00:09, 35.47batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 35.42batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:08, 35.38batch/s] 69%|██████████████████▋        | 702/1014 [00:19<00:08, 35.39batch/s] 70%|██████████████████▊        | 707/1014 [00:19<00:08, 35.40batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 35.37batch/s] 71%|███████████████████        | 717/1014 [00:20<00:08, 35.35batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 35.35batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 35.37batch/s] 72%|███████████████████▍       | 732/1014 [00:20<00:07, 35.41batch/s] 73%|███████████████████▌       | 737/1014 [00:20<00:07, 35.31batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 35.32batch/s] 74%|███████████████████▉       | 747/1014 [00:21<00:07, 35.27batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 35.25batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 35.20batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 35.17batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:07, 35.20batch/s] 76%|████████████████████▌      | 772/1014 [00:21<00:06, 35.17batch/s] 77%|████████████████████▋      | 777/1014 [00:22<00:06, 35.16batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 35.15batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.13batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 35.14batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 35.13batch/s] 79%|█████████████████████▎     | 802/1014 [00:22<00:06, 35.14batch/s] 80%|█████████████████████▍     | 807/1014 [00:22<00:05, 35.16batch/s] 80%|█████████████████████▌     | 812/1014 [00:23<00:05, 35.11batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 35.13batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 35.14batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 35.19batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 35.17batch/s] 83%|██████████████████████▎    | 837/1014 [00:23<00:05, 35.20batch/s] 83%|██████████████████████▍    | 842/1014 [00:23<00:04, 35.20batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 35.18batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 35.22batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 35.25batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 35.24batch/s] 86%|███████████████████████    | 867/1014 [00:24<00:04, 35.26batch/s] 86%|███████████████████████▏   | 872/1014 [00:24<00:04, 35.31batch/s] 86%|███████████████████████▎   | 877/1014 [00:24<00:03, 35.30batch/s] 87%|███████████████████████▍   | 882/1014 [00:24<00:03, 35.31batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 35.32batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 35.31batch/s] 88%|███████████████████████▉   | 897/1014 [00:25<00:03, 35.33batch/s] 89%|████████████████████████   | 902/1014 [00:25<00:03, 35.30batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 35.31batch/s] 90%|████████████████████████▎  | 912/1014 [00:25<00:02, 35.32batch/s] 90%|████████████████████████▍  | 917/1014 [00:25<00:02, 35.31batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 35.30batch/s] 91%|████████████████████████▋  | 927/1014 [00:26<00:02, 35.29batch/s] 92%|████████████████████████▊  | 932/1014 [00:26<00:02, 35.34batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.33batch/s] 93%|█████████████████████████  | 942/1014 [00:26<00:02, 35.30batch/s] 93%|█████████████████████████▏ | 947/1014 [00:26<00:01, 35.28batch/s] 94%|█████████████████████████▎ | 952/1014 [00:26<00:01, 35.27batch/s] 94%|█████████████████████████▍ | 957/1014 [00:27<00:01, 35.26batch/s] 95%|█████████████████████████▌ | 962/1014 [00:27<00:01, 35.23batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.24batch/s] 96%|█████████████████████████▉ | 972/1014 [00:27<00:01, 35.28batch/s] 96%|██████████████████████████ | 977/1014 [00:27<00:01, 35.25batch/s] 97%|██████████████████████████▏| 982/1014 [00:27<00:00, 35.28batch/s] 97%|██████████████████████████▎| 987/1014 [00:28<00:00, 35.23batch/s] 98%|██████████████████████████▍| 992/1014 [00:28<00:00, 35.24batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.24batch/s] 99%|█████████████████████████▋| 1002/1014 [00:28<00:00, 35.22batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 35.24batch/s]100%|█████████████████████████▉| 1012/1014 [00:28<00:00, 35.23batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.25batch/s]
Validation 65 -> LOSS = 0.24
Validation 65 -> BLEU = 96.88, 98.7/97.4/96.3/95.2 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 64
--> Best BLEU so far: 96.92 @ validation 60
Starting Epoch 66
Epoch 66 - update      31350 => loss:   0.070 (#OOM: 0)
Epoch 66 - update      31380 => loss:   0.056 (#OOM: 0)
Epoch 66 - update      31410 => loss:   0.012 (#OOM: 0)
Epoch 66 - update      31440 => loss:   0.052 (#OOM: 0)
Epoch 66 - update      31470 => loss:   0.056 (#OOM: 0)
Epoch 66 - update      31500 => loss:   0.038 (#OOM: 0)
Epoch 66 - update      31530 => loss:   0.033 (#OOM: 0)
Epoch 66 - update      31560 => loss:   0.042 (#OOM: 0)
Epoch 66 - update      31590 => loss:   0.052 (#OOM: 0)
Epoch 66 - update      31620 => loss:   0.027 (#OOM: 0)
Epoch 66 - update      31650 => loss:   0.034 (#OOM: 0)
Epoch 66 - update      31680 => loss:   0.072 (#OOM: 0)
Epoch 66 - update      31710 => loss:   0.033 (#OOM: 0)
Epoch 66 - update      31740 => loss:   0.070 (#OOM: 0)
Epoch 66 - update      31770 => loss:   0.064 (#OOM: 0)
Epoch 66 - update      31800 => loss:   0.102 (#OOM: 0)
--> Epoch 66 finished with mean loss 0.05593
--> Overhead/Training/Evaluation: 0.64/0.72/0.00 mins (total: 1.36 mins)   (668 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.87batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  9.45batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 10.46batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 12.52batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.25batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.14batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.43batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.08batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.99batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.09batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.43batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.83batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.23batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.22batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.15batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 32.51batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 33.98batch/s]  2%|▍                           | 17/1014 [00:00<00:27, 35.62batch/s]  2%|▌                           | 22/1014 [00:00<00:28, 35.13batch/s]  3%|▋                           | 27/1014 [00:00<00:28, 34.33batch/s]  3%|▉                           | 32/1014 [00:00<00:27, 35.26batch/s]  4%|█                           | 37/1014 [00:01<00:28, 34.24batch/s]  4%|█▏                          | 42/1014 [00:01<00:28, 34.32batch/s]  5%|█▎                          | 47/1014 [00:01<00:28, 34.28batch/s]  5%|█▍                          | 52/1014 [00:01<00:28, 33.88batch/s]  6%|█▌                          | 57/1014 [00:01<00:28, 34.13batch/s]  6%|█▋                          | 62/1014 [00:01<00:27, 34.33batch/s]  7%|█▊                          | 67/1014 [00:01<00:27, 34.55batch/s]  7%|█▉                          | 72/1014 [00:02<00:26, 35.02batch/s]  8%|██▏                         | 77/1014 [00:02<00:27, 34.37batch/s]  8%|██▎                         | 82/1014 [00:02<00:27, 34.29batch/s]  9%|██▍                         | 87/1014 [00:02<00:26, 34.42batch/s]  9%|██▌                         | 92/1014 [00:02<00:26, 34.17batch/s] 10%|██▋                         | 97/1014 [00:02<00:27, 33.89batch/s] 10%|██▋                        | 102/1014 [00:03<00:27, 33.72batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 34.07batch/s] 11%|██▉                        | 112/1014 [00:03<00:26, 34.50batch/s] 12%|███                        | 117/1014 [00:03<00:26, 34.29batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 34.36batch/s] 13%|███▍                       | 127/1014 [00:03<00:25, 34.49batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 34.60batch/s] 14%|███▋                       | 137/1014 [00:03<00:25, 34.36batch/s] 14%|███▊                       | 142/1014 [00:04<00:25, 34.24batch/s] 14%|███▉                       | 147/1014 [00:04<00:25, 34.15batch/s] 15%|████                       | 152/1014 [00:04<00:25, 33.68batch/s] 15%|████▏                      | 157/1014 [00:04<00:25, 33.73batch/s] 16%|████▎                      | 162/1014 [00:04<00:25, 33.82batch/s] 16%|████▍                      | 167/1014 [00:04<00:25, 33.87batch/s] 17%|████▌                      | 172/1014 [00:05<00:24, 33.70batch/s] 17%|████▋                      | 177/1014 [00:05<00:24, 33.59batch/s] 18%|████▊                      | 182/1014 [00:05<00:24, 33.72batch/s] 18%|████▉                      | 187/1014 [00:05<00:24, 33.72batch/s] 19%|█████                      | 192/1014 [00:05<00:24, 33.66batch/s] 19%|█████▏                     | 197/1014 [00:05<00:24, 33.58batch/s] 20%|█████▍                     | 202/1014 [00:06<00:24, 33.47batch/s] 20%|█████▌                     | 207/1014 [00:06<00:24, 33.40batch/s] 21%|█████▋                     | 212/1014 [00:06<00:23, 33.45batch/s] 21%|█████▊                     | 217/1014 [00:06<00:23, 33.69batch/s] 22%|█████▉                     | 222/1014 [00:06<00:23, 33.74batch/s] 22%|██████                     | 227/1014 [00:06<00:23, 33.65batch/s] 23%|██████▏                    | 232/1014 [00:06<00:23, 33.45batch/s] 23%|██████▎                    | 237/1014 [00:07<00:23, 33.56batch/s] 24%|██████▍                    | 242/1014 [00:07<00:23, 33.33batch/s] 24%|██████▌                    | 247/1014 [00:07<00:22, 33.41batch/s] 25%|██████▋                    | 252/1014 [00:07<00:22, 33.42batch/s] 25%|██████▊                    | 257/1014 [00:07<00:22, 33.42batch/s] 26%|██████▉                    | 262/1014 [00:07<00:22, 33.55batch/s] 26%|███████                    | 267/1014 [00:07<00:22, 33.55batch/s] 27%|███████▏                   | 272/1014 [00:08<00:22, 33.57batch/s] 27%|███████▍                   | 277/1014 [00:08<00:21, 33.55batch/s] 28%|███████▌                   | 282/1014 [00:08<00:21, 33.51batch/s] 28%|███████▋                   | 287/1014 [00:08<00:21, 33.58batch/s] 29%|███████▊                   | 292/1014 [00:08<00:21, 33.72batch/s] 29%|███████▉                   | 297/1014 [00:08<00:21, 33.74batch/s] 30%|████████                   | 302/1014 [00:08<00:21, 33.75batch/s] 30%|████████▏                  | 307/1014 [00:09<00:20, 33.87batch/s] 31%|████████▎                  | 312/1014 [00:09<00:20, 33.89batch/s] 31%|████████▍                  | 317/1014 [00:09<00:20, 33.90batch/s] 32%|████████▌                  | 322/1014 [00:09<00:20, 33.95batch/s] 32%|████████▋                  | 327/1014 [00:09<00:20, 33.96batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 34.18batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.26batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 34.22batch/s] 35%|█████████▎                 | 351/1014 [00:10<00:19, 34.28batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:19, 34.43batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 34.47batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.43batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.39batch/s] 38%|██████████▏                | 381/1014 [00:11<00:18, 34.42batch/s] 38%|██████████▎                | 387/1014 [00:11<00:18, 34.39batch/s] 39%|██████████▍                | 393/1014 [00:11<00:18, 34.35batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.36batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.38batch/s] 41%|██████████▉                | 411/1014 [00:11<00:17, 34.49batch/s] 41%|███████████                | 417/1014 [00:12<00:17, 34.44batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 34.46batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.46batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.45batch/s] 43%|███████████▋               | 441/1014 [00:12<00:16, 34.53batch/s] 44%|███████████▉               | 447/1014 [00:12<00:16, 34.53batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 34.54batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.41batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.36batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 34.30batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 34.38batch/s] 48%|████████████▊              | 483/1014 [00:14<00:15, 34.49batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.53batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.51batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:14, 34.52batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 34.51batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 34.48batch/s] 51%|█████████████▊             | 519/1014 [00:15<00:14, 34.52batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.55batch/s] 52%|██████████████▏            | 531/1014 [00:15<00:14, 34.48batch/s] 53%|██████████████▎            | 537/1014 [00:15<00:13, 34.45batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.52batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.53batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.61batch/s] 55%|██████████████▉            | 561/1014 [00:16<00:13, 34.62batch/s] 56%|███████████████            | 567/1014 [00:16<00:12, 34.65batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.70batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.78batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.81batch/s] 58%|███████████████▋           | 591/1014 [00:16<00:12, 34.82batch/s] 59%|███████████████▉           | 597/1014 [00:17<00:11, 34.79batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 34.84batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.88batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.80batch/s] 61%|████████████████▌          | 621/1014 [00:17<00:11, 34.82batch/s] 62%|████████████████▋          | 627/1014 [00:17<00:11, 34.91batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:10, 34.88batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.90batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.94batch/s] 64%|█████████████████▎         | 651/1014 [00:18<00:10, 34.98batch/s] 65%|█████████████████▍         | 657/1014 [00:18<00:10, 35.01batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:10, 34.99batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.97batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.93batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 34.95batch/s] 68%|██████████████████▎        | 687/1014 [00:19<00:09, 34.94batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:09, 34.92batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.94batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.96batch/s] 70%|██████████████████▉        | 711/1014 [00:20<00:08, 34.98batch/s] 71%|███████████████████        | 717/1014 [00:20<00:08, 34.98batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 34.93batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 34.96batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:07, 35.00batch/s] 73%|███████████████████▋       | 741/1014 [00:21<00:07, 35.01batch/s] 74%|███████████████████▉       | 747/1014 [00:21<00:07, 34.92batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.88batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.90batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:07, 34.94batch/s] 76%|████████████████████▌      | 771/1014 [00:22<00:06, 34.97batch/s] 77%|████████████████████▋      | 777/1014 [00:22<00:06, 34.97batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 34.91batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.87batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.84batch/s] 79%|█████████████████████▎     | 801/1014 [00:23<00:06, 34.80batch/s] 80%|█████████████████████▍     | 807/1014 [00:23<00:05, 34.85batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.84batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 34.87batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.91batch/s] 82%|██████████████████████▏    | 831/1014 [00:23<00:05, 34.91batch/s] 83%|██████████████████████▎    | 837/1014 [00:23<00:05, 34.93batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 34.94batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.94batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.94batch/s] 85%|██████████████████████▉    | 861/1014 [00:24<00:04, 34.96batch/s] 86%|███████████████████████    | 867/1014 [00:24<00:04, 34.96batch/s] 86%|███████████████████████▏   | 873/1014 [00:24<00:04, 34.97batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 35.01batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 35.02batch/s] 88%|███████████████████████▋   | 891/1014 [00:25<00:03, 35.01batch/s] 88%|███████████████████████▉   | 897/1014 [00:25<00:03, 35.03batch/s] 89%|████████████████████████   | 903/1014 [00:25<00:03, 35.02batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.04batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 35.08batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 35.07batch/s] 91%|████████████████████████▋  | 927/1014 [00:26<00:02, 35.09batch/s] 92%|████████████████████████▊  | 933/1014 [00:26<00:02, 35.07batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 35.08batch/s] 93%|█████████████████████████▏ | 945/1014 [00:26<00:01, 35.09batch/s] 94%|█████████████████████████▎ | 951/1014 [00:27<00:01, 35.11batch/s] 94%|█████████████████████████▍ | 957/1014 [00:27<00:01, 35.17batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 35.19batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 35.19batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 35.20batch/s] 97%|██████████████████████████ | 981/1014 [00:27<00:00, 35.22batch/s] 97%|██████████████████████████▎| 987/1014 [00:28<00:00, 35.17batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 35.15batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.18batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 35.20batch/s]100%|█████████████████████████▉| 1011/1014 [00:28<00:00, 35.23batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.21batch/s]
Validation 66 -> LOSS = 0.24
Validation 66 -> BLEU = 96.92, 98.7/97.4/96.4/95.2 (BP=1.000, ratio=1.000, hyp_len=14378, ref_len=14382)
** Learning rate changed -> 5e-05
Saving best model based on LOSS
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 66
--> Best BLEU so far: 96.92 @ validation 60
Starting Epoch 67
Epoch 67 - update      31830 => loss:   0.057 (#OOM: 0)
Epoch 67 - update      31860 => loss:   0.054 (#OOM: 0)
Epoch 67 - update      31890 => loss:   0.044 (#OOM: 0)
Epoch 67 - update      31920 => loss:   0.044 (#OOM: 0)
Epoch 67 - update      31950 => loss:   0.072 (#OOM: 0)
Epoch 67 - update      31980 => loss:   0.060 (#OOM: 0)
Epoch 67 - update      32010 => loss:   0.047 (#OOM: 0)
Epoch 67 - update      32040 => loss:   0.033 (#OOM: 0)
Epoch 67 - update      32070 => loss:   0.049 (#OOM: 0)
Epoch 67 - update      32100 => loss:   0.066 (#OOM: 0)
Epoch 67 - update      32130 => loss:   0.056 (#OOM: 0)
Epoch 67 - update      32160 => loss:   0.041 (#OOM: 0)
Epoch 67 - update      32190 => loss:   0.059 (#OOM: 0)
Epoch 67 - update      32220 => loss:   0.054 (#OOM: 0)
Epoch 67 - update      32250 => loss:   0.103 (#OOM: 0)
Epoch 67 - update      32280 => loss:   0.076 (#OOM: 0)
--> Epoch 67 finished with mean loss 0.05419
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.34 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.50batch/s] 15%|████▌                          | 5/34 [00:00<00:01, 15.58batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.33batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 13.40batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.28batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 12.81batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.97batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.29batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.82batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.89batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.55batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.93batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:32, 31.26batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 34.47batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 33.93batch/s]  2%|▍                           | 17/1014 [00:00<00:26, 37.11batch/s]  2%|▌                           | 22/1014 [00:00<00:25, 38.36batch/s]  3%|▋                           | 27/1014 [00:00<00:25, 38.53batch/s]  3%|▉                           | 32/1014 [00:00<00:25, 38.63batch/s]  4%|█                           | 37/1014 [00:00<00:25, 38.07batch/s]  4%|█▏                          | 42/1014 [00:01<00:25, 37.39batch/s]  5%|█▎                          | 47/1014 [00:01<00:26, 36.80batch/s]  5%|█▍                          | 52/1014 [00:01<00:25, 37.49batch/s]  6%|█▌                          | 57/1014 [00:01<00:25, 36.97batch/s]  6%|█▋                          | 62/1014 [00:01<00:25, 36.90batch/s]  7%|█▊                          | 67/1014 [00:01<00:25, 36.48batch/s]  7%|█▉                          | 72/1014 [00:01<00:26, 36.21batch/s]  8%|██▏                         | 77/1014 [00:02<00:25, 36.05batch/s]  8%|██▎                         | 82/1014 [00:02<00:25, 36.14batch/s]  9%|██▍                         | 87/1014 [00:02<00:25, 36.18batch/s]  9%|██▌                         | 92/1014 [00:02<00:25, 35.72batch/s] 10%|██▋                         | 97/1014 [00:02<00:25, 35.90batch/s] 10%|██▋                        | 102/1014 [00:02<00:25, 35.52batch/s] 11%|██▊                        | 107/1014 [00:03<00:25, 35.53batch/s] 11%|██▉                        | 112/1014 [00:03<00:25, 35.37batch/s] 12%|███                        | 117/1014 [00:03<00:25, 35.11batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 35.29batch/s] 13%|███▍                       | 127/1014 [00:03<00:25, 35.06batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 35.04batch/s] 14%|███▋                       | 137/1014 [00:03<00:24, 35.11batch/s] 14%|███▊                       | 142/1014 [00:04<00:24, 35.20batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 35.27batch/s] 15%|████                       | 152/1014 [00:04<00:24, 35.00batch/s] 15%|████▏                      | 157/1014 [00:04<00:24, 34.82batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.89batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.89batch/s] 17%|████▌                      | 172/1014 [00:04<00:24, 34.90batch/s] 17%|████▋                      | 177/1014 [00:05<00:24, 34.72batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 34.85batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 34.90batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 35.04batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 35.08batch/s] 20%|█████▍                     | 202/1014 [00:05<00:23, 35.05batch/s] 20%|█████▌                     | 207/1014 [00:05<00:22, 35.10batch/s] 21%|█████▋                     | 212/1014 [00:06<00:22, 35.00batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 35.00batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 34.97batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 35.11batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 35.17batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 35.23batch/s] 24%|██████▍                    | 242/1014 [00:06<00:21, 35.32batch/s] 24%|██████▌                    | 247/1014 [00:06<00:21, 35.38batch/s] 25%|██████▋                    | 252/1014 [00:07<00:21, 35.37batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 35.37batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 35.43batch/s] 26%|███████                    | 267/1014 [00:07<00:20, 35.58batch/s] 27%|███████▏                   | 272/1014 [00:07<00:20, 35.50batch/s] 27%|███████▍                   | 277/1014 [00:07<00:20, 35.31batch/s] 28%|███████▌                   | 282/1014 [00:07<00:20, 35.31batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.43batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.38batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 35.36batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 35.36batch/s] 30%|████████▏                  | 307/1014 [00:08<00:19, 35.48batch/s] 31%|████████▎                  | 312/1014 [00:08<00:19, 35.42batch/s] 31%|████████▍                  | 317/1014 [00:08<00:19, 35.46batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 35.31batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 35.24batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 35.08batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 35.01batch/s] 34%|█████████                  | 342/1014 [00:09<00:19, 35.00batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:19, 35.05batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:18, 34.95batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 34.88batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 34.90batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.92batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 34.94batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 34.94batch/s] 38%|██████████▏                | 382/1014 [00:10<00:18, 35.00batch/s] 38%|██████████▎                | 387/1014 [00:11<00:17, 35.03batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 35.06batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 34.96batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 35.00batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.92batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 34.89batch/s] 41%|███████████                | 417/1014 [00:11<00:17, 34.95batch/s] 42%|███████████▏               | 422/1014 [00:12<00:16, 34.94batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 34.96batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 34.85batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 34.80batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 34.79batch/s] 44%|███████████▉               | 447/1014 [00:12<00:16, 34.82batch/s] 45%|████████████               | 452/1014 [00:12<00:16, 34.87batch/s] 45%|████████████▏              | 457/1014 [00:13<00:15, 34.91batch/s] 46%|████████████▎              | 462/1014 [00:13<00:15, 34.97batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 35.01batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.04batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 35.07batch/s] 48%|████████████▊              | 482/1014 [00:13<00:15, 35.05batch/s] 48%|████████████▉              | 487/1014 [00:13<00:15, 35.02batch/s] 49%|█████████████              | 492/1014 [00:14<00:14, 34.97batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 34.86batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 34.77batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 34.77batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 34.70batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 34.71batch/s] 51%|█████████████▉             | 522/1014 [00:15<00:14, 34.79batch/s] 52%|██████████████             | 527/1014 [00:15<00:13, 34.81batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 34.83batch/s] 53%|██████████████▎            | 537/1014 [00:15<00:13, 34.89batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 34.94batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 34.99batch/s] 54%|██████████████▋            | 552/1014 [00:15<00:13, 34.96batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:13, 34.94batch/s] 55%|██████████████▉            | 562/1014 [00:16<00:12, 34.97batch/s] 56%|███████████████            | 567/1014 [00:16<00:12, 34.98batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 35.00batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 35.01batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 35.03batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 35.06batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:12, 35.02batch/s] 59%|███████████████▉           | 597/1014 [00:17<00:11, 35.00batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 35.04batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 35.00batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 34.98batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 35.02batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 35.02batch/s] 62%|████████████████▋          | 627/1014 [00:17<00:11, 35.04batch/s] 62%|████████████████▊          | 632/1014 [00:18<00:10, 35.07batch/s] 63%|████████████████▉          | 637/1014 [00:18<00:10, 35.08batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 35.07batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.97batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 34.95batch/s] 65%|█████████████████▍         | 657/1014 [00:18<00:10, 34.95batch/s] 65%|█████████████████▋         | 662/1014 [00:18<00:10, 34.93batch/s] 66%|█████████████████▊         | 667/1014 [00:19<00:09, 34.93batch/s] 66%|█████████████████▉         | 672/1014 [00:19<00:09, 34.96batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.91batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 34.96batch/s] 68%|██████████████████▎        | 687/1014 [00:19<00:09, 34.99batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 34.97batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:09, 35.05batch/s] 69%|██████████████████▋        | 702/1014 [00:20<00:08, 35.06batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 35.01batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 35.02batch/s] 71%|███████████████████        | 717/1014 [00:20<00:08, 35.00batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 34.99batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 34.96batch/s] 72%|███████████████████▍       | 732/1014 [00:20<00:08, 34.98batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:07, 34.94batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 34.93batch/s] 74%|███████████████████▉       | 747/1014 [00:21<00:07, 34.85batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 34.91batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 34.93batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 34.95batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:07, 34.93batch/s] 76%|████████████████████▌      | 772/1014 [00:22<00:06, 34.78batch/s] 77%|████████████████████▋      | 777/1014 [00:22<00:06, 34.77batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 34.75batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 34.77batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 34.72batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 34.69batch/s] 79%|█████████████████████▎     | 802/1014 [00:23<00:06, 34.66batch/s] 80%|█████████████████████▍     | 807/1014 [00:23<00:05, 34.66batch/s] 80%|█████████████████████▌     | 812/1014 [00:23<00:05, 34.68batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 34.72batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 34.75batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.75batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 34.77batch/s] 83%|██████████████████████▎    | 837/1014 [00:24<00:05, 34.79batch/s] 83%|██████████████████████▍    | 842/1014 [00:24<00:04, 34.73batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 34.68batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 34.68batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.68batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 34.67batch/s] 86%|███████████████████████    | 867/1014 [00:24<00:04, 34.69batch/s] 86%|███████████████████████▏   | 872/1014 [00:25<00:04, 34.67batch/s] 86%|███████████████████████▎   | 877/1014 [00:25<00:03, 34.66batch/s] 87%|███████████████████████▍   | 882/1014 [00:25<00:03, 34.70batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.69batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 34.74batch/s] 88%|███████████████████████▉   | 897/1014 [00:25<00:03, 34.77batch/s] 89%|████████████████████████   | 902/1014 [00:25<00:03, 34.78batch/s] 89%|████████████████████████▏  | 907/1014 [00:26<00:03, 34.79batch/s] 90%|████████████████████████▎  | 912/1014 [00:26<00:02, 34.81batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.83batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 34.78batch/s] 91%|████████████████████████▋  | 927/1014 [00:26<00:02, 34.79batch/s] 92%|████████████████████████▊  | 932/1014 [00:26<00:02, 34.80batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 34.75batch/s] 93%|█████████████████████████  | 942/1014 [00:27<00:02, 34.72batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.69batch/s] 94%|█████████████████████████▎ | 952/1014 [00:27<00:01, 34.67batch/s] 94%|█████████████████████████▍ | 957/1014 [00:27<00:01, 34.65batch/s] 95%|█████████████████████████▌ | 962/1014 [00:27<00:01, 34.64batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 34.63batch/s] 96%|█████████████████████████▉ | 972/1014 [00:28<00:01, 34.62batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.64batch/s] 97%|██████████████████████████▏| 982/1014 [00:28<00:00, 34.66batch/s] 97%|██████████████████████████▎| 987/1014 [00:28<00:00, 34.67batch/s] 98%|██████████████████████████▍| 992/1014 [00:28<00:00, 34.69batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 34.68batch/s] 99%|█████████████████████████▋| 1002/1014 [00:28<00:00, 34.68batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.70batch/s]100%|█████████████████████████▉| 1012/1014 [00:29<00:00, 34.65batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.62batch/s]
Validation 67 -> LOSS = 0.24
Validation 67 -> BLEU = 96.93, 98.8/97.5/96.4/95.3 (BP=1.000, ratio=1.000, hyp_len=14376, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 66
--> Best BLEU so far: 96.93 @ validation 67
Starting Epoch 68
Epoch 68 - update      32310 => loss:   0.055 (#OOM: 0)
Epoch 68 - update      32340 => loss:   0.052 (#OOM: 0)
Epoch 68 - update      32370 => loss:   0.048 (#OOM: 0)
Epoch 68 - update      32400 => loss:   0.019 (#OOM: 0)
Epoch 68 - update      32430 => loss:   0.089 (#OOM: 0)
Epoch 68 - update      32460 => loss:   0.080 (#OOM: 0)
Epoch 68 - update      32490 => loss:   0.008 (#OOM: 0)
Epoch 68 - update      32520 => loss:   0.065 (#OOM: 0)
Epoch 68 - update      32550 => loss:   0.059 (#OOM: 0)
Epoch 68 - update      32580 => loss:   0.058 (#OOM: 0)
Epoch 68 - update      32610 => loss:   0.030 (#OOM: 0)
Epoch 68 - update      32640 => loss:   0.042 (#OOM: 0)
Epoch 68 - update      32670 => loss:   0.064 (#OOM: 0)
Epoch 68 - update      32700 => loss:   0.058 (#OOM: 0)
Epoch 68 - update      32730 => loss:   0.011 (#OOM: 0)
Epoch 68 - update      32760 => loss:   0.155 (#OOM: 0)
--> Epoch 68 finished with mean loss 0.05207
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.33 mins)   (679 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 16.22batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 16.40batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 14.84batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.58batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 13.26batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.48batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 11.84batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.53batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.42batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.87batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 12.87batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.23batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.57batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 38.01batch/s]  1%|▎                            | 9/1014 [00:00<00:26, 37.64batch/s]  1%|▍                           | 14/1014 [00:00<00:28, 34.64batch/s]  2%|▌                           | 19/1014 [00:00<00:29, 34.26batch/s]  2%|▋                           | 24/1014 [00:00<00:29, 33.28batch/s]  3%|▊                           | 29/1014 [00:00<00:29, 33.26batch/s]  3%|▉                           | 34/1014 [00:01<00:30, 32.39batch/s]  4%|█                           | 39/1014 [00:01<00:30, 32.31batch/s]  4%|█▏                          | 44/1014 [00:01<00:29, 32.39batch/s]  5%|█▎                          | 49/1014 [00:01<00:30, 31.41batch/s]  5%|█▍                          | 54/1014 [00:01<00:30, 31.61batch/s]  6%|█▋                          | 59/1014 [00:01<00:30, 31.76batch/s]  6%|█▊                          | 64/1014 [00:01<00:29, 32.04batch/s]  7%|█▉                          | 69/1014 [00:02<00:28, 32.60batch/s]  7%|██                          | 74/1014 [00:02<00:28, 32.78batch/s]  8%|██▏                         | 79/1014 [00:02<00:28, 33.20batch/s]  8%|██▎                         | 84/1014 [00:02<00:28, 33.00batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 33.08batch/s]  9%|██▌                         | 94/1014 [00:02<00:27, 33.11batch/s] 10%|██▋                         | 99/1014 [00:02<00:27, 33.21batch/s] 10%|██▊                        | 104/1014 [00:03<00:27, 33.23batch/s] 11%|██▉                        | 109/1014 [00:03<00:27, 33.28batch/s] 11%|███                        | 114/1014 [00:03<00:27, 33.23batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 33.62batch/s] 12%|███▎                       | 124/1014 [00:03<00:26, 33.81batch/s] 13%|███▍                       | 129/1014 [00:03<00:26, 33.73batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.04batch/s] 14%|███▋                       | 139/1014 [00:04<00:25, 33.71batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 33.90batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 33.99batch/s] 15%|████                       | 154/1014 [00:04<00:25, 33.79batch/s] 16%|████▏                      | 159/1014 [00:04<00:25, 33.91batch/s] 16%|████▎                      | 164/1014 [00:04<00:25, 33.80batch/s] 17%|████▌                      | 169/1014 [00:05<00:25, 33.76batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 33.72batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 33.87batch/s] 18%|████▉                      | 184/1014 [00:05<00:24, 33.73batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 33.83batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 33.78batch/s] 20%|█████▎                     | 199/1014 [00:05<00:24, 33.87batch/s] 20%|█████▍                     | 204/1014 [00:06<00:23, 33.84batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 33.75batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 33.93batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 33.65batch/s] 22%|█████▉                     | 224/1014 [00:06<00:23, 33.63batch/s] 23%|██████                     | 229/1014 [00:06<00:23, 33.65batch/s] 23%|██████▏                    | 234/1014 [00:06<00:23, 33.53batch/s] 24%|██████▎                    | 239/1014 [00:07<00:23, 33.62batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 33.72batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 33.77batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 33.74batch/s] 26%|██████▉                    | 259/1014 [00:07<00:22, 33.88batch/s] 26%|███████                    | 264/1014 [00:07<00:22, 33.96batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 33.98batch/s] 27%|███████▎                   | 274/1014 [00:08<00:21, 34.01batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.04batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 34.10batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.06batch/s] 29%|███████▊                   | 294/1014 [00:08<00:21, 34.16batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.21batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.26batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 34.34batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.38batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.48batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 34.59batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.50batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 34.55batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.59batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 34.60batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.57batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 34.54batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 34.50batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.47batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.44batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.35batch/s] 37%|██████████                 | 379/1014 [00:11<00:18, 34.40batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.44batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.47batch/s] 39%|██████████▍                | 394/1014 [00:11<00:18, 34.38batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.39batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.46batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.52batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 34.53batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.56batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 34.58batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.59batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.64batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.71batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.68batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.71batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.76batch/s] 45%|████████████▏              | 459/1014 [00:13<00:15, 34.73batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.82batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.87batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.79batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.82batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.88batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.85batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 34.87batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.86batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.89batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.94batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.96batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 34.96batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.91batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.88batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.87batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.83batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.81batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.77batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.87batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.75batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.74batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.72batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.69batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.67batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.63batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.67batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.68batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.71batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.68batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.70batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.70batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.72batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.67batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.73batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.64batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.64batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.59batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 34.61batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.57batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 34.62batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.65batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.70batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.66batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.67batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.66batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.68batch/s] 68%|██████████████████▍        | 694/1014 [00:20<00:09, 34.64batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.55batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.61batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.60batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.58batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.61batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.61batch/s] 72%|███████████████████▍       | 729/1014 [00:21<00:08, 34.61batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 34.63batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.62batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.63batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.60batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.59batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.65batch/s] 75%|████████████████████▎      | 764/1014 [00:22<00:07, 34.66batch/s] 76%|████████████████████▍      | 769/1014 [00:22<00:07, 34.68batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 34.61batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.63batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.60batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.60batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.55batch/s] 79%|█████████████████████▎     | 799/1014 [00:23<00:06, 34.54batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.58batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.58batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.60batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 34.61batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.59batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 34.56batch/s] 82%|██████████████████████▏    | 834/1014 [00:24<00:05, 34.56batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.57batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.60batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.58batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.55batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.55batch/s] 85%|███████████████████████    | 864/1014 [00:25<00:04, 34.56batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.58batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.52batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.51batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.45batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.45batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 34.43batch/s] 89%|███████████████████████▉   | 899/1014 [00:26<00:03, 34.42batch/s] 89%|████████████████████████   | 904/1014 [00:26<00:03, 34.46batch/s] 90%|████████████████████████▏  | 909/1014 [00:26<00:03, 34.49batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.50batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.47batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.49batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.51batch/s] 92%|████████████████████████▊  | 934/1014 [00:27<00:02, 34.49batch/s] 93%|█████████████████████████  | 939/1014 [00:27<00:02, 34.49batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.52batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.56batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.55batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.59batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.58batch/s] 96%|█████████████████████████▊ | 969/1014 [00:28<00:01, 34.55batch/s] 96%|█████████████████████████▉ | 974/1014 [00:28<00:01, 34.57batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.58batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.59batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.58batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.62batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 34.60batch/s] 99%|█████████████████████████▋| 1004/1014 [00:29<00:00, 34.61batch/s]100%|█████████████████████████▊| 1009/1014 [00:29<00:00, 34.63batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.62batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.62batch/s]
Validation 68 -> LOSS = 0.24
Validation 68 -> BLEU = 96.90, 98.7/97.4/96.4/95.2 (BP=1.000, ratio=1.000, hyp_len=14376, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 66
--> Best BLEU so far: 96.93 @ validation 67
Starting Epoch 69
Epoch 69 - update      32790 => loss:   0.054 (#OOM: 0)
Epoch 69 - update      32820 => loss:   0.048 (#OOM: 0)
Epoch 69 - update      32850 => loss:   0.038 (#OOM: 0)
Epoch 69 - update      32880 => loss:   0.065 (#OOM: 0)
Epoch 69 - update      32910 => loss:   0.038 (#OOM: 0)
Epoch 69 - update      32940 => loss:   0.055 (#OOM: 0)
Epoch 69 - update      32970 => loss:   0.058 (#OOM: 0)
Epoch 69 - update      33000 => loss:   0.020 (#OOM: 0)
Epoch 69 - update      33030 => loss:   0.068 (#OOM: 0)
Epoch 69 - update      33060 => loss:   0.039 (#OOM: 0)
Epoch 69 - update      33090 => loss:   0.057 (#OOM: 0)
Epoch 69 - update      33120 => loss:   0.019 (#OOM: 0)
Epoch 69 - update      33150 => loss:   0.049 (#OOM: 0)
Epoch 69 - update      33180 => loss:   0.058 (#OOM: 0)
Epoch 69 - update      33210 => loss:   0.032 (#OOM: 0)
Epoch 69 - update      33240 => loss:   0.032 (#OOM: 0)
--> Epoch 69 finished with mean loss 0.05175
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (675 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.23batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 13.56batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 13.93batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 13.62batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.54batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.36batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.53batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.27batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.34batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.40batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.85batch/s] 82%|████████████████████████▋     | 28/34 [00:01<00:00, 14.31batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.18batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.27batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.27batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:33, 29.78batch/s]  1%|▏                            | 7/1014 [00:00<00:32, 30.91batch/s]  1%|▎                           | 11/1014 [00:00<00:31, 31.50batch/s]  1%|▍                           | 15/1014 [00:00<00:32, 30.89batch/s]  2%|▌                           | 19/1014 [00:00<00:32, 30.17batch/s]  2%|▋                           | 23/1014 [00:00<00:33, 29.92batch/s]  3%|▋                           | 27/1014 [00:00<00:33, 29.42batch/s]  3%|▉                           | 32/1014 [00:01<00:31, 31.25batch/s]  4%|█                           | 37/1014 [00:01<00:30, 31.82batch/s]  4%|█▏                          | 42/1014 [00:01<00:30, 31.75batch/s]  5%|█▎                          | 47/1014 [00:01<00:30, 32.00batch/s]  5%|█▍                          | 52/1014 [00:01<00:29, 32.49batch/s]  6%|█▌                          | 57/1014 [00:01<00:29, 32.66batch/s]  6%|█▋                          | 62/1014 [00:01<00:28, 32.91batch/s]  7%|█▊                          | 67/1014 [00:02<00:28, 33.09batch/s]  7%|█▉                          | 72/1014 [00:02<00:28, 33.20batch/s]  8%|██▏                         | 77/1014 [00:02<00:27, 33.65batch/s]  8%|██▎                         | 82/1014 [00:02<00:27, 33.83batch/s]  9%|██▍                         | 87/1014 [00:02<00:27, 33.98batch/s]  9%|██▌                         | 92/1014 [00:02<00:27, 33.99batch/s] 10%|██▋                         | 97/1014 [00:02<00:26, 34.02batch/s] 10%|██▋                        | 102/1014 [00:02<00:26, 34.02batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 33.95batch/s] 11%|██▉                        | 112/1014 [00:03<00:26, 34.07batch/s] 12%|███                        | 117/1014 [00:03<00:26, 33.82batch/s] 12%|███▏                       | 122/1014 [00:03<00:26, 33.98batch/s] 13%|███▍                       | 127/1014 [00:03<00:26, 34.09batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 33.99batch/s] 14%|███▋                       | 137/1014 [00:04<00:25, 33.98batch/s] 14%|███▊                       | 142/1014 [00:04<00:25, 34.26batch/s] 14%|███▉                       | 147/1014 [00:04<00:25, 34.54batch/s] 15%|████                       | 152/1014 [00:04<00:24, 34.50batch/s] 15%|████▏                      | 157/1014 [00:04<00:24, 34.65batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.75batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.89batch/s] 17%|████▌                      | 172/1014 [00:04<00:24, 34.97batch/s] 17%|████▋                      | 177/1014 [00:05<00:23, 34.91batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 34.76batch/s] 18%|████▉                      | 187/1014 [00:05<00:24, 34.37batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 34.32batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 34.41batch/s] 20%|█████▍                     | 202/1014 [00:05<00:23, 34.41batch/s] 20%|█████▌                     | 207/1014 [00:06<00:23, 34.34batch/s] 21%|█████▋                     | 212/1014 [00:06<00:23, 34.57batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 34.70batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 34.82batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 34.90batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 34.88batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 34.82batch/s] 24%|██████▍                    | 242/1014 [00:06<00:22, 34.88batch/s] 24%|██████▌                    | 247/1014 [00:07<00:21, 34.98batch/s] 25%|██████▋                    | 252/1014 [00:07<00:21, 34.88batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 34.95batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 35.02batch/s] 26%|███████                    | 267/1014 [00:07<00:21, 35.05batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 35.06batch/s] 27%|███████▍                   | 277/1014 [00:07<00:20, 35.12batch/s] 28%|███████▌                   | 282/1014 [00:08<00:20, 35.11batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.03batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.03batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 35.00batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 34.88batch/s] 30%|████████▏                  | 307/1014 [00:08<00:20, 34.90batch/s] 31%|████████▎                  | 312/1014 [00:08<00:20, 34.93batch/s] 31%|████████▍                  | 317/1014 [00:09<00:19, 34.92batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 34.82batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 34.79batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 34.65batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 34.73batch/s] 34%|█████████                  | 342/1014 [00:09<00:19, 34.80batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:19, 34.81batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:18, 34.86batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 34.89batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 34.94batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.95batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 35.06batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 35.02batch/s] 38%|██████████▏                | 382/1014 [00:10<00:18, 35.02batch/s] 38%|██████████▎                | 387/1014 [00:11<00:17, 35.01batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 35.03batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 34.98batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 34.95batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.93batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 34.99batch/s] 41%|███████████                | 417/1014 [00:11<00:17, 34.97batch/s] 42%|███████████▏               | 422/1014 [00:12<00:16, 34.98batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 34.97batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 34.91batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 34.88batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 34.82batch/s] 44%|███████████▉               | 447/1014 [00:12<00:16, 34.87batch/s] 45%|████████████               | 452/1014 [00:12<00:16, 34.82batch/s] 45%|████████████▏              | 457/1014 [00:13<00:15, 34.83batch/s] 46%|████████████▎              | 462/1014 [00:13<00:15, 34.72batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 34.56batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 34.57batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 34.56batch/s] 48%|████████████▊              | 482/1014 [00:13<00:15, 34.56batch/s] 48%|████████████▉              | 487/1014 [00:14<00:15, 34.52batch/s] 49%|█████████████              | 492/1014 [00:14<00:15, 34.51batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 34.53batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 34.45batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 34.38batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 34.46batch/s] 51%|█████████████▊             | 517/1014 [00:15<00:14, 34.43batch/s] 51%|█████████████▉             | 522/1014 [00:15<00:14, 34.44batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 34.50batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 34.53batch/s] 53%|██████████████▎            | 537/1014 [00:15<00:13, 34.58batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 34.59batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 34.60batch/s] 54%|██████████████▋            | 552/1014 [00:15<00:13, 34.62batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.65batch/s] 55%|██████████████▉            | 562/1014 [00:16<00:13, 34.67batch/s] 56%|███████████████            | 567/1014 [00:16<00:12, 34.68batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 34.71batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 34.68batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 34.67batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 34.66batch/s] 58%|███████████████▊           | 592/1014 [00:17<00:12, 34.66batch/s] 59%|███████████████▉           | 597/1014 [00:17<00:12, 34.69batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 34.65batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 34.72batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 34.74batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.72batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 34.76batch/s] 62%|████████████████▋          | 627/1014 [00:18<00:11, 34.75batch/s] 62%|████████████████▊          | 632/1014 [00:18<00:11, 34.71batch/s] 63%|████████████████▉          | 637/1014 [00:18<00:10, 34.74batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 34.72batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.72batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 34.77batch/s] 65%|█████████████████▍         | 657/1014 [00:18<00:10, 34.77batch/s] 65%|█████████████████▋         | 662/1014 [00:19<00:10, 34.78batch/s] 66%|█████████████████▊         | 667/1014 [00:19<00:09, 34.78batch/s] 66%|█████████████████▉         | 672/1014 [00:19<00:09, 34.77batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.84batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 34.83batch/s] 68%|██████████████████▎        | 687/1014 [00:19<00:09, 34.79batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 34.82batch/s] 69%|██████████████████▌        | 697/1014 [00:20<00:09, 34.78batch/s] 69%|██████████████████▋        | 702/1014 [00:20<00:08, 34.80batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.79batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 34.81batch/s] 71%|███████████████████        | 717/1014 [00:20<00:08, 34.79batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 34.80batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 34.77batch/s] 72%|███████████████████▍       | 732/1014 [00:21<00:08, 34.81batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:07, 34.80batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 34.74batch/s] 74%|███████████████████▉       | 747/1014 [00:21<00:07, 34.77batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 34.75batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 34.78batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 34.78batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.79batch/s] 76%|████████████████████▌      | 772/1014 [00:22<00:06, 34.81batch/s] 77%|████████████████████▋      | 777/1014 [00:22<00:06, 34.78batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 34.80batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 34.83batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 34.84batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 34.84batch/s] 79%|█████████████████████▎     | 802/1014 [00:23<00:06, 34.85batch/s] 80%|█████████████████████▍     | 807/1014 [00:23<00:05, 34.90batch/s] 80%|█████████████████████▌     | 812/1014 [00:23<00:05, 34.81batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 34.80batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 34.77batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.82batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 34.83batch/s] 83%|██████████████████████▎    | 837/1014 [00:24<00:05, 34.83batch/s] 83%|██████████████████████▍    | 842/1014 [00:24<00:04, 34.87batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 34.89batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 34.90batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.93batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 34.96batch/s] 86%|███████████████████████    | 867/1014 [00:24<00:04, 34.95batch/s] 86%|███████████████████████▏   | 872/1014 [00:24<00:04, 34.94batch/s] 86%|███████████████████████▎   | 877/1014 [00:25<00:03, 34.99batch/s] 87%|███████████████████████▍   | 882/1014 [00:25<00:03, 34.95batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.95batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 34.96batch/s] 88%|███████████████████████▉   | 897/1014 [00:25<00:03, 34.99batch/s] 89%|████████████████████████   | 902/1014 [00:25<00:03, 34.98batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 34.99batch/s] 90%|████████████████████████▎  | 912/1014 [00:26<00:02, 34.99batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.99batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 35.03batch/s] 91%|████████████████████████▋  | 927/1014 [00:26<00:02, 34.95batch/s] 92%|████████████████████████▊  | 932/1014 [00:26<00:02, 34.98batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 34.99batch/s] 93%|█████████████████████████  | 942/1014 [00:26<00:02, 34.92batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.90batch/s] 94%|█████████████████████████▎ | 952/1014 [00:27<00:01, 34.92batch/s] 94%|█████████████████████████▍ | 957/1014 [00:27<00:01, 34.94batch/s] 95%|█████████████████████████▌ | 962/1014 [00:27<00:01, 34.93batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 34.92batch/s] 96%|█████████████████████████▉ | 972/1014 [00:27<00:01, 34.92batch/s] 96%|██████████████████████████ | 977/1014 [00:27<00:01, 34.95batch/s] 97%|██████████████████████████▏| 982/1014 [00:28<00:00, 34.95batch/s] 97%|██████████████████████████▎| 987/1014 [00:28<00:00, 34.92batch/s] 98%|██████████████████████████▍| 992/1014 [00:28<00:00, 34.93batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 34.95batch/s] 99%|█████████████████████████▋| 1002/1014 [00:28<00:00, 34.95batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 34.92batch/s]100%|█████████████████████████▉| 1012/1014 [00:28<00:00, 34.96batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.95batch/s]
Validation 69 -> LOSS = 0.24
Validation 69 -> BLEU = 96.90, 98.8/97.4/96.4/95.2 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 66
--> Best BLEU so far: 96.93 @ validation 67
Starting Epoch 70
Epoch 70 - update      33270 => loss:   0.048 (#OOM: 0)
Epoch 70 - update      33300 => loss:   0.054 (#OOM: 0)
Epoch 70 - update      33330 => loss:   0.054 (#OOM: 0)
Epoch 70 - update      33360 => loss:   0.055 (#OOM: 0)
Epoch 70 - update      33390 => loss:   0.063 (#OOM: 0)
Epoch 70 - update      33420 => loss:   0.054 (#OOM: 0)
Epoch 70 - update      33450 => loss:   0.044 (#OOM: 0)
Epoch 70 - update      33480 => loss:   0.053 (#OOM: 0)
Epoch 70 - update      33510 => loss:   0.062 (#OOM: 0)
Epoch 70 - update      33540 => loss:   0.066 (#OOM: 0)
Epoch 70 - update      33570 => loss:   0.034 (#OOM: 0)
Epoch 70 - update      33600 => loss:   0.049 (#OOM: 0)
Epoch 70 - update      33630 => loss:   0.074 (#OOM: 0)
Epoch 70 - update      33660 => loss:   0.084 (#OOM: 0)
Epoch 70 - update      33690 => loss:   0.046 (#OOM: 0)
Epoch 70 - update      33720 => loss:   0.022 (#OOM: 0)
--> Epoch 70 finished with mean loss 0.05166
--> Overhead/Training/Evaluation: 0.63/0.72/0.00 mins (total: 1.35 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.57batch/s] 12%|███▋                           | 4/34 [00:00<00:03,  9.86batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 10.80batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.18batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.96batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.31batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 14.07batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.93batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 14.80batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.04batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 14.16batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.89batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.88batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.29batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 35.16batch/s]  1%|▎                           | 12/1014 [00:00<00:27, 35.82batch/s]  2%|▍                           | 16/1014 [00:00<00:27, 35.74batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 35.04batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.21batch/s]  3%|▊                           | 28/1014 [00:00<00:28, 34.17batch/s]  3%|▉                           | 32/1014 [00:00<00:28, 34.74batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 34.56batch/s]  4%|█                           | 40/1014 [00:01<00:28, 34.69batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.08batch/s]  5%|█▍                          | 50/1014 [00:01<00:27, 35.35batch/s]  5%|█▌                          | 55/1014 [00:01<00:27, 34.51batch/s]  6%|█▋                          | 60/1014 [00:01<00:28, 33.94batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 34.02batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.39batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.43batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 34.05batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 33.71batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 33.78batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.06batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.34batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.47batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.69batch/s] 11%|███                        | 115/1014 [00:03<00:25, 35.15batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 35.47batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 35.26batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 35.19batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 35.32batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.29batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.32batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.12batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.19batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 35.00batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.91batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 35.08batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.06batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.04batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.16batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.23batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.11batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 35.24batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 35.06batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.07batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.02batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.11batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 35.09batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.92batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.91batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 35.11batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.01batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 34.90batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 34.93batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.90batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.92batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.05batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 35.01batch/s] 28%|███████▍                   | 280/1014 [00:08<00:20, 34.96batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 34.88batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.96batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.86batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.94batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.98batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 35.06batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.12batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.09batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.12batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.19batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.16batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.95batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 34.90batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:18, 34.96batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 35.10batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 35.20batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.14batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.06batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 35.19batch/s] 37%|██████████                 | 380/1014 [00:10<00:18, 35.16batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 35.22batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 35.22batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.12batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.16batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 35.18batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.20batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 35.19batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.21batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.29batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.32batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 35.28batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.27batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.30batch/s] 44%|███████████▉               | 450/1014 [00:12<00:15, 35.28batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 35.29batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.28batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 35.23batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 35.18batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 35.18batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 35.13batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 35.11batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.12batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 35.14batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.17batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.14batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 35.11batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 35.12batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 35.07batch/s] 52%|█████████████▉             | 525/1014 [00:14<00:13, 35.16batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 35.19batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 35.18batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 35.23batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.22batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 35.26batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:13, 35.26batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.25batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 35.29batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 35.31batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.33batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.27batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 35.32batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 35.23batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.24batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 35.22batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 35.27batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.28batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 35.29batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.20batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 35.21batch/s] 62%|████████████████▊          | 630/1014 [00:17<00:10, 35.20batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 35.18batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 35.20batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 35.21batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.16batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.19batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 35.17batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 35.20batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 35.15batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 35.15batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 35.14batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.13batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 35.15batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 35.09batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.11batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 35.07batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.13batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.13batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.10batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.10batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.12batch/s] 72%|███████████████████▌       | 735/1014 [00:20<00:07, 35.06batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 35.07batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.08batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 35.14batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.16batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.15batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:07, 35.13batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.14batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 35.12batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 35.15batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.15batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.16batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 35.11batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 35.09batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.09batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 35.05batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 35.01batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.02batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 35.02batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.96batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 34.94batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:04, 34.97batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.92batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.97batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.87batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.86batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 34.86batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.77batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.80batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.76batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.77batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.78batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.80batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 34.81batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.80batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.77batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.76batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.72batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.68batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.62batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.56batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.57batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.59batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.58batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.54batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.54batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.58batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.58batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.60batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.64batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.57batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.62batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.64batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.67batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 34.68batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.66batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.63batch/s]
Validation 70 -> LOSS = 0.24
Validation 70 -> BLEU = 96.93, 98.8/97.5/96.5/95.3 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
** Learning rate changed -> 2.5e-05
Saving best model based on LOSS
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 70
--> Best BLEU so far: 96.93 @ validation 67
Starting Epoch 71
Epoch 71 - update      33750 => loss:   0.028 (#OOM: 0)
Epoch 71 - update      33780 => loss:   0.056 (#OOM: 0)
Epoch 71 - update      33810 => loss:   0.045 (#OOM: 0)
Epoch 71 - update      33840 => loss:   0.066 (#OOM: 0)
Epoch 71 - update      33870 => loss:   0.023 (#OOM: 0)
Epoch 71 - update      33900 => loss:   0.048 (#OOM: 0)
Epoch 71 - update      33930 => loss:   0.024 (#OOM: 0)
Epoch 71 - update      33960 => loss:   0.042 (#OOM: 0)
Epoch 71 - update      33990 => loss:   0.052 (#OOM: 0)
Epoch 71 - update      34020 => loss:   0.047 (#OOM: 0)
Epoch 71 - update      34050 => loss:   0.039 (#OOM: 0)
Epoch 71 - update      34080 => loss:   0.045 (#OOM: 0)
Epoch 71 - update      34110 => loss:   0.057 (#OOM: 0)
Epoch 71 - update      34140 => loss:   0.047 (#OOM: 0)
Epoch 71 - update      34170 => loss:   0.008 (#OOM: 0)
Epoch 71 - update      34200 => loss:   0.057 (#OOM: 0)
--> Epoch 71 finished with mean loss 0.05067
--> Overhead/Training/Evaluation: 0.61/0.73/0.00 mins (total: 1.33 mins)   (666 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.52batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.72batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 13.14batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.15batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.31batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.20batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.67batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.24batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.44batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.62batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.06batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.55batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.55batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 36.00batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.11batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 35.65batch/s]  2%|▍                           | 16/1014 [00:00<00:27, 36.24batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 36.05batch/s]  2%|▋                           | 24/1014 [00:00<00:27, 35.67batch/s]  3%|▊                           | 28/1014 [00:00<00:27, 35.52batch/s]  3%|▉                           | 33/1014 [00:00<00:26, 36.57batch/s]  4%|█                           | 38/1014 [00:01<00:26, 36.77batch/s]  4%|█▏                          | 43/1014 [00:01<00:26, 36.92batch/s]  5%|█▎                          | 48/1014 [00:01<00:26, 36.89batch/s]  5%|█▍                          | 53/1014 [00:01<00:26, 36.15batch/s]  6%|█▌                          | 58/1014 [00:01<00:26, 36.19batch/s]  6%|█▋                          | 63/1014 [00:01<00:25, 36.64batch/s]  7%|█▉                          | 68/1014 [00:01<00:25, 36.84batch/s]  7%|██                          | 73/1014 [00:02<00:25, 36.23batch/s]  8%|██▏                         | 78/1014 [00:02<00:26, 35.85batch/s]  8%|██▎                         | 83/1014 [00:02<00:26, 35.74batch/s]  9%|██▍                         | 88/1014 [00:02<00:25, 35.80batch/s]  9%|██▌                         | 93/1014 [00:02<00:25, 35.99batch/s] 10%|██▋                         | 98/1014 [00:02<00:25, 35.80batch/s] 10%|██▋                        | 103/1014 [00:02<00:25, 35.91batch/s] 11%|██▉                        | 108/1014 [00:03<00:25, 35.70batch/s] 11%|███                        | 113/1014 [00:03<00:25, 35.47batch/s] 12%|███▏                       | 118/1014 [00:03<00:25, 35.48batch/s] 12%|███▎                       | 123/1014 [00:03<00:25, 35.19batch/s] 13%|███▍                       | 128/1014 [00:03<00:25, 35.34batch/s] 13%|███▌                       | 133/1014 [00:03<00:24, 35.44batch/s] 14%|███▋                       | 138/1014 [00:03<00:24, 35.38batch/s] 14%|███▊                       | 143/1014 [00:04<00:24, 35.51batch/s] 15%|███▉                       | 148/1014 [00:04<00:24, 35.85batch/s] 15%|████                       | 153/1014 [00:04<00:23, 36.02batch/s] 16%|████▏                      | 158/1014 [00:04<00:23, 36.12batch/s] 16%|████▎                      | 163/1014 [00:04<00:23, 36.10batch/s] 17%|████▍                      | 168/1014 [00:04<00:23, 36.09batch/s] 17%|████▌                      | 173/1014 [00:04<00:23, 36.04batch/s] 18%|████▋                      | 178/1014 [00:04<00:23, 36.01batch/s] 18%|████▊                      | 183/1014 [00:05<00:23, 36.08batch/s] 19%|█████                      | 188/1014 [00:05<00:23, 35.84batch/s] 19%|█████▏                     | 193/1014 [00:05<00:22, 35.89batch/s] 20%|█████▎                     | 198/1014 [00:05<00:22, 35.81batch/s] 20%|█████▍                     | 203/1014 [00:05<00:22, 35.71batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 35.72batch/s] 21%|█████▋                     | 213/1014 [00:05<00:22, 35.95batch/s] 21%|█████▊                     | 218/1014 [00:06<00:22, 35.91batch/s] 22%|█████▉                     | 223/1014 [00:06<00:21, 36.02batch/s] 22%|██████                     | 228/1014 [00:06<00:21, 36.05batch/s] 23%|██████▏                    | 233/1014 [00:06<00:21, 36.06batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 35.93batch/s] 24%|██████▍                    | 243/1014 [00:06<00:21, 36.08batch/s] 24%|██████▌                    | 248/1014 [00:06<00:21, 36.07batch/s] 25%|██████▋                    | 253/1014 [00:07<00:21, 35.96batch/s] 25%|██████▊                    | 258/1014 [00:07<00:20, 36.03batch/s] 26%|███████                    | 263/1014 [00:07<00:20, 35.92batch/s] 26%|███████▏                   | 268/1014 [00:07<00:20, 35.89batch/s] 27%|███████▎                   | 273/1014 [00:07<00:20, 35.93batch/s] 27%|███████▍                   | 278/1014 [00:07<00:20, 36.03batch/s] 28%|███████▌                   | 283/1014 [00:07<00:20, 36.17batch/s] 28%|███████▋                   | 288/1014 [00:07<00:20, 36.11batch/s] 29%|███████▊                   | 293/1014 [00:08<00:19, 36.10batch/s] 29%|███████▉                   | 298/1014 [00:08<00:19, 36.06batch/s] 30%|████████                   | 303/1014 [00:08<00:19, 36.06batch/s] 30%|████████▏                  | 308/1014 [00:08<00:19, 36.01batch/s] 31%|████████▎                  | 313/1014 [00:08<00:19, 36.05batch/s] 31%|████████▍                  | 318/1014 [00:08<00:19, 36.01batch/s] 32%|████████▌                  | 323/1014 [00:08<00:19, 36.08batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 36.04batch/s] 33%|████████▊                  | 333/1014 [00:09<00:18, 36.06batch/s] 33%|█████████                  | 338/1014 [00:09<00:18, 36.04batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:18, 35.88batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:18, 35.80batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:18, 35.73batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 35.59batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 35.58batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 35.54batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 35.53batch/s] 37%|██████████                 | 378/1014 [00:10<00:17, 35.51batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 35.49batch/s] 38%|██████████▎                | 388/1014 [00:10<00:17, 35.52batch/s] 39%|██████████▍                | 393/1014 [00:11<00:17, 35.50batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 35.51batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 35.50batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 35.53batch/s] 41%|██████████▉                | 413/1014 [00:11<00:16, 35.49batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 35.50batch/s] 42%|███████████▎               | 423/1014 [00:11<00:16, 35.50batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 35.38batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 35.38batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 35.36batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 35.29batch/s] 44%|███████████▉               | 448/1014 [00:12<00:15, 35.40batch/s] 45%|████████████               | 453/1014 [00:12<00:15, 35.41batch/s] 45%|████████████▏              | 458/1014 [00:12<00:15, 35.48batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 35.45batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 35.46batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 35.53batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 35.49batch/s] 48%|████████████▊              | 483/1014 [00:13<00:14, 35.43batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 35.45batch/s] 49%|█████████████▏             | 493/1014 [00:13<00:14, 35.42batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 35.47batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.54batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.58batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 35.58batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:13, 35.57batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.61batch/s] 52%|██████████████             | 528/1014 [00:14<00:13, 35.57batch/s] 53%|██████████████▏            | 533/1014 [00:14<00:13, 35.61batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.57batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 35.56batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.59batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:12, 35.58batch/s] 55%|██████████████▊            | 558/1014 [00:15<00:12, 35.56batch/s] 56%|██████████████▉            | 563/1014 [00:15<00:12, 35.47batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 35.49batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 35.42batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.45batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.41batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 35.35batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 35.23batch/s] 59%|███████████████▉           | 598/1014 [00:16<00:11, 35.29batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 35.24batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.24batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.16batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 35.06batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 35.02batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:11, 35.04batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:10, 35.01batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.04batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.03batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 35.05batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 35.01batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 34.99batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:10, 34.99batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:09, 34.92batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 34.91batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.89batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.90batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 34.88batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:09, 34.88batch/s] 69%|██████████████████▌        | 698/1014 [00:20<00:09, 34.89batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:08, 34.87batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.88batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.93batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 34.89batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 34.87batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 34.85batch/s] 72%|███████████████████▌       | 733/1014 [00:21<00:08, 34.89batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:07, 34.84batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.85batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.84batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.87batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 34.83batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 34.85batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.88batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.86batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.87batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 34.92batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 34.90batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 34.91batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 34.92batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:06, 34.96batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 34.96batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.94batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.95batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.00batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 34.95batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 34.94batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:05, 34.99batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 35.02batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.97batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.88batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 34.87batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.86batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 34.82batch/s] 86%|███████████████████████▏   | 873/1014 [00:25<00:04, 34.83batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.83batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.86batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.90batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.92batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.96batch/s] 89%|████████████████████████   | 903/1014 [00:25<00:03, 34.96batch/s] 90%|████████████████████████▏  | 908/1014 [00:25<00:03, 34.98batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 35.01batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 35.00batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 35.00batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.06batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.08batch/s] 93%|█████████████████████████  | 941/1014 [00:26<00:02, 35.08batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 35.05batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 35.07batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.03batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.05batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 35.05batch/s] 96%|██████████████████████████ | 977/1014 [00:27<00:01, 35.04batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 35.02batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.05batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 35.06batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 35.04batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 35.03batch/s]100%|█████████████████████████▉| 1013/1014 [00:28<00:00, 35.05batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.03batch/s]
Validation 71 -> LOSS = 0.24
Validation 71 -> BLEU = 96.94, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 70
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 72
Epoch 72 - update      34230 => loss:   0.025 (#OOM: 0)
Epoch 72 - update      34260 => loss:   0.037 (#OOM: 0)
Epoch 72 - update      34290 => loss:   0.061 (#OOM: 0)
Epoch 72 - update      34320 => loss:   0.058 (#OOM: 0)
Epoch 72 - update      34350 => loss:   0.059 (#OOM: 0)
Epoch 72 - update      34380 => loss:   0.088 (#OOM: 0)
Epoch 72 - update      34410 => loss:   0.032 (#OOM: 0)
Epoch 72 - update      34440 => loss:   0.045 (#OOM: 0)
Epoch 72 - update      34470 => loss:   0.050 (#OOM: 0)
Epoch 72 - update      34500 => loss:   0.053 (#OOM: 0)
Epoch 72 - update      34530 => loss:   0.038 (#OOM: 0)
Epoch 72 - update      34560 => loss:   0.053 (#OOM: 0)
Epoch 72 - update      34590 => loss:   0.046 (#OOM: 0)
Epoch 72 - update      34620 => loss:   0.056 (#OOM: 0)
Epoch 72 - update      34650 => loss:   0.083 (#OOM: 0)
Epoch 72 - update      34680 => loss:   0.027 (#OOM: 0)
--> Epoch 72 finished with mean loss 0.05008
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.33 mins)   (679 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.45batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.20batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 12.07batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.39batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 15.24batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 14.90batch/s] 56%|████████████████▊             | 19/34 [00:01<00:00, 15.15batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.50batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 14.98batch/s] 82%|████████████████████████▋     | 28/34 [00:01<00:00, 14.40batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.24batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.07batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.06batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:45, 22.20batch/s]  1%|▏                            | 7/1014 [00:00<00:33, 29.77batch/s]  1%|▎                           | 11/1014 [00:00<00:34, 28.88batch/s]  1%|▍                           | 15/1014 [00:00<00:34, 29.29batch/s]  2%|▌                           | 19/1014 [00:00<00:32, 30.22batch/s]  2%|▋                           | 23/1014 [00:00<00:31, 31.28batch/s]  3%|▋                           | 27/1014 [00:00<00:31, 31.51batch/s]  3%|▊                           | 31/1014 [00:00<00:31, 31.16batch/s]  3%|▉                           | 35/1014 [00:01<00:31, 31.28batch/s]  4%|█                           | 39/1014 [00:01<00:30, 31.57batch/s]  4%|█▏                          | 43/1014 [00:01<00:30, 31.79batch/s]  5%|█▎                          | 48/1014 [00:01<00:29, 32.61batch/s]  5%|█▍                          | 53/1014 [00:01<00:29, 32.96batch/s]  6%|█▌                          | 58/1014 [00:01<00:29, 32.76batch/s]  6%|█▋                          | 63/1014 [00:01<00:28, 32.93batch/s]  7%|█▉                          | 68/1014 [00:02<00:28, 33.11batch/s]  7%|██                          | 73/1014 [00:02<00:28, 33.19batch/s]  8%|██▏                         | 78/1014 [00:02<00:28, 33.33batch/s]  8%|██▎                         | 83/1014 [00:02<00:27, 33.89batch/s]  9%|██▍                         | 88/1014 [00:02<00:27, 33.75batch/s]  9%|██▌                         | 93/1014 [00:02<00:27, 33.65batch/s] 10%|██▋                         | 98/1014 [00:02<00:27, 33.56batch/s] 10%|██▋                        | 103/1014 [00:03<00:27, 33.23batch/s] 11%|██▉                        | 108/1014 [00:03<00:27, 33.46batch/s] 11%|███                        | 113/1014 [00:03<00:27, 33.28batch/s] 12%|███▏                       | 118/1014 [00:03<00:26, 33.20batch/s] 12%|███▎                       | 123/1014 [00:03<00:26, 33.44batch/s] 13%|███▍                       | 128/1014 [00:03<00:26, 33.66batch/s] 13%|███▌                       | 133/1014 [00:03<00:25, 33.93batch/s] 14%|███▋                       | 138/1014 [00:04<00:25, 34.09batch/s] 14%|███▊                       | 144/1014 [00:04<00:25, 34.42batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 34.59batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 34.66batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.76batch/s] 17%|████▍                      | 168/1014 [00:04<00:24, 34.70batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.52batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.59batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 34.53batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 34.33batch/s] 20%|█████▎                     | 198/1014 [00:05<00:23, 34.25batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.20batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.15batch/s] 21%|█████▊                     | 216/1014 [00:06<00:23, 34.08batch/s] 22%|█████▉                     | 222/1014 [00:06<00:23, 33.88batch/s] 22%|██████                     | 228/1014 [00:06<00:23, 33.85batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 33.97batch/s] 24%|██████▍                    | 240/1014 [00:07<00:22, 34.07batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.24batch/s] 25%|██████▋                    | 252/1014 [00:07<00:22, 34.20batch/s] 25%|██████▊                    | 258/1014 [00:07<00:22, 34.25batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.29batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.43batch/s] 27%|███████▎                   | 276/1014 [00:08<00:21, 34.31batch/s] 28%|███████▌                   | 282/1014 [00:08<00:21, 34.36batch/s] 28%|███████▋                   | 288/1014 [00:08<00:21, 34.32batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.36batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.44batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 34.30batch/s] 31%|████████▎                  | 312/1014 [00:09<00:20, 34.42batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 34.54batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 34.66batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.70batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 34.66batch/s] 34%|█████████                  | 342/1014 [00:09<00:19, 34.71batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 34.76batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 34.79batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.84batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 34.95batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 34.99batch/s] 37%|██████████                 | 378/1014 [00:10<00:18, 34.85batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.66batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 34.77batch/s] 39%|██████████▌                | 396/1014 [00:11<00:17, 34.78batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 34.79batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 34.92batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 34.88batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.91batch/s] 42%|███████████▎               | 426/1014 [00:12<00:16, 34.95batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 34.87batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 34.86batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.82batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 34.79batch/s] 45%|████████████▏              | 456/1014 [00:13<00:16, 34.74batch/s] 46%|████████████▎              | 462/1014 [00:13<00:15, 34.75batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 34.80batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.79batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.85batch/s] 48%|████████████▉              | 486/1014 [00:13<00:15, 34.74batch/s] 49%|█████████████              | 492/1014 [00:14<00:14, 34.80batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 34.81batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.82batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.76batch/s] 51%|█████████████▋             | 516/1014 [00:14<00:14, 34.78batch/s] 51%|█████████████▉             | 522/1014 [00:15<00:14, 34.74batch/s] 52%|██████████████             | 528/1014 [00:15<00:14, 34.71batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.73batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.68batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 34.37batch/s] 54%|██████████████▋            | 552/1014 [00:16<00:13, 34.41batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 34.36batch/s] 56%|███████████████            | 564/1014 [00:16<00:13, 34.34batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.33batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 34.32batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 34.29batch/s] 58%|███████████████▋           | 588/1014 [00:17<00:12, 34.35batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.42batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 34.42batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 34.47batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 34.52batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 34.51batch/s] 62%|████████████████▌          | 624/1014 [00:18<00:11, 34.47batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.40batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:10, 34.42batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 34.43batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 34.45batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.43batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.47batch/s] 66%|█████████████████▋         | 666/1014 [00:19<00:10, 34.48batch/s] 66%|█████████████████▉         | 672/1014 [00:19<00:09, 34.52batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.55batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.62batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.65batch/s] 69%|██████████████████▌        | 696/1014 [00:20<00:09, 34.65batch/s] 69%|██████████████████▋        | 702/1014 [00:20<00:08, 34.67batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.66batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.66batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.64batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 34.66batch/s] 72%|███████████████████▍       | 732/1014 [00:21<00:08, 34.60batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:07, 34.66batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.69batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.70batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 34.77batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 34.83batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.85batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 34.87batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.90batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 34.91batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 34.89batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 34.88batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.90batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.88batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 34.88batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 34.90batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 34.95batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 34.93batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:04, 34.91batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 34.94batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 34.96batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 34.99batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.02batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.00batch/s] 86%|███████████████████████▎   | 876/1014 [00:25<00:03, 35.00batch/s] 87%|███████████████████████▍   | 882/1014 [00:25<00:03, 34.99batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 35.03batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.01batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 34.99batch/s] 89%|████████████████████████   | 906/1014 [00:25<00:03, 35.02batch/s] 90%|████████████████████████▎  | 912/1014 [00:26<00:02, 34.99batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.98batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.94batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.81batch/s] 92%|████████████████████████▉  | 936/1014 [00:26<00:02, 34.79batch/s] 93%|█████████████████████████  | 942/1014 [00:27<00:02, 34.79batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.78batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.73batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.73batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 34.74batch/s] 96%|█████████████████████████▉ | 972/1014 [00:27<00:01, 34.75batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.75batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.75batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.77batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 34.77batch/s] 99%|█████████████████████████▋| 1002/1014 [00:28<00:00, 34.75batch/s] 99%|█████████████████████████▊| 1008/1014 [00:28<00:00, 34.76batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.74batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.74batch/s]
Validation 72 -> LOSS = 0.24
Validation 72 -> BLEU = 96.93, 98.8/97.5/96.5/95.3 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 70
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 73
Epoch 73 - update      34710 => loss:   0.031 (#OOM: 0)
Epoch 73 - update      34740 => loss:   0.035 (#OOM: 0)
Epoch 73 - update      34770 => loss:   0.039 (#OOM: 0)
Epoch 73 - update      34800 => loss:   0.048 (#OOM: 0)
Epoch 73 - update      34830 => loss:   0.064 (#OOM: 0)
Epoch 73 - update      34860 => loss:   0.048 (#OOM: 0)
Epoch 73 - update      34890 => loss:   0.034 (#OOM: 0)
Epoch 73 - update      34920 => loss:   0.041 (#OOM: 0)
Epoch 73 - update      34950 => loss:   0.040 (#OOM: 0)
Epoch 73 - update      34980 => loss:   0.059 (#OOM: 0)
Epoch 73 - update      35010 => loss:   0.068 (#OOM: 0)
Epoch 73 - update      35040 => loss:   0.073 (#OOM: 0)
Epoch 73 - update      35070 => loss:   0.042 (#OOM: 0)
Epoch 73 - update      35100 => loss:   0.073 (#OOM: 0)
Epoch 73 - update      35130 => loss:   0.034 (#OOM: 0)
Epoch 73 - update      35160 => loss:   0.043 (#OOM: 0)
--> Epoch 73 finished with mean loss 0.05017
--> Overhead/Training/Evaluation: 0.60/0.72/0.00 mins (total: 1.32 mins)   (672 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.44batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.53batch/s]  9%|██▋                            | 3/34 [00:00<00:03,  8.88batch/s] 12%|███▋                           | 4/34 [00:00<00:03,  9.04batch/s] 18%|█████▍                         | 6/34 [00:00<00:02,  9.87batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.44batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 10.79batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.43batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.94batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.16batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 11.69batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 11.84batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.29batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.38batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.67batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.59batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.78batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.77batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.09batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 33.67batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 33.93batch/s]  2%|▍                           | 16/1014 [00:00<00:28, 34.57batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 34.26batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.82batch/s]  3%|▊                           | 29/1014 [00:00<00:27, 36.30batch/s]  3%|▉                           | 34/1014 [00:00<00:27, 35.33batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.30batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 34.78batch/s]  5%|█▎                          | 49/1014 [00:01<00:28, 34.14batch/s]  5%|█▍                          | 54/1014 [00:01<00:28, 33.87batch/s]  6%|█▋                          | 59/1014 [00:01<00:28, 34.04batch/s]  6%|█▊                          | 64/1014 [00:01<00:28, 33.85batch/s]  7%|█▉                          | 69/1014 [00:02<00:27, 33.83batch/s]  7%|██                          | 74/1014 [00:02<00:27, 34.09batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 33.99batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 34.25batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 33.90batch/s]  9%|██▌                         | 94/1014 [00:02<00:27, 33.62batch/s] 10%|██▋                         | 99/1014 [00:02<00:27, 33.19batch/s] 10%|██▊                        | 104/1014 [00:03<00:27, 33.10batch/s] 11%|██▉                        | 109/1014 [00:03<00:27, 33.34batch/s] 11%|███                        | 114/1014 [00:03<00:27, 33.23batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 33.59batch/s] 12%|███▎                       | 124/1014 [00:03<00:26, 33.61batch/s] 13%|███▍                       | 129/1014 [00:03<00:26, 33.60batch/s] 13%|███▌                       | 134/1014 [00:04<00:26, 33.42batch/s] 14%|███▋                       | 139/1014 [00:04<00:26, 33.39batch/s] 14%|███▊                       | 144/1014 [00:04<00:26, 33.40batch/s] 15%|███▉                       | 149/1014 [00:04<00:25, 33.73batch/s] 15%|████                       | 154/1014 [00:04<00:25, 33.68batch/s] 16%|████▏                      | 159/1014 [00:04<00:25, 33.79batch/s] 16%|████▎                      | 164/1014 [00:04<00:25, 33.83batch/s] 17%|████▌                      | 169/1014 [00:05<00:25, 33.63batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 33.63batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 33.75batch/s] 18%|████▉                      | 184/1014 [00:05<00:24, 33.69batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 33.83batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 34.02batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.18batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.25batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.32batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.44batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 34.30batch/s] 22%|█████▉                     | 224/1014 [00:06<00:23, 34.19batch/s] 23%|██████                     | 229/1014 [00:06<00:23, 34.10batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 33.97batch/s] 24%|██████▎                    | 239/1014 [00:07<00:22, 33.98batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.15batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 34.17batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 34.14batch/s] 26%|██████▉                    | 259/1014 [00:07<00:22, 34.10batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.16batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.20batch/s] 27%|███████▎                   | 274/1014 [00:08<00:21, 34.19batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 33.90batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 33.97batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.05batch/s] 29%|███████▊                   | 294/1014 [00:08<00:21, 34.11batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.15batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.27batch/s] 30%|████████▏                  | 309/1014 [00:09<00:20, 34.23batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.21batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.31batch/s] 32%|████████▋                  | 324/1014 [00:09<00:20, 34.35batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.40batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 34.30batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.27batch/s] 34%|█████████▏                 | 344/1014 [00:10<00:19, 34.26batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.38batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 34.38batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:19, 34.28batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.30batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.28batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.25batch/s] 37%|██████████                 | 379/1014 [00:11<00:18, 34.31batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.38batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.39batch/s] 39%|██████████▍                | 394/1014 [00:11<00:18, 34.41batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.45batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.51batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.56batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 34.59batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.60batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 34.64batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.63batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.71batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.68batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.68batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.70batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.61batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.66batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.73batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.73batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.74batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.61batch/s] 48%|████████████▉              | 484/1014 [00:14<00:15, 34.54batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.52batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:15, 34.50batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.52batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.58batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.56batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.55batch/s] 51%|█████████████▊             | 519/1014 [00:15<00:14, 34.53batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.56batch/s] 52%|██████████████             | 529/1014 [00:15<00:14, 34.57batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.63batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.67batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.64batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.67batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.71batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.75batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.76batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.82batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.83batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.87batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.86batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.89batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.89batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.92batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.93batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.94batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.92batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.97batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.98batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:11, 34.95batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.95batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.95batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.95batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 34.97batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.98batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.87batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.84batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.80batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.84batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.89batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.88batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.88batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.77batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.74batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.73batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.75batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.82batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 34.87batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 34.91batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:08, 34.94batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.90batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.92batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 34.86batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 34.87batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 34.90batch/s] 76%|████████████████████▍      | 769/1014 [00:22<00:07, 34.88batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.89batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 34.91batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 34.92batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 34.93batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.94batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:05, 34.98batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 34.99batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 35.01batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.04batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.05batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.12batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.09batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 35.12batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.15batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.09batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.04batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.05batch/s] 86%|███████████████████████▎   | 877/1014 [00:24<00:03, 35.09batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 35.10batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.07batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.08batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.12batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 35.15batch/s] 90%|████████████████████████▎  | 913/1014 [00:25<00:02, 35.16batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.12batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.14batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.19batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.21batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.22batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.19batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.17batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.16batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.20batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.20batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.17batch/s] 97%|██████████████████████████▏| 985/1014 [00:27<00:00, 35.18batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 35.21batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.20batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.21batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.20batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.19batch/s]
Validation 73 -> LOSS = 0.24
Validation 73 -> BLEU = 96.93, 98.8/97.5/96.5/95.3 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 70
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 74
Epoch 74 - update      35190 => loss:   0.058 (#OOM: 0)
Epoch 74 - update      35220 => loss:   0.070 (#OOM: 0)
Epoch 74 - update      35250 => loss:   0.046 (#OOM: 0)
Epoch 74 - update      35280 => loss:   0.054 (#OOM: 0)
Epoch 74 - update      35310 => loss:   0.064 (#OOM: 0)
Epoch 74 - update      35340 => loss:   0.038 (#OOM: 0)
Epoch 74 - update      35370 => loss:   0.066 (#OOM: 0)
Epoch 74 - update      35400 => loss:   0.026 (#OOM: 0)
Epoch 74 - update      35430 => loss:   0.066 (#OOM: 0)
Epoch 74 - update      35460 => loss:   0.044 (#OOM: 0)
Epoch 74 - update      35490 => loss:   0.046 (#OOM: 0)
Epoch 74 - update      35520 => loss:   0.062 (#OOM: 0)
Epoch 74 - update      35550 => loss:   0.056 (#OOM: 0)
Epoch 74 - update      35580 => loss:   0.073 (#OOM: 0)
Epoch 74 - update      35610 => loss:   0.085 (#OOM: 0)
Epoch 74 - update      35640 => loss:   0.034 (#OOM: 0)
--> Epoch 74 finished with mean loss 0.05006
--> Overhead/Training/Evaluation: 0.65/0.72/0.00 mins (total: 1.37 mins)   (673 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.79batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.82batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.03batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.50batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.04batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.88batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.19batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.45batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 12.38batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.08batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.65batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.36batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.33batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.63batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.86batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 37.76batch/s]  1%|▏                            | 8/1014 [00:00<00:34, 29.47batch/s]  1%|▎                           | 12/1014 [00:00<00:31, 31.80batch/s]  2%|▍                           | 16/1014 [00:00<00:31, 31.73batch/s]  2%|▌                           | 20/1014 [00:00<00:31, 31.25batch/s]  2%|▋                           | 24/1014 [00:00<00:30, 32.42batch/s]  3%|▊                           | 28/1014 [00:00<00:30, 31.81batch/s]  3%|▉                           | 32/1014 [00:01<00:31, 31.13batch/s]  4%|▉                           | 36/1014 [00:01<00:30, 31.70batch/s]  4%|█                           | 40/1014 [00:01<00:30, 32.16batch/s]  4%|█▏                          | 44/1014 [00:01<00:30, 31.78batch/s]  5%|█▎                          | 48/1014 [00:01<00:30, 31.32batch/s]  5%|█▍                          | 52/1014 [00:01<00:30, 31.35batch/s]  6%|█▌                          | 56/1014 [00:01<00:30, 31.16batch/s]  6%|█▋                          | 60/1014 [00:01<00:30, 31.36batch/s]  6%|█▊                          | 64/1014 [00:02<00:30, 31.64batch/s]  7%|█▉                          | 68/1014 [00:02<00:30, 31.28batch/s]  7%|█▉                          | 72/1014 [00:02<00:30, 30.69batch/s]  7%|██                          | 76/1014 [00:02<00:30, 30.73batch/s]  8%|██▏                         | 80/1014 [00:02<00:30, 31.04batch/s]  8%|██▎                         | 84/1014 [00:02<00:29, 31.05batch/s]  9%|██▍                         | 88/1014 [00:02<00:30, 30.83batch/s]  9%|██▌                         | 92/1014 [00:02<00:29, 31.08batch/s]  9%|██▋                         | 96/1014 [00:03<00:29, 30.97batch/s] 10%|██▋                        | 100/1014 [00:03<00:29, 31.11batch/s] 10%|██▊                        | 104/1014 [00:03<00:29, 31.26batch/s] 11%|██▉                        | 108/1014 [00:03<00:29, 31.24batch/s] 11%|██▉                        | 112/1014 [00:03<00:28, 31.47batch/s] 11%|███                        | 116/1014 [00:03<00:28, 31.49batch/s] 12%|███▏                       | 120/1014 [00:03<00:28, 31.61batch/s] 12%|███▎                       | 124/1014 [00:03<00:28, 31.60batch/s] 13%|███▍                       | 129/1014 [00:04<00:27, 31.98batch/s] 13%|███▌                       | 134/1014 [00:04<00:27, 31.94batch/s] 14%|███▋                       | 139/1014 [00:04<00:27, 32.23batch/s] 14%|███▊                       | 144/1014 [00:04<00:26, 32.29batch/s] 15%|███▉                       | 149/1014 [00:04<00:26, 32.57batch/s] 15%|████                       | 154/1014 [00:04<00:26, 32.43batch/s] 16%|████▏                      | 159/1014 [00:04<00:26, 32.50batch/s] 16%|████▎                      | 164/1014 [00:05<00:26, 32.68batch/s] 17%|████▌                      | 169/1014 [00:05<00:25, 32.78batch/s] 17%|████▋                      | 174/1014 [00:05<00:25, 32.89batch/s] 18%|████▊                      | 179/1014 [00:05<00:25, 32.95batch/s] 18%|████▉                      | 184/1014 [00:05<00:25, 32.94batch/s] 19%|█████                      | 189/1014 [00:05<00:25, 32.87batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 32.93batch/s] 20%|█████▎                     | 199/1014 [00:06<00:24, 32.91batch/s] 20%|█████▍                     | 204/1014 [00:06<00:24, 32.97batch/s] 21%|█████▌                     | 209/1014 [00:06<00:24, 32.93batch/s] 21%|█████▋                     | 214/1014 [00:06<00:24, 32.98batch/s] 22%|█████▊                     | 219/1014 [00:06<00:24, 33.01batch/s] 22%|█████▉                     | 224/1014 [00:06<00:23, 33.08batch/s] 23%|██████                     | 229/1014 [00:06<00:23, 33.13batch/s] 23%|██████▏                    | 234/1014 [00:07<00:23, 33.11batch/s] 24%|██████▎                    | 239/1014 [00:07<00:23, 33.19batch/s] 24%|██████▍                    | 244/1014 [00:07<00:23, 33.16batch/s] 25%|██████▋                    | 249/1014 [00:07<00:23, 33.23batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 33.20batch/s] 26%|██████▉                    | 259/1014 [00:07<00:22, 33.15batch/s] 26%|███████                    | 264/1014 [00:07<00:22, 33.27batch/s] 27%|███████▏                   | 269/1014 [00:08<00:22, 33.32batch/s] 27%|███████▎                   | 274/1014 [00:08<00:22, 33.15batch/s] 28%|███████▍                   | 279/1014 [00:08<00:22, 33.11batch/s] 28%|███████▌                   | 284/1014 [00:08<00:22, 33.02batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 32.98batch/s] 29%|███████▊                   | 294/1014 [00:08<00:21, 33.13batch/s] 29%|███████▉                   | 299/1014 [00:09<00:21, 33.17batch/s] 30%|████████                   | 304/1014 [00:09<00:21, 33.15batch/s] 30%|████████▏                  | 309/1014 [00:09<00:21, 33.03batch/s] 31%|████████▎                  | 314/1014 [00:09<00:21, 32.96batch/s] 31%|████████▍                  | 319/1014 [00:09<00:21, 32.92batch/s] 32%|████████▋                  | 324/1014 [00:09<00:21, 32.81batch/s] 32%|████████▊                  | 329/1014 [00:10<00:20, 32.78batch/s] 33%|████████▉                  | 334/1014 [00:10<00:20, 32.85batch/s] 33%|█████████                  | 339/1014 [00:10<00:20, 32.86batch/s] 34%|█████████▏                 | 344/1014 [00:10<00:20, 32.90batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:20, 32.86batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:20, 32.88batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:19, 32.77batch/s] 36%|█████████▋                 | 364/1014 [00:11<00:19, 32.73batch/s] 36%|█████████▊                 | 369/1014 [00:11<00:19, 32.76batch/s] 37%|█████████▉                 | 374/1014 [00:11<00:19, 32.74batch/s] 37%|██████████                 | 379/1014 [00:11<00:19, 32.72batch/s] 38%|██████████▏                | 384/1014 [00:11<00:19, 32.67batch/s] 38%|██████████▎                | 389/1014 [00:11<00:19, 32.70batch/s] 39%|██████████▍                | 394/1014 [00:12<00:18, 32.64batch/s] 39%|██████████▌                | 399/1014 [00:12<00:18, 32.69batch/s] 40%|██████████▊                | 404/1014 [00:12<00:18, 32.58batch/s] 40%|██████████▉                | 409/1014 [00:12<00:18, 32.43batch/s] 41%|███████████                | 414/1014 [00:12<00:18, 32.35batch/s] 41%|███████████▏               | 419/1014 [00:12<00:18, 32.31batch/s] 42%|███████████▎               | 424/1014 [00:13<00:18, 32.36batch/s] 42%|███████████▍               | 429/1014 [00:13<00:18, 32.39batch/s] 43%|███████████▌               | 434/1014 [00:13<00:17, 32.48batch/s] 43%|███████████▋               | 439/1014 [00:13<00:17, 32.52batch/s] 44%|███████████▊               | 444/1014 [00:13<00:17, 32.54batch/s] 44%|███████████▉               | 449/1014 [00:13<00:17, 32.52batch/s] 45%|████████████               | 454/1014 [00:13<00:17, 32.51batch/s] 45%|████████████▏              | 459/1014 [00:14<00:17, 32.52batch/s] 46%|████████████▎              | 464/1014 [00:14<00:16, 32.54batch/s] 46%|████████████▍              | 469/1014 [00:14<00:16, 32.65batch/s] 47%|████████████▌              | 474/1014 [00:14<00:16, 32.67batch/s] 47%|████████████▊              | 479/1014 [00:14<00:16, 32.73batch/s] 48%|████████████▉              | 484/1014 [00:14<00:16, 32.71batch/s] 48%|█████████████              | 489/1014 [00:14<00:16, 32.73batch/s] 49%|█████████████▏             | 494/1014 [00:15<00:15, 32.75batch/s] 49%|█████████████▎             | 499/1014 [00:15<00:15, 32.75batch/s] 50%|█████████████▍             | 504/1014 [00:15<00:15, 32.78batch/s] 50%|█████████████▌             | 509/1014 [00:15<00:15, 32.79batch/s] 51%|█████████████▋             | 514/1014 [00:15<00:15, 32.84batch/s] 51%|█████████████▊             | 519/1014 [00:15<00:15, 32.88batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 32.87batch/s] 52%|██████████████             | 529/1014 [00:16<00:14, 32.92batch/s] 53%|██████████████▏            | 534/1014 [00:16<00:14, 32.99batch/s] 53%|██████████████▎            | 539/1014 [00:16<00:14, 33.02batch/s] 54%|██████████████▍            | 544/1014 [00:16<00:14, 33.04batch/s] 54%|██████████████▌            | 549/1014 [00:16<00:14, 33.06batch/s] 55%|██████████████▊            | 554/1014 [00:16<00:13, 33.09batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 33.06batch/s] 56%|███████████████            | 564/1014 [00:17<00:13, 33.06batch/s] 56%|███████████████▏           | 569/1014 [00:17<00:13, 33.06batch/s] 57%|███████████████▎           | 574/1014 [00:17<00:13, 33.13batch/s] 57%|███████████████▍           | 579/1014 [00:17<00:13, 33.15batch/s] 58%|███████████████▌           | 584/1014 [00:17<00:12, 33.20batch/s] 58%|███████████████▋           | 589/1014 [00:17<00:12, 33.26batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 33.24batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:12, 33.28batch/s] 60%|████████████████           | 604/1014 [00:18<00:12, 33.22batch/s] 60%|████████████████▏          | 609/1014 [00:18<00:12, 33.27batch/s] 61%|████████████████▎          | 614/1014 [00:18<00:12, 33.28batch/s] 61%|████████████████▍          | 619/1014 [00:18<00:11, 33.30batch/s] 62%|████████████████▌          | 624/1014 [00:18<00:11, 33.27batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 33.21batch/s] 63%|████████████████▉          | 634/1014 [00:19<00:11, 33.23batch/s] 63%|█████████████████          | 639/1014 [00:19<00:11, 33.23batch/s] 64%|█████████████████▏         | 644/1014 [00:19<00:11, 33.20batch/s] 64%|█████████████████▎         | 649/1014 [00:19<00:10, 33.22batch/s] 64%|█████████████████▍         | 654/1014 [00:19<00:10, 33.30batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 33.32batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 33.36batch/s] 66%|█████████████████▊         | 669/1014 [00:20<00:10, 33.22batch/s] 66%|█████████████████▉         | 674/1014 [00:20<00:10, 33.25batch/s] 67%|██████████████████         | 679/1014 [00:20<00:10, 33.20batch/s] 67%|██████████████████▏        | 684/1014 [00:20<00:09, 33.17batch/s] 68%|██████████████████▎        | 689/1014 [00:20<00:09, 33.09batch/s] 68%|██████████████████▍        | 694/1014 [00:21<00:09, 33.04batch/s] 69%|██████████████████▌        | 699/1014 [00:21<00:09, 32.99batch/s] 69%|██████████████████▋        | 704/1014 [00:21<00:09, 32.93batch/s] 70%|██████████████████▉        | 709/1014 [00:21<00:09, 32.93batch/s] 70%|███████████████████        | 714/1014 [00:21<00:09, 32.79batch/s] 71%|███████████████████▏       | 719/1014 [00:21<00:09, 32.72batch/s] 71%|███████████████████▎       | 724/1014 [00:22<00:08, 32.61batch/s] 72%|███████████████████▍       | 729/1014 [00:22<00:08, 32.65batch/s] 72%|███████████████████▌       | 734/1014 [00:22<00:08, 32.61batch/s] 73%|███████████████████▋       | 739/1014 [00:22<00:08, 32.64batch/s] 73%|███████████████████▊       | 744/1014 [00:22<00:08, 32.61batch/s] 74%|███████████████████▉       | 749/1014 [00:22<00:08, 32.57batch/s] 74%|████████████████████       | 754/1014 [00:23<00:07, 32.59batch/s] 75%|████████████████████▏      | 759/1014 [00:23<00:07, 32.61batch/s] 75%|████████████████████▎      | 764/1014 [00:23<00:07, 32.62batch/s] 76%|████████████████████▍      | 769/1014 [00:23<00:07, 32.62batch/s] 76%|████████████████████▌      | 774/1014 [00:23<00:07, 32.63batch/s] 77%|████████████████████▋      | 779/1014 [00:23<00:07, 32.62batch/s] 77%|████████████████████▉      | 784/1014 [00:24<00:07, 32.63batch/s] 78%|█████████████████████      | 789/1014 [00:24<00:06, 32.65batch/s] 78%|█████████████████████▏     | 794/1014 [00:24<00:06, 32.66batch/s] 79%|█████████████████████▎     | 799/1014 [00:24<00:06, 32.70batch/s] 79%|█████████████████████▍     | 804/1014 [00:24<00:06, 32.69batch/s] 80%|█████████████████████▌     | 809/1014 [00:24<00:06, 32.68batch/s] 80%|█████████████████████▋     | 814/1014 [00:24<00:06, 32.69batch/s] 81%|█████████████████████▊     | 819/1014 [00:25<00:05, 32.69batch/s] 81%|█████████████████████▉     | 824/1014 [00:25<00:05, 32.70batch/s] 82%|██████████████████████     | 829/1014 [00:25<00:05, 32.68batch/s] 82%|██████████████████████▏    | 834/1014 [00:25<00:05, 32.70batch/s] 83%|██████████████████████▎    | 839/1014 [00:25<00:05, 32.71batch/s] 83%|██████████████████████▍    | 844/1014 [00:25<00:05, 32.74batch/s] 84%|██████████████████████▌    | 849/1014 [00:25<00:05, 32.77batch/s] 84%|██████████████████████▋    | 854/1014 [00:26<00:04, 32.80batch/s] 85%|██████████████████████▊    | 859/1014 [00:26<00:04, 32.82batch/s] 85%|███████████████████████    | 864/1014 [00:26<00:04, 32.80batch/s] 86%|███████████████████████▏   | 869/1014 [00:26<00:04, 32.79batch/s] 86%|███████████████████████▎   | 874/1014 [00:26<00:04, 32.82batch/s] 87%|███████████████████████▍   | 879/1014 [00:26<00:04, 32.84batch/s] 87%|███████████████████████▌   | 884/1014 [00:26<00:03, 32.87batch/s] 88%|███████████████████████▋   | 889/1014 [00:27<00:03, 32.91batch/s] 88%|███████████████████████▊   | 894/1014 [00:27<00:03, 32.93batch/s] 89%|███████████████████████▉   | 899/1014 [00:27<00:03, 32.91batch/s] 89%|████████████████████████   | 904/1014 [00:27<00:03, 32.95batch/s] 90%|████████████████████████▏  | 909/1014 [00:27<00:03, 32.94batch/s] 90%|████████████████████████▎  | 914/1014 [00:27<00:03, 32.98batch/s] 91%|████████████████████████▍  | 919/1014 [00:27<00:02, 32.97batch/s] 91%|████████████████████████▌  | 924/1014 [00:28<00:02, 32.99batch/s] 92%|████████████████████████▋  | 929/1014 [00:28<00:02, 32.97batch/s] 92%|████████████████████████▊  | 934/1014 [00:28<00:02, 32.98batch/s] 93%|█████████████████████████  | 939/1014 [00:28<00:02, 32.99batch/s] 93%|█████████████████████████▏ | 944/1014 [00:28<00:02, 32.99batch/s] 94%|█████████████████████████▎ | 949/1014 [00:28<00:01, 33.02batch/s] 94%|█████████████████████████▍ | 954/1014 [00:28<00:01, 33.03batch/s] 95%|█████████████████████████▌ | 959/1014 [00:29<00:01, 33.06batch/s] 95%|█████████████████████████▋ | 964/1014 [00:29<00:01, 33.02batch/s] 96%|█████████████████████████▊ | 969/1014 [00:29<00:01, 33.01batch/s] 96%|█████████████████████████▉ | 974/1014 [00:29<00:01, 33.01batch/s] 97%|██████████████████████████ | 979/1014 [00:29<00:01, 33.04batch/s] 97%|██████████████████████████▏| 984/1014 [00:29<00:00, 33.07batch/s] 98%|██████████████████████████▎| 989/1014 [00:29<00:00, 33.12batch/s] 98%|██████████████████████████▍| 994/1014 [00:30<00:00, 33.08batch/s] 99%|██████████████████████████▌| 999/1014 [00:30<00:00, 33.08batch/s] 99%|█████████████████████████▋| 1004/1014 [00:30<00:00, 33.06batch/s]100%|█████████████████████████▊| 1009/1014 [00:30<00:00, 33.08batch/s]100%|██████████████████████████| 1014/1014 [00:30<00:00, 33.06batch/s]100%|██████████████████████████| 1014/1014 [00:30<00:00, 33.06batch/s]
Validation 74 -> LOSS = 0.24
Validation 74 -> BLEU = 96.94, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
** Learning rate changed -> 1.25e-05
Saving best model based on LOSS
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 74
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 75
Epoch 75 - update      35670 => loss:   0.037 (#OOM: 0)
Epoch 75 - update      35700 => loss:   0.056 (#OOM: 0)
Epoch 75 - update      35730 => loss:   0.033 (#OOM: 0)
Epoch 75 - update      35760 => loss:   0.032 (#OOM: 0)
Epoch 75 - update      35790 => loss:   0.051 (#OOM: 0)
Epoch 75 - update      35820 => loss:   0.033 (#OOM: 0)
Epoch 75 - update      35850 => loss:   0.044 (#OOM: 0)
Epoch 75 - update      35880 => loss:   0.059 (#OOM: 0)
Epoch 75 - update      35910 => loss:   0.043 (#OOM: 0)
Epoch 75 - update      35940 => loss:   0.049 (#OOM: 0)
Epoch 75 - update      35970 => loss:   0.037 (#OOM: 0)
Epoch 75 - update      36000 => loss:   0.038 (#OOM: 0)
Epoch 75 - update      36030 => loss:   0.026 (#OOM: 0)
Epoch 75 - update      36060 => loss:   0.034 (#OOM: 0)
Epoch 75 - update      36090 => loss:   0.065 (#OOM: 0)
Epoch 75 - update      36120 => loss:   0.030 (#OOM: 0)
Epoch 75 - update      36150 => loss:   0.093 (#OOM: 0)
--> Epoch 75 finished with mean loss 0.04927
--> Overhead/Training/Evaluation: 0.65/0.73/0.00 mins (total: 1.38 mins)   (664 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 16.08batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.47batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.03batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.47batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.55batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.49batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 11.88batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.05batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 11.78batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.43batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 12.91batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.13batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.15batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:31, 32.26batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.32batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 35.13batch/s]  2%|▍                           | 16/1014 [00:00<00:27, 36.11batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 32.83batch/s]  2%|▋                           | 24/1014 [00:00<00:30, 32.52batch/s]  3%|▊                           | 28/1014 [00:00<00:30, 31.96batch/s]  3%|▉                           | 33/1014 [00:00<00:29, 33.30batch/s]  4%|█                           | 38/1014 [00:01<00:29, 33.11batch/s]  4%|█▏                          | 43/1014 [00:01<00:29, 32.91batch/s]  5%|█▎                          | 48/1014 [00:01<00:30, 31.69batch/s]  5%|█▍                          | 53/1014 [00:01<00:31, 30.79batch/s]  6%|█▌                          | 58/1014 [00:01<00:30, 31.02batch/s]  6%|█▋                          | 63/1014 [00:02<00:30, 30.86batch/s]  7%|█▉                          | 68/1014 [00:02<00:31, 30.38batch/s]  7%|██                          | 73/1014 [00:02<00:31, 30.09batch/s]  8%|██▏                         | 78/1014 [00:02<00:31, 29.89batch/s]  8%|██▎                         | 83/1014 [00:02<00:31, 29.77batch/s]  9%|██▍                         | 88/1014 [00:03<00:31, 29.19batch/s]  9%|██▌                         | 93/1014 [00:03<00:31, 29.15batch/s] 10%|██▋                         | 98/1014 [00:03<00:31, 29.43batch/s] 10%|██▋                        | 103/1014 [00:03<00:30, 29.74batch/s] 11%|██▉                        | 108/1014 [00:03<00:30, 29.88batch/s] 11%|███                        | 113/1014 [00:03<00:29, 30.05batch/s] 12%|███▏                       | 118/1014 [00:03<00:29, 30.10batch/s] 12%|███▎                       | 123/1014 [00:04<00:29, 30.37batch/s] 13%|███▍                       | 128/1014 [00:04<00:28, 30.81batch/s] 13%|███▌                       | 133/1014 [00:04<00:28, 30.80batch/s] 14%|███▋                       | 138/1014 [00:04<00:28, 30.93batch/s] 14%|███▊                       | 143/1014 [00:04<00:28, 30.98batch/s] 15%|███▉                       | 148/1014 [00:04<00:27, 31.03batch/s] 15%|████                       | 153/1014 [00:04<00:27, 31.22batch/s] 16%|████▏                      | 158/1014 [00:05<00:27, 31.02batch/s] 16%|████▎                      | 163/1014 [00:05<00:27, 31.08batch/s] 17%|████▍                      | 168/1014 [00:05<00:27, 30.94batch/s] 17%|████▌                      | 173/1014 [00:05<00:27, 31.11batch/s] 18%|████▋                      | 178/1014 [00:05<00:26, 31.29batch/s] 18%|████▊                      | 183/1014 [00:05<00:26, 31.37batch/s] 19%|█████                      | 188/1014 [00:05<00:26, 31.54batch/s] 19%|█████▏                     | 193/1014 [00:06<00:26, 31.40batch/s] 20%|█████▎                     | 198/1014 [00:06<00:25, 31.44batch/s] 20%|█████▍                     | 203/1014 [00:06<00:25, 31.56batch/s] 21%|█████▌                     | 208/1014 [00:06<00:25, 31.63batch/s] 21%|█████▋                     | 213/1014 [00:06<00:25, 31.68batch/s] 21%|█████▊                     | 218/1014 [00:06<00:25, 31.80batch/s] 22%|█████▉                     | 223/1014 [00:07<00:24, 31.73batch/s] 22%|██████                     | 228/1014 [00:07<00:24, 31.92batch/s] 23%|██████▏                    | 233/1014 [00:07<00:24, 32.07batch/s] 23%|██████▎                    | 238/1014 [00:07<00:24, 32.19batch/s] 24%|██████▍                    | 243/1014 [00:07<00:23, 32.31batch/s] 24%|██████▌                    | 248/1014 [00:07<00:23, 32.42batch/s] 25%|██████▋                    | 253/1014 [00:07<00:23, 32.56batch/s] 25%|██████▊                    | 258/1014 [00:07<00:23, 32.53batch/s] 26%|███████                    | 263/1014 [00:08<00:23, 32.57batch/s] 26%|███████▏                   | 268/1014 [00:08<00:22, 32.69batch/s] 27%|███████▎                   | 273/1014 [00:08<00:22, 32.82batch/s] 27%|███████▍                   | 278/1014 [00:08<00:22, 32.96batch/s] 28%|███████▌                   | 283/1014 [00:08<00:22, 32.96batch/s] 28%|███████▋                   | 288/1014 [00:08<00:22, 32.92batch/s] 29%|███████▊                   | 293/1014 [00:08<00:21, 33.03batch/s] 29%|███████▉                   | 298/1014 [00:09<00:21, 32.95batch/s] 30%|████████                   | 303/1014 [00:09<00:21, 33.08batch/s] 30%|████████▏                  | 308/1014 [00:09<00:21, 33.22batch/s] 31%|████████▎                  | 313/1014 [00:09<00:21, 33.29batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 33.26batch/s] 32%|████████▌                  | 323/1014 [00:09<00:20, 33.36batch/s] 32%|████████▋                  | 328/1014 [00:09<00:20, 33.46batch/s] 33%|████████▊                  | 333/1014 [00:09<00:20, 33.60batch/s] 33%|█████████                  | 338/1014 [00:10<00:20, 33.64batch/s] 34%|█████████▏                 | 343/1014 [00:10<00:19, 33.61batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 33.61batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 33.70batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:19, 33.80batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:19, 33.86batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:19, 33.92batch/s] 37%|█████████▉                 | 373/1014 [00:11<00:18, 33.87batch/s] 37%|██████████                 | 378/1014 [00:11<00:18, 33.77batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 33.81batch/s] 38%|██████████▎                | 388/1014 [00:11<00:18, 33.93batch/s] 39%|██████████▍                | 393/1014 [00:11<00:18, 33.98batch/s] 39%|██████████▌                | 398/1014 [00:11<00:18, 33.91batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 33.99batch/s] 40%|██████████▊                | 408/1014 [00:12<00:17, 33.91batch/s] 41%|██████████▉                | 413/1014 [00:12<00:17, 34.01batch/s] 41%|███████████▏               | 418/1014 [00:12<00:17, 34.02batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 34.04batch/s] 42%|███████████▍               | 428/1014 [00:12<00:17, 34.04batch/s] 43%|███████████▌               | 433/1014 [00:12<00:17, 34.00batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 33.95batch/s] 44%|███████████▊               | 443/1014 [00:13<00:16, 33.92batch/s] 44%|███████████▉               | 448/1014 [00:13<00:16, 33.93batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 33.99batch/s] 45%|████████████▏              | 458/1014 [00:13<00:16, 33.95batch/s] 46%|████████████▎              | 463/1014 [00:13<00:16, 33.96batch/s] 46%|████████████▍              | 468/1014 [00:13<00:16, 33.90batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 33.91batch/s] 47%|████████████▋              | 478/1014 [00:14<00:15, 33.95batch/s] 48%|████████████▊              | 483/1014 [00:14<00:15, 33.98batch/s] 48%|████████████▉              | 488/1014 [00:14<00:15, 33.93batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:15, 33.89batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:15, 33.81batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:15, 33.84batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 33.87batch/s] 51%|█████████████▋             | 513/1014 [00:15<00:14, 33.83batch/s] 51%|█████████████▊             | 518/1014 [00:15<00:14, 33.85batch/s] 52%|█████████████▉             | 523/1014 [00:15<00:14, 33.90batch/s] 52%|██████████████             | 528/1014 [00:15<00:14, 33.97batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:14, 33.99batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:14, 33.98batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.03batch/s] 54%|██████████████▌            | 548/1014 [00:16<00:13, 34.10batch/s] 55%|██████████████▋            | 553/1014 [00:16<00:13, 34.15batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 34.13batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.17batch/s] 56%|███████████████            | 568/1014 [00:16<00:13, 34.24batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.17batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 34.16batch/s] 57%|███████████████▌           | 583/1014 [00:17<00:12, 34.17batch/s] 58%|███████████████▋           | 588/1014 [00:17<00:12, 34.14batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.13batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:12, 34.14batch/s] 59%|████████████████           | 603/1014 [00:17<00:12, 34.20batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 34.15batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 34.15batch/s] 61%|████████████████▍          | 618/1014 [00:18<00:11, 34.13batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 34.20batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 34.18batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:11, 34.18batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 34.20batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 34.23batch/s] 64%|█████████████████▎         | 648/1014 [00:19<00:10, 34.09batch/s] 64%|█████████████████▍         | 653/1014 [00:19<00:10, 34.03batch/s] 65%|█████████████████▌         | 658/1014 [00:19<00:10, 33.98batch/s] 65%|█████████████████▋         | 663/1014 [00:19<00:10, 33.97batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:10, 33.99batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:10, 33.97batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.00batch/s] 67%|██████████████████▏        | 683/1014 [00:20<00:09, 33.97batch/s] 68%|██████████████████▎        | 688/1014 [00:20<00:09, 34.00batch/s] 68%|██████████████████▍        | 693/1014 [00:20<00:09, 34.00batch/s] 69%|██████████████████▌        | 698/1014 [00:20<00:09, 34.02batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:09, 34.07batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.08batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.09batch/s] 71%|███████████████████        | 718/1014 [00:21<00:08, 34.04batch/s] 71%|███████████████████▎       | 723/1014 [00:21<00:08, 34.03batch/s] 72%|███████████████████▍       | 728/1014 [00:21<00:08, 34.04batch/s] 72%|███████████████████▌       | 733/1014 [00:21<00:08, 34.04batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:08, 34.03batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 33.94batch/s] 74%|███████████████████▉       | 748/1014 [00:22<00:07, 33.90batch/s] 74%|████████████████████       | 753/1014 [00:22<00:07, 33.88batch/s] 75%|████████████████████▏      | 758/1014 [00:22<00:07, 33.94batch/s] 75%|████████████████████▎      | 763/1014 [00:22<00:07, 33.92batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 33.95batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:07, 33.91batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 33.93batch/s] 77%|████████████████████▊      | 783/1014 [00:23<00:06, 33.91batch/s] 78%|████████████████████▉      | 788/1014 [00:23<00:06, 33.93batch/s] 78%|█████████████████████      | 793/1014 [00:23<00:06, 33.96batch/s] 79%|█████████████████████▏     | 798/1014 [00:23<00:06, 33.98batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 33.98batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:06, 33.99batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.00batch/s] 81%|█████████████████████▊     | 818/1014 [00:24<00:05, 34.03batch/s] 81%|█████████████████████▉     | 823/1014 [00:24<00:05, 34.07batch/s] 82%|██████████████████████     | 828/1014 [00:24<00:05, 34.05batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.06batch/s] 83%|██████████████████████▎    | 838/1014 [00:24<00:05, 34.06batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:05, 34.04batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.07batch/s] 84%|██████████████████████▋    | 853/1014 [00:25<00:04, 34.03batch/s] 85%|██████████████████████▊    | 858/1014 [00:25<00:04, 34.02batch/s] 85%|██████████████████████▉    | 863/1014 [00:25<00:04, 34.05batch/s] 86%|███████████████████████    | 868/1014 [00:25<00:04, 34.00batch/s] 86%|███████████████████████▏   | 873/1014 [00:25<00:04, 34.01batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.04batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 33.99batch/s] 88%|███████████████████████▋   | 888/1014 [00:26<00:03, 33.99batch/s] 88%|███████████████████████▊   | 893/1014 [00:26<00:03, 34.00batch/s] 89%|███████████████████████▉   | 898/1014 [00:26<00:03, 34.02batch/s] 89%|████████████████████████   | 903/1014 [00:26<00:03, 34.03batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.05batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.08batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.11batch/s] 91%|████████████████████████▌  | 923/1014 [00:27<00:02, 34.12batch/s] 92%|████████████████████████▋  | 928/1014 [00:27<00:02, 34.10batch/s] 92%|████████████████████████▊  | 933/1014 [00:27<00:02, 34.10batch/s] 93%|████████████████████████▉  | 938/1014 [00:27<00:02, 34.12batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 34.10batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.08batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.08batch/s] 94%|█████████████████████████▌ | 958/1014 [00:28<00:01, 34.09batch/s] 95%|█████████████████████████▋ | 963/1014 [00:28<00:01, 34.10batch/s] 95%|█████████████████████████▊ | 968/1014 [00:28<00:01, 34.07batch/s] 96%|█████████████████████████▉ | 973/1014 [00:28<00:01, 34.09batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.05batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.05batch/s] 97%|██████████████████████████▎| 988/1014 [00:29<00:00, 34.07batch/s] 98%|██████████████████████████▍| 993/1014 [00:29<00:00, 34.06batch/s] 98%|██████████████████████████▌| 998/1014 [00:29<00:00, 34.08batch/s] 99%|█████████████████████████▋| 1003/1014 [00:29<00:00, 34.09batch/s] 99%|█████████████████████████▊| 1008/1014 [00:29<00:00, 34.11batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.11batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.12batch/s]
Validation 75 -> LOSS = 0.24
Validation 75 -> BLEU = 96.93, 98.8/97.5/96.5/95.3 (BP=0.999, ratio=0.999, hyp_len=14373, ref_len=14382)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 74
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 76
Epoch 76 - update      36180 => loss:   0.060 (#OOM: 0)
Epoch 76 - update      36210 => loss:   0.059 (#OOM: 0)
Epoch 76 - update      36240 => loss:   0.053 (#OOM: 0)
Epoch 76 - update      36270 => loss:   0.069 (#OOM: 0)
Epoch 76 - update      36300 => loss:   0.052 (#OOM: 0)
Epoch 76 - update      36330 => loss:   0.040 (#OOM: 0)
Epoch 76 - update      36360 => loss:   0.061 (#OOM: 0)
Epoch 76 - update      36390 => loss:   0.007 (#OOM: 0)
Epoch 76 - update      36420 => loss:   0.048 (#OOM: 0)
Epoch 76 - update      36450 => loss:   0.033 (#OOM: 0)
Epoch 76 - update      36480 => loss:   0.037 (#OOM: 0)
Epoch 76 - update      36510 => loss:   0.028 (#OOM: 0)
Epoch 76 - update      36540 => loss:   0.055 (#OOM: 0)
Epoch 76 - update      36570 => loss:   0.083 (#OOM: 0)
Epoch 76 - update      36600 => loss:   0.067 (#OOM: 0)
Epoch 76 - update      36630 => loss:   0.023 (#OOM: 0)
--> Epoch 76 finished with mean loss 0.04948
--> Overhead/Training/Evaluation: 0.61/0.72/0.00 mins (total: 1.33 mins)   (670 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.38batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.88batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.95batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.48batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.25batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.81batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.52batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.02batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.29batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.60batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.59batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.91batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.87batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.25batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.70batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.97batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.25batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.36batch/s]  1%|▎                           | 12/1014 [00:00<00:27, 36.92batch/s]  2%|▍                           | 16/1014 [00:00<00:27, 36.03batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 36.08batch/s]  2%|▋                           | 24/1014 [00:00<00:27, 35.94batch/s]  3%|▊                           | 28/1014 [00:00<00:28, 34.06batch/s]  3%|▉                           | 32/1014 [00:00<00:29, 33.81batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 33.99batch/s]  4%|█                           | 40/1014 [00:01<00:28, 33.85batch/s]  4%|█▏                          | 44/1014 [00:01<00:28, 33.86batch/s]  5%|█▎                          | 48/1014 [00:01<00:28, 33.75batch/s]  5%|█▍                          | 52/1014 [00:01<00:28, 34.10batch/s]  6%|█▌                          | 56/1014 [00:01<00:28, 33.91batch/s]  6%|█▋                          | 60/1014 [00:01<00:28, 33.42batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 33.91batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.03batch/s]  7%|██                          | 75/1014 [00:02<00:27, 33.97batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 33.87batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 34.25batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 33.83batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.13batch/s] 10%|██▋                        | 100/1014 [00:02<00:27, 33.84batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 33.87batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.22batch/s] 11%|███                        | 115/1014 [00:03<00:26, 34.09batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 34.26batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 34.19batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.09batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.14batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.22batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.27batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.34batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 34.55batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.69batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.66batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.77batch/s] 17%|████▋                      | 175/1014 [00:05<00:23, 34.97batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 34.92batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 34.86batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.97batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.93batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.91batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.83batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.90batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 34.90batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 34.86batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.85batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.79batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.87batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.91batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.87batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 34.83batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 34.71batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.73batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.78batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.79batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.79batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.78batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 34.79batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.91batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.91batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.90batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.76batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.78batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.79batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 34.70batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.71batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.73batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.67batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.58batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 34.55batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.50batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.40batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.45batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.48batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.51batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.54batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.45batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.50batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.58batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.52batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.50batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.55batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.64batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 34.72batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.61batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.61batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.63batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.65batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.66batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.66batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.58batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.51batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.56batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.61batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.61batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.66batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.71batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.79batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.83batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 34.76batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.69batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.71batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.75batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.72batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 34.72batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.69batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 34.77batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 34.90batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 34.88batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 34.92batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.96batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:12, 34.92batch/s] 56%|███████████████            | 566/1014 [00:16<00:12, 34.98batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 34.98batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.01batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.03batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 35.10batch/s] 59%|███████████████▊           | 596/1014 [00:17<00:11, 35.06batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 35.10batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.13batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.19batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.13batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:11, 35.16batch/s] 62%|████████████████▊          | 632/1014 [00:17<00:10, 35.14batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.15batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.13batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.18batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 35.21batch/s] 65%|█████████████████▋         | 662/1014 [00:18<00:09, 35.22batch/s] 66%|█████████████████▊         | 668/1014 [00:18<00:09, 35.18batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.10batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 35.13batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 35.16batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 35.15batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.19batch/s] 69%|██████████████████▋        | 704/1014 [00:19<00:08, 35.22batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.16batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 35.11batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 35.14batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.10batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.07batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 35.07batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 35.07batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 35.03batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.06batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.06batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:06, 34.99batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 35.00batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 34.99batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 34.94batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.96batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 35.03batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:05, 35.03batch/s] 80%|█████████████████████▌     | 812/1014 [00:23<00:05, 34.97batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.99batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.98batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.02batch/s] 82%|██████████████████████▎    | 836/1014 [00:23<00:05, 34.92batch/s] 83%|██████████████████████▍    | 842/1014 [00:24<00:04, 34.97batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 35.00batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.01batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.98batch/s] 85%|███████████████████████    | 866/1014 [00:24<00:04, 35.03batch/s] 86%|███████████████████████▏   | 872/1014 [00:24<00:04, 34.98batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.92batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.95batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.94batch/s] 88%|███████████████████████▊   | 896/1014 [00:25<00:03, 34.97batch/s] 89%|████████████████████████   | 902/1014 [00:25<00:03, 35.03batch/s] 90%|████████████████████████▏  | 908/1014 [00:25<00:03, 35.03batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 35.03batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 35.02batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 35.00batch/s] 92%|████████████████████████▊  | 932/1014 [00:26<00:02, 35.01batch/s] 93%|████████████████████████▉  | 938/1014 [00:26<00:02, 35.00batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:02, 34.98batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.98batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 34.98batch/s] 95%|█████████████████████████▌ | 962/1014 [00:27<00:01, 34.97batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 34.96batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 34.93batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.93batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 34.95batch/s] 98%|██████████████████████████▍| 992/1014 [00:28<00:00, 34.94batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 34.91batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.92batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 34.93batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.96batch/s]
Validation 76 -> LOSS = 0.24
Validation 76 -> BLEU = 96.94, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 76
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 77
Epoch 77 - update      36660 => loss:   0.059 (#OOM: 0)
Epoch 77 - update      36690 => loss:   0.033 (#OOM: 0)
Epoch 77 - update      36720 => loss:   0.038 (#OOM: 0)
Epoch 77 - update      36750 => loss:   0.036 (#OOM: 0)
Epoch 77 - update      36780 => loss:   0.027 (#OOM: 0)
Epoch 77 - update      36810 => loss:   0.072 (#OOM: 0)
Epoch 77 - update      36840 => loss:   0.042 (#OOM: 0)
Epoch 77 - update      36870 => loss:   0.050 (#OOM: 0)
Epoch 77 - update      36900 => loss:   0.033 (#OOM: 0)
Epoch 77 - update      36930 => loss:   0.033 (#OOM: 0)
Epoch 77 - update      36960 => loss:   0.036 (#OOM: 0)
Epoch 77 - update      36990 => loss:   0.065 (#OOM: 0)
Epoch 77 - update      37020 => loss:   0.052 (#OOM: 0)
Epoch 77 - update      37050 => loss:   0.050 (#OOM: 0)
Epoch 77 - update      37080 => loss:   0.030 (#OOM: 0)
Epoch 77 - update      37110 => loss:   0.058 (#OOM: 0)
--> Epoch 77 finished with mean loss 0.04899
--> Overhead/Training/Evaluation: 0.60/0.72/0.00 mins (total: 1.32 mins)   (671 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.83batch/s]  9%|██▋                            | 3/34 [00:00<00:03, 10.18batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 10.90batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 11.21batch/s] 26%|████████▏                      | 9/34 [00:00<00:02, 10.99batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.60batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 13.18batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.38batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.80batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.87batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.82batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.94batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.92batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.99batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:30, 33.05batch/s]  1%|▏                            | 8/1014 [00:00<00:32, 31.01batch/s]  1%|▎                           | 12/1014 [00:00<00:32, 30.75batch/s]  2%|▍                           | 16/1014 [00:00<00:31, 31.29batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 32.36batch/s]  2%|▋                           | 24/1014 [00:00<00:29, 33.37batch/s]  3%|▊                           | 29/1014 [00:00<00:28, 34.27batch/s]  3%|▉                           | 34/1014 [00:01<00:28, 33.97batch/s]  4%|█                           | 39/1014 [00:01<00:28, 34.18batch/s]  4%|█▏                          | 44/1014 [00:01<00:28, 33.80batch/s]  5%|█▎                          | 49/1014 [00:01<00:28, 33.99batch/s]  5%|█▍                          | 54/1014 [00:01<00:28, 34.00batch/s]  6%|█▋                          | 59/1014 [00:01<00:28, 33.90batch/s]  6%|█▊                          | 64/1014 [00:01<00:27, 34.05batch/s]  7%|█▉                          | 69/1014 [00:02<00:27, 34.25batch/s]  7%|██                          | 74/1014 [00:02<00:28, 33.13batch/s]  8%|██▏                         | 79/1014 [00:02<00:28, 33.00batch/s]  8%|██▎                         | 84/1014 [00:02<00:28, 32.66batch/s]  9%|██▍                         | 89/1014 [00:02<00:28, 32.38batch/s]  9%|██▌                         | 94/1014 [00:02<00:28, 32.15batch/s] 10%|██▋                         | 99/1014 [00:03<00:28, 32.25batch/s] 10%|██▊                        | 104/1014 [00:03<00:28, 32.34batch/s] 11%|██▉                        | 109/1014 [00:03<00:27, 32.70batch/s] 11%|███                        | 114/1014 [00:03<00:27, 32.74batch/s] 12%|███▏                       | 119/1014 [00:03<00:27, 32.78batch/s] 12%|███▎                       | 124/1014 [00:03<00:27, 32.73batch/s] 13%|███▍                       | 129/1014 [00:03<00:26, 32.86batch/s] 13%|███▌                       | 134/1014 [00:04<00:27, 32.40batch/s] 14%|███▋                       | 139/1014 [00:04<00:26, 32.64batch/s] 14%|███▊                       | 144/1014 [00:04<00:26, 32.32batch/s] 15%|███▉                       | 149/1014 [00:04<00:26, 32.29batch/s] 15%|████                       | 154/1014 [00:04<00:26, 32.51batch/s] 16%|████▏                      | 159/1014 [00:04<00:26, 32.64batch/s] 16%|████▎                      | 164/1014 [00:04<00:25, 32.80batch/s] 17%|████▌                      | 169/1014 [00:05<00:25, 33.02batch/s] 17%|████▋                      | 174/1014 [00:05<00:25, 33.12batch/s] 18%|████▊                      | 179/1014 [00:05<00:25, 32.94batch/s] 18%|████▉                      | 184/1014 [00:05<00:25, 33.06batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 33.21batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 33.13batch/s] 20%|█████▎                     | 199/1014 [00:05<00:24, 33.24batch/s] 20%|█████▍                     | 204/1014 [00:06<00:24, 33.23batch/s] 21%|█████▌                     | 209/1014 [00:06<00:24, 33.20batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 33.35batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 33.36batch/s] 22%|█████▉                     | 224/1014 [00:06<00:23, 33.29batch/s] 23%|██████                     | 229/1014 [00:06<00:23, 33.29batch/s] 23%|██████▏                    | 234/1014 [00:07<00:23, 33.36batch/s] 24%|██████▎                    | 239/1014 [00:07<00:23, 33.46batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 33.56batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 33.70batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 33.77batch/s] 26%|██████▉                    | 259/1014 [00:07<00:22, 33.85batch/s] 26%|███████                    | 264/1014 [00:07<00:22, 33.98batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.00batch/s] 27%|███████▎                   | 274/1014 [00:08<00:21, 33.94batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.05batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 34.01batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.05batch/s] 29%|███████▊                   | 294/1014 [00:08<00:21, 34.05batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.13batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.09batch/s] 30%|████████▏                  | 309/1014 [00:09<00:20, 34.05batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.19batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.18batch/s] 32%|████████▋                  | 324/1014 [00:09<00:20, 34.25batch/s] 32%|████████▊                  | 329/1014 [00:09<00:20, 33.93batch/s] 33%|████████▉                  | 334/1014 [00:09<00:20, 33.91batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 33.94batch/s] 34%|█████████▏                 | 344/1014 [00:10<00:19, 33.97batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.00batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 34.02batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:19, 34.05batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:19, 34.08batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.01batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.02batch/s] 37%|██████████                 | 379/1014 [00:11<00:18, 33.94batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.00batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.02batch/s] 39%|██████████▍                | 394/1014 [00:11<00:18, 34.05batch/s] 39%|██████████▌                | 399/1014 [00:11<00:18, 33.93batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 33.90batch/s] 40%|██████████▉                | 409/1014 [00:12<00:17, 33.98batch/s] 41%|███████████                | 414/1014 [00:12<00:17, 33.97batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 33.92batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 33.99batch/s] 42%|███████████▍               | 429/1014 [00:12<00:17, 34.00batch/s] 43%|███████████▌               | 434/1014 [00:12<00:17, 34.00batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.05batch/s] 44%|███████████▊               | 444/1014 [00:13<00:16, 34.10batch/s] 44%|███████████▉               | 449/1014 [00:13<00:16, 34.17batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.07batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.12batch/s] 46%|████████████▎              | 464/1014 [00:13<00:16, 34.10batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.18batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.16batch/s] 47%|████████████▊              | 479/1014 [00:14<00:15, 34.18batch/s] 48%|████████████▉              | 484/1014 [00:14<00:15, 34.23batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.22batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:15, 34.23batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:15, 34.28batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.34batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.36batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.40batch/s] 51%|█████████████▊             | 519/1014 [00:15<00:14, 34.42batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.44batch/s] 52%|██████████████             | 529/1014 [00:15<00:14, 34.45batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.44batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.47batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.55batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.60batch/s] 55%|██████████████▊            | 554/1014 [00:16<00:13, 34.58batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.59batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.64batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.66batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.64batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.66batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.61batch/s] 58%|███████████████▋           | 589/1014 [00:17<00:12, 34.64batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.60batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.61batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.65batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.62batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.66batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.69batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.75batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.79batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.81batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.82batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.77batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 34.79batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 34.80batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.84batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.84batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.84batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 34.84batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.89batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 34.90batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.88batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.93batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:09, 34.97batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.97batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.98batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.94batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.98batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.98batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 34.95batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 34.95batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.95batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.90batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.93batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.95batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.95batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 34.96batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.02batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 35.02batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.07batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.07batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.02batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.00batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.96batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:06, 34.99batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 35.00batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.01batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.05batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.09batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.08batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.15batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.10batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 35.08batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.07batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.07batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.03batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.01batch/s] 86%|███████████████████████▎   | 877/1014 [00:25<00:03, 35.04batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.98batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.01batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.05batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.09batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 35.07batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 35.07batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.09batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.15batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.08batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.12batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.10batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 35.09batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.11batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.12batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.13batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.12batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.15batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 35.09batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 35.12batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.10batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.12batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.11batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.09batch/s]
Validation 77 -> LOSS = 0.24
Validation 77 -> BLEU = 96.94, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
** Learning rate changed -> 6.25e-06
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 76
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 78
Epoch 78 - update      37140 => loss:   0.056 (#OOM: 0)
Epoch 78 - update      37170 => loss:   0.084 (#OOM: 0)
Epoch 78 - update      37200 => loss:   0.027 (#OOM: 0)
Epoch 78 - update      37230 => loss:   0.087 (#OOM: 0)
Epoch 78 - update      37260 => loss:   0.034 (#OOM: 0)
Epoch 78 - update      37290 => loss:   0.047 (#OOM: 0)
Epoch 78 - update      37320 => loss:   0.055 (#OOM: 0)
Epoch 78 - update      37350 => loss:   0.042 (#OOM: 0)
Epoch 78 - update      37380 => loss:   0.072 (#OOM: 0)
Epoch 78 - update      37410 => loss:   0.035 (#OOM: 0)
Epoch 78 - update      37440 => loss:   0.042 (#OOM: 0)
Epoch 78 - update      37470 => loss:   0.066 (#OOM: 0)
Epoch 78 - update      37500 => loss:   0.057 (#OOM: 0)
Epoch 78 - update      37530 => loss:   0.066 (#OOM: 0)
Epoch 78 - update      37560 => loss:   0.029 (#OOM: 0)
Epoch 78 - update      37590 => loss:   0.059 (#OOM: 0)
--> Epoch 78 finished with mean loss 0.04886
--> Overhead/Training/Evaluation: 0.61/0.72/0.00 mins (total: 1.34 mins)   (669 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 16.78batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 15.17batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 14.03batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.91batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 14.03batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.03batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.12batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.31batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.41batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.45batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.79batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.70batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.90batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 38.33batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.34batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 35.52batch/s]  2%|▍                           | 16/1014 [00:00<00:27, 36.40batch/s]  2%|▌                           | 20/1014 [00:00<00:31, 32.00batch/s]  2%|▋                           | 24/1014 [00:00<00:30, 32.51batch/s]  3%|▊                           | 28/1014 [00:00<00:29, 33.06batch/s]  3%|▉                           | 33/1014 [00:00<00:28, 34.28batch/s]  4%|█                           | 38/1014 [00:01<00:28, 34.70batch/s]  4%|█▏                          | 43/1014 [00:01<00:28, 34.51batch/s]  5%|█▎                          | 48/1014 [00:01<00:28, 33.41batch/s]  5%|█▍                          | 53/1014 [00:01<00:29, 32.61batch/s]  6%|█▌                          | 58/1014 [00:01<00:28, 33.31batch/s]  6%|█▋                          | 63/1014 [00:01<00:28, 33.61batch/s]  7%|█▉                          | 68/1014 [00:02<00:28, 33.30batch/s]  7%|██                          | 73/1014 [00:02<00:28, 33.17batch/s]  8%|██▏                         | 78/1014 [00:02<00:28, 32.98batch/s]  8%|██▎                         | 83/1014 [00:02<00:29, 32.07batch/s]  9%|██▍                         | 88/1014 [00:02<00:28, 32.13batch/s]  9%|██▌                         | 93/1014 [00:02<00:28, 32.09batch/s] 10%|██▋                         | 98/1014 [00:03<00:28, 32.23batch/s] 10%|██▋                        | 103/1014 [00:03<00:28, 32.05batch/s] 11%|██▉                        | 108/1014 [00:03<00:28, 32.31batch/s] 11%|███                        | 113/1014 [00:03<00:27, 32.33batch/s] 12%|███▏                       | 118/1014 [00:03<00:27, 32.41batch/s] 12%|███▎                       | 123/1014 [00:03<00:27, 32.85batch/s] 13%|███▍                       | 128/1014 [00:03<00:26, 32.82batch/s] 13%|███▌                       | 133/1014 [00:04<00:26, 32.91batch/s] 14%|███▋                       | 138/1014 [00:04<00:26, 32.88batch/s] 14%|███▊                       | 143/1014 [00:04<00:26, 32.89batch/s] 15%|███▉                       | 148/1014 [00:04<00:26, 33.05batch/s] 15%|████                       | 153/1014 [00:04<00:26, 33.04batch/s] 16%|████▏                      | 158/1014 [00:04<00:25, 33.20batch/s] 16%|████▎                      | 163/1014 [00:04<00:25, 33.13batch/s] 17%|████▍                      | 168/1014 [00:05<00:25, 32.99batch/s] 17%|████▌                      | 173/1014 [00:05<00:25, 33.01batch/s] 18%|████▋                      | 178/1014 [00:05<00:25, 33.09batch/s] 18%|████▊                      | 183/1014 [00:05<00:25, 33.22batch/s] 19%|█████                      | 188/1014 [00:05<00:24, 33.34batch/s] 19%|█████▏                     | 193/1014 [00:05<00:24, 33.43batch/s] 20%|█████▎                     | 198/1014 [00:05<00:24, 33.44batch/s] 20%|█████▍                     | 203/1014 [00:06<00:24, 33.48batch/s] 21%|█████▌                     | 208/1014 [00:06<00:23, 33.67batch/s] 21%|█████▋                     | 213/1014 [00:06<00:23, 33.76batch/s] 21%|█████▊                     | 218/1014 [00:06<00:23, 33.80batch/s] 22%|█████▉                     | 223/1014 [00:06<00:23, 33.87batch/s] 22%|██████                     | 228/1014 [00:06<00:23, 33.70batch/s] 23%|██████▏                    | 233/1014 [00:06<00:23, 33.84batch/s] 23%|██████▎                    | 238/1014 [00:07<00:22, 33.83batch/s] 24%|██████▍                    | 243/1014 [00:07<00:22, 33.89batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 33.95batch/s] 25%|██████▋                    | 253/1014 [00:07<00:22, 33.82batch/s] 25%|██████▊                    | 258/1014 [00:07<00:22, 33.84batch/s] 26%|███████                    | 263/1014 [00:07<00:22, 33.78batch/s] 26%|███████▏                   | 268/1014 [00:07<00:22, 33.85batch/s] 27%|███████▎                   | 273/1014 [00:08<00:21, 33.83batch/s] 27%|███████▍                   | 278/1014 [00:08<00:21, 33.77batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 33.79batch/s] 28%|███████▋                   | 288/1014 [00:08<00:21, 33.89batch/s] 29%|███████▊                   | 293/1014 [00:08<00:21, 33.82batch/s] 29%|███████▉                   | 298/1014 [00:08<00:21, 33.95batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 33.94batch/s] 30%|████████▏                  | 308/1014 [00:09<00:20, 33.91batch/s] 31%|████████▎                  | 313/1014 [00:09<00:20, 33.97batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 34.01batch/s] 32%|████████▌                  | 323/1014 [00:09<00:20, 34.05batch/s] 32%|████████▋                  | 328/1014 [00:09<00:20, 34.12batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 34.16batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 34.20batch/s] 34%|█████████▏                 | 343/1014 [00:10<00:19, 34.26batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 34.27batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 34.26batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:19, 34.28batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:19, 34.18batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 34.23batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 34.20batch/s] 37%|██████████                 | 378/1014 [00:11<00:18, 34.28batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 34.34batch/s] 38%|██████████▎                | 388/1014 [00:11<00:18, 34.38batch/s] 39%|██████████▍                | 393/1014 [00:11<00:18, 34.32batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 34.38batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 34.36batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 34.38batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 34.46batch/s] 41%|███████████▏               | 418/1014 [00:12<00:17, 34.49batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 34.56batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 34.57batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 34.58batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 34.55batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.42batch/s] 44%|███████████▉               | 448/1014 [00:13<00:16, 34.42batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 34.36batch/s] 45%|████████████▏              | 458/1014 [00:13<00:16, 34.38batch/s] 46%|████████████▎              | 463/1014 [00:13<00:16, 34.31batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 34.33batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.32batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 34.30batch/s] 48%|████████████▊              | 483/1014 [00:14<00:15, 34.25batch/s] 48%|████████████▉              | 488/1014 [00:14<00:15, 34.25batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:15, 34.23batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:15, 34.26batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.27batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 34.31batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 34.32batch/s] 51%|█████████████▊             | 518/1014 [00:15<00:14, 34.23batch/s] 52%|█████████████▉             | 523/1014 [00:15<00:14, 34.32batch/s] 52%|██████████████             | 528/1014 [00:15<00:14, 34.36batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 34.38batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 34.34batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.34batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 34.34batch/s] 55%|██████████████▋            | 553/1014 [00:16<00:13, 34.34batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 34.35batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.37batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 34.37batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.41batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 34.47batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 34.45batch/s] 58%|███████████████▋           | 588/1014 [00:17<00:12, 34.46batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.46batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:12, 34.41batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 34.34batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 34.35batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 34.32batch/s] 61%|████████████████▍          | 618/1014 [00:18<00:11, 34.18batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 34.15batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 34.19batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:11, 34.19batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 34.20batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 34.22batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 34.17batch/s] 64%|█████████████████▍         | 653/1014 [00:19<00:10, 34.20batch/s] 65%|█████████████████▌         | 658/1014 [00:19<00:10, 34.24batch/s] 65%|█████████████████▋         | 663/1014 [00:19<00:10, 34.26batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:10, 34.32batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 34.36batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.38batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.37batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 34.43batch/s] 68%|██████████████████▍        | 693/1014 [00:20<00:09, 34.43batch/s] 69%|██████████████████▌        | 698/1014 [00:20<00:09, 34.50batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:09, 34.54batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.58batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.62batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 34.67batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 34.70batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 34.75batch/s] 72%|███████████████████▌       | 733/1014 [00:21<00:08, 34.76batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:07, 34.78batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.75batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.77batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.77batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 34.77batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 34.75batch/s] 76%|████████████████████▍      | 768/1014 [00:22<00:07, 34.72batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.70batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.71batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 34.71batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 34.72batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 34.72batch/s] 79%|█████████████████████▏     | 798/1014 [00:23<00:06, 34.66batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.67batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 34.67batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.67batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.66batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 34.70batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 34.70batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 34.71batch/s] 83%|██████████████████████▎    | 838/1014 [00:24<00:05, 34.71batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 34.73batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.69batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.68batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 34.70batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.69batch/s] 86%|███████████████████████    | 868/1014 [00:25<00:04, 34.68batch/s] 86%|███████████████████████▏   | 873/1014 [00:25<00:04, 34.67batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.68batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.69batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 34.68batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.71batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.67batch/s] 89%|████████████████████████   | 903/1014 [00:26<00:03, 34.66batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.66batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.64batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 34.65batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.63batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.59batch/s] 92%|████████████████████████▊  | 933/1014 [00:26<00:02, 34.61batch/s] 93%|████████████████████████▉  | 938/1014 [00:27<00:02, 34.66batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 34.64batch/s] 93%|█████████████████████████▏ | 948/1014 [00:27<00:01, 34.66batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.64batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.67batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 34.66batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 34.70batch/s] 96%|█████████████████████████▉ | 973/1014 [00:28<00:01, 34.73batch/s] 96%|██████████████████████████ | 978/1014 [00:28<00:01, 34.75batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.76batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.78batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 34.78batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 34.80batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 34.80batch/s] 99%|█████████████████████████▊| 1008/1014 [00:28<00:00, 34.81batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.84batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.84batch/s]
Validation 78 -> LOSS = 0.24
Validation 78 -> BLEU = 96.94, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 76
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 79
Epoch 79 - update      37620 => loss:   0.052 (#OOM: 0)
Epoch 79 - update      37650 => loss:   0.027 (#OOM: 0)
Epoch 79 - update      37680 => loss:   0.057 (#OOM: 0)
Epoch 79 - update      37710 => loss:   0.030 (#OOM: 0)
Epoch 79 - update      37740 => loss:   0.046 (#OOM: 0)
Epoch 79 - update      37770 => loss:   0.033 (#OOM: 0)
Epoch 79 - update      37800 => loss:   0.024 (#OOM: 0)
Epoch 79 - update      37830 => loss:   0.033 (#OOM: 0)
Epoch 79 - update      37860 => loss:   0.028 (#OOM: 0)
Epoch 79 - update      37890 => loss:   0.016 (#OOM: 0)
Epoch 79 - update      37920 => loss:   0.040 (#OOM: 0)
Epoch 79 - update      37950 => loss:   0.068 (#OOM: 0)
Epoch 79 - update      37980 => loss:   0.050 (#OOM: 0)
Epoch 79 - update      38010 => loss:   0.080 (#OOM: 0)
Epoch 79 - update      38040 => loss:   0.044 (#OOM: 0)
Epoch 79 - update      38070 => loss:   0.058 (#OOM: 0)
--> Epoch 79 finished with mean loss 0.04917
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.35 mins)   (668 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.77batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.07batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 13.33batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 14.70batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 13.63batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.38batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.18batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.47batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 11.94batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.41batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 12.58batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 12.77batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.08batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:37, 27.29batch/s]  1%|▏                            | 7/1014 [00:00<00:32, 31.17batch/s]  1%|▎                           | 11/1014 [00:00<00:31, 32.30batch/s]  1%|▍                           | 15/1014 [00:00<00:30, 32.70batch/s]  2%|▌                           | 19/1014 [00:00<00:34, 29.13batch/s]  2%|▋                           | 23/1014 [00:00<00:32, 30.34batch/s]  3%|▋                           | 27/1014 [00:00<00:31, 30.85batch/s]  3%|▊                           | 31/1014 [00:00<00:31, 31.05batch/s]  4%|▉                           | 36/1014 [00:01<00:30, 32.38batch/s]  4%|█▏                          | 41/1014 [00:01<00:30, 32.26batch/s]  5%|█▎                          | 46/1014 [00:01<00:29, 32.80batch/s]  5%|█▍                          | 51/1014 [00:01<00:28, 33.25batch/s]  6%|█▌                          | 56/1014 [00:01<00:28, 33.47batch/s]  6%|█▋                          | 61/1014 [00:01<00:28, 33.26batch/s]  7%|█▊                          | 66/1014 [00:01<00:28, 33.62batch/s]  7%|█▉                          | 71/1014 [00:02<00:28, 33.63batch/s]  7%|██                          | 76/1014 [00:02<00:27, 33.77batch/s]  8%|██▏                         | 81/1014 [00:02<00:27, 33.55batch/s]  8%|██▎                         | 86/1014 [00:02<00:27, 33.81batch/s]  9%|██▌                         | 91/1014 [00:02<00:27, 34.16batch/s]  9%|██▋                         | 96/1014 [00:02<00:26, 34.37batch/s] 10%|██▋                        | 101/1014 [00:02<00:26, 34.59batch/s] 10%|██▊                        | 106/1014 [00:03<00:26, 34.17batch/s] 11%|██▉                        | 111/1014 [00:03<00:26, 34.28batch/s] 11%|███                        | 116/1014 [00:03<00:26, 34.39batch/s] 12%|███▏                       | 121/1014 [00:03<00:26, 34.12batch/s] 12%|███▎                       | 126/1014 [00:03<00:26, 34.02batch/s] 13%|███▍                       | 131/1014 [00:03<00:26, 33.94batch/s] 13%|███▌                       | 136/1014 [00:03<00:25, 34.07batch/s] 14%|███▊                       | 141/1014 [00:04<00:25, 34.16batch/s] 14%|███▉                       | 146/1014 [00:04<00:25, 34.36batch/s] 15%|████                       | 151/1014 [00:04<00:25, 34.44batch/s] 15%|████▏                      | 156/1014 [00:04<00:25, 34.30batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 34.42batch/s] 16%|████▍                      | 166/1014 [00:04<00:24, 34.48batch/s] 17%|████▌                      | 171/1014 [00:04<00:24, 34.48batch/s] 17%|████▋                      | 176/1014 [00:05<00:24, 34.40batch/s] 18%|████▊                      | 181/1014 [00:05<00:24, 34.29batch/s] 18%|████▉                      | 186/1014 [00:05<00:24, 34.34batch/s] 19%|█████                      | 191/1014 [00:05<00:24, 34.25batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 34.23batch/s] 20%|█████▎                     | 201/1014 [00:05<00:23, 34.22batch/s] 20%|█████▍                     | 206/1014 [00:06<00:23, 34.32batch/s] 21%|█████▌                     | 211/1014 [00:06<00:23, 34.34batch/s] 21%|█████▊                     | 216/1014 [00:06<00:23, 34.45batch/s] 22%|█████▉                     | 221/1014 [00:06<00:23, 34.33batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 34.27batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 34.35batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.37batch/s] 24%|██████▍                    | 241/1014 [00:07<00:22, 34.24batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.29batch/s] 25%|██████▋                    | 251/1014 [00:07<00:22, 34.33batch/s] 25%|██████▊                    | 256/1014 [00:07<00:22, 34.30batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 34.36batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 34.35batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.31batch/s] 27%|███████▎                   | 276/1014 [00:08<00:21, 34.35batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.22batch/s] 28%|███████▌                   | 286/1014 [00:08<00:21, 34.09batch/s] 29%|███████▋                   | 291/1014 [00:08<00:21, 33.77batch/s] 29%|███████▉                   | 296/1014 [00:08<00:21, 33.67batch/s] 30%|████████                   | 301/1014 [00:08<00:21, 33.45batch/s] 30%|████████▏                  | 306/1014 [00:09<00:21, 33.26batch/s] 31%|████████▎                  | 311/1014 [00:09<00:21, 33.12batch/s] 31%|████████▍                  | 316/1014 [00:09<00:21, 33.03batch/s] 32%|████████▌                  | 321/1014 [00:09<00:20, 33.05batch/s] 32%|████████▋                  | 326/1014 [00:09<00:20, 32.95batch/s] 33%|████████▊                  | 331/1014 [00:10<00:20, 32.91batch/s] 33%|████████▉                  | 336/1014 [00:10<00:20, 32.80batch/s] 34%|█████████                  | 341/1014 [00:10<00:20, 32.75batch/s] 34%|█████████▏                 | 346/1014 [00:10<00:20, 32.64batch/s] 35%|█████████▎                 | 351/1014 [00:10<00:20, 32.59batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:20, 32.53batch/s] 36%|█████████▌                 | 361/1014 [00:11<00:20, 32.55batch/s] 36%|█████████▋                 | 366/1014 [00:11<00:19, 32.44batch/s] 37%|█████████▉                 | 371/1014 [00:11<00:19, 32.36batch/s] 37%|██████████                 | 376/1014 [00:11<00:19, 32.34batch/s] 38%|██████████▏                | 381/1014 [00:11<00:19, 32.36batch/s] 38%|██████████▎                | 386/1014 [00:11<00:19, 32.24batch/s] 39%|██████████▍                | 391/1014 [00:12<00:19, 32.17batch/s] 39%|██████████▌                | 396/1014 [00:12<00:19, 32.13batch/s] 40%|██████████▋                | 401/1014 [00:12<00:19, 32.09batch/s] 40%|██████████▊                | 406/1014 [00:12<00:18, 32.10batch/s] 41%|██████████▉                | 411/1014 [00:12<00:18, 32.11batch/s] 41%|███████████                | 416/1014 [00:12<00:18, 32.15batch/s] 42%|███████████▏               | 421/1014 [00:13<00:18, 32.11batch/s] 42%|███████████▎               | 426/1014 [00:13<00:18, 32.15batch/s] 43%|███████████▍               | 431/1014 [00:13<00:18, 32.12batch/s] 43%|███████████▌               | 436/1014 [00:13<00:17, 32.13batch/s] 43%|███████████▋               | 441/1014 [00:13<00:17, 32.15batch/s] 44%|███████████▉               | 446/1014 [00:13<00:17, 32.14batch/s] 44%|████████████               | 451/1014 [00:14<00:17, 32.19batch/s] 45%|████████████▏              | 456/1014 [00:14<00:17, 32.17batch/s] 45%|████████████▎              | 461/1014 [00:14<00:17, 32.23batch/s] 46%|████████████▍              | 466/1014 [00:14<00:16, 32.29batch/s] 46%|████████████▌              | 471/1014 [00:14<00:16, 32.27batch/s] 47%|████████████▋              | 476/1014 [00:14<00:16, 32.25batch/s] 47%|████████████▊              | 481/1014 [00:14<00:16, 32.32batch/s] 48%|████████████▉              | 486/1014 [00:15<00:16, 32.36batch/s] 48%|█████████████              | 491/1014 [00:15<00:16, 32.35batch/s] 49%|█████████████▏             | 496/1014 [00:15<00:15, 32.39batch/s] 49%|█████████████▎             | 501/1014 [00:15<00:15, 32.47batch/s] 50%|█████████████▍             | 506/1014 [00:15<00:15, 32.49batch/s] 50%|█████████████▌             | 511/1014 [00:15<00:15, 32.52batch/s] 51%|█████████████▋             | 516/1014 [00:15<00:15, 32.53batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:15, 32.60batch/s] 52%|██████████████             | 526/1014 [00:16<00:14, 32.63batch/s] 52%|██████████████▏            | 531/1014 [00:16<00:14, 32.70batch/s] 53%|██████████████▎            | 536/1014 [00:16<00:14, 32.65batch/s] 53%|██████████████▍            | 541/1014 [00:16<00:14, 32.71batch/s] 54%|██████████████▌            | 546/1014 [00:16<00:14, 32.73batch/s] 54%|██████████████▋            | 551/1014 [00:16<00:14, 32.66batch/s] 55%|██████████████▊            | 556/1014 [00:16<00:13, 32.73batch/s] 55%|██████████████▉            | 561/1014 [00:17<00:13, 32.77batch/s] 56%|███████████████            | 566/1014 [00:17<00:13, 32.71batch/s] 56%|███████████████▏           | 571/1014 [00:17<00:13, 32.75batch/s] 57%|███████████████▎           | 576/1014 [00:17<00:13, 32.73batch/s] 57%|███████████████▍           | 581/1014 [00:17<00:13, 32.75batch/s] 58%|███████████████▌           | 586/1014 [00:17<00:13, 32.75batch/s] 58%|███████████████▋           | 591/1014 [00:18<00:12, 32.74batch/s] 59%|███████████████▊           | 596/1014 [00:18<00:12, 32.77batch/s] 59%|████████████████           | 601/1014 [00:18<00:12, 32.84batch/s] 60%|████████████████▏          | 606/1014 [00:18<00:12, 32.89batch/s] 60%|████████████████▎          | 611/1014 [00:18<00:12, 32.95batch/s] 61%|████████████████▍          | 616/1014 [00:18<00:12, 32.95batch/s] 61%|████████████████▌          | 621/1014 [00:18<00:11, 32.95batch/s] 62%|████████████████▋          | 626/1014 [00:18<00:11, 32.95batch/s] 62%|████████████████▊          | 631/1014 [00:19<00:11, 32.93batch/s] 63%|████████████████▉          | 636/1014 [00:19<00:11, 32.88batch/s] 63%|█████████████████          | 641/1014 [00:19<00:11, 32.80batch/s] 64%|█████████████████▏         | 646/1014 [00:19<00:11, 32.81batch/s] 64%|█████████████████▎         | 651/1014 [00:19<00:11, 32.75batch/s] 65%|█████████████████▍         | 656/1014 [00:20<00:10, 32.72batch/s] 65%|█████████████████▌         | 661/1014 [00:20<00:10, 32.69batch/s] 66%|█████████████████▋         | 666/1014 [00:20<00:10, 32.69batch/s] 66%|█████████████████▊         | 671/1014 [00:20<00:10, 32.71batch/s] 67%|██████████████████         | 676/1014 [00:20<00:10, 32.68batch/s] 67%|██████████████████▏        | 681/1014 [00:20<00:10, 32.67batch/s] 68%|██████████████████▎        | 686/1014 [00:20<00:10, 32.69batch/s] 68%|██████████████████▍        | 691/1014 [00:21<00:09, 32.64batch/s] 69%|██████████████████▌        | 696/1014 [00:21<00:09, 32.65batch/s] 69%|██████████████████▋        | 701/1014 [00:21<00:09, 32.62batch/s] 70%|██████████████████▊        | 706/1014 [00:21<00:09, 32.59batch/s] 70%|██████████████████▉        | 711/1014 [00:21<00:09, 32.58batch/s] 71%|███████████████████        | 716/1014 [00:22<00:09, 32.53batch/s] 71%|███████████████████▏       | 721/1014 [00:22<00:09, 32.53batch/s] 72%|███████████████████▎       | 726/1014 [00:22<00:08, 32.49batch/s] 72%|███████████████████▍       | 731/1014 [00:22<00:08, 32.43batch/s] 73%|███████████████████▌       | 736/1014 [00:22<00:08, 32.38batch/s] 73%|███████████████████▋       | 741/1014 [00:22<00:08, 32.33batch/s] 74%|███████████████████▊       | 746/1014 [00:23<00:08, 32.36batch/s] 74%|███████████████████▉       | 751/1014 [00:23<00:08, 32.32batch/s] 75%|████████████████████▏      | 756/1014 [00:23<00:07, 32.35batch/s] 75%|████████████████████▎      | 761/1014 [00:23<00:07, 32.27batch/s] 76%|████████████████████▍      | 766/1014 [00:23<00:07, 32.24batch/s] 76%|████████████████████▌      | 771/1014 [00:23<00:07, 32.25batch/s] 77%|████████████████████▋      | 776/1014 [00:24<00:07, 32.23batch/s] 77%|████████████████████▊      | 781/1014 [00:24<00:07, 32.23batch/s] 78%|████████████████████▉      | 786/1014 [00:24<00:07, 32.25batch/s] 78%|█████████████████████      | 791/1014 [00:24<00:06, 32.22batch/s] 79%|█████████████████████▏     | 796/1014 [00:24<00:06, 32.18batch/s] 79%|█████████████████████▎     | 801/1014 [00:24<00:06, 32.14batch/s] 79%|█████████████████████▍     | 806/1014 [00:25<00:06, 32.17batch/s] 80%|█████████████████████▌     | 811/1014 [00:25<00:06, 32.04batch/s] 80%|█████████████████████▋     | 816/1014 [00:25<00:06, 32.03batch/s] 81%|█████████████████████▊     | 821/1014 [00:25<00:06, 32.02batch/s] 81%|█████████████████████▉     | 826/1014 [00:25<00:05, 31.97batch/s] 82%|██████████████████████▏    | 831/1014 [00:25<00:05, 31.99batch/s] 82%|██████████████████████▎    | 836/1014 [00:26<00:05, 31.97batch/s] 83%|██████████████████████▍    | 841/1014 [00:26<00:05, 31.99batch/s] 83%|██████████████████████▌    | 846/1014 [00:26<00:05, 32.00batch/s] 84%|██████████████████████▋    | 851/1014 [00:26<00:05, 32.04batch/s] 84%|██████████████████████▊    | 856/1014 [00:26<00:04, 32.01batch/s] 85%|██████████████████████▉    | 861/1014 [00:26<00:04, 31.98batch/s] 85%|███████████████████████    | 866/1014 [00:27<00:04, 31.99batch/s] 86%|███████████████████████▏   | 871/1014 [00:27<00:04, 31.97batch/s] 86%|███████████████████████▎   | 876/1014 [00:27<00:04, 31.96batch/s] 87%|███████████████████████▍   | 881/1014 [00:27<00:04, 31.98batch/s] 87%|███████████████████████▌   | 886/1014 [00:27<00:04, 31.96batch/s] 88%|███████████████████████▋   | 891/1014 [00:27<00:03, 31.97batch/s] 88%|███████████████████████▊   | 896/1014 [00:28<00:03, 31.98batch/s] 89%|███████████████████████▉   | 901/1014 [00:28<00:03, 31.93batch/s] 89%|████████████████████████   | 906/1014 [00:28<00:03, 31.95batch/s] 90%|████████████████████████▎  | 911/1014 [00:28<00:03, 31.97batch/s] 90%|████████████████████████▍  | 916/1014 [00:28<00:03, 32.00batch/s] 91%|████████████████████████▌  | 921/1014 [00:28<00:02, 32.00batch/s] 91%|████████████████████████▋  | 926/1014 [00:28<00:02, 32.01batch/s] 92%|████████████████████████▊  | 931/1014 [00:29<00:02, 32.04batch/s] 92%|████████████████████████▉  | 936/1014 [00:29<00:02, 32.03batch/s] 93%|█████████████████████████  | 941/1014 [00:29<00:02, 32.02batch/s] 93%|█████████████████████████▏ | 946/1014 [00:29<00:02, 31.99batch/s] 94%|█████████████████████████▎ | 951/1014 [00:29<00:01, 32.01batch/s] 94%|█████████████████████████▍ | 956/1014 [00:29<00:01, 32.00batch/s] 95%|█████████████████████████▌ | 961/1014 [00:30<00:01, 32.02batch/s] 95%|█████████████████████████▋ | 966/1014 [00:30<00:01, 32.02batch/s] 96%|█████████████████████████▊ | 971/1014 [00:30<00:01, 32.06batch/s] 96%|█████████████████████████▉ | 976/1014 [00:30<00:01, 32.09batch/s] 97%|██████████████████████████ | 981/1014 [00:30<00:01, 32.12batch/s] 97%|██████████████████████████▎| 986/1014 [00:30<00:00, 32.07batch/s] 98%|██████████████████████████▍| 991/1014 [00:30<00:00, 32.08batch/s] 98%|██████████████████████████▌| 996/1014 [00:31<00:00, 32.07batch/s] 99%|█████████████████████████▋| 1001/1014 [00:31<00:00, 32.04batch/s] 99%|█████████████████████████▊| 1006/1014 [00:31<00:00, 32.09batch/s]100%|█████████████████████████▉| 1011/1014 [00:31<00:00, 32.11batch/s]100%|██████████████████████████| 1014/1014 [00:31<00:00, 32.14batch/s]
Validation 79 -> LOSS = 0.24
Validation 79 -> BLEU = 96.94, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 76
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 80
Epoch 80 - update      38100 => loss:   0.049 (#OOM: 0)
Epoch 80 - update      38130 => loss:   0.071 (#OOM: 0)
Epoch 80 - update      38160 => loss:   0.088 (#OOM: 0)
Epoch 80 - update      38190 => loss:   0.037 (#OOM: 0)
Epoch 80 - update      38220 => loss:   0.048 (#OOM: 0)
Epoch 80 - update      38250 => loss:   0.050 (#OOM: 0)
Epoch 80 - update      38280 => loss:   0.028 (#OOM: 0)
Epoch 80 - update      38310 => loss:   0.072 (#OOM: 0)
Epoch 80 - update      38340 => loss:   0.045 (#OOM: 0)
Epoch 80 - update      38370 => loss:   0.052 (#OOM: 0)
Epoch 80 - update      38400 => loss:   0.034 (#OOM: 0)
Epoch 80 - update      38430 => loss:   0.027 (#OOM: 0)
Epoch 80 - update      38460 => loss:   0.037 (#OOM: 0)
Epoch 80 - update      38490 => loss:   0.069 (#OOM: 0)
Epoch 80 - update      38520 => loss:   0.046 (#OOM: 0)
Epoch 80 - update      38550 => loss:   0.024 (#OOM: 0)
--> Epoch 80 finished with mean loss 0.04887
--> Overhead/Training/Evaluation: 0.67/0.73/0.00 mins (total: 1.40 mins)   (664 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 18.50batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 18.61batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 17.20batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.85batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.79batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.14batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.50batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.66batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.17batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.30batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.71batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.89batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.75batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.76batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.78batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.90batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.05batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.04batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 37.99batch/s]  1%|▎                            | 9/1014 [00:00<00:25, 39.29batch/s]  1%|▍                           | 14/1014 [00:00<00:25, 38.90batch/s]  2%|▌                           | 19/1014 [00:00<00:25, 39.77batch/s]  2%|▋                           | 24/1014 [00:00<00:25, 39.12batch/s]  3%|▊                           | 29/1014 [00:00<00:25, 38.42batch/s]  3%|▉                           | 34/1014 [00:00<00:25, 38.35batch/s]  4%|█                           | 39/1014 [00:01<00:25, 38.27batch/s]  4%|█▏                          | 44/1014 [00:01<00:25, 37.50batch/s]  5%|█▎                          | 49/1014 [00:01<00:25, 37.41batch/s]  5%|█▍                          | 54/1014 [00:01<00:25, 37.65batch/s]  6%|█▋                          | 59/1014 [00:01<00:25, 37.58batch/s]  6%|█▊                          | 64/1014 [00:01<00:25, 37.53batch/s]  7%|█▉                          | 69/1014 [00:01<00:25, 36.97batch/s]  7%|██                          | 74/1014 [00:01<00:25, 37.19batch/s]  8%|██▏                         | 79/1014 [00:02<00:25, 36.87batch/s]  8%|██▎                         | 84/1014 [00:02<00:25, 36.40batch/s]  9%|██▍                         | 89/1014 [00:02<00:25, 35.78batch/s]  9%|██▌                         | 94/1014 [00:02<00:25, 35.92batch/s] 10%|██▋                         | 99/1014 [00:02<00:25, 35.90batch/s] 10%|██▊                        | 104/1014 [00:02<00:25, 35.78batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 35.69batch/s] 11%|███                        | 115/1014 [00:03<00:25, 35.95batch/s] 12%|███▏                       | 121/1014 [00:03<00:24, 36.07batch/s] 13%|███▍                       | 127/1014 [00:03<00:24, 35.71batch/s] 13%|███▌                       | 133/1014 [00:03<00:24, 35.78batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 35.63batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.76batch/s] 15%|████                       | 151/1014 [00:04<00:24, 35.85batch/s] 15%|████▏                      | 157/1014 [00:04<00:23, 35.91batch/s] 16%|████▎                      | 163/1014 [00:04<00:23, 35.88batch/s] 17%|████▌                      | 169/1014 [00:04<00:23, 35.86batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.97batch/s] 18%|████▊                      | 181/1014 [00:05<00:23, 35.84batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 35.65batch/s] 19%|█████▏                     | 193/1014 [00:05<00:23, 35.48batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 35.14batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 35.17batch/s] 21%|█████▌                     | 211/1014 [00:05<00:22, 35.30batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 35.16batch/s] 22%|█████▉                     | 223/1014 [00:06<00:22, 35.02batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 35.09batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 35.20batch/s] 24%|██████▍                    | 241/1014 [00:06<00:22, 35.12batch/s] 24%|██████▌                    | 247/1014 [00:07<00:21, 35.12batch/s] 25%|██████▋                    | 253/1014 [00:07<00:21, 35.08batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.21batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.22batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 35.29batch/s] 27%|███████▍                   | 277/1014 [00:07<00:20, 35.33batch/s] 28%|███████▌                   | 283/1014 [00:08<00:20, 35.35batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 35.40batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.42batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 35.29batch/s] 30%|████████▏                  | 307/1014 [00:08<00:20, 35.32batch/s] 31%|████████▎                  | 313/1014 [00:08<00:19, 35.22batch/s] 31%|████████▍                  | 319/1014 [00:09<00:19, 35.04batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.02batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 35.14batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 35.13batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:19, 35.12batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:19, 34.93batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 34.86batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 34.95batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.96batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 34.90batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 34.96batch/s] 38%|██████████▎                | 385/1014 [00:11<00:17, 34.96batch/s] 39%|██████████▍                | 391/1014 [00:11<00:17, 35.02batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 35.02batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 34.94batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.94batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 35.04batch/s] 42%|███████████▏               | 421/1014 [00:12<00:16, 35.01batch/s] 42%|███████████▎               | 427/1014 [00:12<00:16, 35.01batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 35.01batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.07batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.09batch/s] 44%|████████████               | 451/1014 [00:12<00:16, 35.09batch/s] 45%|████████████▏              | 457/1014 [00:13<00:15, 35.13batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 35.19batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.13batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 35.17batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 34.98batch/s] 48%|████████████▉              | 487/1014 [00:13<00:15, 35.08batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:14, 35.03batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.02batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.04batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 35.05batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 35.04batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.07batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 35.04batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.99batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 34.97batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 34.92batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 34.91batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.90batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 34.91batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 34.93batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 34.96batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.03batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.03batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.09batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 35.05batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 35.04batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.03batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.08batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 35.05batch/s] 62%|████████████████▊          | 631/1014 [00:18<00:10, 35.02batch/s] 63%|████████████████▉          | 637/1014 [00:18<00:10, 35.01batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 34.98batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.00batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.94batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:10, 34.97batch/s] 66%|█████████████████▊         | 667/1014 [00:19<00:09, 34.94batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 34.91batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 34.92batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.97batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 34.97batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:09, 34.96batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:08, 34.97batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.01batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.98batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 34.99batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 35.00batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:08, 34.92batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.89batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.88batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 34.87batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 34.84batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 34.82batch/s] 76%|████████████████████▍      | 769/1014 [00:22<00:07, 34.81batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.81batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 34.86batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 34.85batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 34.86batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.86batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:05, 34.86batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 34.88batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 34.89batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 34.91batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 34.90batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 34.91batch/s] 83%|██████████████████████▍    | 841/1014 [00:24<00:04, 34.93batch/s] 84%|██████████████████████▌    | 847/1014 [00:24<00:04, 34.93batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 34.93batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.88batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 34.85batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 34.86batch/s] 86%|███████████████████████▎   | 877/1014 [00:25<00:03, 34.87batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 34.90batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.89batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.91batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 34.93batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 34.94batch/s] 90%|████████████████████████▎  | 913/1014 [00:26<00:02, 34.94batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.95batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.95batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 34.93batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 34.93batch/s] 93%|█████████████████████████  | 943/1014 [00:27<00:02, 34.92batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.88batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.92batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 34.93batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 34.91batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 34.93batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.92batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.92batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 34.94batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 34.92batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 34.94batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 34.95batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.00batch/s]
Validation 80 -> LOSS = 0.24
Validation 80 -> BLEU = 96.94, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
** Learning rate changed -> 3.125e-06
Early stopping patience: 1
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 76
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 81
Epoch 81 - update      38580 => loss:   0.044 (#OOM: 0)
Epoch 81 - update      38610 => loss:   0.038 (#OOM: 0)
Epoch 81 - update      38640 => loss:   0.071 (#OOM: 0)
Epoch 81 - update      38670 => loss:   0.056 (#OOM: 0)
Epoch 81 - update      38700 => loss:   0.046 (#OOM: 0)
Epoch 81 - update      38730 => loss:   0.025 (#OOM: 0)
Epoch 81 - update      38760 => loss:   0.086 (#OOM: 0)
Epoch 81 - update      38790 => loss:   0.056 (#OOM: 0)
Epoch 81 - update      38820 => loss:   0.064 (#OOM: 0)
Epoch 81 - update      38850 => loss:   0.029 (#OOM: 0)
Epoch 81 - update      38880 => loss:   0.039 (#OOM: 0)
Epoch 81 - update      38910 => loss:   0.050 (#OOM: 0)
Epoch 81 - update      38940 => loss:   0.031 (#OOM: 0)
Epoch 81 - update      38970 => loss:   0.070 (#OOM: 0)
Epoch 81 - update      39000 => loss:   0.064 (#OOM: 0)
Epoch 81 - update      39030 => loss:   0.039 (#OOM: 0)
--> Epoch 81 finished with mean loss 0.04871
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.35 mins)   (667 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.93batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.41batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 10.39batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.15batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 10.86batch/s] 35%|██████████▌                   | 12/34 [00:01<00:02, 10.66batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.26batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 11.84batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 11.73batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 11.82batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.12batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.34batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.56batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 12.78batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 12.95batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 12.90batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.20batch/s]
Performing greedy search (args: {'k': 5})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:27, 37.17batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.34batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 34.21batch/s]  2%|▍                           | 16/1014 [00:00<00:29, 33.96batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 33.78batch/s]  2%|▋                           | 24/1014 [00:00<00:29, 33.30batch/s]  3%|▊                           | 28/1014 [00:00<00:29, 33.99batch/s]  3%|▉                           | 32/1014 [00:00<00:28, 34.35batch/s]  4%|▉                           | 36/1014 [00:01<00:29, 33.20batch/s]  4%|█▏                          | 41/1014 [00:01<00:28, 34.05batch/s]  5%|█▎                          | 46/1014 [00:01<00:28, 33.65batch/s]  5%|█▍                          | 51/1014 [00:01<00:28, 33.62batch/s]  6%|█▌                          | 56/1014 [00:01<00:28, 33.55batch/s]  6%|█▋                          | 61/1014 [00:01<00:28, 33.63batch/s]  7%|█▊                          | 66/1014 [00:01<00:27, 33.88batch/s]  7%|█▉                          | 71/1014 [00:02<00:27, 34.09batch/s]  7%|██                          | 76/1014 [00:02<00:27, 34.27batch/s]  8%|██▏                         | 81/1014 [00:02<00:27, 34.49batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 34.68batch/s]  9%|██▌                         | 91/1014 [00:02<00:26, 34.54batch/s]  9%|██▋                         | 96/1014 [00:02<00:26, 34.39batch/s] 10%|██▋                        | 101/1014 [00:02<00:26, 34.62batch/s] 10%|██▊                        | 106/1014 [00:03<00:26, 34.65batch/s] 11%|██▉                        | 111/1014 [00:03<00:26, 34.46batch/s] 11%|███                        | 116/1014 [00:03<00:25, 34.76batch/s] 12%|███▏                       | 121/1014 [00:03<00:25, 34.63batch/s] 12%|███▎                       | 126/1014 [00:03<00:26, 34.15batch/s] 13%|███▍                       | 131/1014 [00:03<00:25, 34.31batch/s] 13%|███▌                       | 136/1014 [00:03<00:25, 34.43batch/s] 14%|███▊                       | 141/1014 [00:04<00:25, 34.64batch/s] 14%|███▉                       | 146/1014 [00:04<00:25, 34.68batch/s] 15%|████                       | 151/1014 [00:04<00:24, 34.67batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 34.46batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 34.65batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.98batch/s] 17%|████▌                      | 173/1014 [00:04<00:23, 35.07batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 35.22batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.39batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 35.47batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 35.45batch/s] 20%|█████▍                     | 203/1014 [00:05<00:22, 35.52batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.48batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.02batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 34.99batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 35.06batch/s] 23%|██████▏                    | 233/1014 [00:06<00:22, 34.89batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.92batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.12batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 35.05batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 35.08batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 35.02batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 35.00batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.94batch/s] 28%|███████▍                   | 281/1014 [00:08<00:20, 34.97batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 34.90batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 34.89batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.09batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 35.12batch/s] 31%|████████▎                  | 311/1014 [00:08<00:20, 35.12batch/s] 31%|████████▍                  | 317/1014 [00:09<00:19, 35.03batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.13batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.03batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.07batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 35.01batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:19, 34.97batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:18, 34.98batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 34.88batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.85batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 34.85batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 34.91batch/s] 38%|██████████▏                | 383/1014 [00:10<00:18, 34.92batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 34.87batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.96batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 34.95batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.99batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 34.69batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.54batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.36batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 34.35batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 34.43batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.44batch/s] 44%|███████████▉               | 449/1014 [00:13<00:16, 34.42batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.43batch/s] 45%|████████████▎              | 461/1014 [00:13<00:16, 34.32batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 34.33batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.37batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.34batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.33batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 34.33batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:15, 34.27batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.34batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.36batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.38batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 34.37batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 34.36batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:14, 34.33batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.34batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.37batch/s] 54%|██████████████▋            | 551/1014 [00:16<00:13, 34.40batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.36batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.24batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.33batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.31batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.33batch/s] 58%|███████████████▋           | 587/1014 [00:17<00:12, 34.34batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.34batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:12, 34.35batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.36batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.44batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.51batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 34.44batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.53batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.55batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.55batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.56batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.51batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 34.49batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.56batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.59batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.62batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.64batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.66batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.67batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.66batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.67batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.66batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.62batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.68batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.62batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:08, 34.58batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.59batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.59batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.58batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.56batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.60batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.60batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.62batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.66batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.63batch/s] 79%|█████████████████████▏     | 797/1014 [00:23<00:06, 34.63batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.65batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.63batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.64batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.67batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.65batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.69batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.72batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.73batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.74batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.74batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.79batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.75batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.77batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.75batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.77batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.75batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.73batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.76batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.74batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.70batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.75batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.79batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.82batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.83batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.85batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.85batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.80batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.81batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 34.86batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.84batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.82batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.82batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.78batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.78batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 34.77batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.78batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.78batch/s]
Validation 81 -> LOSS = 0.24
Validation 81 -> BLEU = 96.94, 98.8/97.5/96.4/95.3 (BP=0.999, ratio=0.999, hyp_len=14374, ref_len=14382)
Early stopping patience: 0
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 76
--> Best BLEU so far: 96.94 @ validation 71
Starting Epoch 82
Early stopped.
--> This is model: simultaneouswaitknmt-r341d4
--> Best LOSS so far: 0.24 @ validation 76
--> Best BLEU so far: 96.94 @ validation 71
Training finished on 25-05-2020 20:25
Mon May 25 20:25:12 2020       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 435.21       Driver Version: 435.21       CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Tesla T4            On   | 00000000:00:09.0 Off |                    0 |
| N/A   49C    P0    28W /  70W |      0MiB / 15109MiB |      3%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
-------
[train]
-------
         num_workers:0
          pin_memory:False
                seed:1590434714
               gclip:1
              l2_reg:1e-05
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
          model_type:SimultaneousWaitKNMT
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:64
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:
                de-bpe
             de-hyphen
     eval_batch_size:32
           eval_freq:0
        eval_max_len:100
          eval_start:1
           eval_zero:False
   save_best_metrics:True
           save_path:/homes/al4616/experiments/simnmt/nmtpy/bpe_models/fr-fr
    save_optim_state:False
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/homes/al4616/experiments/simnmt/nmtpy/bpe_models/fr-fr/tb_dir
     pretrained_file:
   pretrained_layers:
       freeze_layers:
          handle_oom:False
           subfolder:fr-fr-multimodal-w2bpe-wait7
              exp_id:simultaneouswaitknmt-rc59cc
------
[vars]
------
                  sl:en
                  tl:fr
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             enc_dim:320
   enc_bidirectional:False
             dec_dim:320
             emb_dim:200
         dropout_emb:0.4
         dropout_ctx:0.5
         dropout_out:0.5
          n_encoders:2
            tied_emb:2way
             max_len:None
           out_logic:deep
           direction:src:Text, image:Numpy -> trg:Text
        sampler_type:bucket
           bucket_by:src
     translator_args:
                     k:7
         aux_dropout:0.5
        aux_proj_dim:320
      aux_proj_activ:tanh
             aux_dim:2048
       dec_inp_activ:None
        mm_fusion_op:sum
   mm_fusion_dropout:0.0
------
[data]
------
            txt_root:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr
            img_root:/vol/bitbucket/al4616/simmt/data/resnet50-256x256
           train_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.fr
                 image:/vol/bitbucket/al4616/simmt/data/resnet50-256x256/train-resnet50-res5c_relu-r256-c256-l2norm.npy
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.bpe.fr
             val_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.fr
                 image:/vol/bitbucket/al4616/simmt/data/resnet50-256x256/val-resnet50-res5c_relu-r256-c256-l2norm.npy
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/val.lc.norm.tok.bpe.fr
test_2016_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.fr
                 image:/vol/bitbucket/al4616/simmt/data/resnet50-256x256/test_2016_flickr-resnet50-res5c_relu-r256-c256-l2norm.npy
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2016_flickr.lc.norm.tok.bpe.fr
test_2017_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.fr
                 image:/vol/bitbucket/al4616/simmt/data/resnet50-256x256/test_2017_flickr-resnet50-res5c_relu-r256-c256-l2norm.npy
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/test_2017_flickr.lc.norm.tok.bpe.fr
------------
[vocabulary]
------------
                 src:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.vocab.fr
                 trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-fr/train.lc.norm.tok.bpe.vocab.fr
----------------------------------------------------------------------

Python 3.7.7 -- torch 1.4.0 with CUDA 10.1 (on machine 'cloud-vm-40-190.doc.ic.ac.uk')
nmtpytorch 4.1.0
DeviceManager(cuda:0, n_gpu=1)
Seed for further reproducibility: 1590434714
SLURM Job ID: 6622
Loading dataset(s)
Initializing dataset for 'src'...
Dataset src with revert = False
0sents [00:00, ?sents/s]14103sents [00:00, 140991.14sents/s]28206sents [00:00, 140549.77sents/s]29000sents [00:00, 140345.87sents/s]
Initializing dataset for 'image'...
Dataset image with revert = False
Initializing dataset for 'trg'...
Dataset trg with revert = False
0sents [00:00, ?sents/s]13866sents [00:00, 138620.47sents/s]27732sents [00:00, 134683.18sents/s]29000sents [00:00, 134514.14sents/s]
MultimodalDataset - (2 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'train.lc.norm.tok.fr' (29000 sentences)
    --> NumpyDataset 'train-resnet50-res5c_relu-r256-c256-l2norm.npy' (29000 samples)

  Targets:
    --> TextDataset 'train.lc.norm.tok.bpe.fr' (29000 sentences)

Initializing dataset for 'src'...
Dataset src with revert = False
0sents [00:00, ?sents/s]1014sents [00:00, 140684.21sents/s]
Initializing dataset for 'image'...
Dataset image with revert = False
Initializing dataset for 'trg'...
Dataset trg with revert = False
0sents [00:00, ?sents/s]1014sents [00:00, 104999.98sents/s]
MultimodalDataset - (2 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.fr' (1014 sentences)
    --> NumpyDataset 'val-resnet50-res5c_relu-r256-c256-l2norm.npy' (1014 samples)

  Targets:
    --> TextDataset 'val.lc.norm.tok.bpe.fr' (1014 sentences)

Initializing dataset for 'src'...
Dataset src with revert = False
0sents [00:00, ?sents/s]1014sents [00:00, 16772.98sents/s]
Initializing dataset for 'image'...
Dataset image with revert = False
Skipping 'trg' as target
MultimodalDataset - (2 source(s) / 0 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.fr' (1014 sentences)
    --> NumpyDataset 'val-resnet50-res5c_relu-r256-c256-l2norm.npy' (1014 samples)


Ignoring batch_size 32 for simultaneous greedy search
SimultaneousWaitKNMT(
  (encoders): ModuleDict(
    (image): VisualFeaturesEncoder(
      (output): Sequential(
        (0): FF(in_features=2048, out_features=320, activ=tanh, bias=True, bias_zero=True)
        (1): Dropout(p=0.5, inplace=False)
      )
    )
    (src): TextEncoder(
      (do_emb): Dropout(p=0.4, inplace=False)
      (emb): Embedding(11048, 200, padding_idx=0)
      (enc): GRU(200, 320, num_layers=2)
      (output): Sequential(
        (0): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (dec): SimultaneousConditionalDecoder(
    (emb): Embedding(5874, 200, padding_idx=0)
    (att): ModuleDict(
      (image): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
      (src): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
    )
    (fusion): Sequential(
      (0): Fusion(type=sum, adaptor=<function Fusion.__init__.<locals>.<lambda> at 0x7f8fdd4805f0>, activ=None)
    )
    (dec0): GRUCell(200, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.5, inplace=False)
    (hid2out): FF(in_features=840, out_features=200, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=200, out_features=5874, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss()
  )
)
Vocabulary of 11048 items ('train.lc.norm.tok.vocab.fr')
Vocabulary of 5874 items ('train.lc.norm.tok.bpe.vocab.fr')
# parameters: 7.06M (7.06M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 1e-05, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Training started on 25-05-2020 20:25:26
Starting Epoch 1
Epoch 1 - update         30 => loss:   6.269 (#OOM: 0)
Epoch 1 - update         60 => loss:   5.532 (#OOM: 0)
Epoch 1 - update         90 => loss:   6.147 (#OOM: 0)
Epoch 1 - update        120 => loss:   4.660 (#OOM: 0)
Epoch 1 - update        150 => loss:   4.379 (#OOM: 0)
Epoch 1 - update        180 => loss:   4.534 (#OOM: 0)
Epoch 1 - update        210 => loss:   4.230 (#OOM: 0)
Epoch 1 - update        240 => loss:   3.729 (#OOM: 0)
Epoch 1 - update        270 => loss:   3.576 (#OOM: 0)
Epoch 1 - update        300 => loss:   3.924 (#OOM: 0)
Epoch 1 - update        330 => loss:   3.362 (#OOM: 0)
Epoch 1 - update        360 => loss:   3.249 (#OOM: 0)
Epoch 1 - update        390 => loss:   3.618 (#OOM: 0)
Epoch 1 - update        420 => loss:   3.027 (#OOM: 0)
Epoch 1 - update        450 => loss:   3.351 (#OOM: 0)
Epoch 1 - update        480 => loss:   3.023 (#OOM: 0)
--> Epoch 1 finished with mean loss 4.36173
--> Overhead/Training/Evaluation: 0.59/0.70/0.00 mins (total: 1.29 mins)   (688 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.93batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.97batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 13.72batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.05batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.41batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.14batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.60batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.30batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.56batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.69batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.31batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.78batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.19batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.75batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.23batch/s]  1%|▎                           | 13/1014 [00:00<00:28, 34.87batch/s]  2%|▍                           | 18/1014 [00:00<00:28, 35.46batch/s]  2%|▋                           | 23/1014 [00:00<00:26, 37.31batch/s]  3%|▊                           | 28/1014 [00:00<00:26, 37.05batch/s]  3%|▉                           | 33/1014 [00:00<00:25, 37.92batch/s]  4%|█                           | 38/1014 [00:01<00:26, 37.53batch/s]  4%|█▏                          | 43/1014 [00:01<00:25, 37.88batch/s]  5%|█▎                          | 48/1014 [00:01<00:25, 37.68batch/s]  5%|█▍                          | 53/1014 [00:01<00:25, 37.58batch/s]  6%|█▌                          | 58/1014 [00:01<00:25, 37.60batch/s]  6%|█▋                          | 63/1014 [00:01<00:25, 38.02batch/s]  7%|█▉                          | 68/1014 [00:01<00:24, 38.19batch/s]  7%|██                          | 73/1014 [00:01<00:24, 37.66batch/s]  8%|██▏                         | 78/1014 [00:02<00:24, 38.03batch/s]  8%|██▎                         | 83/1014 [00:02<00:24, 38.35batch/s]  9%|██▍                         | 88/1014 [00:02<00:24, 38.52batch/s]  9%|██▌                         | 93/1014 [00:02<00:23, 38.74batch/s] 10%|██▋                         | 98/1014 [00:02<00:23, 38.38batch/s] 10%|██▋                        | 103/1014 [00:02<00:23, 38.47batch/s] 11%|██▉                        | 108/1014 [00:02<00:23, 38.32batch/s] 11%|███                        | 113/1014 [00:02<00:23, 38.18batch/s] 12%|███▏                       | 118/1014 [00:03<00:23, 38.08batch/s] 12%|███▎                       | 123/1014 [00:03<00:23, 38.12batch/s] 13%|███▍                       | 128/1014 [00:03<00:23, 37.96batch/s] 13%|███▌                       | 133/1014 [00:03<00:23, 37.73batch/s] 14%|███▋                       | 138/1014 [00:03<00:23, 37.82batch/s] 14%|███▊                       | 143/1014 [00:03<00:23, 37.84batch/s] 15%|███▉                       | 148/1014 [00:03<00:22, 37.86batch/s] 15%|████                       | 153/1014 [00:04<00:22, 37.90batch/s] 16%|████▏                      | 158/1014 [00:04<00:22, 37.85batch/s] 16%|████▎                      | 163/1014 [00:04<00:22, 37.80batch/s] 17%|████▍                      | 168/1014 [00:04<00:22, 37.89batch/s] 17%|████▌                      | 173/1014 [00:04<00:22, 38.07batch/s] 18%|████▋                      | 178/1014 [00:04<00:22, 37.90batch/s] 18%|████▊                      | 183/1014 [00:04<00:21, 37.93batch/s] 19%|█████                      | 188/1014 [00:04<00:21, 38.02batch/s] 19%|█████▏                     | 193/1014 [00:05<00:21, 38.12batch/s] 20%|█████▎                     | 198/1014 [00:05<00:21, 38.02batch/s] 20%|█████▍                     | 203/1014 [00:05<00:21, 38.15batch/s] 21%|█████▌                     | 208/1014 [00:05<00:21, 38.13batch/s] 21%|█████▋                     | 213/1014 [00:05<00:21, 38.12batch/s] 21%|█████▊                     | 218/1014 [00:05<00:20, 38.15batch/s] 22%|█████▉                     | 223/1014 [00:05<00:20, 38.04batch/s] 22%|██████                     | 228/1014 [00:05<00:20, 38.01batch/s] 23%|██████▏                    | 233/1014 [00:06<00:20, 37.94batch/s] 23%|██████▎                    | 238/1014 [00:06<00:20, 37.90batch/s] 24%|██████▍                    | 243/1014 [00:06<00:20, 38.06batch/s] 24%|██████▌                    | 248/1014 [00:06<00:20, 38.03batch/s] 25%|██████▋                    | 253/1014 [00:06<00:20, 37.94batch/s] 25%|██████▊                    | 258/1014 [00:06<00:19, 37.81batch/s] 26%|███████                    | 263/1014 [00:06<00:19, 37.92batch/s] 26%|███████▏                   | 268/1014 [00:07<00:19, 37.95batch/s] 27%|███████▎                   | 273/1014 [00:07<00:19, 38.00batch/s] 27%|███████▍                   | 278/1014 [00:07<00:19, 38.03batch/s] 28%|███████▌                   | 283/1014 [00:07<00:19, 38.08batch/s] 28%|███████▋                   | 288/1014 [00:07<00:19, 38.16batch/s] 29%|███████▊                   | 293/1014 [00:07<00:19, 37.93batch/s] 29%|███████▉                   | 298/1014 [00:07<00:18, 37.90batch/s] 30%|████████                   | 303/1014 [00:07<00:18, 37.89batch/s] 30%|████████▏                  | 308/1014 [00:08<00:18, 37.88batch/s] 31%|████████▎                  | 313/1014 [00:08<00:18, 37.79batch/s] 31%|████████▍                  | 318/1014 [00:08<00:18, 37.88batch/s] 32%|████████▌                  | 323/1014 [00:08<00:18, 37.91batch/s] 32%|████████▋                  | 328/1014 [00:08<00:18, 38.01batch/s] 33%|████████▊                  | 333/1014 [00:08<00:17, 38.05batch/s] 33%|█████████                  | 338/1014 [00:08<00:17, 37.99batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:17, 37.91batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:17, 37.96batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:17, 38.05batch/s] 35%|█████████▌                 | 358/1014 [00:09<00:17, 37.94batch/s] 36%|█████████▋                 | 363/1014 [00:09<00:17, 37.98batch/s] 36%|█████████▊                 | 368/1014 [00:09<00:17, 37.87batch/s] 37%|█████████▉                 | 373/1014 [00:09<00:16, 37.88batch/s] 37%|██████████                 | 378/1014 [00:09<00:16, 37.97batch/s] 38%|██████████▏                | 383/1014 [00:10<00:16, 37.79batch/s] 38%|██████████▎                | 388/1014 [00:10<00:16, 37.72batch/s] 39%|██████████▍                | 393/1014 [00:10<00:16, 37.70batch/s] 39%|██████████▌                | 398/1014 [00:10<00:16, 37.66batch/s] 40%|██████████▋                | 403/1014 [00:10<00:16, 37.58batch/s] 40%|██████████▊                | 408/1014 [00:10<00:16, 37.46batch/s] 41%|██████████▉                | 413/1014 [00:11<00:16, 37.49batch/s] 41%|███████████▏               | 418/1014 [00:11<00:15, 37.53batch/s] 42%|███████████▎               | 423/1014 [00:11<00:15, 37.47batch/s] 42%|███████████▍               | 428/1014 [00:11<00:15, 37.44batch/s] 43%|███████████▌               | 433/1014 [00:11<00:15, 37.47batch/s] 43%|███████████▋               | 438/1014 [00:11<00:15, 37.48batch/s] 44%|███████████▊               | 443/1014 [00:11<00:15, 37.38batch/s] 44%|███████████▉               | 448/1014 [00:12<00:15, 36.98batch/s] 45%|████████████               | 453/1014 [00:12<00:15, 37.06batch/s] 45%|████████████▏              | 458/1014 [00:12<00:14, 37.07batch/s] 46%|████████████▎              | 463/1014 [00:12<00:14, 37.06batch/s] 46%|████████████▍              | 468/1014 [00:12<00:14, 37.06batch/s] 47%|████████████▌              | 473/1014 [00:12<00:14, 37.13batch/s] 47%|████████████▋              | 478/1014 [00:12<00:14, 37.07batch/s] 48%|████████████▊              | 483/1014 [00:13<00:14, 37.00batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 37.07batch/s] 49%|█████████████▏             | 493/1014 [00:13<00:14, 37.09batch/s] 49%|█████████████▎             | 498/1014 [00:13<00:13, 37.11batch/s] 50%|█████████████▍             | 503/1014 [00:13<00:13, 37.11batch/s] 50%|█████████████▌             | 508/1014 [00:13<00:13, 37.14batch/s] 51%|█████████████▋             | 513/1014 [00:13<00:13, 37.20batch/s] 51%|█████████████▊             | 518/1014 [00:13<00:13, 37.14batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 37.08batch/s] 52%|██████████████             | 528/1014 [00:14<00:13, 37.06batch/s] 53%|██████████████▏            | 533/1014 [00:14<00:12, 37.05batch/s] 53%|██████████████▎            | 538/1014 [00:14<00:12, 37.01batch/s] 54%|██████████████▍            | 543/1014 [00:14<00:12, 37.06batch/s] 54%|██████████████▌            | 548/1014 [00:14<00:12, 37.06batch/s] 55%|██████████████▋            | 553/1014 [00:14<00:12, 37.07batch/s] 55%|██████████████▊            | 558/1014 [00:15<00:12, 37.08batch/s] 56%|██████████████▉            | 563/1014 [00:15<00:12, 37.00batch/s] 56%|███████████████            | 568/1014 [00:15<00:12, 37.02batch/s] 57%|███████████████▎           | 573/1014 [00:15<00:11, 37.04batch/s] 57%|███████████████▍           | 578/1014 [00:15<00:11, 37.05batch/s] 57%|███████████████▌           | 583/1014 [00:15<00:11, 36.97batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:11, 36.68batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 36.67batch/s] 59%|███████████████▉           | 598/1014 [00:16<00:11, 36.64batch/s] 59%|████████████████           | 603/1014 [00:16<00:11, 36.62batch/s] 60%|████████████████▏          | 608/1014 [00:16<00:11, 36.68batch/s] 60%|████████████████▎          | 613/1014 [00:16<00:10, 36.74batch/s] 61%|████████████████▍          | 618/1014 [00:16<00:10, 36.75batch/s] 61%|████████████████▌          | 623/1014 [00:16<00:10, 36.76batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:10, 36.72batch/s] 62%|████████████████▊          | 633/1014 [00:17<00:10, 36.69batch/s] 63%|████████████████▉          | 638/1014 [00:17<00:10, 36.73batch/s] 63%|█████████████████          | 643/1014 [00:17<00:10, 36.72batch/s] 64%|█████████████████▎         | 648/1014 [00:17<00:09, 36.74batch/s] 64%|█████████████████▍         | 653/1014 [00:17<00:09, 36.75batch/s] 65%|█████████████████▌         | 658/1014 [00:17<00:09, 36.75batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:09, 36.76batch/s] 66%|█████████████████▊         | 668/1014 [00:18<00:09, 36.76batch/s] 66%|█████████████████▉         | 673/1014 [00:18<00:09, 36.80batch/s] 67%|██████████████████         | 678/1014 [00:18<00:09, 36.84batch/s] 67%|██████████████████▏        | 683/1014 [00:18<00:08, 36.87batch/s] 68%|██████████████████▎        | 688/1014 [00:18<00:08, 36.88batch/s] 68%|██████████████████▍        | 693/1014 [00:18<00:08, 36.91batch/s] 69%|██████████████████▌        | 698/1014 [00:18<00:08, 36.94batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 36.99batch/s] 70%|██████████████████▊        | 708/1014 [00:19<00:08, 37.02batch/s] 70%|██████████████████▉        | 713/1014 [00:19<00:08, 37.03batch/s] 71%|███████████████████        | 718/1014 [00:19<00:07, 37.04batch/s] 71%|███████████████████▎       | 723/1014 [00:19<00:07, 37.09batch/s] 72%|███████████████████▍       | 728/1014 [00:19<00:07, 37.12batch/s] 72%|███████████████████▌       | 733/1014 [00:19<00:07, 37.08batch/s] 73%|███████████████████▋       | 738/1014 [00:19<00:07, 37.09batch/s] 73%|███████████████████▊       | 743/1014 [00:20<00:07, 37.13batch/s] 74%|███████████████████▉       | 748/1014 [00:20<00:07, 37.13batch/s] 74%|████████████████████       | 753/1014 [00:20<00:07, 37.16batch/s] 75%|████████████████████▏      | 758/1014 [00:20<00:06, 37.12batch/s] 75%|████████████████████▎      | 763/1014 [00:20<00:06, 37.07batch/s] 76%|████████████████████▍      | 768/1014 [00:20<00:06, 37.10batch/s] 76%|████████████████████▌      | 773/1014 [00:20<00:06, 37.09batch/s] 77%|████████████████████▋      | 778/1014 [00:20<00:06, 37.11batch/s] 77%|████████████████████▊      | 783/1014 [00:21<00:06, 37.09batch/s] 78%|████████████████████▉      | 788/1014 [00:21<00:06, 37.06batch/s] 78%|█████████████████████      | 793/1014 [00:21<00:05, 37.09batch/s] 79%|█████████████████████▏     | 798/1014 [00:21<00:05, 37.10batch/s] 79%|█████████████████████▍     | 803/1014 [00:21<00:05, 37.09batch/s] 80%|█████████████████████▌     | 808/1014 [00:21<00:05, 37.08batch/s] 80%|█████████████████████▋     | 813/1014 [00:21<00:05, 37.08batch/s] 81%|█████████████████████▊     | 818/1014 [00:22<00:05, 37.08batch/s] 81%|█████████████████████▉     | 823/1014 [00:22<00:05, 37.09batch/s] 82%|██████████████████████     | 828/1014 [00:22<00:05, 37.09batch/s] 82%|██████████████████████▏    | 833/1014 [00:22<00:04, 37.08batch/s] 83%|██████████████████████▎    | 838/1014 [00:22<00:04, 37.09batch/s] 83%|██████████████████████▍    | 843/1014 [00:22<00:04, 37.11batch/s] 84%|██████████████████████▌    | 848/1014 [00:22<00:04, 37.11batch/s] 84%|██████████████████████▋    | 853/1014 [00:22<00:04, 37.12batch/s] 85%|██████████████████████▊    | 858/1014 [00:23<00:04, 37.12batch/s] 85%|██████████████████████▉    | 863/1014 [00:23<00:04, 37.10batch/s] 86%|███████████████████████    | 868/1014 [00:23<00:03, 37.12batch/s] 86%|███████████████████████▎   | 874/1014 [00:23<00:03, 37.19batch/s] 87%|███████████████████████▍   | 880/1014 [00:23<00:03, 37.14batch/s] 87%|███████████████████████▌   | 886/1014 [00:23<00:03, 37.15batch/s] 88%|███████████████████████▊   | 892/1014 [00:24<00:03, 37.16batch/s] 89%|███████████████████████▉   | 898/1014 [00:24<00:03, 37.19batch/s] 89%|████████████████████████   | 904/1014 [00:24<00:02, 37.23batch/s] 90%|████████████████████████▏  | 910/1014 [00:24<00:02, 37.23batch/s] 90%|████████████████████████▍  | 916/1014 [00:24<00:02, 37.24batch/s] 91%|████████████████████████▌  | 922/1014 [00:24<00:02, 37.23batch/s] 92%|████████████████████████▋  | 928/1014 [00:24<00:02, 37.24batch/s] 92%|████████████████████████▊  | 934/1014 [00:25<00:02, 37.24batch/s] 93%|█████████████████████████  | 940/1014 [00:25<00:01, 37.25batch/s] 93%|█████████████████████████▏ | 946/1014 [00:25<00:01, 37.27batch/s] 94%|█████████████████████████▎ | 952/1014 [00:25<00:01, 37.27batch/s] 94%|█████████████████████████▌ | 958/1014 [00:25<00:01, 37.29batch/s] 95%|█████████████████████████▋ | 964/1014 [00:25<00:01, 37.26batch/s] 96%|█████████████████████████▊ | 970/1014 [00:26<00:01, 37.28batch/s] 96%|█████████████████████████▉ | 976/1014 [00:26<00:01, 37.29batch/s] 97%|██████████████████████████▏| 982/1014 [00:26<00:00, 37.31batch/s] 97%|██████████████████████████▎| 988/1014 [00:26<00:00, 37.30batch/s] 98%|██████████████████████████▍| 994/1014 [00:26<00:00, 37.30batch/s] 99%|█████████████████████████▋| 1000/1014 [00:26<00:00, 37.29batch/s] 99%|█████████████████████████▊| 1006/1014 [00:26<00:00, 37.31batch/s]100%|█████████████████████████▉| 1012/1014 [00:27<00:00, 37.30batch/s]100%|██████████████████████████| 1014/1014 [00:27<00:00, 37.28batch/s]
Validation 1 -> LOSS = 2.80
Validation 1 -> BLEU = 25.35, 66.9/36.0/19.7/11.4 (BP=0.936, ratio=0.938, hyp_len=13485, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 2.80 @ validation 1
--> Best BLEU so far: 25.35 @ validation 1
Starting Epoch 2
Epoch 2 - update        510 => loss:   2.562 (#OOM: 0)
Epoch 2 - update        540 => loss:   2.585 (#OOM: 0)
Epoch 2 - update        570 => loss:   3.249 (#OOM: 0)
Epoch 2 - update        600 => loss:   2.873 (#OOM: 0)
Epoch 2 - update        630 => loss:   3.014 (#OOM: 0)
Epoch 2 - update        660 => loss:   3.014 (#OOM: 0)
Epoch 2 - update        690 => loss:   2.647 (#OOM: 0)
Epoch 2 - update        720 => loss:   2.624 (#OOM: 0)
Epoch 2 - update        750 => loss:   2.392 (#OOM: 0)
Epoch 2 - update        780 => loss:   2.553 (#OOM: 0)
Epoch 2 - update        810 => loss:   2.699 (#OOM: 0)
Epoch 2 - update        840 => loss:   2.165 (#OOM: 0)
Epoch 2 - update        870 => loss:   2.224 (#OOM: 0)
Epoch 2 - update        900 => loss:   2.132 (#OOM: 0)
Epoch 2 - update        930 => loss:   1.903 (#OOM: 0)
Epoch 2 - update        960 => loss:   2.692 (#OOM: 0)
--> Epoch 2 finished with mean loss 2.58985
--> Overhead/Training/Evaluation: 0.60/0.70/0.00 mins (total: 1.30 mins)   (689 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.40batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.37batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 10.67batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.09batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 11.58batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 13.10batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.60batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 14.60batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.97batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.60batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.85batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 14.46batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 14.38batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.27batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:32, 31.54batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.11batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 34.37batch/s]  2%|▍                           | 16/1014 [00:00<00:29, 33.85batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 34.31batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 35.20batch/s]  3%|▊                           | 31/1014 [00:00<00:26, 36.78batch/s]  4%|█                           | 37/1014 [00:01<00:30, 32.53batch/s]  4%|█▏                          | 43/1014 [00:01<00:28, 34.08batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 34.83batch/s]  5%|█▌                          | 55/1014 [00:01<00:27, 34.92batch/s]  6%|█▋                          | 61/1014 [00:01<00:27, 34.83batch/s]  7%|█▊                          | 67/1014 [00:01<00:26, 35.19batch/s]  7%|██                          | 73/1014 [00:02<00:26, 35.45batch/s]  8%|██▏                         | 79/1014 [00:02<00:26, 35.38batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 35.89batch/s]  9%|██▌                         | 91/1014 [00:02<00:25, 36.25batch/s] 10%|██▋                         | 97/1014 [00:02<00:25, 35.85batch/s] 10%|██▋                        | 103/1014 [00:02<00:25, 35.59batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 36.06batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.27batch/s] 12%|███▏                       | 121/1014 [00:03<00:24, 36.42batch/s] 13%|███▍                       | 127/1014 [00:03<00:24, 36.54batch/s] 13%|███▌                       | 133/1014 [00:03<00:25, 35.06batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 35.40batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.08batch/s] 15%|████                       | 151/1014 [00:04<00:25, 34.00batch/s] 15%|████▏                      | 157/1014 [00:04<00:25, 34.26batch/s] 16%|████▎                      | 163/1014 [00:04<00:24, 34.48batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.33batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.29batch/s] 18%|████▊                      | 181/1014 [00:05<00:24, 34.44batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 34.49batch/s] 19%|█████▏                     | 193/1014 [00:05<00:23, 34.40batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.58batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.86batch/s] 21%|█████▌                     | 211/1014 [00:06<00:23, 34.91batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 34.89batch/s] 22%|█████▉                     | 223/1014 [00:06<00:22, 34.85batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.94batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.41batch/s] 24%|██████▍                    | 241/1014 [00:06<00:22, 34.57batch/s] 24%|██████▌                    | 247/1014 [00:07<00:22, 34.63batch/s] 25%|██████▋                    | 253/1014 [00:07<00:21, 34.68batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.67batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.53batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.24batch/s] 27%|███████▍                   | 277/1014 [00:08<00:21, 34.21batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 34.19batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.33batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.33batch/s] 30%|████████                   | 301/1014 [00:08<00:21, 33.89batch/s] 30%|████████▏                  | 307/1014 [00:09<00:20, 33.96batch/s] 31%|████████▎                  | 313/1014 [00:09<00:20, 34.12batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.21batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 34.28batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 34.17batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 34.19batch/s] 34%|█████████▏                 | 343/1014 [00:10<00:19, 34.20batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.27batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.35batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 34.42batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 34.52batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 34.65batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 34.70batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.63batch/s] 39%|██████████▍                | 391/1014 [00:11<00:17, 34.64batch/s] 39%|██████████▌                | 397/1014 [00:11<00:17, 34.72batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 34.79batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.87batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 34.83batch/s] 42%|███████████▏               | 421/1014 [00:12<00:17, 34.86batch/s] 42%|███████████▎               | 427/1014 [00:12<00:17, 34.50batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 34.62batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.60batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.64batch/s] 44%|████████████               | 451/1014 [00:13<00:16, 34.65batch/s] 45%|████████████▏              | 457/1014 [00:13<00:16, 34.64batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 34.69batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.66batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.65batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 34.75batch/s] 48%|████████████▉              | 487/1014 [00:14<00:15, 34.78batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:14, 34.84batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.95batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.02batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 35.05batch/s] 51%|█████████████▊             | 517/1014 [00:14<00:14, 35.13batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.17batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 35.23batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 35.24batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 35.29batch/s] 54%|██████████████▌            | 547/1014 [00:15<00:13, 35.21batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 35.24batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.24batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 35.29batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 35.27batch/s] 57%|███████████████▎           | 577/1014 [00:16<00:12, 35.29batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.25batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.30batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.31batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 35.31batch/s] 60%|████████████████▏          | 607/1014 [00:17<00:11, 35.33batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.34batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.32batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:10, 35.40batch/s] 62%|████████████████▊          | 631/1014 [00:17<00:10, 35.40batch/s] 63%|████████████████▉          | 637/1014 [00:17<00:10, 35.44batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.49batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.54batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.50batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:10, 35.21batch/s] 66%|█████████████████▊         | 667/1014 [00:18<00:09, 35.22batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.25batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.28batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.29batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 35.28batch/s] 69%|██████████████████▌        | 697/1014 [00:19<00:08, 35.26batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 35.32batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.32batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.37batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 35.39batch/s] 72%|███████████████████▎       | 727/1014 [00:20<00:08, 35.44batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:07, 35.44batch/s] 73%|███████████████████▋       | 739/1014 [00:20<00:07, 35.52batch/s] 73%|███████████████████▊       | 745/1014 [00:20<00:07, 35.54batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 35.56batch/s] 75%|████████████████████▏      | 757/1014 [00:21<00:07, 35.54batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.59batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.60batch/s] 76%|████████████████████▋      | 775/1014 [00:21<00:06, 35.62batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.45batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.48batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.52batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.51batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.50batch/s] 80%|█████████████████████▌     | 811/1014 [00:22<00:05, 35.54batch/s] 81%|█████████████████████▊     | 817/1014 [00:22<00:05, 35.60batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.64batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.68batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.69batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.73batch/s] 84%|██████████████████████▌    | 847/1014 [00:23<00:04, 35.77batch/s] 84%|██████████████████████▋    | 853/1014 [00:23<00:04, 35.84batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.69batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.63batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.64batch/s] 86%|███████████████████████▎   | 877/1014 [00:24<00:03, 35.68batch/s] 87%|███████████████████████▌   | 883/1014 [00:24<00:03, 35.52batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.55batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.53batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.55batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 35.52batch/s] 90%|████████████████████████▎  | 913/1014 [00:25<00:02, 35.57batch/s] 91%|████████████████████████▍  | 919/1014 [00:25<00:02, 35.57batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.56batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.55batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.56batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:01, 35.51batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.53batch/s] 94%|█████████████████████████▍ | 955/1014 [00:26<00:01, 35.58batch/s] 95%|█████████████████████████▌ | 961/1014 [00:26<00:01, 35.60batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.57batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.61batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.62batch/s] 97%|██████████████████████████▏| 985/1014 [00:27<00:00, 35.63batch/s] 98%|██████████████████████████▍| 991/1014 [00:27<00:00, 35.61batch/s] 98%|██████████████████████████▌| 997/1014 [00:27<00:00, 35.65batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.65batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.66batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.65batch/s]
Validation 2 -> LOSS = 1.74
Validation 2 -> BLEU = 51.92, 76.8/58.0/45.5/35.8 (BP=1.000, ratio=1.029, hyp_len=14803, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 1.74 @ validation 2
--> Best BLEU so far: 51.92 @ validation 2
Starting Epoch 3
Epoch 3 - update        990 => loss:   1.909 (#OOM: 0)
Epoch 3 - update       1020 => loss:   1.916 (#OOM: 0)
Epoch 3 - update       1050 => loss:   1.826 (#OOM: 0)
Epoch 3 - update       1080 => loss:   1.813 (#OOM: 0)
Epoch 3 - update       1110 => loss:   1.925 (#OOM: 0)
Epoch 3 - update       1140 => loss:   1.965 (#OOM: 0)
Epoch 3 - update       1170 => loss:   1.683 (#OOM: 0)
Epoch 3 - update       1200 => loss:   1.616 (#OOM: 0)
Epoch 3 - update       1230 => loss:   1.880 (#OOM: 0)
Epoch 3 - update       1260 => loss:   1.520 (#OOM: 0)
Epoch 3 - update       1290 => loss:   1.709 (#OOM: 0)
Epoch 3 - update       1320 => loss:   1.548 (#OOM: 0)
Epoch 3 - update       1350 => loss:   1.695 (#OOM: 0)
Epoch 3 - update       1380 => loss:   1.556 (#OOM: 0)
Epoch 3 - update       1410 => loss:   1.296 (#OOM: 0)
Epoch 3 - update       1440 => loss:   1.427 (#OOM: 0)
--> Epoch 3 finished with mean loss 1.77916
--> Overhead/Training/Evaluation: 0.64/0.71/0.00 mins (total: 1.36 mins)   (678 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.54batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 12.79batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.07batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 11.80batch/s] 26%|████████▏                      | 9/34 [00:00<00:02, 12.19batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.59batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 11.81batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.79batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.87batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.82batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.41batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.45batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.20batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.75batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.75batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:25, 39.86batch/s]  1%|▎                           | 10/1014 [00:00<00:27, 36.14batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 36.52batch/s]  2%|▌                           | 20/1014 [00:00<00:26, 36.99batch/s]  2%|▋                           | 25/1014 [00:00<00:25, 38.28batch/s]  3%|▊                           | 30/1014 [00:00<00:25, 38.58batch/s]  3%|▉                           | 35/1014 [00:00<00:25, 38.04batch/s]  4%|█                           | 40/1014 [00:01<00:26, 37.39batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 36.85batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.10batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 35.99batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 35.64batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 35.66batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.56batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.69batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.32batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 35.83batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 36.07batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 36.23batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 36.35batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 36.41batch/s] 11%|██▉                        | 110/1014 [00:03<00:24, 36.46batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.73batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 36.52batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 36.46batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 36.41batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 36.39batch/s] 14%|███▋                       | 140/1014 [00:03<00:23, 36.49batch/s] 14%|███▊                       | 145/1014 [00:03<00:23, 36.46batch/s] 15%|███▉                       | 150/1014 [00:04<00:23, 36.43batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 36.36batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 36.25batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 36.31batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 36.32batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 36.36batch/s] 18%|████▊                      | 180/1014 [00:04<00:22, 36.30batch/s] 18%|████▉                      | 185/1014 [00:05<00:22, 36.40batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 36.44batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 36.45batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 36.46batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 36.54batch/s] 21%|█████▌                     | 210/1014 [00:05<00:21, 36.60batch/s] 21%|█████▋                     | 215/1014 [00:05<00:21, 36.58batch/s] 22%|█████▊                     | 220/1014 [00:06<00:21, 36.53batch/s] 22%|█████▉                     | 225/1014 [00:06<00:21, 36.58batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 36.51batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 35.86batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.76batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.61batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.67batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.77batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.71batch/s] 26%|███████                    | 265/1014 [00:07<00:20, 35.84batch/s] 27%|███████▏                   | 270/1014 [00:07<00:20, 35.84batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.79batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.77batch/s] 28%|███████▌                   | 285/1014 [00:07<00:20, 35.82batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.81batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.91batch/s] 30%|███████▉                   | 300/1014 [00:08<00:19, 35.93batch/s] 30%|████████                   | 305/1014 [00:08<00:19, 36.05batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 36.07batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 36.00batch/s] 32%|████████▌                  | 320/1014 [00:08<00:19, 36.06batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 36.09batch/s] 33%|████████▊                  | 330/1014 [00:09<00:18, 36.16batch/s] 33%|████████▉                  | 335/1014 [00:09<00:18, 36.19batch/s] 34%|█████████                  | 340/1014 [00:09<00:18, 36.21batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:18, 36.25batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 36.29batch/s] 35%|█████████▍                 | 355/1014 [00:09<00:18, 36.35batch/s] 36%|█████████▌                 | 360/1014 [00:09<00:18, 36.32batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:17, 36.41batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:17, 36.43batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:17, 36.38batch/s] 37%|██████████                 | 380/1014 [00:10<00:17, 36.47batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 36.45batch/s] 38%|██████████▍                | 390/1014 [00:10<00:17, 36.41batch/s] 39%|██████████▌                | 395/1014 [00:10<00:16, 36.44batch/s] 39%|██████████▋                | 400/1014 [00:10<00:16, 36.47batch/s] 40%|██████████▊                | 405/1014 [00:11<00:16, 36.44batch/s] 40%|██████████▉                | 410/1014 [00:11<00:16, 36.46batch/s] 41%|███████████                | 415/1014 [00:11<00:16, 36.52batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 36.49batch/s] 42%|███████████▎               | 425/1014 [00:11<00:16, 36.53batch/s] 42%|███████████▍               | 430/1014 [00:11<00:16, 36.50batch/s] 43%|███████████▌               | 435/1014 [00:11<00:15, 36.49batch/s] 43%|███████████▋               | 440/1014 [00:12<00:15, 36.55batch/s] 44%|███████████▊               | 445/1014 [00:12<00:15, 36.50batch/s] 44%|███████████▉               | 450/1014 [00:12<00:15, 36.53batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 36.49batch/s] 45%|████████████▏              | 460/1014 [00:12<00:15, 36.38batch/s] 46%|████████████▍              | 465/1014 [00:12<00:15, 36.38batch/s] 46%|████████████▌              | 470/1014 [00:12<00:15, 36.24batch/s] 47%|████████████▋              | 475/1014 [00:13<00:14, 36.23batch/s] 47%|████████████▊              | 480/1014 [00:13<00:14, 36.25batch/s] 48%|████████████▉              | 485/1014 [00:13<00:14, 36.32batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 36.23batch/s] 49%|█████████████▏             | 495/1014 [00:13<00:14, 36.25batch/s] 49%|█████████████▎             | 500/1014 [00:13<00:14, 36.30batch/s] 50%|█████████████▍             | 505/1014 [00:13<00:14, 36.31batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:13, 36.28batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:13, 36.31batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:13, 36.32batch/s] 52%|█████████████▉             | 525/1014 [00:14<00:13, 36.31batch/s] 52%|██████████████             | 530/1014 [00:14<00:13, 36.35batch/s] 53%|██████████████▏            | 535/1014 [00:14<00:13, 36.30batch/s] 53%|██████████████▍            | 540/1014 [00:14<00:13, 36.33batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:12, 36.29batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:12, 36.34batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:12, 36.33batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 36.32batch/s] 56%|███████████████            | 565/1014 [00:15<00:12, 36.32batch/s] 56%|███████████████▏           | 570/1014 [00:15<00:12, 36.35batch/s] 57%|███████████████▎           | 575/1014 [00:15<00:12, 36.34batch/s] 57%|███████████████▍           | 580/1014 [00:15<00:11, 36.34batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:11, 36.33batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:11, 36.25batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 36.24batch/s] 59%|███████████████▉           | 600/1014 [00:16<00:11, 36.19batch/s] 60%|████████████████           | 605/1014 [00:16<00:11, 36.21batch/s] 60%|████████████████▏          | 610/1014 [00:16<00:11, 36.18batch/s] 61%|████████████████▍          | 615/1014 [00:16<00:11, 36.22batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:10, 36.25batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:10, 36.22batch/s] 62%|████████████████▊          | 630/1014 [00:17<00:10, 36.29batch/s] 63%|████████████████▉          | 635/1014 [00:17<00:10, 36.30batch/s] 63%|█████████████████          | 640/1014 [00:17<00:10, 36.36batch/s] 64%|█████████████████▏         | 645/1014 [00:17<00:10, 36.39batch/s] 64%|█████████████████▎         | 650/1014 [00:17<00:10, 36.39batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:09, 36.37batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:09, 36.34batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 36.10batch/s] 66%|█████████████████▊         | 670/1014 [00:18<00:09, 36.07batch/s] 67%|█████████████████▉         | 675/1014 [00:18<00:09, 36.11batch/s] 67%|██████████████████         | 680/1014 [00:18<00:09, 36.12batch/s] 68%|██████████████████▏        | 685/1014 [00:18<00:09, 36.13batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 35.87batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:08, 35.87batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.82batch/s] 70%|██████████████████▊        | 705/1014 [00:19<00:08, 35.85batch/s] 70%|██████████████████▉        | 710/1014 [00:19<00:08, 35.88batch/s] 71%|███████████████████        | 715/1014 [00:19<00:08, 35.89batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.91batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.90batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:07, 35.87batch/s] 72%|███████████████████▌       | 735/1014 [00:20<00:07, 35.90batch/s] 73%|███████████████████▋       | 740/1014 [00:20<00:07, 35.87batch/s] 73%|███████████████████▊       | 745/1014 [00:20<00:07, 35.87batch/s] 74%|███████████████████▉       | 750/1014 [00:20<00:07, 35.86batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.90batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.91batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:06, 35.92batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.92batch/s] 76%|████████████████████▋      | 775/1014 [00:21<00:06, 35.93batch/s] 77%|████████████████████▊      | 780/1014 [00:21<00:06, 35.91batch/s] 77%|████████████████████▉      | 785/1014 [00:21<00:06, 35.92batch/s] 78%|█████████████████████      | 790/1014 [00:21<00:06, 35.95batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 35.96batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:05, 35.91batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.91batch/s] 80%|█████████████████████▌     | 810/1014 [00:22<00:05, 35.89batch/s] 80%|█████████████████████▋     | 815/1014 [00:22<00:05, 35.91batch/s] 81%|█████████████████████▊     | 820/1014 [00:22<00:05, 35.69batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 35.74batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.74batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.59batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.56batch/s] 83%|██████████████████████▌    | 845/1014 [00:23<00:04, 35.55batch/s] 84%|██████████████████████▋    | 850/1014 [00:23<00:04, 35.59batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 35.53batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 35.55batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.54batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.57batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.57batch/s] 87%|███████████████████████▍   | 880/1014 [00:24<00:03, 35.58batch/s] 87%|███████████████████████▌   | 885/1014 [00:24<00:03, 35.59batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 35.53batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.52batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.53batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.57batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.54batch/s] 90%|████████████████████████▎  | 915/1014 [00:25<00:02, 35.52batch/s] 91%|████████████████████████▍  | 920/1014 [00:25<00:02, 35.52batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.56batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 35.55batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.56batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.54batch/s] 93%|█████████████████████████▏ | 945/1014 [00:26<00:01, 35.55batch/s] 94%|█████████████████████████▎ | 950/1014 [00:26<00:01, 35.58batch/s] 94%|█████████████████████████▍ | 955/1014 [00:26<00:01, 35.62batch/s] 95%|█████████████████████████▌ | 960/1014 [00:26<00:01, 35.64batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.67batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.51batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 35.52batch/s] 97%|██████████████████████████ | 980/1014 [00:27<00:00, 35.55batch/s] 97%|██████████████████████████▏| 985/1014 [00:27<00:00, 35.55batch/s] 98%|██████████████████████████▎| 990/1014 [00:27<00:00, 35.55batch/s] 98%|██████████████████████████▍| 995/1014 [00:27<00:00, 35.56batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 35.58batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 35.56batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 35.58batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.56batch/s]
Validation 3 -> LOSS = 1.15
Validation 3 -> BLEU = 70.26, 86.2/74.5/65.6/57.8 (BP=1.000, ratio=1.017, hyp_len=14631, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 1.15 @ validation 3
--> Best BLEU so far: 70.26 @ validation 3
Starting Epoch 4
Epoch 4 - update       1470 => loss:   1.366 (#OOM: 0)
Epoch 4 - update       1500 => loss:   1.612 (#OOM: 0)
Epoch 4 - update       1530 => loss:   1.262 (#OOM: 0)
Epoch 4 - update       1560 => loss:   1.410 (#OOM: 0)
Epoch 4 - update       1590 => loss:   1.696 (#OOM: 0)
Epoch 4 - update       1620 => loss:   1.362 (#OOM: 0)
Epoch 4 - update       1650 => loss:   1.392 (#OOM: 0)
Epoch 4 - update       1680 => loss:   1.163 (#OOM: 0)
Epoch 4 - update       1710 => loss:   1.122 (#OOM: 0)
Epoch 4 - update       1740 => loss:   1.356 (#OOM: 0)
Epoch 4 - update       1770 => loss:   1.117 (#OOM: 0)
Epoch 4 - update       1800 => loss:   1.214 (#OOM: 0)
Epoch 4 - update       1830 => loss:   1.250 (#OOM: 0)
Epoch 4 - update       1860 => loss:   0.960 (#OOM: 0)
Epoch 4 - update       1890 => loss:   1.134 (#OOM: 0)
Epoch 4 - update       1920 => loss:   0.948 (#OOM: 0)
--> Epoch 4 finished with mean loss 1.29484
--> Overhead/Training/Evaluation: 0.63/0.70/0.00 mins (total: 1.33 mins)   (688 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 18.33batch/s] 15%|████▌                          | 5/34 [00:00<00:01, 16.26batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 14.43batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 15.53batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.32batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 14.16batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.22batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.72batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.25batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.92batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.81batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.91batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 34.23batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 34.81batch/s]  1%|▎                           | 13/1014 [00:00<00:27, 36.40batch/s]  2%|▍                           | 18/1014 [00:00<00:25, 38.93batch/s]  2%|▋                           | 23/1014 [00:00<00:24, 40.49batch/s]  3%|▊                           | 28/1014 [00:00<00:25, 39.27batch/s]  3%|▉                           | 33/1014 [00:00<00:25, 39.12batch/s]  4%|█                           | 38/1014 [00:01<00:25, 37.81batch/s]  4%|█▏                          | 43/1014 [00:01<00:25, 37.47batch/s]  5%|█▎                          | 48/1014 [00:01<00:25, 37.65batch/s]  5%|█▍                          | 53/1014 [00:01<00:25, 37.31batch/s]  6%|█▌                          | 58/1014 [00:01<00:25, 37.47batch/s]  6%|█▋                          | 63/1014 [00:01<00:25, 37.48batch/s]  7%|█▉                          | 68/1014 [00:01<00:25, 37.57batch/s]  7%|██                          | 73/1014 [00:01<00:24, 37.91batch/s]  8%|██▏                         | 78/1014 [00:02<00:24, 37.62batch/s]  8%|██▎                         | 83/1014 [00:02<00:25, 37.07batch/s]  9%|██▍                         | 88/1014 [00:02<00:24, 37.30batch/s]  9%|██▌                         | 93/1014 [00:02<00:24, 37.25batch/s] 10%|██▋                         | 98/1014 [00:02<00:24, 36.93batch/s] 10%|██▋                        | 103/1014 [00:02<00:25, 36.39batch/s] 11%|██▉                        | 108/1014 [00:02<00:24, 36.48batch/s] 11%|███                        | 113/1014 [00:03<00:24, 36.66batch/s] 12%|███▏                       | 118/1014 [00:03<00:24, 36.74batch/s] 12%|███▎                       | 123/1014 [00:03<00:24, 36.63batch/s] 13%|███▍                       | 128/1014 [00:03<00:24, 36.47batch/s] 13%|███▌                       | 133/1014 [00:03<00:24, 36.70batch/s] 14%|███▋                       | 138/1014 [00:03<00:23, 36.80batch/s] 14%|███▊                       | 143/1014 [00:03<00:23, 36.45batch/s] 15%|███▉                       | 148/1014 [00:04<00:24, 35.94batch/s] 15%|████                       | 153/1014 [00:04<00:24, 35.83batch/s] 16%|████▏                      | 158/1014 [00:04<00:23, 36.12batch/s] 16%|████▎                      | 163/1014 [00:04<00:23, 35.54batch/s] 17%|████▍                      | 168/1014 [00:04<00:24, 35.10batch/s] 17%|████▌                      | 173/1014 [00:04<00:24, 34.90batch/s] 18%|████▋                      | 178/1014 [00:05<00:24, 34.46batch/s] 18%|████▊                      | 183/1014 [00:05<00:24, 34.11batch/s] 19%|█████                      | 188/1014 [00:05<00:24, 34.21batch/s] 19%|█████▏                     | 193/1014 [00:05<00:24, 34.14batch/s] 20%|█████▎                     | 198/1014 [00:05<00:23, 34.22batch/s] 20%|█████▍                     | 203/1014 [00:05<00:23, 34.40batch/s] 21%|█████▌                     | 208/1014 [00:06<00:23, 34.30batch/s] 21%|█████▋                     | 213/1014 [00:06<00:23, 34.39batch/s] 21%|█████▊                     | 218/1014 [00:06<00:23, 34.37batch/s] 22%|█████▉                     | 223/1014 [00:06<00:23, 34.36batch/s] 22%|██████                     | 228/1014 [00:06<00:22, 34.35batch/s] 23%|██████▏                    | 233/1014 [00:06<00:22, 34.36batch/s] 23%|██████▎                    | 238/1014 [00:06<00:22, 34.44batch/s] 24%|██████▍                    | 243/1014 [00:07<00:22, 34.49batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 34.34batch/s] 25%|██████▋                    | 253/1014 [00:07<00:22, 34.37batch/s] 25%|██████▊                    | 258/1014 [00:07<00:22, 34.36batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 34.34batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 34.46batch/s] 27%|███████▎                   | 273/1014 [00:07<00:21, 34.29batch/s] 27%|███████▍                   | 278/1014 [00:08<00:21, 34.40batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 34.59batch/s] 28%|███████▋                   | 288/1014 [00:08<00:20, 34.61batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 34.59batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 34.53batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 34.66batch/s] 30%|████████▏                  | 308/1014 [00:08<00:20, 34.73batch/s] 31%|████████▎                  | 313/1014 [00:09<00:20, 34.67batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 34.69batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 34.68batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 34.77batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 34.66batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 34.72batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:19, 34.73batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 34.75batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:18, 34.79batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 34.80batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.96batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.02batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 35.02batch/s] 38%|██████████▏                | 382/1014 [00:10<00:18, 35.05batch/s] 38%|██████████▎                | 388/1014 [00:11<00:17, 35.11batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.10batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.04batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 34.95batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 35.01batch/s] 41%|███████████▏               | 418/1014 [00:11<00:17, 35.04batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.10batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.21batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 35.25batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 35.30batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 35.23batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.15batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.26batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 35.21batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 34.87batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 34.88batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.93batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.91batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 34.86batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 34.91batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 34.98batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.98batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 35.04batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 35.09batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 35.04batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.12batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.14batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 35.18batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:12, 35.25batch/s] 55%|██████████████▉            | 562/1014 [00:15<00:12, 35.24batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 35.27batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.29batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.27batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 35.32batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:11, 35.32batch/s] 59%|███████████████▉           | 598/1014 [00:16<00:11, 35.24batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.24batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.26batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 35.28batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 35.31batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:11, 35.06batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 35.06batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 35.11batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 35.12batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 35.10batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 35.17batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.20batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 35.21batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 35.25batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 35.25batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.28batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.27batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.32batch/s] 70%|██████████████████▊        | 706/1014 [00:19<00:08, 35.37batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 35.39batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.34batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.36batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.41batch/s] 73%|███████████████████▌       | 736/1014 [00:20<00:07, 35.46batch/s] 73%|███████████████████▊       | 742/1014 [00:20<00:07, 35.50batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.55batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.56batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.52batch/s] 76%|████████████████████▍      | 766/1014 [00:21<00:06, 35.54batch/s] 76%|████████████████████▌      | 772/1014 [00:21<00:06, 35.56batch/s] 77%|████████████████████▋      | 778/1014 [00:21<00:06, 35.55batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.48batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.55batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 35.60batch/s] 79%|█████████████████████▎     | 802/1014 [00:22<00:05, 35.59batch/s] 80%|█████████████████████▌     | 808/1014 [00:22<00:05, 35.63batch/s] 80%|█████████████████████▋     | 814/1014 [00:22<00:05, 35.61batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.64batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 35.63batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 35.61batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:04, 35.60batch/s] 83%|██████████████████████▍    | 844/1014 [00:23<00:04, 35.61batch/s] 84%|██████████████████████▋    | 850/1014 [00:23<00:04, 35.64batch/s] 84%|██████████████████████▊    | 856/1014 [00:23<00:04, 35.68batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 35.65batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 35.66batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.71batch/s] 87%|███████████████████████▍   | 880/1014 [00:24<00:03, 35.70batch/s] 87%|███████████████████████▌   | 886/1014 [00:24<00:03, 35.74batch/s] 88%|███████████████████████▊   | 892/1014 [00:24<00:03, 35.75batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 35.68batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.71batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.76batch/s] 90%|████████████████████████▍  | 916/1014 [00:25<00:02, 35.78batch/s] 91%|████████████████████████▌  | 922/1014 [00:25<00:02, 35.81batch/s] 92%|████████████████████████▋  | 928/1014 [00:25<00:02, 35.82batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.82batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.87batch/s] 93%|█████████████████████████▏ | 946/1014 [00:26<00:01, 35.86batch/s] 94%|█████████████████████████▎ | 952/1014 [00:26<00:01, 35.86batch/s] 94%|█████████████████████████▌ | 958/1014 [00:26<00:01, 35.83batch/s] 95%|█████████████████████████▋ | 964/1014 [00:26<00:01, 35.81batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.80batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 35.78batch/s] 97%|██████████████████████████▏| 982/1014 [00:27<00:00, 35.80batch/s] 97%|██████████████████████████▎| 988/1014 [00:27<00:00, 35.80batch/s] 98%|██████████████████████████▍| 994/1014 [00:27<00:00, 35.76batch/s] 99%|█████████████████████████▋| 1000/1014 [00:27<00:00, 35.75batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 35.71batch/s]100%|█████████████████████████▉| 1012/1014 [00:28<00:00, 35.73batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.74batch/s]
Validation 4 -> LOSS = 0.86
Validation 4 -> BLEU = 81.07, 91.5/83.9/77.9/72.3 (BP=1.000, ratio=1.010, hyp_len=14529, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.86 @ validation 4
--> Best BLEU so far: 81.07 @ validation 4
Starting Epoch 5
Epoch 5 - update       1950 => loss:   0.951 (#OOM: 0)
Epoch 5 - update       1980 => loss:   0.872 (#OOM: 0)
Epoch 5 - update       2010 => loss:   0.963 (#OOM: 0)
Epoch 5 - update       2040 => loss:   0.997 (#OOM: 0)
Epoch 5 - update       2070 => loss:   0.904 (#OOM: 0)
Epoch 5 - update       2100 => loss:   1.144 (#OOM: 0)
Epoch 5 - update       2130 => loss:   1.151 (#OOM: 0)
Epoch 5 - update       2160 => loss:   0.842 (#OOM: 0)
Epoch 5 - update       2190 => loss:   0.899 (#OOM: 0)
Epoch 5 - update       2220 => loss:   0.930 (#OOM: 0)
Epoch 5 - update       2250 => loss:   1.031 (#OOM: 0)
Epoch 5 - update       2280 => loss:   0.845 (#OOM: 0)
Epoch 5 - update       2310 => loss:   0.964 (#OOM: 0)
Epoch 5 - update       2340 => loss:   1.045 (#OOM: 0)
Epoch 5 - update       2370 => loss:   0.963 (#OOM: 0)
Epoch 5 - update       2400 => loss:   0.941 (#OOM: 0)
--> Epoch 5 finished with mean loss 1.02182
--> Overhead/Training/Evaluation: 0.59/0.71/0.00 mins (total: 1.31 mins)   (678 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.81batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 10.23batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.66batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.31batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.94batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.74batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 12.65batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.98batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 14.17batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.03batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 14.71batch/s] 82%|████████████████████████▋     | 28/34 [00:01<00:00, 14.19batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.96batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.93batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.92batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:35, 28.86batch/s]  1%|▏                            | 7/1014 [00:00<00:30, 32.62batch/s]  1%|▎                           | 11/1014 [00:00<00:28, 34.80batch/s]  1%|▍                           | 15/1014 [00:00<00:30, 32.51batch/s]  2%|▌                           | 19/1014 [00:00<00:31, 31.65batch/s]  2%|▋                           | 23/1014 [00:00<00:30, 32.08batch/s]  3%|▋                           | 27/1014 [00:00<00:30, 31.92batch/s]  3%|▊                           | 31/1014 [00:00<00:30, 32.63batch/s]  4%|▉                           | 36/1014 [00:01<00:29, 33.38batch/s]  4%|█▏                          | 41/1014 [00:01<00:29, 32.49batch/s]  5%|█▎                          | 46/1014 [00:01<00:29, 32.95batch/s]  5%|█▍                          | 51/1014 [00:01<00:28, 33.68batch/s]  6%|█▌                          | 56/1014 [00:01<00:28, 33.28batch/s]  6%|█▋                          | 61/1014 [00:01<00:28, 33.55batch/s]  7%|█▊                          | 66/1014 [00:01<00:28, 33.76batch/s]  7%|█▉                          | 71/1014 [00:02<00:27, 34.14batch/s]  7%|██                          | 76/1014 [00:02<00:27, 34.47batch/s]  8%|██▏                         | 81/1014 [00:02<00:26, 34.85batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 34.92batch/s]  9%|██▌                         | 91/1014 [00:02<00:26, 35.05batch/s]  9%|██▋                         | 96/1014 [00:02<00:26, 35.26batch/s] 10%|██▋                        | 101/1014 [00:02<00:25, 35.15batch/s] 10%|██▊                        | 106/1014 [00:03<00:25, 35.08batch/s] 11%|██▉                        | 111/1014 [00:03<00:25, 34.92batch/s] 11%|███                        | 116/1014 [00:03<00:25, 34.81batch/s] 12%|███▏                       | 121/1014 [00:03<00:25, 34.93batch/s] 12%|███▎                       | 126/1014 [00:03<00:25, 35.06batch/s] 13%|███▍                       | 131/1014 [00:03<00:25, 35.05batch/s] 13%|███▌                       | 136/1014 [00:03<00:24, 35.13batch/s] 14%|███▊                       | 141/1014 [00:04<00:25, 34.67batch/s] 14%|███▉                       | 146/1014 [00:04<00:25, 34.67batch/s] 15%|████                       | 151/1014 [00:04<00:24, 34.55batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 34.54batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 34.53batch/s] 16%|████▍                      | 166/1014 [00:04<00:24, 34.71batch/s] 17%|████▌                      | 171/1014 [00:04<00:24, 34.91batch/s] 17%|████▋                      | 176/1014 [00:05<00:23, 34.99batch/s] 18%|████▊                      | 181/1014 [00:05<00:23, 35.07batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 35.27batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 35.43batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 35.38batch/s] 20%|█████▎                     | 201/1014 [00:05<00:22, 35.40batch/s] 20%|█████▍                     | 206/1014 [00:05<00:22, 35.29batch/s] 21%|█████▌                     | 211/1014 [00:05<00:22, 35.38batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 35.40batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 35.32batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 35.34batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 35.41batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.89batch/s] 24%|██████▍                    | 241/1014 [00:06<00:22, 35.04batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.47batch/s] 25%|██████▋                    | 251/1014 [00:07<00:22, 34.35batch/s] 25%|██████▊                    | 256/1014 [00:07<00:22, 34.41batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 34.33batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 34.45batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.52batch/s] 27%|███████▎                   | 276/1014 [00:08<00:21, 34.44batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.43batch/s] 28%|███████▌                   | 286/1014 [00:08<00:21, 34.42batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 34.51batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 34.52batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 34.62batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 34.48batch/s] 31%|████████▎                  | 311/1014 [00:09<00:20, 34.46batch/s] 31%|████████▍                  | 316/1014 [00:09<00:20, 34.58batch/s] 32%|████████▌                  | 321/1014 [00:09<00:20, 34.48batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 34.49batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 34.54batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 34.47batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 34.35batch/s] 34%|█████████▏                 | 346/1014 [00:10<00:19, 34.38batch/s] 35%|█████████▎                 | 351/1014 [00:10<00:19, 34.45batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:19, 34.48batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 34.43batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 34.44batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 34.33batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 34.25batch/s] 38%|██████████▏                | 381/1014 [00:11<00:18, 34.13batch/s] 38%|██████████▎                | 386/1014 [00:11<00:18, 34.12batch/s] 39%|██████████▍                | 391/1014 [00:11<00:18, 34.19batch/s] 39%|██████████▌                | 396/1014 [00:11<00:18, 34.10batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 34.11batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 34.19batch/s] 41%|██████████▉                | 411/1014 [00:12<00:17, 34.21batch/s] 41%|███████████                | 416/1014 [00:12<00:17, 34.21batch/s] 42%|███████████▏               | 421/1014 [00:12<00:17, 34.25batch/s] 42%|███████████▎               | 426/1014 [00:12<00:17, 34.27batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 34.32batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 34.32batch/s] 43%|███████████▋               | 441/1014 [00:12<00:16, 34.32batch/s] 44%|███████████▉               | 446/1014 [00:13<00:16, 34.29batch/s] 44%|████████████               | 451/1014 [00:13<00:16, 34.31batch/s] 45%|████████████▏              | 456/1014 [00:13<00:16, 34.37batch/s] 45%|████████████▎              | 461/1014 [00:13<00:16, 34.43batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 34.40batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 34.44batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 34.15batch/s] 47%|████████████▊              | 481/1014 [00:14<00:15, 34.18batch/s] 48%|████████████▉              | 486/1014 [00:14<00:15, 34.14batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 34.14batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:15, 34.12batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:15, 34.10batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 34.18batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 34.19batch/s] 51%|█████████████▋             | 516/1014 [00:15<00:14, 34.16batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 34.21batch/s] 52%|██████████████             | 526/1014 [00:15<00:14, 34.14batch/s] 52%|██████████████▏            | 531/1014 [00:15<00:14, 34.14batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 34.18batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 34.09batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 34.17batch/s] 54%|██████████████▋            | 551/1014 [00:16<00:13, 34.21batch/s] 55%|██████████████▊            | 556/1014 [00:16<00:13, 34.17batch/s] 55%|██████████████▉            | 561/1014 [00:16<00:13, 34.26batch/s] 56%|███████████████            | 566/1014 [00:16<00:13, 34.24batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 34.28batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 34.32batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.34batch/s] 58%|███████████████▌           | 586/1014 [00:17<00:12, 34.38batch/s] 58%|███████████████▋           | 591/1014 [00:17<00:12, 34.38batch/s] 59%|███████████████▊           | 596/1014 [00:17<00:12, 34.45batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 34.49batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 34.48batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.53batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 34.57batch/s] 61%|████████████████▌          | 621/1014 [00:18<00:11, 34.48batch/s] 62%|████████████████▋          | 626/1014 [00:18<00:11, 34.51batch/s] 62%|████████████████▊          | 631/1014 [00:18<00:11, 34.49batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:10, 34.47batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.50batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 34.53batch/s] 64%|█████████████████▎         | 651/1014 [00:18<00:10, 34.52batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 34.55batch/s] 65%|█████████████████▌         | 661/1014 [00:19<00:10, 34.59batch/s] 66%|█████████████████▋         | 666/1014 [00:19<00:10, 34.58batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.58batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 34.58batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 34.54batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 34.55batch/s] 68%|██████████████████▍        | 691/1014 [00:20<00:09, 34.54batch/s] 69%|██████████████████▌        | 696/1014 [00:20<00:09, 34.51batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.56batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 34.52batch/s] 70%|██████████████████▉        | 711/1014 [00:20<00:08, 34.53batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 34.56batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 34.40batch/s] 72%|███████████████████▎       | 726/1014 [00:21<00:08, 34.39batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.45batch/s] 73%|███████████████████▌       | 736/1014 [00:21<00:08, 34.48batch/s] 73%|███████████████████▋       | 741/1014 [00:21<00:07, 34.50batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 34.46batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 34.41batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 34.43batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.44batch/s] 76%|████████████████████▍      | 766/1014 [00:22<00:07, 34.42batch/s] 76%|████████████████████▌      | 771/1014 [00:22<00:07, 34.43batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 34.47batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 34.48batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 34.46batch/s] 78%|█████████████████████      | 791/1014 [00:23<00:06, 34.29batch/s] 79%|█████████████████████▏     | 796/1014 [00:23<00:06, 34.31batch/s] 79%|█████████████████████▎     | 801/1014 [00:23<00:06, 34.31batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:06, 34.29batch/s] 80%|█████████████████████▌     | 811/1014 [00:23<00:05, 34.28batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 34.27batch/s] 81%|█████████████████████▊     | 821/1014 [00:24<00:05, 34.11batch/s] 81%|█████████████████████▉     | 826/1014 [00:24<00:05, 34.12batch/s] 82%|██████████████████████▏    | 831/1014 [00:24<00:05, 34.17batch/s] 82%|██████████████████████▎    | 836/1014 [00:24<00:05, 34.18batch/s] 83%|██████████████████████▍    | 841/1014 [00:24<00:05, 34.20batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 34.21batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.20batch/s] 84%|██████████████████████▊    | 856/1014 [00:25<00:04, 34.20batch/s] 85%|██████████████████████▉    | 861/1014 [00:25<00:04, 34.15batch/s] 85%|███████████████████████    | 866/1014 [00:25<00:04, 34.13batch/s] 86%|███████████████████████▏   | 871/1014 [00:25<00:04, 34.17batch/s] 86%|███████████████████████▎   | 876/1014 [00:25<00:04, 34.16batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.18batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 34.18batch/s] 88%|███████████████████████▋   | 891/1014 [00:26<00:03, 34.21batch/s] 88%|███████████████████████▊   | 896/1014 [00:26<00:03, 34.22batch/s] 89%|███████████████████████▉   | 901/1014 [00:26<00:03, 34.19batch/s] 89%|████████████████████████   | 906/1014 [00:26<00:03, 34.22batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:03, 34.22batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.24batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 34.20batch/s] 91%|████████████████████████▋  | 926/1014 [00:27<00:02, 34.21batch/s] 92%|████████████████████████▊  | 931/1014 [00:27<00:02, 34.19batch/s] 92%|████████████████████████▉  | 936/1014 [00:27<00:02, 34.24batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.25batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.24batch/s] 94%|█████████████████████████▎ | 951/1014 [00:27<00:01, 34.27batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 34.24batch/s] 95%|█████████████████████████▌ | 961/1014 [00:28<00:01, 34.10batch/s] 95%|█████████████████████████▋ | 966/1014 [00:28<00:01, 34.11batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.09batch/s] 96%|█████████████████████████▉ | 976/1014 [00:28<00:01, 34.11batch/s] 97%|██████████████████████████ | 981/1014 [00:28<00:00, 34.16batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 34.14batch/s] 98%|██████████████████████████▍| 991/1014 [00:29<00:00, 34.14batch/s] 98%|██████████████████████████▌| 996/1014 [00:29<00:00, 33.96batch/s] 99%|█████████████████████████▋| 1001/1014 [00:29<00:00, 33.98batch/s] 99%|█████████████████████████▊| 1006/1014 [00:29<00:00, 33.96batch/s]100%|█████████████████████████▉| 1011/1014 [00:29<00:00, 33.95batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 33.94batch/s]
Validation 5 -> LOSS = 0.71
Validation 5 -> BLEU = 83.22, 91.4/85.5/80.7/76.1 (BP=1.000, ratio=1.029, hyp_len=14796, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.71 @ validation 5
--> Best BLEU so far: 83.22 @ validation 5
Starting Epoch 6
Epoch 6 - update       2430 => loss:   1.055 (#OOM: 0)
Epoch 6 - update       2460 => loss:   0.750 (#OOM: 0)
Epoch 6 - update       2490 => loss:   0.985 (#OOM: 0)
Epoch 6 - update       2520 => loss:   1.008 (#OOM: 0)
Epoch 6 - update       2550 => loss:   0.620 (#OOM: 0)
Epoch 6 - update       2580 => loss:   0.643 (#OOM: 0)
Epoch 6 - update       2610 => loss:   0.809 (#OOM: 0)
Epoch 6 - update       2640 => loss:   0.928 (#OOM: 0)
Epoch 6 - update       2670 => loss:   0.788 (#OOM: 0)
Epoch 6 - update       2700 => loss:   0.623 (#OOM: 0)
Epoch 6 - update       2730 => loss:   0.856 (#OOM: 0)
Epoch 6 - update       2760 => loss:   0.802 (#OOM: 0)
Epoch 6 - update       2790 => loss:   0.568 (#OOM: 0)
Epoch 6 - update       2820 => loss:   0.941 (#OOM: 0)
Epoch 6 - update       2850 => loss:   0.667 (#OOM: 0)
Epoch 6 - update       2880 => loss:   0.712 (#OOM: 0)
--> Epoch 6 finished with mean loss 0.84845
--> Overhead/Training/Evaluation: 0.63/0.71/0.00 mins (total: 1.34 mins)   (681 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.51batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.60batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.15batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.69batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.50batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 14.34batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 14.48batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 14.27batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.98batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 14.60batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.74batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.91batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.87batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.87batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:25, 39.25batch/s]  1%|▎                           | 10/1014 [00:00<00:28, 35.35batch/s]  1%|▍                           | 15/1014 [00:00<00:26, 37.57batch/s]  2%|▌                           | 20/1014 [00:00<00:25, 39.70batch/s]  2%|▋                           | 25/1014 [00:00<00:25, 39.17batch/s]  3%|▊                           | 30/1014 [00:00<00:25, 38.50batch/s]  3%|▉                           | 35/1014 [00:00<00:25, 38.55batch/s]  4%|█                           | 40/1014 [00:01<00:25, 38.26batch/s]  4%|█▏                          | 45/1014 [00:01<00:25, 38.02batch/s]  5%|█▍                          | 50/1014 [00:01<00:25, 37.64batch/s]  5%|█▌                          | 55/1014 [00:01<00:25, 36.98batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.34batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 36.27batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 36.32batch/s]  7%|██                          | 75/1014 [00:02<00:26, 35.39batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.53batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 35.63batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 34.98batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.74batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 35.14batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.87batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.26batch/s] 11%|███                        | 115/1014 [00:03<00:26, 34.40batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 34.34batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.34batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.41batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.61batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.44batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.39batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.45batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 34.51batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.50batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.55batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.68batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.47batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.64batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 34.63batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.48batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.45batch/s] 20%|█████▎                     | 200/1014 [00:05<00:24, 33.81batch/s] 20%|█████▍                     | 205/1014 [00:06<00:23, 33.93batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.10batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.11batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.13batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 34.11batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.21batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.18batch/s] 24%|██████▍                    | 240/1014 [00:07<00:22, 34.18batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 33.66batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 33.58batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 33.64batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 33.72batch/s] 26%|███████                    | 265/1014 [00:07<00:22, 33.63batch/s] 27%|███████▏                   | 270/1014 [00:08<00:22, 33.65batch/s] 27%|███████▎                   | 275/1014 [00:08<00:22, 33.17batch/s] 28%|███████▍                   | 280/1014 [00:08<00:22, 33.23batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 33.33batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 33.30batch/s] 29%|███████▊                   | 295/1014 [00:09<00:21, 32.76batch/s] 30%|███████▉                   | 300/1014 [00:09<00:21, 32.67batch/s] 30%|████████                   | 305/1014 [00:09<00:21, 32.52batch/s] 31%|████████▎                  | 310/1014 [00:09<00:21, 32.52batch/s] 31%|████████▍                  | 315/1014 [00:09<00:21, 32.54batch/s] 32%|████████▌                  | 320/1014 [00:09<00:21, 32.59batch/s] 32%|████████▋                  | 325/1014 [00:10<00:21, 32.49batch/s] 33%|████████▊                  | 330/1014 [00:10<00:21, 32.52batch/s] 33%|████████▉                  | 335/1014 [00:10<00:20, 32.57batch/s] 34%|█████████                  | 340/1014 [00:10<00:20, 32.55batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:20, 32.52batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:20, 32.45batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:20, 32.48batch/s] 36%|█████████▌                 | 360/1014 [00:11<00:20, 32.52batch/s] 36%|█████████▋                 | 365/1014 [00:11<00:19, 32.63batch/s] 36%|█████████▊                 | 370/1014 [00:11<00:19, 32.51batch/s] 37%|█████████▉                 | 375/1014 [00:11<00:19, 32.54batch/s] 37%|██████████                 | 380/1014 [00:11<00:19, 32.48batch/s] 38%|██████████▎                | 385/1014 [00:11<00:19, 32.53batch/s] 38%|██████████▍                | 390/1014 [00:12<00:19, 32.27batch/s] 39%|██████████▌                | 395/1014 [00:12<00:19, 32.39batch/s] 39%|██████████▋                | 400/1014 [00:12<00:18, 32.45batch/s] 40%|██████████▊                | 405/1014 [00:12<00:18, 32.52batch/s] 40%|██████████▉                | 410/1014 [00:12<00:18, 32.55batch/s] 41%|███████████                | 415/1014 [00:12<00:18, 32.53batch/s] 41%|███████████▏               | 420/1014 [00:12<00:18, 32.55batch/s] 42%|███████████▎               | 425/1014 [00:13<00:18, 32.44batch/s] 42%|███████████▍               | 430/1014 [00:13<00:17, 32.47batch/s] 43%|███████████▌               | 435/1014 [00:13<00:17, 32.45batch/s] 43%|███████████▋               | 440/1014 [00:13<00:17, 32.46batch/s] 44%|███████████▊               | 445/1014 [00:13<00:17, 32.55batch/s] 44%|███████████▉               | 450/1014 [00:13<00:17, 32.55batch/s] 45%|████████████               | 455/1014 [00:13<00:17, 32.58batch/s] 45%|████████████▏              | 460/1014 [00:14<00:16, 32.69batch/s] 46%|████████████▍              | 465/1014 [00:14<00:16, 32.76batch/s] 46%|████████████▌              | 470/1014 [00:14<00:16, 32.84batch/s] 47%|████████████▋              | 475/1014 [00:14<00:16, 32.80batch/s] 47%|████████████▊              | 480/1014 [00:14<00:16, 32.85batch/s] 48%|████████████▉              | 485/1014 [00:14<00:16, 32.83batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 32.83batch/s] 49%|█████████████▏             | 495/1014 [00:15<00:15, 32.84batch/s] 49%|█████████████▎             | 500/1014 [00:15<00:15, 32.81batch/s] 50%|█████████████▍             | 505/1014 [00:15<00:15, 32.87batch/s] 50%|█████████████▌             | 510/1014 [00:15<00:15, 32.90batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:15, 32.90batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:15, 32.86batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 32.87batch/s] 52%|██████████████             | 530/1014 [00:16<00:14, 32.87batch/s] 53%|██████████████▏            | 535/1014 [00:16<00:14, 32.90batch/s] 53%|██████████████▍            | 540/1014 [00:16<00:14, 32.88batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:14, 32.90batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:14, 32.79batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 32.84batch/s] 55%|██████████████▉            | 560/1014 [00:17<00:13, 32.84batch/s] 56%|███████████████            | 565/1014 [00:17<00:13, 32.84batch/s] 56%|███████████████▏           | 570/1014 [00:17<00:13, 32.89batch/s] 57%|███████████████▎           | 575/1014 [00:17<00:13, 32.93batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:13, 32.92batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:13, 32.85batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 32.82batch/s] 59%|███████████████▊           | 595/1014 [00:18<00:12, 32.83batch/s] 59%|███████████████▉           | 600/1014 [00:18<00:12, 32.80batch/s] 60%|████████████████           | 605/1014 [00:18<00:12, 32.83batch/s] 60%|████████████████▏          | 610/1014 [00:18<00:12, 32.80batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:12, 32.79batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:12, 32.79batch/s] 62%|████████████████▋          | 625/1014 [00:19<00:11, 32.83batch/s] 62%|████████████████▊          | 630/1014 [00:19<00:11, 32.79batch/s] 63%|████████████████▉          | 635/1014 [00:19<00:11, 32.83batch/s] 63%|█████████████████          | 640/1014 [00:19<00:11, 32.85batch/s] 64%|█████████████████▏         | 645/1014 [00:19<00:11, 32.75batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:11, 32.80batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 32.85batch/s] 65%|█████████████████▌         | 660/1014 [00:20<00:10, 32.87batch/s] 66%|█████████████████▋         | 665/1014 [00:20<00:10, 32.85batch/s] 66%|█████████████████▊         | 670/1014 [00:20<00:10, 32.80batch/s] 67%|█████████████████▉         | 675/1014 [00:20<00:10, 32.77batch/s] 67%|██████████████████         | 680/1014 [00:20<00:10, 32.81batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:10, 32.86batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 32.89batch/s] 69%|██████████████████▌        | 695/1014 [00:21<00:09, 32.92batch/s] 69%|██████████████████▋        | 700/1014 [00:21<00:09, 32.94batch/s] 70%|██████████████████▊        | 705/1014 [00:21<00:09, 32.96batch/s] 70%|██████████████████▉        | 710/1014 [00:21<00:09, 32.99batch/s] 71%|███████████████████        | 715/1014 [00:21<00:09, 33.00batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 33.00batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 33.03batch/s] 72%|███████████████████▍       | 730/1014 [00:22<00:08, 33.10batch/s] 72%|███████████████████▌       | 735/1014 [00:22<00:08, 33.02batch/s] 73%|███████████████████▋       | 740/1014 [00:22<00:08, 33.02batch/s] 73%|███████████████████▊       | 745/1014 [00:22<00:08, 33.04batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 33.09batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.05batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.05batch/s] 75%|████████████████████▎      | 765/1014 [00:23<00:07, 32.85batch/s] 76%|████████████████████▌      | 770/1014 [00:23<00:07, 32.86batch/s] 76%|████████████████████▋      | 775/1014 [00:23<00:07, 32.88batch/s] 77%|████████████████████▊      | 780/1014 [00:23<00:07, 32.88batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 32.89batch/s] 78%|█████████████████████      | 790/1014 [00:24<00:06, 32.87batch/s] 78%|█████████████████████▏     | 795/1014 [00:24<00:06, 32.92batch/s] 79%|█████████████████████▎     | 800/1014 [00:24<00:06, 32.94batch/s] 79%|█████████████████████▍     | 805/1014 [00:24<00:06, 32.98batch/s] 80%|█████████████████████▌     | 810/1014 [00:24<00:06, 32.83batch/s] 80%|█████████████████████▋     | 815/1014 [00:24<00:06, 32.88batch/s] 81%|█████████████████████▊     | 820/1014 [00:24<00:05, 32.90batch/s] 81%|█████████████████████▉     | 825/1014 [00:25<00:05, 32.93batch/s] 82%|██████████████████████     | 830/1014 [00:25<00:05, 32.92batch/s] 82%|██████████████████████▏    | 835/1014 [00:25<00:05, 32.95batch/s] 83%|██████████████████████▎    | 840/1014 [00:25<00:05, 32.99batch/s] 83%|██████████████████████▌    | 845/1014 [00:25<00:05, 33.04batch/s] 84%|██████████████████████▋    | 850/1014 [00:25<00:04, 32.99batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 33.00batch/s] 85%|██████████████████████▉    | 860/1014 [00:26<00:04, 32.95batch/s] 85%|███████████████████████    | 865/1014 [00:26<00:04, 32.96batch/s] 86%|███████████████████████▏   | 870/1014 [00:26<00:04, 32.97batch/s] 86%|███████████████████████▎   | 875/1014 [00:26<00:04, 32.98batch/s] 87%|███████████████████████▍   | 880/1014 [00:26<00:04, 33.01batch/s] 87%|███████████████████████▌   | 885/1014 [00:26<00:03, 32.93batch/s] 88%|███████████████████████▋   | 890/1014 [00:27<00:03, 32.93batch/s] 88%|███████████████████████▊   | 895/1014 [00:27<00:03, 32.97batch/s] 89%|███████████████████████▉   | 900/1014 [00:27<00:03, 32.98batch/s] 89%|████████████████████████   | 905/1014 [00:27<00:03, 32.97batch/s] 90%|████████████████████████▏  | 910/1014 [00:27<00:03, 32.98batch/s] 90%|████████████████████████▎  | 915/1014 [00:27<00:03, 32.95batch/s] 91%|████████████████████████▍  | 920/1014 [00:27<00:02, 32.94batch/s] 91%|████████████████████████▋  | 925/1014 [00:28<00:02, 32.91batch/s] 92%|████████████████████████▊  | 930/1014 [00:28<00:02, 32.90batch/s] 92%|████████████████████████▉  | 935/1014 [00:28<00:02, 32.94batch/s] 93%|█████████████████████████  | 940/1014 [00:28<00:02, 32.90batch/s] 93%|█████████████████████████▏ | 945/1014 [00:28<00:02, 32.91batch/s] 94%|█████████████████████████▎ | 950/1014 [00:28<00:01, 32.91batch/s] 94%|█████████████████████████▍ | 955/1014 [00:29<00:01, 32.93batch/s] 95%|█████████████████████████▌ | 960/1014 [00:29<00:01, 32.91batch/s] 95%|█████████████████████████▋ | 965/1014 [00:29<00:01, 32.94batch/s] 96%|█████████████████████████▊ | 970/1014 [00:29<00:01, 32.92batch/s] 96%|█████████████████████████▉ | 975/1014 [00:29<00:01, 32.90batch/s] 97%|██████████████████████████ | 980/1014 [00:29<00:01, 32.89batch/s] 97%|██████████████████████████▏| 985/1014 [00:29<00:00, 32.90batch/s] 98%|██████████████████████████▎| 990/1014 [00:30<00:00, 32.91batch/s] 98%|██████████████████████████▍| 995/1014 [00:30<00:00, 32.90batch/s] 99%|█████████████████████████▋| 1000/1014 [00:30<00:00, 32.89batch/s] 99%|█████████████████████████▊| 1005/1014 [00:30<00:00, 32.91batch/s]100%|█████████████████████████▉| 1010/1014 [00:30<00:00, 32.93batch/s]100%|██████████████████████████| 1014/1014 [00:30<00:00, 32.92batch/s]
Validation 6 -> LOSS = 0.61
Validation 6 -> BLEU = 88.24, 94.8/90.1/86.2/82.4 (BP=1.000, ratio=1.003, hyp_len=14427, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.61 @ validation 6
--> Best BLEU so far: 88.24 @ validation 6
Starting Epoch 7
Epoch 7 - update       2910 => loss:   0.936 (#OOM: 0)
Epoch 7 - update       2940 => loss:   0.645 (#OOM: 0)
Epoch 7 - update       2970 => loss:   0.670 (#OOM: 0)
Epoch 7 - update       3000 => loss:   0.508 (#OOM: 0)
Epoch 7 - update       3030 => loss:   0.699 (#OOM: 0)
Epoch 7 - update       3060 => loss:   0.692 (#OOM: 0)
Epoch 7 - update       3090 => loss:   0.791 (#OOM: 0)
Epoch 7 - update       3120 => loss:   0.532 (#OOM: 0)
Epoch 7 - update       3150 => loss:   0.690 (#OOM: 0)
Epoch 7 - update       3180 => loss:   0.673 (#OOM: 0)
Epoch 7 - update       3210 => loss:   0.623 (#OOM: 0)
Epoch 7 - update       3240 => loss:   0.575 (#OOM: 0)
Epoch 7 - update       3270 => loss:   0.777 (#OOM: 0)
Epoch 7 - update       3300 => loss:   0.613 (#OOM: 0)
Epoch 7 - update       3330 => loss:   0.691 (#OOM: 0)
Epoch 7 - update       3360 => loss:   0.614 (#OOM: 0)
--> Epoch 7 finished with mean loss 0.72954
--> Overhead/Training/Evaluation: 0.60/0.71/0.00 mins (total: 1.31 mins)   (681 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.15batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.98batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.23batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.35batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.69batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 14.35batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.44batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.80batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.94batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.96batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.41batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.64batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.56batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.55batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:34, 29.29batch/s]  1%|▏                            | 7/1014 [00:00<00:31, 31.85batch/s]  1%|▎                           | 11/1014 [00:00<00:32, 31.08batch/s]  1%|▍                           | 15/1014 [00:00<00:31, 31.87batch/s]  2%|▌                           | 19/1014 [00:00<00:31, 32.08batch/s]  2%|▋                           | 23/1014 [00:00<00:30, 32.01batch/s]  3%|▋                           | 27/1014 [00:00<00:30, 32.05batch/s]  3%|▉                           | 32/1014 [00:00<00:29, 33.18batch/s]  4%|█                           | 37/1014 [00:01<00:29, 33.30batch/s]  4%|█▏                          | 42/1014 [00:01<00:30, 32.38batch/s]  5%|█▎                          | 47/1014 [00:01<00:29, 33.26batch/s]  5%|█▍                          | 52/1014 [00:01<00:29, 32.94batch/s]  6%|█▌                          | 57/1014 [00:01<00:29, 32.58batch/s]  6%|█▋                          | 62/1014 [00:01<00:28, 33.27batch/s]  7%|█▊                          | 67/1014 [00:01<00:28, 33.60batch/s]  7%|█▉                          | 72/1014 [00:02<00:28, 33.24batch/s]  8%|██▏                         | 77/1014 [00:02<00:28, 33.09batch/s]  8%|██▎                         | 82/1014 [00:02<00:27, 33.45batch/s]  9%|██▍                         | 87/1014 [00:02<00:28, 32.82batch/s]  9%|██▌                         | 92/1014 [00:02<00:28, 32.46batch/s] 10%|██▋                         | 97/1014 [00:02<00:27, 32.86batch/s] 10%|██▋                        | 102/1014 [00:03<00:27, 32.97batch/s] 11%|██▊                        | 107/1014 [00:03<00:27, 33.27batch/s] 11%|██▉                        | 112/1014 [00:03<00:27, 33.25batch/s] 12%|███                        | 117/1014 [00:03<00:26, 33.37batch/s] 12%|███▏                       | 122/1014 [00:03<00:26, 33.45batch/s] 13%|███▍                       | 127/1014 [00:03<00:26, 33.50batch/s] 13%|███▌                       | 132/1014 [00:03<00:26, 33.68batch/s] 14%|███▋                       | 137/1014 [00:04<00:25, 33.83batch/s] 14%|███▊                       | 142/1014 [00:04<00:25, 33.86batch/s] 14%|███▉                       | 147/1014 [00:04<00:25, 34.11batch/s] 15%|████                       | 152/1014 [00:04<00:25, 34.14batch/s] 15%|████▏                      | 157/1014 [00:04<00:25, 34.11batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.21batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.17batch/s] 17%|████▌                      | 172/1014 [00:05<00:24, 34.06batch/s] 17%|████▋                      | 177/1014 [00:05<00:24, 34.17batch/s] 18%|████▊                      | 182/1014 [00:05<00:24, 34.35batch/s] 18%|████▉                      | 187/1014 [00:05<00:24, 34.27batch/s] 19%|█████                      | 192/1014 [00:05<00:24, 34.13batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 34.10batch/s] 20%|█████▍                     | 203/1014 [00:05<00:23, 34.40batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.56batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.33batch/s] 22%|█████▉                     | 221/1014 [00:06<00:23, 34.47batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 34.36batch/s] 23%|██████▏                    | 233/1014 [00:06<00:22, 34.45batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.55batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.42batch/s] 25%|██████▋                    | 251/1014 [00:07<00:22, 34.58batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 34.70batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 34.72batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.83batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.73batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.81batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 34.81batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 34.63batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.82batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.83batch/s] 31%|████████▎                  | 311/1014 [00:08<00:20, 34.67batch/s] 31%|████████▍                  | 317/1014 [00:09<00:20, 34.69batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 34.82batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.82batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.63batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 34.71batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:19, 34.71batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 34.67batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 34.70batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.75batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 34.75batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 34.71batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 34.80batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 34.81batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.66batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 34.70batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 34.73batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 34.73batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.79batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 34.78batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 34.84batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 34.75batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.72batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.75batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.77batch/s] 45%|████████████▎              | 461/1014 [00:13<00:15, 34.84batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 34.81batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.85batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.82batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.77batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 34.66batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 34.65batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.64batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.56batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.60batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 34.63batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 34.57batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 34.62batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.63batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.62batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 34.60batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.57batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:13, 34.52batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.56batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.63batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.65batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 34.65batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.63batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.62batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.56batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.52batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.49batch/s] 61%|████████████████▌          | 623/1014 [00:18<00:11, 34.50batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.51batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.56batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.57batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.51batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.51batch/s] 65%|█████████████████▌         | 659/1014 [00:19<00:10, 34.53batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.52batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.52batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.48batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.43batch/s] 68%|██████████████████▎        | 689/1014 [00:20<00:09, 34.38batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.39batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.38batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.39batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.41batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.39batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.24batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.25batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:08, 34.25batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.19batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.18batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.87batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 33.89batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 33.83batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:07, 33.87batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 33.94batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.95batch/s] 78%|█████████████████████      | 791/1014 [00:23<00:06, 33.93batch/s] 79%|█████████████████████▏     | 797/1014 [00:23<00:06, 33.99batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 33.99batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:06, 34.04batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.05batch/s] 81%|█████████████████████▊     | 821/1014 [00:24<00:05, 34.01batch/s] 82%|██████████████████████     | 827/1014 [00:24<00:05, 33.99batch/s] 82%|██████████████████████▏    | 833/1014 [00:24<00:05, 34.00batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.02batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 33.96batch/s] 84%|██████████████████████▋    | 851/1014 [00:25<00:04, 33.97batch/s] 85%|██████████████████████▊    | 857/1014 [00:25<00:04, 33.95batch/s] 85%|██████████████████████▉    | 863/1014 [00:25<00:04, 34.01batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.05batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.09batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.11batch/s] 87%|███████████████████████▌   | 887/1014 [00:26<00:03, 34.07batch/s] 88%|███████████████████████▊   | 893/1014 [00:26<00:03, 34.04batch/s] 89%|███████████████████████▉   | 899/1014 [00:26<00:03, 34.07batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 33.99batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:03, 33.99batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.00batch/s] 91%|████████████████████████▌  | 923/1014 [00:27<00:02, 34.03batch/s] 92%|████████████████████████▋  | 929/1014 [00:27<00:02, 34.02batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.07batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.09batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.10batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.09batch/s] 95%|█████████████████████████▌ | 959/1014 [00:28<00:01, 34.04batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 34.02batch/s] 96%|█████████████████████████▊ | 971/1014 [00:28<00:01, 34.03batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.01batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.03batch/s] 98%|██████████████████████████▎| 989/1014 [00:29<00:00, 34.08batch/s] 98%|██████████████████████████▍| 995/1014 [00:29<00:00, 34.09batch/s] 99%|█████████████████████████▋| 1001/1014 [00:29<00:00, 34.09batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.05batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.03batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.03batch/s]
Validation 7 -> LOSS = 0.54
Validation 7 -> BLEU = 89.59, 95.4/91.2/87.7/84.3 (BP=1.000, ratio=1.005, hyp_len=14451, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.54 @ validation 7
--> Best BLEU so far: 89.59 @ validation 7
Starting Epoch 8
Epoch 8 - update       3390 => loss:   0.797 (#OOM: 0)
Epoch 8 - update       3420 => loss:   0.806 (#OOM: 0)
Epoch 8 - update       3450 => loss:   1.191 (#OOM: 0)
Epoch 8 - update       3480 => loss:   0.787 (#OOM: 0)
Epoch 8 - update       3510 => loss:   0.565 (#OOM: 0)
Epoch 8 - update       3540 => loss:   1.282 (#OOM: 0)
Epoch 8 - update       3570 => loss:   0.604 (#OOM: 0)
Epoch 8 - update       3600 => loss:   0.514 (#OOM: 0)
Epoch 8 - update       3630 => loss:   0.439 (#OOM: 0)
Epoch 8 - update       3660 => loss:   0.581 (#OOM: 0)
Epoch 8 - update       3690 => loss:   0.573 (#OOM: 0)
Epoch 8 - update       3720 => loss:   0.477 (#OOM: 0)
Epoch 8 - update       3750 => loss:   0.681 (#OOM: 0)
Epoch 8 - update       3780 => loss:   0.518 (#OOM: 0)
Epoch 8 - update       3810 => loss:   0.735 (#OOM: 0)
Epoch 8 - update       3840 => loss:   0.528 (#OOM: 0)
--> Epoch 8 finished with mean loss 0.63831
--> Overhead/Training/Evaluation: 0.64/0.72/0.00 mins (total: 1.35 mins)   (675 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.82batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.19batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.29batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.76batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 13.51batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 13.74batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.11batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.19batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.74batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.32batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.61batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.06batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.11batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:36, 27.92batch/s]  1%|▏                            | 7/1014 [00:00<00:33, 30.25batch/s]  1%|▎                           | 11/1014 [00:00<00:32, 30.42batch/s]  1%|▍                           | 15/1014 [00:00<00:31, 31.93batch/s]  2%|▌                           | 20/1014 [00:00<00:30, 32.87batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.50batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 35.30batch/s]  3%|▉                           | 35/1014 [00:00<00:27, 35.28batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.15batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.47batch/s]  5%|█▍                          | 50/1014 [00:01<00:27, 35.68batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.08batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 35.51batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 35.29batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 35.18batch/s]  7%|██                          | 75/1014 [00:02<00:26, 35.03batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.49batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 35.84batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 35.79batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 35.93batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 36.13batch/s] 10%|██▊                        | 105/1014 [00:02<00:25, 36.05batch/s] 11%|██▉                        | 110/1014 [00:03<00:24, 36.17batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.04batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 34.58batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.38batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.61batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.65batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.48batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.63batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 34.64batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 33.88batch/s] 16%|████▎                      | 160/1014 [00:04<00:25, 33.83batch/s] 16%|████▍                      | 165/1014 [00:04<00:25, 33.90batch/s] 17%|████▌                      | 170/1014 [00:05<00:24, 33.97batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.09batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.15batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 34.15batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 34.31batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 34.37batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 34.38batch/s] 20%|█████▍                     | 205/1014 [00:05<00:23, 34.46batch/s] 21%|█████▌                     | 210/1014 [00:06<00:23, 34.43batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 34.38batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 34.44batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.47batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.49batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.55batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 34.55batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 34.58batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 34.63batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 34.57batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.54batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.70batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.83batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.74batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.76batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 34.76batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.81batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.76batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.74batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.71batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.68batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.69batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 34.83batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.87batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.94batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.01batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 35.11batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 35.14batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.13batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.67batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.50batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.48batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.43batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.30batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.44batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.39batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.48batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.51batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.49batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.54batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.56batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 34.53batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.51batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.50batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.54batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.61batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.60batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.50batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.57batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.45batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.12batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 34.12batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.06batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.10batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 34.15batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.19batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.23batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.29batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.34batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.33batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.34batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.36batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.42batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.43batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 34.43batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.42batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.43batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.41batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.44batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.47batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.51batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 34.45batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.45batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.48batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.45batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.51batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.49batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.52batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.54batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.59batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.51batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.52batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.59batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.54batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.57batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.53batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.56batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.48batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.46batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 34.46batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.48batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.46batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.50batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.51batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.52batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.49batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.55batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.55batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.56batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.57batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.59batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.59batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.53batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.57batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.57batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.53batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.54batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.55batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.51batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.54batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.57batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.59batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.55batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.51batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.53batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.55batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.56batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.61batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.62batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.60batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.58batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.58batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.56batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.58batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 34.55batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.48batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.47batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.49batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.51batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.52batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.55batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.57batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.57batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.56batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.57batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.55batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.52batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.52batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.57batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.56batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.53batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.54batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.56batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.59batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.59batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.58batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.57batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.55batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.56batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.56batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.51batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.47batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.42batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.42batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.41batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.41batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.39batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.38batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.38batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.37batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.34batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.35batch/s]
Validation 8 -> LOSS = 0.49
Validation 8 -> BLEU = 90.01, 95.3/91.5/88.3/85.3 (BP=1.000, ratio=1.009, hyp_len=14517, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.49 @ validation 8
--> Best BLEU so far: 90.01 @ validation 8
Starting Epoch 9
Epoch 9 - update       3870 => loss:   0.643 (#OOM: 0)
Epoch 9 - update       3900 => loss:   0.591 (#OOM: 0)
Epoch 9 - update       3930 => loss:   0.627 (#OOM: 0)
Epoch 9 - update       3960 => loss:   0.539 (#OOM: 0)
Epoch 9 - update       3990 => loss:   0.481 (#OOM: 0)
Epoch 9 - update       4020 => loss:   0.647 (#OOM: 0)
Epoch 9 - update       4050 => loss:   0.602 (#OOM: 0)
Epoch 9 - update       4080 => loss:   0.705 (#OOM: 0)
Epoch 9 - update       4110 => loss:   0.528 (#OOM: 0)
Epoch 9 - update       4140 => loss:   0.638 (#OOM: 0)
Epoch 9 - update       4170 => loss:   0.365 (#OOM: 0)
Epoch 9 - update       4200 => loss:   0.508 (#OOM: 0)
Epoch 9 - update       4230 => loss:   0.552 (#OOM: 0)
Epoch 9 - update       4260 => loss:   0.485 (#OOM: 0)
Epoch 9 - update       4290 => loss:   0.351 (#OOM: 0)
Epoch 9 - update       4320 => loss:   0.567 (#OOM: 0)
--> Epoch 9 finished with mean loss 0.56922
--> Overhead/Training/Evaluation: 0.64/0.71/0.00 mins (total: 1.35 mins)   (683 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  8.13batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.10batch/s] 12%|███▋                           | 4/34 [00:00<00:03,  9.52batch/s] 18%|█████▍                         | 6/34 [00:00<00:02,  9.92batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 10.48batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 10.68batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.11batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.55batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.06batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 11.95batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.16batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.29batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.66batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.42batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.54batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.38batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.51batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:27, 36.10batch/s]  1%|▎                           | 10/1014 [00:00<00:28, 35.55batch/s]  1%|▍                           | 15/1014 [00:00<00:28, 35.29batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 35.30batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.82batch/s]  3%|▊                           | 30/1014 [00:00<00:28, 34.95batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.65batch/s]  4%|█                           | 40/1014 [00:01<00:28, 34.38batch/s]  4%|█▏                          | 45/1014 [00:01<00:28, 33.49batch/s]  5%|█▍                          | 50/1014 [00:01<00:29, 33.05batch/s]  5%|█▌                          | 55/1014 [00:01<00:28, 33.42batch/s]  6%|█▋                          | 60/1014 [00:01<00:28, 33.45batch/s]  6%|█▊                          | 65/1014 [00:01<00:28, 33.56batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.02batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.58batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 34.70batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 34.63batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 34.17batch/s]  9%|██▌                         | 95/1014 [00:02<00:27, 33.64batch/s] 10%|██▋                        | 100/1014 [00:02<00:27, 33.72batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 33.81batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 33.90batch/s] 11%|███                        | 115/1014 [00:03<00:26, 33.70batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 33.88batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 34.03batch/s] 13%|███▍                       | 130/1014 [00:03<00:26, 33.88batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 33.89batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 33.73batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 33.79batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 33.92batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 33.92batch/s] 16%|████▎                      | 160/1014 [00:04<00:25, 33.91batch/s] 16%|████▍                      | 165/1014 [00:04<00:25, 33.71batch/s] 17%|████▌                      | 170/1014 [00:05<00:25, 33.75batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 33.89batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 33.85batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 33.83batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 34.05batch/s] 19%|█████▏                     | 195/1014 [00:05<00:24, 34.10batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 33.98batch/s] 20%|█████▍                     | 205/1014 [00:06<00:24, 33.26batch/s] 21%|█████▌                     | 210/1014 [00:06<00:24, 33.27batch/s] 21%|█████▋                     | 215/1014 [00:06<00:24, 33.19batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 33.18batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 33.10batch/s] 23%|██████                     | 230/1014 [00:06<00:23, 33.06batch/s] 23%|██████▎                    | 235/1014 [00:07<00:23, 33.03batch/s] 24%|██████▍                    | 240/1014 [00:07<00:23, 33.04batch/s] 24%|██████▌                    | 245/1014 [00:07<00:23, 33.16batch/s] 25%|██████▋                    | 250/1014 [00:07<00:23, 33.10batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 33.26batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 33.34batch/s] 26%|███████                    | 265/1014 [00:07<00:22, 33.35batch/s] 27%|███████▏                   | 270/1014 [00:08<00:22, 33.33batch/s] 27%|███████▎                   | 275/1014 [00:08<00:22, 33.30batch/s] 28%|███████▍                   | 280/1014 [00:08<00:22, 33.36batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 33.35batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 33.41batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 33.48batch/s] 30%|███████▉                   | 300/1014 [00:08<00:21, 33.63batch/s] 30%|████████                   | 305/1014 [00:09<00:21, 33.64batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 33.73batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 33.78batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 33.86batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 33.80batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 33.86batch/s] 33%|████████▉                  | 335/1014 [00:09<00:20, 33.77batch/s] 34%|█████████                  | 340/1014 [00:10<00:19, 33.83batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 33.90batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 33.93batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 33.89batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 33.86batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:19, 33.90batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:19, 33.86batch/s] 37%|█████████▉                 | 375/1014 [00:11<00:18, 33.87batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 33.51batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 33.53batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 33.40batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 33.42batch/s] 39%|██████████▋                | 400/1014 [00:11<00:18, 33.38batch/s] 40%|██████████▊                | 405/1014 [00:12<00:18, 33.41batch/s] 40%|██████████▉                | 410/1014 [00:12<00:18, 33.47batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 33.43batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 33.45batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 33.46batch/s] 42%|███████████▍               | 430/1014 [00:12<00:17, 33.46batch/s] 43%|███████████▌               | 435/1014 [00:13<00:17, 33.45batch/s] 43%|███████████▋               | 440/1014 [00:13<00:17, 33.51batch/s] 44%|███████████▊               | 445/1014 [00:13<00:17, 33.37batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 33.38batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 33.44batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 33.40batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 33.47batch/s] 46%|████████████▌              | 470/1014 [00:14<00:16, 33.51batch/s] 47%|████████████▋              | 475/1014 [00:14<00:16, 33.57batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 33.59batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 33.58batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 33.48batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 33.49batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 33.46batch/s] 50%|█████████████▍             | 505/1014 [00:15<00:15, 33.54batch/s] 50%|█████████████▌             | 510/1014 [00:15<00:15, 33.60batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 33.54batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 33.50batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 33.50batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 33.50batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 33.54batch/s] 53%|██████████████▍            | 540/1014 [00:16<00:14, 33.58batch/s] 54%|██████████████▌            | 545/1014 [00:16<00:13, 33.58batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 33.66batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 33.73batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 33.76batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 33.80batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 33.81batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 33.83batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 33.88batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 33.84batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 33.82batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 33.82batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 33.79batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 33.77batch/s] 60%|████████████████▏          | 610/1014 [00:18<00:11, 33.81batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 33.79batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 33.81batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 33.81batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 33.84batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 33.88batch/s] 63%|█████████████████          | 640/1014 [00:18<00:11, 33.84batch/s] 64%|█████████████████▏         | 645/1014 [00:19<00:10, 33.76batch/s] 64%|█████████████████▎         | 650/1014 [00:19<00:10, 33.78batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 33.77batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 33.80batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 33.77batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 33.82batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:10, 33.85batch/s] 67%|██████████████████         | 680/1014 [00:20<00:09, 33.82batch/s] 68%|██████████████████▏        | 685/1014 [00:20<00:09, 33.86batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 33.84batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 33.87batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 33.92batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:09, 33.94batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.01batch/s] 71%|███████████████████        | 715/1014 [00:21<00:08, 34.02batch/s] 71%|███████████████████▏       | 720/1014 [00:21<00:08, 34.00batch/s] 71%|███████████████████▎       | 725/1014 [00:21<00:08, 34.01batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.02batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.03batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:08, 33.98batch/s] 73%|███████████████████▊       | 745/1014 [00:22<00:07, 33.79batch/s] 74%|███████████████████▉       | 750/1014 [00:22<00:07, 33.82batch/s] 74%|████████████████████       | 755/1014 [00:22<00:07, 33.63batch/s] 75%|████████████████████▏      | 760/1014 [00:22<00:07, 33.63batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 33.63batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 33.66batch/s] 76%|████████████████████▋      | 775/1014 [00:23<00:07, 33.69batch/s] 77%|████████████████████▊      | 780/1014 [00:23<00:06, 33.73batch/s] 77%|████████████████████▉      | 785/1014 [00:23<00:06, 33.74batch/s] 78%|█████████████████████      | 790/1014 [00:23<00:06, 33.76batch/s] 78%|█████████████████████▏     | 795/1014 [00:23<00:06, 33.80batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 33.79batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 33.75batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:06, 33.78batch/s] 80%|█████████████████████▋     | 815/1014 [00:24<00:05, 33.81batch/s] 81%|█████████████████████▊     | 820/1014 [00:24<00:05, 33.78batch/s] 81%|█████████████████████▉     | 825/1014 [00:24<00:05, 33.80batch/s] 82%|██████████████████████     | 830/1014 [00:24<00:05, 33.82batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 33.77batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 33.81batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 33.81batch/s] 84%|██████████████████████▋    | 850/1014 [00:25<00:04, 33.82batch/s] 84%|██████████████████████▊    | 855/1014 [00:25<00:04, 33.83batch/s] 85%|██████████████████████▉    | 860/1014 [00:25<00:04, 33.84batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 33.84batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 33.86batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 33.85batch/s] 87%|███████████████████████▍   | 880/1014 [00:26<00:03, 33.77batch/s] 87%|███████████████████████▌   | 885/1014 [00:26<00:03, 33.76batch/s] 88%|███████████████████████▋   | 890/1014 [00:26<00:03, 33.78batch/s] 88%|███████████████████████▊   | 895/1014 [00:26<00:03, 33.79batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 33.80batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 33.76batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 33.79batch/s] 90%|████████████████████████▎  | 915/1014 [00:27<00:02, 33.79batch/s] 91%|████████████████████████▍  | 920/1014 [00:27<00:02, 33.84batch/s] 91%|████████████████████████▋  | 925/1014 [00:27<00:02, 33.86batch/s] 92%|████████████████████████▊  | 930/1014 [00:27<00:02, 33.87batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 33.91batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 33.95batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:02, 33.94batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 33.99batch/s] 94%|█████████████████████████▍ | 955/1014 [00:28<00:01, 33.98batch/s] 95%|█████████████████████████▌ | 960/1014 [00:28<00:01, 33.97batch/s] 95%|█████████████████████████▋ | 965/1014 [00:28<00:01, 33.98batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 33.95batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 33.93batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:01, 33.91batch/s] 97%|██████████████████████████▏| 985/1014 [00:29<00:00, 33.94batch/s] 98%|██████████████████████████▎| 990/1014 [00:29<00:00, 33.98batch/s] 98%|██████████████████████████▍| 995/1014 [00:29<00:00, 34.01batch/s] 99%|█████████████████████████▋| 1000/1014 [00:29<00:00, 34.06batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.08batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.02batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.01batch/s]
Validation 9 -> LOSS = 0.46
Validation 9 -> BLEU = 90.55, 95.7/92.0/88.9/85.9 (BP=1.000, ratio=1.007, hyp_len=14481, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.46 @ validation 9
--> Best BLEU so far: 90.55 @ validation 9
Starting Epoch 10
Epoch 10 - update       4350 => loss:   0.676 (#OOM: 0)
Epoch 10 - update       4380 => loss:   0.635 (#OOM: 0)
Epoch 10 - update       4410 => loss:   0.474 (#OOM: 0)
Epoch 10 - update       4440 => loss:   0.468 (#OOM: 0)
Epoch 10 - update       4470 => loss:   0.461 (#OOM: 0)
Epoch 10 - update       4500 => loss:   0.369 (#OOM: 0)
Epoch 10 - update       4530 => loss:   0.503 (#OOM: 0)
Epoch 10 - update       4560 => loss:   0.460 (#OOM: 0)
Epoch 10 - update       4590 => loss:   0.447 (#OOM: 0)
Epoch 10 - update       4620 => loss:   0.566 (#OOM: 0)
Epoch 10 - update       4650 => loss:   0.410 (#OOM: 0)
Epoch 10 - update       4680 => loss:   0.316 (#OOM: 0)
Epoch 10 - update       4710 => loss:   0.412 (#OOM: 0)
Epoch 10 - update       4740 => loss:   0.377 (#OOM: 0)
Epoch 10 - update       4770 => loss:   0.475 (#OOM: 0)
Epoch 10 - update       4800 => loss:   0.647 (#OOM: 0)
--> Epoch 10 finished with mean loss 0.51227
--> Overhead/Training/Evaluation: 0.66/0.72/0.00 mins (total: 1.38 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.52batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 10.46batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.67batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 12.52batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 12.76batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.54batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 13.09batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.24batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.35batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.01batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.24batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.52batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.89batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.95batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.84batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 34.33batch/s]  1%|▎                           | 13/1014 [00:00<00:27, 36.17batch/s]  2%|▍                           | 18/1014 [00:00<00:27, 35.81batch/s]  2%|▋                           | 23/1014 [00:00<00:28, 34.40batch/s]  3%|▊                           | 28/1014 [00:00<00:29, 33.73batch/s]  3%|▉                           | 33/1014 [00:00<00:28, 34.82batch/s]  4%|█                           | 38/1014 [00:01<00:28, 34.72batch/s]  4%|█▏                          | 43/1014 [00:01<00:27, 34.81batch/s]  5%|█▎                          | 48/1014 [00:01<00:27, 34.78batch/s]  5%|█▍                          | 53/1014 [00:01<00:27, 34.54batch/s]  6%|█▌                          | 58/1014 [00:01<00:27, 34.80batch/s]  6%|█▋                          | 63/1014 [00:01<00:27, 34.88batch/s]  7%|█▉                          | 68/1014 [00:01<00:27, 34.95batch/s]  7%|██                          | 73/1014 [00:02<00:26, 35.60batch/s]  8%|██▏                         | 78/1014 [00:02<00:26, 35.89batch/s]  8%|██▎                         | 83/1014 [00:02<00:26, 35.49batch/s]  9%|██▍                         | 88/1014 [00:02<00:26, 35.39batch/s]  9%|██▌                         | 93/1014 [00:02<00:26, 35.11batch/s] 10%|██▋                         | 99/1014 [00:02<00:25, 35.74batch/s] 10%|██▊                        | 105/1014 [00:02<00:25, 35.56batch/s] 11%|██▉                        | 111/1014 [00:03<00:25, 35.37batch/s] 12%|███                        | 117/1014 [00:03<00:25, 35.43batch/s] 12%|███▎                       | 123/1014 [00:03<00:25, 35.62batch/s] 13%|███▍                       | 129/1014 [00:03<00:24, 35.66batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 35.53batch/s] 14%|███▊                       | 141/1014 [00:03<00:24, 35.65batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 35.66batch/s] 15%|████                       | 153/1014 [00:04<00:24, 35.41batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 35.36batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 35.54batch/s] 17%|████▌                      | 171/1014 [00:04<00:23, 35.46batch/s] 17%|████▋                      | 177/1014 [00:04<00:23, 35.59batch/s] 18%|████▊                      | 183/1014 [00:05<00:23, 35.53batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 35.48batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.02batch/s] 20%|█████▎                     | 201/1014 [00:05<00:23, 34.94batch/s] 20%|█████▌                     | 207/1014 [00:05<00:23, 34.90batch/s] 21%|█████▋                     | 213/1014 [00:06<00:22, 35.05batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 34.88batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.87batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 34.94batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 34.85batch/s] 24%|██████▍                    | 243/1014 [00:06<00:22, 34.75batch/s] 25%|██████▋                    | 249/1014 [00:07<00:21, 34.83batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 34.73batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 34.83batch/s] 26%|███████                    | 267/1014 [00:07<00:21, 34.86batch/s] 27%|███████▎                   | 273/1014 [00:07<00:21, 34.71batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.70batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 34.78batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 34.78batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 34.68batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 34.82batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 34.79batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.89batch/s] 32%|████████▌                  | 321/1014 [00:09<00:19, 34.92batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 34.98batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 35.00batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 35.06batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 35.01batch/s] 35%|█████████▎                 | 351/1014 [00:10<00:18, 35.08batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 34.97batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 34.89batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.90batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.88batch/s] 38%|██████████▏                | 381/1014 [00:10<00:18, 34.92batch/s] 38%|██████████▎                | 387/1014 [00:11<00:18, 34.82batch/s] 39%|██████████▍                | 393/1014 [00:11<00:17, 34.89batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.96batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.65batch/s] 41%|██████████▉                | 411/1014 [00:11<00:17, 34.65batch/s] 41%|███████████                | 417/1014 [00:12<00:17, 34.60batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 34.59batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.50batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.52batch/s] 43%|███████████▋               | 441/1014 [00:12<00:16, 34.53batch/s] 44%|███████████▉               | 447/1014 [00:12<00:16, 34.49batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 34.53batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.45batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.42batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 34.32batch/s] 47%|████████████▋              | 477/1014 [00:13<00:15, 34.32batch/s] 48%|████████████▊              | 483/1014 [00:14<00:15, 34.37batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.48batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.45batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:14, 34.41batch/s] 50%|█████████████▌             | 507/1014 [00:14<00:14, 34.46batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 34.52batch/s] 51%|█████████████▊             | 519/1014 [00:15<00:14, 34.56batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.26batch/s] 52%|██████████████▏            | 531/1014 [00:15<00:14, 34.25batch/s] 53%|██████████████▎            | 537/1014 [00:15<00:13, 34.24batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.22batch/s] 54%|██████████████▌            | 549/1014 [00:16<00:13, 34.24batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.23batch/s] 55%|██████████████▉            | 561/1014 [00:16<00:13, 34.24batch/s] 56%|███████████████            | 567/1014 [00:16<00:13, 34.24batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.29batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.15batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 34.15batch/s] 58%|███████████████▋           | 591/1014 [00:17<00:12, 34.18batch/s] 59%|███████████████▉           | 597/1014 [00:17<00:12, 34.18batch/s] 59%|████████████████           | 603/1014 [00:17<00:12, 34.22batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.27batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.34batch/s] 61%|████████████████▌          | 621/1014 [00:18<00:11, 34.34batch/s] 62%|████████████████▋          | 627/1014 [00:18<00:11, 34.41batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:11, 34.46batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.50batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.48batch/s] 64%|█████████████████▎         | 651/1014 [00:18<00:10, 34.53batch/s] 65%|█████████████████▍         | 657/1014 [00:19<00:10, 34.52batch/s] 65%|█████████████████▋         | 663/1014 [00:19<00:10, 34.52batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 34.55batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.57batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 34.59batch/s] 68%|██████████████████▎        | 687/1014 [00:19<00:09, 34.58batch/s] 68%|██████████████████▍        | 693/1014 [00:20<00:09, 34.54batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.52batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.54batch/s] 70%|██████████████████▉        | 711/1014 [00:20<00:08, 34.54batch/s] 71%|███████████████████        | 717/1014 [00:20<00:08, 34.54batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 34.55batch/s] 72%|███████████████████▍       | 729/1014 [00:21<00:08, 34.59batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.62batch/s] 73%|███████████████████▋       | 741/1014 [00:21<00:07, 34.63batch/s] 74%|███████████████████▉       | 747/1014 [00:21<00:07, 34.66batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 34.72batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.73batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.73batch/s] 76%|████████████████████▌      | 771/1014 [00:22<00:07, 34.71batch/s] 77%|████████████████████▋      | 777/1014 [00:22<00:06, 34.69batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 34.66batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.66batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.66batch/s] 79%|█████████████████████▎     | 801/1014 [00:23<00:06, 34.67batch/s] 80%|█████████████████████▍     | 807/1014 [00:23<00:05, 34.67batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 34.67batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 34.63batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.64batch/s] 82%|██████████████████████▏    | 831/1014 [00:23<00:05, 34.64batch/s] 83%|██████████████████████▎    | 837/1014 [00:24<00:05, 34.59batch/s] 83%|██████████████████████▍    | 843/1014 [00:24<00:04, 34.61batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.60batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.67batch/s] 85%|██████████████████████▉    | 861/1014 [00:24<00:04, 34.67batch/s] 86%|███████████████████████    | 867/1014 [00:24<00:04, 34.71batch/s] 86%|███████████████████████▏   | 873/1014 [00:25<00:04, 34.71batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.77batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.75batch/s] 88%|███████████████████████▋   | 891/1014 [00:25<00:03, 34.78batch/s] 88%|███████████████████████▉   | 897/1014 [00:25<00:03, 34.75batch/s] 89%|████████████████████████   | 903/1014 [00:25<00:03, 34.76batch/s] 90%|████████████████████████▏  | 909/1014 [00:26<00:03, 34.76batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.77batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 34.78batch/s] 91%|████████████████████████▋  | 927/1014 [00:26<00:02, 34.82batch/s] 92%|████████████████████████▊  | 933/1014 [00:26<00:02, 34.88batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 34.89batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.93batch/s] 94%|█████████████████████████▎ | 951/1014 [00:27<00:01, 34.90batch/s] 94%|█████████████████████████▍ | 957/1014 [00:27<00:01, 34.95batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 34.97batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.97batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 34.98batch/s] 97%|██████████████████████████ | 981/1014 [00:28<00:00, 34.96batch/s] 97%|██████████████████████████▎| 987/1014 [00:28<00:00, 35.01batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 35.01batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.06batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 35.10batch/s]100%|█████████████████████████▉| 1011/1014 [00:28<00:00, 35.11batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.11batch/s]
Validation 10 -> LOSS = 0.42
Validation 10 -> BLEU = 91.50, 96.3/92.8/90.0/87.2 (BP=1.000, ratio=1.004, hyp_len=14445, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.42 @ validation 10
--> Best BLEU so far: 91.50 @ validation 10
Starting Epoch 11
Epoch 11 - update       4830 => loss:   0.508 (#OOM: 0)
Epoch 11 - update       4860 => loss:   0.495 (#OOM: 0)
Epoch 11 - update       4890 => loss:   0.508 (#OOM: 0)
Epoch 11 - update       4920 => loss:   0.466 (#OOM: 0)
Epoch 11 - update       4950 => loss:   0.390 (#OOM: 0)
Epoch 11 - update       4980 => loss:   0.312 (#OOM: 0)
Epoch 11 - update       5010 => loss:   0.504 (#OOM: 0)
Epoch 11 - update       5040 => loss:   0.385 (#OOM: 0)
Epoch 11 - update       5070 => loss:   0.402 (#OOM: 0)
Epoch 11 - update       5100 => loss:   0.515 (#OOM: 0)
Epoch 11 - update       5130 => loss:   0.454 (#OOM: 0)
Epoch 11 - update       5160 => loss:   0.267 (#OOM: 0)
Epoch 11 - update       5190 => loss:   0.520 (#OOM: 0)
Epoch 11 - update       5220 => loss:   0.529 (#OOM: 0)
Epoch 11 - update       5250 => loss:   0.511 (#OOM: 0)
Epoch 11 - update       5280 => loss:   0.492 (#OOM: 0)
--> Epoch 11 finished with mean loss 0.46171
--> Overhead/Training/Evaluation: 0.62/0.72/0.00 mins (total: 1.34 mins)   (674 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 17.72batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.13batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 13.28batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.76batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.97batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.47batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.73batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.59batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.55batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.05batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.62batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.82batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.82batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:23, 42.05batch/s]  1%|▎                           | 10/1014 [00:00<00:23, 42.36batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 36.57batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 36.01batch/s]  2%|▋                           | 25/1014 [00:00<00:27, 36.27batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 35.49batch/s]  3%|▉                           | 35/1014 [00:00<00:26, 36.42batch/s]  4%|█                           | 40/1014 [00:01<00:26, 37.25batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 37.00batch/s]  5%|█▍                          | 50/1014 [00:01<00:25, 37.59batch/s]  5%|█▌                          | 55/1014 [00:01<00:25, 38.00batch/s]  6%|█▋                          | 60/1014 [00:01<00:25, 37.88batch/s]  6%|█▊                          | 65/1014 [00:01<00:24, 37.97batch/s]  7%|█▉                          | 70/1014 [00:01<00:24, 38.61batch/s]  7%|██                          | 75/1014 [00:01<00:24, 38.01batch/s]  8%|██▏                         | 80/1014 [00:02<00:24, 37.86batch/s]  8%|██▎                         | 85/1014 [00:02<00:24, 37.27batch/s]  9%|██▍                         | 90/1014 [00:02<00:24, 37.56batch/s]  9%|██▌                         | 95/1014 [00:02<00:24, 37.17batch/s] 10%|██▋                        | 100/1014 [00:02<00:24, 37.57batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 37.84batch/s] 11%|██▉                        | 110/1014 [00:02<00:23, 37.68batch/s] 11%|███                        | 115/1014 [00:03<00:23, 37.55batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 37.24batch/s] 12%|███▎                       | 125/1014 [00:03<00:23, 37.20batch/s] 13%|███▍                       | 130/1014 [00:03<00:23, 37.45batch/s] 13%|███▌                       | 135/1014 [00:03<00:23, 37.61batch/s] 14%|███▋                       | 140/1014 [00:03<00:23, 37.11batch/s] 14%|███▊                       | 145/1014 [00:03<00:23, 36.83batch/s] 15%|███▉                       | 150/1014 [00:04<00:23, 37.14batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 37.12batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 36.91batch/s] 16%|████▍                      | 165/1014 [00:04<00:22, 36.96batch/s] 17%|████▌                      | 170/1014 [00:04<00:22, 36.89batch/s] 17%|████▋                      | 175/1014 [00:04<00:22, 36.97batch/s] 18%|████▊                      | 180/1014 [00:04<00:22, 36.96batch/s] 18%|████▉                      | 185/1014 [00:05<00:22, 36.78batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 36.64batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 36.54batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 36.47batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 36.38batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 36.20batch/s] 21%|█████▋                     | 215/1014 [00:05<00:22, 36.23batch/s] 22%|█████▊                     | 220/1014 [00:06<00:21, 36.11batch/s] 22%|█████▉                     | 225/1014 [00:06<00:21, 36.13batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 36.23batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 36.28batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.53batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.37batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.34batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.20batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.14batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.15batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.14batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 35.13batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.18batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 35.15batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.17batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.14batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 35.20batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 35.19batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 35.12batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.18batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.12batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.18batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.25batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.25batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 35.26batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:18, 35.27batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.26batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 35.24batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 35.25batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.27batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.25batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 35.18batch/s] 37%|██████████                 | 380/1014 [00:10<00:18, 35.17batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 35.06batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 35.11batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.23batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.06batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 35.11batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.09batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 35.05batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.07batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.07batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.06batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 35.02batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.91batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.95batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 34.86batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.89batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 34.91batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.89batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.94batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.78batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.83batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.80batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.81batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 34.82batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.83batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.91batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.92batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.94batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 34.85batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.91batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 34.92batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.87batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.86batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.79batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.77batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:13, 34.74batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.75batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 34.78batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.79batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.81batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.79batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.81batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 34.77batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.78batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.79batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.75batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.80batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.79batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.78batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 34.81batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.81batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.81batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.80batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.81batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.75batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.75batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 34.78batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.79batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.62batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.66batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.64batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.65batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.66batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.68batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.72batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.72batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.67batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.66batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.69batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.66batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.68batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.66batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.65batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.65batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.62batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.63batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.67batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.70batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.69batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.75batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.76batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.81batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.78batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.80batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.75batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.74batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.74batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.76batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.73batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.77batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.71batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.65batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.62batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.66batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.65batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.67batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.62batch/s] 85%|███████████████████████    | 865/1014 [00:25<00:04, 34.59batch/s] 86%|███████████████████████▏   | 870/1014 [00:25<00:04, 34.58batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.60batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.57batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.55batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.52batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.50batch/s] 89%|███████████████████████▉   | 900/1014 [00:26<00:03, 34.51batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.53batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:03, 34.54batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.56batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.60batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.61batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.63batch/s] 92%|████████████████████████▉  | 935/1014 [00:27<00:02, 34.62batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.59batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.59batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.61batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.63batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.61batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.59batch/s] 96%|█████████████████████████▊ | 970/1014 [00:28<00:01, 34.59batch/s] 96%|█████████████████████████▉ | 975/1014 [00:28<00:01, 34.61batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.63batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.63batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.64batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.62batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.61batch/s] 99%|█████████████████████████▊| 1005/1014 [00:29<00:00, 34.62batch/s]100%|█████████████████████████▉| 1010/1014 [00:29<00:00, 34.63batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.64batch/s]
Validation 11 -> LOSS = 0.40
Validation 11 -> BLEU = 92.07, 96.6/93.3/90.6/88.0 (BP=1.000, ratio=1.003, hyp_len=14418, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.40 @ validation 11
--> Best BLEU so far: 92.07 @ validation 11
Starting Epoch 12
Epoch 12 - update       5310 => loss:   0.294 (#OOM: 0)
Epoch 12 - update       5340 => loss:   0.425 (#OOM: 0)
Epoch 12 - update       5370 => loss:   0.442 (#OOM: 0)
Epoch 12 - update       5400 => loss:   0.469 (#OOM: 0)
Epoch 12 - update       5430 => loss:   0.371 (#OOM: 0)
Epoch 12 - update       5460 => loss:   0.379 (#OOM: 0)
Epoch 12 - update       5490 => loss:   0.571 (#OOM: 0)
Epoch 12 - update       5520 => loss:   0.549 (#OOM: 0)
Epoch 12 - update       5550 => loss:   0.471 (#OOM: 0)
Epoch 12 - update       5580 => loss:   0.433 (#OOM: 0)
Epoch 12 - update       5610 => loss:   0.446 (#OOM: 0)
Epoch 12 - update       5640 => loss:   0.351 (#OOM: 0)
Epoch 12 - update       5670 => loss:   0.332 (#OOM: 0)
Epoch 12 - update       5700 => loss:   0.329 (#OOM: 0)
Epoch 12 - update       5730 => loss:   0.461 (#OOM: 0)
Epoch 12 - update       5760 => loss:   0.713 (#OOM: 0)
--> Epoch 12 finished with mean loss 0.41879
--> Overhead/Training/Evaluation: 0.61/0.71/0.00 mins (total: 1.32 mins)   (680 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 16.75batch/s] 15%|████▌                          | 5/34 [00:00<00:01, 19.32batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 19.23batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 16.03batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 15.63batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 15.79batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:00, 15.68batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 15.33batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.98batch/s] 85%|█████████████████████████▌    | 29/34 [00:01<00:00, 14.80batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 14.23batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.29batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:36, 27.58batch/s]  1%|▏                            | 7/1014 [00:00<00:32, 31.22batch/s]  1%|▎                           | 11/1014 [00:00<00:29, 33.56batch/s]  1%|▍                           | 15/1014 [00:00<00:29, 34.27batch/s]  2%|▌                           | 19/1014 [00:00<00:28, 34.87batch/s]  2%|▋                           | 23/1014 [00:00<00:29, 33.43batch/s]  3%|▋                           | 27/1014 [00:00<00:29, 33.24batch/s]  3%|▊                           | 31/1014 [00:00<00:29, 33.87batch/s]  3%|▉                           | 35/1014 [00:01<00:28, 34.08batch/s]  4%|█                           | 39/1014 [00:01<00:29, 33.36batch/s]  4%|█▏                          | 43/1014 [00:01<00:29, 33.21batch/s]  5%|█▎                          | 48/1014 [00:01<00:28, 33.66batch/s]  5%|█▍                          | 53/1014 [00:01<00:28, 33.32batch/s]  6%|█▌                          | 58/1014 [00:01<00:28, 33.56batch/s]  6%|█▋                          | 63/1014 [00:01<00:28, 33.06batch/s]  7%|█▉                          | 68/1014 [00:02<00:28, 33.34batch/s]  7%|██                          | 73/1014 [00:02<00:27, 33.72batch/s]  8%|██▏                         | 78/1014 [00:02<00:27, 33.45batch/s]  8%|██▎                         | 83/1014 [00:02<00:28, 32.84batch/s]  9%|██▍                         | 88/1014 [00:02<00:27, 33.11batch/s]  9%|██▌                         | 93/1014 [00:02<00:27, 33.27batch/s] 10%|██▋                         | 98/1014 [00:02<00:27, 33.40batch/s] 10%|██▋                        | 103/1014 [00:03<00:27, 33.74batch/s] 11%|██▉                        | 108/1014 [00:03<00:26, 33.87batch/s] 11%|███                        | 113/1014 [00:03<00:26, 34.28batch/s] 12%|███▏                       | 118/1014 [00:03<00:26, 34.20batch/s] 12%|███▎                       | 123/1014 [00:03<00:25, 34.28batch/s] 13%|███▍                       | 128/1014 [00:03<00:25, 34.31batch/s] 13%|███▌                       | 133/1014 [00:03<00:25, 34.32batch/s] 14%|███▋                       | 138/1014 [00:04<00:25, 34.44batch/s] 14%|███▊                       | 143/1014 [00:04<00:25, 34.54batch/s] 15%|███▉                       | 148/1014 [00:04<00:25, 34.58batch/s] 15%|████                       | 153/1014 [00:04<00:24, 34.65batch/s] 16%|████▏                      | 158/1014 [00:04<00:24, 34.69batch/s] 16%|████▎                      | 163/1014 [00:04<00:24, 34.68batch/s] 17%|████▍                      | 168/1014 [00:04<00:24, 34.76batch/s] 17%|████▌                      | 173/1014 [00:04<00:24, 34.72batch/s] 18%|████▋                      | 178/1014 [00:05<00:24, 34.61batch/s] 18%|████▊                      | 183/1014 [00:05<00:24, 34.52batch/s] 19%|█████                      | 188/1014 [00:05<00:23, 34.63batch/s] 19%|█████▏                     | 193/1014 [00:05<00:23, 34.55batch/s] 20%|█████▎                     | 198/1014 [00:05<00:23, 34.50batch/s] 20%|█████▍                     | 203/1014 [00:05<00:23, 34.56batch/s] 21%|█████▌                     | 208/1014 [00:06<00:23, 34.49batch/s] 21%|█████▋                     | 213/1014 [00:06<00:23, 34.48batch/s] 21%|█████▊                     | 218/1014 [00:06<00:23, 34.47batch/s] 22%|█████▉                     | 223/1014 [00:06<00:23, 34.30batch/s] 22%|██████                     | 228/1014 [00:06<00:22, 34.32batch/s] 23%|██████▏                    | 233/1014 [00:06<00:22, 34.40batch/s] 23%|██████▎                    | 238/1014 [00:06<00:22, 34.41batch/s] 24%|██████▍                    | 243/1014 [00:07<00:22, 34.36batch/s] 24%|██████▌                    | 248/1014 [00:07<00:22, 34.33batch/s] 25%|██████▋                    | 253/1014 [00:07<00:22, 34.40batch/s] 25%|██████▊                    | 258/1014 [00:07<00:22, 34.34batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 34.36batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 34.49batch/s] 27%|███████▎                   | 273/1014 [00:07<00:21, 34.56batch/s] 27%|███████▍                   | 278/1014 [00:08<00:21, 34.47batch/s] 28%|███████▌                   | 283/1014 [00:08<00:21, 34.40batch/s] 28%|███████▋                   | 288/1014 [00:08<00:21, 34.40batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 34.53batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 34.38batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 34.40batch/s] 30%|████████▏                  | 308/1014 [00:09<00:20, 34.21batch/s] 31%|████████▎                  | 313/1014 [00:09<00:20, 34.28batch/s] 31%|████████▍                  | 318/1014 [00:09<00:20, 34.30batch/s] 32%|████████▌                  | 323/1014 [00:09<00:20, 34.39batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 34.40batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 34.40batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 34.49batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:19, 34.51batch/s] 34%|█████████▎                 | 348/1014 [00:10<00:19, 34.47batch/s] 35%|█████████▍                 | 353/1014 [00:10<00:19, 34.46batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 34.55batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 34.38batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 34.36batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 34.41batch/s] 37%|██████████                 | 378/1014 [00:10<00:18, 34.45batch/s] 38%|██████████▏                | 383/1014 [00:11<00:18, 34.46batch/s] 38%|██████████▎                | 388/1014 [00:11<00:18, 34.55batch/s] 39%|██████████▍                | 393/1014 [00:11<00:17, 34.65batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 34.59batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 34.58batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 34.61batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 34.61batch/s] 41%|███████████▏               | 418/1014 [00:12<00:17, 34.53batch/s] 42%|███████████▎               | 423/1014 [00:12<00:17, 34.56batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 34.52batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 34.61batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 34.61batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 34.48batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 34.46batch/s] 45%|████████████               | 453/1014 [00:13<00:16, 34.48batch/s] 45%|████████████▏              | 458/1014 [00:13<00:16, 34.47batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 34.51batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 34.56batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 34.58batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 34.56batch/s] 48%|████████████▊              | 483/1014 [00:13<00:15, 34.57batch/s] 48%|████████████▉              | 488/1014 [00:14<00:15, 34.62batch/s] 49%|█████████████▏             | 493/1014 [00:14<00:15, 34.58batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 34.65batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.68batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 34.68batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 34.71batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:14, 34.67batch/s] 52%|█████████████▉             | 523/1014 [00:15<00:14, 34.72batch/s] 52%|██████████████             | 528/1014 [00:15<00:13, 34.77batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 34.72batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 34.75batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 34.75batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 34.71batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:13, 34.72batch/s] 55%|██████████████▊            | 558/1014 [00:16<00:13, 34.69batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:12, 34.72batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 34.73batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 34.75batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 34.76batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 34.76batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 34.81batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.75batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:11, 34.75batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 34.75batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 34.77batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 34.82batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 34.86batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 34.86batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 34.86batch/s] 62%|████████████████▊          | 633/1014 [00:18<00:10, 34.87batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 34.87batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 34.86batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 34.88batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.91batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 34.95batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:10, 34.99batch/s] 66%|█████████████████▊         | 668/1014 [00:19<00:09, 35.04batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.03batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 34.98batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.94batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 34.90batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:09, 34.95batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:09, 34.94batch/s] 69%|██████████████████▋        | 703/1014 [00:20<00:08, 34.95batch/s] 70%|██████████████████▊        | 708/1014 [00:20<00:08, 34.99batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.99batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 34.99batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 35.00batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.00batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:08, 35.05batch/s] 73%|███████████████████▋       | 738/1014 [00:21<00:07, 35.08batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 35.09batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.06batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 35.10batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.07batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.10batch/s] 76%|████████████████████▍      | 768/1014 [00:21<00:07, 35.12batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 35.10batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 35.11batch/s] 77%|████████████████████▊      | 783/1014 [00:22<00:06, 35.12batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 35.17batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.20batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 35.23batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:05, 35.28batch/s] 80%|█████████████████████▌     | 808/1014 [00:22<00:05, 35.30batch/s] 80%|█████████████████████▋     | 813/1014 [00:23<00:05, 35.30batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 35.26batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.23batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 35.22batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.21batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:04, 35.21batch/s] 83%|██████████████████████▍    | 843/1014 [00:23<00:04, 35.24batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 35.27batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.25batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 35.24batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 35.22batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 35.22batch/s] 86%|███████████████████████▏   | 873/1014 [00:24<00:04, 35.23batch/s] 87%|███████████████████████▍   | 878/1014 [00:24<00:03, 35.28batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 35.30batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 35.32batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 35.31batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 35.29batch/s] 89%|████████████████████████   | 903/1014 [00:25<00:03, 35.28batch/s] 90%|████████████████████████▏  | 908/1014 [00:25<00:03, 35.26batch/s] 90%|████████████████████████▎  | 913/1014 [00:25<00:02, 35.27batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 35.29batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 35.27batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 35.28batch/s] 92%|████████████████████████▊  | 933/1014 [00:26<00:02, 35.25batch/s] 93%|████████████████████████▉  | 938/1014 [00:26<00:02, 35.28batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.26batch/s] 93%|█████████████████████████▏ | 948/1014 [00:26<00:01, 35.28batch/s] 94%|█████████████████████████▍ | 953/1014 [00:26<00:01, 35.32batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 35.26batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 35.24batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 35.23batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.20batch/s] 96%|██████████████████████████ | 978/1014 [00:27<00:01, 35.21batch/s] 97%|██████████████████████████▏| 983/1014 [00:27<00:00, 35.26batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 35.26batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 35.27batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 35.27batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.28batch/s] 99%|█████████████████████████▊| 1008/1014 [00:28<00:00, 35.29batch/s]100%|█████████████████████████▉| 1013/1014 [00:28<00:00, 35.27batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.27batch/s]
Validation 12 -> LOSS = 0.38
Validation 12 -> BLEU = 92.59, 97.0/93.8/91.2/88.7 (BP=1.000, ratio=1.000, hyp_len=14376, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.38 @ validation 12
--> Best BLEU so far: 92.59 @ validation 12
Starting Epoch 13
Epoch 13 - update       5790 => loss:   0.415 (#OOM: 0)
Epoch 13 - update       5820 => loss:   0.538 (#OOM: 0)
Epoch 13 - update       5850 => loss:   0.446 (#OOM: 0)
Epoch 13 - update       5880 => loss:   0.451 (#OOM: 0)
Epoch 13 - update       5910 => loss:   0.372 (#OOM: 0)
Epoch 13 - update       5940 => loss:   0.207 (#OOM: 0)
Epoch 13 - update       5970 => loss:   0.391 (#OOM: 0)
Epoch 13 - update       6000 => loss:   0.294 (#OOM: 0)
Epoch 13 - update       6030 => loss:   0.385 (#OOM: 0)
Epoch 13 - update       6060 => loss:   0.405 (#OOM: 0)
Epoch 13 - update       6090 => loss:   0.514 (#OOM: 0)
Epoch 13 - update       6120 => loss:   0.375 (#OOM: 0)
Epoch 13 - update       6150 => loss:   0.319 (#OOM: 0)
Epoch 13 - update       6180 => loss:   0.220 (#OOM: 0)
Epoch 13 - update       6210 => loss:   0.214 (#OOM: 0)
Epoch 13 - update       6240 => loss:   0.257 (#OOM: 0)
--> Epoch 13 finished with mean loss 0.38076
--> Overhead/Training/Evaluation: 0.61/0.70/0.00 mins (total: 1.31 mins)   (695 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:01, 16.56batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.99batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.91batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.23batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 14.66batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 14.19batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.63batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.56batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 13.37batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.33batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.47batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.56batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:24, 41.32batch/s]  1%|▎                           | 10/1014 [00:00<00:23, 43.52batch/s]  1%|▍                           | 15/1014 [00:00<00:24, 40.41batch/s]  2%|▌                           | 20/1014 [00:00<00:23, 41.53batch/s]  2%|▋                           | 25/1014 [00:00<00:24, 40.08batch/s]  3%|▊                           | 30/1014 [00:00<00:24, 39.53batch/s]  3%|▉                           | 35/1014 [00:00<00:25, 38.92batch/s]  4%|█                           | 40/1014 [00:01<00:25, 37.89batch/s]  4%|█▏                          | 45/1014 [00:01<00:25, 38.14batch/s]  5%|█▍                          | 50/1014 [00:01<00:25, 37.61batch/s]  5%|█▌                          | 55/1014 [00:01<00:25, 37.36batch/s]  6%|█▋                          | 60/1014 [00:01<00:25, 36.84batch/s]  6%|█▊                          | 65/1014 [00:01<00:25, 37.49batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 36.86batch/s]  7%|██                          | 76/1014 [00:02<00:24, 37.68batch/s]  8%|██▎                         | 82/1014 [00:02<00:25, 37.28batch/s]  9%|██▍                         | 88/1014 [00:02<00:25, 36.68batch/s]  9%|██▌                         | 94/1014 [00:02<00:24, 36.99batch/s] 10%|██▋                        | 100/1014 [00:02<00:24, 37.17batch/s] 10%|██▊                        | 106/1014 [00:02<00:24, 37.19batch/s] 11%|██▉                        | 112/1014 [00:02<00:24, 37.47batch/s] 12%|███▏                       | 118/1014 [00:03<00:23, 37.49batch/s] 12%|███▎                       | 124/1014 [00:03<00:23, 37.23batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 36.62batch/s] 13%|███▌                       | 136/1014 [00:03<00:23, 36.63batch/s] 14%|███▊                       | 142/1014 [00:03<00:23, 36.64batch/s] 15%|███▉                       | 148/1014 [00:04<00:23, 36.75batch/s] 15%|████                       | 154/1014 [00:04<00:23, 36.51batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 36.10batch/s] 16%|████▍                      | 166/1014 [00:04<00:23, 35.96batch/s] 17%|████▌                      | 172/1014 [00:04<00:23, 36.00batch/s] 18%|████▋                      | 178/1014 [00:04<00:23, 35.96batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.91batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 36.01batch/s] 19%|█████▏                     | 196/1014 [00:05<00:22, 35.76batch/s] 20%|█████▍                     | 202/1014 [00:05<00:22, 35.87batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 35.92batch/s] 21%|█████▋                     | 214/1014 [00:05<00:22, 35.88batch/s] 22%|█████▊                     | 220/1014 [00:06<00:21, 36.15batch/s] 22%|██████                     | 226/1014 [00:06<00:21, 36.13batch/s] 23%|██████▏                    | 232/1014 [00:06<00:21, 36.17batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 36.18batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 36.04batch/s] 25%|██████▋                    | 250/1014 [00:06<00:21, 35.89batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 35.47batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 35.35batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 35.27batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 35.21batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.19batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 35.35batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.39batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 35.27batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.18batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 35.17batch/s] 31%|████████▍                  | 316/1014 [00:08<00:19, 35.16batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 35.10batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 35.20batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.06batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 35.16batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:18, 35.16batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:18, 35.19batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 35.05batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.08batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.14batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 35.05batch/s] 38%|██████████▏                | 382/1014 [00:10<00:18, 35.09batch/s] 38%|██████████▎                | 388/1014 [00:11<00:17, 35.20batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.20batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.01batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 35.07batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 34.97batch/s] 41%|███████████▏               | 418/1014 [00:11<00:17, 34.98batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.03batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.06batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 34.97batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 34.97batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 34.92batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.86batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 34.89batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 34.95batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 34.98batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 34.97batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.97batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.93batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 34.88batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 34.88batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 34.91batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.94batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 34.81batch/s] 52%|██████████████             | 526/1014 [00:15<00:14, 34.83batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 34.82batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 34.77batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.77batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.71batch/s] 55%|██████████████▊            | 556/1014 [00:16<00:13, 34.70batch/s] 55%|██████████████▉            | 562/1014 [00:16<00:13, 34.73batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 34.68batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.71batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.77batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 34.75batch/s] 58%|███████████████▊           | 592/1014 [00:17<00:12, 34.73batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:11, 34.80batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.71batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.70batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 34.66batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 34.76batch/s] 62%|████████████████▋          | 628/1014 [00:18<00:11, 34.68batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.68batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.77batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 34.73batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 34.74batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 34.74batch/s] 65%|█████████████████▋         | 664/1014 [00:19<00:10, 34.75batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.77batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 34.81batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 34.84batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 34.89batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.93batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:08, 34.94batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 34.98batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 34.96batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 34.88batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.82batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 34.80batch/s] 73%|███████████████████▌       | 736/1014 [00:21<00:07, 34.82batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 34.80batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 34.85batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.84batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.82batch/s] 76%|████████████████████▍      | 766/1014 [00:22<00:07, 34.76batch/s] 76%|████████████████████▌      | 772/1014 [00:22<00:06, 34.83batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.79batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.80batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.85batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 34.82batch/s] 79%|█████████████████████▎     | 802/1014 [00:23<00:06, 34.80batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 34.80batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.76batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.74batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 34.73batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 34.70batch/s] 83%|██████████████████████▎    | 838/1014 [00:24<00:05, 34.70batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.73batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.76batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 34.76batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 34.78batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 34.79batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.77batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.84batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 34.82batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 34.85batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.86batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 34.90batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.91batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.93batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 34.97batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.95batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.92batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 34.93batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.92batch/s] 94%|█████████████████████████▎ | 952/1014 [00:27<00:01, 34.94batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.96batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.95batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 34.97batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 34.97batch/s] 97%|██████████████████████████▏| 982/1014 [00:28<00:00, 34.96batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 35.00batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.97batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.97batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 35.00batch/s]100%|█████████████████████████▉| 1012/1014 [00:28<00:00, 34.98batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.00batch/s]
Validation 13 -> LOSS = 0.36
Validation 13 -> BLEU = 93.10, 97.2/94.2/91.8/89.4 (BP=1.000, ratio=1.000, hyp_len=14384, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.36 @ validation 13
--> Best BLEU so far: 93.10 @ validation 13
Starting Epoch 14
Epoch 14 - update       6270 => loss:   0.327 (#OOM: 0)
Epoch 14 - update       6300 => loss:   0.315 (#OOM: 0)
Epoch 14 - update       6330 => loss:   0.353 (#OOM: 0)
Epoch 14 - update       6360 => loss:   0.562 (#OOM: 0)
Epoch 14 - update       6390 => loss:   0.373 (#OOM: 0)
Epoch 14 - update       6420 => loss:   0.309 (#OOM: 0)
Epoch 14 - update       6450 => loss:   0.263 (#OOM: 0)
Epoch 14 - update       6480 => loss:   0.264 (#OOM: 0)
Epoch 14 - update       6510 => loss:   0.317 (#OOM: 0)
Epoch 14 - update       6540 => loss:   0.333 (#OOM: 0)
Epoch 14 - update       6570 => loss:   0.384 (#OOM: 0)
Epoch 14 - update       6600 => loss:   0.500 (#OOM: 0)
Epoch 14 - update       6630 => loss:   0.339 (#OOM: 0)
Epoch 14 - update       6660 => loss:   0.349 (#OOM: 0)
Epoch 14 - update       6690 => loss:   0.296 (#OOM: 0)
Epoch 14 - update       6720 => loss:   0.386 (#OOM: 0)
--> Epoch 14 finished with mean loss 0.35087
--> Overhead/Training/Evaluation: 0.67/0.71/0.00 mins (total: 1.38 mins)   (682 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.93batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.87batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 13.36batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 14.95batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 13.94batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 14.37batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 14.25batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 14.19batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 14.56batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 14.00batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.89batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.31batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.17batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:23, 43.59batch/s]  1%|▎                           | 10/1014 [00:00<00:24, 41.40batch/s]  1%|▍                           | 15/1014 [00:00<00:25, 38.68batch/s]  2%|▌                           | 20/1014 [00:00<00:25, 39.38batch/s]  2%|▋                           | 25/1014 [00:00<00:27, 36.36batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 36.19batch/s]  3%|▉                           | 35/1014 [00:00<00:26, 37.20batch/s]  4%|█                           | 40/1014 [00:01<00:26, 36.16batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 36.18batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.71batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.22batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 35.89batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 35.89batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 36.11batch/s]  7%|██                          | 75/1014 [00:02<00:26, 35.43batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.53batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 35.22batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 34.13batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.52batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.34batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.43batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.17batch/s] 11%|███                        | 115/1014 [00:03<00:26, 34.16batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 34.58batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.73batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.71batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.76batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.76batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.72batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 34.95batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 34.77batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.78batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.90batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 35.04batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.17batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.34batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.31batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.35batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.24batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 35.33batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.23batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.34batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.48batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.35batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 35.48batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 35.34batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 35.32batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.24batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.35batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.38batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.25batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.39batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.46batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.38batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.48batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.58batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 35.59batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.61batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.53batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 35.48batch/s] 30%|████████                   | 305/1014 [00:08<00:19, 35.53batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 35.50batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.34batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.39batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.34batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.45batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.46batch/s] 34%|█████████                  | 340/1014 [00:09<00:18, 35.57batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:18, 35.56batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.68batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 35.43batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 35.29batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.39batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.37batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 35.32batch/s] 37%|██████████                 | 380/1014 [00:10<00:17, 35.36batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 35.30batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 35.27batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.29batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.28batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 35.19batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.08batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 35.01batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.08batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.09batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.10batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 35.13batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.08batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.13batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 35.02batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.91batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.00batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 35.01batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.96batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.94batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.87batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.84batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.74batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 34.74batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.70batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.72batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.73batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.69batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 34.70batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.69batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 34.74batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.78batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.75batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.74batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.71batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:13, 34.76batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.76batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 34.77batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.75batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.72batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.74batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.71batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 34.77batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.79batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.79batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.79batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.76batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.76batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.79batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 34.84batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.82batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.78batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.81batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.81batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.83batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.85batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 34.90batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:09, 34.91batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.94batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.94batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.91batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.90batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.95batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 34.97batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:08, 35.00batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 35.01batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.02batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.00batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.03batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.04batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.02batch/s] 72%|███████████████████▌       | 735/1014 [00:20<00:07, 35.02batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.99batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.05batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 35.03batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.01batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.02batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:07, 35.04batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.07batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 35.09batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 35.07batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.08batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.09batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 35.09batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 35.11batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.12batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 35.10batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 35.03batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.06batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 35.09batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.09batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.09batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.04batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 35.05batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 35.03batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 35.02batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 35.03batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.05batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.10batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.11batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 35.08batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 35.12batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 35.11batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.07batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.06batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.08batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.10batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 35.14batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 35.08batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.02batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.99batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.95batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 34.90batch/s] 93%|█████████████████████████▏ | 945/1014 [00:27<00:01, 34.94batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.92batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 34.93batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 34.97batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.96batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 34.97batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 34.95batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.97batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 35.01batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.98batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.98batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.96batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 34.96batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 34.98batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 34.98batch/s]
Validation 14 -> LOSS = 0.34
Validation 14 -> BLEU = 93.26, 97.3/94.4/92.1/89.8 (BP=0.999, ratio=0.999, hyp_len=14370, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.34 @ validation 14
--> Best BLEU so far: 93.26 @ validation 14
Starting Epoch 15
Epoch 15 - update       6750 => loss:   0.291 (#OOM: 0)
Epoch 15 - update       6780 => loss:   0.251 (#OOM: 0)
Epoch 15 - update       6810 => loss:   0.287 (#OOM: 0)
Epoch 15 - update       6840 => loss:   0.268 (#OOM: 0)
Epoch 15 - update       6870 => loss:   0.369 (#OOM: 0)
Epoch 15 - update       6900 => loss:   0.285 (#OOM: 0)
Epoch 15 - update       6930 => loss:   0.318 (#OOM: 0)
Epoch 15 - update       6960 => loss:   0.260 (#OOM: 0)
Epoch 15 - update       6990 => loss:   0.399 (#OOM: 0)
Epoch 15 - update       7020 => loss:   0.199 (#OOM: 0)
Epoch 15 - update       7050 => loss:   0.341 (#OOM: 0)
Epoch 15 - update       7080 => loss:   0.324 (#OOM: 0)
Epoch 15 - update       7110 => loss:   0.369 (#OOM: 0)
Epoch 15 - update       7140 => loss:   0.249 (#OOM: 0)
Epoch 15 - update       7170 => loss:   0.209 (#OOM: 0)
Epoch 15 - update       7200 => loss:   0.283 (#OOM: 0)
Epoch 15 - update       7230 => loss:   0.379 (#OOM: 0)
--> Epoch 15 finished with mean loss 0.32580
--> Overhead/Training/Evaluation: 0.60/0.71/0.00 mins (total: 1.30 mins)   (684 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  7.84batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.51batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.48batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 14.12batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 15.22batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.37batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 14.32batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.79batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.48batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.86batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 14.03batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 14.08batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.27batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:21, 46.24batch/s]  1%|▎                           | 10/1014 [00:00<00:25, 39.29batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 36.63batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 33.83batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.89batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 35.49batch/s]  3%|▉                           | 35/1014 [00:00<00:27, 35.85batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.63batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.32batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 35.91batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 35.54batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 35.58batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 35.46batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 35.45batch/s]  7%|██                          | 75/1014 [00:02<00:27, 34.39batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 34.37batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 34.25batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 34.35batch/s]  9%|██▌                         | 95/1014 [00:02<00:27, 33.77batch/s] 10%|██▋                        | 100/1014 [00:03<00:27, 32.84batch/s] 10%|██▊                        | 105/1014 [00:03<00:27, 32.71batch/s] 11%|██▉                        | 110/1014 [00:03<00:27, 32.81batch/s] 11%|███                        | 115/1014 [00:03<00:27, 32.68batch/s] 12%|███▏                       | 120/1014 [00:03<00:27, 32.84batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 32.98batch/s] 13%|███▍                       | 130/1014 [00:03<00:26, 33.21batch/s] 13%|███▌                       | 135/1014 [00:04<00:26, 33.26batch/s] 14%|███▋                       | 140/1014 [00:04<00:26, 33.34batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 33.43batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 33.58batch/s] 15%|████▏                      | 155/1014 [00:04<00:25, 33.43batch/s] 16%|████▎                      | 160/1014 [00:04<00:25, 33.35batch/s] 16%|████▍                      | 165/1014 [00:04<00:25, 33.45batch/s] 17%|████▌                      | 170/1014 [00:05<00:25, 33.72batch/s] 17%|████▋                      | 175/1014 [00:05<00:25, 33.54batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 33.51batch/s] 18%|████▉                      | 185/1014 [00:05<00:24, 33.50batch/s] 19%|█████                      | 190/1014 [00:05<00:24, 33.47batch/s] 19%|█████▏                     | 195/1014 [00:05<00:24, 33.28batch/s] 20%|█████▎                     | 200/1014 [00:06<00:24, 33.30batch/s] 20%|█████▍                     | 205/1014 [00:06<00:24, 33.31batch/s] 21%|█████▌                     | 210/1014 [00:06<00:24, 33.45batch/s] 21%|█████▋                     | 215/1014 [00:06<00:23, 33.52batch/s] 22%|█████▊                     | 220/1014 [00:06<00:23, 33.59batch/s] 22%|█████▉                     | 225/1014 [00:06<00:23, 33.65batch/s] 23%|██████                     | 230/1014 [00:06<00:23, 33.84batch/s] 23%|██████▎                    | 235/1014 [00:06<00:23, 33.87batch/s] 24%|██████▍                    | 240/1014 [00:07<00:22, 33.82batch/s] 24%|██████▌                    | 245/1014 [00:07<00:22, 33.71batch/s] 25%|██████▋                    | 250/1014 [00:07<00:22, 33.83batch/s] 25%|██████▊                    | 255/1014 [00:07<00:22, 34.00batch/s] 26%|██████▉                    | 260/1014 [00:07<00:22, 34.03batch/s] 26%|███████                    | 265/1014 [00:07<00:22, 34.04batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.05batch/s] 27%|███████▎                   | 275/1014 [00:08<00:21, 34.12batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 33.88batch/s] 28%|███████▌                   | 285/1014 [00:08<00:21, 33.84batch/s] 29%|███████▋                   | 290/1014 [00:08<00:21, 33.95batch/s] 29%|███████▊                   | 295/1014 [00:08<00:21, 34.05batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.09batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.11batch/s] 31%|████████▎                  | 310/1014 [00:09<00:20, 34.17batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.08batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.06batch/s] 32%|████████▋                  | 325/1014 [00:09<00:20, 34.04batch/s] 33%|████████▊                  | 330/1014 [00:09<00:20, 34.07batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.06batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.02batch/s] 34%|█████████▏                 | 345/1014 [00:10<00:19, 34.11batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.15batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.11batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:19, 34.10batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.16batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.20batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.21batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.23batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.14batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.15batch/s] 39%|██████████▌                | 395/1014 [00:11<00:18, 34.26batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.27batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.35batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.33batch/s] 41%|███████████                | 415/1014 [00:12<00:17, 34.37batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.38batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.39batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.48batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.46batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.46batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.32batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.14batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.14batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.08batch/s] 46%|████████████▍              | 465/1014 [00:13<00:16, 34.09batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.11batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.07batch/s] 47%|████████████▊              | 480/1014 [00:14<00:15, 34.06batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.06batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.02batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.02batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:15, 34.09batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.06batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.05batch/s] 51%|█████████████▋             | 515/1014 [00:15<00:14, 34.07batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.10batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.11batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 34.15batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:14, 34.14batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.15batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.16batch/s] 54%|██████████████▋            | 550/1014 [00:16<00:13, 34.15batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.19batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.21batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 34.08batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:13, 34.10batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.03batch/s] 57%|███████████████▍           | 580/1014 [00:17<00:12, 34.06batch/s] 58%|███████████████▌           | 585/1014 [00:17<00:12, 34.04batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.03batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.08batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:12, 34.07batch/s] 60%|████████████████           | 605/1014 [00:17<00:12, 34.07batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.12batch/s] 61%|████████████████▍          | 615/1014 [00:18<00:11, 34.11batch/s] 61%|████████████████▌          | 620/1014 [00:18<00:11, 34.18batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.15batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.20batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:11, 34.22batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.25batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.28batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.27batch/s] 65%|█████████████████▍         | 655/1014 [00:19<00:10, 34.32batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.35batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.33batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:10, 34.37batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.37batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.44batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.47batch/s] 68%|██████████████████▎        | 690/1014 [00:20<00:09, 34.45batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.49batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.58batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.60batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.58batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.58batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.57batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.63batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:07, 34.65batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.62batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.61batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.56batch/s] 75%|████████████████████▎      | 761/1014 [00:22<00:07, 34.57batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.60batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.58batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.58batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.57batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.59batch/s] 79%|█████████████████████▏     | 797/1014 [00:23<00:06, 34.62batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.68batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.70batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.74batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.74batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.71batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 34.74batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.73batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.69batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.64batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.66batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.69batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.70batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:04, 34.67batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.70batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.70batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.65batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.67batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.68batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.72batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.71batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.71batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.71batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.65batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.69batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.66batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.66batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.68batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.70batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 34.69batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.74batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.75batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.72batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.68batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.66batch/s] 99%|█████████████████████████▊| 1007/1014 [00:29<00:00, 34.67batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.63batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.64batch/s]
Validation 15 -> LOSS = 0.33
Validation 15 -> BLEU = 93.75, 97.5/94.8/92.6/90.4 (BP=1.000, ratio=1.000, hyp_len=14379, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.33 @ validation 15
--> Best BLEU so far: 93.75 @ validation 15
Starting Epoch 16
Epoch 16 - update       7260 => loss:   0.363 (#OOM: 0)
Epoch 16 - update       7290 => loss:   0.405 (#OOM: 0)
Epoch 16 - update       7320 => loss:   0.276 (#OOM: 0)
Epoch 16 - update       7350 => loss:   0.354 (#OOM: 0)
Epoch 16 - update       7380 => loss:   0.272 (#OOM: 0)
Epoch 16 - update       7410 => loss:   0.327 (#OOM: 0)
Epoch 16 - update       7440 => loss:   0.291 (#OOM: 0)
Epoch 16 - update       7470 => loss:   0.227 (#OOM: 0)
Epoch 16 - update       7500 => loss:   0.283 (#OOM: 0)
Epoch 16 - update       7530 => loss:   0.227 (#OOM: 0)
Epoch 16 - update       7560 => loss:   0.414 (#OOM: 0)
Epoch 16 - update       7590 => loss:   0.245 (#OOM: 0)
Epoch 16 - update       7620 => loss:   0.273 (#OOM: 0)
Epoch 16 - update       7650 => loss:   0.201 (#OOM: 0)
Epoch 16 - update       7680 => loss:   0.303 (#OOM: 0)
Epoch 16 - update       7710 => loss:   0.336 (#OOM: 0)
--> Epoch 16 finished with mean loss 0.30011
--> Overhead/Training/Evaluation: 0.60/0.70/0.00 mins (total: 1.30 mins)   (692 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 14.31batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.06batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 15.48batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 14.65batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.68batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.96batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.25batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.39batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.38batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.03batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.60batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.03batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.02batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:31, 32.50batch/s]  1%|▏                            | 8/1014 [00:00<00:32, 30.57batch/s]  1%|▎                           | 12/1014 [00:00<00:33, 29.99batch/s]  2%|▍                           | 16/1014 [00:00<00:31, 31.54batch/s]  2%|▌                           | 20/1014 [00:00<00:31, 31.44batch/s]  2%|▋                           | 25/1014 [00:00<00:30, 32.87batch/s]  3%|▊                           | 30/1014 [00:00<00:30, 31.95batch/s]  3%|▉                           | 35/1014 [00:01<00:31, 31.41batch/s]  4%|█                           | 40/1014 [00:01<00:30, 31.70batch/s]  4%|█▏                          | 45/1014 [00:01<00:29, 32.59batch/s]  5%|█▍                          | 50/1014 [00:01<00:29, 32.75batch/s]  5%|█▌                          | 55/1014 [00:01<00:29, 32.56batch/s]  6%|█▋                          | 60/1014 [00:01<00:29, 32.75batch/s]  6%|█▊                          | 65/1014 [00:01<00:28, 33.18batch/s]  7%|█▉                          | 70/1014 [00:02<00:28, 33.31batch/s]  7%|██                          | 75/1014 [00:02<00:27, 33.69batch/s]  8%|██▏                         | 80/1014 [00:02<00:27, 33.77batch/s]  8%|██▎                         | 85/1014 [00:02<00:27, 33.97batch/s]  9%|██▍                         | 90/1014 [00:02<00:27, 34.15batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.22batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 33.99batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 33.82batch/s] 11%|██▉                        | 110/1014 [00:03<00:26, 34.03batch/s] 11%|███                        | 115/1014 [00:03<00:26, 34.14batch/s] 12%|███▏                       | 120/1014 [00:03<00:26, 33.90batch/s] 12%|███▎                       | 125/1014 [00:03<00:26, 33.86batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.01batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 34.26batch/s] 14%|███▋                       | 140/1014 [00:04<00:25, 34.36batch/s] 14%|███▊                       | 145/1014 [00:04<00:25, 34.40batch/s] 15%|███▉                       | 150/1014 [00:04<00:25, 34.27batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 34.51batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 34.48batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 34.32batch/s] 17%|████▌                      | 170/1014 [00:04<00:24, 34.32batch/s] 17%|████▋                      | 175/1014 [00:05<00:24, 34.41batch/s] 18%|████▊                      | 180/1014 [00:05<00:24, 34.55batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 34.74batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 34.97batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.10batch/s] 20%|█████▎                     | 200/1014 [00:05<00:23, 35.24batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.19batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.16batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.09batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.02batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 35.06batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.91batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 35.01batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 35.04batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.09batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 34.92batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 34.85batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 34.76batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 34.71batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 34.70batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 34.68batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.79batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 34.81batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.86batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.76batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.55batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.55batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.53batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.57batch/s] 32%|████████▌                  | 320/1014 [00:09<00:20, 34.53batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.58batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.59batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 34.62batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.66batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 34.61batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.66batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.62batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.62batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.54batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.47batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.46batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.51batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.56batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.64batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.63batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.57batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.51batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.51batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 34.59batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.57batch/s] 42%|███████████▎               | 425/1014 [00:12<00:17, 34.48batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.53batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.59batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.60batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.59batch/s] 44%|███████████▉               | 450/1014 [00:13<00:16, 34.53batch/s] 45%|████████████               | 455/1014 [00:13<00:16, 34.55batch/s] 45%|████████████▏              | 460/1014 [00:13<00:16, 34.58batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.56batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.53batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.50batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.53batch/s] 48%|████████████▉              | 485/1014 [00:14<00:15, 34.44batch/s] 48%|█████████████              | 490/1014 [00:14<00:15, 34.47batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:15, 34.51batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 34.56batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 34.56batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.33batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.34batch/s] 51%|█████████████▊             | 520/1014 [00:15<00:14, 34.31batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:14, 34.32batch/s] 52%|██████████████             | 530/1014 [00:15<00:14, 34.41batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.38batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 34.43batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.47batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.48batch/s] 55%|██████████████▊            | 555/1014 [00:16<00:13, 34.48batch/s] 55%|██████████████▉            | 560/1014 [00:16<00:13, 34.48batch/s] 56%|███████████████            | 565/1014 [00:16<00:13, 34.44batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 34.49batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.46batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.44batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.47batch/s] 58%|███████████████▋           | 590/1014 [00:17<00:12, 34.45batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.48batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.51batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.50batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.52batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.60batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.62batch/s] 62%|████████████████▋          | 625/1014 [00:18<00:11, 34.57batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.59batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.63batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.66batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.70batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.68batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.66batch/s] 65%|█████████████████▌         | 660/1014 [00:19<00:10, 34.66batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.71batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.72batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.76batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.73batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.76batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.67batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.67batch/s] 69%|██████████████████▋        | 700/1014 [00:20<00:09, 34.67batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 34.66batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 34.67batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 34.71batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 34.72batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.72batch/s] 72%|███████████████████▍       | 730/1014 [00:21<00:08, 34.74batch/s] 72%|███████████████████▌       | 735/1014 [00:21<00:08, 34.67batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.63batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 34.66batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 34.69batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.70batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 34.62batch/s] 75%|████████████████████▎      | 765/1014 [00:22<00:07, 34.64batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:07, 34.64batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 34.65batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 34.67batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.69batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.73batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 34.75batch/s] 79%|█████████████████████▎     | 800/1014 [00:23<00:06, 34.76batch/s] 79%|█████████████████████▍     | 805/1014 [00:23<00:06, 34.79batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 34.77batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.78batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 34.75batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 34.74batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.72batch/s] 82%|██████████████████████▏    | 835/1014 [00:24<00:05, 34.75batch/s] 83%|██████████████████████▎    | 840/1014 [00:24<00:05, 34.73batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.77batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.78batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 34.81batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.86batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 34.88batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 34.90batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.92batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.95batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 34.98batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.98batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 34.99batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 34.99batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 34.97batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.96batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 34.97batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.95batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 34.96batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 34.99batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.99batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.01batch/s] 93%|█████████████████████████▏ | 945/1014 [00:26<00:01, 35.05batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 35.05batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.08batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 35.08batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.10batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.10batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 35.10batch/s] 97%|██████████████████████████ | 980/1014 [00:27<00:00, 35.12batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 35.14batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 35.14batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 35.16batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 35.18batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 35.17batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 35.20batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.22batch/s]
Validation 16 -> LOSS = 0.32
Validation 16 -> BLEU = 93.43, 97.0/94.4/92.3/90.1 (BP=1.000, ratio=1.006, hyp_len=14464, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.32 @ validation 16
--> Best BLEU so far: 93.75 @ validation 15
Starting Epoch 17
Epoch 17 - update       7740 => loss:   0.304 (#OOM: 0)
Epoch 17 - update       7770 => loss:   0.217 (#OOM: 0)
Epoch 17 - update       7800 => loss:   0.257 (#OOM: 0)
Epoch 17 - update       7830 => loss:   0.272 (#OOM: 0)
Epoch 17 - update       7860 => loss:   0.215 (#OOM: 0)
Epoch 17 - update       7890 => loss:   0.288 (#OOM: 0)
Epoch 17 - update       7920 => loss:   0.337 (#OOM: 0)
Epoch 17 - update       7950 => loss:   0.323 (#OOM: 0)
Epoch 17 - update       7980 => loss:   0.221 (#OOM: 0)
Epoch 17 - update       8010 => loss:   0.239 (#OOM: 0)
Epoch 17 - update       8040 => loss:   0.205 (#OOM: 0)
Epoch 17 - update       8070 => loss:   0.334 (#OOM: 0)
Epoch 17 - update       8100 => loss:   0.517 (#OOM: 0)
Epoch 17 - update       8130 => loss:   0.264 (#OOM: 0)
Epoch 17 - update       8160 => loss:   0.266 (#OOM: 0)
Epoch 17 - update       8190 => loss:   0.241 (#OOM: 0)
--> Epoch 17 finished with mean loss 0.27935
--> Overhead/Training/Evaluation: 0.61/0.70/0.00 mins (total: 1.31 mins)   (691 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.49batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.46batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.60batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 13.47batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 12.44batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.69batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.01batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.33batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.09batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.99batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.08batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.08batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:36, 27.84batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 35.49batch/s]  1%|▎                           | 13/1014 [00:00<00:30, 32.78batch/s]  2%|▍                           | 18/1014 [00:00<00:29, 34.31batch/s]  2%|▋                           | 23/1014 [00:00<00:28, 35.26batch/s]  3%|▊                           | 28/1014 [00:00<00:27, 35.26batch/s]  3%|▉                           | 33/1014 [00:00<00:27, 35.74batch/s]  4%|█                           | 38/1014 [00:01<00:26, 36.24batch/s]  4%|█▏                          | 43/1014 [00:01<00:26, 36.28batch/s]  5%|█▎                          | 48/1014 [00:01<00:26, 36.25batch/s]  5%|█▍                          | 53/1014 [00:01<00:26, 36.41batch/s]  6%|█▌                          | 58/1014 [00:01<00:26, 36.50batch/s]  6%|█▋                          | 63/1014 [00:01<00:25, 37.05batch/s]  7%|█▉                          | 68/1014 [00:01<00:25, 37.26batch/s]  7%|██                          | 73/1014 [00:01<00:25, 36.61batch/s]  8%|██▏                         | 78/1014 [00:02<00:25, 36.76batch/s]  8%|██▎                         | 83/1014 [00:02<00:25, 36.60batch/s]  9%|██▍                         | 88/1014 [00:02<00:25, 36.80batch/s]  9%|██▌                         | 93/1014 [00:02<00:25, 36.80batch/s] 10%|██▋                         | 98/1014 [00:02<00:24, 36.93batch/s] 10%|██▋                        | 103/1014 [00:02<00:24, 36.94batch/s] 11%|██▉                        | 108/1014 [00:02<00:24, 37.30batch/s] 11%|███                        | 113/1014 [00:03<00:24, 37.35batch/s] 12%|███▏                       | 118/1014 [00:03<00:24, 36.91batch/s] 12%|███▎                       | 123/1014 [00:03<00:24, 36.94batch/s] 13%|███▍                       | 128/1014 [00:03<00:23, 36.94batch/s] 13%|███▌                       | 133/1014 [00:03<00:23, 36.96batch/s] 14%|███▋                       | 138/1014 [00:03<00:23, 36.91batch/s] 14%|███▊                       | 143/1014 [00:03<00:23, 36.65batch/s] 15%|███▉                       | 148/1014 [00:04<00:23, 36.54batch/s] 15%|████                       | 153/1014 [00:04<00:23, 36.63batch/s] 16%|████▏                      | 158/1014 [00:04<00:23, 36.75batch/s] 16%|████▎                      | 163/1014 [00:04<00:23, 36.45batch/s] 17%|████▍                      | 168/1014 [00:04<00:23, 36.55batch/s] 17%|████▌                      | 173/1014 [00:04<00:23, 36.54batch/s] 18%|████▋                      | 178/1014 [00:04<00:23, 36.34batch/s] 18%|████▊                      | 183/1014 [00:05<00:22, 36.35batch/s] 19%|█████                      | 188/1014 [00:05<00:22, 36.34batch/s] 19%|█████▏                     | 193/1014 [00:05<00:22, 36.28batch/s] 20%|█████▎                     | 198/1014 [00:05<00:22, 36.28batch/s] 20%|█████▍                     | 203/1014 [00:05<00:22, 36.30batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 36.05batch/s] 21%|█████▋                     | 213/1014 [00:05<00:22, 35.92batch/s] 21%|█████▊                     | 218/1014 [00:06<00:22, 36.05batch/s] 22%|█████▉                     | 223/1014 [00:06<00:21, 36.19batch/s] 22%|██████                     | 228/1014 [00:06<00:21, 36.22batch/s] 23%|██████▏                    | 233/1014 [00:06<00:21, 36.43batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 36.36batch/s] 24%|██████▍                    | 243/1014 [00:06<00:21, 36.09batch/s] 24%|██████▌                    | 248/1014 [00:06<00:21, 36.21batch/s] 25%|██████▋                    | 253/1014 [00:06<00:21, 36.16batch/s] 25%|██████▊                    | 258/1014 [00:07<00:20, 36.20batch/s] 26%|███████                    | 263/1014 [00:07<00:20, 36.28batch/s] 26%|███████▏                   | 268/1014 [00:07<00:20, 36.17batch/s] 27%|███████▎                   | 273/1014 [00:07<00:20, 36.24batch/s] 27%|███████▍                   | 278/1014 [00:07<00:20, 36.28batch/s] 28%|███████▌                   | 283/1014 [00:07<00:20, 36.34batch/s] 28%|███████▋                   | 288/1014 [00:07<00:20, 36.26batch/s] 29%|███████▊                   | 293/1014 [00:08<00:19, 36.33batch/s] 29%|███████▉                   | 298/1014 [00:08<00:19, 36.39batch/s] 30%|████████                   | 303/1014 [00:08<00:19, 36.36batch/s] 30%|████████▏                  | 308/1014 [00:08<00:19, 36.38batch/s] 31%|████████▎                  | 313/1014 [00:08<00:19, 36.39batch/s] 31%|████████▍                  | 318/1014 [00:08<00:19, 36.28batch/s] 32%|████████▌                  | 323/1014 [00:08<00:19, 36.27batch/s] 32%|████████▋                  | 328/1014 [00:09<00:18, 36.25batch/s] 33%|████████▊                  | 333/1014 [00:09<00:18, 36.25batch/s] 33%|█████████                  | 338/1014 [00:09<00:18, 36.27batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:18, 36.27batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:18, 36.30batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:18, 36.34batch/s] 35%|█████████▌                 | 358/1014 [00:09<00:18, 36.41batch/s] 36%|█████████▋                 | 363/1014 [00:09<00:17, 36.34batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:17, 36.37batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:17, 36.35batch/s] 37%|██████████                 | 378/1014 [00:10<00:17, 36.39batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 36.27batch/s] 38%|██████████▎                | 388/1014 [00:10<00:17, 36.37batch/s] 39%|██████████▍                | 393/1014 [00:10<00:17, 36.29batch/s] 39%|██████████▌                | 398/1014 [00:10<00:16, 36.27batch/s] 40%|██████████▋                | 403/1014 [00:11<00:16, 36.31batch/s] 40%|██████████▊                | 408/1014 [00:11<00:16, 36.37batch/s] 41%|██████████▉                | 413/1014 [00:11<00:16, 36.39batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 36.29batch/s] 42%|███████████▎               | 423/1014 [00:11<00:16, 36.31batch/s] 42%|███████████▍               | 428/1014 [00:11<00:16, 36.34batch/s] 43%|███████████▌               | 433/1014 [00:11<00:15, 36.39batch/s] 43%|███████████▋               | 438/1014 [00:12<00:15, 36.35batch/s] 44%|███████████▊               | 443/1014 [00:12<00:15, 36.35batch/s] 44%|███████████▉               | 448/1014 [00:12<00:15, 36.42batch/s] 45%|████████████               | 453/1014 [00:12<00:15, 36.46batch/s] 45%|████████████▏              | 458/1014 [00:12<00:15, 36.41batch/s] 46%|████████████▎              | 463/1014 [00:12<00:15, 36.52batch/s] 46%|████████████▍              | 468/1014 [00:12<00:14, 36.48batch/s] 47%|████████████▌              | 473/1014 [00:12<00:14, 36.52batch/s] 47%|████████████▋              | 478/1014 [00:13<00:14, 36.43batch/s] 48%|████████████▊              | 483/1014 [00:13<00:14, 36.35batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 36.30batch/s] 49%|█████████████▏             | 493/1014 [00:13<00:14, 36.29batch/s] 49%|█████████████▎             | 498/1014 [00:13<00:14, 36.27batch/s] 50%|█████████████▍             | 503/1014 [00:13<00:14, 36.20batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:13, 36.15batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:13, 36.15batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:13, 36.09batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.98batch/s] 52%|██████████████             | 528/1014 [00:14<00:13, 35.90batch/s] 53%|██████████████▏            | 533/1014 [00:14<00:13, 35.84batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.85batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 35.82batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.77batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:12, 35.80batch/s] 55%|██████████████▊            | 558/1014 [00:15<00:12, 35.78batch/s] 56%|██████████████▉            | 563/1014 [00:15<00:12, 35.80batch/s] 56%|███████████████            | 568/1014 [00:15<00:12, 35.79batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 35.77batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.76batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.73batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:11, 35.78batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 35.82batch/s] 59%|███████████████▉           | 598/1014 [00:16<00:11, 35.81batch/s] 59%|████████████████           | 603/1014 [00:16<00:11, 35.84batch/s] 60%|████████████████▏          | 608/1014 [00:16<00:11, 35.84batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.89batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 35.83batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:10, 35.73batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:10, 35.77batch/s] 62%|████████████████▊          | 633/1014 [00:17<00:10, 35.71batch/s] 63%|████████████████▉          | 638/1014 [00:17<00:10, 35.72batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.72batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 35.70batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 35.73batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:09, 35.79batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:09, 35.74batch/s] 66%|█████████████████▊         | 668/1014 [00:18<00:09, 35.72batch/s] 66%|█████████████████▉         | 673/1014 [00:18<00:09, 35.74batch/s] 67%|██████████████████         | 678/1014 [00:18<00:09, 35.75batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 35.76batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.82batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:08, 35.80batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.84batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 35.86batch/s] 70%|██████████████████▊        | 708/1014 [00:19<00:08, 35.83batch/s] 70%|██████████████████▉        | 713/1014 [00:19<00:08, 35.82batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.79batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 35.77batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:07, 35.79batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:07, 35.80batch/s] 73%|███████████████████▋       | 738/1014 [00:20<00:07, 35.81batch/s] 73%|███████████████████▊       | 743/1014 [00:20<00:07, 35.75batch/s] 74%|███████████████████▉       | 748/1014 [00:20<00:07, 35.73batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 35.71batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.71batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.73batch/s] 76%|████████████████████▍      | 768/1014 [00:21<00:06, 35.73batch/s] 76%|████████████████████▌      | 773/1014 [00:21<00:06, 35.69batch/s] 77%|████████████████████▋      | 778/1014 [00:21<00:06, 35.70batch/s] 77%|████████████████████▊      | 783/1014 [00:21<00:06, 35.71batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 35.72batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.70batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 35.73batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:05, 35.75batch/s] 80%|█████████████████████▌     | 808/1014 [00:22<00:05, 35.75batch/s] 80%|█████████████████████▋     | 813/1014 [00:22<00:05, 35.77batch/s] 81%|█████████████████████▊     | 818/1014 [00:22<00:05, 35.76batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.77batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 35.76batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.72batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:04, 35.73batch/s] 83%|██████████████████████▍    | 843/1014 [00:23<00:04, 35.76batch/s] 84%|██████████████████████▌    | 848/1014 [00:23<00:04, 35.72batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.53batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 35.54batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 35.52batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 35.49batch/s] 86%|███████████████████████▏   | 873/1014 [00:24<00:03, 35.48batch/s] 87%|███████████████████████▍   | 878/1014 [00:24<00:03, 35.47batch/s] 87%|███████████████████████▌   | 883/1014 [00:24<00:03, 35.51batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 35.48batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 35.49batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 35.45batch/s] 89%|████████████████████████   | 903/1014 [00:25<00:03, 35.45batch/s] 90%|████████████████████████▏  | 908/1014 [00:25<00:02, 35.47batch/s] 90%|████████████████████████▎  | 913/1014 [00:25<00:02, 35.48batch/s] 91%|████████████████████████▍  | 918/1014 [00:25<00:02, 35.47batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 35.47batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 35.50batch/s] 92%|████████████████████████▊  | 933/1014 [00:26<00:02, 35.46batch/s] 93%|████████████████████████▉  | 938/1014 [00:26<00:02, 35.43batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.46batch/s] 93%|█████████████████████████▏ | 948/1014 [00:26<00:01, 35.38batch/s] 94%|█████████████████████████▍ | 953/1014 [00:26<00:01, 35.39batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 35.39batch/s] 95%|█████████████████████████▋ | 963/1014 [00:27<00:01, 35.38batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 35.39batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.39batch/s] 96%|██████████████████████████ | 978/1014 [00:27<00:01, 35.37batch/s] 97%|██████████████████████████▏| 983/1014 [00:27<00:00, 35.35batch/s] 97%|██████████████████████████▎| 988/1014 [00:27<00:00, 35.35batch/s] 98%|██████████████████████████▍| 993/1014 [00:28<00:00, 35.37batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 35.34batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.29batch/s] 99%|█████████████████████████▊| 1008/1014 [00:28<00:00, 35.30batch/s]100%|█████████████████████████▉| 1013/1014 [00:28<00:00, 35.28batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.29batch/s]
Validation 17 -> LOSS = 0.32
Validation 17 -> BLEU = 93.74, 97.2/94.7/92.6/90.6 (BP=1.000, ratio=1.004, hyp_len=14438, ref_len=14382)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.32 @ validation 16
--> Best BLEU so far: 93.75 @ validation 15
Starting Epoch 18
Epoch 18 - update       8220 => loss:   0.191 (#OOM: 0)
Epoch 18 - update       8250 => loss:   0.190 (#OOM: 0)
Epoch 18 - update       8280 => loss:   0.234 (#OOM: 0)
Epoch 18 - update       8310 => loss:   0.315 (#OOM: 0)
Epoch 18 - update       8340 => loss:   0.152 (#OOM: 0)
Epoch 18 - update       8370 => loss:   0.201 (#OOM: 0)
Epoch 18 - update       8400 => loss:   0.222 (#OOM: 0)
Epoch 18 - update       8430 => loss:   0.366 (#OOM: 0)
Epoch 18 - update       8460 => loss:   0.214 (#OOM: 0)
Epoch 18 - update       8490 => loss:   0.223 (#OOM: 0)
Epoch 18 - update       8520 => loss:   0.320 (#OOM: 0)
Epoch 18 - update       8550 => loss:   0.343 (#OOM: 0)
Epoch 18 - update       8580 => loss:   0.341 (#OOM: 0)
Epoch 18 - update       8610 => loss:   0.231 (#OOM: 0)
Epoch 18 - update       8640 => loss:   0.253 (#OOM: 0)
Epoch 18 - update       8670 => loss:   0.406 (#OOM: 0)
--> Epoch 18 finished with mean loss 0.26239
--> Overhead/Training/Evaluation: 0.64/0.71/0.00 mins (total: 1.35 mins)   (684 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  8.08batch/s]  9%|██▋                            | 3/34 [00:00<00:03,  9.34batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 10.13batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.38batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.13batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.71batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 11.69batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 12.57batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.41batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.82batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 12.84batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.02batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.29batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:33, 30.28batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.24batch/s]  1%|▎                           | 12/1014 [00:00<00:30, 33.32batch/s]  2%|▍                           | 17/1014 [00:00<00:28, 35.37batch/s]  2%|▌                           | 22/1014 [00:00<00:27, 35.83batch/s]  3%|▋                           | 27/1014 [00:00<00:27, 36.23batch/s]  3%|▉                           | 32/1014 [00:00<00:27, 36.11batch/s]  4%|█                           | 37/1014 [00:01<00:26, 36.47batch/s]  4%|█▏                          | 42/1014 [00:01<00:27, 35.93batch/s]  5%|█▎                          | 47/1014 [00:01<00:26, 35.82batch/s]  5%|█▍                          | 52/1014 [00:01<00:26, 35.93batch/s]  6%|█▌                          | 57/1014 [00:01<00:26, 35.45batch/s]  6%|█▋                          | 62/1014 [00:01<00:26, 35.84batch/s]  7%|█▊                          | 67/1014 [00:01<00:26, 35.11batch/s]  7%|█▉                          | 72/1014 [00:02<00:26, 35.43batch/s]  8%|██▏                         | 77/1014 [00:02<00:26, 35.61batch/s]  8%|██▎                         | 82/1014 [00:02<00:25, 36.10batch/s]  9%|██▍                         | 87/1014 [00:02<00:25, 36.17batch/s]  9%|██▌                         | 92/1014 [00:02<00:25, 35.93batch/s] 10%|██▋                         | 97/1014 [00:02<00:25, 36.07batch/s] 10%|██▋                        | 102/1014 [00:02<00:25, 36.04batch/s] 11%|██▊                        | 107/1014 [00:02<00:25, 35.85batch/s] 11%|██▉                        | 112/1014 [00:03<00:25, 35.62batch/s] 12%|███                        | 117/1014 [00:03<00:25, 35.64batch/s] 12%|███▏                       | 122/1014 [00:03<00:24, 35.83batch/s] 13%|███▍                       | 127/1014 [00:03<00:24, 35.86batch/s] 13%|███▌                       | 132/1014 [00:03<00:24, 35.83batch/s] 14%|███▋                       | 137/1014 [00:03<00:24, 35.99batch/s] 14%|███▊                       | 142/1014 [00:03<00:24, 35.97batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 36.11batch/s] 15%|████                       | 152/1014 [00:04<00:23, 36.03batch/s] 15%|████▏                      | 157/1014 [00:04<00:23, 36.11batch/s] 16%|████▎                      | 162/1014 [00:04<00:23, 36.26batch/s] 16%|████▍                      | 167/1014 [00:04<00:23, 36.02batch/s] 17%|████▌                      | 172/1014 [00:04<00:23, 35.81batch/s] 17%|████▋                      | 177/1014 [00:04<00:23, 35.85batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 35.88batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 35.86batch/s] 19%|█████                      | 192/1014 [00:05<00:22, 35.98batch/s] 19%|█████▏                     | 197/1014 [00:05<00:22, 36.05batch/s] 20%|█████▍                     | 202/1014 [00:05<00:22, 35.96batch/s] 20%|█████▌                     | 207/1014 [00:05<00:22, 35.89batch/s] 21%|█████▋                     | 212/1014 [00:05<00:22, 35.98batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 35.75batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 35.83batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 35.66batch/s] 23%|██████▏                    | 232/1014 [00:06<00:21, 35.57batch/s] 23%|██████▎                    | 237/1014 [00:06<00:21, 35.55batch/s] 24%|██████▍                    | 242/1014 [00:06<00:21, 35.53batch/s] 24%|██████▌                    | 248/1014 [00:06<00:21, 35.69batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 35.80batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.81batch/s] 26%|███████                    | 266/1014 [00:07<00:20, 35.79batch/s] 27%|███████▏                   | 272/1014 [00:07<00:20, 35.66batch/s] 27%|███████▍                   | 278/1014 [00:07<00:20, 35.59batch/s] 28%|███████▌                   | 284/1014 [00:08<00:20, 35.47batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.51batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 35.47batch/s] 30%|████████                   | 302/1014 [00:08<00:20, 35.29batch/s] 30%|████████▏                  | 308/1014 [00:08<00:20, 35.22batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.20batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.23batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 35.20batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 35.22batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 35.25batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:18, 35.32batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.14batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:18, 35.03batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 35.03batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 35.04batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.05batch/s] 37%|██████████                 | 380/1014 [00:10<00:18, 34.94batch/s] 38%|██████████▎                | 386/1014 [00:11<00:17, 35.02batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 34.95batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 34.91batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.96batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.01batch/s] 41%|███████████                | 416/1014 [00:11<00:17, 35.09batch/s] 42%|███████████▏               | 422/1014 [00:12<00:16, 35.16batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 35.05batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.06batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.13batch/s] 44%|███████████▉               | 446/1014 [00:12<00:16, 35.03batch/s] 45%|████████████               | 452/1014 [00:12<00:16, 35.09batch/s] 45%|████████████▏              | 458/1014 [00:13<00:15, 35.07batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.12batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 35.14batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 35.05batch/s] 48%|████████████▊              | 482/1014 [00:13<00:15, 35.08batch/s] 48%|████████████▉              | 488/1014 [00:13<00:15, 35.02batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 35.00batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.06batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 35.03batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 35.10batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:14, 35.01batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.01batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 35.07batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 35.07batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 35.02batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.06batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.08batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.12batch/s] 56%|███████████████            | 566/1014 [00:16<00:12, 35.12batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 35.16batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.16batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.09batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 35.05batch/s] 59%|███████████████▊           | 596/1014 [00:16<00:11, 35.07batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 35.08batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.10batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.13batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.11batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:11, 35.18batch/s] 62%|████████████████▊          | 632/1014 [00:17<00:10, 35.21batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.22batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.27batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.31batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 35.19batch/s] 65%|█████████████████▋         | 662/1014 [00:18<00:09, 35.23batch/s] 66%|█████████████████▊         | 668/1014 [00:18<00:09, 35.25batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.23batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 35.25batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 35.24batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 35.25batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.22batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 35.10batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.12batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 35.15batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 35.13batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.13batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.12batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 35.13batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 35.11batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 35.10batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.04batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.00batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.03batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 35.06batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 35.07batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 35.08batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.11batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 35.08batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:05, 35.04batch/s] 80%|█████████████████████▌     | 812/1014 [00:23<00:05, 35.05batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 35.08batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.11batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.11batch/s] 82%|██████████████████████▎    | 836/1014 [00:23<00:05, 35.09batch/s] 83%|██████████████████████▍    | 842/1014 [00:23<00:04, 35.09batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 35.07batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.06batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 35.09batch/s] 85%|███████████████████████    | 866/1014 [00:24<00:04, 35.10batch/s] 86%|███████████████████████▏   | 872/1014 [00:24<00:04, 35.09batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 35.06batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 35.07batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 35.12batch/s] 88%|███████████████████████▊   | 896/1014 [00:25<00:03, 35.19batch/s] 89%|████████████████████████   | 902/1014 [00:25<00:03, 35.16batch/s] 90%|████████████████████████▏  | 908/1014 [00:25<00:03, 35.16batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 35.09batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 35.13batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 35.16batch/s] 92%|████████████████████████▊  | 932/1014 [00:26<00:02, 35.19batch/s] 93%|████████████████████████▉  | 938/1014 [00:26<00:02, 35.21batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.26batch/s] 94%|█████████████████████████▎ | 950/1014 [00:26<00:01, 35.26batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 35.26batch/s] 95%|█████████████████████████▌ | 962/1014 [00:27<00:01, 35.24batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 35.23batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 35.20batch/s] 97%|██████████████████████████ | 980/1014 [00:27<00:00, 35.17batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 35.14batch/s] 98%|██████████████████████████▍| 992/1014 [00:28<00:00, 35.15batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 35.17batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 35.16batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 35.19batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.22batch/s]
Validation 18 -> LOSS = 0.30
Validation 18 -> BLEU = 94.47, 97.7/95.3/93.4/91.5 (BP=1.000, ratio=1.001, hyp_len=14390, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.30 @ validation 18
--> Best BLEU so far: 94.47 @ validation 18
Starting Epoch 19
Epoch 19 - update       8700 => loss:   0.234 (#OOM: 0)
Epoch 19 - update       8730 => loss:   0.273 (#OOM: 0)
Epoch 19 - update       8760 => loss:   0.173 (#OOM: 0)
Epoch 19 - update       8790 => loss:   0.231 (#OOM: 0)
Epoch 19 - update       8820 => loss:   0.179 (#OOM: 0)
Epoch 19 - update       8850 => loss:   0.206 (#OOM: 0)
Epoch 19 - update       8880 => loss:   0.134 (#OOM: 0)
Epoch 19 - update       8910 => loss:   0.304 (#OOM: 0)
Epoch 19 - update       8940 => loss:   0.252 (#OOM: 0)
Epoch 19 - update       8970 => loss:   0.205 (#OOM: 0)
Epoch 19 - update       9000 => loss:   0.154 (#OOM: 0)
Epoch 19 - update       9030 => loss:   0.234 (#OOM: 0)
Epoch 19 - update       9060 => loss:   0.193 (#OOM: 0)
Epoch 19 - update       9090 => loss:   0.400 (#OOM: 0)
Epoch 19 - update       9120 => loss:   0.208 (#OOM: 0)
Epoch 19 - update       9150 => loss:   0.181 (#OOM: 0)
--> Epoch 19 finished with mean loss 0.24346
--> Overhead/Training/Evaluation: 0.65/0.73/0.00 mins (total: 1.39 mins)   (659 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.79batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 11.63batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 12.63batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 12.62batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 12.54batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 14.98batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 14.04batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 14.04batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.49batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.78batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.15batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.27batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:20, 48.30batch/s]  1%|▎                           | 10/1014 [00:00<00:26, 37.63batch/s]  1%|▍                           | 15/1014 [00:00<00:26, 37.13batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 36.62batch/s]  2%|▋                           | 25/1014 [00:00<00:26, 36.74batch/s]  3%|▊                           | 30/1014 [00:00<00:26, 36.50batch/s]  3%|▉                           | 35/1014 [00:00<00:27, 35.61batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.66batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.68batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 35.86batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 35.62batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.05batch/s]  6%|█▊                          | 65/1014 [00:01<00:26, 35.67batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 35.35batch/s]  7%|██                          | 75/1014 [00:02<00:26, 35.29batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 35.55batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 35.17batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 34.61batch/s]  9%|██▌                         | 95/1014 [00:02<00:26, 34.38batch/s] 10%|██▋                        | 100/1014 [00:02<00:26, 34.52batch/s] 10%|██▊                        | 105/1014 [00:03<00:26, 34.62batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 34.80batch/s] 11%|███                        | 115/1014 [00:03<00:25, 34.80batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 34.97batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 34.80batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 34.94batch/s] 13%|███▌                       | 135/1014 [00:03<00:25, 35.15batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.31batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.43batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.55batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.64batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 35.46batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 35.49batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 35.29batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.36batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.57batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.71batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.78batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.60batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.62batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.69batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.73batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.10batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.15batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 34.92batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 34.95batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 34.99batch/s] 24%|██████▍                    | 240/1014 [00:06<00:22, 35.04batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.14batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.07batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 34.94batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.07batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.05batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.14batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 35.10batch/s] 28%|███████▍                   | 280/1014 [00:08<00:21, 34.92batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 34.83batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 34.78batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 34.83batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 34.85batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 34.90batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.93batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.91batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 35.00batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.02batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.11batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.06batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 35.05batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 35.07batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.06batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 34.98batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 35.04batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.05batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.09batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 35.12batch/s] 37%|██████████                 | 380/1014 [00:10<00:18, 35.15batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 35.14batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 35.16batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.20batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.11batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 35.13batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.19batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 35.19batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.16batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.08batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.14batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 35.19batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.21batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.05batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 35.13batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 35.05batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 34.98batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.99batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 35.01batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 35.03batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 35.10batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 35.11batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.14batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 35.10batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.10batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.07batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 35.06batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 35.00batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:14, 35.13batch/s] 52%|██████████████             | 527/1014 [00:14<00:13, 35.19batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 35.12batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.13batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.19batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 35.20batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:12, 35.25batch/s] 56%|██████████████▉            | 563/1014 [00:15<00:12, 35.29batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.35batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.36batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 35.33batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 35.28batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 35.30batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 35.23batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 35.17batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 35.16batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 35.14batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 35.20batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.19batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 35.20batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 35.20batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 35.24batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 35.27batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.30batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 35.30batch/s] 66%|█████████████████▊         | 671/1014 [00:18<00:09, 35.32batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 35.35batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 35.36batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.32batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 35.29batch/s] 69%|██████████████████▋        | 701/1014 [00:19<00:08, 35.30batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 35.27batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 35.31batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.26batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.29batch/s] 72%|███████████████████▍       | 731/1014 [00:20<00:08, 35.32batch/s] 73%|███████████████████▌       | 737/1014 [00:20<00:07, 35.29batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 35.29batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.29batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.24batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 35.19batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:07, 35.19batch/s] 76%|████████████████████▌      | 773/1014 [00:21<00:06, 35.23batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.25batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.29batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 35.34batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 35.32batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:05, 35.27batch/s] 80%|█████████████████████▌     | 809/1014 [00:22<00:05, 35.28batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 35.22batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 35.22batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 35.18batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.03batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.07batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 35.06batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 35.11batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 35.13batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 35.10batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.09batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.02batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 35.07batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 35.07batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 35.04batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.02batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.05batch/s] 90%|████████████████████████▎  | 911/1014 [00:25<00:02, 35.04batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 35.08batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 35.15batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.16batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.18batch/s] 93%|█████████████████████████  | 941/1014 [00:26<00:02, 35.13batch/s] 93%|█████████████████████████▏ | 947/1014 [00:26<00:01, 35.09batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 35.12batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.13batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.11batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 35.10batch/s] 96%|██████████████████████████ | 977/1014 [00:27<00:01, 35.12batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 35.10batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.12batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 35.12batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 35.08batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 35.09batch/s]100%|█████████████████████████▉| 1013/1014 [00:28<00:00, 35.05batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.06batch/s]
Validation 19 -> LOSS = 0.29
Validation 19 -> BLEU = 94.32, 97.5/95.2/93.3/91.4 (BP=1.000, ratio=1.003, hyp_len=14424, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.29 @ validation 19
--> Best BLEU so far: 94.47 @ validation 18
Starting Epoch 20
Epoch 20 - update       9180 => loss:   0.226 (#OOM: 0)
Epoch 20 - update       9210 => loss:   0.256 (#OOM: 0)
Epoch 20 - update       9240 => loss:   0.209 (#OOM: 0)
Epoch 20 - update       9270 => loss:   0.259 (#OOM: 0)
Epoch 20 - update       9300 => loss:   0.229 (#OOM: 0)
Epoch 20 - update       9330 => loss:   0.201 (#OOM: 0)
Epoch 20 - update       9360 => loss:   0.178 (#OOM: 0)
Epoch 20 - update       9390 => loss:   0.330 (#OOM: 0)
Epoch 20 - update       9420 => loss:   0.267 (#OOM: 0)
Epoch 20 - update       9450 => loss:   0.269 (#OOM: 0)
Epoch 20 - update       9480 => loss:   0.146 (#OOM: 0)
Epoch 20 - update       9510 => loss:   0.185 (#OOM: 0)
Epoch 20 - update       9540 => loss:   0.239 (#OOM: 0)
Epoch 20 - update       9570 => loss:   0.256 (#OOM: 0)
Epoch 20 - update       9600 => loss:   0.264 (#OOM: 0)
Epoch 20 - update       9630 => loss:   0.334 (#OOM: 0)
--> Epoch 20 finished with mean loss 0.22797
--> Overhead/Training/Evaluation: 0.63/0.71/0.00 mins (total: 1.34 mins)   (677 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:04,  7.49batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 15.12batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 13.12batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.47batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.88batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.18batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.72batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.01batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.68batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.59batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.62batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.86batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.86batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 33.96batch/s]  1%|▎                            | 9/1014 [00:00<00:27, 37.07batch/s]  1%|▍                           | 14/1014 [00:00<00:25, 39.55batch/s]  2%|▌                           | 19/1014 [00:00<00:25, 39.32batch/s]  2%|▋                           | 24/1014 [00:00<00:25, 38.08batch/s]  3%|▊                           | 29/1014 [00:00<00:26, 37.41batch/s]  3%|▉                           | 34/1014 [00:00<00:26, 36.46batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.87batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.51batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 35.36batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 36.02batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 36.14batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 36.09batch/s]  7%|█▉                          | 69/1014 [00:01<00:26, 35.73batch/s]  7%|██                          | 74/1014 [00:02<00:26, 36.10batch/s]  8%|██▏                         | 79/1014 [00:02<00:25, 36.21batch/s]  8%|██▎                         | 84/1014 [00:02<00:25, 36.16batch/s]  9%|██▍                         | 89/1014 [00:02<00:25, 35.92batch/s]  9%|██▌                         | 94/1014 [00:02<00:25, 35.61batch/s] 10%|██▋                         | 99/1014 [00:02<00:25, 35.43batch/s] 10%|██▊                        | 104/1014 [00:02<00:25, 35.20batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 34.86batch/s] 11%|███                        | 114/1014 [00:03<00:25, 35.01batch/s] 12%|███▏                       | 119/1014 [00:03<00:25, 35.08batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 35.31batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 35.23batch/s] 13%|███▌                       | 134/1014 [00:03<00:24, 35.24batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 35.03batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 35.09batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 35.28batch/s] 15%|████                       | 154/1014 [00:04<00:24, 35.28batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 35.46batch/s] 16%|████▎                      | 164/1014 [00:04<00:23, 35.57batch/s] 17%|████▌                      | 169/1014 [00:04<00:23, 35.74batch/s] 17%|████▋                      | 174/1014 [00:04<00:23, 35.80batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 35.74batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.80batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 35.75batch/s] 19%|█████▏                     | 194/1014 [00:05<00:22, 35.96batch/s] 20%|█████▎                     | 199/1014 [00:05<00:22, 35.80batch/s] 20%|█████▍                     | 204/1014 [00:05<00:22, 35.93batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.84batch/s] 21%|█████▋                     | 214/1014 [00:06<00:22, 35.53batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 35.38batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 35.46batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 35.34batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 35.28batch/s] 24%|██████▎                    | 239/1014 [00:06<00:21, 35.27batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.39batch/s] 25%|██████▋                    | 249/1014 [00:07<00:21, 35.34batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 35.43batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.56batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 35.66batch/s] 27%|███████▏                   | 269/1014 [00:07<00:20, 35.69batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.52batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 35.60batch/s] 28%|███████▌                   | 284/1014 [00:07<00:20, 35.55batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 35.65batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.71batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.74batch/s] 30%|████████                   | 304/1014 [00:08<00:19, 35.72batch/s] 30%|████████▏                  | 309/1014 [00:08<00:19, 35.81batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.90batch/s] 31%|████████▍                  | 319/1014 [00:08<00:19, 35.96batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.91batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.91batch/s] 33%|████████▉                  | 334/1014 [00:09<00:18, 35.99batch/s] 33%|█████████                  | 339/1014 [00:09<00:18, 35.81batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:18, 35.83batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.92batch/s] 35%|█████████▍                 | 354/1014 [00:09<00:18, 35.92batch/s] 35%|█████████▌                 | 359/1014 [00:09<00:18, 36.02batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 36.02batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:17, 35.96batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:17, 35.91batch/s] 37%|██████████                 | 379/1014 [00:10<00:17, 35.83batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.78batch/s] 38%|██████████▎                | 389/1014 [00:10<00:17, 35.82batch/s] 39%|██████████▍                | 394/1014 [00:10<00:17, 35.84batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.80batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.84batch/s] 40%|██████████▉                | 409/1014 [00:11<00:16, 35.81batch/s] 41%|███████████                | 414/1014 [00:11<00:16, 35.74batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.77batch/s] 42%|███████████▎               | 424/1014 [00:11<00:16, 35.69batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.62batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.70batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.62batch/s] 44%|███████████▊               | 444/1014 [00:12<00:15, 35.72batch/s] 44%|███████████▉               | 449/1014 [00:12<00:15, 35.68batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.68batch/s] 45%|████████████▏              | 459/1014 [00:12<00:15, 35.76batch/s] 46%|████████████▎              | 464/1014 [00:12<00:15, 35.75batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.75batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.83batch/s] 47%|████████████▊              | 479/1014 [00:13<00:14, 35.81batch/s] 48%|████████████▉              | 484/1014 [00:13<00:14, 35.83batch/s] 48%|█████████████              | 489/1014 [00:13<00:14, 35.79batch/s] 49%|█████████████▏             | 494/1014 [00:13<00:14, 35.81batch/s] 49%|█████████████▎             | 499/1014 [00:13<00:14, 35.84batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 35.85batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.76batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.68batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:13, 35.67batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.69batch/s] 52%|██████████████             | 529/1014 [00:14<00:13, 35.67batch/s] 53%|██████████████▏            | 534/1014 [00:14<00:13, 35.67batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.68batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.61batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.59batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.32batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.34batch/s] 56%|███████████████            | 564/1014 [00:15<00:12, 35.37batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.39batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.30batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.34batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.37batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.33batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.30batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.30batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.18batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.10batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.03batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.05batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 35.03batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.03batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 35.08batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 35.09batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.08batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.07batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.11batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.10batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.12batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 35.14batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.17batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.07batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.08batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.10batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.07batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.09batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 35.09batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.12batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.08batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.03batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.93batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 34.98batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:08, 34.98batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.99batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 35.01batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.03batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.01batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.01batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 34.97batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.00batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 35.03batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.04batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.02batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.01batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.99batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.93batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.95batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.99batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.03batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.04batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.98batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.01batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.05batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.01batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 35.03batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.97batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.01batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.01batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 34.99batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 34.98batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:04, 34.96batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.99batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 35.00batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.02batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.01batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.01batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 34.99batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:03, 34.97batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.97batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.98batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.00batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.00batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.99batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 35.00batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.01batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 35.01batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 35.00batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.93batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.94batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.93batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 34.94batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:01, 34.98batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.96batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.92batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.93batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 34.93batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.93batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 34.94batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.95batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.95batch/s]
Validation 20 -> LOSS = 0.29
Validation 20 -> BLEU = 94.39, 97.4/95.2/93.4/91.6 (BP=1.000, ratio=1.006, hyp_len=14462, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.29 @ validation 20
--> Best BLEU so far: 94.47 @ validation 18
Starting Epoch 21
Epoch 21 - update       9660 => loss:   0.149 (#OOM: 0)
Epoch 21 - update       9690 => loss:   0.133 (#OOM: 0)
Epoch 21 - update       9720 => loss:   0.275 (#OOM: 0)
Epoch 21 - update       9750 => loss:   0.271 (#OOM: 0)
Epoch 21 - update       9780 => loss:   0.204 (#OOM: 0)
Epoch 21 - update       9810 => loss:   0.186 (#OOM: 0)
Epoch 21 - update       9840 => loss:   0.287 (#OOM: 0)
Epoch 21 - update       9870 => loss:   0.148 (#OOM: 0)
Epoch 21 - update       9900 => loss:   0.256 (#OOM: 0)
Epoch 21 - update       9930 => loss:   0.315 (#OOM: 0)
Epoch 21 - update       9960 => loss:   0.212 (#OOM: 0)
Epoch 21 - update       9990 => loss:   0.207 (#OOM: 0)
Epoch 21 - update      10020 => loss:   0.379 (#OOM: 0)
Epoch 21 - update      10050 => loss:   0.200 (#OOM: 0)
Epoch 21 - update      10080 => loss:   0.136 (#OOM: 0)
Epoch 21 - update      10110 => loss:   0.205 (#OOM: 0)
--> Epoch 21 finished with mean loss 0.21844
--> Overhead/Training/Evaluation: 0.63/0.70/0.00 mins (total: 1.32 mins)   (691 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.90batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  8.80batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.37batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.67batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.67batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.60batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 13.59batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 13.89batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.87batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 13.85batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.64batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 14.41batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.76batch/s] 85%|█████████████████████████▌    | 29/34 [00:01<00:00, 14.62batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 14.84batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.16batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:27, 36.11batch/s]  1%|▎                           | 10/1014 [00:00<00:29, 33.92batch/s]  1%|▍                           | 15/1014 [00:00<00:27, 36.80batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 35.68batch/s]  2%|▋                           | 25/1014 [00:00<00:26, 37.64batch/s]  3%|▊                           | 30/1014 [00:00<00:25, 37.87batch/s]  3%|▉                           | 35/1014 [00:00<00:26, 37.44batch/s]  4%|█                           | 40/1014 [00:01<00:26, 37.09batch/s]  4%|█▏                          | 45/1014 [00:01<00:25, 37.47batch/s]  5%|█▍                          | 50/1014 [00:01<00:25, 37.40batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.60batch/s]  6%|█▋                          | 60/1014 [00:01<00:25, 37.16batch/s]  6%|█▊                          | 65/1014 [00:01<00:25, 37.13batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 37.35batch/s]  7%|██                          | 75/1014 [00:01<00:24, 37.63batch/s]  8%|██▏                         | 80/1014 [00:02<00:24, 37.57batch/s]  8%|██▎                         | 85/1014 [00:02<00:24, 37.43batch/s]  9%|██▍                         | 90/1014 [00:02<00:24, 37.51batch/s]  9%|██▌                         | 95/1014 [00:02<00:24, 37.43batch/s] 10%|██▋                        | 100/1014 [00:02<00:24, 37.68batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 37.85batch/s] 11%|██▉                        | 110/1014 [00:02<00:23, 37.98batch/s] 11%|███                        | 115/1014 [00:03<00:23, 37.84batch/s] 12%|███▏                       | 120/1014 [00:03<00:23, 37.79batch/s] 12%|███▎                       | 125/1014 [00:03<00:23, 37.62batch/s] 13%|███▍                       | 130/1014 [00:03<00:23, 37.86batch/s] 13%|███▌                       | 135/1014 [00:03<00:23, 37.74batch/s] 14%|███▋                       | 140/1014 [00:03<00:23, 37.23batch/s] 14%|███▊                       | 145/1014 [00:03<00:23, 37.20batch/s] 15%|███▉                       | 150/1014 [00:04<00:23, 36.77batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 36.86batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 36.65batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 36.40batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 36.05batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.89batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.80batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.89batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.78batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 35.67batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.85batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.71batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.87batch/s] 21%|█████▋                     | 215/1014 [00:05<00:22, 35.96batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.85batch/s] 22%|█████▉                     | 225/1014 [00:06<00:21, 36.02batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 35.99batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 35.98batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.98batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 36.04batch/s] 25%|██████▋                    | 250/1014 [00:06<00:21, 36.08batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 36.09batch/s] 26%|██████▉                    | 260/1014 [00:07<00:20, 36.01batch/s] 26%|███████                    | 265/1014 [00:07<00:20, 35.84batch/s] 27%|███████▏                   | 270/1014 [00:07<00:20, 35.74batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.82batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.85batch/s] 28%|███████▌                   | 285/1014 [00:07<00:20, 35.88batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.82batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.90batch/s] 30%|███████▉                   | 300/1014 [00:08<00:19, 35.81batch/s] 30%|████████                   | 305/1014 [00:08<00:19, 35.70batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 35.65batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.65batch/s] 32%|████████▌                  | 320/1014 [00:08<00:19, 35.61batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 35.65batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.60batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.46batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 35.47batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:18, 35.37batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 35.48batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:18, 35.45batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 35.37batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.32batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.29batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 35.11batch/s] 37%|██████████                 | 380/1014 [00:10<00:18, 35.17batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 35.06batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 35.03batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.00batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.02batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 35.10batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 35.13batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 35.19batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.21batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.20batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.18batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 35.21batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.27batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 35.25batch/s] 44%|███████████▉               | 450/1014 [00:12<00:15, 35.29batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 35.35batch/s] 45%|████████████▏              | 460/1014 [00:12<00:15, 35.44batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 35.46batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 35.39batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 35.35batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 35.22batch/s] 48%|████████████▉              | 485/1014 [00:13<00:14, 35.30batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.28batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 35.29batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.30batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.24batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 35.22batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 35.25batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 35.21batch/s] 52%|█████████████▉             | 525/1014 [00:14<00:13, 35.23batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 35.21batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 35.12batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 35.16batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.12batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 35.13batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:13, 35.20batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.17batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 35.13batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 35.14batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.18batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.14batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 35.16batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 35.18batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.10batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 35.13batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 35.17batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.20batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 35.24batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.24batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 35.25batch/s] 62%|████████████████▊          | 630/1014 [00:17<00:10, 35.26batch/s] 63%|████████████████▉          | 635/1014 [00:17<00:10, 35.30batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 35.28batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 35.24batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.24batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.20batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 35.26batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 35.31batch/s] 66%|█████████████████▊         | 670/1014 [00:18<00:09, 35.29batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 35.26batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 35.27batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.30batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 35.26batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 35.24batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.27batch/s] 70%|██████████████████▊        | 705/1014 [00:19<00:08, 35.30batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.33batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.37batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.38batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.36batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.36batch/s] 72%|███████████████████▌       | 735/1014 [00:20<00:07, 35.28batch/s] 73%|███████████████████▋       | 740/1014 [00:20<00:07, 35.27batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.25batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 35.24batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.21batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.17batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:07, 35.14batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.17batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 35.16batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 35.19batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.16batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.14batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 35.16batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 35.18batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.21batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 35.22batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 35.25batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.23batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 35.22batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.22batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.22batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.23batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 35.19batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 35.22batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 35.25batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 35.25batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.24batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.18batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.21batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 35.19batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 35.21batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 35.24batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.17batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.16batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.17batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.13batch/s] 90%|████████████████████████▎  | 915/1014 [00:26<00:02, 35.13batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 35.12batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.13batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 35.12batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.14batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.17batch/s] 93%|█████████████████████████▏ | 945/1014 [00:26<00:01, 35.14batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 35.08batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.04batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 35.06batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.02batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 34.98batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 34.98batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.97batch/s] 97%|██████████████████████████▏| 985/1014 [00:28<00:00, 34.98batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 34.95batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.95batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.95batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 34.97batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 34.97batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.00batch/s]
Validation 21 -> LOSS = 0.28
Validation 21 -> BLEU = 94.92, 98.0/95.8/94.0/92.2 (BP=1.000, ratio=1.000, hyp_len=14379, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.28 @ validation 21
--> Best BLEU so far: 94.92 @ validation 21
Starting Epoch 22
Epoch 22 - update      10140 => loss:   0.174 (#OOM: 0)
Epoch 22 - update      10170 => loss:   0.182 (#OOM: 0)
Epoch 22 - update      10200 => loss:   0.267 (#OOM: 0)
Epoch 22 - update      10230 => loss:   0.173 (#OOM: 0)
Epoch 22 - update      10260 => loss:   0.181 (#OOM: 0)
Epoch 22 - update      10290 => loss:   0.189 (#OOM: 0)
Epoch 22 - update      10320 => loss:   0.240 (#OOM: 0)
Epoch 22 - update      10350 => loss:   0.142 (#OOM: 0)
Epoch 22 - update      10380 => loss:   0.214 (#OOM: 0)
Epoch 22 - update      10410 => loss:   0.182 (#OOM: 0)
Epoch 22 - update      10440 => loss:   0.225 (#OOM: 0)
Epoch 22 - update      10470 => loss:   0.084 (#OOM: 0)
Epoch 22 - update      10500 => loss:   0.259 (#OOM: 0)
Epoch 22 - update      10530 => loss:   0.149 (#OOM: 0)
Epoch 22 - update      10560 => loss:   0.211 (#OOM: 0)
Epoch 22 - update      10590 => loss:   0.149 (#OOM: 0)
--> Epoch 22 finished with mean loss 0.20461
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.33 mins)   (681 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:03,  9.98batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 11.78batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 14.44batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 15.57batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.69batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.09batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.10batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.80batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.30batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.18batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.34batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.66batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.66batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:35, 28.78batch/s]  1%|▎                            | 9/1014 [00:00<00:28, 34.76batch/s]  1%|▍                           | 14/1014 [00:00<00:28, 35.52batch/s]  2%|▌                           | 19/1014 [00:00<00:27, 35.84batch/s]  2%|▋                           | 24/1014 [00:00<00:27, 35.37batch/s]  3%|▊                           | 29/1014 [00:00<00:27, 35.84batch/s]  3%|▉                           | 34/1014 [00:00<00:27, 35.41batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.20batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.31batch/s]  5%|█▎                          | 49/1014 [00:01<00:26, 36.00batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 36.07batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 35.72batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 35.47batch/s]  7%|█▉                          | 69/1014 [00:01<00:27, 34.94batch/s]  7%|██                          | 74/1014 [00:02<00:26, 35.38batch/s]  8%|██▏                         | 79/1014 [00:02<00:26, 35.05batch/s]  8%|██▎                         | 84/1014 [00:02<00:26, 35.06batch/s]  9%|██▍                         | 89/1014 [00:02<00:26, 34.74batch/s]  9%|██▌                         | 94/1014 [00:02<00:26, 34.73batch/s] 10%|██▋                         | 99/1014 [00:02<00:26, 34.59batch/s] 10%|██▊                        | 104/1014 [00:03<00:26, 34.37batch/s] 11%|██▉                        | 109/1014 [00:03<00:26, 34.41batch/s] 11%|███                        | 114/1014 [00:03<00:25, 34.67batch/s] 12%|███▏                       | 119/1014 [00:03<00:25, 34.87batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 34.77batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.79batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.86batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 35.07batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 34.90batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 34.85batch/s] 15%|████                       | 154/1014 [00:04<00:24, 34.41batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 34.34batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 34.16batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 34.29batch/s] 17%|████▋                      | 174/1014 [00:05<00:24, 34.04batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 33.90batch/s] 18%|████▉                      | 184/1014 [00:05<00:24, 33.89batch/s] 19%|█████                      | 189/1014 [00:05<00:24, 33.82batch/s] 19%|█████▏                     | 194/1014 [00:05<00:24, 33.71batch/s] 20%|█████▎                     | 199/1014 [00:05<00:24, 33.78batch/s] 20%|█████▍                     | 204/1014 [00:06<00:24, 33.72batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 33.75batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 33.65batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 33.69batch/s] 22%|█████▉                     | 224/1014 [00:06<00:23, 33.69batch/s] 23%|██████                     | 229/1014 [00:06<00:23, 33.80batch/s] 23%|██████▏                    | 234/1014 [00:06<00:23, 33.86batch/s] 24%|██████▎                    | 239/1014 [00:07<00:22, 34.06batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 33.99batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 33.88batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 33.79batch/s] 26%|██████▉                    | 259/1014 [00:07<00:22, 33.83batch/s] 26%|███████                    | 264/1014 [00:07<00:22, 33.92batch/s] 27%|███████▏                   | 269/1014 [00:07<00:22, 33.80batch/s] 27%|███████▎                   | 274/1014 [00:08<00:21, 33.85batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 33.85batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 33.81batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 33.74batch/s] 29%|███████▊                   | 294/1014 [00:08<00:21, 33.78batch/s] 29%|███████▉                   | 299/1014 [00:08<00:21, 33.81batch/s] 30%|████████                   | 304/1014 [00:08<00:21, 33.80batch/s] 30%|████████▏                  | 309/1014 [00:09<00:20, 33.85batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 33.85batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 33.82batch/s] 32%|████████▋                  | 324/1014 [00:09<00:20, 33.83batch/s] 32%|████████▊                  | 329/1014 [00:09<00:20, 33.92batch/s] 33%|████████▉                  | 334/1014 [00:09<00:20, 33.92batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.05batch/s] 34%|█████████▏                 | 344/1014 [00:10<00:19, 34.16batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.24batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 34.28batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:19, 34.24batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.26batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.28batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.32batch/s] 37%|██████████                 | 379/1014 [00:11<00:18, 34.34batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.39batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.51batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 34.58batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.59batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.45batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.43batch/s] 41%|███████████                | 414/1014 [00:12<00:17, 34.44batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.37batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 34.37batch/s] 42%|███████████▍               | 429/1014 [00:12<00:17, 34.31batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.24batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.34batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.42batch/s] 44%|███████████▉               | 449/1014 [00:13<00:16, 34.43batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.39batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.42batch/s] 46%|████████████▎              | 464/1014 [00:13<00:16, 34.37batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.48batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.48batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.52batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.66batch/s] 48%|█████████████              | 491/1014 [00:14<00:15, 34.65batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 34.65batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 34.69batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.66batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 34.56batch/s] 51%|█████████████▊             | 521/1014 [00:15<00:14, 34.54batch/s] 52%|██████████████             | 527/1014 [00:15<00:14, 34.57batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 34.62batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.65batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.62batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 34.61batch/s] 55%|██████████████▊            | 557/1014 [00:16<00:13, 34.66batch/s] 56%|██████████████▉            | 563/1014 [00:16<00:12, 34.73batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.75batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.77batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 34.80batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 34.78batch/s] 58%|███████████████▊           | 593/1014 [00:17<00:12, 34.82batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.76batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.81batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 34.85batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.80batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 34.78batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.79batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.75batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.70batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.68batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.70batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.74batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.78batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.82batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.79batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.76batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.70batch/s] 69%|██████████████████▌        | 695/1014 [00:20<00:09, 34.68batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:09, 34.70batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.65batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.66batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.70batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.69batch/s] 72%|███████████████████▍       | 731/1014 [00:21<00:08, 34.70batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:07, 34.67batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.70batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.63batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.61batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 34.63batch/s] 76%|████████████████████▍      | 767/1014 [00:22<00:07, 34.70batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.68batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.70batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.71batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.73batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 34.71batch/s] 79%|█████████████████████▍     | 803/1014 [00:23<00:06, 34.74batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.74batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.76batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.76batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 34.74batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 34.73batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.74batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 34.75batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 34.76batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 34.72batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.73batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.74batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.76batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.78batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.77batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 34.80batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.82batch/s] 89%|████████████████████████   | 905/1014 [00:26<00:03, 34.78batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 34.77batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 34.80batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 34.80batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.78batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 34.78batch/s] 93%|█████████████████████████  | 941/1014 [00:27<00:02, 34.83batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 34.82batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.77batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.80batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 34.78batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 34.82batch/s] 96%|██████████████████████████ | 977/1014 [00:28<00:01, 34.83batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.84batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.85batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.84batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 34.83batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 34.76batch/s]100%|█████████████████████████▉| 1013/1014 [00:29<00:00, 34.78batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.77batch/s]
Validation 22 -> LOSS = 0.28
Validation 22 -> BLEU = 95.04, 98.0/95.9/94.1/92.3 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.28 @ validation 22
--> Best BLEU so far: 95.04 @ validation 22
Starting Epoch 23
Epoch 23 - update      10620 => loss:   0.166 (#OOM: 0)
Epoch 23 - update      10650 => loss:   0.208 (#OOM: 0)
Epoch 23 - update      10680 => loss:   0.198 (#OOM: 0)
Epoch 23 - update      10710 => loss:   0.109 (#OOM: 0)
Epoch 23 - update      10740 => loss:   0.246 (#OOM: 0)
Epoch 23 - update      10770 => loss:   0.286 (#OOM: 0)
Epoch 23 - update      10800 => loss:   0.199 (#OOM: 0)
Epoch 23 - update      10830 => loss:   0.279 (#OOM: 0)
Epoch 23 - update      10860 => loss:   0.188 (#OOM: 0)
Epoch 23 - update      10890 => loss:   0.185 (#OOM: 0)
Epoch 23 - update      10920 => loss:   0.118 (#OOM: 0)
Epoch 23 - update      10950 => loss:   0.152 (#OOM: 0)
Epoch 23 - update      10980 => loss:   0.177 (#OOM: 0)
Epoch 23 - update      11010 => loss:   0.171 (#OOM: 0)
Epoch 23 - update      11040 => loss:   0.126 (#OOM: 0)
Epoch 23 - update      11070 => loss:   0.186 (#OOM: 0)
--> Epoch 23 finished with mean loss 0.19283
--> Overhead/Training/Evaluation: 0.64/0.70/0.00 mins (total: 1.35 mins)   (688 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.90batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.03batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 11.52batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.84batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 14.83batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.38batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 13.72batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.87batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 14.05batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.54batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.95batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 14.13batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.28batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:27, 36.63batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 34.21batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 33.57batch/s]  2%|▍                           | 16/1014 [00:00<00:31, 31.35batch/s]  2%|▌                           | 22/1014 [00:00<00:28, 34.81batch/s]  3%|▊                           | 28/1014 [00:00<00:29, 33.89batch/s]  3%|▉                           | 34/1014 [00:01<00:29, 33.60batch/s]  4%|█                           | 40/1014 [00:01<00:27, 34.89batch/s]  5%|█▎                          | 46/1014 [00:01<00:27, 34.91batch/s]  5%|█▍                          | 52/1014 [00:01<00:27, 34.52batch/s]  6%|█▌                          | 58/1014 [00:01<00:27, 35.19batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 35.57batch/s]  7%|█▉                          | 70/1014 [00:01<00:26, 35.58batch/s]  7%|██                          | 76/1014 [00:02<00:26, 35.48batch/s]  8%|██▎                         | 82/1014 [00:02<00:26, 35.76batch/s]  9%|██▍                         | 88/1014 [00:02<00:25, 36.06batch/s]  9%|██▌                         | 94/1014 [00:02<00:25, 35.89batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 35.49batch/s] 10%|██▊                        | 106/1014 [00:02<00:25, 35.42batch/s] 11%|██▉                        | 112/1014 [00:03<00:25, 35.57batch/s] 12%|███▏                       | 118/1014 [00:03<00:25, 35.35batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 34.94batch/s] 13%|███▍                       | 130/1014 [00:03<00:25, 35.18batch/s] 13%|███▌                       | 136/1014 [00:03<00:24, 35.21batch/s] 14%|███▊                       | 142/1014 [00:04<00:24, 35.35batch/s] 15%|███▉                       | 148/1014 [00:04<00:24, 35.28batch/s] 15%|████                       | 154/1014 [00:04<00:24, 35.26batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 35.19batch/s] 16%|████▍                      | 166/1014 [00:04<00:24, 35.24batch/s] 17%|████▌                      | 172/1014 [00:04<00:23, 35.22batch/s] 18%|████▋                      | 178/1014 [00:05<00:23, 35.21batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.32batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.40batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 35.48batch/s] 20%|█████▍                     | 202/1014 [00:05<00:22, 35.39batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 35.50batch/s] 21%|█████▋                     | 214/1014 [00:06<00:22, 35.50batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.46batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 35.36batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 35.37batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 35.53batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.29batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.31batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 35.13batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 35.13batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 35.24batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.32batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.15batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 35.00batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.04batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 35.03batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.06batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 34.98batch/s] 31%|████████▍                  | 316/1014 [00:09<00:19, 35.06batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 34.98batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 34.95batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 34.81batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.86batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:19, 34.86batch/s] 35%|█████████▎                 | 352/1014 [00:10<00:19, 34.80batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 34.81batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.77batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.74batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 34.74batch/s] 38%|██████████▏                | 382/1014 [00:10<00:18, 34.75batch/s] 38%|██████████▎                | 388/1014 [00:11<00:18, 34.78batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 34.77batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.76batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 34.74batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 34.73batch/s] 41%|███████████▏               | 418/1014 [00:11<00:17, 34.85batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 34.89batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.95batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 35.00batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 34.99batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 35.04batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.06batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.12batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 35.04batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.05batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 35.02batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 35.06batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.09batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 35.09batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 35.07batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.06batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.01batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 34.96batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 35.10batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 35.06batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 34.99batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.04batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 35.06batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:13, 35.06batch/s] 55%|██████████████▉            | 562/1014 [00:16<00:12, 35.01batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 35.00batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.01batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.99batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 34.94batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:12, 34.92batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:11, 34.90batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.94batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.93batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 35.00batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 34.91batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:11, 34.95batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.97batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.97batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 35.02batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 35.05batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 35.09batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.07batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 35.09batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 35.06batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 35.03batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.08batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.09batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.09batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 35.15batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 35.08batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.10batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.12batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.12batch/s] 73%|███████████████████▌       | 736/1014 [00:20<00:07, 35.15batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 35.17batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.20batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.16batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.17batch/s] 76%|████████████████████▍      | 766/1014 [00:21<00:07, 35.21batch/s] 76%|████████████████████▌      | 772/1014 [00:21<00:06, 35.20batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 35.17batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.20batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.27batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 35.28batch/s] 79%|█████████████████████▎     | 802/1014 [00:22<00:06, 35.31batch/s] 80%|█████████████████████▌     | 808/1014 [00:22<00:05, 35.26batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.28batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.31batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 35.29batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 35.29batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:04, 35.31batch/s] 83%|██████████████████████▍    | 844/1014 [00:23<00:04, 35.33batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 35.34batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 35.31batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 35.34batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 35.34batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.39batch/s] 87%|███████████████████████▍   | 880/1014 [00:24<00:03, 35.36batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 35.35batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 35.34batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 35.36batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.39batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.34batch/s] 90%|████████████████████████▍  | 916/1014 [00:25<00:02, 35.28batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 35.28batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 35.27batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.29batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.31batch/s] 93%|█████████████████████████▏ | 946/1014 [00:26<00:01, 35.32batch/s] 94%|█████████████████████████▎ | 952/1014 [00:26<00:01, 35.30batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 35.29batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 35.31batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.32batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 35.34batch/s] 97%|██████████████████████████▏| 982/1014 [00:27<00:00, 35.37batch/s] 97%|██████████████████████████▎| 988/1014 [00:27<00:00, 35.35batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.35batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 35.33batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 35.30batch/s]100%|█████████████████████████▉| 1012/1014 [00:28<00:00, 35.26batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.25batch/s]
Validation 23 -> LOSS = 0.27
Validation 23 -> BLEU = 95.23, 98.1/96.0/94.3/92.6 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.27 @ validation 23
--> Best BLEU so far: 95.23 @ validation 23
Starting Epoch 24
Epoch 24 - update      11100 => loss:   0.109 (#OOM: 0)
Epoch 24 - update      11130 => loss:   0.136 (#OOM: 0)
Epoch 24 - update      11160 => loss:   0.181 (#OOM: 0)
Epoch 24 - update      11190 => loss:   0.082 (#OOM: 0)
Epoch 24 - update      11220 => loss:   0.140 (#OOM: 0)
Epoch 24 - update      11250 => loss:   0.202 (#OOM: 0)
Epoch 24 - update      11280 => loss:   0.198 (#OOM: 0)
Epoch 24 - update      11310 => loss:   0.144 (#OOM: 0)
Epoch 24 - update      11340 => loss:   0.158 (#OOM: 0)
Epoch 24 - update      11370 => loss:   0.161 (#OOM: 0)
Epoch 24 - update      11400 => loss:   0.292 (#OOM: 0)
Epoch 24 - update      11430 => loss:   0.127 (#OOM: 0)
Epoch 24 - update      11460 => loss:   0.217 (#OOM: 0)
Epoch 24 - update      11490 => loss:   0.144 (#OOM: 0)
Epoch 24 - update      11520 => loss:   0.184 (#OOM: 0)
Epoch 24 - update      11550 => loss:   0.223 (#OOM: 0)
--> Epoch 24 finished with mean loss 0.18384
--> Overhead/Training/Evaluation: 0.66/0.73/0.00 mins (total: 1.39 mins)   (658 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 12.40batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.56batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 15.16batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 17.02batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 14.74batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.93batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.93batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.43batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.64batch/s] 82%|████████████████████████▋     | 28/34 [00:01<00:00, 14.01batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.13batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.39batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.38batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:31, 31.61batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 32.56batch/s]  1%|▎                           | 12/1014 [00:00<00:29, 33.97batch/s]  2%|▍                           | 16/1014 [00:00<00:30, 33.26batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 33.50batch/s]  2%|▋                           | 25/1014 [00:00<00:28, 34.32batch/s]  3%|▊                           | 30/1014 [00:00<00:28, 34.21batch/s]  3%|▉                           | 35/1014 [00:00<00:27, 35.31batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.94batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 35.92batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 35.83batch/s]  5%|█▌                          | 55/1014 [00:01<00:27, 35.33batch/s]  6%|█▋                          | 60/1014 [00:01<00:27, 35.13batch/s]  6%|█▊                          | 65/1014 [00:01<00:27, 35.09batch/s]  7%|█▉                          | 70/1014 [00:02<00:27, 34.95batch/s]  7%|██                          | 75/1014 [00:02<00:26, 34.92batch/s]  8%|██▏                         | 80/1014 [00:02<00:26, 34.99batch/s]  8%|██▎                         | 85/1014 [00:02<00:26, 35.21batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 35.13batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 35.38batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 35.74batch/s] 10%|██▊                        | 105/1014 [00:02<00:25, 35.78batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 36.14batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.30batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 36.17batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 36.03batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 35.83batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 35.70batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.47batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.39batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.31batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.36batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 35.32batch/s] 16%|████▍                      | 165/1014 [00:04<00:24, 35.37batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 35.57batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.65batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.72batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.74batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 35.90batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 35.82batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.76batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.78batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.82batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.66batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.51batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 35.65batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 35.48batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 35.48batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.56batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.49batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 35.81batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 35.79batch/s] 26%|███████                    | 263/1014 [00:07<00:21, 35.64batch/s] 27%|███████▏                   | 269/1014 [00:07<00:20, 35.67batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.72batch/s] 28%|███████▍                   | 281/1014 [00:07<00:20, 35.75batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.71batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 35.65batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.58batch/s] 30%|████████                   | 305/1014 [00:08<00:19, 35.60batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 35.65batch/s] 31%|████████▍                  | 317/1014 [00:08<00:19, 35.61batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.64batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.74batch/s] 33%|████████▉                  | 335/1014 [00:09<00:18, 35.76batch/s] 34%|█████████                  | 341/1014 [00:09<00:18, 35.82batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:18, 35.35batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:18, 35.35batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.25batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 35.23batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 35.05batch/s] 37%|██████████                 | 377/1014 [00:10<00:18, 35.20batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 35.25batch/s] 38%|██████████▎                | 389/1014 [00:11<00:17, 35.32batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 35.40batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 35.33batch/s] 40%|██████████▊                | 407/1014 [00:11<00:17, 35.29batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 35.30batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.35batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 35.33batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 35.29batch/s] 43%|███████████▋               | 437/1014 [00:12<00:16, 35.33batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 35.31batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 35.26batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 35.32batch/s] 45%|████████████▎              | 461/1014 [00:13<00:15, 35.34batch/s] 46%|████████████▍              | 467/1014 [00:13<00:15, 35.34batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 35.30batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 35.25batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 35.18batch/s] 48%|█████████████              | 491/1014 [00:13<00:14, 35.22batch/s] 49%|█████████████▏             | 497/1014 [00:14<00:14, 35.19batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.17batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.18batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 35.17batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:14, 35.18batch/s] 52%|██████████████             | 527/1014 [00:14<00:13, 35.16batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 35.21batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.27batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.33batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 35.34batch/s] 55%|██████████████▊            | 557/1014 [00:15<00:12, 35.29batch/s] 56%|██████████████▉            | 563/1014 [00:15<00:12, 35.30batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.33batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.33batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 35.32batch/s] 58%|███████████████▋           | 587/1014 [00:16<00:12, 35.27batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 35.29batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.26batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 35.26batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 35.15batch/s] 61%|████████████████▍          | 617/1014 [00:17<00:11, 34.71batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 34.71batch/s] 62%|████████████████▋          | 629/1014 [00:18<00:11, 34.74batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.80batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 34.84batch/s] 64%|█████████████████▏         | 647/1014 [00:18<00:10, 34.82batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 34.84batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 34.82batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:10, 34.83batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 34.84batch/s] 67%|██████████████████         | 677/1014 [00:19<00:09, 34.86batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 34.88batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 34.86batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 34.90batch/s] 69%|██████████████████▋        | 701/1014 [00:20<00:08, 34.95batch/s] 70%|██████████████████▊        | 707/1014 [00:20<00:08, 34.92batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 34.92batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.88batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 34.85batch/s] 72%|███████████████████▍       | 731/1014 [00:20<00:08, 34.85batch/s] 73%|███████████████████▌       | 737/1014 [00:21<00:07, 34.89batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 34.91batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.89batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 34.89batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 34.89batch/s] 76%|████████████████████▍      | 767/1014 [00:21<00:07, 34.94batch/s] 76%|████████████████████▌      | 773/1014 [00:22<00:06, 34.91batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.87batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 34.90batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 34.91batch/s] 79%|█████████████████████▏     | 797/1014 [00:22<00:06, 34.89batch/s] 79%|█████████████████████▍     | 803/1014 [00:22<00:06, 34.92batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.92batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 34.94batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 34.96batch/s] 82%|██████████████████████     | 827/1014 [00:23<00:05, 35.02batch/s] 82%|██████████████████████▏    | 833/1014 [00:23<00:05, 35.07batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.07batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 35.04batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 35.04batch/s] 85%|██████████████████████▊    | 857/1014 [00:24<00:04, 35.05batch/s] 85%|██████████████████████▉    | 863/1014 [00:24<00:04, 34.98batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 34.97batch/s] 86%|███████████████████████▎   | 875/1014 [00:25<00:03, 34.94batch/s] 87%|███████████████████████▍   | 881/1014 [00:25<00:03, 34.99batch/s] 87%|███████████████████████▌   | 887/1014 [00:25<00:03, 34.98batch/s] 88%|███████████████████████▊   | 893/1014 [00:25<00:03, 35.00batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.97batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 34.99batch/s] 90%|████████████████████████▎  | 911/1014 [00:26<00:02, 35.03batch/s] 90%|████████████████████████▍  | 917/1014 [00:26<00:02, 35.07batch/s] 91%|████████████████████████▌  | 923/1014 [00:26<00:02, 35.06batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.10batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.08batch/s] 93%|█████████████████████████  | 941/1014 [00:26<00:02, 35.06batch/s] 93%|█████████████████████████▏ | 947/1014 [00:27<00:01, 35.05batch/s] 94%|█████████████████████████▍ | 953/1014 [00:27<00:01, 34.99batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.03batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.04batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 35.01batch/s] 96%|██████████████████████████ | 977/1014 [00:27<00:01, 34.97batch/s] 97%|██████████████████████████▏| 983/1014 [00:28<00:00, 34.97batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.99batch/s] 98%|██████████████████████████▍| 995/1014 [00:28<00:00, 34.97batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 35.02batch/s] 99%|█████████████████████████▊| 1007/1014 [00:28<00:00, 35.04batch/s]100%|█████████████████████████▉| 1013/1014 [00:28<00:00, 35.06batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.05batch/s]
Validation 24 -> LOSS = 0.27
Validation 24 -> BLEU = 94.69, 97.4/95.4/93.8/92.2 (BP=1.000, ratio=1.007, hyp_len=14483, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.27 @ validation 24
--> Best BLEU so far: 95.23 @ validation 23
Starting Epoch 25
Epoch 25 - update      11580 => loss:   0.082 (#OOM: 0)
Epoch 25 - update      11610 => loss:   0.213 (#OOM: 0)
Epoch 25 - update      11640 => loss:   0.146 (#OOM: 0)
Epoch 25 - update      11670 => loss:   0.171 (#OOM: 0)
Epoch 25 - update      11700 => loss:   0.173 (#OOM: 0)
Epoch 25 - update      11730 => loss:   0.158 (#OOM: 0)
Epoch 25 - update      11760 => loss:   0.225 (#OOM: 0)
Epoch 25 - update      11790 => loss:   0.135 (#OOM: 0)
Epoch 25 - update      11820 => loss:   0.192 (#OOM: 0)
Epoch 25 - update      11850 => loss:   0.076 (#OOM: 0)
Epoch 25 - update      11880 => loss:   0.221 (#OOM: 0)
Epoch 25 - update      11910 => loss:   0.114 (#OOM: 0)
Epoch 25 - update      11940 => loss:   0.192 (#OOM: 0)
Epoch 25 - update      11970 => loss:   0.108 (#OOM: 0)
Epoch 25 - update      12000 => loss:   0.063 (#OOM: 0)
Epoch 25 - update      12030 => loss:   0.231 (#OOM: 0)
--> Epoch 25 finished with mean loss 0.17390
--> Overhead/Training/Evaluation: 0.60/0.71/0.00 mins (total: 1.31 mins)   (680 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.24batch/s]  9%|██▋                            | 3/34 [00:00<00:03,  9.53batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.87batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 11.63batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 12.61batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 12.47batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.98batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 12.90batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 12.27batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.66batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 13.09batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.09batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 13.25batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.78batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.70batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.12batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 34.37batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.37batch/s]  1%|▎                           | 13/1014 [00:00<00:27, 36.86batch/s]  2%|▍                           | 18/1014 [00:00<00:29, 34.12batch/s]  2%|▋                           | 24/1014 [00:00<00:26, 36.73batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 36.41batch/s]  4%|▉                           | 36/1014 [00:01<00:27, 34.99batch/s]  4%|█▏                          | 42/1014 [00:01<00:28, 34.42batch/s]  5%|█▎                          | 48/1014 [00:01<00:28, 34.49batch/s]  5%|█▍                          | 54/1014 [00:01<00:28, 34.04batch/s]  6%|█▋                          | 60/1014 [00:01<00:28, 33.52batch/s]  7%|█▊                          | 66/1014 [00:01<00:28, 33.60batch/s]  7%|█▉                          | 72/1014 [00:02<00:27, 33.93batch/s]  8%|██▏                         | 78/1014 [00:02<00:27, 34.23batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 33.98batch/s]  9%|██▍                         | 90/1014 [00:02<00:26, 34.35batch/s]  9%|██▋                         | 96/1014 [00:02<00:26, 34.56batch/s] 10%|██▋                        | 102/1014 [00:02<00:26, 34.62batch/s] 11%|██▉                        | 108/1014 [00:03<00:26, 34.60batch/s] 11%|███                        | 114/1014 [00:03<00:25, 34.82batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 34.79batch/s] 12%|███▎                       | 126/1014 [00:03<00:25, 34.86batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 35.16batch/s] 14%|███▋                       | 138/1014 [00:03<00:24, 35.14batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 35.42batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.43batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 35.44batch/s] 16%|████▎                      | 162/1014 [00:04<00:23, 35.80batch/s] 17%|████▍                      | 168/1014 [00:04<00:23, 35.80batch/s] 17%|████▋                      | 174/1014 [00:04<00:23, 35.66batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.87batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 35.84batch/s] 19%|█████                      | 192/1014 [00:05<00:22, 35.95batch/s] 20%|█████▎                     | 198/1014 [00:05<00:22, 35.97batch/s] 20%|█████▍                     | 204/1014 [00:05<00:22, 35.74batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.68batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 35.75batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 35.70batch/s] 22%|██████                     | 228/1014 [00:06<00:22, 35.47batch/s] 23%|██████▏                    | 234/1014 [00:06<00:21, 35.59batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.63batch/s] 24%|██████▌                    | 246/1014 [00:06<00:21, 35.52batch/s] 25%|██████▋                    | 252/1014 [00:07<00:21, 35.45batch/s] 25%|██████▊                    | 258/1014 [00:07<00:21, 35.33batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 35.20batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.23batch/s] 27%|███████▎                   | 276/1014 [00:07<00:20, 35.23batch/s] 28%|███████▌                   | 282/1014 [00:08<00:20, 35.17batch/s] 28%|███████▋                   | 288/1014 [00:08<00:20, 35.25batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.20batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 35.15batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 35.13batch/s] 31%|████████▎                  | 312/1014 [00:08<00:20, 35.01batch/s] 31%|████████▍                  | 318/1014 [00:09<00:19, 35.01batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 34.94batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 34.99batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 34.95batch/s] 34%|█████████                  | 342/1014 [00:09<00:19, 34.97batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:19, 34.91batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:18, 34.93batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 35.09batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 35.14batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 35.18batch/s] 37%|██████████                 | 378/1014 [00:10<00:18, 35.26batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.32batch/s] 38%|██████████▍                | 390/1014 [00:11<00:17, 35.32batch/s] 39%|██████████▌                | 396/1014 [00:11<00:17, 35.37batch/s] 40%|██████████▋                | 402/1014 [00:11<00:17, 35.31batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 35.35batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 35.27batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 35.33batch/s] 42%|███████████▎               | 426/1014 [00:12<00:16, 35.32batch/s] 43%|███████████▌               | 432/1014 [00:12<00:16, 35.26batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 35.25batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 35.25batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 35.21batch/s] 45%|████████████▏              | 456/1014 [00:12<00:15, 35.18batch/s] 46%|████████████▎              | 462/1014 [00:13<00:15, 35.22batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 35.16batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.19batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 35.26batch/s] 48%|████████████▉              | 486/1014 [00:13<00:14, 35.31batch/s] 49%|█████████████              | 492/1014 [00:13<00:14, 35.26batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 35.30batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 35.29batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 35.27batch/s] 51%|█████████████▋             | 516/1014 [00:14<00:14, 35.33batch/s] 51%|█████████████▉             | 522/1014 [00:14<00:13, 35.30batch/s] 52%|██████████████             | 528/1014 [00:14<00:13, 35.29batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 35.37batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 35.38batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 35.36batch/s] 54%|██████████████▋            | 552/1014 [00:15<00:13, 35.29batch/s] 55%|██████████████▊            | 558/1014 [00:15<00:12, 35.31batch/s] 56%|███████████████            | 564/1014 [00:15<00:12, 35.33batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 35.38batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 35.42batch/s] 57%|███████████████▍           | 582/1014 [00:16<00:12, 35.48batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:11, 35.50batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.51batch/s] 59%|███████████████▉           | 600/1014 [00:16<00:11, 35.47batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 35.54batch/s] 60%|████████████████▎          | 612/1014 [00:17<00:11, 35.51batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 35.51batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:10, 35.53batch/s] 62%|████████████████▊          | 630/1014 [00:17<00:10, 35.45batch/s] 63%|████████████████▉          | 636/1014 [00:17<00:10, 35.47batch/s] 63%|█████████████████          | 642/1014 [00:18<00:10, 35.55batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 35.46batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.44batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:09, 35.42batch/s] 66%|█████████████████▋         | 666/1014 [00:18<00:09, 35.44batch/s] 66%|█████████████████▉         | 672/1014 [00:18<00:09, 35.42batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 35.42batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.43batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 35.44batch/s] 69%|██████████████████▌        | 696/1014 [00:19<00:08, 35.49batch/s] 69%|██████████████████▋        | 702/1014 [00:19<00:08, 35.47batch/s] 70%|██████████████████▊        | 708/1014 [00:19<00:08, 35.47batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.47batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.48batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 35.49batch/s] 72%|███████████████████▍       | 732/1014 [00:20<00:07, 35.51batch/s] 73%|███████████████████▋       | 738/1014 [00:20<00:07, 35.54batch/s] 73%|███████████████████▊       | 744/1014 [00:20<00:07, 35.54batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 35.55batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 35.59batch/s] 75%|████████████████████▎      | 762/1014 [00:21<00:07, 35.57batch/s] 76%|████████████████████▍      | 768/1014 [00:21<00:06, 35.51batch/s] 76%|████████████████████▌      | 774/1014 [00:21<00:06, 35.48batch/s] 77%|████████████████████▊      | 780/1014 [00:21<00:06, 35.49batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 35.51batch/s] 78%|█████████████████████      | 792/1014 [00:22<00:06, 35.56batch/s] 79%|█████████████████████▏     | 798/1014 [00:22<00:06, 35.54batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.49batch/s] 80%|█████████████████████▌     | 810/1014 [00:22<00:05, 35.51batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 35.46batch/s] 81%|█████████████████████▉     | 822/1014 [00:23<00:05, 35.39batch/s] 82%|██████████████████████     | 828/1014 [00:23<00:05, 35.40batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.41batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.39batch/s] 83%|██████████████████████▌    | 846/1014 [00:23<00:04, 35.38batch/s] 84%|██████████████████████▋    | 852/1014 [00:24<00:04, 35.41batch/s] 85%|██████████████████████▊    | 858/1014 [00:24<00:04, 35.38batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.35batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.31batch/s] 86%|███████████████████████▎   | 876/1014 [00:24<00:03, 35.33batch/s] 87%|███████████████████████▍   | 882/1014 [00:24<00:03, 35.31batch/s] 88%|███████████████████████▋   | 888/1014 [00:25<00:03, 35.28batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.29batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.29batch/s] 89%|████████████████████████   | 906/1014 [00:25<00:03, 35.24batch/s] 90%|████████████████████████▎  | 912/1014 [00:25<00:02, 35.28batch/s] 91%|████████████████████████▍  | 918/1014 [00:26<00:02, 35.26batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.23batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 35.22batch/s] 92%|████████████████████████▉  | 936/1014 [00:26<00:02, 35.17batch/s] 93%|█████████████████████████  | 942/1014 [00:26<00:02, 35.19batch/s] 93%|█████████████████████████▏ | 948/1014 [00:26<00:01, 35.22batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 35.25batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 35.22batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 35.22batch/s] 96%|█████████████████████████▉ | 972/1014 [00:27<00:01, 35.26batch/s] 96%|██████████████████████████ | 978/1014 [00:27<00:01, 35.26batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.31batch/s] 98%|██████████████████████████▎| 990/1014 [00:28<00:00, 35.34batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 35.36batch/s] 99%|█████████████████████████▋| 1002/1014 [00:28<00:00, 35.33batch/s] 99%|█████████████████████████▊| 1008/1014 [00:28<00:00, 35.37batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.41batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.41batch/s]
Validation 25 -> LOSS = 0.27
Validation 25 -> BLEU = 95.51, 98.2/96.3/94.7/93.0 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.27 @ validation 25
--> Best BLEU so far: 95.51 @ validation 25
Starting Epoch 26
Epoch 26 - update      12060 => loss:   0.200 (#OOM: 0)
Epoch 26 - update      12090 => loss:   0.399 (#OOM: 0)
Epoch 26 - update      12120 => loss:   0.215 (#OOM: 0)
Epoch 26 - update      12150 => loss:   0.154 (#OOM: 0)
Epoch 26 - update      12180 => loss:   0.147 (#OOM: 0)
Epoch 26 - update      12210 => loss:   0.140 (#OOM: 0)
Epoch 26 - update      12240 => loss:   0.138 (#OOM: 0)
Epoch 26 - update      12270 => loss:   0.148 (#OOM: 0)
Epoch 26 - update      12300 => loss:   0.176 (#OOM: 0)
Epoch 26 - update      12330 => loss:   0.185 (#OOM: 0)
Epoch 26 - update      12360 => loss:   0.071 (#OOM: 0)
Epoch 26 - update      12390 => loss:   0.160 (#OOM: 0)
Epoch 26 - update      12420 => loss:   0.198 (#OOM: 0)
Epoch 26 - update      12450 => loss:   0.161 (#OOM: 0)
Epoch 26 - update      12480 => loss:   0.150 (#OOM: 0)
Epoch 26 - update      12510 => loss:   0.226 (#OOM: 0)
--> Epoch 26 finished with mean loss 0.16561
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.33 mins)   (679 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 13.01batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.33batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.22batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.03batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 13.94batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 14.51batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 15.51batch/s] 56%|████████████████▊             | 19/34 [00:01<00:00, 15.37batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 15.17batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 14.97batch/s] 82%|████████████████████████▋     | 28/34 [00:01<00:00, 15.13batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.95batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.43batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.42batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 38.39batch/s]  1%|▏                            | 8/1014 [00:00<00:28, 35.52batch/s]  1%|▎                           | 12/1014 [00:00<00:27, 35.85batch/s]  2%|▍                           | 17/1014 [00:00<00:26, 38.20batch/s]  2%|▌                           | 22/1014 [00:00<00:28, 34.61batch/s]  3%|▋                           | 27/1014 [00:00<00:28, 34.37batch/s]  3%|▉                           | 32/1014 [00:00<00:27, 35.11batch/s]  4%|█                           | 37/1014 [00:01<00:27, 35.28batch/s]  4%|█▏                          | 42/1014 [00:01<00:27, 35.70batch/s]  5%|█▎                          | 47/1014 [00:01<00:27, 35.38batch/s]  5%|█▍                          | 52/1014 [00:01<00:27, 34.93batch/s]  6%|█▌                          | 57/1014 [00:01<00:27, 34.88batch/s]  6%|█▋                          | 62/1014 [00:01<00:27, 34.57batch/s]  7%|█▊                          | 67/1014 [00:01<00:27, 34.86batch/s]  7%|█▉                          | 72/1014 [00:02<00:26, 35.32batch/s]  8%|██▏                         | 77/1014 [00:02<00:26, 35.45batch/s]  8%|██▎                         | 82/1014 [00:02<00:26, 35.38batch/s]  9%|██▍                         | 87/1014 [00:02<00:26, 35.52batch/s]  9%|██▌                         | 92/1014 [00:02<00:25, 35.76batch/s] 10%|██▋                         | 97/1014 [00:02<00:26, 34.59batch/s] 10%|██▋                        | 102/1014 [00:02<00:26, 34.22batch/s] 11%|██▊                        | 107/1014 [00:03<00:26, 34.38batch/s] 11%|██▉                        | 112/1014 [00:03<00:26, 34.26batch/s] 12%|███                        | 117/1014 [00:03<00:26, 34.29batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 34.46batch/s] 13%|███▍                       | 127/1014 [00:03<00:25, 34.85batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 34.53batch/s] 14%|███▋                       | 137/1014 [00:03<00:25, 34.40batch/s] 14%|███▊                       | 142/1014 [00:04<00:25, 34.48batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 34.75batch/s] 15%|████                       | 152/1014 [00:04<00:24, 34.68batch/s] 15%|████▏                      | 157/1014 [00:04<00:24, 34.75batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 34.80batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 34.82batch/s] 17%|████▌                      | 172/1014 [00:04<00:24, 34.75batch/s] 18%|████▋                      | 178/1014 [00:05<00:23, 35.14batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.25batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.22batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 35.19batch/s] 20%|█████▍                     | 202/1014 [00:05<00:23, 35.22batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 35.27batch/s] 21%|█████▋                     | 214/1014 [00:06<00:22, 35.26batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.16batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 35.20batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 35.20batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 35.34batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.36batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.40batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 35.43batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 35.39batch/s] 26%|███████▏                   | 268/1014 [00:07<00:21, 35.50batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.41batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.36batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 35.44batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.46batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 35.35batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 35.42batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 35.57batch/s] 31%|████████▍                  | 316/1014 [00:08<00:19, 35.40batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 35.40batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 35.46batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.45batch/s] 34%|█████████                  | 340/1014 [00:09<00:18, 35.50batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:18, 35.45batch/s] 35%|█████████▎                 | 352/1014 [00:09<00:18, 35.49batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 35.57batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.60batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 35.64batch/s] 37%|██████████                 | 376/1014 [00:10<00:17, 35.59batch/s] 38%|██████████▏                | 382/1014 [00:10<00:17, 35.61batch/s] 38%|██████████▎                | 388/1014 [00:10<00:17, 35.53batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.47batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.50batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 35.38batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 35.41batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 35.42batch/s] 42%|███████████▎               | 424/1014 [00:12<00:16, 35.24batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.06batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 35.14batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 35.23batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 35.19batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.22batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.26batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 35.32batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.35batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 35.42batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 35.31batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.37batch/s] 49%|█████████████▏             | 496/1014 [00:13<00:14, 35.47batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 35.41batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.43batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.44batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:13, 35.50batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 35.56batch/s] 52%|██████████████▏            | 532/1014 [00:14<00:13, 35.63batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.67batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.65batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:12, 35.70batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:12, 35.71batch/s] 55%|██████████████▉            | 562/1014 [00:15<00:12, 35.77batch/s] 56%|███████████████            | 568/1014 [00:15<00:12, 35.76batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.68batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.68batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 35.64batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:11, 35.60batch/s] 59%|███████████████▉           | 598/1014 [00:16<00:11, 35.49batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.45batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.45batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 35.46batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 35.36batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:10, 35.24batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 35.09batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 35.10batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 35.06batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 35.04batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 34.98batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.00batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.97batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 35.00batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 34.95batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.00batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.05batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.00batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 35.03batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 35.08batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.06batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.06batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.08batch/s] 73%|███████████████████▌       | 736/1014 [00:20<00:07, 35.12batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 35.15batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.18batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.17batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.19batch/s] 76%|████████████████████▍      | 766/1014 [00:21<00:07, 35.10batch/s] 76%|████████████████████▌      | 772/1014 [00:22<00:06, 35.01batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 34.95batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.91batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 34.92batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 34.94batch/s] 79%|█████████████████████▎     | 802/1014 [00:22<00:06, 34.96batch/s] 80%|█████████████████████▌     | 808/1014 [00:23<00:05, 35.02batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.05batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.04batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 35.03batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 35.03batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:05, 35.00batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.91batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 34.95batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 35.00batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 34.97batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 34.94batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.93batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.95batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 34.96batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 34.95batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.93batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 34.91batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.93batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.88batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 34.89batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.89batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.91batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 34.89batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.92batch/s] 94%|█████████████████████████▎ | 952/1014 [00:27<00:01, 34.91batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.92batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.90batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 34.89batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 34.89batch/s] 97%|██████████████████████████▏| 982/1014 [00:28<00:00, 34.88batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.88batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.82batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.84batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 34.85batch/s]100%|█████████████████████████▉| 1012/1014 [00:29<00:00, 34.84batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.84batch/s]
Validation 26 -> LOSS = 0.27
Validation 26 -> BLEU = 95.69, 98.2/96.4/94.9/93.3 (BP=1.000, ratio=1.000, hyp_len=14382, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.27 @ validation 26
--> Best BLEU so far: 95.69 @ validation 26
Starting Epoch 27
Epoch 27 - update      12540 => loss:   0.135 (#OOM: 0)
Epoch 27 - update      12570 => loss:   0.151 (#OOM: 0)
Epoch 27 - update      12600 => loss:   0.099 (#OOM: 0)
Epoch 27 - update      12630 => loss:   0.160 (#OOM: 0)
Epoch 27 - update      12660 => loss:   0.124 (#OOM: 0)
Epoch 27 - update      12690 => loss:   0.216 (#OOM: 0)
Epoch 27 - update      12720 => loss:   0.160 (#OOM: 0)
Epoch 27 - update      12750 => loss:   0.197 (#OOM: 0)
Epoch 27 - update      12780 => loss:   0.125 (#OOM: 0)
Epoch 27 - update      12810 => loss:   0.155 (#OOM: 0)
Epoch 27 - update      12840 => loss:   0.143 (#OOM: 0)
Epoch 27 - update      12870 => loss:   0.176 (#OOM: 0)
Epoch 27 - update      12900 => loss:   0.165 (#OOM: 0)
Epoch 27 - update      12930 => loss:   0.209 (#OOM: 0)
Epoch 27 - update      12960 => loss:   0.194 (#OOM: 0)
Epoch 27 - update      12990 => loss:   0.164 (#OOM: 0)
--> Epoch 27 finished with mean loss 0.15854
--> Overhead/Training/Evaluation: 0.62/0.70/0.00 mins (total: 1.32 mins)   (692 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.53batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 13.67batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 11.38batch/s] 21%|██████▍                        | 7/34 [00:00<00:02, 11.60batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.57batch/s] 38%|███████████▍                  | 13/34 [00:01<00:01, 12.64batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.73batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.31batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.39batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.90batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.53batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.74batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.95batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.94batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 34.96batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.10batch/s]  1%|▎                           | 12/1014 [00:00<00:30, 33.13batch/s]  2%|▍                           | 16/1014 [00:00<00:30, 33.01batch/s]  2%|▌                           | 20/1014 [00:00<00:29, 33.98batch/s]  2%|▋                           | 25/1014 [00:00<00:27, 35.45batch/s]  3%|▊                           | 30/1014 [00:00<00:28, 34.74batch/s]  3%|▉                           | 35/1014 [00:00<00:27, 35.12batch/s]  4%|█                           | 40/1014 [00:01<00:27, 36.07batch/s]  4%|█▏                          | 45/1014 [00:01<00:26, 36.87batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.37batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.62batch/s]  6%|█▋                          | 60/1014 [00:01<00:25, 37.08batch/s]  6%|█▊                          | 65/1014 [00:01<00:25, 37.41batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 37.12batch/s]  7%|██                          | 75/1014 [00:02<00:25, 37.04batch/s]  8%|██▏                         | 80/1014 [00:02<00:25, 36.63batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.68batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 36.49batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 36.40batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 35.60batch/s] 10%|██▊                        | 105/1014 [00:02<00:25, 35.39batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 35.54batch/s] 11%|███                        | 115/1014 [00:03<00:25, 35.49batch/s] 12%|███▏                       | 120/1014 [00:03<00:25, 35.20batch/s] 12%|███▎                       | 125/1014 [00:03<00:25, 35.47batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 35.64batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 35.67batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.88batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.80batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.88batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.74batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 35.97batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 35.91batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 35.67batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.82batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.68batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.57batch/s] 19%|█████                      | 190/1014 [00:05<00:23, 35.59batch/s] 19%|█████▏                     | 195/1014 [00:05<00:23, 35.51batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.45batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.44batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.37batch/s] 21%|█████▋                     | 215/1014 [00:06<00:22, 35.34batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.14batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 35.12batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 35.13batch/s] 23%|██████▎                    | 235/1014 [00:06<00:22, 35.28batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.40batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.34batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.44batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.30batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.31batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.20batch/s] 27%|███████▏                   | 270/1014 [00:07<00:21, 35.00batch/s] 27%|███████▎                   | 275/1014 [00:07<00:21, 35.08batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.18batch/s] 28%|███████▌                   | 285/1014 [00:08<00:20, 35.07batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 35.08batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.08batch/s] 30%|███████▉                   | 300/1014 [00:08<00:20, 35.10batch/s] 30%|████████                   | 305/1014 [00:08<00:20, 35.09batch/s] 31%|████████▎                  | 310/1014 [00:08<00:20, 35.08batch/s] 31%|████████▍                  | 315/1014 [00:09<00:20, 34.92batch/s] 32%|████████▌                  | 320/1014 [00:09<00:19, 34.99batch/s] 32%|████████▋                  | 325/1014 [00:09<00:19, 34.95batch/s] 33%|████████▊                  | 330/1014 [00:09<00:19, 35.03batch/s] 33%|████████▉                  | 335/1014 [00:09<00:19, 35.01batch/s] 34%|█████████                  | 340/1014 [00:09<00:19, 34.83batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:19, 34.90batch/s] 35%|█████████▎                 | 350/1014 [00:10<00:19, 34.84batch/s] 35%|█████████▍                 | 355/1014 [00:10<00:19, 34.63batch/s] 36%|█████████▌                 | 360/1014 [00:10<00:18, 34.61batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:18, 34.54batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:18, 34.61batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:18, 34.45batch/s] 37%|██████████                 | 380/1014 [00:11<00:18, 34.50batch/s] 38%|██████████▎                | 385/1014 [00:11<00:18, 34.43batch/s] 38%|██████████▍                | 390/1014 [00:11<00:18, 34.46batch/s] 39%|██████████▌                | 395/1014 [00:11<00:17, 34.52batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 34.53batch/s] 40%|██████████▊                | 405/1014 [00:11<00:17, 34.57batch/s] 40%|██████████▉                | 410/1014 [00:11<00:17, 34.62batch/s] 41%|███████████                | 415/1014 [00:11<00:17, 34.74batch/s] 41%|███████████▏               | 420/1014 [00:12<00:17, 34.75batch/s] 42%|███████████▎               | 425/1014 [00:12<00:16, 34.81batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 34.83batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 34.80batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 34.87batch/s] 44%|███████████▊               | 445/1014 [00:12<00:16, 34.93batch/s] 44%|███████████▉               | 450/1014 [00:12<00:16, 34.97batch/s] 45%|████████████               | 455/1014 [00:13<00:15, 34.94batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 34.90batch/s] 46%|████████████▍              | 465/1014 [00:13<00:15, 34.88batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 34.85batch/s] 47%|████████████▋              | 475/1014 [00:13<00:15, 34.86batch/s] 47%|████████████▊              | 480/1014 [00:13<00:15, 34.91batch/s] 48%|████████████▉              | 485/1014 [00:13<00:15, 34.94batch/s] 48%|█████████████              | 490/1014 [00:14<00:14, 34.96batch/s] 49%|█████████████▏             | 495/1014 [00:14<00:14, 34.97batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.04batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 35.00batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 34.95batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:14, 35.00batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 35.02batch/s] 52%|█████████████▉             | 525/1014 [00:15<00:13, 34.96batch/s] 52%|██████████████             | 530/1014 [00:15<00:13, 34.98batch/s] 53%|██████████████▏            | 535/1014 [00:15<00:13, 34.99batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 35.01batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 34.95batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 34.96batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:13, 34.98batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.02batch/s] 56%|███████████████            | 565/1014 [00:16<00:12, 35.01batch/s] 56%|███████████████▏           | 570/1014 [00:16<00:12, 35.02batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 34.97batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 34.95batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:12, 34.93batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:12, 34.95batch/s] 59%|███████████████▊           | 595/1014 [00:17<00:12, 34.90batch/s] 59%|███████████████▉           | 600/1014 [00:17<00:11, 34.89batch/s] 60%|████████████████           | 605/1014 [00:17<00:11, 34.89batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 34.92batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 34.93batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 34.90batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:11, 34.90batch/s] 62%|████████████████▊          | 630/1014 [00:18<00:11, 34.89batch/s] 63%|████████████████▉          | 635/1014 [00:18<00:10, 34.86batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 34.82batch/s] 64%|█████████████████▏         | 645/1014 [00:18<00:10, 34.83batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 34.85batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 34.89batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:10, 34.90batch/s] 66%|█████████████████▋         | 665/1014 [00:19<00:09, 34.96batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 34.94batch/s] 67%|█████████████████▉         | 675/1014 [00:19<00:09, 34.93batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 34.94batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 34.95batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 34.96batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:09, 35.02batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.02batch/s] 70%|██████████████████▊        | 705/1014 [00:20<00:08, 35.05batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.05batch/s] 71%|███████████████████        | 715/1014 [00:20<00:08, 35.07batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.07batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.08batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.02batch/s] 72%|███████████████████▌       | 735/1014 [00:20<00:07, 35.04batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 35.08batch/s] 73%|███████████████████▊       | 745/1014 [00:21<00:07, 35.10batch/s] 74%|███████████████████▉       | 750/1014 [00:21<00:07, 35.09batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.04batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.05batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:07, 35.04batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.08batch/s] 76%|████████████████████▋      | 775/1014 [00:22<00:06, 35.12batch/s] 77%|████████████████████▊      | 780/1014 [00:22<00:06, 35.14batch/s] 77%|████████████████████▉      | 785/1014 [00:22<00:06, 35.15batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.11batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 35.14batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 35.19batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.19batch/s] 80%|█████████████████████▌     | 810/1014 [00:23<00:05, 35.16batch/s] 80%|█████████████████████▋     | 815/1014 [00:23<00:05, 35.15batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.13batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 35.13batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.10batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.10batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.13batch/s] 83%|██████████████████████▌    | 845/1014 [00:24<00:04, 35.12batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 35.12batch/s] 84%|██████████████████████▊    | 855/1014 [00:24<00:04, 35.15batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 35.18batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.17batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.17batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.17batch/s] 87%|███████████████████████▍   | 880/1014 [00:24<00:03, 35.22batch/s] 87%|███████████████████████▌   | 885/1014 [00:25<00:03, 35.19batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 35.15batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.17batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.15batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.17batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.20batch/s] 90%|████████████████████████▎  | 915/1014 [00:25<00:02, 35.19batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 35.14batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.16batch/s] 92%|████████████████████████▊  | 930/1014 [00:26<00:02, 35.17batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.17batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.12batch/s] 93%|█████████████████████████▏ | 945/1014 [00:26<00:01, 35.13batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 35.12batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.08batch/s] 95%|█████████████████████████▌ | 960/1014 [00:27<00:01, 35.06batch/s] 95%|█████████████████████████▋ | 965/1014 [00:27<00:01, 35.08batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.12batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 35.18batch/s] 97%|██████████████████████████▏| 982/1014 [00:27<00:00, 35.19batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 35.20batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.23batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 35.25batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 35.26batch/s]100%|█████████████████████████▉| 1012/1014 [00:28<00:00, 35.22batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.20batch/s]
Validation 27 -> LOSS = 0.26
Validation 27 -> BLEU = 95.87, 98.3/96.5/95.1/93.6 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.26 @ validation 27
--> Best BLEU so far: 95.87 @ validation 27
Starting Epoch 28
Epoch 28 - update      13020 => loss:   0.126 (#OOM: 0)
Epoch 28 - update      13050 => loss:   0.143 (#OOM: 0)
Epoch 28 - update      13080 => loss:   0.180 (#OOM: 0)
Epoch 28 - update      13110 => loss:   0.119 (#OOM: 0)
Epoch 28 - update      13140 => loss:   0.093 (#OOM: 0)
Epoch 28 - update      13170 => loss:   0.125 (#OOM: 0)
Epoch 28 - update      13200 => loss:   0.169 (#OOM: 0)
Epoch 28 - update      13230 => loss:   0.099 (#OOM: 0)
Epoch 28 - update      13260 => loss:   0.134 (#OOM: 0)
Epoch 28 - update      13290 => loss:   0.128 (#OOM: 0)
Epoch 28 - update      13320 => loss:   0.134 (#OOM: 0)
Epoch 28 - update      13350 => loss:   0.160 (#OOM: 0)
Epoch 28 - update      13380 => loss:   0.248 (#OOM: 0)
Epoch 28 - update      13410 => loss:   0.133 (#OOM: 0)
Epoch 28 - update      13440 => loss:   0.154 (#OOM: 0)
Epoch 28 - update      13470 => loss:   0.001 (#OOM: 0)
--> Epoch 28 finished with mean loss 0.15328
--> Overhead/Training/Evaluation: 0.61/0.70/0.00 mins (total: 1.31 mins)   (688 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  8.38batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 16.21batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 14.14batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.91batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 13.96batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 13.40batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 13.18batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 13.22batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.21batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.94batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.08batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.39batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.39batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|▏                            | 5/1014 [00:00<00:24, 41.10batch/s]  1%|▎                           | 10/1014 [00:00<00:26, 37.43batch/s]  1%|▍                           | 15/1014 [00:00<00:26, 38.18batch/s]  2%|▌                           | 20/1014 [00:00<00:26, 37.10batch/s]  2%|▋                           | 25/1014 [00:00<00:27, 36.56batch/s]  3%|▊                           | 30/1014 [00:00<00:26, 37.76batch/s]  3%|▉                           | 35/1014 [00:00<00:25, 37.84batch/s]  4%|█                           | 40/1014 [00:01<00:26, 37.18batch/s]  4%|█▏                          | 45/1014 [00:01<00:25, 37.60batch/s]  5%|█▍                          | 50/1014 [00:01<00:25, 38.50batch/s]  5%|█▌                          | 55/1014 [00:01<00:25, 38.05batch/s]  6%|█▋                          | 60/1014 [00:01<00:25, 37.91batch/s]  6%|█▊                          | 65/1014 [00:01<00:24, 38.15batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 37.40batch/s]  7%|██                          | 75/1014 [00:02<00:25, 37.45batch/s]  8%|██▏                         | 80/1014 [00:02<00:25, 36.85batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.72batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 36.54batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 36.62batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 36.49batch/s] 10%|██▊                        | 105/1014 [00:02<00:24, 36.61batch/s] 11%|██▉                        | 110/1014 [00:03<00:24, 36.19batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.27batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 36.42batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 36.22batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 36.38batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 36.54batch/s] 14%|███▋                       | 140/1014 [00:03<00:23, 36.62batch/s] 14%|███▊                       | 145/1014 [00:03<00:23, 36.48batch/s] 15%|███▉                       | 150/1014 [00:04<00:23, 36.29batch/s] 15%|████▏                      | 155/1014 [00:04<00:23, 36.33batch/s] 16%|████▎                      | 160/1014 [00:04<00:23, 36.21batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 36.40batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 36.11batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 36.14batch/s] 18%|████▊                      | 180/1014 [00:04<00:23, 36.14batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.99batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 36.12batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 36.07batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 36.13batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 36.20batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 36.27batch/s] 21%|█████▋                     | 215/1014 [00:05<00:22, 36.13batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.98batch/s] 22%|█████▉                     | 225/1014 [00:06<00:21, 36.06batch/s] 23%|██████                     | 230/1014 [00:06<00:21, 36.13batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 36.23batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 36.18batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 36.13batch/s] 25%|██████▋                    | 250/1014 [00:06<00:21, 35.82batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.77batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.89batch/s] 26%|███████                    | 265/1014 [00:07<00:20, 35.73batch/s] 27%|███████▏                   | 270/1014 [00:07<00:20, 35.88batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.91batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.96batch/s] 28%|███████▌                   | 285/1014 [00:07<00:20, 35.92batch/s] 29%|███████▋                   | 290/1014 [00:08<00:20, 36.02batch/s] 29%|███████▊                   | 295/1014 [00:08<00:20, 35.95batch/s] 30%|███████▉                   | 300/1014 [00:08<00:19, 36.00batch/s] 30%|████████                   | 305/1014 [00:08<00:19, 36.00batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 35.96batch/s] 31%|████████▍                  | 315/1014 [00:08<00:19, 35.99batch/s] 32%|████████▌                  | 320/1014 [00:08<00:19, 36.11batch/s] 32%|████████▋                  | 325/1014 [00:08<00:19, 36.20batch/s] 33%|████████▊                  | 330/1014 [00:09<00:18, 36.27batch/s] 33%|████████▉                  | 335/1014 [00:09<00:18, 36.32batch/s] 34%|█████████                  | 340/1014 [00:09<00:18, 36.36batch/s] 34%|█████████▏                 | 345/1014 [00:09<00:18, 36.46batch/s] 35%|█████████▎                 | 350/1014 [00:09<00:18, 36.39batch/s] 35%|█████████▍                 | 355/1014 [00:09<00:18, 36.38batch/s] 36%|█████████▌                 | 360/1014 [00:09<00:17, 36.40batch/s] 36%|█████████▋                 | 365/1014 [00:10<00:17, 36.34batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:17, 36.32batch/s] 37%|█████████▉                 | 375/1014 [00:10<00:17, 36.27batch/s] 37%|██████████                 | 380/1014 [00:10<00:17, 36.26batch/s] 38%|██████████▎                | 385/1014 [00:10<00:17, 36.27batch/s] 38%|██████████▍                | 390/1014 [00:10<00:17, 36.22batch/s] 39%|██████████▌                | 395/1014 [00:10<00:17, 36.18batch/s] 39%|██████████▋                | 400/1014 [00:11<00:16, 36.20batch/s] 40%|██████████▊                | 405/1014 [00:11<00:16, 36.05batch/s] 40%|██████████▉                | 410/1014 [00:11<00:16, 36.08batch/s] 41%|███████████                | 415/1014 [00:11<00:16, 36.09batch/s] 41%|███████████▏               | 420/1014 [00:11<00:16, 36.15batch/s] 42%|███████████▎               | 425/1014 [00:11<00:16, 36.07batch/s] 42%|███████████▍               | 430/1014 [00:11<00:16, 36.11batch/s] 43%|███████████▌               | 435/1014 [00:12<00:16, 36.16batch/s] 43%|███████████▋               | 440/1014 [00:12<00:15, 36.11batch/s] 44%|███████████▊               | 445/1014 [00:12<00:15, 36.04batch/s] 44%|███████████▉               | 450/1014 [00:12<00:15, 36.04batch/s] 45%|████████████               | 455/1014 [00:12<00:15, 36.15batch/s] 45%|████████████▏              | 460/1014 [00:12<00:15, 36.13batch/s] 46%|████████████▍              | 465/1014 [00:12<00:15, 36.10batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 36.07batch/s] 47%|████████████▋              | 475/1014 [00:13<00:14, 36.01batch/s] 47%|████████████▊              | 480/1014 [00:13<00:14, 36.00batch/s] 48%|████████████▉              | 485/1014 [00:13<00:14, 35.96batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.95batch/s] 49%|█████████████▏             | 495/1014 [00:13<00:14, 36.00batch/s] 49%|█████████████▎             | 500/1014 [00:13<00:14, 36.06batch/s] 50%|█████████████▍             | 505/1014 [00:14<00:14, 36.04batch/s] 50%|█████████████▌             | 510/1014 [00:14<00:14, 35.96batch/s] 51%|█████████████▋             | 515/1014 [00:14<00:13, 35.99batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:13, 36.01batch/s] 52%|█████████████▉             | 525/1014 [00:14<00:13, 35.97batch/s] 52%|██████████████             | 530/1014 [00:14<00:13, 35.91batch/s] 53%|██████████████▏            | 535/1014 [00:14<00:13, 35.90batch/s] 53%|██████████████▍            | 540/1014 [00:15<00:13, 35.89batch/s] 54%|██████████████▌            | 545/1014 [00:15<00:13, 35.89batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:12, 35.94batch/s] 55%|██████████████▊            | 555/1014 [00:15<00:12, 35.93batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.89batch/s] 56%|███████████████            | 565/1014 [00:15<00:12, 35.84batch/s] 56%|███████████████▏           | 570/1014 [00:15<00:12, 35.73batch/s] 57%|███████████████▎           | 575/1014 [00:16<00:12, 35.77batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.80batch/s] 58%|███████████████▌           | 585/1014 [00:16<00:11, 35.83batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:11, 35.82batch/s] 59%|███████████████▊           | 595/1014 [00:16<00:11, 35.84batch/s] 59%|███████████████▉           | 600/1014 [00:16<00:11, 35.84batch/s] 60%|████████████████           | 605/1014 [00:16<00:11, 35.80batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.82batch/s] 61%|████████████████▍          | 615/1014 [00:17<00:11, 35.83batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:10, 35.84batch/s] 62%|████████████████▋          | 625/1014 [00:17<00:10, 35.84batch/s] 62%|████████████████▊          | 630/1014 [00:17<00:10, 35.88batch/s] 63%|████████████████▉          | 635/1014 [00:17<00:10, 35.89batch/s] 63%|█████████████████          | 640/1014 [00:17<00:10, 35.84batch/s] 64%|█████████████████▏         | 645/1014 [00:17<00:10, 35.85batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.83batch/s] 65%|█████████████████▍         | 655/1014 [00:18<00:10, 35.86batch/s] 65%|█████████████████▌         | 660/1014 [00:18<00:09, 35.84batch/s] 66%|█████████████████▋         | 665/1014 [00:18<00:09, 35.80batch/s] 66%|█████████████████▊         | 670/1014 [00:18<00:09, 35.81batch/s] 67%|█████████████████▉         | 675/1014 [00:18<00:09, 35.80batch/s] 67%|██████████████████         | 680/1014 [00:18<00:09, 35.83batch/s] 68%|██████████████████▏        | 685/1014 [00:19<00:09, 35.85batch/s] 68%|██████████████████▎        | 690/1014 [00:19<00:09, 35.83batch/s] 69%|██████████████████▌        | 695/1014 [00:19<00:08, 35.86batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.87batch/s] 70%|██████████████████▊        | 705/1014 [00:19<00:08, 35.77batch/s] 70%|██████████████████▉        | 710/1014 [00:19<00:08, 35.75batch/s] 71%|███████████████████        | 715/1014 [00:19<00:08, 35.80batch/s] 71%|███████████████████▏       | 720/1014 [00:20<00:08, 35.79batch/s] 71%|███████████████████▎       | 725/1014 [00:20<00:08, 35.79batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:07, 35.81batch/s] 72%|███████████████████▌       | 735/1014 [00:20<00:07, 35.82batch/s] 73%|███████████████████▋       | 740/1014 [00:20<00:07, 35.80batch/s] 73%|███████████████████▊       | 745/1014 [00:20<00:07, 35.76batch/s] 74%|███████████████████▉       | 750/1014 [00:20<00:07, 35.79batch/s] 74%|████████████████████       | 755/1014 [00:21<00:07, 35.79batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.78batch/s] 75%|████████████████████▎      | 765/1014 [00:21<00:06, 35.75batch/s] 76%|████████████████████▌      | 770/1014 [00:21<00:06, 35.75batch/s] 76%|████████████████████▋      | 775/1014 [00:21<00:06, 35.77batch/s] 77%|████████████████████▊      | 780/1014 [00:21<00:06, 35.77batch/s] 77%|████████████████████▉      | 785/1014 [00:21<00:06, 35.77batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.76batch/s] 78%|█████████████████████▏     | 795/1014 [00:22<00:06, 35.77batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:05, 35.78batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.80batch/s] 80%|█████████████████████▌     | 810/1014 [00:22<00:05, 35.78batch/s] 80%|█████████████████████▋     | 815/1014 [00:22<00:05, 35.75batch/s] 81%|█████████████████████▊     | 820/1014 [00:22<00:05, 35.71batch/s] 81%|█████████████████████▉     | 825/1014 [00:23<00:05, 35.70batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 35.66batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.65batch/s] 83%|██████████████████████▎    | 840/1014 [00:23<00:04, 35.66batch/s] 83%|██████████████████████▌    | 845/1014 [00:23<00:04, 35.68batch/s] 84%|██████████████████████▋    | 850/1014 [00:23<00:04, 35.71batch/s] 84%|██████████████████████▊    | 855/1014 [00:23<00:04, 35.71batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 35.73batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.75batch/s] 86%|███████████████████████▏   | 870/1014 [00:24<00:04, 35.77batch/s] 86%|███████████████████████▎   | 875/1014 [00:24<00:03, 35.76batch/s] 87%|███████████████████████▍   | 880/1014 [00:24<00:03, 35.77batch/s] 87%|███████████████████████▌   | 885/1014 [00:24<00:03, 35.81batch/s] 88%|███████████████████████▋   | 890/1014 [00:24<00:03, 35.80batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.75batch/s] 89%|███████████████████████▉   | 900/1014 [00:25<00:03, 35.77batch/s] 89%|████████████████████████   | 905/1014 [00:25<00:03, 35.79batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.80batch/s] 90%|████████████████████████▎  | 915/1014 [00:25<00:02, 35.84batch/s] 91%|████████████████████████▍  | 920/1014 [00:25<00:02, 35.82batch/s] 91%|████████████████████████▋  | 925/1014 [00:25<00:02, 35.80batch/s] 92%|████████████████████████▊  | 930/1014 [00:25<00:02, 35.81batch/s] 92%|████████████████████████▉  | 935/1014 [00:26<00:02, 35.77batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.78batch/s] 93%|█████████████████████████▏ | 945/1014 [00:26<00:01, 35.80batch/s] 94%|█████████████████████████▎ | 950/1014 [00:26<00:01, 35.78batch/s] 94%|█████████████████████████▍ | 955/1014 [00:26<00:01, 35.77batch/s] 95%|█████████████████████████▌ | 960/1014 [00:26<00:01, 35.77batch/s] 95%|█████████████████████████▋ | 965/1014 [00:26<00:01, 35.75batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.74batch/s] 96%|█████████████████████████▉ | 975/1014 [00:27<00:01, 35.79batch/s] 97%|██████████████████████████ | 980/1014 [00:27<00:00, 35.74batch/s] 97%|██████████████████████████▏| 985/1014 [00:27<00:00, 35.70batch/s] 98%|██████████████████████████▎| 990/1014 [00:27<00:00, 35.70batch/s] 98%|██████████████████████████▍| 995/1014 [00:27<00:00, 35.67batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 35.67batch/s] 99%|█████████████████████████▊| 1005/1014 [00:28<00:00, 35.70batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 35.71batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.69batch/s]
Validation 28 -> LOSS = 0.26
Validation 28 -> BLEU = 95.89, 98.3/96.6/95.1/93.6 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.26 @ validation 27
--> Best BLEU so far: 95.89 @ validation 28
Starting Epoch 29
Epoch 29 - update      13500 => loss:   0.157 (#OOM: 0)
Epoch 29 - update      13530 => loss:   0.186 (#OOM: 0)
Epoch 29 - update      13560 => loss:   0.098 (#OOM: 0)
Epoch 29 - update      13590 => loss:   0.149 (#OOM: 0)
Epoch 29 - update      13620 => loss:   0.108 (#OOM: 0)
Epoch 29 - update      13650 => loss:   0.091 (#OOM: 0)
Epoch 29 - update      13680 => loss:   0.199 (#OOM: 0)
Epoch 29 - update      13710 => loss:   0.088 (#OOM: 0)
Epoch 29 - update      13740 => loss:   0.053 (#OOM: 0)
Epoch 29 - update      13770 => loss:   0.140 (#OOM: 0)
Epoch 29 - update      13800 => loss:   0.160 (#OOM: 0)
Epoch 29 - update      13830 => loss:   0.211 (#OOM: 0)
Epoch 29 - update      13860 => loss:   0.047 (#OOM: 0)
Epoch 29 - update      13890 => loss:   0.113 (#OOM: 0)
Epoch 29 - update      13920 => loss:   0.143 (#OOM: 0)
Epoch 29 - update      13950 => loss:   0.143 (#OOM: 0)
--> Epoch 29 finished with mean loss 0.14703
--> Overhead/Training/Evaluation: 0.63/0.71/0.00 mins (total: 1.34 mins)   (680 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 11.20batch/s] 15%|████▌                          | 5/34 [00:00<00:02, 13.69batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.36batch/s] 32%|█████████▋                    | 11/34 [00:00<00:01, 13.48batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.55batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 14.79batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 13.81batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 13.66batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 14.20batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 13.82batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 13.79batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.72batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:27, 36.23batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 34.32batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 35.54batch/s]  2%|▍                           | 16/1014 [00:00<00:27, 36.09batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 35.97batch/s]  2%|▋                           | 25/1014 [00:00<00:27, 36.53batch/s]  3%|▊                           | 30/1014 [00:00<00:27, 36.16batch/s]  3%|▉                           | 35/1014 [00:00<00:27, 35.88batch/s]  4%|█                           | 40/1014 [00:01<00:27, 35.79batch/s]  4%|█▏                          | 45/1014 [00:01<00:27, 35.70batch/s]  5%|█▍                          | 50/1014 [00:01<00:26, 36.13batch/s]  5%|█▌                          | 55/1014 [00:01<00:26, 36.55batch/s]  6%|█▋                          | 60/1014 [00:01<00:26, 36.55batch/s]  6%|█▊                          | 65/1014 [00:01<00:25, 36.84batch/s]  7%|█▉                          | 70/1014 [00:01<00:25, 36.61batch/s]  7%|██                          | 75/1014 [00:02<00:25, 36.53batch/s]  8%|██▏                         | 80/1014 [00:02<00:25, 36.10batch/s]  8%|██▎                         | 85/1014 [00:02<00:25, 36.24batch/s]  9%|██▍                         | 90/1014 [00:02<00:25, 35.66batch/s]  9%|██▌                         | 95/1014 [00:02<00:25, 35.69batch/s] 10%|██▋                        | 100/1014 [00:02<00:25, 35.74batch/s] 10%|██▊                        | 105/1014 [00:02<00:25, 35.92batch/s] 11%|██▉                        | 110/1014 [00:03<00:25, 36.09batch/s] 11%|███                        | 115/1014 [00:03<00:24, 36.31batch/s] 12%|███▏                       | 120/1014 [00:03<00:24, 36.23batch/s] 12%|███▎                       | 125/1014 [00:03<00:24, 35.96batch/s] 13%|███▍                       | 130/1014 [00:03<00:24, 35.78batch/s] 13%|███▌                       | 135/1014 [00:03<00:24, 35.76batch/s] 14%|███▋                       | 140/1014 [00:03<00:24, 35.54batch/s] 14%|███▊                       | 145/1014 [00:04<00:24, 35.60batch/s] 15%|███▉                       | 150/1014 [00:04<00:24, 35.53batch/s] 15%|████▏                      | 155/1014 [00:04<00:24, 35.65batch/s] 16%|████▎                      | 160/1014 [00:04<00:24, 35.46batch/s] 16%|████▍                      | 165/1014 [00:04<00:23, 35.66batch/s] 17%|████▌                      | 170/1014 [00:04<00:23, 35.71batch/s] 17%|████▋                      | 175/1014 [00:04<00:23, 35.67batch/s] 18%|████▊                      | 180/1014 [00:05<00:23, 35.82batch/s] 18%|████▉                      | 185/1014 [00:05<00:23, 35.85batch/s] 19%|█████                      | 190/1014 [00:05<00:22, 35.98batch/s] 19%|█████▏                     | 195/1014 [00:05<00:22, 35.85batch/s] 20%|█████▎                     | 200/1014 [00:05<00:22, 35.82batch/s] 20%|█████▍                     | 205/1014 [00:05<00:22, 35.88batch/s] 21%|█████▌                     | 210/1014 [00:05<00:22, 35.91batch/s] 21%|█████▋                     | 215/1014 [00:05<00:22, 35.95batch/s] 22%|█████▊                     | 220/1014 [00:06<00:22, 35.71batch/s] 22%|█████▉                     | 225/1014 [00:06<00:22, 35.61batch/s] 23%|██████                     | 230/1014 [00:06<00:22, 35.58batch/s] 23%|██████▎                    | 235/1014 [00:06<00:21, 35.57batch/s] 24%|██████▍                    | 240/1014 [00:06<00:21, 35.58batch/s] 24%|██████▌                    | 245/1014 [00:06<00:21, 35.68batch/s] 25%|██████▋                    | 250/1014 [00:07<00:21, 35.50batch/s] 25%|██████▊                    | 255/1014 [00:07<00:21, 35.56batch/s] 26%|██████▉                    | 260/1014 [00:07<00:21, 35.42batch/s] 26%|███████                    | 265/1014 [00:07<00:21, 35.53batch/s] 27%|███████▏                   | 270/1014 [00:07<00:20, 35.54batch/s] 27%|███████▎                   | 275/1014 [00:07<00:20, 35.45batch/s] 28%|███████▍                   | 280/1014 [00:07<00:20, 35.49batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 35.63batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.60batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 35.73batch/s] 30%|████████                   | 304/1014 [00:08<00:19, 35.79batch/s] 31%|████████▎                  | 310/1014 [00:08<00:19, 35.82batch/s] 31%|████████▍                  | 316/1014 [00:08<00:19, 35.89batch/s] 32%|████████▌                  | 322/1014 [00:08<00:19, 35.92batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 36.04batch/s] 33%|████████▉                  | 334/1014 [00:09<00:18, 36.12batch/s] 34%|█████████                  | 340/1014 [00:09<00:18, 36.10batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:18, 36.09batch/s] 35%|█████████▎                 | 352/1014 [00:09<00:18, 36.00batch/s] 35%|█████████▌                 | 358/1014 [00:09<00:18, 35.90batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.89batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:17, 35.95batch/s] 37%|██████████                 | 376/1014 [00:10<00:17, 35.52batch/s] 38%|██████████▏                | 382/1014 [00:10<00:17, 35.45batch/s] 38%|██████████▎                | 388/1014 [00:10<00:17, 35.55batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.47batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 35.51batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 35.53batch/s] 41%|██████████▉                | 412/1014 [00:11<00:17, 35.41batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 35.45batch/s] 42%|███████████▎               | 424/1014 [00:11<00:16, 35.41batch/s] 42%|███████████▍               | 430/1014 [00:12<00:16, 35.37batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 35.30batch/s] 44%|███████████▊               | 442/1014 [00:12<00:16, 35.32batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 35.31batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.25batch/s] 45%|████████████▏              | 460/1014 [00:13<00:15, 35.19batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 35.18batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.10batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 35.19batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 35.19batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.19batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 35.17batch/s] 50%|█████████████▎             | 502/1014 [00:14<00:14, 35.17batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.03batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.04batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:14, 35.05batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 35.12batch/s] 52%|██████████████▏            | 532/1014 [00:15<00:13, 35.16batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.20batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.15batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 35.14batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:13, 35.12batch/s] 55%|██████████████▉            | 562/1014 [00:15<00:12, 35.14batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 35.14batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.16batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.13batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 35.15batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:11, 35.18batch/s] 59%|███████████████▉           | 598/1014 [00:17<00:11, 35.09batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.07batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.06batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 35.14batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 35.12batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:11, 35.09batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 35.12batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 35.11batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 35.10batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 35.09batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 35.11batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.09batch/s] 66%|█████████████████▊         | 670/1014 [00:19<00:09, 35.14batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 35.11batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 35.14batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.12batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.08batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.05batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 35.08batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 35.14batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.14batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.18batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.21batch/s] 73%|███████████████████▌       | 736/1014 [00:20<00:07, 35.17batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 35.18batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.19batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.22batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.20batch/s] 76%|████████████████████▍      | 766/1014 [00:21<00:07, 35.15batch/s] 76%|████████████████████▌      | 772/1014 [00:21<00:06, 35.15batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 35.19batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.22batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.24batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 35.24batch/s] 79%|█████████████████████▎     | 802/1014 [00:22<00:06, 35.19batch/s] 80%|█████████████████████▌     | 808/1014 [00:22<00:05, 35.18batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.13batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.10batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 35.09batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 35.14batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:05, 35.08batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 35.04batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 35.03batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 35.05batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 35.07batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 35.09batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.05batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 34.95batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 34.95batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 34.93batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 34.92batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 34.93batch/s] 90%|████████████████████████▏  | 910/1014 [00:26<00:02, 34.86batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 34.80batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 34.76batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 34.76batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.76batch/s] 93%|█████████████████████████  | 940/1014 [00:27<00:02, 34.81batch/s] 93%|█████████████████████████▏ | 946/1014 [00:27<00:01, 34.81batch/s] 94%|█████████████████████████▎ | 952/1014 [00:27<00:01, 34.80batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 34.79batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.79batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 34.80batch/s] 96%|█████████████████████████▉ | 976/1014 [00:28<00:01, 34.82batch/s] 97%|██████████████████████████▏| 982/1014 [00:28<00:00, 34.82batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 34.86batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.87batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 34.86batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 34.85batch/s]100%|█████████████████████████▉| 1012/1014 [00:29<00:00, 34.84batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.84batch/s]
Validation 29 -> LOSS = 0.26
Validation 29 -> BLEU = 95.66, 98.3/96.5/95.0/93.4 (BP=0.999, ratio=0.999, hyp_len=14367, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.26 @ validation 29
--> Best BLEU so far: 95.89 @ validation 28
Starting Epoch 30
Epoch 30 - update      13980 => loss:   0.194 (#OOM: 0)
Epoch 30 - update      14010 => loss:   0.117 (#OOM: 0)
Epoch 30 - update      14040 => loss:   0.156 (#OOM: 0)
Epoch 30 - update      14070 => loss:   0.071 (#OOM: 0)
Epoch 30 - update      14100 => loss:   0.144 (#OOM: 0)
Epoch 30 - update      14130 => loss:   0.112 (#OOM: 0)
Epoch 30 - update      14160 => loss:   0.139 (#OOM: 0)
Epoch 30 - update      14190 => loss:   0.060 (#OOM: 0)
Epoch 30 - update      14220 => loss:   0.165 (#OOM: 0)
Epoch 30 - update      14250 => loss:   0.147 (#OOM: 0)
Epoch 30 - update      14280 => loss:   0.113 (#OOM: 0)
Epoch 30 - update      14310 => loss:   0.132 (#OOM: 0)
Epoch 30 - update      14340 => loss:   0.067 (#OOM: 0)
Epoch 30 - update      14370 => loss:   0.114 (#OOM: 0)
Epoch 30 - update      14400 => loss:   0.093 (#OOM: 0)
Epoch 30 - update      14430 => loss:   0.146 (#OOM: 0)
Epoch 30 - update      14460 => loss:   0.183 (#OOM: 0)
--> Epoch 30 finished with mean loss 0.13965
--> Overhead/Training/Evaluation: 0.63/0.71/0.00 mins (total: 1.33 mins)   (684 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 18.91batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 14.69batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 16.09batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 15.52batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 14.69batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.32batch/s] 41%|████████████▎                 | 14/34 [00:00<00:01, 14.47batch/s] 50%|███████████████               | 17/34 [00:01<00:01, 15.90batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:00, 15.54batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 15.47batch/s] 76%|██████████████████████▉       | 26/34 [00:01<00:00, 15.34batch/s] 85%|█████████████████████████▌    | 29/34 [00:01<00:00, 15.03batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 14.49batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.37batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 38.33batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.27batch/s]  1%|▎                           | 12/1014 [00:00<00:26, 37.40batch/s]  2%|▍                           | 16/1014 [00:00<00:27, 35.98batch/s]  2%|▌                           | 21/1014 [00:00<00:27, 36.76batch/s]  3%|▋                           | 26/1014 [00:00<00:27, 35.63batch/s]  3%|▊                           | 31/1014 [00:00<00:28, 34.96batch/s]  4%|▉                           | 36/1014 [00:01<00:27, 35.21batch/s]  4%|█▏                          | 41/1014 [00:01<00:26, 36.06batch/s]  5%|█▎                          | 46/1014 [00:01<00:26, 35.97batch/s]  5%|█▍                          | 51/1014 [00:01<00:26, 36.24batch/s]  6%|█▌                          | 56/1014 [00:01<00:26, 36.33batch/s]  6%|█▋                          | 61/1014 [00:01<00:26, 36.26batch/s]  7%|█▊                          | 66/1014 [00:01<00:26, 35.85batch/s]  7%|█▉                          | 71/1014 [00:01<00:26, 36.03batch/s]  7%|██                          | 76/1014 [00:02<00:26, 35.77batch/s]  8%|██▏                         | 81/1014 [00:02<00:26, 35.77batch/s]  8%|██▎                         | 86/1014 [00:02<00:25, 36.04batch/s]  9%|██▌                         | 91/1014 [00:02<00:25, 35.96batch/s]  9%|██▋                         | 96/1014 [00:02<00:25, 35.50batch/s] 10%|██▋                        | 101/1014 [00:02<00:25, 35.84batch/s] 10%|██▊                        | 106/1014 [00:02<00:25, 35.85batch/s] 11%|██▉                        | 111/1014 [00:03<00:25, 36.01batch/s] 11%|███                        | 116/1014 [00:03<00:24, 36.18batch/s] 12%|███▏                       | 121/1014 [00:03<00:24, 36.27batch/s] 12%|███▎                       | 126/1014 [00:03<00:24, 36.08batch/s] 13%|███▍                       | 131/1014 [00:03<00:24, 35.69batch/s] 13%|███▌                       | 136/1014 [00:03<00:24, 35.83batch/s] 14%|███▊                       | 141/1014 [00:03<00:24, 35.85batch/s] 14%|███▉                       | 146/1014 [00:04<00:24, 35.75batch/s] 15%|████                       | 151/1014 [00:04<00:24, 35.64batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 35.62batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 35.53batch/s] 16%|████▍                      | 166/1014 [00:04<00:23, 35.55batch/s] 17%|████▌                      | 171/1014 [00:04<00:23, 35.55batch/s] 17%|████▋                      | 176/1014 [00:04<00:23, 35.37batch/s] 18%|████▊                      | 181/1014 [00:05<00:23, 35.22batch/s] 18%|████▉                      | 186/1014 [00:05<00:23, 35.17batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 35.36batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 35.31batch/s] 20%|█████▎                     | 201/1014 [00:05<00:22, 35.39batch/s] 20%|█████▍                     | 206/1014 [00:05<00:22, 35.54batch/s] 21%|█████▌                     | 211/1014 [00:05<00:22, 35.60batch/s] 21%|█████▊                     | 216/1014 [00:06<00:22, 35.69batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 35.70batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 35.53batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 35.56batch/s] 23%|██████▎                    | 236/1014 [00:06<00:21, 35.61batch/s] 24%|██████▍                    | 241/1014 [00:06<00:21, 35.70batch/s] 24%|██████▌                    | 246/1014 [00:06<00:21, 35.62batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 35.70batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 35.43batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 35.51batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 35.54batch/s] 27%|███████▏                   | 271/1014 [00:07<00:20, 35.56batch/s] 27%|███████▎                   | 276/1014 [00:07<00:20, 35.49batch/s] 28%|███████▍                   | 281/1014 [00:07<00:20, 35.59batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 35.65batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 35.63batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 35.62batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 35.62batch/s] 30%|████████▏                  | 306/1014 [00:08<00:19, 35.62batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 35.57batch/s] 31%|████████▍                  | 316/1014 [00:08<00:19, 35.63batch/s] 32%|████████▌                  | 321/1014 [00:08<00:19, 35.76batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 35.73batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 35.72batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 35.65batch/s] 34%|█████████                  | 341/1014 [00:09<00:18, 35.71batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:18, 35.70batch/s] 35%|█████████▎                 | 352/1014 [00:09<00:18, 35.84batch/s] 35%|█████████▌                 | 358/1014 [00:09<00:18, 35.92batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.88batch/s] 36%|█████████▊                 | 370/1014 [00:10<00:17, 35.89batch/s] 37%|██████████                 | 376/1014 [00:10<00:17, 35.91batch/s] 38%|██████████▏                | 382/1014 [00:10<00:17, 35.95batch/s] 38%|██████████▎                | 388/1014 [00:10<00:17, 35.94batch/s] 39%|██████████▍                | 394/1014 [00:10<00:17, 36.01batch/s] 39%|██████████▋                | 400/1014 [00:11<00:17, 36.02batch/s] 40%|██████████▊                | 406/1014 [00:11<00:16, 36.05batch/s] 41%|██████████▉                | 412/1014 [00:11<00:16, 36.07batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 35.99batch/s] 42%|███████████▎               | 424/1014 [00:11<00:16, 35.99batch/s] 42%|███████████▍               | 430/1014 [00:11<00:16, 36.01batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 35.99batch/s] 44%|███████████▊               | 442/1014 [00:12<00:15, 35.99batch/s] 44%|███████████▉               | 448/1014 [00:12<00:15, 35.88batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.98batch/s] 45%|████████████▏              | 460/1014 [00:12<00:15, 35.91batch/s] 46%|████████████▍              | 466/1014 [00:12<00:15, 35.91batch/s] 47%|████████████▌              | 472/1014 [00:13<00:15, 35.78batch/s] 47%|████████████▋              | 478/1014 [00:13<00:14, 35.83batch/s] 48%|████████████▉              | 484/1014 [00:13<00:14, 35.87batch/s] 48%|█████████████              | 490/1014 [00:13<00:14, 35.86batch/s] 49%|█████████████▏             | 496/1014 [00:13<00:14, 35.91batch/s] 50%|█████████████▎             | 502/1014 [00:13<00:14, 35.87batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.83batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.71batch/s] 51%|█████████████▊             | 520/1014 [00:14<00:13, 35.71batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 35.71batch/s] 52%|██████████████▏            | 532/1014 [00:14<00:13, 35.69batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.70batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.65batch/s] 54%|██████████████▋            | 550/1014 [00:15<00:13, 35.64batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:12, 35.63batch/s] 55%|██████████████▉            | 562/1014 [00:15<00:12, 35.71batch/s] 56%|███████████████            | 568/1014 [00:15<00:12, 35.58batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.52batch/s] 57%|███████████████▍           | 580/1014 [00:16<00:12, 35.56batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 35.48batch/s] 58%|███████████████▊           | 592/1014 [00:16<00:11, 35.46batch/s] 59%|███████████████▉           | 598/1014 [00:16<00:11, 35.49batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.43batch/s] 60%|████████████████▏          | 610/1014 [00:17<00:11, 35.39batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 35.48batch/s] 61%|████████████████▌          | 622/1014 [00:17<00:11, 35.45batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:10, 35.36batch/s] 63%|████████████████▉          | 634/1014 [00:17<00:10, 35.39batch/s] 63%|█████████████████          | 640/1014 [00:18<00:10, 35.35batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 35.38batch/s] 64%|█████████████████▎         | 652/1014 [00:18<00:10, 35.37batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 35.39batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.35batch/s] 66%|█████████████████▊         | 670/1014 [00:18<00:09, 35.29batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 35.31batch/s] 67%|██████████████████▏        | 682/1014 [00:19<00:09, 35.28batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.29batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.21batch/s] 69%|██████████████████▋        | 700/1014 [00:19<00:08, 35.18batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 35.20batch/s] 70%|██████████████████▉        | 712/1014 [00:20<00:08, 35.25batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.22batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.25batch/s] 72%|███████████████████▍       | 730/1014 [00:20<00:08, 35.23batch/s] 73%|███████████████████▌       | 736/1014 [00:20<00:07, 35.23batch/s] 73%|███████████████████▊       | 742/1014 [00:21<00:07, 35.26batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.21batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.11batch/s] 75%|████████████████████▏      | 760/1014 [00:21<00:07, 35.11batch/s] 76%|████████████████████▍      | 766/1014 [00:21<00:07, 35.15batch/s] 76%|████████████████████▌      | 772/1014 [00:21<00:06, 35.15batch/s] 77%|████████████████████▋      | 778/1014 [00:22<00:06, 35.18batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.22batch/s] 78%|█████████████████████      | 790/1014 [00:22<00:06, 35.27batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 35.29batch/s] 79%|█████████████████████▎     | 802/1014 [00:22<00:06, 35.31batch/s] 80%|█████████████████████▌     | 808/1014 [00:22<00:05, 35.32batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 35.25batch/s] 81%|█████████████████████▊     | 820/1014 [00:23<00:05, 35.22batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 35.22batch/s] 82%|██████████████████████▏    | 832/1014 [00:23<00:05, 35.26batch/s] 83%|██████████████████████▎    | 838/1014 [00:23<00:04, 35.24batch/s] 83%|██████████████████████▍    | 844/1014 [00:23<00:04, 35.27batch/s] 84%|██████████████████████▋    | 850/1014 [00:24<00:04, 35.21batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 35.21batch/s] 85%|██████████████████████▉    | 862/1014 [00:24<00:04, 35.22batch/s] 86%|███████████████████████    | 868/1014 [00:24<00:04, 35.20batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.20batch/s] 87%|███████████████████████▍   | 880/1014 [00:25<00:03, 35.16batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 35.20batch/s] 88%|███████████████████████▊   | 892/1014 [00:25<00:03, 35.24batch/s] 89%|███████████████████████▉   | 898/1014 [00:25<00:03, 35.23batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.25batch/s] 90%|████████████████████████▏  | 910/1014 [00:25<00:02, 35.24batch/s] 90%|████████████████████████▍  | 916/1014 [00:26<00:02, 35.21batch/s] 91%|████████████████████████▌  | 922/1014 [00:26<00:02, 35.24batch/s] 92%|████████████████████████▋  | 928/1014 [00:26<00:02, 35.26batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.22batch/s] 93%|█████████████████████████  | 940/1014 [00:26<00:02, 35.20batch/s] 93%|█████████████████████████▏ | 946/1014 [00:26<00:01, 35.19batch/s] 94%|█████████████████████████▎ | 952/1014 [00:27<00:01, 35.18batch/s] 94%|█████████████████████████▌ | 958/1014 [00:27<00:01, 35.19batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 35.17batch/s] 96%|█████████████████████████▊ | 970/1014 [00:27<00:01, 35.17batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 35.18batch/s] 97%|██████████████████████████▏| 982/1014 [00:27<00:00, 35.17batch/s] 97%|██████████████████████████▎| 988/1014 [00:28<00:00, 35.19batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.17batch/s] 99%|█████████████████████████▋| 1000/1014 [00:28<00:00, 35.18batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 35.20batch/s]100%|█████████████████████████▉| 1012/1014 [00:28<00:00, 35.19batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.18batch/s]
Validation 30 -> LOSS = 0.26
Validation 30 -> BLEU = 96.04, 98.4/96.7/95.3/93.8 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.26 @ validation 30
--> Best BLEU so far: 96.04 @ validation 30
Starting Epoch 31
Epoch 31 - update      14490 => loss:   0.166 (#OOM: 0)
Epoch 31 - update      14520 => loss:   0.099 (#OOM: 0)
Epoch 31 - update      14550 => loss:   0.188 (#OOM: 0)
Epoch 31 - update      14580 => loss:   0.165 (#OOM: 0)
Epoch 31 - update      14610 => loss:   0.158 (#OOM: 0)
Epoch 31 - update      14640 => loss:   0.121 (#OOM: 0)
Epoch 31 - update      14670 => loss:   0.122 (#OOM: 0)
Epoch 31 - update      14700 => loss:   0.207 (#OOM: 0)
Epoch 31 - update      14730 => loss:   0.184 (#OOM: 0)
Epoch 31 - update      14760 => loss:   0.090 (#OOM: 0)
Epoch 31 - update      14790 => loss:   0.207 (#OOM: 0)
Epoch 31 - update      14820 => loss:   0.106 (#OOM: 0)
Epoch 31 - update      14850 => loss:   0.123 (#OOM: 0)
Epoch 31 - update      14880 => loss:   0.097 (#OOM: 0)
Epoch 31 - update      14910 => loss:   0.161 (#OOM: 0)
Epoch 31 - update      14940 => loss:   0.011 (#OOM: 0)
--> Epoch 31 finished with mean loss 0.13650
--> Overhead/Training/Evaluation: 0.62/0.71/0.00 mins (total: 1.33 mins)   (684 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  3%|▉                              | 1/34 [00:00<00:03,  9.41batch/s] 12%|███▋                           | 4/34 [00:00<00:01, 17.90batch/s] 21%|██████▍                        | 7/34 [00:00<00:01, 16.48batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 14.49batch/s] 38%|███████████▍                  | 13/34 [00:00<00:01, 15.19batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 14.97batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 14.63batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 14.35batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 13.78batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.90batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 14.29batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.20batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.20batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:28, 35.69batch/s]  1%|▏                            | 8/1014 [00:00<00:29, 34.18batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 35.35batch/s]  2%|▍                           | 17/1014 [00:00<00:27, 36.79batch/s]  2%|▌                           | 22/1014 [00:00<00:27, 35.59batch/s]  3%|▋                           | 27/1014 [00:00<00:27, 35.41batch/s]  3%|▉                           | 32/1014 [00:00<00:27, 35.32batch/s]  4%|█                           | 37/1014 [00:01<00:27, 35.16batch/s]  4%|█▏                          | 42/1014 [00:01<00:27, 35.49batch/s]  5%|█▎                          | 47/1014 [00:01<00:26, 35.94batch/s]  5%|█▍                          | 52/1014 [00:01<00:26, 36.18batch/s]  6%|█▌                          | 57/1014 [00:01<00:27, 35.22batch/s]  6%|█▋                          | 62/1014 [00:01<00:26, 35.26batch/s]  7%|█▊                          | 67/1014 [00:01<00:26, 35.41batch/s]  7%|█▉                          | 72/1014 [00:02<00:26, 35.29batch/s]  8%|██▏                         | 77/1014 [00:02<00:26, 35.04batch/s]  8%|██▎                         | 82/1014 [00:02<00:26, 35.04batch/s]  9%|██▍                         | 87/1014 [00:02<00:26, 35.23batch/s]  9%|██▌                         | 92/1014 [00:02<00:26, 35.08batch/s] 10%|██▋                         | 97/1014 [00:02<00:26, 35.13batch/s] 10%|██▋                        | 102/1014 [00:02<00:26, 35.03batch/s] 11%|██▊                        | 107/1014 [00:03<00:25, 34.96batch/s] 11%|██▉                        | 112/1014 [00:03<00:25, 34.84batch/s] 12%|███                        | 117/1014 [00:03<00:25, 34.73batch/s] 12%|███▏                       | 122/1014 [00:03<00:25, 34.87batch/s] 13%|███▍                       | 127/1014 [00:03<00:25, 34.99batch/s] 13%|███▌                       | 132/1014 [00:03<00:25, 35.21batch/s] 14%|███▋                       | 137/1014 [00:03<00:24, 35.08batch/s] 14%|███▊                       | 142/1014 [00:04<00:24, 35.20batch/s] 14%|███▉                       | 147/1014 [00:04<00:24, 35.33batch/s] 15%|████                       | 152/1014 [00:04<00:24, 35.21batch/s] 15%|████▏                      | 157/1014 [00:04<00:24, 35.20batch/s] 16%|████▎                      | 162/1014 [00:04<00:24, 35.26batch/s] 16%|████▍                      | 167/1014 [00:04<00:24, 35.29batch/s] 17%|████▌                      | 172/1014 [00:04<00:23, 35.41batch/s] 17%|████▋                      | 177/1014 [00:04<00:23, 35.58batch/s] 18%|████▊                      | 182/1014 [00:05<00:23, 35.52batch/s] 18%|████▉                      | 187/1014 [00:05<00:23, 35.40batch/s] 19%|█████                      | 192/1014 [00:05<00:23, 35.46batch/s] 19%|█████▏                     | 197/1014 [00:05<00:23, 35.37batch/s] 20%|█████▍                     | 202/1014 [00:05<00:23, 35.30batch/s] 20%|█████▌                     | 207/1014 [00:05<00:22, 35.41batch/s] 21%|█████▋                     | 212/1014 [00:05<00:22, 35.37batch/s] 21%|█████▊                     | 217/1014 [00:06<00:22, 35.19batch/s] 22%|█████▉                     | 222/1014 [00:06<00:22, 35.04batch/s] 22%|██████                     | 227/1014 [00:06<00:22, 35.18batch/s] 23%|██████▏                    | 232/1014 [00:06<00:22, 35.21batch/s] 23%|██████▎                    | 237/1014 [00:06<00:22, 35.18batch/s] 24%|██████▍                    | 242/1014 [00:06<00:21, 35.19batch/s] 24%|██████▌                    | 247/1014 [00:07<00:21, 35.08batch/s] 25%|██████▋                    | 252/1014 [00:07<00:21, 35.11batch/s] 25%|██████▊                    | 257/1014 [00:07<00:21, 34.98batch/s] 26%|██████▉                    | 262/1014 [00:07<00:21, 35.12batch/s] 26%|███████                    | 267/1014 [00:07<00:21, 35.25batch/s] 27%|███████▏                   | 272/1014 [00:07<00:21, 35.28batch/s] 27%|███████▍                   | 277/1014 [00:07<00:20, 35.35batch/s] 28%|███████▌                   | 282/1014 [00:07<00:20, 35.48batch/s] 28%|███████▋                   | 287/1014 [00:08<00:20, 35.48batch/s] 29%|███████▊                   | 292/1014 [00:08<00:20, 35.61batch/s] 29%|███████▉                   | 297/1014 [00:08<00:20, 35.66batch/s] 30%|████████                   | 302/1014 [00:08<00:19, 35.66batch/s] 30%|████████▏                  | 307/1014 [00:08<00:19, 35.67batch/s] 31%|████████▎                  | 312/1014 [00:08<00:19, 35.66batch/s] 31%|████████▍                  | 317/1014 [00:08<00:19, 35.61batch/s] 32%|████████▌                  | 322/1014 [00:09<00:19, 35.56batch/s] 32%|████████▋                  | 327/1014 [00:09<00:19, 35.56batch/s] 33%|████████▊                  | 332/1014 [00:09<00:19, 35.53batch/s] 33%|████████▉                  | 337/1014 [00:09<00:19, 35.56batch/s] 34%|█████████                  | 342/1014 [00:09<00:18, 35.47batch/s] 34%|█████████▏                 | 347/1014 [00:09<00:18, 35.40batch/s] 35%|█████████▎                 | 352/1014 [00:09<00:18, 35.43batch/s] 35%|█████████▌                 | 357/1014 [00:10<00:18, 35.37batch/s] 36%|█████████▋                 | 362/1014 [00:10<00:18, 35.38batch/s] 36%|█████████▊                 | 367/1014 [00:10<00:18, 35.42batch/s] 37%|█████████▉                 | 372/1014 [00:10<00:18, 35.50batch/s] 37%|██████████                 | 377/1014 [00:10<00:17, 35.53batch/s] 38%|██████████▏                | 382/1014 [00:10<00:17, 35.54batch/s] 38%|██████████▎                | 387/1014 [00:10<00:17, 35.55batch/s] 39%|██████████▍                | 392/1014 [00:11<00:17, 35.51batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 35.66batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.67batch/s] 40%|██████████▉                | 410/1014 [00:11<00:16, 35.70batch/s] 41%|███████████                | 416/1014 [00:11<00:16, 35.57batch/s] 42%|███████████▏               | 422/1014 [00:11<00:16, 35.45batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 35.49batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.49batch/s] 43%|███████████▋               | 440/1014 [00:12<00:16, 35.57batch/s] 44%|███████████▉               | 446/1014 [00:12<00:15, 35.56batch/s] 45%|████████████               | 452/1014 [00:12<00:15, 35.51batch/s] 45%|████████████▏              | 458/1014 [00:12<00:15, 35.58batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.62batch/s] 46%|████████████▌              | 470/1014 [00:13<00:15, 35.65batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 35.62batch/s] 48%|████████████▊              | 482/1014 [00:13<00:14, 35.70batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 35.64batch/s] 49%|█████████████▏             | 494/1014 [00:13<00:14, 35.61batch/s] 49%|█████████████▎             | 500/1014 [00:14<00:14, 35.63batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 35.59batch/s] 50%|█████████████▋             | 512/1014 [00:14<00:14, 35.51batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:13, 35.47batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.46batch/s] 52%|██████████████             | 530/1014 [00:14<00:13, 35.49batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 35.47batch/s] 53%|██████████████▍            | 542/1014 [00:15<00:13, 35.49batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.53batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:12, 35.57batch/s] 55%|██████████████▉            | 560/1014 [00:15<00:12, 35.46batch/s] 56%|███████████████            | 566/1014 [00:15<00:12, 35.50batch/s] 56%|███████████████▏           | 572/1014 [00:16<00:12, 35.42batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.41batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.40batch/s] 58%|███████████████▋           | 590/1014 [00:16<00:11, 35.40batch/s] 59%|███████████████▊           | 596/1014 [00:16<00:11, 35.35batch/s] 59%|████████████████           | 602/1014 [00:17<00:11, 35.41batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.36batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.30batch/s] 61%|████████████████▌          | 620/1014 [00:17<00:11, 35.34batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:11, 35.23batch/s] 62%|████████████████▊          | 632/1014 [00:17<00:10, 35.20batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.19batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.16batch/s] 64%|█████████████████▎         | 650/1014 [00:18<00:10, 35.17batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 35.17batch/s] 65%|█████████████████▋         | 662/1014 [00:18<00:10, 35.20batch/s] 66%|█████████████████▊         | 668/1014 [00:18<00:09, 35.20batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.19batch/s] 67%|██████████████████         | 680/1014 [00:19<00:09, 35.22batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 35.26batch/s] 68%|██████████████████▍        | 692/1014 [00:19<00:09, 35.18batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.19batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 35.12batch/s] 70%|██████████████████▉        | 710/1014 [00:20<00:08, 35.02batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 35.01batch/s] 71%|███████████████████▏       | 722/1014 [00:20<00:08, 34.98batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.00batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:08, 35.00batch/s] 73%|███████████████████▋       | 740/1014 [00:21<00:07, 34.96batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 34.95batch/s] 74%|████████████████████       | 752/1014 [00:21<00:07, 34.95batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 34.92batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 34.91batch/s] 76%|████████████████████▌      | 770/1014 [00:22<00:06, 34.95batch/s] 77%|████████████████████▋      | 776/1014 [00:22<00:06, 34.92batch/s] 77%|████████████████████▊      | 782/1014 [00:22<00:06, 34.91batch/s] 78%|████████████████████▉      | 788/1014 [00:22<00:06, 34.94batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.94batch/s] 79%|█████████████████████▎     | 800/1014 [00:22<00:06, 34.95batch/s] 79%|█████████████████████▍     | 806/1014 [00:23<00:05, 34.87batch/s] 80%|█████████████████████▌     | 812/1014 [00:23<00:05, 34.88batch/s] 81%|█████████████████████▊     | 818/1014 [00:23<00:05, 34.90batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.93batch/s] 82%|██████████████████████     | 830/1014 [00:23<00:05, 34.91batch/s] 82%|██████████████████████▎    | 836/1014 [00:23<00:05, 34.93batch/s] 83%|██████████████████████▍    | 842/1014 [00:24<00:04, 34.95batch/s] 84%|██████████████████████▌    | 848/1014 [00:24<00:04, 34.88batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.87batch/s] 85%|██████████████████████▉    | 860/1014 [00:24<00:04, 34.85batch/s] 85%|███████████████████████    | 866/1014 [00:24<00:04, 34.83batch/s] 86%|███████████████████████▏   | 872/1014 [00:25<00:04, 34.84batch/s] 87%|███████████████████████▍   | 878/1014 [00:25<00:03, 34.90batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.87batch/s] 88%|███████████████████████▋   | 890/1014 [00:25<00:03, 34.89batch/s] 88%|███████████████████████▊   | 896/1014 [00:25<00:03, 34.90batch/s] 89%|████████████████████████   | 902/1014 [00:25<00:03, 34.88batch/s] 90%|████████████████████████▏  | 908/1014 [00:26<00:03, 34.91batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.89batch/s] 91%|████████████████████████▍  | 920/1014 [00:26<00:02, 34.87batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 34.89batch/s] 92%|████████████████████████▊  | 932/1014 [00:26<00:02, 34.90batch/s] 93%|████████████████████████▉  | 938/1014 [00:26<00:02, 34.90batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.91batch/s] 94%|█████████████████████████▎ | 950/1014 [00:27<00:01, 34.96batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 34.96batch/s] 95%|█████████████████████████▌ | 962/1014 [00:27<00:01, 34.92batch/s] 95%|█████████████████████████▊ | 968/1014 [00:27<00:01, 34.91batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 34.92batch/s] 97%|██████████████████████████ | 980/1014 [00:28<00:00, 34.95batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 34.99batch/s] 98%|██████████████████████████▍| 992/1014 [00:28<00:00, 34.97batch/s] 98%|██████████████████████████▌| 998/1014 [00:28<00:00, 34.90batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.89batch/s]100%|█████████████████████████▉| 1010/1014 [00:28<00:00, 34.90batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.89batch/s]
Validation 31 -> LOSS = 0.26
Validation 31 -> BLEU = 96.11, 98.4/96.8/95.4/93.9 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.26 @ validation 31
--> Best BLEU so far: 96.11 @ validation 31
Starting Epoch 32
Epoch 32 - update      14970 => loss:   0.115 (#OOM: 0)
Epoch 32 - update      15000 => loss:   0.115 (#OOM: 0)
Epoch 32 - update      15030 => loss:   0.136 (#OOM: 0)
Epoch 32 - update      15060 => loss:   0.130 (#OOM: 0)
Epoch 32 - update      15090 => loss:   0.174 (#OOM: 0)
Epoch 32 - update      15120 => loss:   0.086 (#OOM: 0)
Epoch 32 - update      15150 => loss:   0.167 (#OOM: 0)
Epoch 32 - update      15180 => loss:   0.130 (#OOM: 0)
Epoch 32 - update      15210 => loss:   0.165 (#OOM: 0)
Epoch 32 - update      15240 => loss:   0.131 (#OOM: 0)
Epoch 32 - update      15270 => loss:   0.175 (#OOM: 0)
Epoch 32 - update      15300 => loss:   0.122 (#OOM: 0)
Epoch 32 - update      15330 => loss:   0.122 (#OOM: 0)
Epoch 32 - update      15360 => loss:   0.108 (#OOM: 0)
Epoch 32 - update      15390 => loss:   0.112 (#OOM: 0)
Epoch 32 - update      15420 => loss:   0.111 (#OOM: 0)
--> Epoch 32 finished with mean loss 0.13550
--> Overhead/Training/Evaluation: 0.58/0.71/0.00 mins (total: 1.28 mins)   (684 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:01, 19.91batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 15.82batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 16.07batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 14.62batch/s] 44%|█████████████▏                | 15/34 [00:00<00:01, 15.18batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 14.26batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 14.12batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 14.58batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.99batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 14.28batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 14.07batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 14.19batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 34.75batch/s]  1%|▎                            | 9/1014 [00:00<00:27, 36.33batch/s]  1%|▍                           | 14/1014 [00:00<00:27, 35.92batch/s]  2%|▌                           | 19/1014 [00:00<00:26, 36.93batch/s]  2%|▋                           | 24/1014 [00:00<00:26, 37.64batch/s]  3%|▊                           | 29/1014 [00:00<00:25, 38.90batch/s]  3%|▉                           | 34/1014 [00:00<00:25, 38.43batch/s]  4%|█                           | 39/1014 [00:01<00:25, 38.67batch/s]  4%|█▏                          | 44/1014 [00:01<00:25, 37.98batch/s]  5%|█▎                          | 49/1014 [00:01<00:25, 37.71batch/s]  5%|█▍                          | 54/1014 [00:01<00:26, 36.86batch/s]  6%|█▋                          | 59/1014 [00:01<00:26, 36.52batch/s]  6%|█▊                          | 64/1014 [00:01<00:25, 36.78batch/s]  7%|█▉                          | 69/1014 [00:01<00:25, 37.13batch/s]  7%|██                          | 74/1014 [00:01<00:25, 37.05batch/s]  8%|██▏                         | 79/1014 [00:02<00:25, 36.98batch/s]  8%|██▎                         | 84/1014 [00:02<00:25, 36.80batch/s]  9%|██▍                         | 89/1014 [00:02<00:25, 36.74batch/s]  9%|██▌                         | 94/1014 [00:02<00:25, 36.36batch/s] 10%|██▋                         | 99/1014 [00:02<00:24, 36.61batch/s] 10%|██▊                        | 104/1014 [00:02<00:25, 36.04batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 36.06batch/s] 11%|███                        | 114/1014 [00:03<00:25, 35.66batch/s] 12%|███▏                       | 119/1014 [00:03<00:24, 35.83batch/s] 12%|███▎                       | 124/1014 [00:03<00:24, 35.81batch/s] 13%|███▍                       | 129/1014 [00:03<00:24, 36.00batch/s] 13%|███▌                       | 134/1014 [00:03<00:24, 36.00batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 35.82batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 35.25batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 35.04batch/s] 15%|████                       | 154/1014 [00:04<00:24, 34.99batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 35.00batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 35.20batch/s] 17%|████▌                      | 169/1014 [00:04<00:24, 35.10batch/s] 17%|████▋                      | 174/1014 [00:04<00:24, 34.83batch/s] 18%|████▊                      | 179/1014 [00:05<00:24, 34.67batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 34.73batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 34.60batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 34.75batch/s] 20%|█████▎                     | 199/1014 [00:05<00:23, 34.50batch/s] 20%|█████▍                     | 204/1014 [00:05<00:23, 34.38batch/s] 21%|█████▌                     | 209/1014 [00:06<00:23, 34.28batch/s] 21%|█████▋                     | 214/1014 [00:06<00:23, 34.26batch/s] 22%|█████▊                     | 219/1014 [00:06<00:23, 34.38batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 34.42batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 34.40batch/s] 23%|██████▏                    | 234/1014 [00:06<00:22, 34.37batch/s] 24%|██████▎                    | 239/1014 [00:06<00:22, 34.44batch/s] 24%|██████▍                    | 244/1014 [00:07<00:22, 34.52batch/s] 25%|██████▋                    | 249/1014 [00:07<00:22, 34.38batch/s] 25%|██████▊                    | 254/1014 [00:07<00:22, 34.47batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 34.44batch/s] 26%|███████                    | 264/1014 [00:07<00:21, 34.43batch/s] 27%|███████▏                   | 269/1014 [00:07<00:21, 34.58batch/s] 27%|███████▎                   | 274/1014 [00:07<00:21, 34.74batch/s] 28%|███████▍                   | 279/1014 [00:08<00:21, 34.77batch/s] 28%|███████▌                   | 284/1014 [00:08<00:21, 34.51batch/s] 29%|███████▋                   | 289/1014 [00:08<00:21, 34.49batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 34.59batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 34.60batch/s] 30%|████████                   | 304/1014 [00:08<00:20, 34.60batch/s] 30%|████████▏                  | 309/1014 [00:08<00:20, 34.53batch/s] 31%|████████▎                  | 314/1014 [00:09<00:20, 34.58batch/s] 31%|████████▍                  | 319/1014 [00:09<00:20, 34.60batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 34.61batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 34.67batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 34.61batch/s] 33%|█████████                  | 339/1014 [00:09<00:19, 34.56batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:19, 34.71batch/s] 34%|█████████▎                 | 349/1014 [00:10<00:19, 34.71batch/s] 35%|█████████▍                 | 354/1014 [00:10<00:19, 34.70batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 34.67batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 34.71batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 34.59batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 34.65batch/s] 37%|██████████                 | 379/1014 [00:10<00:18, 34.68batch/s] 38%|██████████▏                | 384/1014 [00:11<00:18, 34.71batch/s] 38%|██████████▎                | 389/1014 [00:11<00:18, 34.66batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 34.67batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 34.66batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 34.65batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 34.67batch/s] 41%|███████████                | 414/1014 [00:11<00:17, 34.69batch/s] 41%|███████████▏               | 419/1014 [00:12<00:17, 34.66batch/s] 42%|███████████▎               | 424/1014 [00:12<00:17, 34.69batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 34.69batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 34.67batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 34.69batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 34.64batch/s] 44%|███████████▉               | 449/1014 [00:12<00:16, 34.56batch/s] 45%|████████████               | 454/1014 [00:13<00:16, 34.61batch/s] 45%|████████████▏              | 459/1014 [00:13<00:16, 34.66batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 34.71batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 34.75batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 34.74batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 34.66batch/s] 48%|████████████▉              | 484/1014 [00:13<00:15, 34.67batch/s] 48%|█████████████              | 489/1014 [00:14<00:15, 34.70batch/s] 49%|█████████████▏             | 494/1014 [00:14<00:14, 34.70batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 34.72batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 34.73batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 34.77batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 34.83batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:14, 34.84batch/s] 52%|█████████████▉             | 524/1014 [00:15<00:14, 34.88batch/s] 52%|██████████████             | 529/1014 [00:15<00:13, 34.81batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 34.77batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 34.83batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 34.84batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 34.81batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 34.72batch/s] 55%|██████████████▉            | 559/1014 [00:16<00:13, 34.71batch/s] 56%|███████████████            | 564/1014 [00:16<00:12, 34.64batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 34.67batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 34.75batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 34.76batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 34.82batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 34.86batch/s] 59%|███████████████▊           | 594/1014 [00:17<00:12, 34.89batch/s] 59%|███████████████▉           | 599/1014 [00:17<00:11, 34.92batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 34.96batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 34.96batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 34.95batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 34.96batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 34.97batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:11, 34.96batch/s] 63%|████████████████▉          | 634/1014 [00:18<00:10, 34.97batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 34.92batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 34.96batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 34.98batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.04batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.07batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.12batch/s] 66%|█████████████████▊         | 669/1014 [00:19<00:09, 35.13batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.18batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.16batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.11batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.13batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 35.10batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.10batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 35.08batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 35.07batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.12batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.12batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.15batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 35.14batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.13batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 35.12batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 35.14batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.16batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.13batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.11batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.10batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.10batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 35.07batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 35.08batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.04batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.03batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 34.96batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 34.97batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.92batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.90batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.94batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.00batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.01batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.02batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.04batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.06batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 35.06batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 35.04batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.04batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.05batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.06batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.08batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.13batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 35.14batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 35.15batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.15batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.17batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.17batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.16batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.16batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 35.15batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.13batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.15batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.17batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.17batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 35.14batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.16batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 35.10batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 35.12batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.13batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 35.13batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 35.17batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 35.16batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.15batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.19batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.20batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.20batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.20batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 35.22batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.23batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.24batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.24batch/s]
Validation 32 -> LOSS = 0.25
Validation 32 -> BLEU = 96.14, 98.4/96.8/95.4/94.0 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.25 @ validation 32
--> Best BLEU so far: 96.14 @ validation 32
Starting Epoch 33
Epoch 33 - update      15450 => loss:   0.101 (#OOM: 0)
Epoch 33 - update      15480 => loss:   0.176 (#OOM: 0)
Epoch 33 - update      15510 => loss:   0.072 (#OOM: 0)
Epoch 33 - update      15540 => loss:   0.106 (#OOM: 0)
Epoch 33 - update      15570 => loss:   0.097 (#OOM: 0)
Epoch 33 - update      15600 => loss:   0.089 (#OOM: 0)
Epoch 33 - update      15630 => loss:   0.142 (#OOM: 0)
Epoch 33 - update      15660 => loss:   0.110 (#OOM: 0)
Epoch 33 - update      15690 => loss:   0.129 (#OOM: 0)
Epoch 33 - update      15720 => loss:   0.084 (#OOM: 0)
Epoch 33 - update      15750 => loss:   0.151 (#OOM: 0)
Epoch 33 - update      15780 => loss:   0.154 (#OOM: 0)
Epoch 33 - update      15810 => loss:   0.095 (#OOM: 0)
Epoch 33 - update      15840 => loss:   0.178 (#OOM: 0)
Epoch 33 - update      15870 => loss:   0.096 (#OOM: 0)
Epoch 33 - update      15900 => loss:   0.119 (#OOM: 0)
--> Epoch 33 finished with mean loss 0.12902
--> Overhead/Training/Evaluation: 0.64/0.70/0.00 mins (total: 1.34 mins)   (686 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 15.47batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 16.40batch/s] 26%|████████▏                      | 9/34 [00:00<00:01, 14.63batch/s] 35%|██████████▌                   | 12/34 [00:00<00:01, 16.00batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 14.18batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 14.25batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:00, 14.54batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 13.61batch/s] 79%|███████████████████████▊      | 27/34 [00:01<00:00, 13.55batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.62batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.83batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.98batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:29, 34.39batch/s]  1%|▎                            | 9/1014 [00:00<00:25, 40.20batch/s]  1%|▍                           | 14/1014 [00:00<00:24, 40.50batch/s]  2%|▌                           | 19/1014 [00:00<00:25, 38.67batch/s]  2%|▋                           | 24/1014 [00:00<00:25, 39.11batch/s]  3%|▊                           | 29/1014 [00:00<00:26, 36.79batch/s]  3%|▉                           | 34/1014 [00:00<00:26, 36.74batch/s]  4%|█                           | 39/1014 [00:01<00:27, 35.58batch/s]  4%|█▏                          | 44/1014 [00:01<00:27, 35.46batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 35.52batch/s]  5%|█▍                          | 54/1014 [00:01<00:27, 34.74batch/s]  6%|█▋                          | 59/1014 [00:01<00:27, 35.01batch/s]  6%|█▊                          | 64/1014 [00:01<00:26, 35.26batch/s]  7%|█▉                          | 69/1014 [00:01<00:27, 34.54batch/s]  7%|██                          | 74/1014 [00:02<00:27, 34.75batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 34.62batch/s]  8%|██▎                         | 84/1014 [00:02<00:26, 34.54batch/s]  9%|██▍                         | 89/1014 [00:02<00:26, 34.34batch/s]  9%|██▌                         | 94/1014 [00:02<00:26, 34.92batch/s] 10%|██▋                         | 99/1014 [00:02<00:26, 35.06batch/s] 10%|██▊                        | 104/1014 [00:02<00:26, 34.89batch/s] 11%|██▉                        | 109/1014 [00:03<00:25, 35.14batch/s] 11%|███                        | 114/1014 [00:03<00:25, 34.91batch/s] 12%|███▏                       | 119/1014 [00:03<00:25, 34.95batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 35.03batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 35.13batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 35.14batch/s] 14%|███▋                       | 139/1014 [00:03<00:24, 35.23batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 35.35batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 35.26batch/s] 15%|████                       | 154/1014 [00:04<00:24, 35.33batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 35.48batch/s] 16%|████▎                      | 164/1014 [00:04<00:23, 35.45batch/s] 17%|████▌                      | 169/1014 [00:04<00:23, 35.23batch/s] 17%|████▋                      | 174/1014 [00:04<00:23, 35.10batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 35.29batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.40batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 35.57batch/s] 19%|█████▏                     | 194/1014 [00:05<00:23, 35.55batch/s] 20%|█████▎                     | 199/1014 [00:05<00:22, 35.57batch/s] 20%|█████▍                     | 204/1014 [00:05<00:22, 35.82batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.90batch/s] 21%|█████▋                     | 214/1014 [00:05<00:22, 36.07batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 36.12batch/s] 22%|█████▉                     | 224/1014 [00:06<00:21, 36.07batch/s] 23%|██████                     | 229/1014 [00:06<00:21, 36.09batch/s] 23%|██████▏                    | 234/1014 [00:06<00:21, 35.98batch/s] 24%|██████▎                    | 239/1014 [00:06<00:21, 35.95batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.99batch/s] 25%|██████▋                    | 249/1014 [00:06<00:21, 36.08batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 36.11batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.93batch/s] 26%|███████                    | 264/1014 [00:07<00:20, 35.74batch/s] 27%|███████▏                   | 269/1014 [00:07<00:20, 35.63batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.68batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 35.67batch/s] 28%|███████▌                   | 284/1014 [00:07<00:20, 35.56batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 35.50batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.53batch/s] 29%|███████▉                   | 299/1014 [00:08<00:20, 35.45batch/s] 30%|████████                   | 304/1014 [00:08<00:19, 35.56batch/s] 30%|████████▏                  | 309/1014 [00:08<00:19, 35.55batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.55batch/s] 31%|████████▍                  | 319/1014 [00:08<00:19, 35.51batch/s] 32%|████████▋                  | 324/1014 [00:09<00:19, 35.54batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 35.51batch/s] 33%|████████▉                  | 334/1014 [00:09<00:19, 35.56batch/s] 33%|█████████                  | 339/1014 [00:09<00:18, 35.58batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:18, 35.56batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.57batch/s] 35%|█████████▍                 | 354/1014 [00:09<00:18, 35.60batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.43batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.45batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 35.42batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:18, 35.41batch/s] 37%|██████████                 | 379/1014 [00:10<00:17, 35.41batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.42batch/s] 38%|██████████▎                | 389/1014 [00:10<00:17, 35.40batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.41batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.33batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.36batch/s] 40%|██████████▉                | 409/1014 [00:11<00:17, 35.36batch/s] 41%|███████████                | 414/1014 [00:11<00:16, 35.39batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.43batch/s] 42%|███████████▎               | 424/1014 [00:11<00:16, 35.49batch/s] 42%|███████████▍               | 429/1014 [00:12<00:16, 35.43batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.40batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.46batch/s] 44%|███████████▊               | 444/1014 [00:12<00:16, 35.50batch/s] 44%|███████████▉               | 449/1014 [00:12<00:15, 35.45batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.49batch/s] 45%|████████████▏              | 459/1014 [00:12<00:15, 35.55batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.57batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.58batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.56batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 35.57batch/s] 48%|████████████▉              | 484/1014 [00:13<00:14, 35.56batch/s] 48%|█████████████              | 489/1014 [00:13<00:14, 35.55batch/s] 49%|█████████████▏             | 494/1014 [00:13<00:14, 35.61batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.53batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 35.47batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.42batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.41batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:13, 35.43batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.40batch/s] 52%|██████████████             | 529/1014 [00:14<00:13, 35.44batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 35.50batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.47batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.44batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.40batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:13, 35.35batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.28batch/s] 56%|███████████████            | 564/1014 [00:15<00:12, 35.32batch/s] 56%|███████████████▏           | 569/1014 [00:16<00:12, 35.30batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.33batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.25batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.24batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:12, 35.27batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.29batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.30batch/s] 60%|████████████████           | 604/1014 [00:17<00:11, 35.32batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.30batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.31batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.33batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:11, 35.34batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.32batch/s] 63%|████████████████▉          | 634/1014 [00:17<00:10, 35.35batch/s] 63%|█████████████████          | 639/1014 [00:18<00:10, 35.33batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.28batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.34batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.33batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:10, 35.24batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.22batch/s] 66%|█████████████████▊         | 669/1014 [00:18<00:09, 35.22batch/s] 66%|█████████████████▉         | 674/1014 [00:19<00:09, 35.17batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.16batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.09batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.01batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:09, 34.98batch/s] 69%|██████████████████▌        | 699/1014 [00:20<00:09, 34.95batch/s] 69%|██████████████████▋        | 704/1014 [00:20<00:08, 34.91batch/s] 70%|██████████████████▉        | 709/1014 [00:20<00:08, 34.84batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 34.79batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 34.83batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 34.77batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:08, 34.73batch/s] 72%|███████████████████▌       | 734/1014 [00:21<00:08, 34.68batch/s] 73%|███████████████████▋       | 739/1014 [00:21<00:07, 34.63batch/s] 73%|███████████████████▊       | 744/1014 [00:21<00:07, 34.67batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 34.71batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 34.69batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 34.72batch/s] 75%|████████████████████▎      | 764/1014 [00:22<00:07, 34.63batch/s] 76%|████████████████████▍      | 769/1014 [00:22<00:07, 34.60batch/s] 76%|████████████████████▌      | 774/1014 [00:22<00:06, 34.56batch/s] 77%|████████████████████▋      | 779/1014 [00:22<00:06, 34.52batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 34.50batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 34.53batch/s] 78%|█████████████████████▏     | 794/1014 [00:23<00:06, 34.51batch/s] 79%|█████████████████████▎     | 799/1014 [00:23<00:06, 34.52batch/s] 79%|█████████████████████▍     | 804/1014 [00:23<00:06, 34.53batch/s] 80%|█████████████████████▌     | 809/1014 [00:23<00:05, 34.52batch/s] 80%|█████████████████████▋     | 814/1014 [00:23<00:05, 34.56batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 34.57batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 34.59batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 34.62batch/s] 82%|██████████████████████▏    | 834/1014 [00:24<00:05, 34.68batch/s] 83%|██████████████████████▎    | 839/1014 [00:24<00:05, 34.69batch/s] 83%|██████████████████████▍    | 844/1014 [00:24<00:04, 34.66batch/s] 84%|██████████████████████▌    | 849/1014 [00:24<00:04, 34.68batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 34.69batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 34.69batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 34.67batch/s] 86%|███████████████████████▏   | 869/1014 [00:25<00:04, 34.66batch/s] 86%|███████████████████████▎   | 874/1014 [00:25<00:04, 34.70batch/s] 87%|███████████████████████▍   | 879/1014 [00:25<00:03, 34.70batch/s] 87%|███████████████████████▌   | 884/1014 [00:25<00:03, 34.70batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 34.72batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 34.68batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 34.71batch/s] 89%|████████████████████████   | 904/1014 [00:26<00:03, 34.74batch/s] 90%|████████████████████████▏  | 909/1014 [00:26<00:03, 34.75batch/s] 90%|████████████████████████▎  | 914/1014 [00:26<00:02, 34.72batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 34.67batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 34.70batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 34.71batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 34.75batch/s] 93%|█████████████████████████  | 939/1014 [00:27<00:02, 34.77batch/s] 93%|█████████████████████████▏ | 944/1014 [00:27<00:02, 34.76batch/s] 94%|█████████████████████████▎ | 949/1014 [00:27<00:01, 34.76batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 34.74batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 34.79batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 34.79batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 34.82batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 34.82batch/s] 97%|██████████████████████████ | 979/1014 [00:28<00:01, 34.82batch/s] 97%|██████████████████████████▏| 984/1014 [00:28<00:00, 34.81batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 34.80batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 34.81batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 34.77batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 34.80batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 34.82batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.81batch/s]100%|██████████████████████████| 1014/1014 [00:29<00:00, 34.80batch/s]
Validation 33 -> LOSS = 0.25
Validation 33 -> BLEU = 96.21, 98.5/96.9/95.6/94.2 (BP=0.999, ratio=0.999, hyp_len=14372, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.25 @ validation 33
--> Best BLEU so far: 96.21 @ validation 33
Starting Epoch 34
Epoch 34 - update      15930 => loss:   0.146 (#OOM: 0)
Epoch 34 - update      15960 => loss:   0.037 (#OOM: 0)
Epoch 34 - update      15990 => loss:   0.066 (#OOM: 0)
Epoch 34 - update      16020 => loss:   0.133 (#OOM: 0)
Epoch 34 - update      16050 => loss:   0.130 (#OOM: 0)
Epoch 34 - update      16080 => loss:   0.154 (#OOM: 0)
Epoch 34 - update      16110 => loss:   0.123 (#OOM: 0)
Epoch 34 - update      16140 => loss:   0.118 (#OOM: 0)
Epoch 34 - update      16170 => loss:   0.094 (#OOM: 0)
Epoch 34 - update      16200 => loss:   0.078 (#OOM: 0)
Epoch 34 - update      16230 => loss:   0.118 (#OOM: 0)
Epoch 34 - update      16260 => loss:   0.136 (#OOM: 0)
Epoch 34 - update      16290 => loss:   0.087 (#OOM: 0)
Epoch 34 - update      16320 => loss:   0.113 (#OOM: 0)
Epoch 34 - update      16350 => loss:   0.091 (#OOM: 0)
Epoch 34 - update      16380 => loss:   0.032 (#OOM: 0)
--> Epoch 34 finished with mean loss 0.12325
--> Overhead/Training/Evaluation: 0.63/0.71/0.00 mins (total: 1.34 mins)   (680 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:02, 13.10batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 12.66batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 12.39batch/s] 24%|███████▎                       | 8/34 [00:00<00:01, 13.68batch/s] 29%|████████▊                     | 10/34 [00:00<00:01, 12.51batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.34batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.47batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 11.46batch/s] 56%|████████████████▊             | 19/34 [00:01<00:01, 12.32batch/s] 65%|███████████████████▍          | 22/34 [00:01<00:00, 12.51batch/s] 74%|██████████████████████        | 25/34 [00:01<00:00, 12.68batch/s] 82%|████████████████████████▋     | 28/34 [00:02<00:00, 13.07batch/s] 91%|███████████████████████████▎  | 31/34 [00:02<00:00, 13.42batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.53batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.53batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 38.33batch/s]  1%|▏                            | 8/1014 [00:00<00:25, 39.09batch/s]  1%|▎                           | 12/1014 [00:00<00:27, 36.84batch/s]  2%|▍                           | 16/1014 [00:00<00:27, 36.69batch/s]  2%|▌                           | 20/1014 [00:00<00:27, 35.85batch/s]  2%|▋                           | 24/1014 [00:00<00:28, 34.20batch/s]  3%|▊                           | 28/1014 [00:00<00:28, 34.05batch/s]  3%|▉                           | 32/1014 [00:00<00:28, 34.53batch/s]  4%|▉                           | 36/1014 [00:01<00:28, 34.47batch/s]  4%|█▏                          | 41/1014 [00:01<00:28, 34.64batch/s]  5%|█▎                          | 46/1014 [00:01<00:27, 35.03batch/s]  5%|█▍                          | 51/1014 [00:01<00:27, 35.64batch/s]  6%|█▌                          | 56/1014 [00:01<00:26, 35.85batch/s]  6%|█▋                          | 61/1014 [00:01<00:26, 35.49batch/s]  7%|█▊                          | 66/1014 [00:01<00:27, 35.00batch/s]  7%|█▉                          | 71/1014 [00:02<00:27, 34.83batch/s]  7%|██                          | 76/1014 [00:02<00:27, 34.71batch/s]  8%|██▏                         | 81/1014 [00:02<00:27, 34.40batch/s]  8%|██▎                         | 86/1014 [00:02<00:26, 34.45batch/s]  9%|██▌                         | 91/1014 [00:02<00:26, 34.65batch/s]  9%|██▋                         | 96/1014 [00:02<00:26, 34.61batch/s] 10%|██▋                        | 101/1014 [00:02<00:26, 34.72batch/s] 10%|██▊                        | 106/1014 [00:03<00:25, 35.02batch/s] 11%|██▉                        | 111/1014 [00:03<00:25, 35.27batch/s] 11%|███                        | 116/1014 [00:03<00:26, 34.36batch/s] 12%|███▏                       | 121/1014 [00:03<00:25, 34.46batch/s] 12%|███▎                       | 126/1014 [00:03<00:25, 34.53batch/s] 13%|███▍                       | 131/1014 [00:03<00:25, 34.51batch/s] 13%|███▌                       | 136/1014 [00:03<00:25, 34.64batch/s] 14%|███▊                       | 141/1014 [00:04<00:25, 34.91batch/s] 14%|███▉                       | 146/1014 [00:04<00:24, 34.78batch/s] 15%|████                       | 151/1014 [00:04<00:24, 34.95batch/s] 15%|████▏                      | 156/1014 [00:04<00:24, 34.91batch/s] 16%|████▎                      | 161/1014 [00:04<00:24, 34.82batch/s] 16%|████▍                      | 166/1014 [00:04<00:24, 34.76batch/s] 17%|████▌                      | 171/1014 [00:04<00:24, 34.68batch/s] 17%|████▋                      | 176/1014 [00:05<00:24, 34.39batch/s] 18%|████▊                      | 181/1014 [00:05<00:24, 34.43batch/s] 18%|████▉                      | 186/1014 [00:05<00:24, 34.36batch/s] 19%|█████                      | 191/1014 [00:05<00:23, 34.36batch/s] 19%|█████▏                     | 196/1014 [00:05<00:23, 34.41batch/s] 20%|█████▎                     | 201/1014 [00:05<00:23, 34.52batch/s] 20%|█████▍                     | 206/1014 [00:05<00:23, 34.72batch/s] 21%|█████▌                     | 211/1014 [00:06<00:23, 34.63batch/s] 21%|█████▊                     | 216/1014 [00:06<00:23, 34.54batch/s] 22%|█████▉                     | 221/1014 [00:06<00:22, 34.69batch/s] 22%|██████                     | 226/1014 [00:06<00:22, 34.64batch/s] 23%|██████▏                    | 231/1014 [00:06<00:22, 34.69batch/s] 23%|██████▎                    | 236/1014 [00:06<00:22, 34.63batch/s] 24%|██████▍                    | 241/1014 [00:06<00:22, 34.58batch/s] 24%|██████▌                    | 246/1014 [00:07<00:22, 34.64batch/s] 25%|██████▋                    | 251/1014 [00:07<00:21, 34.71batch/s] 25%|██████▊                    | 256/1014 [00:07<00:21, 34.83batch/s] 26%|██████▉                    | 261/1014 [00:07<00:21, 34.84batch/s] 26%|███████                    | 266/1014 [00:07<00:21, 34.87batch/s] 27%|███████▏                   | 271/1014 [00:07<00:21, 34.97batch/s] 27%|███████▎                   | 276/1014 [00:07<00:21, 34.89batch/s] 28%|███████▍                   | 281/1014 [00:08<00:21, 34.85batch/s] 28%|███████▌                   | 286/1014 [00:08<00:20, 34.86batch/s] 29%|███████▋                   | 291/1014 [00:08<00:20, 34.80batch/s] 29%|███████▉                   | 296/1014 [00:08<00:20, 34.96batch/s] 30%|████████                   | 301/1014 [00:08<00:20, 34.99batch/s] 30%|████████▏                  | 306/1014 [00:08<00:20, 35.12batch/s] 31%|████████▎                  | 311/1014 [00:08<00:19, 35.23batch/s] 31%|████████▍                  | 316/1014 [00:08<00:19, 35.20batch/s] 32%|████████▌                  | 321/1014 [00:09<00:19, 35.24batch/s] 32%|████████▋                  | 326/1014 [00:09<00:19, 35.18batch/s] 33%|████████▊                  | 331/1014 [00:09<00:19, 35.01batch/s] 33%|████████▉                  | 336/1014 [00:09<00:19, 35.14batch/s] 34%|█████████                  | 341/1014 [00:09<00:19, 35.24batch/s] 34%|█████████▏                 | 346/1014 [00:09<00:18, 35.24batch/s] 35%|█████████▎                 | 351/1014 [00:09<00:18, 35.25batch/s] 35%|█████████▍                 | 356/1014 [00:10<00:18, 35.28batch/s] 36%|█████████▌                 | 361/1014 [00:10<00:18, 35.18batch/s] 36%|█████████▋                 | 366/1014 [00:10<00:18, 35.17batch/s] 37%|█████████▉                 | 371/1014 [00:10<00:18, 35.20batch/s] 37%|██████████                 | 376/1014 [00:10<00:18, 35.15batch/s] 38%|██████████▏                | 381/1014 [00:10<00:17, 35.20batch/s] 38%|██████████▎                | 386/1014 [00:10<00:17, 35.21batch/s] 39%|██████████▍                | 391/1014 [00:11<00:17, 35.10batch/s] 39%|██████████▌                | 396/1014 [00:11<00:17, 35.06batch/s] 40%|██████████▋                | 401/1014 [00:11<00:17, 35.19batch/s] 40%|██████████▊                | 406/1014 [00:11<00:17, 35.20batch/s] 41%|██████████▉                | 411/1014 [00:11<00:17, 35.25batch/s] 41%|███████████                | 416/1014 [00:11<00:16, 35.24batch/s] 42%|███████████▏               | 421/1014 [00:11<00:16, 35.28batch/s] 42%|███████████▎               | 426/1014 [00:12<00:16, 35.22batch/s] 43%|███████████▍               | 431/1014 [00:12<00:16, 35.10batch/s] 43%|███████████▌               | 436/1014 [00:12<00:16, 35.10batch/s] 43%|███████████▋               | 441/1014 [00:12<00:16, 35.12batch/s] 44%|███████████▉               | 446/1014 [00:12<00:16, 35.17batch/s] 44%|████████████               | 451/1014 [00:12<00:15, 35.22batch/s] 45%|████████████▏              | 456/1014 [00:12<00:15, 35.23batch/s] 45%|████████████▎              | 461/1014 [00:13<00:15, 35.17batch/s] 46%|████████████▍              | 466/1014 [00:13<00:15, 35.10batch/s] 46%|████████████▌              | 471/1014 [00:13<00:15, 35.06batch/s] 47%|████████████▋              | 476/1014 [00:13<00:15, 35.07batch/s] 47%|████████████▊              | 481/1014 [00:13<00:15, 35.09batch/s] 48%|████████████▉              | 486/1014 [00:13<00:15, 35.08batch/s] 48%|█████████████              | 491/1014 [00:14<00:14, 35.07batch/s] 49%|█████████████▏             | 496/1014 [00:14<00:14, 35.12batch/s] 49%|█████████████▎             | 501/1014 [00:14<00:14, 35.11batch/s] 50%|█████████████▍             | 506/1014 [00:14<00:14, 35.10batch/s] 50%|█████████████▌             | 511/1014 [00:14<00:14, 35.11batch/s] 51%|█████████████▋             | 516/1014 [00:14<00:14, 35.16batch/s] 51%|█████████████▊             | 521/1014 [00:14<00:14, 35.14batch/s] 52%|██████████████             | 526/1014 [00:14<00:13, 35.14batch/s] 52%|██████████████▏            | 531/1014 [00:15<00:13, 35.20batch/s] 53%|██████████████▎            | 536/1014 [00:15<00:13, 35.15batch/s] 53%|██████████████▍            | 541/1014 [00:15<00:13, 35.20batch/s] 54%|██████████████▌            | 546/1014 [00:15<00:13, 35.22batch/s] 54%|██████████████▋            | 551/1014 [00:15<00:13, 35.20batch/s] 55%|██████████████▊            | 556/1014 [00:15<00:13, 35.22batch/s] 55%|██████████████▉            | 561/1014 [00:15<00:12, 35.19batch/s] 56%|███████████████            | 566/1014 [00:16<00:12, 35.20batch/s] 56%|███████████████▏           | 571/1014 [00:16<00:12, 35.22batch/s] 57%|███████████████▎           | 576/1014 [00:16<00:12, 35.19batch/s] 57%|███████████████▍           | 581/1014 [00:16<00:12, 35.11batch/s] 58%|███████████████▌           | 586/1014 [00:16<00:12, 35.06batch/s] 58%|███████████████▋           | 591/1014 [00:16<00:12, 35.07batch/s] 59%|███████████████▊           | 596/1014 [00:16<00:11, 35.11batch/s] 59%|████████████████           | 601/1014 [00:17<00:11, 35.14batch/s] 60%|████████████████▏          | 606/1014 [00:17<00:11, 35.12batch/s] 60%|████████████████▎          | 611/1014 [00:17<00:11, 35.10batch/s] 61%|████████████████▍          | 616/1014 [00:17<00:11, 35.09batch/s] 61%|████████████████▌          | 621/1014 [00:17<00:11, 35.11batch/s] 62%|████████████████▋          | 626/1014 [00:17<00:11, 35.11batch/s] 62%|████████████████▊          | 631/1014 [00:17<00:10, 35.09batch/s] 63%|████████████████▉          | 636/1014 [00:18<00:10, 35.03batch/s] 63%|█████████████████          | 641/1014 [00:18<00:10, 35.00batch/s] 64%|█████████████████▏         | 646/1014 [00:18<00:10, 35.02batch/s] 64%|█████████████████▎         | 651/1014 [00:18<00:10, 35.03batch/s] 65%|█████████████████▍         | 656/1014 [00:18<00:10, 35.03batch/s] 65%|█████████████████▌         | 661/1014 [00:18<00:10, 35.04batch/s] 66%|█████████████████▋         | 666/1014 [00:18<00:09, 35.06batch/s] 66%|█████████████████▊         | 671/1014 [00:19<00:09, 35.05batch/s] 67%|██████████████████         | 676/1014 [00:19<00:09, 35.10batch/s] 67%|██████████████████▏        | 681/1014 [00:19<00:09, 35.11batch/s] 68%|██████████████████▎        | 686/1014 [00:19<00:09, 35.11batch/s] 68%|██████████████████▍        | 691/1014 [00:19<00:09, 35.07batch/s] 69%|██████████████████▌        | 696/1014 [00:19<00:09, 35.08batch/s] 69%|██████████████████▋        | 701/1014 [00:19<00:08, 35.14batch/s] 70%|██████████████████▊        | 706/1014 [00:20<00:08, 35.17batch/s] 70%|██████████████████▉        | 711/1014 [00:20<00:08, 35.12batch/s] 71%|███████████████████        | 716/1014 [00:20<00:08, 35.16batch/s] 71%|███████████████████▏       | 721/1014 [00:20<00:08, 35.17batch/s] 72%|███████████████████▎       | 726/1014 [00:20<00:08, 35.13batch/s] 72%|███████████████████▍       | 731/1014 [00:20<00:08, 35.14batch/s] 73%|███████████████████▌       | 736/1014 [00:20<00:07, 35.19batch/s] 73%|███████████████████▋       | 741/1014 [00:21<00:07, 35.20batch/s] 74%|███████████████████▊       | 746/1014 [00:21<00:07, 35.23batch/s] 74%|███████████████████▉       | 751/1014 [00:21<00:07, 35.25batch/s] 75%|████████████████████▏      | 756/1014 [00:21<00:07, 35.25batch/s] 75%|████████████████████▎      | 761/1014 [00:21<00:07, 35.26batch/s] 76%|████████████████████▍      | 766/1014 [00:21<00:07, 35.27batch/s] 76%|████████████████████▌      | 771/1014 [00:21<00:06, 35.29batch/s] 77%|████████████████████▋      | 776/1014 [00:21<00:06, 35.33batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.31batch/s] 78%|████████████████████▉      | 786/1014 [00:22<00:06, 35.35batch/s] 78%|█████████████████████      | 791/1014 [00:22<00:06, 35.34batch/s] 79%|█████████████████████▏     | 796/1014 [00:22<00:06, 35.35batch/s] 79%|█████████████████████▎     | 801/1014 [00:22<00:06, 35.36batch/s] 79%|█████████████████████▍     | 806/1014 [00:22<00:05, 35.36batch/s] 80%|█████████████████████▌     | 811/1014 [00:22<00:05, 35.40batch/s] 80%|█████████████████████▋     | 816/1014 [00:23<00:05, 35.38batch/s] 81%|█████████████████████▊     | 821/1014 [00:23<00:05, 35.29batch/s] 81%|█████████████████████▉     | 826/1014 [00:23<00:05, 35.32batch/s] 82%|██████████████████████▏    | 831/1014 [00:23<00:05, 35.27batch/s] 82%|██████████████████████▎    | 836/1014 [00:23<00:05, 35.27batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.21batch/s] 83%|██████████████████████▌    | 846/1014 [00:24<00:04, 35.19batch/s] 84%|██████████████████████▋    | 851/1014 [00:24<00:04, 35.20batch/s] 84%|██████████████████████▊    | 856/1014 [00:24<00:04, 35.23batch/s] 85%|██████████████████████▉    | 861/1014 [00:24<00:04, 35.22batch/s] 85%|███████████████████████    | 866/1014 [00:24<00:04, 35.24batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.26batch/s] 86%|███████████████████████▎   | 876/1014 [00:24<00:03, 35.27batch/s] 87%|███████████████████████▍   | 881/1014 [00:24<00:03, 35.31batch/s] 87%|███████████████████████▌   | 886/1014 [00:25<00:03, 35.33batch/s] 88%|███████████████████████▋   | 891/1014 [00:25<00:03, 35.32batch/s] 88%|███████████████████████▊   | 896/1014 [00:25<00:03, 35.29batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.24batch/s] 89%|████████████████████████   | 906/1014 [00:25<00:03, 35.26batch/s] 90%|████████████████████████▎  | 911/1014 [00:25<00:02, 35.23batch/s] 90%|████████████████████████▍  | 916/1014 [00:25<00:02, 35.26batch/s] 91%|████████████████████████▌  | 921/1014 [00:26<00:02, 35.27batch/s] 91%|████████████████████████▋  | 926/1014 [00:26<00:02, 35.28batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.24batch/s] 92%|████████████████████████▉  | 936/1014 [00:26<00:02, 35.25batch/s] 93%|█████████████████████████  | 941/1014 [00:26<00:02, 35.17batch/s] 93%|█████████████████████████▏ | 946/1014 [00:26<00:01, 35.16batch/s] 94%|█████████████████████████▎ | 951/1014 [00:27<00:01, 35.16batch/s] 94%|█████████████████████████▍ | 956/1014 [00:27<00:01, 35.12batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.08batch/s] 95%|█████████████████████████▋ | 966/1014 [00:27<00:01, 35.07batch/s] 96%|█████████████████████████▊ | 971/1014 [00:27<00:01, 35.06batch/s] 96%|█████████████████████████▉ | 976/1014 [00:27<00:01, 35.09batch/s] 97%|██████████████████████████ | 981/1014 [00:27<00:00, 35.07batch/s] 97%|██████████████████████████▎| 986/1014 [00:28<00:00, 35.10batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 35.07batch/s] 98%|██████████████████████████▌| 996/1014 [00:28<00:00, 35.02batch/s] 99%|█████████████████████████▋| 1001/1014 [00:28<00:00, 35.03batch/s] 99%|█████████████████████████▊| 1006/1014 [00:28<00:00, 35.05batch/s]100%|█████████████████████████▉| 1011/1014 [00:28<00:00, 35.06batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.06batch/s]
Validation 34 -> LOSS = 0.25
Validation 34 -> BLEU = 96.19, 98.4/96.8/95.5/94.1 (BP=1.000, ratio=1.000, hyp_len=14381, ref_len=14382)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.25 @ validation 34
--> Best BLEU so far: 96.21 @ validation 33
Starting Epoch 35
Epoch 35 - update      16410 => loss:   0.174 (#OOM: 0)
Epoch 35 - update      16440 => loss:   0.092 (#OOM: 0)
Epoch 35 - update      16470 => loss:   0.089 (#OOM: 0)
Epoch 35 - update      16500 => loss:   0.131 (#OOM: 0)
Epoch 35 - update      16530 => loss:   0.081 (#OOM: 0)
Epoch 35 - update      16560 => loss:   0.078 (#OOM: 0)
Epoch 35 - update      16590 => loss:   0.137 (#OOM: 0)
Epoch 35 - update      16620 => loss:   0.093 (#OOM: 0)
Epoch 35 - update      16650 => loss:   0.106 (#OOM: 0)
Epoch 35 - update      16680 => loss:   0.149 (#OOM: 0)
Epoch 35 - update      16710 => loss:   0.065 (#OOM: 0)
Epoch 35 - update      16740 => loss:   0.113 (#OOM: 0)
Epoch 35 - update      16770 => loss:   0.100 (#OOM: 0)
Epoch 35 - update      16800 => loss:   0.113 (#OOM: 0)
Epoch 35 - update      16830 => loss:   0.111 (#OOM: 0)
Epoch 35 - update      16860 => loss:   0.136 (#OOM: 0)
--> Epoch 35 finished with mean loss 0.11988
--> Overhead/Training/Evaluation: 0.67/0.72/0.00 mins (total: 1.39 mins)   (671 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  9%|██▋                            | 3/34 [00:00<00:02, 14.08batch/s] 18%|█████▍                         | 6/34 [00:00<00:02, 10.84batch/s] 26%|████████▏                      | 9/34 [00:00<00:02, 10.71batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.29batch/s] 44%|█████████████▏                | 15/34 [00:01<00:01, 11.74batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 11.69batch/s] 62%|██████████████████▌           | 21/34 [00:01<00:01, 12.04batch/s] 71%|█████████████████████▏        | 24/34 [00:01<00:00, 12.07batch/s] 79%|███████████████████████▊      | 27/34 [00:02<00:00, 12.78batch/s] 88%|██████████████████████████▍   | 30/34 [00:02<00:00, 13.15batch/s] 97%|█████████████████████████████ | 33/34 [00:02<00:00, 13.51batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.41batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 4/1014 [00:00<00:26, 38.35batch/s]  1%|▏                            | 8/1014 [00:00<00:30, 33.42batch/s]  1%|▎                           | 12/1014 [00:00<00:28, 35.17batch/s]  2%|▍                           | 16/1014 [00:00<00:28, 35.32batch/s]  2%|▌                           | 20/1014 [00:00<00:28, 34.31batch/s]  2%|▋                           | 24/1014 [00:00<00:29, 33.73batch/s]  3%|▊                           | 29/1014 [00:00<00:28, 34.64batch/s]  3%|▉                           | 34/1014 [00:01<00:28, 33.84batch/s]  4%|█                           | 39/1014 [00:01<00:29, 33.61batch/s]  4%|█▏                          | 44/1014 [00:01<00:28, 34.49batch/s]  5%|█▎                          | 49/1014 [00:01<00:27, 34.86batch/s]  5%|█▍                          | 54/1014 [00:01<00:27, 34.99batch/s]  6%|█▋                          | 59/1014 [00:01<00:27, 35.22batch/s]  6%|█▊                          | 64/1014 [00:01<00:27, 34.86batch/s]  7%|█▉                          | 69/1014 [00:01<00:27, 34.65batch/s]  7%|██                          | 74/1014 [00:02<00:27, 34.52batch/s]  8%|██▏                         | 79/1014 [00:02<00:27, 34.19batch/s]  8%|██▎                         | 84/1014 [00:02<00:27, 34.40batch/s]  9%|██▍                         | 89/1014 [00:02<00:27, 34.06batch/s]  9%|██▌                         | 94/1014 [00:02<00:26, 34.20batch/s] 10%|██▋                         | 99/1014 [00:02<00:26, 34.29batch/s] 10%|██▊                        | 104/1014 [00:03<00:26, 34.25batch/s] 11%|██▉                        | 109/1014 [00:03<00:26, 34.15batch/s] 11%|███                        | 114/1014 [00:03<00:26, 34.21batch/s] 12%|███▏                       | 119/1014 [00:03<00:26, 34.34batch/s] 12%|███▎                       | 124/1014 [00:03<00:25, 34.45batch/s] 13%|███▍                       | 129/1014 [00:03<00:25, 34.45batch/s] 13%|███▌                       | 134/1014 [00:03<00:25, 34.63batch/s] 14%|███▋                       | 139/1014 [00:03<00:25, 34.79batch/s] 14%|███▊                       | 144/1014 [00:04<00:24, 35.13batch/s] 15%|███▉                       | 149/1014 [00:04<00:24, 35.22batch/s] 15%|████                       | 154/1014 [00:04<00:24, 35.21batch/s] 16%|████▏                      | 159/1014 [00:04<00:24, 35.24batch/s] 16%|████▎                      | 164/1014 [00:04<00:24, 35.39batch/s] 17%|████▌                      | 169/1014 [00:04<00:23, 35.46batch/s] 17%|████▋                      | 174/1014 [00:04<00:23, 35.38batch/s] 18%|████▊                      | 179/1014 [00:05<00:23, 35.44batch/s] 18%|████▉                      | 184/1014 [00:05<00:23, 35.53batch/s] 19%|█████                      | 189/1014 [00:05<00:23, 35.56batch/s] 19%|█████▏                     | 194/1014 [00:05<00:22, 35.71batch/s] 20%|█████▎                     | 199/1014 [00:05<00:22, 35.67batch/s] 20%|█████▍                     | 204/1014 [00:05<00:22, 35.64batch/s] 21%|█████▌                     | 209/1014 [00:05<00:22, 35.51batch/s] 21%|█████▋                     | 214/1014 [00:06<00:22, 35.55batch/s] 22%|█████▊                     | 219/1014 [00:06<00:22, 35.55batch/s] 22%|█████▉                     | 224/1014 [00:06<00:22, 35.38batch/s] 23%|██████                     | 229/1014 [00:06<00:22, 35.42batch/s] 23%|██████▏                    | 234/1014 [00:06<00:21, 35.50batch/s] 24%|██████▎                    | 239/1014 [00:06<00:21, 35.65batch/s] 24%|██████▍                    | 244/1014 [00:06<00:21, 35.61batch/s] 25%|██████▋                    | 249/1014 [00:06<00:21, 35.74batch/s] 25%|██████▊                    | 254/1014 [00:07<00:21, 35.75batch/s] 26%|██████▉                    | 259/1014 [00:07<00:21, 35.74batch/s] 26%|███████                    | 264/1014 [00:07<00:20, 35.84batch/s] 27%|███████▏                   | 269/1014 [00:07<00:20, 35.83batch/s] 27%|███████▎                   | 274/1014 [00:07<00:20, 35.86batch/s] 28%|███████▍                   | 279/1014 [00:07<00:20, 35.76batch/s] 28%|███████▌                   | 284/1014 [00:07<00:20, 35.64batch/s] 29%|███████▋                   | 289/1014 [00:08<00:20, 35.70batch/s] 29%|███████▊                   | 294/1014 [00:08<00:20, 35.78batch/s] 29%|███████▉                   | 299/1014 [00:08<00:19, 35.92batch/s] 30%|████████                   | 304/1014 [00:08<00:19, 35.86batch/s] 30%|████████▏                  | 309/1014 [00:08<00:19, 35.84batch/s] 31%|████████▎                  | 314/1014 [00:08<00:19, 35.93batch/s] 31%|████████▍                  | 319/1014 [00:08<00:19, 36.04batch/s] 32%|████████▋                  | 324/1014 [00:08<00:19, 36.06batch/s] 32%|████████▊                  | 329/1014 [00:09<00:19, 36.05batch/s] 33%|████████▉                  | 334/1014 [00:09<00:18, 36.13batch/s] 33%|█████████                  | 339/1014 [00:09<00:18, 35.95batch/s] 34%|█████████▏                 | 344/1014 [00:09<00:18, 36.00batch/s] 34%|█████████▎                 | 349/1014 [00:09<00:18, 35.89batch/s] 35%|█████████▍                 | 354/1014 [00:09<00:18, 35.97batch/s] 35%|█████████▌                 | 359/1014 [00:10<00:18, 35.83batch/s] 36%|█████████▋                 | 364/1014 [00:10<00:18, 35.66batch/s] 36%|█████████▊                 | 369/1014 [00:10<00:18, 35.61batch/s] 37%|█████████▉                 | 374/1014 [00:10<00:17, 35.68batch/s] 37%|██████████                 | 379/1014 [00:10<00:17, 35.70batch/s] 38%|██████████▏                | 384/1014 [00:10<00:17, 35.78batch/s] 38%|██████████▎                | 389/1014 [00:10<00:17, 35.78batch/s] 39%|██████████▍                | 394/1014 [00:11<00:17, 35.74batch/s] 39%|██████████▌                | 399/1014 [00:11<00:17, 35.75batch/s] 40%|██████████▊                | 404/1014 [00:11<00:17, 35.79batch/s] 40%|██████████▉                | 409/1014 [00:11<00:16, 35.70batch/s] 41%|███████████                | 414/1014 [00:11<00:16, 35.80batch/s] 41%|███████████▏               | 419/1014 [00:11<00:16, 35.80batch/s] 42%|███████████▎               | 424/1014 [00:11<00:16, 35.83batch/s] 42%|███████████▍               | 429/1014 [00:11<00:16, 35.85batch/s] 43%|███████████▌               | 434/1014 [00:12<00:16, 35.85batch/s] 43%|███████████▋               | 439/1014 [00:12<00:16, 35.81batch/s] 44%|███████████▊               | 444/1014 [00:12<00:15, 35.78batch/s] 44%|███████████▉               | 449/1014 [00:12<00:15, 35.75batch/s] 45%|████████████               | 454/1014 [00:12<00:15, 35.71batch/s] 45%|████████████▏              | 459/1014 [00:12<00:15, 35.70batch/s] 46%|████████████▎              | 464/1014 [00:13<00:15, 35.69batch/s] 46%|████████████▍              | 469/1014 [00:13<00:15, 35.63batch/s] 47%|████████████▌              | 474/1014 [00:13<00:15, 35.67batch/s] 47%|████████████▊              | 479/1014 [00:13<00:15, 35.58batch/s] 48%|████████████▉              | 484/1014 [00:13<00:14, 35.61batch/s] 48%|█████████████              | 489/1014 [00:13<00:14, 35.61batch/s] 49%|█████████████▏             | 494/1014 [00:13<00:14, 35.54batch/s] 49%|█████████████▎             | 499/1014 [00:14<00:14, 35.51batch/s] 50%|█████████████▍             | 504/1014 [00:14<00:14, 35.51batch/s] 50%|█████████████▌             | 509/1014 [00:14<00:14, 35.56batch/s] 51%|█████████████▋             | 514/1014 [00:14<00:14, 35.44batch/s] 51%|█████████████▊             | 519/1014 [00:14<00:13, 35.46batch/s] 52%|█████████████▉             | 524/1014 [00:14<00:13, 35.56batch/s] 52%|██████████████             | 529/1014 [00:14<00:13, 35.51batch/s] 53%|██████████████▏            | 534/1014 [00:15<00:13, 35.57batch/s] 53%|██████████████▎            | 539/1014 [00:15<00:13, 35.55batch/s] 54%|██████████████▍            | 544/1014 [00:15<00:13, 35.61batch/s] 54%|██████████████▌            | 549/1014 [00:15<00:13, 35.60batch/s] 55%|██████████████▊            | 554/1014 [00:15<00:12, 35.68batch/s] 55%|██████████████▉            | 559/1014 [00:15<00:12, 35.67batch/s] 56%|███████████████            | 564/1014 [00:15<00:12, 35.67batch/s] 56%|███████████████▏           | 569/1014 [00:15<00:12, 35.70batch/s] 57%|███████████████▎           | 574/1014 [00:16<00:12, 35.74batch/s] 57%|███████████████▍           | 579/1014 [00:16<00:12, 35.71batch/s] 58%|███████████████▌           | 584/1014 [00:16<00:12, 35.69batch/s] 58%|███████████████▋           | 589/1014 [00:16<00:11, 35.72batch/s] 59%|███████████████▊           | 594/1014 [00:16<00:11, 35.66batch/s] 59%|███████████████▉           | 599/1014 [00:16<00:11, 35.69batch/s] 60%|████████████████           | 604/1014 [00:16<00:11, 35.67batch/s] 60%|████████████████▏          | 609/1014 [00:17<00:11, 35.69batch/s] 61%|████████████████▎          | 614/1014 [00:17<00:11, 35.75batch/s] 61%|████████████████▍          | 619/1014 [00:17<00:11, 35.76batch/s] 62%|████████████████▌          | 624/1014 [00:17<00:10, 35.72batch/s] 62%|████████████████▋          | 629/1014 [00:17<00:10, 35.66batch/s] 63%|████████████████▉          | 634/1014 [00:17<00:10, 35.66batch/s] 63%|█████████████████          | 639/1014 [00:17<00:10, 35.68batch/s] 64%|█████████████████▏         | 644/1014 [00:18<00:10, 35.73batch/s] 64%|█████████████████▎         | 649/1014 [00:18<00:10, 35.71batch/s] 64%|█████████████████▍         | 654/1014 [00:18<00:10, 35.72batch/s] 65%|█████████████████▌         | 659/1014 [00:18<00:09, 35.70batch/s] 65%|█████████████████▋         | 664/1014 [00:18<00:09, 35.74batch/s] 66%|█████████████████▊         | 669/1014 [00:18<00:09, 35.68batch/s] 66%|█████████████████▉         | 674/1014 [00:18<00:09, 35.61batch/s] 67%|██████████████████         | 679/1014 [00:19<00:09, 35.57batch/s] 67%|██████████████████▏        | 684/1014 [00:19<00:09, 35.57batch/s] 68%|██████████████████▎        | 689/1014 [00:19<00:09, 35.59batch/s] 68%|██████████████████▍        | 694/1014 [00:19<00:08, 35.63batch/s] 69%|██████████████████▌        | 699/1014 [00:19<00:08, 35.66batch/s] 69%|██████████████████▋        | 704/1014 [00:19<00:08, 35.63batch/s] 70%|██████████████████▉        | 709/1014 [00:19<00:08, 35.66batch/s] 70%|███████████████████        | 714/1014 [00:20<00:08, 35.67batch/s] 71%|███████████████████▏       | 719/1014 [00:20<00:08, 35.63batch/s] 71%|███████████████████▎       | 724/1014 [00:20<00:08, 35.67batch/s] 72%|███████████████████▍       | 729/1014 [00:20<00:07, 35.63batch/s] 72%|███████████████████▌       | 734/1014 [00:20<00:07, 35.62batch/s] 73%|███████████████████▋       | 739/1014 [00:20<00:07, 35.64batch/s] 73%|███████████████████▊       | 744/1014 [00:20<00:07, 35.63batch/s] 74%|███████████████████▉       | 749/1014 [00:21<00:07, 35.60batch/s] 74%|████████████████████       | 754/1014 [00:21<00:07, 35.61batch/s] 75%|████████████████████▏      | 759/1014 [00:21<00:07, 35.64batch/s] 75%|████████████████████▎      | 764/1014 [00:21<00:07, 35.63batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.61batch/s] 76%|████████████████████▌      | 774/1014 [00:21<00:06, 35.60batch/s] 77%|████████████████████▋      | 779/1014 [00:21<00:06, 35.57batch/s] 77%|████████████████████▉      | 784/1014 [00:22<00:06, 35.52batch/s] 78%|█████████████████████      | 789/1014 [00:22<00:06, 35.47batch/s] 78%|█████████████████████▏     | 794/1014 [00:22<00:06, 35.45batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.46batch/s] 79%|█████████████████████▍     | 804/1014 [00:22<00:05, 35.51batch/s] 80%|█████████████████████▌     | 809/1014 [00:22<00:05, 35.55batch/s] 80%|█████████████████████▋     | 814/1014 [00:22<00:05, 35.56batch/s] 81%|█████████████████████▊     | 819/1014 [00:23<00:05, 35.46batch/s] 81%|█████████████████████▉     | 824/1014 [00:23<00:05, 35.46batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.47batch/s] 82%|██████████████████████▏    | 834/1014 [00:23<00:05, 35.48batch/s] 83%|██████████████████████▎    | 839/1014 [00:23<00:04, 35.50batch/s] 83%|██████████████████████▍    | 844/1014 [00:23<00:04, 35.52batch/s] 84%|██████████████████████▌    | 849/1014 [00:23<00:04, 35.48batch/s] 84%|██████████████████████▋    | 854/1014 [00:24<00:04, 35.51batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.49batch/s] 85%|███████████████████████    | 864/1014 [00:24<00:04, 35.50batch/s] 86%|███████████████████████▏   | 869/1014 [00:24<00:04, 35.49batch/s] 86%|███████████████████████▎   | 874/1014 [00:24<00:03, 35.48batch/s] 87%|███████████████████████▍   | 879/1014 [00:24<00:03, 35.47batch/s] 87%|███████████████████████▌   | 884/1014 [00:24<00:03, 35.45batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.49batch/s] 88%|███████████████████████▊   | 894/1014 [00:25<00:03, 35.48batch/s] 89%|███████████████████████▉   | 899/1014 [00:25<00:03, 35.52batch/s] 89%|████████████████████████   | 904/1014 [00:25<00:03, 35.51batch/s] 90%|████████████████████████▏  | 909/1014 [00:25<00:02, 35.48batch/s] 90%|████████████████████████▎  | 914/1014 [00:25<00:02, 35.41batch/s] 91%|████████████████████████▍  | 919/1014 [00:25<00:02, 35.41batch/s] 91%|████████████████████████▌  | 924/1014 [00:26<00:02, 35.41batch/s] 92%|████████████████████████▋  | 929/1014 [00:26<00:02, 35.43batch/s] 92%|████████████████████████▊  | 934/1014 [00:26<00:02, 35.41batch/s] 93%|█████████████████████████  | 939/1014 [00:26<00:02, 35.36batch/s] 93%|█████████████████████████▏ | 944/1014 [00:26<00:01, 35.32batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.34batch/s] 94%|█████████████████████████▍ | 954/1014 [00:27<00:01, 35.30batch/s] 95%|█████████████████████████▌ | 959/1014 [00:27<00:01, 35.29batch/s] 95%|█████████████████████████▋ | 964/1014 [00:27<00:01, 35.27batch/s] 96%|█████████████████████████▊ | 969/1014 [00:27<00:01, 35.24batch/s] 96%|█████████████████████████▉ | 974/1014 [00:27<00:01, 35.24batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.27batch/s] 97%|██████████████████████████▏| 984/1014 [00:27<00:00, 35.30batch/s] 98%|██████████████████████████▎| 989/1014 [00:28<00:00, 35.29batch/s] 98%|██████████████████████████▍| 994/1014 [00:28<00:00, 35.24batch/s] 99%|██████████████████████████▌| 999/1014 [00:28<00:00, 35.25batch/s] 99%|█████████████████████████▋| 1004/1014 [00:28<00:00, 35.26batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.27batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.26batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.26batch/s]
Validation 35 -> LOSS = 0.25
Validation 35 -> BLEU = 96.23, 98.5/96.8/95.5/94.1 (BP=1.000, ratio=1.000, hyp_len=14382, ref_len=14382)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.23 @ validation 35
Starting Epoch 36
Epoch 36 - update      16890 => loss:   0.129 (#OOM: 0)
Epoch 36 - update      16920 => loss:   0.136 (#OOM: 0)
Epoch 36 - update      16950 => loss:   0.086 (#OOM: 0)
Epoch 36 - update      16980 => loss:   0.061 (#OOM: 0)
Epoch 36 - update      17010 => loss:   0.106 (#OOM: 0)
Epoch 36 - update      17040 => loss:   0.097 (#OOM: 0)
Epoch 36 - update      17070 => loss:   0.110 (#OOM: 0)
Epoch 36 - update      17100 => loss:   0.108 (#OOM: 0)
Epoch 36 - update      17130 => loss:   0.091 (#OOM: 0)
Epoch 36 - update      17160 => loss:   0.127 (#OOM: 0)
Epoch 36 - update      17190 => loss:   0.126 (#OOM: 0)
Epoch 36 - update      17220 => loss:   0.104 (#OOM: 0)
Epoch 36 - update      17250 => loss:   0.092 (#OOM: 0)
Epoch 36 - update      17280 => loss:   0.121 (#OOM: 0)
Epoch 36 - update      17310 => loss:   0.187 (#OOM: 0)
Epoch 36 - update      17340 => loss:   0.067 (#OOM: 0)
--> Epoch 36 finished with mean loss 0.11780
--> Overhead/Training/Evaluation: 0.70/0.71/0.00 mins (total: 1.41 mins)   (679 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/34 [00:00<?, ?batch/s]  6%|█▊                             | 2/34 [00:00<00:01, 17.75batch/s] 12%|███▋                           | 4/34 [00:00<00:02, 13.21batch/s] 18%|█████▍                         | 6/34 [00:00<00:01, 14.09batch/s] 24%|███████▎                       | 8/34 [00:00<00:02, 12.99batch/s] 29%|████████▊                     | 10/34 [00:00<00:02, 11.91batch/s] 35%|██████████▌                   | 12/34 [00:01<00:01, 11.86batch/s] 41%|████████████▎                 | 14/34 [00:01<00:01, 11.81batch/s] 47%|██████████████                | 16/34 [00:01<00:01, 12.33batch/s] 53%|███████████████▉              | 18/34 [00:01<00:01, 12.55batch/s] 59%|█████████████████▋            | 20/34 [00:01<00:01, 11.99batch/s] 68%|████████████████████▎         | 23/34 [00:01<00:00, 12.14batch/s] 76%|██████████████████████▉       | 26/34 [00:02<00:00, 12.77batch/s] 85%|█████████████████████████▌    | 29/34 [00:02<00:00, 12.77batch/s] 94%|████████████████████████████▏ | 32/34 [00:02<00:00, 12.94batch/s]100%|██████████████████████████████| 34/34 [00:02<00:00, 13.24batch/s]
Performing greedy search (args: {'k': 7})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  0%|                             | 3/1014 [00:00<00:37, 27.30batch/s]  1%|▏                            | 8/1014 [00:00<00:27, 36.38batch/s]  1%|▎                           | 13/1014 [00:00<00:29, 33.66batch/s]  2%|▍                           | 18/1014 [00:00<00:30, 32.77batch/s]  2%|▋                           | 23/1014 [00:00<00:30, 32.50batch/s]  3%|▊                           | 28/1014 [00:00<00:31, 31.68batch/s]  3%|▉                           | 33/1014 [00:00<00:29, 33.12batch/s]  4%|█                           | 38/1014 [00:01<00:29, 33.25batch/s]  4%|█▏                          | 43/1014 [00:01<00:28, 34.55batch/s]  5%|█▎                          | 48/1014 [00:01<00:28, 34.12batch/s]  5%|█▍                          | 53/1014 [00:01<00:28, 34.07batch/s]  6%|█▌                          | 58/1014 [00:01<00:27, 34.42batch/s]  6%|█▋                          | 63/1014 [00:01<00:27, 34.06batch/s]  7%|█▉                          | 68/1014 [00:01<00:27, 34.27batch/s]  7%|██                          | 73/1014 [00:02<00:27, 34.66batch/s]  8%|██▏                         | 78/1014 [00:02<00:26, 35.10batch/s]  8%|██▎                         | 83/1014 [00:02<00:26, 34.91batch/s]  9%|██▍                         | 88/1014 [00:02<00:26, 34.51batch/s]  9%|██▌                         | 93/1014 [00:02<00:26, 34.41batch/s] 10%|██▋                         | 98/1014 [00:02<00:26, 34.35batch/s] 10%|██▋                        | 103/1014 [00:03<00:26, 34.33batch/s] 11%|██▉                        | 108/1014 [00:03<00:26, 34.35batch/s] 11%|███                        | 113/1014 [00:03<00:26, 34.31batch/s] 12%|███▏                       | 118/1014 [00:03<00:25, 34.60batch/s] 12%|███▎                       | 123/1014 [00:03<00:25, 34.80batch/s] 13%|███▍                       | 128/1014 [00:03<00:25, 34.80batch/s] 13%|███▌                       | 133/1014 [00:03<00:25, 34.68batch/s] 14%|███▋                       | 138/1014 [00:03<00:24, 35.05batch/s] 14%|███▊                       | 143/1014 [00:04<00:24, 35.13batch/s] 15%|███▉                       | 148/1014 [00:04<00:24, 35.32batch/s] 15%|████                       | 153/1014 [00:04<00:24, 35.32batch/s] 16%|████▏                      | 158/1014 [00:04<00:24, 35.44batch/s] 16%|████▎                      | 163/1014 [00:04<00:23, 35.50batch/s] 17%|████▍                      | 168/1014 [00:04<00:23, 35.55batch/s] 17%|████▌                      | 173/1014 [00:04<00:23, 35.59batch/s] 18%|████▋                      | 178/1014 [00:05<00:23, 35.53batch/s] 18%|████▊                      | 183/1014 [00:05<00:23, 35.39batch/s] 19%|█████                      | 188/1014 [00:05<00:23, 35.52batch/s] 19%|█████▏                     | 193/1014 [00:05<00:22, 35.73batch/s] 20%|█████▎                     | 198/1014 [00:05<00:22, 35.71batch/s] 20%|█████▍                     | 203/1014 [00:05<00:22, 35.74batch/s] 21%|█████▌                     | 208/1014 [00:05<00:22, 35.85batch/s] 21%|█████▋                     | 213/1014 [00:05<00:22, 35.58batch/s] 21%|█████▊                     | 218/1014 [00:06<00:22, 35.65batch/s] 22%|█████▉                     | 223/1014 [00:06<00:22, 35.68batch/s] 22%|██████                     | 228/1014 [00:06<00:22, 35.72batch/s] 23%|██████▏                    | 233/1014 [00:06<00:21, 35.77batch/s] 23%|██████▎                    | 238/1014 [00:06<00:21, 35.82batch/s] 24%|██████▍                    | 243/1014 [00:06<00:21, 35.93batch/s] 24%|██████▌                    | 248/1014 [00:06<00:21, 35.79batch/s] 25%|██████▋                    | 253/1014 [00:07<00:21, 35.93batch/s] 25%|██████▊                    | 258/1014 [00:07<00:21, 35.90batch/s] 26%|███████                    | 263/1014 [00:07<00:20, 35.77batch/s] 26%|███████▏                   | 268/1014 [00:07<00:20, 35.76batch/s] 27%|███████▎                   | 273/1014 [00:07<00:20, 35.75batch/s] 27%|███████▍                   | 278/1014 [00:07<00:20, 35.83batch/s] 28%|███████▌                   | 283/1014 [00:07<00:20, 35.84batch/s] 28%|███████▋                   | 288/1014 [00:08<00:20, 35.58batch/s] 29%|███████▊                   | 293/1014 [00:08<00:20, 35.44batch/s] 29%|███████▉                   | 298/1014 [00:08<00:20, 35.53batch/s] 30%|████████                   | 303/1014 [00:08<00:20, 35.54batch/s] 30%|████████▏                  | 308/1014 [00:08<00:19, 35.47batch/s] 31%|████████▎                  | 313/1014 [00:08<00:19, 35.57batch/s] 31%|████████▍                  | 318/1014 [00:08<00:19, 35.61batch/s] 32%|████████▌                  | 323/1014 [00:09<00:19, 35.56batch/s] 32%|████████▋                  | 328/1014 [00:09<00:19, 35.45batch/s] 33%|████████▊                  | 333/1014 [00:09<00:19, 35.38batch/s] 33%|█████████                  | 338/1014 [00:09<00:19, 35.34batch/s] 34%|█████████▏                 | 343/1014 [00:09<00:18, 35.33batch/s] 34%|█████████▎                 | 348/1014 [00:09<00:18, 35.34batch/s] 35%|█████████▍                 | 353/1014 [00:09<00:18, 35.34batch/s] 35%|█████████▌                 | 358/1014 [00:10<00:18, 35.33batch/s] 36%|█████████▋                 | 363/1014 [00:10<00:18, 35.36batch/s] 36%|█████████▊                 | 368/1014 [00:10<00:18, 35.38batch/s] 37%|█████████▉                 | 373/1014 [00:10<00:18, 35.28batch/s] 37%|██████████                 | 378/1014 [00:10<00:18, 35.12batch/s] 38%|██████████▏                | 383/1014 [00:10<00:17, 35.08batch/s] 38%|██████████▎                | 388/1014 [00:11<00:17, 35.08batch/s] 39%|██████████▍                | 393/1014 [00:11<00:17, 35.19batch/s] 39%|██████████▌                | 398/1014 [00:11<00:17, 35.23batch/s] 40%|██████████▋                | 403/1014 [00:11<00:17, 35.29batch/s] 40%|██████████▊                | 408/1014 [00:11<00:17, 35.32batch/s] 41%|██████████▉                | 413/1014 [00:11<00:17, 35.31batch/s] 41%|███████████▏               | 418/1014 [00:11<00:16, 35.35batch/s] 42%|███████████▎               | 423/1014 [00:11<00:16, 35.39batch/s] 42%|███████████▍               | 428/1014 [00:12<00:16, 35.36batch/s] 43%|███████████▌               | 433/1014 [00:12<00:16, 35.42batch/s] 43%|███████████▋               | 438/1014 [00:12<00:16, 35.35batch/s] 44%|███████████▊               | 443/1014 [00:12<00:16, 35.39batch/s] 44%|███████████▉               | 448/1014 [00:12<00:16, 35.34batch/s] 45%|████████████               | 453/1014 [00:12<00:15, 35.36batch/s] 45%|████████████▏              | 458/1014 [00:12<00:15, 35.42batch/s] 46%|████████████▎              | 463/1014 [00:13<00:15, 35.41batch/s] 46%|████████████▍              | 468/1014 [00:13<00:15, 35.34batch/s] 47%|████████████▌              | 473/1014 [00:13<00:15, 35.40batch/s] 47%|████████████▋              | 478/1014 [00:13<00:15, 35.44batch/s] 48%|████████████▊              | 483/1014 [00:13<00:14, 35.43batch/s] 48%|████████████▉              | 488/1014 [00:13<00:14, 35.48batch/s] 49%|█████████████▏             | 493/1014 [00:13<00:14, 35.50batch/s] 49%|█████████████▎             | 498/1014 [00:14<00:14, 35.55batch/s] 50%|█████████████▍             | 503/1014 [00:14<00:14, 35.59batch/s] 50%|█████████████▌             | 508/1014 [00:14<00:14, 35.56batch/s] 51%|█████████████▋             | 513/1014 [00:14<00:14, 35.54batch/s] 51%|█████████████▊             | 518/1014 [00:14<00:13, 35.53batch/s] 52%|█████████████▉             | 523/1014 [00:14<00:13, 35.57batch/s] 52%|██████████████             | 528/1014 [00:14<00:13, 35.55batch/s] 53%|██████████████▏            | 533/1014 [00:15<00:13, 35.50batch/s] 53%|██████████████▎            | 538/1014 [00:15<00:13, 35.57batch/s] 54%|██████████████▍            | 543/1014 [00:15<00:13, 35.55batch/s] 54%|██████████████▌            | 548/1014 [00:15<00:13, 35.53batch/s] 55%|██████████████▋            | 553/1014 [00:15<00:12, 35.52batch/s] 55%|██████████████▊            | 558/1014 [00:15<00:12, 35.55batch/s] 56%|██████████████▉            | 563/1014 [00:15<00:12, 35.48batch/s] 56%|███████████████            | 568/1014 [00:16<00:12, 35.43batch/s] 57%|███████████████▎           | 573/1014 [00:16<00:12, 35.43batch/s] 57%|███████████████▍           | 578/1014 [00:16<00:12, 35.38batch/s] 57%|███████████████▌           | 583/1014 [00:16<00:12, 35.37batch/s] 58%|███████████████▋           | 588/1014 [00:16<00:12, 35.34batch/s] 58%|███████████████▊           | 593/1014 [00:16<00:11, 35.37batch/s] 59%|███████████████▉           | 598/1014 [00:16<00:11, 35.36batch/s] 59%|████████████████           | 603/1014 [00:17<00:11, 35.32batch/s] 60%|████████████████▏          | 608/1014 [00:17<00:11, 35.38batch/s] 60%|████████████████▎          | 613/1014 [00:17<00:11, 35.36batch/s] 61%|████████████████▍          | 618/1014 [00:17<00:11, 35.40batch/s] 61%|████████████████▌          | 623/1014 [00:17<00:11, 35.40batch/s] 62%|████████████████▋          | 628/1014 [00:17<00:10, 35.37batch/s] 62%|████████████████▊          | 633/1014 [00:17<00:10, 35.39batch/s] 63%|████████████████▉          | 638/1014 [00:18<00:10, 35.36batch/s] 63%|█████████████████          | 643/1014 [00:18<00:10, 35.35batch/s] 64%|█████████████████▎         | 648/1014 [00:18<00:10, 35.36batch/s] 64%|█████████████████▍         | 653/1014 [00:18<00:10, 35.34batch/s] 65%|█████████████████▌         | 658/1014 [00:18<00:10, 35.40batch/s] 65%|█████████████████▋         | 663/1014 [00:18<00:09, 35.37batch/s] 66%|█████████████████▊         | 668/1014 [00:18<00:09, 35.33batch/s] 66%|█████████████████▉         | 673/1014 [00:19<00:09, 35.35batch/s] 67%|██████████████████         | 678/1014 [00:19<00:09, 35.37batch/s] 67%|██████████████████▏        | 683/1014 [00:19<00:09, 35.38batch/s] 68%|██████████████████▎        | 688/1014 [00:19<00:09, 35.39batch/s] 68%|██████████████████▍        | 693/1014 [00:19<00:09, 35.41batch/s] 69%|██████████████████▌        | 698/1014 [00:19<00:08, 35.44batch/s] 69%|██████████████████▋        | 703/1014 [00:19<00:08, 35.45batch/s] 70%|██████████████████▊        | 708/1014 [00:19<00:08, 35.43batch/s] 70%|██████████████████▉        | 713/1014 [00:20<00:08, 35.34batch/s] 71%|███████████████████        | 718/1014 [00:20<00:08, 35.37batch/s] 71%|███████████████████▎       | 723/1014 [00:20<00:08, 35.35batch/s] 72%|███████████████████▍       | 728/1014 [00:20<00:08, 35.31batch/s] 72%|███████████████████▌       | 733/1014 [00:20<00:07, 35.29batch/s] 73%|███████████████████▋       | 738/1014 [00:20<00:07, 35.27batch/s] 73%|███████████████████▊       | 743/1014 [00:21<00:07, 35.27batch/s] 74%|███████████████████▉       | 748/1014 [00:21<00:07, 35.26batch/s] 74%|████████████████████       | 753/1014 [00:21<00:07, 35.27batch/s] 75%|████████████████████▏      | 758/1014 [00:21<00:07, 35.31batch/s] 75%|████████████████████▎      | 763/1014 [00:21<00:07, 35.25batch/s] 76%|████████████████████▍      | 769/1014 [00:21<00:06, 35.34batch/s] 76%|████████████████████▋      | 775/1014 [00:21<00:06, 35.32batch/s] 77%|████████████████████▊      | 781/1014 [00:22<00:06, 35.34batch/s] 78%|████████████████████▉      | 787/1014 [00:22<00:06, 35.38batch/s] 78%|█████████████████████      | 793/1014 [00:22<00:06, 35.38batch/s] 79%|█████████████████████▎     | 799/1014 [00:22<00:06, 35.40batch/s] 79%|█████████████████████▍     | 805/1014 [00:22<00:05, 35.44batch/s] 80%|█████████████████████▌     | 811/1014 [00:22<00:05, 35.44batch/s] 81%|█████████████████████▊     | 817/1014 [00:23<00:05, 35.44batch/s] 81%|█████████████████████▉     | 823/1014 [00:23<00:05, 35.38batch/s] 82%|██████████████████████     | 829/1014 [00:23<00:05, 35.35batch/s] 82%|██████████████████████▏    | 835/1014 [00:23<00:05, 35.33batch/s] 83%|██████████████████████▍    | 841/1014 [00:23<00:04, 35.38batch/s] 84%|██████████████████████▌    | 847/1014 [00:23<00:04, 35.38batch/s] 84%|██████████████████████▋    | 853/1014 [00:24<00:04, 35.34batch/s] 85%|██████████████████████▊    | 859/1014 [00:24<00:04, 35.32batch/s] 85%|███████████████████████    | 865/1014 [00:24<00:04, 35.33batch/s] 86%|███████████████████████▏   | 871/1014 [00:24<00:04, 35.28batch/s] 86%|███████████████████████▎   | 877/1014 [00:24<00:03, 35.28batch/s] 87%|███████████████████████▌   | 883/1014 [00:25<00:03, 35.28batch/s] 88%|███████████████████████▋   | 889/1014 [00:25<00:03, 35.20batch/s] 88%|███████████████████████▊   | 895/1014 [00:25<00:03, 35.25batch/s] 89%|███████████████████████▉   | 901/1014 [00:25<00:03, 35.28batch/s] 89%|████████████████████████▏  | 907/1014 [00:25<00:03, 35.26batch/s] 90%|████████████████████████▎  | 913/1014 [00:25<00:02, 35.27batch/s] 91%|████████████████████████▍  | 919/1014 [00:26<00:02, 35.29batch/s] 91%|████████████████████████▋  | 925/1014 [00:26<00:02, 35.21batch/s] 92%|████████████████████████▊  | 931/1014 [00:26<00:02, 35.19batch/s] 92%|████████████████████████▉  | 937/1014 [00:26<00:02, 35.19batch/s] 93%|█████████████████████████  | 943/1014 [00:26<00:02, 35.15batch/s] 94%|█████████████████████████▎ | 949/1014 [00:26<00:01, 35.21batch/s] 94%|█████████████████████████▍ | 955/1014 [00:27<00:01, 35.23batch/s] 95%|█████████████████████████▌ | 961/1014 [00:27<00:01, 35.27batch/s] 95%|█████████████████████████▋ | 967/1014 [00:27<00:01, 35.30batch/s] 96%|█████████████████████████▉ | 973/1014 [00:27<00:01, 35.31batch/s] 97%|██████████████████████████ | 979/1014 [00:27<00:00, 35.33batch/s] 97%|██████████████████████████▏| 985/1014 [00:27<00:00, 35.32batch/s] 98%|██████████████████████████▍| 991/1014 [00:28<00:00, 35.31batch/s] 98%|██████████████████████████▌| 997/1014 [00:28<00:00, 35.28batch/s] 99%|█████████████████████████▋| 1003/1014 [00:28<00:00, 35.30batch/s]100%|█████████████████████████▊| 1009/1014 [00:28<00:00, 35.30batch/s]100%|██████████████████████████| 1014/1014 [00:28<00:00, 35.28batch/s]
Validation 36 -> LOSS = 0.25
Validation 36 -> BLEU = 96.39, 98.5/97.0/95.7/94.4 (BP=1.000, ratio=1.000, hyp_len=14380, ref_len=14382)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-rc59cc
--> Best LOSS so far: 0.25 @ validation 35
--> Best BLEU so far: 96.39 @ validation 36
Starting Epoch 37
Epoch 37 - update      17370 => loss:   0.141 (#OOM: 0)
Epoch 37 - update      17400 => loss:   0.090 (#OOM: 0)
Epoch 37 - update      17430 => loss:   0.095 (#OOM: 0)
Epoch 37 - update      17460 => loss:   0.157 (#OOM: 0)
Epoch 37 - update      17490 => loss:   0.079 (#OOM: 0)
Epoch 37 - update      17520 => loss:   0.146 (#OOM: 0)
Epoch 37 - update      17550 => loss:   0.130 (#OOM: 0)
Epoch 37 - update      17580 => loss:   0.178 (#OOM: 0)
Epoch 37 - update      17610 => loss:   0.070 (#OOM: 0)
Epoch 37 - update      17640 => loss:   0.124 (#OOM: 0)
Epoch 37 - update      17670 => loss:   0.111 (#OOM: 0)
Epoch 37 - update      17700 => loss:   0.183 (#OOM: 0)
slurmstepd: error: *** JOB 6622 ON cloud-vm-40-190 CANCELLED AT 2020-05-25T21:33:56 ***
Epoch 37 - update      17730 => loss:   0.085 (#OOM: 0)
Epoch 37 - update      17760 => loss:   0.098 (#OOM: 0)
