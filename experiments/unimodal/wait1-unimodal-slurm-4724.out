-------
[train]
-------
         num_workers:0
          pin_memory:False
                seed:1587662228
               gclip:1
              l2_reg:1e-05
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
          model_type:SimultaneousWaitKNMT
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:64
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:
             de-hyphen
     eval_batch_size:32
           eval_freq:0
        eval_max_len:100
          eval_start:1
           eval_zero:False
   save_best_metrics:True
           save_path:/homes/al4616/experiments/simnmt/nmtpy/w2w_models/en-de
    save_optim_state:False
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/homes/al4616/experiments/simnmt/nmtpy/w2w_models/en-de/tb_dir
     pretrained_file:
   pretrained_layers:
       freeze_layers:
          handle_oom:False
           subfolder:wait1-rnn-unimodal
              exp_id:simultaneouswaitknmt-r7b06f
------
[vars]
------
                  sl:en
                  tl:de
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             enc_dim:320
   enc_bidirectional:False
             dec_dim:320
             emb_dim:200
         dropout_emb:0.4
         dropout_ctx:0.5
         dropout_out:0.5
          n_encoders:2
            tied_emb:2way
             max_len:None
           out_logic:deep
           direction:src:Text -> trg:Text
        sampler_type:bucket
           bucket_by:src
     translator_args:
                     k:1
------
[data]
------
            txt_root:/vol/bitbucket/al4616/simmt/data/multi30k/en-de
           train_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/train.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/train.lc.norm.tok.de
             val_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/val.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/val.lc.norm.tok.de
test_2016_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/test_2016_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/test_2016_flickr.lc.norm.tok.de
test_2017_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/test_2017_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/test_2017_flickr.lc.norm.tok.de
------------
[vocabulary]
------------
                 src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/train.lc.norm.tok.vocab.en
                 trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/train.lc.norm.tok-min2.vocab.de
----------------------------------------------------------------------

Python 3.7.7 -- torch 1.4.0 with CUDA 10.1 (on machine 'kingfisher.doc.ic.ac.uk')
nmtpytorch 4.1.0
DeviceManager(cuda:0, n_gpu=1)
Seed for further reproducibility: 1587662228
SLURM Job ID: 4724
Loading dataset(s)
Initializing dataset for 'src'...
0sents [00:00, ?sents/s]16360sents [00:00, 163558.82sents/s]29000sents [00:00, 160026.65sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]14529sents [00:00, 145253.08sents/s]29000sents [00:00, 145888.48sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'train.lc.norm.tok.en' (29000 sentences)
  Targets:
    --> TextDataset 'train.lc.norm.tok.de' (29000 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 121643.57sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]1014sents [00:00, 19042.14sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)
  Targets:
    --> TextDataset 'val.lc.norm.tok.de' (1014 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 142997.25sents/s]
Skipping 'trg' as target
MultimodalDataset - (1 source(s) / 0 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)

Ignoring batch_size 32 for simultaneous greedy search
SimultaneousWaitKNMT(
  (encoders): ModuleDict(
    (src): TextEncoder(
      (do_emb): Dropout(p=0.4, inplace=False)
      (emb): Embedding(9797, 200, padding_idx=0)
      (enc): GRU(200, 320, num_layers=2)
      (output): Sequential(
        (0): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (dec): SimultaneousConditionalDecoder(
    (emb): Embedding(7875, 200, padding_idx=0)
    (att): ModuleDict(
      (src): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
    )
    (dec0): GRUCell(200, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.5, inplace=False)
    (hid2out): FF(in_features=840, out_features=200, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=200, out_features=7875, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss()
  )
)
Vocabulary of 9797 items ('train.lc.norm.tok.vocab.en')
Vocabulary of 7875 items ('train.lc.norm.tok-min2.vocab.de')
# parameters: 6.25M (6.25M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 1e-05, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Training started on 23-04-2020 18:17:15
Starting Epoch 1
Epoch 1 - update         30 => loss:   6.429 (#OOM: 0)
Epoch 1 - update         60 => loss:   5.716 (#OOM: 0)
Epoch 1 - update         90 => loss:   5.331 (#OOM: 0)
Epoch 1 - update        120 => loss:   5.251 (#OOM: 0)
Epoch 1 - update        150 => loss:   4.580 (#OOM: 0)
Epoch 1 - update        180 => loss:   4.867 (#OOM: 0)
Epoch 1 - update        210 => loss:   4.880 (#OOM: 0)
Epoch 1 - update        240 => loss:   4.771 (#OOM: 0)
Epoch 1 - update        270 => loss:   4.475 (#OOM: 0)
Epoch 1 - update        300 => loss:   4.620 (#OOM: 0)
Epoch 1 - update        330 => loss:   4.443 (#OOM: 0)
Epoch 1 - update        360 => loss:   3.823 (#OOM: 0)
Epoch 1 - update        390 => loss:   4.369 (#OOM: 0)
Epoch 1 - update        420 => loss:   4.377 (#OOM: 0)
Epoch 1 - update        450 => loss:   4.668 (#OOM: 0)
--> Epoch 1 finished with mean loss 4.91402
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (900 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.83batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.44batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.84batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.11batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 54.45batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.47batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:18, 53.89batch/s]  2%|▍                           | 18/1014 [00:00<00:15, 63.64batch/s]  3%|▋                           | 27/1014 [00:00<00:17, 57.20batch/s]  4%|▉                           | 36/1014 [00:00<00:16, 60.65batch/s]  4%|█▏                          | 45/1014 [00:00<00:15, 62.94batch/s]  5%|█▍                          | 54/1014 [00:00<00:14, 65.79batch/s]  6%|█▊                          | 64/1014 [00:00<00:13, 69.09batch/s]  7%|██                          | 74/1014 [00:01<00:13, 70.64batch/s]  8%|██▎                         | 84/1014 [00:01<00:12, 72.61batch/s]  9%|██▌                         | 94/1014 [00:01<00:12, 73.97batch/s] 10%|██▊                        | 104/1014 [00:01<00:12, 75.38batch/s] 11%|███                        | 114/1014 [00:01<00:11, 76.52batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 77.24batch/s] 13%|███▌                       | 134/1014 [00:01<00:11, 77.30batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 78.77batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 79.31batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 79.83batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 80.11batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 80.21batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 80.57batch/s] 21%|█████▌                     | 211/1014 [00:02<00:09, 80.74batch/s] 22%|█████▉                     | 222/1014 [00:02<00:09, 80.78batch/s] 23%|██████▏                    | 233/1014 [00:02<00:09, 81.36batch/s] 24%|██████▍                    | 244/1014 [00:02<00:09, 81.54batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 81.26batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 81.59batch/s] 27%|███████▍                   | 277/1014 [00:03<00:08, 81.90batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 82.38batch/s] 29%|███████▉                   | 299/1014 [00:03<00:08, 82.47batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 82.78batch/s] 32%|████████▌                  | 321/1014 [00:03<00:08, 82.85batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 82.65batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 82.61batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:07, 82.77batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:07, 82.15batch/s] 37%|██████████                 | 376/1014 [00:04<00:07, 82.27batch/s] 38%|██████████▎                | 387/1014 [00:04<00:07, 82.24batch/s] 39%|██████████▌                | 398/1014 [00:04<00:07, 82.44batch/s] 40%|██████████▉                | 409/1014 [00:04<00:07, 82.33batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 82.19batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 82.34batch/s] 44%|███████████▊               | 442/1014 [00:05<00:06, 82.42batch/s] 45%|████████████               | 453/1014 [00:05<00:06, 82.74batch/s] 46%|████████████▎              | 464/1014 [00:05<00:06, 82.77batch/s] 47%|████████████▋              | 475/1014 [00:05<00:06, 82.64batch/s] 48%|████████████▉              | 486/1014 [00:05<00:06, 82.52batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 82.48batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 82.58batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 81.52batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 80.23batch/s] 53%|██████████████▍            | 541/1014 [00:06<00:05, 80.40batch/s] 54%|██████████████▋            | 552/1014 [00:06<00:05, 80.48batch/s] 56%|██████████████▉            | 563/1014 [00:06<00:05, 80.74batch/s] 57%|███████████████▎           | 574/1014 [00:07<00:05, 80.95batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 81.16batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 81.27batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 81.32batch/s] 61%|████████████████▍          | 618/1014 [00:07<00:04, 81.29batch/s] 62%|████████████████▋          | 629/1014 [00:07<00:04, 81.32batch/s] 63%|█████████████████          | 640/1014 [00:07<00:04, 81.51batch/s] 64%|█████████████████▎         | 651/1014 [00:07<00:04, 81.73batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 81.67batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 81.63batch/s] 67%|██████████████████▏        | 684/1014 [00:08<00:04, 81.78batch/s] 69%|██████████████████▌        | 695/1014 [00:08<00:03, 81.99batch/s] 70%|██████████████████▊        | 706/1014 [00:08<00:03, 82.08batch/s] 71%|███████████████████        | 717/1014 [00:08<00:03, 82.02batch/s] 72%|███████████████████▍       | 728/1014 [00:08<00:03, 82.00batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 82.05batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 82.09batch/s] 75%|████████████████████▎      | 761/1014 [00:09<00:03, 82.04batch/s] 76%|████████████████████▌      | 772/1014 [00:09<00:02, 82.05batch/s] 77%|████████████████████▊      | 783/1014 [00:09<00:02, 82.08batch/s] 78%|█████████████████████▏     | 794/1014 [00:09<00:02, 82.19batch/s] 79%|█████████████████████▍     | 805/1014 [00:09<00:02, 81.71batch/s] 80%|█████████████████████▋     | 816/1014 [00:09<00:02, 81.73batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 81.89batch/s] 83%|██████████████████████▎    | 838/1014 [00:10<00:02, 80.98batch/s] 84%|██████████████████████▌    | 849/1014 [00:10<00:02, 80.96batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 80.90batch/s] 86%|███████████████████████▏   | 871/1014 [00:10<00:01, 80.89batch/s] 87%|███████████████████████▍   | 882/1014 [00:10<00:01, 81.00batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 80.59batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 80.56batch/s] 90%|████████████████████████▎  | 915/1014 [00:11<00:01, 80.79batch/s] 91%|████████████████████████▋  | 926/1014 [00:11<00:01, 80.86batch/s] 92%|████████████████████████▉  | 937/1014 [00:11<00:00, 81.05batch/s] 93%|█████████████████████████▏ | 948/1014 [00:11<00:00, 81.12batch/s] 95%|█████████████████████████▌ | 959/1014 [00:11<00:00, 80.84batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 80.51batch/s] 97%|██████████████████████████ | 981/1014 [00:12<00:00, 80.54batch/s] 98%|██████████████████████████▍| 992/1014 [00:12<00:00, 80.58batch/s] 99%|█████████████████████████▋| 1003/1014 [00:12<00:00, 80.71batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.72batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.71batch/s]
Validation 1 -> LOSS = 3.71
Validation 1 -> BLEU = 6.90, 33.9/9.9/4.0/1.7 (BP=1.000, ratio=1.023, hyp_len=13120, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 3.71 @ validation 1
--> Best BLEU so far: 6.90 @ validation 1
Starting Epoch 2
Epoch 2 - update        480 => loss:   4.489 (#OOM: 0)
Epoch 2 - update        510 => loss:   4.216 (#OOM: 0)
Epoch 2 - update        540 => loss:   3.876 (#OOM: 0)
Epoch 2 - update        570 => loss:   3.795 (#OOM: 0)
Epoch 2 - update        600 => loss:   4.442 (#OOM: 0)
Epoch 2 - update        630 => loss:   3.621 (#OOM: 0)
Epoch 2 - update        660 => loss:   4.015 (#OOM: 0)
Epoch 2 - update        690 => loss:   3.770 (#OOM: 0)
Epoch 2 - update        720 => loss:   4.261 (#OOM: 0)
Epoch 2 - update        750 => loss:   3.900 (#OOM: 0)
Epoch 2 - update        780 => loss:   3.820 (#OOM: 0)
Epoch 2 - update        810 => loss:   3.686 (#OOM: 0)
Epoch 2 - update        840 => loss:   3.579 (#OOM: 0)
Epoch 2 - update        870 => loss:   3.517 (#OOM: 0)
Epoch 2 - update        900 => loss:   3.310 (#OOM: 0)
Epoch 2 - update        930 => loss:   3.421 (#OOM: 0)
--> Epoch 2 finished with mean loss 3.82852
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.56 mins)   (915 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.37batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.24batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 57.12batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 55.11batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 56.49batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.54batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.62batch/s]  2%|▌                           | 20/1014 [00:00<00:10, 96.92batch/s]  3%|▊                           | 31/1014 [00:00<00:10, 90.42batch/s]  4%|█▏                          | 42/1014 [00:00<00:10, 94.21batch/s]  5%|█▍                          | 53/1014 [00:00<00:10, 93.38batch/s]  6%|█▊                          | 64/1014 [00:00<00:10, 93.74batch/s]  7%|██                          | 75/1014 [00:00<00:10, 92.03batch/s]  8%|██▎                         | 86/1014 [00:00<00:10, 92.73batch/s] 10%|██▋                         | 97/1014 [00:01<00:09, 93.20batch/s] 11%|██▉                        | 108/1014 [00:01<00:09, 93.17batch/s] 12%|███▏                       | 119/1014 [00:01<00:09, 93.27batch/s] 13%|███▍                       | 130/1014 [00:01<00:09, 93.66batch/s] 14%|███▊                       | 141/1014 [00:01<00:09, 94.07batch/s] 15%|████                       | 152/1014 [00:01<00:09, 94.49batch/s] 16%|████▎                      | 164/1014 [00:01<00:08, 95.68batch/s] 17%|████▋                      | 176/1014 [00:01<00:08, 95.49batch/s] 19%|█████                      | 188/1014 [00:01<00:08, 96.18batch/s] 20%|█████▎                     | 200/1014 [00:02<00:08, 96.87batch/s] 21%|█████▋                     | 212/1014 [00:02<00:08, 96.68batch/s] 22%|█████▉                     | 224/1014 [00:02<00:08, 96.67batch/s] 23%|██████▎                    | 236/1014 [00:02<00:08, 96.18batch/s] 24%|██████▌                    | 248/1014 [00:02<00:07, 96.24batch/s] 26%|██████▉                    | 260/1014 [00:02<00:08, 93.74batch/s] 27%|███████▏                   | 272/1014 [00:02<00:08, 91.44batch/s] 28%|███████▌                   | 284/1014 [00:03<00:08, 91.22batch/s] 29%|███████▉                   | 296/1014 [00:03<00:07, 91.16batch/s] 30%|████████▏                  | 308/1014 [00:03<00:07, 91.40batch/s] 32%|████████▌                  | 320/1014 [00:03<00:07, 91.19batch/s] 33%|████████▊                  | 332/1014 [00:03<00:07, 91.21batch/s] 34%|█████████▏                 | 344/1014 [00:03<00:07, 91.15batch/s] 35%|█████████▍                 | 356/1014 [00:03<00:07, 91.44batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 91.58batch/s] 37%|██████████                 | 380/1014 [00:04<00:06, 91.67batch/s] 39%|██████████▍                | 392/1014 [00:04<00:06, 91.95batch/s] 40%|██████████▊                | 404/1014 [00:04<00:06, 92.32batch/s] 41%|███████████                | 416/1014 [00:04<00:06, 92.56batch/s] 42%|███████████▍               | 428/1014 [00:04<00:06, 92.12batch/s] 43%|███████████▋               | 440/1014 [00:04<00:06, 92.23batch/s] 45%|████████████               | 452/1014 [00:04<00:06, 92.25batch/s] 46%|████████████▎              | 464/1014 [00:05<00:05, 92.28batch/s] 47%|████████████▋              | 476/1014 [00:05<00:05, 90.82batch/s] 48%|████████████▉              | 488/1014 [00:05<00:05, 90.92batch/s] 49%|█████████████▎             | 500/1014 [00:05<00:05, 91.04batch/s] 50%|█████████████▋             | 512/1014 [00:05<00:05, 91.11batch/s] 52%|█████████████▉             | 524/1014 [00:05<00:05, 91.38batch/s] 53%|██████████████▎            | 536/1014 [00:05<00:05, 91.37batch/s] 54%|██████████████▌            | 548/1014 [00:05<00:05, 91.61batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:04, 91.93batch/s] 56%|███████████████▏           | 572/1014 [00:06<00:04, 92.27batch/s] 58%|███████████████▌           | 584/1014 [00:06<00:04, 92.08batch/s] 59%|███████████████▊           | 596/1014 [00:06<00:04, 92.17batch/s] 60%|████████████████▏          | 608/1014 [00:06<00:04, 92.18batch/s] 61%|████████████████▌          | 620/1014 [00:06<00:04, 91.88batch/s] 62%|████████████████▊          | 632/1014 [00:06<00:04, 91.10batch/s] 64%|█████████████████▏         | 644/1014 [00:07<00:04, 91.30batch/s] 65%|█████████████████▍         | 656/1014 [00:07<00:03, 91.46batch/s] 66%|█████████████████▊         | 668/1014 [00:07<00:03, 90.80batch/s] 67%|██████████████████         | 680/1014 [00:07<00:03, 91.07batch/s] 68%|██████████████████▍        | 692/1014 [00:07<00:03, 91.22batch/s] 69%|██████████████████▋        | 704/1014 [00:07<00:03, 91.35batch/s] 71%|███████████████████        | 716/1014 [00:07<00:03, 91.32batch/s] 72%|███████████████████▍       | 728/1014 [00:07<00:03, 91.51batch/s] 73%|███████████████████▋       | 740/1014 [00:08<00:02, 91.52batch/s] 74%|████████████████████       | 752/1014 [00:08<00:02, 91.66batch/s] 75%|████████████████████▎      | 764/1014 [00:08<00:02, 91.53batch/s] 77%|████████████████████▋      | 776/1014 [00:08<00:02, 91.52batch/s] 78%|████████████████████▉      | 788/1014 [00:08<00:02, 91.63batch/s] 79%|█████████████████████▎     | 800/1014 [00:08<00:02, 91.66batch/s] 80%|█████████████████████▌     | 812/1014 [00:08<00:02, 91.70batch/s] 81%|█████████████████████▉     | 824/1014 [00:08<00:02, 91.95batch/s] 82%|██████████████████████▎    | 836/1014 [00:09<00:01, 92.00batch/s] 84%|██████████████████████▌    | 848/1014 [00:09<00:01, 92.17batch/s] 85%|██████████████████████▉    | 860/1014 [00:09<00:01, 92.05batch/s] 86%|███████████████████████▏   | 872/1014 [00:09<00:01, 92.23batch/s] 87%|███████████████████████▌   | 884/1014 [00:09<00:01, 92.25batch/s] 88%|███████████████████████▊   | 896/1014 [00:09<00:01, 91.64batch/s] 90%|████████████████████████▏  | 908/1014 [00:09<00:01, 91.65batch/s] 91%|████████████████████████▍  | 920/1014 [00:10<00:01, 91.68batch/s] 92%|████████████████████████▊  | 932/1014 [00:10<00:00, 91.68batch/s] 93%|█████████████████████████▏ | 944/1014 [00:10<00:00, 91.37batch/s] 94%|█████████████████████████▍ | 956/1014 [00:10<00:00, 91.15batch/s] 95%|█████████████████████████▊ | 968/1014 [00:10<00:00, 91.28batch/s] 97%|██████████████████████████ | 980/1014 [00:10<00:00, 91.43batch/s] 98%|██████████████████████████▍| 992/1014 [00:10<00:00, 91.39batch/s] 99%|█████████████████████████▋| 1004/1014 [00:10<00:00, 91.50batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 91.53batch/s]
Validation 2 -> LOSS = 3.22
Validation 2 -> BLEU = 9.55, 41.9/15.5/7.5/3.5 (BP=0.836, ratio=0.848, hyp_len=10882, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 3.22 @ validation 2
--> Best BLEU so far: 9.55 @ validation 2
Starting Epoch 3
Epoch 3 - update        960 => loss:   3.547 (#OOM: 0)
Epoch 3 - update        990 => loss:   3.566 (#OOM: 0)
Epoch 3 - update       1020 => loss:   3.408 (#OOM: 0)
Epoch 3 - update       1050 => loss:   3.729 (#OOM: 0)
Epoch 3 - update       1080 => loss:   3.138 (#OOM: 0)
Epoch 3 - update       1110 => loss:   3.408 (#OOM: 0)
Epoch 3 - update       1140 => loss:   3.281 (#OOM: 0)
Epoch 3 - update       1170 => loss:   3.436 (#OOM: 0)
Epoch 3 - update       1200 => loss:   3.046 (#OOM: 0)
Epoch 3 - update       1230 => loss:   4.014 (#OOM: 0)
Epoch 3 - update       1260 => loss:   3.191 (#OOM: 0)
Epoch 3 - update       1290 => loss:   3.900 (#OOM: 0)
Epoch 3 - update       1320 => loss:   3.355 (#OOM: 0)
Epoch 3 - update       1350 => loss:   3.461 (#OOM: 0)
Epoch 3 - update       1380 => loss:   2.667 (#OOM: 0)
Epoch 3 - update       1410 => loss:   2.970 (#OOM: 0)
--> Epoch 3 finished with mean loss 3.44476
--> Overhead/Training/Evaluation: 0.03/0.52/0.00 mins (total: 0.55 mins)   (928 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.66batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.72batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.35batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.87batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 54.86batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.91batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 11/1014 [00:00<00:10, 99.09batch/s]  2%|▌                           | 22/1014 [00:00<00:10, 93.44batch/s]  3%|▉                           | 33/1014 [00:00<00:10, 94.41batch/s]  4%|█▏                          | 44/1014 [00:00<00:10, 94.07batch/s]  5%|█▌                          | 55/1014 [00:00<00:10, 93.44batch/s]  7%|█▊                          | 66/1014 [00:00<00:10, 93.99batch/s]  8%|██▏                         | 77/1014 [00:00<00:10, 91.09batch/s]  9%|██▍                         | 88/1014 [00:00<00:10, 91.86batch/s] 10%|██▋                         | 99/1014 [00:01<00:09, 92.83batch/s] 11%|██▉                        | 110/1014 [00:01<00:09, 93.21batch/s] 12%|███▏                       | 121/1014 [00:01<00:09, 92.69batch/s] 13%|███▌                       | 132/1014 [00:01<00:09, 92.71batch/s] 14%|███▊                       | 143/1014 [00:01<00:09, 93.83batch/s] 15%|████                       | 154/1014 [00:01<00:09, 93.32batch/s] 16%|████▍                      | 165/1014 [00:01<00:09, 94.07batch/s] 17%|████▋                      | 176/1014 [00:01<00:08, 94.84batch/s] 18%|████▉                      | 187/1014 [00:01<00:08, 94.91batch/s] 20%|█████▎                     | 198/1014 [00:02<00:08, 94.25batch/s] 21%|█████▌                     | 209/1014 [00:02<00:08, 93.80batch/s] 22%|█████▊                     | 220/1014 [00:02<00:08, 93.73batch/s] 23%|██████▏                    | 231/1014 [00:02<00:08, 93.54batch/s] 24%|██████▍                    | 242/1014 [00:02<00:08, 93.19batch/s] 25%|██████▋                    | 253/1014 [00:02<00:08, 93.27batch/s] 26%|███████                    | 264/1014 [00:02<00:08, 93.23batch/s] 27%|███████▎                   | 275/1014 [00:02<00:07, 92.67batch/s] 28%|███████▌                   | 286/1014 [00:03<00:07, 92.58batch/s] 29%|███████▉                   | 297/1014 [00:03<00:07, 92.01batch/s] 30%|████████▏                  | 308/1014 [00:03<00:07, 92.30batch/s] 31%|████████▍                  | 319/1014 [00:03<00:07, 92.09batch/s] 33%|████████▊                  | 330/1014 [00:03<00:07, 91.87batch/s] 34%|█████████                  | 341/1014 [00:03<00:07, 90.79batch/s] 35%|█████████▎                 | 352/1014 [00:03<00:07, 90.82batch/s] 36%|█████████▋                 | 363/1014 [00:03<00:07, 90.81batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 90.74batch/s] 38%|██████████▎                | 385/1014 [00:04<00:06, 90.41batch/s] 39%|██████████▌                | 396/1014 [00:04<00:06, 90.57batch/s] 40%|██████████▊                | 407/1014 [00:04<00:06, 90.62batch/s] 41%|███████████▏               | 418/1014 [00:04<00:06, 90.60batch/s] 42%|███████████▍               | 429/1014 [00:04<00:06, 90.67batch/s] 43%|███████████▋               | 440/1014 [00:04<00:06, 90.55batch/s] 44%|████████████               | 451/1014 [00:04<00:06, 90.67batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 90.67batch/s] 47%|████████████▌              | 473/1014 [00:05<00:05, 90.49batch/s] 48%|████████████▉              | 484/1014 [00:05<00:05, 90.74batch/s] 49%|█████████████▏             | 495/1014 [00:05<00:05, 90.58batch/s] 50%|█████████████▍             | 506/1014 [00:05<00:05, 90.76batch/s] 51%|█████████████▊             | 517/1014 [00:05<00:05, 90.64batch/s] 52%|██████████████             | 528/1014 [00:05<00:05, 90.55batch/s] 53%|██████████████▎            | 539/1014 [00:05<00:05, 90.69batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 90.67batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:05, 90.52batch/s] 56%|███████████████▏           | 572/1014 [00:06<00:04, 90.49batch/s] 57%|███████████████▌           | 583/1014 [00:06<00:04, 90.30batch/s] 59%|███████████████▊           | 594/1014 [00:06<00:04, 90.42batch/s] 60%|████████████████           | 605/1014 [00:06<00:04, 90.54batch/s] 61%|████████████████▍          | 616/1014 [00:06<00:04, 90.19batch/s] 62%|████████████████▋          | 627/1014 [00:06<00:04, 90.26batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 90.08batch/s] 64%|█████████████████▎         | 649/1014 [00:07<00:04, 90.02batch/s] 65%|█████████████████▌         | 660/1014 [00:07<00:03, 90.07batch/s] 66%|█████████████████▊         | 671/1014 [00:07<00:03, 90.01batch/s] 67%|██████████████████▏        | 682/1014 [00:07<00:03, 89.82batch/s] 68%|██████████████████▍        | 693/1014 [00:07<00:03, 89.79batch/s] 69%|██████████████████▋        | 704/1014 [00:07<00:03, 89.84batch/s] 71%|███████████████████        | 715/1014 [00:07<00:03, 89.81batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 89.74batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 89.65batch/s] 74%|███████████████████▉       | 748/1014 [00:08<00:02, 89.68batch/s] 75%|████████████████████▏      | 759/1014 [00:08<00:02, 89.47batch/s] 76%|████████████████████▌      | 770/1014 [00:08<00:02, 89.46batch/s] 77%|████████████████████▊      | 781/1014 [00:08<00:02, 89.51batch/s] 78%|█████████████████████      | 792/1014 [00:08<00:02, 89.51batch/s] 79%|█████████████████████▍     | 803/1014 [00:08<00:02, 89.65batch/s] 80%|█████████████████████▋     | 814/1014 [00:09<00:02, 89.74batch/s] 81%|█████████████████████▉     | 825/1014 [00:09<00:02, 89.73batch/s] 82%|██████████████████████▎    | 836/1014 [00:09<00:01, 89.73batch/s] 84%|██████████████████████▌    | 847/1014 [00:09<00:01, 89.45batch/s] 85%|██████████████████████▊    | 858/1014 [00:09<00:01, 89.46batch/s] 86%|███████████████████████▏   | 869/1014 [00:09<00:01, 89.55batch/s] 87%|███████████████████████▍   | 880/1014 [00:09<00:01, 89.58batch/s] 88%|███████████████████████▋   | 891/1014 [00:09<00:01, 89.57batch/s] 89%|████████████████████████   | 902/1014 [00:10<00:01, 89.56batch/s] 90%|████████████████████████▎  | 913/1014 [00:10<00:01, 89.59batch/s] 91%|████████████████████████▌  | 924/1014 [00:10<00:01, 89.57batch/s] 92%|████████████████████████▉  | 935/1014 [00:10<00:00, 89.63batch/s] 93%|█████████████████████████▏ | 946/1014 [00:10<00:00, 89.59batch/s] 94%|█████████████████████████▍ | 957/1014 [00:10<00:00, 89.64batch/s] 95%|█████████████████████████▊ | 968/1014 [00:10<00:00, 89.66batch/s] 97%|██████████████████████████ | 979/1014 [00:10<00:00, 89.81batch/s] 98%|██████████████████████████▎| 990/1014 [00:11<00:00, 89.88batch/s] 99%|█████████████████████████▋| 1001/1014 [00:11<00:00, 89.72batch/s]100%|█████████████████████████▉| 1012/1014 [00:11<00:00, 89.77batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 89.76batch/s]
Validation 3 -> LOSS = 2.94
Validation 3 -> BLEU = 11.52, 45.9/18.2/9.2/4.5 (BP=0.842, ratio=0.853, hyp_len=10942, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.94 @ validation 3
--> Best BLEU so far: 11.52 @ validation 3
Starting Epoch 4
Epoch 4 - update       1440 => loss:   2.516 (#OOM: 0)
Epoch 4 - update       1470 => loss:   2.933 (#OOM: 0)
Epoch 4 - update       1500 => loss:   3.297 (#OOM: 0)
Epoch 4 - update       1530 => loss:   2.902 (#OOM: 0)
Epoch 4 - update       1560 => loss:   3.371 (#OOM: 0)
Epoch 4 - update       1590 => loss:   3.102 (#OOM: 0)
Epoch 4 - update       1620 => loss:   3.119 (#OOM: 0)
Epoch 4 - update       1650 => loss:   2.983 (#OOM: 0)
Epoch 4 - update       1680 => loss:   2.796 (#OOM: 0)
Epoch 4 - update       1710 => loss:   3.202 (#OOM: 0)
Epoch 4 - update       1740 => loss:   2.708 (#OOM: 0)
Epoch 4 - update       1770 => loss:   3.468 (#OOM: 0)
Epoch 4 - update       1800 => loss:   2.982 (#OOM: 0)
Epoch 4 - update       1830 => loss:   3.553 (#OOM: 0)
Epoch 4 - update       1860 => loss:   3.074 (#OOM: 0)
Epoch 4 - update       1890 => loss:   3.031 (#OOM: 0)
--> Epoch 4 finished with mean loss 3.19738
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.58 mins)   (888 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.80batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 57.56batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.59batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.33batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.06batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.02batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 88.14batch/s]  2%|▌                          | 21/1014 [00:00<00:09, 101.07batch/s]  3%|▉                           | 33/1014 [00:00<00:10, 95.15batch/s]  4%|█▏                          | 45/1014 [00:00<00:10, 96.79batch/s]  6%|█▌                          | 57/1014 [00:00<00:10, 95.70batch/s]  7%|█▉                          | 69/1014 [00:00<00:09, 95.31batch/s]  8%|██▏                         | 81/1014 [00:00<00:09, 94.67batch/s]  9%|██▌                         | 93/1014 [00:00<00:09, 94.13batch/s] 10%|██▊                        | 105/1014 [00:01<00:09, 91.86batch/s] 12%|███                        | 117/1014 [00:01<00:09, 91.94batch/s] 13%|███▍                       | 129/1014 [00:01<00:09, 92.21batch/s] 14%|███▊                       | 141/1014 [00:01<00:09, 91.79batch/s] 15%|████                       | 153/1014 [00:01<00:09, 91.63batch/s] 16%|████▍                      | 165/1014 [00:01<00:09, 92.04batch/s] 17%|████▋                      | 177/1014 [00:01<00:08, 93.05batch/s] 19%|█████                      | 189/1014 [00:02<00:08, 93.05batch/s] 20%|█████▎                     | 201/1014 [00:02<00:08, 92.57batch/s] 21%|█████▋                     | 213/1014 [00:02<00:08, 92.23batch/s] 22%|█████▉                     | 225/1014 [00:02<00:08, 92.25batch/s] 23%|██████▎                    | 237/1014 [00:02<00:08, 92.58batch/s] 25%|██████▋                    | 249/1014 [00:02<00:08, 92.82batch/s] 26%|██████▉                    | 261/1014 [00:02<00:08, 92.62batch/s] 27%|███████▎                   | 273/1014 [00:02<00:08, 92.22batch/s] 28%|███████▌                   | 285/1014 [00:03<00:07, 91.94batch/s] 29%|███████▉                   | 297/1014 [00:03<00:07, 92.30batch/s] 30%|████████▏                  | 309/1014 [00:03<00:07, 91.95batch/s] 32%|████████▌                  | 321/1014 [00:03<00:07, 91.74batch/s] 33%|████████▊                  | 333/1014 [00:03<00:07, 91.57batch/s] 34%|█████████▏                 | 345/1014 [00:03<00:07, 91.54batch/s] 35%|█████████▌                 | 357/1014 [00:03<00:07, 91.61batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:07, 92.04batch/s] 38%|██████████▏                | 381/1014 [00:04<00:06, 91.85batch/s] 39%|██████████▍                | 393/1014 [00:04<00:06, 91.68batch/s] 40%|██████████▊                | 405/1014 [00:04<00:06, 91.54batch/s] 41%|███████████                | 417/1014 [00:04<00:06, 91.24batch/s] 42%|███████████▍               | 429/1014 [00:04<00:06, 91.21batch/s] 43%|███████████▋               | 441/1014 [00:04<00:06, 91.48batch/s] 45%|████████████               | 453/1014 [00:04<00:06, 91.54batch/s] 46%|████████████▍              | 465/1014 [00:05<00:05, 91.76batch/s] 47%|████████████▋              | 477/1014 [00:05<00:05, 91.68batch/s] 48%|█████████████              | 489/1014 [00:05<00:05, 91.69batch/s] 49%|█████████████▎             | 501/1014 [00:05<00:05, 91.92batch/s] 51%|█████████████▋             | 513/1014 [00:05<00:05, 92.15batch/s] 52%|█████████████▉             | 525/1014 [00:05<00:05, 92.13batch/s] 53%|██████████████▎            | 537/1014 [00:05<00:05, 91.88batch/s] 54%|██████████████▌            | 549/1014 [00:05<00:05, 91.81batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:04, 91.80batch/s] 57%|███████████████▎           | 573/1014 [00:06<00:04, 91.59batch/s] 58%|███████████████▌           | 585/1014 [00:06<00:04, 91.39batch/s] 59%|███████████████▉           | 597/1014 [00:06<00:04, 90.42batch/s] 60%|████████████████▏          | 609/1014 [00:06<00:04, 90.48batch/s] 61%|████████████████▌          | 621/1014 [00:06<00:04, 90.64batch/s] 62%|████████████████▊          | 633/1014 [00:06<00:04, 90.64batch/s] 64%|█████████████████▏         | 645/1014 [00:07<00:04, 90.56batch/s] 65%|█████████████████▍         | 657/1014 [00:07<00:03, 90.37batch/s] 66%|█████████████████▊         | 669/1014 [00:07<00:03, 90.44batch/s] 67%|██████████████████▏        | 681/1014 [00:07<00:03, 90.34batch/s] 68%|██████████████████▍        | 693/1014 [00:07<00:03, 90.51batch/s] 70%|██████████████████▊        | 705/1014 [00:07<00:03, 90.29batch/s] 71%|███████████████████        | 717/1014 [00:07<00:03, 90.34batch/s] 72%|███████████████████▍       | 729/1014 [00:08<00:03, 90.49batch/s] 73%|███████████████████▋       | 741/1014 [00:08<00:03, 90.03batch/s] 74%|████████████████████       | 753/1014 [00:08<00:02, 89.91batch/s] 75%|████████████████████▎      | 765/1014 [00:08<00:02, 89.98batch/s] 77%|████████████████████▋      | 777/1014 [00:08<00:02, 89.96batch/s] 78%|█████████████████████      | 789/1014 [00:08<00:02, 90.19batch/s] 79%|█████████████████████▎     | 801/1014 [00:08<00:02, 90.28batch/s] 80%|█████████████████████▋     | 813/1014 [00:09<00:02, 90.25batch/s] 81%|█████████████████████▉     | 825/1014 [00:09<00:02, 90.14batch/s] 83%|██████████████████████▎    | 837/1014 [00:09<00:01, 90.07batch/s] 84%|██████████████████████▌    | 849/1014 [00:09<00:01, 90.21batch/s] 85%|██████████████████████▉    | 861/1014 [00:09<00:01, 90.27batch/s] 86%|███████████████████████▏   | 873/1014 [00:09<00:01, 90.13batch/s] 87%|███████████████████████▌   | 885/1014 [00:09<00:01, 90.11batch/s] 88%|███████████████████████▉   | 897/1014 [00:09<00:01, 90.12batch/s] 90%|████████████████████████▏  | 909/1014 [00:10<00:01, 90.17batch/s] 91%|████████████████████████▌  | 921/1014 [00:10<00:01, 90.29batch/s] 92%|████████████████████████▊  | 933/1014 [00:10<00:00, 90.44batch/s] 93%|█████████████████████████▏ | 945/1014 [00:10<00:00, 90.64batch/s] 94%|█████████████████████████▍ | 957/1014 [00:10<00:00, 90.52batch/s] 96%|█████████████████████████▊ | 969/1014 [00:10<00:00, 90.48batch/s] 97%|██████████████████████████ | 981/1014 [00:10<00:00, 90.54batch/s] 98%|██████████████████████████▍| 993/1014 [00:10<00:00, 90.65batch/s] 99%|█████████████████████████▊| 1005/1014 [00:11<00:00, 90.75batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 90.74batch/s]
Validation 4 -> LOSS = 2.80
Validation 4 -> BLEU = 12.33, 46.3/19.1/9.8/5.1 (BP=0.849, ratio=0.860, hyp_len=11026, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.80 @ validation 4
--> Best BLEU so far: 12.33 @ validation 4
Starting Epoch 5
Epoch 5 - update       1920 => loss:   3.550 (#OOM: 0)
Epoch 5 - update       1950 => loss:   2.733 (#OOM: 0)
Epoch 5 - update       1980 => loss:   2.642 (#OOM: 0)
Epoch 5 - update       2010 => loss:   2.838 (#OOM: 0)
Epoch 5 - update       2040 => loss:   3.122 (#OOM: 0)
Epoch 5 - update       2070 => loss:   2.907 (#OOM: 0)
Epoch 5 - update       2100 => loss:   2.559 (#OOM: 0)
Epoch 5 - update       2130 => loss:   3.183 (#OOM: 0)
Epoch 5 - update       2160 => loss:   2.947 (#OOM: 0)
Epoch 5 - update       2190 => loss:   2.609 (#OOM: 0)
Epoch 5 - update       2220 => loss:   2.476 (#OOM: 0)
Epoch 5 - update       2250 => loss:   2.635 (#OOM: 0)
Epoch 5 - update       2280 => loss:   3.334 (#OOM: 0)
Epoch 5 - update       2310 => loss:   2.641 (#OOM: 0)
Epoch 5 - update       2340 => loss:   2.757 (#OOM: 0)
Epoch 5 - update       2370 => loss:   2.814 (#OOM: 0)
--> Epoch 5 finished with mean loss 3.01657
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (832 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.83batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.40batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 47.43batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.73batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 55.23batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.65batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 95.48batch/s]  2%|▌                           | 20/1014 [00:00<00:11, 90.04batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 89.07batch/s]  4%|█                           | 40/1014 [00:00<00:11, 86.61batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 87.34batch/s]  6%|█▋                          | 60/1014 [00:00<00:10, 88.08batch/s]  7%|█▉                          | 70/1014 [00:00<00:10, 87.99batch/s]  8%|██▏                         | 80/1014 [00:00<00:10, 88.16batch/s]  9%|██▍                         | 90/1014 [00:01<00:10, 87.81batch/s] 10%|██▋                        | 100/1014 [00:01<00:10, 88.24batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 88.61batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 88.84batch/s] 13%|███▍                       | 130/1014 [00:01<00:09, 88.91batch/s] 14%|███▋                       | 140/1014 [00:01<00:09, 88.88batch/s] 15%|███▉                       | 150/1014 [00:01<00:09, 89.03batch/s] 16%|████▎                      | 160/1014 [00:01<00:09, 89.04batch/s] 17%|████▌                      | 170/1014 [00:01<00:09, 89.44batch/s] 18%|████▊                      | 181/1014 [00:02<00:09, 90.02batch/s] 19%|█████                      | 192/1014 [00:02<00:09, 90.39batch/s] 20%|█████▍                     | 203/1014 [00:02<00:08, 90.59batch/s] 21%|█████▋                     | 214/1014 [00:02<00:08, 90.49batch/s] 22%|█████▉                     | 225/1014 [00:02<00:08, 90.25batch/s] 23%|██████▎                    | 237/1014 [00:02<00:08, 90.99batch/s] 25%|██████▋                    | 249/1014 [00:02<00:08, 91.10batch/s] 26%|██████▉                    | 261/1014 [00:02<00:08, 90.94batch/s] 27%|███████▎                   | 273/1014 [00:02<00:08, 91.09batch/s] 28%|███████▌                   | 285/1014 [00:03<00:08, 91.09batch/s] 29%|███████▉                   | 297/1014 [00:03<00:07, 91.41batch/s] 30%|████████▏                  | 309/1014 [00:03<00:07, 91.70batch/s] 32%|████████▌                  | 321/1014 [00:03<00:07, 91.77batch/s] 33%|████████▊                  | 333/1014 [00:03<00:07, 91.89batch/s] 34%|█████████▏                 | 345/1014 [00:03<00:07, 92.09batch/s] 35%|█████████▌                 | 357/1014 [00:03<00:07, 92.26batch/s] 36%|█████████▊                 | 369/1014 [00:03<00:06, 92.60batch/s] 38%|██████████▏                | 381/1014 [00:04<00:06, 92.67batch/s] 39%|██████████▍                | 393/1014 [00:04<00:06, 92.50batch/s] 40%|██████████▊                | 405/1014 [00:04<00:06, 92.68batch/s] 41%|███████████                | 417/1014 [00:04<00:06, 92.55batch/s] 42%|███████████▍               | 429/1014 [00:04<00:06, 92.63batch/s] 43%|███████████▋               | 441/1014 [00:04<00:06, 92.58batch/s] 45%|████████████               | 453/1014 [00:04<00:06, 92.61batch/s] 46%|████████████▍              | 465/1014 [00:05<00:05, 92.67batch/s] 47%|████████████▋              | 477/1014 [00:05<00:05, 92.27batch/s] 48%|█████████████              | 489/1014 [00:05<00:05, 92.42batch/s] 49%|█████████████▎             | 501/1014 [00:05<00:05, 92.52batch/s] 51%|█████████████▋             | 513/1014 [00:05<00:05, 92.47batch/s] 52%|█████████████▉             | 525/1014 [00:05<00:05, 92.44batch/s] 53%|██████████████▎            | 537/1014 [00:05<00:05, 92.16batch/s] 54%|██████████████▌            | 549/1014 [00:05<00:05, 92.01batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:04, 91.98batch/s] 57%|███████████████▎           | 573/1014 [00:06<00:04, 92.08batch/s] 58%|███████████████▌           | 585/1014 [00:06<00:04, 92.23batch/s] 59%|███████████████▉           | 597/1014 [00:06<00:04, 92.31batch/s] 60%|████████████████▏          | 609/1014 [00:06<00:04, 92.20batch/s] 61%|████████████████▌          | 621/1014 [00:06<00:04, 92.12batch/s] 62%|████████████████▊          | 633/1014 [00:06<00:04, 92.09batch/s] 64%|█████████████████▏         | 645/1014 [00:06<00:04, 92.22batch/s] 65%|█████████████████▍         | 657/1014 [00:07<00:03, 92.29batch/s] 66%|█████████████████▊         | 669/1014 [00:07<00:03, 92.27batch/s] 67%|██████████████████▏        | 681/1014 [00:07<00:03, 92.17batch/s] 68%|██████████████████▍        | 693/1014 [00:07<00:03, 92.11batch/s] 70%|██████████████████▊        | 705/1014 [00:07<00:03, 92.07batch/s] 71%|███████████████████        | 717/1014 [00:07<00:03, 92.01batch/s] 72%|███████████████████▍       | 729/1014 [00:07<00:03, 92.09batch/s] 73%|███████████████████▋       | 741/1014 [00:08<00:02, 92.18batch/s] 74%|████████████████████       | 753/1014 [00:08<00:02, 92.09batch/s] 75%|████████████████████▎      | 765/1014 [00:08<00:02, 92.18batch/s] 77%|████████████████████▋      | 777/1014 [00:08<00:02, 92.14batch/s] 78%|█████████████████████      | 789/1014 [00:08<00:02, 92.13batch/s] 79%|█████████████████████▎     | 801/1014 [00:08<00:02, 92.15batch/s] 80%|█████████████████████▋     | 813/1014 [00:08<00:02, 92.11batch/s] 81%|█████████████████████▉     | 825/1014 [00:08<00:02, 92.18batch/s] 83%|██████████████████████▎    | 837/1014 [00:09<00:01, 92.14batch/s] 84%|██████████████████████▌    | 849/1014 [00:09<00:01, 92.17batch/s] 85%|██████████████████████▉    | 861/1014 [00:09<00:01, 92.13batch/s] 86%|███████████████████████▏   | 873/1014 [00:09<00:01, 92.19batch/s] 87%|███████████████████████▌   | 885/1014 [00:09<00:01, 92.11batch/s] 88%|███████████████████████▉   | 897/1014 [00:09<00:01, 92.08batch/s] 90%|████████████████████████▏  | 909/1014 [00:09<00:01, 92.07batch/s] 91%|████████████████████████▌  | 921/1014 [00:10<00:01, 92.06batch/s] 92%|████████████████████████▊  | 933/1014 [00:10<00:00, 91.95batch/s] 93%|█████████████████████████▏ | 945/1014 [00:10<00:00, 91.92batch/s] 94%|█████████████████████████▍ | 957/1014 [00:10<00:00, 91.86batch/s] 96%|█████████████████████████▊ | 969/1014 [00:10<00:00, 91.81batch/s] 97%|██████████████████████████ | 981/1014 [00:10<00:00, 91.80batch/s] 98%|██████████████████████████▍| 993/1014 [00:10<00:00, 91.88batch/s] 99%|█████████████████████████▊| 1005/1014 [00:10<00:00, 91.83batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 91.83batch/s]
Validation 5 -> LOSS = 2.67
Validation 5 -> BLEU = 13.86, 49.3/21.6/11.8/6.5 (BP=0.821, ratio=0.836, hyp_len=10720, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.67 @ validation 5
--> Best BLEU so far: 13.86 @ validation 5
Starting Epoch 6
Epoch 6 - update       2400 => loss:   3.538 (#OOM: 0)
Epoch 6 - update       2430 => loss:   3.263 (#OOM: 0)
Epoch 6 - update       2460 => loss:   2.894 (#OOM: 0)
Epoch 6 - update       2490 => loss:   2.860 (#OOM: 0)
Epoch 6 - update       2520 => loss:   3.144 (#OOM: 0)
Epoch 6 - update       2550 => loss:   2.628 (#OOM: 0)
Epoch 6 - update       2580 => loss:   2.838 (#OOM: 0)
Epoch 6 - update       2610 => loss:   3.180 (#OOM: 0)
Epoch 6 - update       2640 => loss:   2.921 (#OOM: 0)
Epoch 6 - update       2670 => loss:   2.268 (#OOM: 0)
Epoch 6 - update       2700 => loss:   4.029 (#OOM: 0)
Epoch 6 - update       2730 => loss:   2.709 (#OOM: 0)
Epoch 6 - update       2760 => loss:   3.625 (#OOM: 0)
Epoch 6 - update       2790 => loss:   2.961 (#OOM: 0)
Epoch 6 - update       2820 => loss:   3.246 (#OOM: 0)
Epoch 6 - update       2850 => loss:   2.543 (#OOM: 0)
--> Epoch 6 finished with mean loss 2.87773
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.61 mins)   (840 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.27batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.48batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.05batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.23batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 53.55batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.42batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 87.46batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 78.39batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.36batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.26batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 83.56batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 82.61batch/s]  6%|█▊                          | 64/1014 [00:00<00:11, 83.78batch/s]  7%|██                          | 74/1014 [00:00<00:11, 83.94batch/s]  8%|██▎                         | 84/1014 [00:01<00:11, 82.74batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 83.23batch/s] 10%|██▊                        | 104/1014 [00:01<00:10, 82.96batch/s] 11%|███                        | 114/1014 [00:01<00:10, 82.84batch/s] 12%|███▎                       | 124/1014 [00:01<00:10, 81.61batch/s] 13%|███▌                       | 134/1014 [00:01<00:10, 82.43batch/s] 14%|███▊                       | 144/1014 [00:01<00:10, 83.13batch/s] 15%|████                       | 154/1014 [00:01<00:10, 82.64batch/s] 16%|████▎                      | 164/1014 [00:01<00:10, 82.29batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 82.80batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 82.79batch/s] 19%|█████▏                     | 194/1014 [00:02<00:09, 82.99batch/s] 20%|█████▍                     | 204/1014 [00:02<00:09, 82.64batch/s] 21%|█████▋                     | 214/1014 [00:02<00:09, 82.38batch/s] 22%|█████▉                     | 224/1014 [00:02<00:09, 82.14batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 82.39batch/s] 24%|██████▍                    | 244/1014 [00:02<00:09, 82.80batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 82.56batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 83.03batch/s] 27%|███████▎                   | 274/1014 [00:03<00:08, 83.30batch/s] 28%|███████▌                   | 284/1014 [00:03<00:08, 83.44batch/s] 29%|███████▊                   | 294/1014 [00:03<00:08, 83.49batch/s] 30%|████████                   | 304/1014 [00:03<00:08, 83.59batch/s] 31%|████████▎                  | 314/1014 [00:03<00:08, 83.72batch/s] 32%|████████▋                  | 324/1014 [00:03<00:08, 84.08batch/s] 33%|████████▉                  | 334/1014 [00:03<00:08, 84.13batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:07, 84.15batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:07, 84.08batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:07, 84.07batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 84.40batch/s] 38%|██████████▏                | 384/1014 [00:04<00:07, 84.54batch/s] 39%|██████████▍                | 394/1014 [00:04<00:07, 84.44batch/s] 40%|██████████▊                | 404/1014 [00:04<00:07, 84.46batch/s] 41%|███████████                | 414/1014 [00:04<00:07, 84.57batch/s] 42%|███████████▎               | 425/1014 [00:05<00:06, 84.89batch/s] 43%|███████████▌               | 436/1014 [00:05<00:06, 85.23batch/s] 44%|███████████▉               | 447/1014 [00:05<00:06, 85.40batch/s] 45%|████████████▏              | 458/1014 [00:05<00:06, 85.52batch/s] 46%|████████████▍              | 469/1014 [00:05<00:06, 85.78batch/s] 47%|████████████▊              | 480/1014 [00:05<00:06, 86.14batch/s] 48%|█████████████              | 491/1014 [00:05<00:06, 86.36batch/s] 50%|█████████████▎             | 502/1014 [00:05<00:05, 86.41batch/s] 51%|█████████████▋             | 513/1014 [00:05<00:05, 86.26batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:05, 86.23batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:05, 86.32batch/s] 54%|██████████████▌            | 546/1014 [00:06<00:05, 85.98batch/s] 55%|██████████████▊            | 557/1014 [00:06<00:05, 86.01batch/s] 56%|███████████████            | 568/1014 [00:06<00:05, 86.18batch/s] 57%|███████████████▍           | 579/1014 [00:06<00:05, 86.32batch/s] 58%|███████████████▋           | 590/1014 [00:06<00:04, 86.35batch/s] 59%|████████████████           | 601/1014 [00:06<00:04, 86.50batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:04, 86.54batch/s] 61%|████████████████▌          | 623/1014 [00:07<00:04, 86.62batch/s] 63%|████████████████▉          | 634/1014 [00:07<00:04, 86.54batch/s] 64%|█████████████████▏         | 645/1014 [00:07<00:04, 86.57batch/s] 65%|█████████████████▍         | 656/1014 [00:07<00:04, 86.59batch/s] 66%|█████████████████▊         | 667/1014 [00:07<00:04, 86.70batch/s] 67%|██████████████████         | 678/1014 [00:07<00:03, 86.58batch/s] 68%|██████████████████▎        | 689/1014 [00:07<00:03, 86.64batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 86.61batch/s] 70%|██████████████████▉        | 711/1014 [00:08<00:03, 86.69batch/s] 71%|███████████████████▏       | 722/1014 [00:08<00:03, 86.59batch/s] 72%|███████████████████▌       | 733/1014 [00:08<00:03, 86.61batch/s] 73%|███████████████████▊       | 744/1014 [00:08<00:03, 86.76batch/s] 74%|████████████████████       | 755/1014 [00:08<00:02, 86.83batch/s] 76%|████████████████████▍      | 766/1014 [00:08<00:02, 86.83batch/s] 77%|████████████████████▋      | 777/1014 [00:08<00:02, 86.90batch/s] 78%|████████████████████▉      | 788/1014 [00:09<00:02, 86.99batch/s] 79%|█████████████████████▎     | 799/1014 [00:09<00:02, 86.95batch/s] 80%|█████████████████████▌     | 810/1014 [00:09<00:02, 86.99batch/s] 81%|█████████████████████▊     | 821/1014 [00:09<00:02, 86.89batch/s] 82%|██████████████████████▏    | 832/1014 [00:09<00:02, 86.85batch/s] 83%|██████████████████████▍    | 843/1014 [00:09<00:01, 86.97batch/s] 84%|██████████████████████▋    | 854/1014 [00:09<00:01, 86.99batch/s] 85%|███████████████████████    | 865/1014 [00:09<00:01, 87.01batch/s] 86%|███████████████████████▎   | 876/1014 [00:10<00:01, 87.08batch/s] 87%|███████████████████████▌   | 887/1014 [00:10<00:01, 87.02batch/s] 89%|███████████████████████▉   | 898/1014 [00:10<00:01, 87.14batch/s] 90%|████████████████████████▏  | 909/1014 [00:10<00:01, 87.11batch/s] 91%|████████████████████████▍  | 920/1014 [00:10<00:01, 87.07batch/s] 92%|████████████████████████▊  | 931/1014 [00:10<00:00, 87.20batch/s] 93%|█████████████████████████  | 942/1014 [00:10<00:00, 87.16batch/s] 94%|█████████████████████████▍ | 953/1014 [00:10<00:00, 86.93batch/s] 95%|█████████████████████████▋ | 964/1014 [00:11<00:00, 87.09batch/s] 96%|█████████████████████████▉ | 975/1014 [00:11<00:00, 87.21batch/s] 97%|██████████████████████████▎| 986/1014 [00:11<00:00, 86.93batch/s] 98%|██████████████████████████▌| 997/1014 [00:11<00:00, 86.92batch/s] 99%|█████████████████████████▊| 1008/1014 [00:11<00:00, 86.91batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 86.99batch/s]
Validation 6 -> LOSS = 2.54
Validation 6 -> BLEU = 15.10, 48.8/22.0/12.0/6.5 (BP=0.887, ratio=0.893, hyp_len=11450, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.54 @ validation 6
--> Best BLEU so far: 15.10 @ validation 6
Starting Epoch 7
Epoch 7 - update       2880 => loss:   3.041 (#OOM: 0)
Epoch 7 - update       2910 => loss:   2.590 (#OOM: 0)
Epoch 7 - update       2940 => loss:   2.634 (#OOM: 0)
Epoch 7 - update       2970 => loss:   2.976 (#OOM: 0)
Epoch 7 - update       3000 => loss:   3.357 (#OOM: 0)
Epoch 7 - update       3030 => loss:   2.530 (#OOM: 0)
Epoch 7 - update       3060 => loss:   2.413 (#OOM: 0)
Epoch 7 - update       3090 => loss:   2.079 (#OOM: 0)
Epoch 7 - update       3120 => loss:   2.422 (#OOM: 0)
Epoch 7 - update       3150 => loss:   3.129 (#OOM: 0)
Epoch 7 - update       3180 => loss:   2.451 (#OOM: 0)
Epoch 7 - update       3210 => loss:   2.681 (#OOM: 0)
Epoch 7 - update       3240 => loss:   2.851 (#OOM: 0)
Epoch 7 - update       3270 => loss:   2.633 (#OOM: 0)
Epoch 7 - update       3300 => loss:   2.006 (#OOM: 0)
Epoch 7 - update       3330 => loss:   2.499 (#OOM: 0)
--> Epoch 7 finished with mean loss 2.76042
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (803 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.24batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.59batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.94batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 52.26batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.23batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.07batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.30batch/s]  2%|▍                           | 17/1014 [00:00<00:13, 74.01batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.85batch/s]  4%|█                           | 37/1014 [00:00<00:12, 79.53batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 81.37batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 81.11batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 80.85batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 82.75batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 79.48batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 81.70batch/s] 11%|██▉                        | 109/1014 [00:01<00:11, 80.79batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 81.61batch/s] 13%|███▍                       | 131/1014 [00:01<00:10, 81.97batch/s] 14%|███▊                       | 142/1014 [00:01<00:10, 82.50batch/s] 15%|████                       | 153/1014 [00:01<00:10, 81.39batch/s] 16%|████▎                      | 164/1014 [00:02<00:10, 81.57batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 81.78batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 82.17batch/s] 19%|█████▏                     | 197/1014 [00:02<00:09, 82.89batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 83.40batch/s] 22%|█████▊                     | 219/1014 [00:02<00:09, 83.71batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 84.46batch/s] 24%|██████▍                    | 241/1014 [00:02<00:09, 82.51batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 82.59batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 83.17batch/s] 27%|███████▎                   | 274/1014 [00:03<00:08, 83.47batch/s] 28%|███████▌                   | 285/1014 [00:03<00:08, 84.04batch/s] 29%|███████▉                   | 296/1014 [00:03<00:08, 84.25batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 84.30batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 84.62batch/s] 32%|████████▊                  | 329/1014 [00:03<00:08, 84.98batch/s] 34%|█████████                  | 340/1014 [00:03<00:07, 85.19batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:07, 85.39batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:07, 85.54batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:07, 85.55batch/s] 38%|██████████▏                | 384/1014 [00:04<00:07, 85.83batch/s] 39%|██████████▌                | 395/1014 [00:04<00:07, 85.76batch/s] 40%|██████████▊                | 406/1014 [00:04<00:07, 86.09batch/s] 41%|███████████                | 417/1014 [00:04<00:06, 86.04batch/s] 42%|███████████▍               | 428/1014 [00:04<00:06, 85.94batch/s] 43%|███████████▋               | 439/1014 [00:05<00:06, 85.96batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 85.87batch/s] 45%|████████████▎              | 461/1014 [00:05<00:06, 85.71batch/s] 47%|████████████▌              | 472/1014 [00:05<00:06, 85.78batch/s] 48%|████████████▊              | 483/1014 [00:05<00:06, 85.58batch/s] 49%|█████████████▏             | 494/1014 [00:05<00:06, 85.70batch/s] 50%|█████████████▍             | 505/1014 [00:05<00:05, 85.63batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:05, 85.43batch/s] 52%|██████████████             | 527/1014 [00:06<00:05, 85.64batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:05, 85.57batch/s] 54%|██████████████▌            | 549/1014 [00:06<00:05, 85.72batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 85.85batch/s] 56%|███████████████▏           | 571/1014 [00:06<00:05, 86.07batch/s] 57%|███████████████▍           | 582/1014 [00:06<00:05, 86.29batch/s] 58%|███████████████▊           | 593/1014 [00:06<00:04, 86.18batch/s] 60%|████████████████           | 604/1014 [00:07<00:04, 86.26batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:04, 86.12batch/s] 62%|████████████████▋          | 626/1014 [00:07<00:04, 86.13batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 86.14batch/s] 64%|█████████████████▎         | 648/1014 [00:07<00:04, 85.97batch/s] 65%|█████████████████▌         | 659/1014 [00:07<00:04, 85.90batch/s] 66%|█████████████████▊         | 670/1014 [00:07<00:03, 86.01batch/s] 67%|██████████████████▏        | 681/1014 [00:07<00:03, 86.23batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:03, 86.25batch/s] 69%|██████████████████▋        | 703/1014 [00:08<00:03, 86.14batch/s] 70%|███████████████████        | 714/1014 [00:08<00:03, 86.37batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 86.28batch/s] 73%|███████████████████▌       | 736/1014 [00:08<00:03, 86.16batch/s] 74%|███████████████████▉       | 747/1014 [00:08<00:03, 86.22batch/s] 75%|████████████████████▏      | 758/1014 [00:08<00:02, 86.20batch/s] 76%|████████████████████▍      | 769/1014 [00:08<00:02, 86.14batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 86.04batch/s] 78%|█████████████████████      | 791/1014 [00:09<00:02, 86.06batch/s] 79%|█████████████████████▎     | 802/1014 [00:09<00:02, 86.07batch/s] 80%|█████████████████████▋     | 813/1014 [00:09<00:02, 86.07batch/s] 81%|█████████████████████▉     | 824/1014 [00:09<00:02, 86.18batch/s] 82%|██████████████████████▏    | 835/1014 [00:09<00:02, 86.16batch/s] 83%|██████████████████████▌    | 846/1014 [00:09<00:01, 86.29batch/s] 85%|██████████████████████▊    | 857/1014 [00:09<00:01, 86.23batch/s] 86%|███████████████████████    | 868/1014 [00:10<00:01, 86.21batch/s] 87%|███████████████████████▍   | 879/1014 [00:10<00:01, 86.29batch/s] 88%|███████████████████████▋   | 890/1014 [00:10<00:01, 86.28batch/s] 89%|███████████████████████▉   | 901/1014 [00:10<00:01, 86.15batch/s] 90%|████████████████████████▎  | 912/1014 [00:10<00:01, 86.04batch/s] 91%|████████████████████████▌  | 923/1014 [00:10<00:01, 86.19batch/s] 92%|████████████████████████▊  | 934/1014 [00:10<00:00, 86.36batch/s] 93%|█████████████████████████▏ | 945/1014 [00:10<00:00, 86.42batch/s] 94%|█████████████████████████▍ | 956/1014 [00:11<00:00, 86.45batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 86.46batch/s] 97%|██████████████████████████ | 979/1014 [00:11<00:00, 86.68batch/s] 98%|██████████████████████████▍| 991/1014 [00:11<00:00, 86.69batch/s] 99%|█████████████████████████▋| 1003/1014 [00:11<00:00, 86.74batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 86.56batch/s]
Validation 7 -> LOSS = 2.47
Validation 7 -> BLEU = 15.56, 49.3/22.7/12.5/7.0 (BP=0.879, ratio=0.886, hyp_len=11365, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.47 @ validation 7
--> Best BLEU so far: 15.56 @ validation 7
Starting Epoch 8
Epoch 8 - update       3360 => loss:   2.854 (#OOM: 0)
Epoch 8 - update       3390 => loss:   2.525 (#OOM: 0)
Epoch 8 - update       3420 => loss:   3.672 (#OOM: 0)
Epoch 8 - update       3450 => loss:   2.495 (#OOM: 0)
Epoch 8 - update       3480 => loss:   2.117 (#OOM: 0)
Epoch 8 - update       3510 => loss:   2.510 (#OOM: 0)
Epoch 8 - update       3540 => loss:   2.224 (#OOM: 0)
Epoch 8 - update       3570 => loss:   2.225 (#OOM: 0)
Epoch 8 - update       3600 => loss:   2.131 (#OOM: 0)
Epoch 8 - update       3630 => loss:   2.821 (#OOM: 0)
Epoch 8 - update       3660 => loss:   2.698 (#OOM: 0)
Epoch 8 - update       3690 => loss:   3.006 (#OOM: 0)
Epoch 8 - update       3720 => loss:   2.416 (#OOM: 0)
Epoch 8 - update       3750 => loss:   1.933 (#OOM: 0)
Epoch 8 - update       3780 => loss:   3.330 (#OOM: 0)
Epoch 8 - update       3810 => loss:   2.503 (#OOM: 0)
--> Epoch 8 finished with mean loss 2.66469
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (797 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.73batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.42batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.10batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.11batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 50.71batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.62batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.18batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.85batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 82.27batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 83.67batch/s]  5%|█▎                          | 46/1014 [00:00<00:11, 83.01batch/s]  6%|█▌                          | 56/1014 [00:00<00:11, 83.09batch/s]  7%|█▊                          | 66/1014 [00:00<00:11, 83.71batch/s]  7%|██                          | 76/1014 [00:00<00:11, 83.85batch/s]  8%|██▎                         | 86/1014 [00:01<00:11, 83.83batch/s]  9%|██▋                         | 96/1014 [00:01<00:10, 83.51batch/s] 10%|██▊                        | 106/1014 [00:01<00:10, 83.75batch/s] 11%|███                        | 116/1014 [00:01<00:10, 83.30batch/s] 12%|███▎                       | 126/1014 [00:01<00:10, 82.89batch/s] 13%|███▌                       | 136/1014 [00:01<00:10, 81.88batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 80.98batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 81.53batch/s] 16%|████▍                      | 166/1014 [00:02<00:10, 81.32batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 81.58batch/s] 18%|████▉                      | 186/1014 [00:02<00:10, 82.31batch/s] 19%|█████▏                     | 196/1014 [00:02<00:09, 82.68batch/s] 20%|█████▍                     | 206/1014 [00:02<00:09, 82.40batch/s] 21%|█████▊                     | 216/1014 [00:02<00:09, 82.73batch/s] 22%|██████                     | 226/1014 [00:02<00:09, 82.53batch/s] 23%|██████▎                    | 236/1014 [00:02<00:09, 82.36batch/s] 24%|██████▌                    | 246/1014 [00:02<00:09, 82.10batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 82.30batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 82.48batch/s] 27%|███████▎                   | 276/1014 [00:03<00:08, 82.19batch/s] 28%|███████▌                   | 286/1014 [00:03<00:08, 82.40batch/s] 29%|███████▉                   | 296/1014 [00:03<00:08, 82.58batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 82.22batch/s] 31%|████████▍                  | 316/1014 [00:03<00:08, 82.48batch/s] 32%|████████▋                  | 326/1014 [00:03<00:08, 82.44batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 82.26batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:08, 82.40batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:07, 82.44batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:07, 82.49batch/s] 37%|██████████                 | 376/1014 [00:04<00:07, 82.75batch/s] 38%|██████████▎                | 386/1014 [00:04<00:07, 82.78batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 82.79batch/s] 40%|██████████▊                | 406/1014 [00:04<00:07, 82.88batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 82.94batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 83.00batch/s] 43%|███████████▌               | 436/1014 [00:05<00:06, 82.99batch/s] 44%|███████████▉               | 446/1014 [00:05<00:06, 83.10batch/s] 45%|████████████▏              | 456/1014 [00:05<00:06, 83.02batch/s] 46%|████████████▍              | 466/1014 [00:05<00:06, 83.12batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 82.62batch/s] 48%|████████████▉              | 486/1014 [00:05<00:06, 82.34batch/s] 49%|█████████████▏             | 496/1014 [00:06<00:06, 81.97batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 82.17batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 82.15batch/s] 52%|██████████████             | 526/1014 [00:06<00:05, 82.34batch/s] 53%|██████████████▎            | 536/1014 [00:06<00:05, 82.05batch/s] 54%|██████████████▌            | 546/1014 [00:06<00:05, 82.04batch/s] 55%|██████████████▊            | 556/1014 [00:06<00:05, 81.97batch/s] 56%|███████████████            | 566/1014 [00:06<00:05, 81.78batch/s] 57%|███████████████▎           | 576/1014 [00:07<00:05, 81.84batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 81.74batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 81.70batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:05, 81.55batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 81.60batch/s] 62%|████████████████▋          | 626/1014 [00:07<00:04, 81.62batch/s] 63%|████████████████▉          | 636/1014 [00:07<00:04, 81.37batch/s] 64%|█████████████████▏         | 646/1014 [00:07<00:04, 81.41batch/s] 65%|█████████████████▍         | 656/1014 [00:08<00:04, 81.39batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 81.77batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 81.87batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:03, 81.79batch/s] 69%|██████████████████▋        | 704/1014 [00:08<00:03, 81.75batch/s] 71%|███████████████████        | 716/1014 [00:08<00:03, 81.72batch/s] 72%|███████████████████▍       | 728/1014 [00:08<00:03, 81.75batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 81.63batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 81.63batch/s] 75%|████████████████████▎      | 764/1014 [00:09<00:03, 81.54batch/s] 77%|████████████████████▋      | 776/1014 [00:09<00:02, 81.54batch/s] 78%|████████████████████▉      | 788/1014 [00:09<00:02, 81.61batch/s] 79%|█████████████████████▎     | 800/1014 [00:09<00:02, 81.64batch/s] 80%|█████████████████████▌     | 812/1014 [00:09<00:02, 81.64batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 81.63batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 81.62batch/s] 84%|██████████████████████▌    | 848/1014 [00:10<00:02, 81.72batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 81.67batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 81.77batch/s] 87%|███████████████████████▌   | 884/1014 [00:10<00:01, 81.67batch/s] 88%|███████████████████████▊   | 896/1014 [00:10<00:01, 81.68batch/s] 90%|████████████████████████▏  | 908/1014 [00:11<00:01, 81.64batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 81.68batch/s] 92%|████████████████████████▊  | 932/1014 [00:11<00:01, 81.62batch/s] 93%|█████████████████████████▏ | 944/1014 [00:11<00:00, 81.57batch/s] 94%|█████████████████████████▍ | 956/1014 [00:11<00:00, 81.65batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 81.69batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 81.61batch/s] 98%|██████████████████████████▍| 992/1014 [00:12<00:00, 81.47batch/s] 99%|█████████████████████████▋| 1004/1014 [00:12<00:00, 81.53batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.62batch/s]
Validation 8 -> LOSS = 2.41
Validation 8 -> BLEU = 17.45, 48.0/22.5/12.5/7.1 (BP=0.990, ratio=0.990, hyp_len=12701, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.41 @ validation 8
--> Best BLEU so far: 17.45 @ validation 8
Starting Epoch 9
Epoch 9 - update       3840 => loss:   2.626 (#OOM: 0)
Epoch 9 - update       3870 => loss:   2.464 (#OOM: 0)
Epoch 9 - update       3900 => loss:   2.857 (#OOM: 0)
Epoch 9 - update       3930 => loss:   3.654 (#OOM: 0)
Epoch 9 - update       3960 => loss:   1.861 (#OOM: 0)
Epoch 9 - update       3990 => loss:   3.142 (#OOM: 0)
Epoch 9 - update       4020 => loss:   2.235 (#OOM: 0)
Epoch 9 - update       4050 => loss:   2.981 (#OOM: 0)
Epoch 9 - update       4080 => loss:   2.097 (#OOM: 0)
Epoch 9 - update       4110 => loss:   2.287 (#OOM: 0)
Epoch 9 - update       4140 => loss:   2.335 (#OOM: 0)
Epoch 9 - update       4170 => loss:   2.696 (#OOM: 0)
Epoch 9 - update       4200 => loss:   2.018 (#OOM: 0)
Epoch 9 - update       4230 => loss:   2.227 (#OOM: 0)
Epoch 9 - update       4260 => loss:   2.204 (#OOM: 0)
Epoch 9 - update       4290 => loss:   2.433 (#OOM: 0)
--> Epoch 9 finished with mean loss 2.57811
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (863 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.21batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 58.72batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 55.80batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 54.59batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.84batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 63.53batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 72.86batch/s]  2%|▋                           | 25/1014 [00:00<00:14, 70.53batch/s]  3%|▉                           | 34/1014 [00:00<00:13, 74.03batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 75.43batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 75.56batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 77.17batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 78.40batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 77.85batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 76.81batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 77.46batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 77.34batch/s] 11%|███                        | 115/1014 [00:01<00:11, 76.94batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 78.03batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 77.54batch/s] 14%|███▊                       | 145/1014 [00:01<00:11, 78.04batch/s] 15%|████▏                      | 155/1014 [00:01<00:11, 77.98batch/s] 16%|████▍                      | 165/1014 [00:02<00:10, 77.56batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 77.67batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 78.04batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 77.41batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 77.86batch/s] 21%|█████▋                     | 215/1014 [00:02<00:10, 77.95batch/s] 22%|█████▉                     | 225/1014 [00:02<00:10, 77.49batch/s] 23%|██████▎                    | 235/1014 [00:03<00:10, 77.60batch/s] 24%|██████▌                    | 245/1014 [00:03<00:09, 77.67batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 78.12batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 78.33batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 78.35batch/s] 28%|███████▌                   | 285/1014 [00:03<00:09, 78.37batch/s] 29%|███████▊                   | 295/1014 [00:03<00:09, 78.38batch/s] 30%|████████                   | 305/1014 [00:03<00:09, 78.40batch/s] 31%|████████▍                  | 315/1014 [00:04<00:09, 77.33batch/s] 32%|████████▋                  | 325/1014 [00:04<00:08, 77.28batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 77.61batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 77.74batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 78.00batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 78.18batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 78.17batch/s] 38%|██████████▎                | 385/1014 [00:04<00:08, 78.07batch/s] 39%|██████████▌                | 395/1014 [00:05<00:07, 78.29batch/s] 40%|██████████▊                | 405/1014 [00:05<00:07, 78.09batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 77.94batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 77.92batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 78.04batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 77.80batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 77.82batch/s] 46%|████████████▍              | 465/1014 [00:05<00:07, 77.83batch/s] 47%|████████████▋              | 475/1014 [00:06<00:06, 78.06batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 78.09batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 78.18batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 78.35batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 78.27batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 78.42batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:06, 78.37batch/s] 54%|██████████████▌            | 545/1014 [00:06<00:05, 78.24batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:05, 78.38batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 78.34batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 78.26batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 78.52batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 78.45batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 78.50batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:05, 78.53batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 78.78batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 78.82batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 78.83batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 78.75batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 78.76batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 78.54batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 78.55batch/s] 69%|██████████████████▌        | 695/1014 [00:08<00:04, 78.70batch/s] 70%|██████████████████▊        | 705/1014 [00:08<00:03, 78.68batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 78.54batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 78.61batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 78.66batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 78.67batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 78.61batch/s] 75%|████████████████████▎      | 765/1014 [00:09<00:03, 78.63batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:03, 78.70batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 78.86batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 78.79batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 78.79batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 78.78batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 78.85batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 78.93batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 79.06batch/s] 84%|██████████████████████▊    | 855/1014 [00:10<00:02, 79.01batch/s] 85%|███████████████████████    | 865/1014 [00:10<00:01, 79.06batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 79.06batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 79.10batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 79.09batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 79.14batch/s] 90%|████████████████████████▎  | 915/1014 [00:11<00:01, 79.25batch/s] 91%|████████████████████████▋  | 925/1014 [00:11<00:01, 79.35batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 79.33batch/s] 93%|█████████████████████████▏ | 945/1014 [00:11<00:00, 79.13batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 79.24batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 79.31batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 79.28batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 79.26batch/s] 98%|██████████████████████████▍| 995/1014 [00:12<00:00, 79.42batch/s] 99%|█████████████████████████▊| 1005/1014 [00:12<00:00, 79.47batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.62batch/s]
Validation 9 -> LOSS = 2.35
Validation 9 -> BLEU = 17.94, 48.4/23.0/13.0/7.5 (BP=0.987, ratio=0.987, hyp_len=12667, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.35 @ validation 9
--> Best BLEU so far: 17.94 @ validation 9
Starting Epoch 10
Epoch 10 - update       4320 => loss:   2.759 (#OOM: 0)
Epoch 10 - update       4350 => loss:   2.505 (#OOM: 0)
Epoch 10 - update       4380 => loss:   2.466 (#OOM: 0)
Epoch 10 - update       4410 => loss:   2.342 (#OOM: 0)
Epoch 10 - update       4440 => loss:   2.589 (#OOM: 0)
Epoch 10 - update       4470 => loss:   2.451 (#OOM: 0)
Epoch 10 - update       4500 => loss:   2.128 (#OOM: 0)
Epoch 10 - update       4530 => loss:   2.718 (#OOM: 0)
Epoch 10 - update       4560 => loss:   2.537 (#OOM: 0)
Epoch 10 - update       4590 => loss:   2.386 (#OOM: 0)
Epoch 10 - update       4620 => loss:   2.460 (#OOM: 0)
Epoch 10 - update       4650 => loss:   2.293 (#OOM: 0)
Epoch 10 - update       4680 => loss:   2.402 (#OOM: 0)
Epoch 10 - update       4710 => loss:   2.142 (#OOM: 0)
Epoch 10 - update       4740 => loss:   2.225 (#OOM: 0)
Epoch 10 - update       4770 => loss:   1.943 (#OOM: 0)
--> Epoch 10 finished with mean loss 2.50797
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.57 mins)   (904 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.54batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.29batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.32batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.32batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 53.81batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.97batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.25batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 84.56batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 83.11batch/s]  4%|█                           | 38/1014 [00:00<00:12, 77.71batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 76.63batch/s]  6%|█▌                          | 58/1014 [00:00<00:12, 76.55batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 77.05batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 78.19batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 78.42batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 78.30batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 76.84batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 77.74batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 78.06batch/s] 14%|███▋                       | 138/1014 [00:01<00:11, 77.98batch/s] 15%|███▉                       | 148/1014 [00:01<00:11, 78.44batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 79.25batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 79.14batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 79.76batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 79.38batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 79.30batch/s] 21%|█████▌                     | 208/1014 [00:02<00:10, 80.09batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 79.60batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 79.62batch/s] 23%|██████▎                    | 238/1014 [00:03<00:09, 79.20batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 79.11batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 78.90batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 78.61batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 77.65batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 78.03batch/s] 29%|███████▉                   | 298/1014 [00:03<00:09, 78.20batch/s] 30%|████████▏                  | 308/1014 [00:03<00:09, 78.27batch/s] 31%|████████▍                  | 318/1014 [00:04<00:08, 78.30batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 78.25batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 78.01batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 78.19batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 78.54batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 78.11batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 77.96batch/s] 38%|██████████▎                | 388/1014 [00:04<00:08, 78.01batch/s] 39%|██████████▌                | 398/1014 [00:05<00:07, 78.08batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 78.22batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 78.12batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 77.74batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 77.61batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 77.68batch/s] 45%|████████████▏              | 458/1014 [00:05<00:07, 77.76batch/s] 46%|████████████▍              | 468/1014 [00:06<00:07, 77.81batch/s] 47%|████████████▋              | 478/1014 [00:06<00:06, 77.68batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 77.67batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 77.86batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 77.85batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 77.98batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 77.99batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:06, 78.09batch/s] 54%|██████████████▌            | 548/1014 [00:07<00:05, 78.26batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 78.27batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 78.32batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 78.30batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 78.48batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 78.47batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 78.67batch/s] 61%|████████████████▍          | 618/1014 [00:07<00:05, 78.85batch/s] 62%|████████████████▋          | 628/1014 [00:07<00:04, 78.95batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 78.99batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 79.12batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 79.26batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 79.41batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 79.35batch/s] 68%|██████████████████▎        | 688/1014 [00:08<00:04, 79.46batch/s] 69%|██████████████████▌        | 698/1014 [00:08<00:03, 79.53batch/s] 70%|██████████████████▊        | 708/1014 [00:08<00:03, 79.55batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 79.58batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 79.67batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 79.52batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 79.52batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 79.54batch/s] 76%|████████████████████▍      | 768/1014 [00:09<00:03, 79.45batch/s] 77%|████████████████████▋      | 778/1014 [00:09<00:02, 79.38batch/s] 78%|████████████████████▉      | 788/1014 [00:09<00:02, 78.87batch/s] 79%|█████████████████████▏     | 798/1014 [00:10<00:02, 78.87batch/s] 80%|█████████████████████▌     | 808/1014 [00:10<00:02, 78.95batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 78.98batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 78.95batch/s] 83%|██████████████████████▎    | 838/1014 [00:10<00:02, 79.02batch/s] 84%|██████████████████████▌    | 848/1014 [00:10<00:02, 79.03batch/s] 85%|██████████████████████▊    | 858/1014 [00:10<00:01, 79.04batch/s] 86%|███████████████████████    | 868/1014 [00:11<00:01, 78.65batch/s] 87%|███████████████████████▍   | 878/1014 [00:11<00:01, 78.63batch/s] 88%|███████████████████████▋   | 888/1014 [00:11<00:01, 78.63batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 78.70batch/s] 90%|████████████████████████▏  | 908/1014 [00:11<00:01, 78.73batch/s] 91%|████████████████████████▍  | 918/1014 [00:11<00:01, 78.71batch/s] 92%|████████████████████████▋  | 928/1014 [00:11<00:01, 78.67batch/s] 93%|████████████████████████▉  | 938/1014 [00:11<00:00, 78.74batch/s] 93%|█████████████████████████▏ | 948/1014 [00:12<00:00, 78.83batch/s] 94%|█████████████████████████▌ | 958/1014 [00:12<00:00, 78.93batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 79.06batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 79.14batch/s] 97%|██████████████████████████▎| 988/1014 [00:12<00:00, 79.18batch/s] 98%|██████████████████████████▌| 998/1014 [00:12<00:00, 79.17batch/s] 99%|█████████████████████████▊| 1008/1014 [00:12<00:00, 79.27batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.26batch/s]
Validation 10 -> LOSS = 2.32
Validation 10 -> BLEU = 17.89, 47.4/22.6/12.9/7.4 (BP=1.000, ratio=1.008, hyp_len=12931, ref_len=12828)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.32 @ validation 10
--> Best BLEU so far: 17.94 @ validation 9
Starting Epoch 11
Epoch 11 - update       4800 => loss:   2.207 (#OOM: 0)
Epoch 11 - update       4830 => loss:   2.107 (#OOM: 0)
Epoch 11 - update       4860 => loss:   2.374 (#OOM: 0)
Epoch 11 - update       4890 => loss:   2.286 (#OOM: 0)
Epoch 11 - update       4920 => loss:   2.720 (#OOM: 0)
Epoch 11 - update       4950 => loss:   1.902 (#OOM: 0)
Epoch 11 - update       4980 => loss:   2.361 (#OOM: 0)
Epoch 11 - update       5010 => loss:   2.546 (#OOM: 0)
Epoch 11 - update       5040 => loss:   2.218 (#OOM: 0)
Epoch 11 - update       5070 => loss:   2.480 (#OOM: 0)
Epoch 11 - update       5100 => loss:   2.754 (#OOM: 0)
Epoch 11 - update       5130 => loss:   3.247 (#OOM: 0)
Epoch 11 - update       5160 => loss:   2.384 (#OOM: 0)
Epoch 11 - update       5190 => loss:   2.131 (#OOM: 0)
Epoch 11 - update       5220 => loss:   2.203 (#OOM: 0)
--> Epoch 11 finished with mean loss 2.44059
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.58 mins)   (892 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.91batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.80batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.45batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.99batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.37batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.60batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 97.27batch/s]  2%|▌                           | 20/1014 [00:00<00:10, 95.81batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 88.64batch/s]  4%|█                           | 40/1014 [00:00<00:11, 84.83batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 84.23batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 84.90batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 84.26batch/s]  8%|██▏                         | 80/1014 [00:00<00:10, 85.73batch/s]  9%|██▍                         | 90/1014 [00:01<00:10, 86.23batch/s] 10%|██▋                        | 100/1014 [00:01<00:10, 86.24batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 86.17batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 85.51batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 84.45batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 84.22batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 84.79batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 85.09batch/s] 17%|████▌                      | 170/1014 [00:01<00:09, 85.47batch/s] 18%|████▊                      | 180/1014 [00:02<00:09, 86.00batch/s] 19%|█████                      | 190/1014 [00:02<00:09, 86.53batch/s] 20%|█████▎                     | 200/1014 [00:02<00:09, 86.28batch/s] 21%|█████▌                     | 210/1014 [00:02<00:09, 86.03batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 85.80batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 84.99batch/s] 24%|██████▍                    | 240/1014 [00:02<00:09, 84.84batch/s] 25%|██████▋                    | 250/1014 [00:02<00:09, 84.71batch/s] 26%|██████▉                    | 260/1014 [00:03<00:08, 84.96batch/s] 27%|███████▏                   | 270/1014 [00:03<00:08, 85.24batch/s] 28%|███████▍                   | 280/1014 [00:03<00:08, 85.57batch/s] 29%|███████▋                   | 290/1014 [00:03<00:08, 85.37batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 85.50batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 85.20batch/s] 32%|████████▌                  | 320/1014 [00:03<00:08, 85.33batch/s] 33%|████████▊                  | 330/1014 [00:03<00:08, 84.64batch/s] 34%|█████████                  | 340/1014 [00:04<00:07, 84.92batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:07, 85.38batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:07, 85.13batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:07, 85.17batch/s] 38%|██████████▏                | 384/1014 [00:04<00:07, 85.35batch/s] 39%|██████████▌                | 395/1014 [00:04<00:07, 85.28batch/s] 40%|██████████▊                | 406/1014 [00:04<00:07, 85.29batch/s] 41%|███████████                | 417/1014 [00:04<00:06, 85.63batch/s] 42%|███████████▍               | 428/1014 [00:05<00:06, 85.49batch/s] 43%|███████████▋               | 439/1014 [00:05<00:06, 85.50batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 85.35batch/s] 45%|████████████▎              | 461/1014 [00:05<00:06, 85.23batch/s] 47%|████████████▌              | 472/1014 [00:05<00:06, 85.05batch/s] 48%|████████████▊              | 483/1014 [00:05<00:06, 85.16batch/s] 49%|█████████████▏             | 494/1014 [00:05<00:06, 85.41batch/s] 50%|█████████████▍             | 505/1014 [00:05<00:05, 85.36batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:05, 85.46batch/s] 52%|██████████████             | 527/1014 [00:06<00:05, 85.41batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:05, 85.54batch/s] 54%|██████████████▌            | 549/1014 [00:06<00:05, 85.60batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 85.70batch/s] 56%|███████████████▏           | 571/1014 [00:06<00:05, 85.67batch/s] 57%|███████████████▍           | 582/1014 [00:06<00:05, 85.70batch/s] 58%|███████████████▊           | 593/1014 [00:06<00:04, 85.63batch/s] 60%|████████████████           | 604/1014 [00:07<00:04, 85.66batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:04, 85.57batch/s] 62%|████████████████▋          | 626/1014 [00:07<00:04, 85.54batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 85.68batch/s] 64%|█████████████████▎         | 648/1014 [00:07<00:04, 85.76batch/s] 65%|█████████████████▌         | 659/1014 [00:07<00:04, 85.91batch/s] 66%|█████████████████▊         | 670/1014 [00:07<00:04, 85.93batch/s] 67%|██████████████████▏        | 681/1014 [00:07<00:03, 86.03batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:03, 86.02batch/s] 69%|██████████████████▋        | 703/1014 [00:08<00:03, 85.92batch/s] 70%|███████████████████        | 714/1014 [00:08<00:03, 85.96batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 85.89batch/s] 73%|███████████████████▌       | 736/1014 [00:08<00:03, 86.03batch/s] 74%|███████████████████▉       | 747/1014 [00:08<00:03, 86.06batch/s] 75%|████████████████████▏      | 758/1014 [00:08<00:02, 86.06batch/s] 76%|████████████████████▍      | 769/1014 [00:08<00:02, 86.04batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 85.81batch/s] 78%|█████████████████████      | 791/1014 [00:09<00:02, 85.75batch/s] 79%|█████████████████████▎     | 802/1014 [00:09<00:02, 85.73batch/s] 80%|█████████████████████▋     | 813/1014 [00:09<00:02, 85.81batch/s] 81%|█████████████████████▉     | 824/1014 [00:09<00:02, 85.65batch/s] 82%|██████████████████████▏    | 835/1014 [00:09<00:02, 85.73batch/s] 83%|██████████████████████▌    | 846/1014 [00:09<00:01, 85.36batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 85.22batch/s] 86%|███████████████████████    | 868/1014 [00:10<00:01, 85.20batch/s] 87%|███████████████████████▍   | 879/1014 [00:10<00:01, 85.09batch/s] 88%|███████████████████████▋   | 890/1014 [00:10<00:01, 85.12batch/s] 89%|███████████████████████▉   | 901/1014 [00:10<00:01, 85.14batch/s] 90%|████████████████████████▎  | 912/1014 [00:10<00:01, 85.24batch/s] 91%|████████████████████████▌  | 923/1014 [00:10<00:01, 85.18batch/s] 92%|████████████████████████▊  | 934/1014 [00:10<00:00, 85.13batch/s] 93%|█████████████████████████▏ | 945/1014 [00:11<00:00, 85.22batch/s] 94%|█████████████████████████▍ | 956/1014 [00:11<00:00, 85.18batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 85.20batch/s] 96%|██████████████████████████ | 978/1014 [00:11<00:00, 85.16batch/s] 98%|██████████████████████████▎| 989/1014 [00:11<00:00, 84.97batch/s] 99%|█████████████████████████▋| 1000/1014 [00:11<00:00, 84.94batch/s]100%|█████████████████████████▉| 1011/1014 [00:11<00:00, 84.99batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 84.94batch/s]
Validation 11 -> LOSS = 2.29
Validation 11 -> BLEU = 18.90, 51.9/25.6/14.8/8.7 (BP=0.929, ratio=0.932, hyp_len=11954, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.29 @ validation 11
--> Best BLEU so far: 18.90 @ validation 11
Starting Epoch 12
Epoch 12 - update       5250 => loss:   2.457 (#OOM: 0)
Epoch 12 - update       5280 => loss:   2.131 (#OOM: 0)
Epoch 12 - update       5310 => loss:   2.313 (#OOM: 0)
Epoch 12 - update       5340 => loss:   2.152 (#OOM: 0)
Epoch 12 - update       5370 => loss:   2.429 (#OOM: 0)
Epoch 12 - update       5400 => loss:   2.102 (#OOM: 0)
Epoch 12 - update       5430 => loss:   2.046 (#OOM: 0)
Epoch 12 - update       5460 => loss:   2.691 (#OOM: 0)
Epoch 12 - update       5490 => loss:   2.222 (#OOM: 0)
Epoch 12 - update       5520 => loss:   3.254 (#OOM: 0)
Epoch 12 - update       5550 => loss:   2.183 (#OOM: 0)
Epoch 12 - update       5580 => loss:   2.065 (#OOM: 0)
Epoch 12 - update       5610 => loss:   2.373 (#OOM: 0)
Epoch 12 - update       5640 => loss:   2.303 (#OOM: 0)
Epoch 12 - update       5670 => loss:   3.032 (#OOM: 0)
Epoch 12 - update       5700 => loss:   2.075 (#OOM: 0)
--> Epoch 12 finished with mean loss 2.38361
--> Overhead/Training/Evaluation: 0.03/0.48/0.00 mins (total: 0.51 mins)   (1010 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.68batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.73batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.23batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.33batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 56.45batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.72batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 83.09batch/s]  2%|▌                           | 19/1014 [00:00<00:11, 87.99batch/s]  3%|▊                           | 29/1014 [00:00<00:10, 91.28batch/s]  4%|█                           | 39/1014 [00:00<00:10, 90.08batch/s]  5%|█▎                          | 49/1014 [00:00<00:10, 91.22batch/s]  6%|█▋                          | 60/1014 [00:00<00:10, 92.71batch/s]  7%|█▉                          | 71/1014 [00:00<00:10, 93.57batch/s]  8%|██▎                         | 82/1014 [00:00<00:10, 90.65batch/s]  9%|██▌                         | 93/1014 [00:01<00:10, 91.38batch/s] 10%|██▊                        | 104/1014 [00:01<00:10, 90.45batch/s] 11%|███                        | 115/1014 [00:01<00:10, 89.08batch/s] 12%|███▎                       | 126/1014 [00:01<00:10, 88.55batch/s] 14%|███▋                       | 137/1014 [00:01<00:09, 87.93batch/s] 15%|███▉                       | 148/1014 [00:01<00:09, 88.25batch/s] 16%|████▏                      | 159/1014 [00:01<00:09, 88.55batch/s] 17%|████▌                      | 170/1014 [00:01<00:09, 88.77batch/s] 18%|████▊                      | 181/1014 [00:02<00:09, 88.86batch/s] 19%|█████                      | 192/1014 [00:02<00:09, 88.48batch/s] 20%|█████▍                     | 203/1014 [00:02<00:09, 88.33batch/s] 21%|█████▋                     | 214/1014 [00:02<00:09, 88.56batch/s] 22%|█████▉                     | 225/1014 [00:02<00:08, 88.15batch/s] 23%|██████▎                    | 236/1014 [00:02<00:08, 87.58batch/s] 24%|██████▌                    | 247/1014 [00:02<00:08, 88.25batch/s] 25%|██████▊                    | 258/1014 [00:02<00:08, 88.16batch/s] 27%|███████▏                   | 269/1014 [00:03<00:08, 87.81batch/s] 28%|███████▍                   | 280/1014 [00:03<00:08, 87.56batch/s] 29%|███████▋                   | 291/1014 [00:03<00:08, 86.78batch/s] 30%|████████                   | 302/1014 [00:03<00:08, 86.91batch/s] 31%|████████▎                  | 313/1014 [00:03<00:08, 87.08batch/s] 32%|████████▋                  | 324/1014 [00:03<00:07, 86.75batch/s] 33%|████████▉                  | 335/1014 [00:03<00:07, 86.48batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:07, 86.24batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:07, 86.35batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 86.33batch/s] 37%|██████████                 | 379/1014 [00:04<00:07, 86.21batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 86.24batch/s] 40%|██████████▋                | 401/1014 [00:04<00:07, 86.26batch/s] 41%|██████████▉                | 412/1014 [00:04<00:06, 86.60batch/s] 42%|███████████▎               | 423/1014 [00:04<00:06, 86.66batch/s] 43%|███████████▌               | 434/1014 [00:04<00:06, 86.83batch/s] 44%|███████████▊               | 445/1014 [00:05<00:06, 87.09batch/s] 45%|████████████▏              | 456/1014 [00:05<00:06, 86.87batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 86.85batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 86.72batch/s] 48%|█████████████              | 489/1014 [00:05<00:06, 86.69batch/s] 49%|█████████████▎             | 500/1014 [00:05<00:05, 86.30batch/s] 50%|█████████████▌             | 511/1014 [00:05<00:05, 86.50batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:05, 86.46batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:05, 86.50batch/s] 54%|██████████████▍            | 544/1014 [00:06<00:05, 86.55batch/s] 55%|██████████████▊            | 555/1014 [00:06<00:05, 86.62batch/s] 56%|███████████████            | 566/1014 [00:06<00:05, 86.84batch/s] 57%|███████████████▎           | 577/1014 [00:06<00:05, 86.99batch/s] 58%|███████████████▋           | 588/1014 [00:06<00:04, 87.05batch/s] 59%|███████████████▉           | 599/1014 [00:06<00:04, 87.13batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 87.09batch/s] 61%|████████████████▌          | 621/1014 [00:07<00:04, 87.13batch/s] 62%|████████████████▊          | 632/1014 [00:07<00:04, 87.09batch/s] 63%|█████████████████          | 643/1014 [00:07<00:04, 87.06batch/s] 64%|█████████████████▍         | 654/1014 [00:07<00:04, 87.31batch/s] 66%|█████████████████▋         | 665/1014 [00:07<00:03, 87.32batch/s] 67%|██████████████████         | 676/1014 [00:07<00:03, 87.22batch/s] 68%|██████████████████▎        | 687/1014 [00:07<00:03, 87.15batch/s] 69%|██████████████████▌        | 698/1014 [00:08<00:03, 87.14batch/s] 70%|██████████████████▉        | 709/1014 [00:08<00:03, 87.37batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 87.45batch/s] 72%|███████████████████▍       | 731/1014 [00:08<00:03, 87.50batch/s] 73%|███████████████████▊       | 742/1014 [00:08<00:03, 87.56batch/s] 74%|████████████████████       | 753/1014 [00:08<00:02, 87.52batch/s] 75%|████████████████████▎      | 764/1014 [00:08<00:02, 87.48batch/s] 76%|████████████████████▋      | 775/1014 [00:08<00:02, 87.56batch/s] 78%|████████████████████▉      | 786/1014 [00:08<00:02, 87.41batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 87.61batch/s] 80%|█████████████████████▌     | 808/1014 [00:09<00:02, 87.65batch/s] 81%|█████████████████████▊     | 819/1014 [00:09<00:02, 87.53batch/s] 82%|██████████████████████     | 830/1014 [00:09<00:02, 87.56batch/s] 83%|██████████████████████▍    | 841/1014 [00:09<00:01, 87.41batch/s] 84%|██████████████████████▋    | 852/1014 [00:09<00:01, 87.49batch/s] 85%|██████████████████████▉    | 863/1014 [00:09<00:01, 87.46batch/s] 86%|███████████████████████▎   | 874/1014 [00:10<00:01, 87.34batch/s] 87%|███████████████████████▌   | 885/1014 [00:10<00:01, 87.45batch/s] 88%|███████████████████████▊   | 896/1014 [00:10<00:01, 87.35batch/s] 89%|████████████████████████▏  | 907/1014 [00:10<00:01, 87.28batch/s] 91%|████████████████████████▍  | 918/1014 [00:10<00:01, 87.03batch/s] 92%|████████████████████████▋  | 929/1014 [00:10<00:00, 86.97batch/s] 93%|█████████████████████████  | 940/1014 [00:10<00:00, 86.87batch/s] 94%|█████████████████████████▎ | 951/1014 [00:10<00:00, 86.77batch/s] 95%|█████████████████████████▌ | 962/1014 [00:11<00:00, 86.76batch/s] 96%|█████████████████████████▉ | 973/1014 [00:11<00:00, 86.81batch/s] 97%|██████████████████████████▏| 984/1014 [00:11<00:00, 86.82batch/s] 98%|██████████████████████████▍| 995/1014 [00:11<00:00, 86.80batch/s] 99%|█████████████████████████▊| 1006/1014 [00:11<00:00, 86.69batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 86.74batch/s]
Validation 12 -> LOSS = 2.26
Validation 12 -> BLEU = 18.53, 51.4/25.5/15.0/9.0 (BP=0.904, ratio=0.908, hyp_len=11649, ref_len=12828)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.26 @ validation 12
--> Best BLEU so far: 18.90 @ validation 11
Starting Epoch 13
Epoch 13 - update       5730 => loss:   1.738 (#OOM: 0)
Epoch 13 - update       5760 => loss:   1.768 (#OOM: 0)
Epoch 13 - update       5790 => loss:   2.796 (#OOM: 0)
Epoch 13 - update       5820 => loss:   2.544 (#OOM: 0)
Epoch 13 - update       5850 => loss:   2.293 (#OOM: 0)
Epoch 13 - update       5880 => loss:   2.188 (#OOM: 0)
Epoch 13 - update       5910 => loss:   2.322 (#OOM: 0)
Epoch 13 - update       5940 => loss:   2.510 (#OOM: 0)
Epoch 13 - update       5970 => loss:   2.196 (#OOM: 0)
Epoch 13 - update       6000 => loss:   1.993 (#OOM: 0)
Epoch 13 - update       6030 => loss:   1.907 (#OOM: 0)
Epoch 13 - update       6060 => loss:   2.064 (#OOM: 0)
Epoch 13 - update       6090 => loss:   2.284 (#OOM: 0)
Epoch 13 - update       6120 => loss:   2.231 (#OOM: 0)
Epoch 13 - update       6150 => loss:   2.568 (#OOM: 0)
Epoch 13 - update       6180 => loss:   2.603 (#OOM: 0)
--> Epoch 13 finished with mean loss 2.32910
--> Overhead/Training/Evaluation: 0.03/0.46/0.00 mins (total: 0.49 mins)   (1040 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.03batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.52batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.96batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 53.44batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 53.05batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.19batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.35batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 82.36batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 77.35batch/s]  3%|▉                           | 35/1014 [00:00<00:13, 73.46batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 74.44batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 76.28batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 76.66batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 77.93batch/s]  8%|██▏                         | 80/1014 [00:01<00:12, 77.24batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 78.30batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 78.88batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 79.63batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 79.37batch/s] 13%|███▍                       | 130/1014 [00:01<00:11, 79.11batch/s] 14%|███▋                       | 140/1014 [00:01<00:11, 78.24batch/s] 15%|███▉                       | 150/1014 [00:01<00:11, 78.36batch/s] 16%|████▎                      | 160/1014 [00:02<00:10, 77.89batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 78.39batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 78.78batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 78.40batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 78.92batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 79.04batch/s] 22%|█████▊                     | 220/1014 [00:02<00:10, 78.29batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 78.63batch/s] 24%|██████▍                    | 240/1014 [00:03<00:09, 78.25batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 77.90batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 77.54batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 77.14batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 76.89batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 76.82batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 76.79batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 76.67batch/s] 32%|████████▌                  | 320/1014 [00:04<00:09, 76.78batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 76.98batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 77.28batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 77.23batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 77.21batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 77.49batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 77.69batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 77.88batch/s] 39%|██████████▋                | 400/1014 [00:05<00:07, 78.00batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 78.03batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 78.03batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 77.97batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 78.10batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 78.10batch/s] 45%|████████████▏              | 460/1014 [00:05<00:07, 78.26batch/s] 46%|████████████▌              | 470/1014 [00:06<00:06, 78.17batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 78.19batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 78.36batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 78.47batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 78.57batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 78.51batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 78.33batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:06, 78.23batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:05, 78.54batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 78.56batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 78.61batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 78.83batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 78.75batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 78.86batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 78.36batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:05, 78.35batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:04, 78.47batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 78.43batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 78.52batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 78.44batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 78.41batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 78.34batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:04, 78.51batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 78.60batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:03, 78.70batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 78.73batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 78.81batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 78.95batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 78.87batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 78.91batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:03, 79.00batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 79.15batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 79.23batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 79.26batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 79.29batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 79.11batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 79.14batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 79.23batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 79.22batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 79.31batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 79.39batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 79.32batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 79.32batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 79.44batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 79.49batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 79.60batch/s] 92%|████████████████████████▊  | 930/1014 [00:11<00:01, 79.53batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 79.61batch/s] 94%|█████████████████████████▎ | 950/1014 [00:11<00:00, 79.76batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 79.81batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 79.84batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 79.74batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 79.82batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 79.81batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 79.83batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.85batch/s]
Validation 13 -> LOSS = 2.24
Validation 13 -> BLEU = 18.96, 49.4/24.0/13.8/8.2 (BP=0.992, ratio=0.992, hyp_len=12725, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.24 @ validation 13
--> Best BLEU so far: 18.96 @ validation 13
Starting Epoch 14
Epoch 14 - update       6210 => loss:   2.777 (#OOM: 0)
Epoch 14 - update       6240 => loss:   2.186 (#OOM: 0)
Epoch 14 - update       6270 => loss:   1.715 (#OOM: 0)
Epoch 14 - update       6300 => loss:   2.595 (#OOM: 0)
Epoch 14 - update       6330 => loss:   1.868 (#OOM: 0)
Epoch 14 - update       6360 => loss:   1.737 (#OOM: 0)
Epoch 14 - update       6390 => loss:   1.960 (#OOM: 0)
Epoch 14 - update       6420 => loss:   1.310 (#OOM: 0)
Epoch 14 - update       6450 => loss:   2.812 (#OOM: 0)
Epoch 14 - update       6480 => loss:   2.135 (#OOM: 0)
Epoch 14 - update       6510 => loss:   2.397 (#OOM: 0)
Epoch 14 - update       6540 => loss:   2.221 (#OOM: 0)
Epoch 14 - update       6570 => loss:   2.611 (#OOM: 0)
Epoch 14 - update       6600 => loss:   2.211 (#OOM: 0)
Epoch 14 - update       6630 => loss:   2.542 (#OOM: 0)
Epoch 14 - update       6660 => loss:   2.484 (#OOM: 0)
--> Epoch 14 finished with mean loss 2.27709
--> Overhead/Training/Evaluation: 0.04/0.64/0.00 mins (total: 0.68 mins)   (760 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.24batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.15batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.28batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.81batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.88batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.48batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:13, 76.62batch/s]  2%|▌                           | 19/1014 [00:00<00:11, 84.08batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 89.41batch/s]  4%|█▏                          | 41/1014 [00:00<00:10, 92.37batch/s]  5%|█▍                          | 52/1014 [00:00<00:10, 90.66batch/s]  6%|█▋                          | 63/1014 [00:00<00:10, 89.89batch/s]  7%|██                          | 74/1014 [00:00<00:10, 90.59batch/s]  8%|██▎                         | 85/1014 [00:00<00:10, 89.84batch/s]  9%|██▋                         | 96/1014 [00:01<00:10, 89.36batch/s] 11%|██▊                        | 107/1014 [00:01<00:10, 88.81batch/s] 12%|███▏                       | 118/1014 [00:01<00:10, 86.86batch/s] 13%|███▍                       | 129/1014 [00:01<00:10, 86.43batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 86.30batch/s] 15%|████                       | 151/1014 [00:01<00:10, 86.29batch/s] 16%|████▎                      | 162/1014 [00:01<00:09, 86.03batch/s] 17%|████▌                      | 173/1014 [00:02<00:09, 86.35batch/s] 18%|████▉                      | 184/1014 [00:02<00:09, 85.82batch/s] 19%|█████▏                     | 195/1014 [00:02<00:09, 85.65batch/s] 20%|█████▍                     | 206/1014 [00:02<00:09, 85.67batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 85.54batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 85.75batch/s] 24%|██████▎                    | 239/1014 [00:02<00:08, 86.40batch/s] 25%|██████▋                    | 250/1014 [00:02<00:08, 86.42batch/s] 26%|██████▉                    | 261/1014 [00:03<00:08, 86.47batch/s] 27%|███████▏                   | 272/1014 [00:03<00:08, 86.35batch/s] 28%|███████▌                   | 283/1014 [00:03<00:08, 86.32batch/s] 29%|███████▊                   | 294/1014 [00:03<00:08, 86.13batch/s] 30%|████████                   | 305/1014 [00:03<00:08, 86.27batch/s] 31%|████████▍                  | 316/1014 [00:03<00:08, 86.30batch/s] 32%|████████▋                  | 327/1014 [00:03<00:07, 86.59batch/s] 33%|█████████                  | 338/1014 [00:03<00:07, 86.25batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:07, 86.13batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:07, 86.18batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:07, 86.38batch/s] 38%|██████████▏                | 382/1014 [00:04<00:07, 86.26batch/s] 39%|██████████▍                | 393/1014 [00:04<00:07, 86.35batch/s] 40%|██████████▊                | 404/1014 [00:04<00:07, 86.44batch/s] 41%|███████████                | 415/1014 [00:04<00:06, 86.60batch/s] 42%|███████████▎               | 426/1014 [00:04<00:06, 86.66batch/s] 43%|███████████▋               | 437/1014 [00:05<00:06, 86.42batch/s] 44%|███████████▉               | 448/1014 [00:05<00:06, 86.36batch/s] 45%|████████████▏              | 459/1014 [00:05<00:06, 86.14batch/s] 46%|████████████▌              | 470/1014 [00:05<00:06, 86.39batch/s] 47%|████████████▊              | 481/1014 [00:05<00:06, 86.39batch/s] 49%|█████████████              | 492/1014 [00:05<00:06, 86.34batch/s] 50%|█████████████▍             | 503/1014 [00:05<00:05, 86.34batch/s] 51%|█████████████▋             | 514/1014 [00:05<00:05, 86.38batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:05, 86.49batch/s] 53%|██████████████▎            | 536/1014 [00:06<00:05, 86.50batch/s] 54%|██████████████▌            | 547/1014 [00:06<00:05, 86.45batch/s] 55%|██████████████▊            | 558/1014 [00:06<00:05, 86.36batch/s] 56%|███████████████▏           | 569/1014 [00:06<00:05, 86.41batch/s] 57%|███████████████▍           | 580/1014 [00:06<00:05, 86.22batch/s] 58%|███████████████▋           | 591/1014 [00:06<00:04, 86.12batch/s] 59%|████████████████           | 602/1014 [00:06<00:04, 86.01batch/s] 60%|████████████████▎          | 613/1014 [00:07<00:04, 86.09batch/s] 62%|████████████████▌          | 624/1014 [00:07<00:04, 86.08batch/s] 63%|████████████████▉          | 635/1014 [00:07<00:04, 86.11batch/s] 64%|█████████████████▏         | 646/1014 [00:07<00:04, 86.23batch/s] 65%|█████████████████▍         | 657/1014 [00:07<00:04, 86.26batch/s] 66%|█████████████████▊         | 668/1014 [00:07<00:04, 86.18batch/s] 67%|██████████████████         | 679/1014 [00:07<00:03, 86.10batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:03, 85.97batch/s] 69%|██████████████████▋        | 701/1014 [00:08<00:03, 85.99batch/s] 70%|██████████████████▉        | 712/1014 [00:08<00:03, 85.91batch/s] 71%|███████████████████▎       | 723/1014 [00:08<00:03, 85.96batch/s] 72%|███████████████████▌       | 734/1014 [00:08<00:03, 86.06batch/s] 73%|███████████████████▊       | 745/1014 [00:08<00:03, 85.93batch/s] 75%|████████████████████▏      | 756/1014 [00:08<00:03, 85.84batch/s] 76%|████████████████████▍      | 767/1014 [00:08<00:02, 85.97batch/s] 77%|████████████████████▋      | 778/1014 [00:09<00:02, 86.01batch/s] 78%|█████████████████████      | 789/1014 [00:09<00:02, 85.99batch/s] 79%|█████████████████████▎     | 800/1014 [00:09<00:02, 85.95batch/s] 80%|█████████████████████▌     | 811/1014 [00:09<00:02, 85.84batch/s] 81%|█████████████████████▉     | 822/1014 [00:09<00:02, 85.87batch/s] 82%|██████████████████████▏    | 833/1014 [00:09<00:02, 85.85batch/s] 83%|██████████████████████▍    | 844/1014 [00:09<00:01, 85.69batch/s] 84%|██████████████████████▊    | 855/1014 [00:09<00:01, 85.67batch/s] 85%|███████████████████████    | 866/1014 [00:10<00:01, 85.62batch/s] 86%|███████████████████████▎   | 877/1014 [00:10<00:01, 85.62batch/s] 88%|███████████████████████▋   | 888/1014 [00:10<00:01, 85.72batch/s] 89%|███████████████████████▉   | 899/1014 [00:10<00:01, 85.57batch/s] 90%|████████████████████████▏  | 910/1014 [00:10<00:01, 85.60batch/s] 91%|████████████████████████▌  | 921/1014 [00:10<00:01, 85.69batch/s] 92%|████████████████████████▊  | 932/1014 [00:10<00:00, 85.77batch/s] 93%|█████████████████████████  | 943/1014 [00:10<00:00, 85.90batch/s] 94%|█████████████████████████▍ | 954/1014 [00:11<00:00, 85.92batch/s] 95%|█████████████████████████▋ | 965/1014 [00:11<00:00, 85.92batch/s] 96%|█████████████████████████▉ | 976/1014 [00:11<00:00, 85.96batch/s] 97%|██████████████████████████▎| 987/1014 [00:11<00:00, 86.02batch/s] 98%|██████████████████████████▌| 998/1014 [00:11<00:00, 86.06batch/s]100%|█████████████████████████▊| 1009/1014 [00:11<00:00, 86.04batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 86.02batch/s]
Validation 14 -> LOSS = 2.26
Validation 14 -> BLEU = 19.03, 52.2/25.9/15.3/9.3 (BP=0.907, ratio=0.911, hyp_len=11692, ref_len=12828)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.24 @ validation 13
--> Best BLEU so far: 19.03 @ validation 14
Starting Epoch 15
Epoch 15 - update       6690 => loss:   2.056 (#OOM: 0)
Epoch 15 - update       6720 => loss:   2.894 (#OOM: 0)
Epoch 15 - update       6750 => loss:   1.654 (#OOM: 0)
Epoch 15 - update       6780 => loss:   2.033 (#OOM: 0)
Epoch 15 - update       6810 => loss:   2.580 (#OOM: 0)
Epoch 15 - update       6840 => loss:   1.871 (#OOM: 0)
Epoch 15 - update       6870 => loss:   2.398 (#OOM: 0)
Epoch 15 - update       6900 => loss:   1.819 (#OOM: 0)
Epoch 15 - update       6930 => loss:   1.990 (#OOM: 0)
Epoch 15 - update       6960 => loss:   1.899 (#OOM: 0)
Epoch 15 - update       6990 => loss:   2.017 (#OOM: 0)
Epoch 15 - update       7020 => loss:   2.331 (#OOM: 0)
Epoch 15 - update       7050 => loss:   2.279 (#OOM: 0)
Epoch 15 - update       7080 => loss:   2.367 (#OOM: 0)
Epoch 15 - update       7110 => loss:   2.452 (#OOM: 0)
Epoch 15 - update       7140 => loss:   2.211 (#OOM: 0)
--> Epoch 15 finished with mean loss 2.23139
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (797 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.03batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.29batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 56.36batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 55.17batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 54.78batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.38batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:16, 62.86batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 75.03batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 76.19batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 78.89batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 78.13batch/s]  5%|█▍                          | 52/1014 [00:00<00:12, 76.82batch/s]  6%|█▋                          | 61/1014 [00:00<00:12, 76.06batch/s]  7%|█▉                          | 70/1014 [00:00<00:12, 74.81batch/s]  8%|██▏                         | 79/1014 [00:01<00:12, 75.10batch/s]  9%|██▍                         | 88/1014 [00:01<00:12, 74.26batch/s] 10%|██▋                         | 97/1014 [00:01<00:12, 75.18batch/s] 10%|██▊                        | 106/1014 [00:01<00:12, 75.53batch/s] 11%|███                        | 115/1014 [00:01<00:11, 75.07batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 75.09batch/s] 13%|███▌                       | 133/1014 [00:01<00:11, 75.10batch/s] 14%|███▊                       | 142/1014 [00:01<00:11, 75.39batch/s] 15%|████                       | 151/1014 [00:01<00:11, 75.89batch/s] 16%|████▎                      | 160/1014 [00:02<00:11, 76.47batch/s] 17%|████▌                      | 169/1014 [00:02<00:11, 76.70batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 77.22batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 77.46batch/s] 19%|█████▏                     | 196/1014 [00:02<00:10, 77.42batch/s] 20%|█████▍                     | 205/1014 [00:02<00:10, 77.44batch/s] 21%|█████▋                     | 214/1014 [00:02<00:10, 77.04batch/s] 22%|█████▉                     | 223/1014 [00:02<00:10, 77.28batch/s] 23%|██████▏                    | 232/1014 [00:02<00:10, 77.49batch/s] 24%|██████▍                    | 241/1014 [00:03<00:09, 77.62batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 77.19batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 77.79batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 77.70batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 76.89batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 76.93batch/s] 30%|███████▉                   | 300/1014 [00:03<00:09, 77.02batch/s] 31%|████████▎                  | 310/1014 [00:04<00:09, 77.19batch/s] 32%|████████▌                  | 320/1014 [00:04<00:08, 77.22batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 76.91batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 76.94batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 76.93batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 76.55batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 76.38batch/s] 37%|██████████                 | 380/1014 [00:04<00:08, 76.35batch/s] 38%|██████████▍                | 390/1014 [00:05<00:08, 76.43batch/s] 39%|██████████▋                | 400/1014 [00:05<00:08, 76.32batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 76.38batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 76.70batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 76.60batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 76.74batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 76.99batch/s] 45%|████████████▏              | 460/1014 [00:05<00:07, 76.86batch/s] 46%|████████████▌              | 470/1014 [00:06<00:07, 77.05batch/s] 47%|████████████▊              | 480/1014 [00:06<00:06, 76.96batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 76.83batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 76.80batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 76.95batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 77.14batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 77.22batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:06, 77.37batch/s] 54%|██████████████▋            | 550/1014 [00:07<00:05, 77.40batch/s] 55%|██████████████▉            | 560/1014 [00:07<00:05, 77.53batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 77.16batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 77.14batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 77.00batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 77.08batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 77.08batch/s] 61%|████████████████▌          | 620/1014 [00:08<00:05, 77.24batch/s] 62%|████████████████▊          | 630/1014 [00:08<00:04, 77.17batch/s] 63%|█████████████████          | 640/1014 [00:08<00:04, 76.98batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 77.06batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 76.98batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 77.05batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 77.24batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:04, 77.38batch/s] 69%|██████████████████▋        | 700/1014 [00:09<00:04, 77.54batch/s] 70%|██████████████████▉        | 710/1014 [00:09<00:03, 77.65batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 77.13batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 77.06batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 77.18batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 77.07batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 77.12batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:03, 77.05batch/s] 77%|████████████████████▊      | 780/1014 [00:10<00:03, 77.11batch/s] 78%|█████████████████████      | 790/1014 [00:10<00:02, 77.20batch/s] 79%|█████████████████████▎     | 800/1014 [00:10<00:02, 77.33batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 77.36batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 77.52batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 77.51batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 77.60batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 77.55batch/s] 85%|██████████████████████▉    | 860/1014 [00:11<00:01, 77.62batch/s] 86%|███████████████████████▏   | 870/1014 [00:11<00:01, 77.71batch/s] 87%|███████████████████████▍   | 880/1014 [00:11<00:01, 77.74batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 77.81batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 77.85batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 77.86batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 77.92batch/s] 92%|████████████████████████▊  | 930/1014 [00:11<00:01, 78.00batch/s] 93%|█████████████████████████  | 940/1014 [00:12<00:00, 77.98batch/s] 94%|█████████████████████████▎ | 950/1014 [00:12<00:00, 78.05batch/s] 95%|█████████████████████████▌ | 960/1014 [00:12<00:00, 78.12batch/s] 96%|█████████████████████████▊ | 970/1014 [00:12<00:00, 78.16batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 78.26batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 78.20batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 78.27batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 78.24batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 78.26batch/s]
Validation 15 -> LOSS = 2.21
Validation 15 -> BLEU = 19.46, 49.4/24.4/14.1/8.4 (BP=1.000, ratio=1.008, hyp_len=12934, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.21 @ validation 15
--> Best BLEU so far: 19.46 @ validation 15
Starting Epoch 16
Epoch 16 - update       7170 => loss:   2.167 (#OOM: 0)
Epoch 16 - update       7200 => loss:   1.950 (#OOM: 0)
Epoch 16 - update       7230 => loss:   2.093 (#OOM: 0)
Epoch 16 - update       7260 => loss:   1.938 (#OOM: 0)
Epoch 16 - update       7290 => loss:   2.201 (#OOM: 0)
Epoch 16 - update       7320 => loss:   2.487 (#OOM: 0)
Epoch 16 - update       7350 => loss:   1.527 (#OOM: 0)
Epoch 16 - update       7380 => loss:   2.064 (#OOM: 0)
Epoch 16 - update       7410 => loss:   2.233 (#OOM: 0)
Epoch 16 - update       7440 => loss:   2.065 (#OOM: 0)
Epoch 16 - update       7470 => loss:   2.728 (#OOM: 0)
Epoch 16 - update       7500 => loss:   2.459 (#OOM: 0)
Epoch 16 - update       7530 => loss:   2.301 (#OOM: 0)
Epoch 16 - update       7560 => loss:   2.286 (#OOM: 0)
Epoch 16 - update       7590 => loss:   1.385 (#OOM: 0)
Epoch 16 - update       7620 => loss:   2.080 (#OOM: 0)
--> Epoch 16 finished with mean loss 2.18825
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (808 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.70batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 53.74batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 54.09batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 55.41batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 54.47batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.77batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.73batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.67batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 78.26batch/s]  3%|▋                           | 26/1014 [00:00<00:14, 66.42batch/s]  3%|▉                           | 35/1014 [00:00<00:14, 69.63batch/s]  4%|█▏                          | 44/1014 [00:00<00:13, 72.29batch/s]  5%|█▍                          | 53/1014 [00:00<00:13, 73.05batch/s]  6%|█▋                          | 62/1014 [00:00<00:12, 73.97batch/s]  7%|█▉                          | 71/1014 [00:00<00:12, 73.98batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.29batch/s]  9%|██▌                         | 91/1014 [00:01<00:11, 77.69batch/s] 10%|██▋                        | 101/1014 [00:01<00:11, 78.38batch/s] 11%|██▉                        | 111/1014 [00:01<00:11, 78.41batch/s] 12%|███▏                       | 121/1014 [00:01<00:11, 78.52batch/s] 13%|███▍                       | 131/1014 [00:01<00:11, 78.52batch/s] 14%|███▊                       | 141/1014 [00:01<00:11, 78.67batch/s] 15%|████                       | 151/1014 [00:01<00:10, 78.53batch/s] 16%|████▎                      | 161/1014 [00:02<00:10, 78.95batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 79.00batch/s] 18%|████▊                      | 181/1014 [00:02<00:10, 78.79batch/s] 19%|█████                      | 191/1014 [00:02<00:10, 78.51batch/s] 20%|█████▎                     | 201/1014 [00:02<00:10, 79.01batch/s] 21%|█████▌                     | 211/1014 [00:02<00:10, 79.52batch/s] 22%|█████▉                     | 221/1014 [00:02<00:09, 79.54batch/s] 23%|██████▏                    | 231/1014 [00:02<00:09, 79.87batch/s] 24%|██████▍                    | 241/1014 [00:03<00:09, 79.95batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 79.67batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 79.48batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 79.69batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 79.57batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 79.86batch/s] 30%|████████                   | 301/1014 [00:03<00:08, 80.22batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 79.79batch/s] 32%|████████▌                  | 321/1014 [00:04<00:08, 80.10batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 79.93batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 79.87batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 79.88batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 79.92batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 79.93batch/s] 38%|██████████▏                | 381/1014 [00:04<00:07, 80.09batch/s] 39%|██████████▍                | 391/1014 [00:04<00:07, 80.17batch/s] 40%|██████████▋                | 401/1014 [00:04<00:07, 80.25batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 79.96batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 80.06batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 80.18batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 80.25batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 80.13batch/s] 45%|████████████▎              | 461/1014 [00:05<00:06, 80.35batch/s] 46%|████████████▌              | 471/1014 [00:05<00:06, 80.15batch/s] 47%|████████████▊              | 481/1014 [00:06<00:06, 80.06batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 80.13batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 80.03batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 79.89batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 80.02batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 80.13batch/s] 53%|██████████████▍            | 541/1014 [00:06<00:05, 80.09batch/s] 54%|██████████████▋            | 551/1014 [00:06<00:05, 80.09batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 80.11batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 80.25batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 80.14batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 80.17batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 80.00batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:05, 80.03batch/s] 61%|████████████████▌          | 621/1014 [00:07<00:04, 80.14batch/s] 62%|████████████████▊          | 631/1014 [00:07<00:04, 80.17batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 80.20batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 80.34batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 80.27batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 80.28batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 80.27batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:04, 80.27batch/s] 69%|██████████████████▋        | 701/1014 [00:08<00:03, 80.38batch/s] 70%|██████████████████▉        | 711/1014 [00:08<00:03, 80.34batch/s] 71%|███████████████████▏       | 721/1014 [00:08<00:03, 80.38batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 80.56batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 80.63batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 80.77batch/s] 75%|████████████████████▎      | 761/1014 [00:09<00:03, 80.72batch/s] 76%|████████████████████▌      | 771/1014 [00:09<00:03, 80.72batch/s] 77%|████████████████████▊      | 781/1014 [00:09<00:02, 80.66batch/s] 78%|█████████████████████      | 791/1014 [00:09<00:02, 80.46batch/s] 79%|█████████████████████▎     | 801/1014 [00:09<00:02, 80.47batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 80.40batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 80.29batch/s] 82%|██████████████████████▏    | 831/1014 [00:10<00:02, 80.34batch/s] 83%|██████████████████████▍    | 841/1014 [00:10<00:02, 80.37batch/s] 84%|██████████████████████▋    | 851/1014 [00:10<00:02, 80.28batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 80.25batch/s] 86%|███████████████████████▏   | 871/1014 [00:10<00:01, 80.23batch/s] 87%|███████████████████████▍   | 881/1014 [00:10<00:01, 80.34batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 80.27batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 80.34batch/s] 90%|████████████████████████▎  | 911/1014 [00:11<00:01, 80.23batch/s] 91%|████████████████████████▌  | 921/1014 [00:11<00:01, 80.23batch/s] 92%|████████████████████████▊  | 931/1014 [00:11<00:01, 80.14batch/s] 93%|█████████████████████████  | 941/1014 [00:11<00:00, 80.24batch/s] 94%|█████████████████████████▎ | 951/1014 [00:11<00:00, 80.08batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 79.90batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 79.89batch/s] 97%|██████████████████████████ | 981/1014 [00:12<00:00, 79.93batch/s] 98%|██████████████████████████▍| 991/1014 [00:12<00:00, 79.93batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 79.89batch/s]100%|█████████████████████████▉| 1011/1014 [00:12<00:00, 79.94batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.96batch/s]
Validation 16 -> LOSS = 2.20
Validation 16 -> BLEU = 20.32, 50.2/25.3/15.0/9.0 (BP=0.999, ratio=0.999, hyp_len=12810, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.20 @ validation 16
--> Best BLEU so far: 20.32 @ validation 16
Starting Epoch 17
Epoch 17 - update       7650 => loss:   1.463 (#OOM: 0)
Epoch 17 - update       7680 => loss:   3.040 (#OOM: 0)
Epoch 17 - update       7710 => loss:   2.324 (#OOM: 0)
Epoch 17 - update       7740 => loss:   2.502 (#OOM: 0)
Epoch 17 - update       7770 => loss:   1.946 (#OOM: 0)
Epoch 17 - update       7800 => loss:   2.413 (#OOM: 0)
Epoch 17 - update       7830 => loss:   2.485 (#OOM: 0)
Epoch 17 - update       7860 => loss:   1.974 (#OOM: 0)
Epoch 17 - update       7890 => loss:   1.778 (#OOM: 0)
Epoch 17 - update       7920 => loss:   1.740 (#OOM: 0)
Epoch 17 - update       7950 => loss:   2.313 (#OOM: 0)
Epoch 17 - update       7980 => loss:   2.079 (#OOM: 0)
Epoch 17 - update       8010 => loss:   1.991 (#OOM: 0)
Epoch 17 - update       8040 => loss:   1.888 (#OOM: 0)
Epoch 17 - update       8070 => loss:   2.828 (#OOM: 0)
Epoch 17 - update       8100 => loss:   1.357 (#OOM: 0)
--> Epoch 17 finished with mean loss 2.14799
--> Overhead/Training/Evaluation: 0.03/0.53/0.00 mins (total: 0.57 mins)   (906 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.51batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.94batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.03batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.99batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 55.90batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.42batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 66.58batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 80.99batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.20batch/s]  4%|█                           | 37/1014 [00:00<00:11, 84.71batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 86.25batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 85.28batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 85.74batch/s]  8%|██▏                         | 77/1014 [00:00<00:10, 85.54batch/s]  9%|██▍                         | 87/1014 [00:01<00:10, 85.71batch/s] 10%|██▋                         | 97/1014 [00:01<00:10, 85.06batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 80.47batch/s] 12%|███                        | 117/1014 [00:01<00:11, 80.69batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 80.75batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 81.12batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 81.39batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 81.62batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 82.30batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 82.18batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 82.19batch/s] 19%|█████▏                     | 197/1014 [00:02<00:09, 81.82batch/s] 20%|█████▌                     | 207/1014 [00:02<00:09, 82.21batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 82.03batch/s] 22%|██████                     | 227/1014 [00:02<00:09, 82.13batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 82.34batch/s] 24%|██████▌                    | 247/1014 [00:02<00:09, 82.79batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 83.15batch/s] 26%|███████                    | 267/1014 [00:03<00:08, 83.45batch/s] 27%|███████▍                   | 277/1014 [00:03<00:08, 83.31batch/s] 28%|███████▋                   | 287/1014 [00:03<00:08, 83.72batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 84.13batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 84.64batch/s] 31%|████████▍                  | 319/1014 [00:03<00:08, 84.51batch/s] 33%|████████▊                  | 330/1014 [00:03<00:08, 84.31batch/s] 34%|█████████                  | 341/1014 [00:04<00:07, 84.17batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:07, 84.27batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:07, 83.93batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 84.18batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 84.07batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 84.07batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 84.53batch/s] 41%|███████████▏               | 418/1014 [00:04<00:07, 84.68batch/s] 42%|███████████▍               | 429/1014 [00:05<00:06, 84.65batch/s] 43%|███████████▋               | 440/1014 [00:05<00:06, 84.72batch/s] 44%|████████████               | 451/1014 [00:05<00:06, 84.81batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 85.01batch/s] 47%|████████████▌              | 473/1014 [00:05<00:06, 85.12batch/s] 48%|████████████▉              | 484/1014 [00:05<00:06, 85.45batch/s] 49%|█████████████▏             | 495/1014 [00:05<00:06, 85.42batch/s] 50%|█████████████▍             | 506/1014 [00:05<00:05, 85.42batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:05, 85.34batch/s] 52%|██████████████             | 528/1014 [00:06<00:05, 85.02batch/s] 53%|██████████████▎            | 539/1014 [00:06<00:05, 85.11batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 85.20batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:05, 85.31batch/s] 56%|███████████████▏           | 572/1014 [00:06<00:05, 85.30batch/s] 57%|███████████████▌           | 583/1014 [00:06<00:05, 85.35batch/s] 59%|███████████████▊           | 594/1014 [00:06<00:04, 85.35batch/s] 60%|████████████████           | 605/1014 [00:07<00:04, 85.42batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 85.33batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 85.18batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 85.05batch/s] 64%|█████████████████▎         | 649/1014 [00:07<00:04, 84.89batch/s] 65%|█████████████████▌         | 660/1014 [00:07<00:04, 84.90batch/s] 66%|█████████████████▊         | 671/1014 [00:07<00:04, 85.05batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:03, 85.24batch/s] 68%|██████████████████▍        | 693/1014 [00:08<00:03, 85.27batch/s] 69%|██████████████████▋        | 704/1014 [00:08<00:03, 85.38batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 85.39batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 85.42batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 85.54batch/s] 74%|███████████████████▉       | 748/1014 [00:08<00:03, 85.58batch/s] 75%|████████████████████▏      | 759/1014 [00:08<00:02, 85.51batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:02, 85.48batch/s] 77%|████████████████████▊      | 781/1014 [00:09<00:02, 85.45batch/s] 78%|█████████████████████      | 792/1014 [00:09<00:02, 85.57batch/s] 79%|█████████████████████▍     | 803/1014 [00:09<00:02, 85.37batch/s] 80%|█████████████████████▋     | 814/1014 [00:09<00:02, 85.40batch/s] 81%|█████████████████████▉     | 825/1014 [00:09<00:02, 85.31batch/s] 82%|██████████████████████▎    | 836/1014 [00:09<00:02, 85.35batch/s] 84%|██████████████████████▌    | 847/1014 [00:09<00:01, 85.30batch/s] 85%|██████████████████████▊    | 858/1014 [00:10<00:01, 85.33batch/s] 86%|███████████████████████▏   | 869/1014 [00:10<00:01, 85.28batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 85.28batch/s] 88%|███████████████████████▋   | 891/1014 [00:10<00:01, 85.31batch/s] 89%|████████████████████████   | 902/1014 [00:10<00:01, 85.30batch/s] 90%|████████████████████████▎  | 913/1014 [00:10<00:01, 85.29batch/s] 91%|████████████████████████▌  | 924/1014 [00:10<00:01, 85.22batch/s] 92%|████████████████████████▉  | 935/1014 [00:10<00:00, 85.27batch/s] 93%|█████████████████████████▏ | 946/1014 [00:11<00:00, 85.26batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 85.24batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 85.33batch/s] 97%|██████████████████████████ | 979/1014 [00:11<00:00, 85.36batch/s] 98%|██████████████████████████▎| 990/1014 [00:11<00:00, 85.28batch/s] 99%|█████████████████████████▋| 1001/1014 [00:11<00:00, 85.29batch/s]100%|█████████████████████████▉| 1012/1014 [00:11<00:00, 85.12batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 85.16batch/s]
Validation 17 -> LOSS = 2.21
Validation 17 -> BLEU = 19.71, 52.4/26.4/15.6/9.4 (BP=0.929, ratio=0.931, hyp_len=11948, ref_len=12828)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.20 @ validation 16
--> Best BLEU so far: 20.32 @ validation 16
Starting Epoch 18
Epoch 18 - update       8130 => loss:   1.870 (#OOM: 0)
Epoch 18 - update       8160 => loss:   2.465 (#OOM: 0)
Epoch 18 - update       8190 => loss:   2.638 (#OOM: 0)
Epoch 18 - update       8220 => loss:   2.927 (#OOM: 0)
Epoch 18 - update       8250 => loss:   1.792 (#OOM: 0)
Epoch 18 - update       8280 => loss:   1.716 (#OOM: 0)
Epoch 18 - update       8310 => loss:   1.952 (#OOM: 0)
Epoch 18 - update       8340 => loss:   1.960 (#OOM: 0)
Epoch 18 - update       8370 => loss:   1.839 (#OOM: 0)
Epoch 18 - update       8400 => loss:   1.548 (#OOM: 0)
Epoch 18 - update       8430 => loss:   2.045 (#OOM: 0)
Epoch 18 - update       8460 => loss:   1.905 (#OOM: 0)
Epoch 18 - update       8490 => loss:   2.420 (#OOM: 0)
Epoch 18 - update       8520 => loss:   1.937 (#OOM: 0)
Epoch 18 - update       8550 => loss:   1.848 (#OOM: 0)
Epoch 18 - update       8580 => loss:   1.781 (#OOM: 0)
--> Epoch 18 finished with mean loss 2.10810
--> Overhead/Training/Evaluation: 0.04/0.55/0.00 mins (total: 0.58 mins)   (879 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.67batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 58.46batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 54.95batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 56.06batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 54.06batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.22batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 83.76batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 76.92batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.03batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 79.78batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 84.14batch/s]  6%|█▌                          | 58/1014 [00:00<00:11, 84.07batch/s]  7%|█▉                          | 69/1014 [00:00<00:11, 84.27batch/s]  8%|██▏                         | 80/1014 [00:00<00:10, 85.14batch/s]  9%|██▌                         | 91/1014 [00:01<00:10, 86.09batch/s] 10%|██▋                        | 102/1014 [00:01<00:10, 85.89batch/s] 11%|███                        | 113/1014 [00:01<00:10, 85.80batch/s] 12%|███▎                       | 124/1014 [00:01<00:10, 85.14batch/s] 13%|███▌                       | 135/1014 [00:01<00:10, 84.93batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 84.09batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 83.89batch/s] 17%|████▍                      | 168/1014 [00:01<00:10, 84.42batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 83.37batch/s] 19%|█████                      | 190/1014 [00:02<00:09, 83.29batch/s] 20%|█████▎                     | 201/1014 [00:02<00:09, 82.79batch/s] 21%|█████▋                     | 212/1014 [00:02<00:09, 82.85batch/s] 22%|█████▉                     | 223/1014 [00:02<00:09, 83.02batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 83.21batch/s] 24%|██████▌                    | 245/1014 [00:02<00:09, 82.96batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 83.21batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 82.83batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 82.30batch/s] 29%|███████▋                   | 289/1014 [00:03<00:08, 81.93batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 82.29batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 81.96batch/s] 32%|████████▌                  | 322/1014 [00:03<00:08, 82.06batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 82.30batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 82.32batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 82.03batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:07, 82.05batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 81.92batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 81.90batch/s] 39%|██████████▌                | 399/1014 [00:04<00:07, 81.62batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 81.56batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 81.45batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 81.43batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 81.55batch/s] 45%|████████████               | 454/1014 [00:05<00:06, 81.64batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 81.74batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 81.93batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 82.13batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 81.78batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 81.57batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 81.61batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:05, 81.47batch/s] 53%|██████████████▍            | 542/1014 [00:06<00:05, 81.31batch/s] 55%|██████████████▋            | 553/1014 [00:06<00:05, 81.09batch/s] 56%|███████████████            | 564/1014 [00:06<00:05, 81.02batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 81.09batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 81.09batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 80.95batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 80.82batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:04, 80.87batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 80.75batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 80.80batch/s] 64%|█████████████████▎         | 652/1014 [00:08<00:04, 80.82batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 80.61batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 80.65batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 80.77batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:03, 80.94batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 80.71batch/s] 71%|███████████████████        | 718/1014 [00:08<00:03, 80.81batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 80.69batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 80.82batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 80.75batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 80.79batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:02, 80.82batch/s] 77%|████████████████████▉      | 784/1014 [00:09<00:02, 80.83batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 81.03batch/s] 79%|█████████████████████▍     | 806/1014 [00:09<00:02, 80.83batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 80.71batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 80.58batch/s] 83%|██████████████████████▎    | 839/1014 [00:10<00:02, 80.69batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 80.74batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 80.63batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 80.73batch/s] 87%|███████████████████████▌   | 883/1014 [00:10<00:01, 80.62batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 80.60batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 80.56batch/s] 90%|████████████████████████▍  | 916/1014 [00:11<00:01, 80.44batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 80.40batch/s] 93%|████████████████████████▉  | 938/1014 [00:11<00:00, 80.41batch/s] 94%|█████████████████████████▎ | 949/1014 [00:11<00:00, 80.38batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 80.43batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 80.48batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 80.55batch/s] 98%|██████████████████████████▍| 993/1014 [00:12<00:00, 80.61batch/s] 99%|█████████████████████████▋| 1004/1014 [00:12<00:00, 80.69batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.69batch/s]
Validation 18 -> LOSS = 2.19
Validation 18 -> BLEU = 20.51, 51.3/25.8/15.3/9.4 (BP=0.983, ratio=0.983, hyp_len=12611, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.19 @ validation 18
--> Best BLEU so far: 20.51 @ validation 18
Starting Epoch 19
Epoch 19 - update       8610 => loss:   2.606 (#OOM: 0)
Epoch 19 - update       8640 => loss:   1.941 (#OOM: 0)
Epoch 19 - update       8670 => loss:   2.515 (#OOM: 0)
Epoch 19 - update       8700 => loss:   2.005 (#OOM: 0)
Epoch 19 - update       8730 => loss:   2.163 (#OOM: 0)
Epoch 19 - update       8760 => loss:   2.463 (#OOM: 0)
Epoch 19 - update       8790 => loss:   2.464 (#OOM: 0)
Epoch 19 - update       8820 => loss:   1.873 (#OOM: 0)
Epoch 19 - update       8850 => loss:   1.544 (#OOM: 0)
Epoch 19 - update       8880 => loss:   1.719 (#OOM: 0)
Epoch 19 - update       8910 => loss:   2.734 (#OOM: 0)
Epoch 19 - update       8940 => loss:   2.413 (#OOM: 0)
Epoch 19 - update       8970 => loss:   1.448 (#OOM: 0)
Epoch 19 - update       9000 => loss:   1.829 (#OOM: 0)
Epoch 19 - update       9030 => loss:   2.072 (#OOM: 0)
Epoch 19 - update       9060 => loss:   2.026 (#OOM: 0)
--> Epoch 19 finished with mean loss 2.07533
--> Overhead/Training/Evaluation: 0.03/0.51/0.00 mins (total: 0.54 mins)   (947 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.35batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 54.46batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 56.75batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 56.92batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 55.77batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.51batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 88.73batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 82.68batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 82.13batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 80.29batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 81.26batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 79.44batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.67batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 79.26batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 79.03batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 79.66batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 80.12batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 79.44batch/s] 12%|███                        | 117/1014 [00:01<00:11, 78.60batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 79.08batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 79.59batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 79.01batch/s] 15%|████                       | 153/1014 [00:01<00:10, 79.02batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 78.64batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 78.45batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 78.62batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 78.93batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 79.25batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 78.98batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 79.31batch/s] 22%|█████▉                     | 225/1014 [00:02<00:09, 79.12batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 79.10batch/s] 24%|██████▍                    | 243/1014 [00:03<00:09, 79.01batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 78.95batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 78.93batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 78.71batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 78.67batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 78.72batch/s] 29%|███████▉                   | 297/1014 [00:03<00:09, 78.82batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 78.70batch/s] 31%|████████▍                  | 315/1014 [00:04<00:08, 78.70batch/s] 32%|████████▋                  | 324/1014 [00:04<00:08, 78.65batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 78.44batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 78.02batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 77.87batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 78.03batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:08, 78.12batch/s] 37%|██████████                 | 378/1014 [00:04<00:08, 78.29batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 78.64batch/s] 39%|██████████▌                | 398/1014 [00:05<00:07, 78.92batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 79.03batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 79.09batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 79.18batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 79.31batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 79.19batch/s] 45%|████████████▏              | 458/1014 [00:05<00:07, 79.01batch/s] 46%|████████████▍              | 468/1014 [00:05<00:06, 79.00batch/s] 47%|████████████▋              | 478/1014 [00:06<00:06, 79.05batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 79.21batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 79.13batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 79.34batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 79.35batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 79.29batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:05, 79.43batch/s] 54%|██████████████▌            | 548/1014 [00:06<00:05, 79.35batch/s] 55%|██████████████▊            | 558/1014 [00:07<00:05, 79.17batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 79.22batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 79.29batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 79.29batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 79.48batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 79.47batch/s] 61%|████████████████▍          | 618/1014 [00:07<00:04, 79.46batch/s] 62%|████████████████▋          | 628/1014 [00:07<00:04, 79.45batch/s] 63%|████████████████▉          | 638/1014 [00:08<00:04, 79.44batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 79.37batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 79.50batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 79.41batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 79.35batch/s] 68%|██████████████████▎        | 688/1014 [00:08<00:04, 79.52batch/s] 69%|██████████████████▌        | 698/1014 [00:08<00:03, 79.59batch/s] 70%|██████████████████▊        | 708/1014 [00:08<00:03, 79.69batch/s] 71%|███████████████████        | 718/1014 [00:09<00:03, 79.77batch/s] 72%|███████████████████▍       | 729/1014 [00:09<00:03, 80.03batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 79.96batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 80.03batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 79.99batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:03, 80.15batch/s] 77%|████████████████████▉      | 784/1014 [00:09<00:02, 80.24batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 80.25batch/s] 79%|█████████████████████▍     | 806/1014 [00:10<00:02, 80.25batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 80.23batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 80.24batch/s] 83%|██████████████████████▎    | 839/1014 [00:10<00:02, 80.20batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 80.25batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 80.37batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 80.29batch/s] 87%|███████████████████████▌   | 883/1014 [00:10<00:01, 80.32batch/s] 88%|███████████████████████▊   | 894/1014 [00:11<00:01, 80.19batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 80.24batch/s] 90%|████████████████████████▍  | 916/1014 [00:11<00:01, 80.20batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 80.15batch/s] 93%|████████████████████████▉  | 938/1014 [00:11<00:00, 80.08batch/s] 94%|█████████████████████████▎ | 949/1014 [00:11<00:00, 80.10batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 80.05batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 79.91batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 80.01batch/s] 98%|██████████████████████████▍| 993/1014 [00:12<00:00, 79.98batch/s] 99%|█████████████████████████▋| 1004/1014 [00:12<00:00, 79.99batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.00batch/s]
Validation 19 -> LOSS = 2.18
Validation 19 -> BLEU = 19.96, 49.9/24.8/14.6/8.8 (BP=1.000, ratio=1.009, hyp_len=12947, ref_len=12828)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 19
--> Best BLEU so far: 20.51 @ validation 18
Starting Epoch 20
Epoch 20 - update       9090 => loss:   1.773 (#OOM: 0)
Epoch 20 - update       9120 => loss:   1.989 (#OOM: 0)
Epoch 20 - update       9150 => loss:   1.917 (#OOM: 0)
Epoch 20 - update       9180 => loss:   1.543 (#OOM: 0)
Epoch 20 - update       9210 => loss:   1.493 (#OOM: 0)
Epoch 20 - update       9240 => loss:   2.392 (#OOM: 0)
Epoch 20 - update       9270 => loss:   1.062 (#OOM: 0)
Epoch 20 - update       9300 => loss:   2.236 (#OOM: 0)
Epoch 20 - update       9330 => loss:   1.968 (#OOM: 0)
Epoch 20 - update       9360 => loss:   2.627 (#OOM: 0)
Epoch 20 - update       9390 => loss:   2.165 (#OOM: 0)
Epoch 20 - update       9420 => loss:   2.184 (#OOM: 0)
Epoch 20 - update       9450 => loss:   2.136 (#OOM: 0)
Epoch 20 - update       9480 => loss:   2.402 (#OOM: 0)
Epoch 20 - update       9510 => loss:   1.833 (#OOM: 0)
Epoch 20 - update       9540 => loss:   1.726 (#OOM: 0)
--> Epoch 20 finished with mean loss 2.04289
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.60 mins)   (853 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.65batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.18batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.25batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.99batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.24batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.30batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 87.20batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 87.99batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 86.96batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 87.53batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 86.76batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 84.84batch/s]  6%|█▊                          | 64/1014 [00:00<00:11, 86.09batch/s]  7%|██                          | 74/1014 [00:00<00:10, 86.91batch/s]  8%|██▎                         | 84/1014 [00:00<00:10, 86.92batch/s]  9%|██▌                         | 94/1014 [00:01<00:10, 86.21batch/s] 10%|██▊                        | 104/1014 [00:01<00:10, 85.30batch/s] 11%|███                        | 114/1014 [00:01<00:10, 86.04batch/s] 12%|███▎                       | 124/1014 [00:01<00:10, 85.96batch/s] 13%|███▌                       | 134/1014 [00:01<00:10, 85.59batch/s] 14%|███▊                       | 144/1014 [00:01<00:10, 85.78batch/s] 15%|████                       | 154/1014 [00:01<00:10, 85.31batch/s] 16%|████▎                      | 164/1014 [00:01<00:09, 85.48batch/s] 17%|████▋                      | 174/1014 [00:02<00:09, 85.28batch/s] 18%|████▉                      | 184/1014 [00:02<00:09, 85.60batch/s] 19%|█████▏                     | 194/1014 [00:02<00:09, 85.26batch/s] 20%|█████▍                     | 204/1014 [00:02<00:09, 84.69batch/s] 21%|█████▋                     | 214/1014 [00:02<00:09, 84.82batch/s] 22%|█████▉                     | 224/1014 [00:02<00:09, 84.30batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 83.76batch/s] 24%|██████▍                    | 244/1014 [00:02<00:09, 83.98batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 84.18batch/s] 26%|███████                    | 264/1014 [00:03<00:08, 83.77batch/s] 27%|███████▎                   | 274/1014 [00:03<00:08, 83.57batch/s] 28%|███████▌                   | 284/1014 [00:03<00:08, 83.27batch/s] 29%|███████▊                   | 294/1014 [00:03<00:08, 83.17batch/s] 30%|████████                   | 304/1014 [00:03<00:08, 83.09batch/s] 31%|████████▍                  | 315/1014 [00:03<00:08, 83.63batch/s] 32%|████████▋                  | 326/1014 [00:03<00:08, 83.71batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 84.07batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:07, 84.01batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:07, 84.10batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:07, 83.79batch/s] 38%|██████████▏                | 381/1014 [00:04<00:07, 83.57batch/s] 39%|██████████▍                | 392/1014 [00:04<00:07, 83.66batch/s] 40%|██████████▋                | 403/1014 [00:04<00:07, 83.46batch/s] 41%|███████████                | 414/1014 [00:04<00:07, 83.30batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 83.30batch/s] 43%|███████████▌               | 436/1014 [00:05<00:06, 83.21batch/s] 44%|███████████▉               | 447/1014 [00:05<00:06, 83.37batch/s] 45%|████████████▏              | 458/1014 [00:05<00:06, 83.47batch/s] 46%|████████████▍              | 469/1014 [00:05<00:06, 83.45batch/s] 47%|████████████▊              | 480/1014 [00:05<00:06, 83.59batch/s] 48%|█████████████              | 491/1014 [00:05<00:06, 83.58batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 83.37batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:05, 83.52batch/s] 52%|█████████████▉             | 524/1014 [00:06<00:05, 83.71batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:05, 83.74batch/s] 54%|██████████████▌            | 546/1014 [00:06<00:05, 83.65batch/s] 55%|██████████████▊            | 557/1014 [00:06<00:05, 83.44batch/s] 56%|███████████████            | 568/1014 [00:06<00:05, 83.67batch/s] 57%|███████████████▍           | 579/1014 [00:06<00:05, 83.55batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 83.57batch/s] 59%|████████████████           | 601/1014 [00:07<00:04, 83.35batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:04, 83.45batch/s] 61%|████████████████▌          | 623/1014 [00:07<00:04, 83.45batch/s] 63%|████████████████▉          | 634/1014 [00:07<00:04, 83.50batch/s] 64%|█████████████████▏         | 645/1014 [00:07<00:04, 83.58batch/s] 65%|█████████████████▍         | 656/1014 [00:07<00:04, 83.68batch/s] 66%|█████████████████▊         | 667/1014 [00:07<00:04, 83.80batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 83.87batch/s] 68%|██████████████████▎        | 689/1014 [00:08<00:03, 83.73batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 83.66batch/s] 70%|██████████████████▉        | 711/1014 [00:08<00:03, 83.61batch/s] 71%|███████████████████▏       | 722/1014 [00:08<00:03, 83.86batch/s] 72%|███████████████████▌       | 733/1014 [00:08<00:03, 83.87batch/s] 73%|███████████████████▊       | 744/1014 [00:08<00:03, 83.87batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 83.83batch/s] 76%|████████████████████▍      | 766/1014 [00:09<00:02, 83.95batch/s] 77%|████████████████████▋      | 777/1014 [00:09<00:02, 84.00batch/s] 78%|████████████████████▉      | 788/1014 [00:09<00:02, 84.12batch/s] 79%|█████████████████████▎     | 799/1014 [00:09<00:02, 84.16batch/s] 80%|█████████████████████▌     | 810/1014 [00:09<00:02, 84.05batch/s] 81%|█████████████████████▊     | 821/1014 [00:09<00:02, 84.02batch/s] 82%|██████████████████████▏    | 832/1014 [00:09<00:02, 83.93batch/s] 83%|██████████████████████▍    | 843/1014 [00:10<00:02, 84.04batch/s] 84%|██████████████████████▋    | 854/1014 [00:10<00:01, 84.11batch/s] 85%|███████████████████████    | 865/1014 [00:10<00:01, 84.20batch/s] 86%|███████████████████████▎   | 876/1014 [00:10<00:01, 84.10batch/s] 87%|███████████████████████▌   | 887/1014 [00:10<00:01, 84.17batch/s] 89%|███████████████████████▉   | 898/1014 [00:10<00:01, 84.25batch/s] 90%|████████████████████████▏  | 909/1014 [00:10<00:01, 84.42batch/s] 91%|████████████████████████▍  | 920/1014 [00:10<00:01, 84.56batch/s] 92%|████████████████████████▊  | 931/1014 [00:11<00:00, 84.55batch/s] 93%|█████████████████████████  | 942/1014 [00:11<00:00, 84.61batch/s] 94%|█████████████████████████▍ | 953/1014 [00:11<00:00, 84.60batch/s] 95%|█████████████████████████▋ | 964/1014 [00:11<00:00, 84.57batch/s] 96%|█████████████████████████▉ | 975/1014 [00:11<00:00, 84.50batch/s] 97%|██████████████████████████▎| 986/1014 [00:11<00:00, 84.45batch/s] 98%|██████████████████████████▌| 997/1014 [00:11<00:00, 84.41batch/s] 99%|█████████████████████████▊| 1008/1014 [00:11<00:00, 84.41batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 84.28batch/s]
Validation 20 -> LOSS = 2.20
Validation 20 -> BLEU = 19.65, 51.8/25.9/15.4/9.4 (BP=0.937, ratio=0.939, hyp_len=12043, ref_len=12828)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 19
--> Best BLEU so far: 20.51 @ validation 18
Starting Epoch 21
Epoch 21 - update       9570 => loss:   1.621 (#OOM: 0)
Epoch 21 - update       9600 => loss:   1.720 (#OOM: 0)
Epoch 21 - update       9630 => loss:   1.701 (#OOM: 0)
Epoch 21 - update       9660 => loss:   1.667 (#OOM: 0)
Epoch 21 - update       9690 => loss:   2.515 (#OOM: 0)
Epoch 21 - update       9720 => loss:   2.376 (#OOM: 0)
Epoch 21 - update       9750 => loss:   2.209 (#OOM: 0)
Epoch 21 - update       9780 => loss:   1.773 (#OOM: 0)
Epoch 21 - update       9810 => loss:   1.072 (#OOM: 0)
Epoch 21 - update       9840 => loss:   2.611 (#OOM: 0)
Epoch 21 - update       9870 => loss:   1.744 (#OOM: 0)
Epoch 21 - update       9900 => loss:   1.929 (#OOM: 0)
Epoch 21 - update       9930 => loss:   1.380 (#OOM: 0)
Epoch 21 - update       9960 => loss:   1.865 (#OOM: 0)
Epoch 21 - update       9990 => loss:   1.787 (#OOM: 0)
--> Epoch 21 finished with mean loss 2.01171
--> Overhead/Training/Evaluation: 0.03/0.52/0.00 mins (total: 0.56 mins)   (923 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.59batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.01batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 57.19batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 55.27batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 55.89batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.31batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 87.33batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 81.33batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 86.52batch/s]  4%|█                           | 38/1014 [00:00<00:11, 85.88batch/s]  5%|█▎                          | 48/1014 [00:00<00:11, 84.82batch/s]  6%|█▌                          | 58/1014 [00:00<00:11, 84.41batch/s]  7%|█▉                          | 68/1014 [00:00<00:11, 84.51batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 84.61batch/s]  9%|██▍                         | 88/1014 [00:01<00:10, 84.67batch/s] 10%|██▋                         | 98/1014 [00:01<00:10, 84.90batch/s] 11%|██▉                        | 108/1014 [00:01<00:10, 84.79batch/s] 12%|███▏                       | 118/1014 [00:01<00:10, 85.26batch/s] 13%|███▍                       | 128/1014 [00:01<00:10, 85.39batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 85.76batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 85.96batch/s] 16%|████▏                      | 158/1014 [00:01<00:09, 85.75batch/s] 17%|████▍                      | 168/1014 [00:01<00:09, 85.98batch/s] 18%|████▋                      | 178/1014 [00:02<00:09, 86.36batch/s] 19%|█████                      | 188/1014 [00:02<00:09, 86.12batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 85.69batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 86.14batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 85.87batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 85.92batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 85.59batch/s] 24%|██████▌                    | 248/1014 [00:02<00:08, 85.35batch/s] 25%|██████▊                    | 258/1014 [00:03<00:08, 84.60batch/s] 26%|███████▏                   | 268/1014 [00:03<00:08, 84.67batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 84.52batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 84.13batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 84.16batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 84.16batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 84.24batch/s] 32%|████████▋                  | 328/1014 [00:03<00:08, 84.11batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 84.19batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:07, 84.24batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:07, 84.18batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 83.83batch/s] 37%|██████████                 | 378/1014 [00:04<00:07, 83.61batch/s] 38%|██████████▎                | 389/1014 [00:04<00:07, 84.05batch/s] 39%|██████████▋                | 400/1014 [00:04<00:07, 84.42batch/s] 41%|██████████▉                | 411/1014 [00:04<00:07, 84.39batch/s] 42%|███████████▏               | 422/1014 [00:04<00:07, 84.49batch/s] 43%|███████████▌               | 433/1014 [00:05<00:06, 84.28batch/s] 44%|███████████▊               | 444/1014 [00:05<00:06, 84.52batch/s] 45%|████████████               | 455/1014 [00:05<00:06, 84.33batch/s] 46%|████████████▍              | 466/1014 [00:05<00:06, 84.44batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 84.41batch/s] 48%|████████████▉              | 488/1014 [00:05<00:06, 84.04batch/s] 49%|█████████████▎             | 499/1014 [00:05<00:06, 83.93batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 83.78batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:05, 83.57batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:05, 83.58batch/s] 54%|██████████████▍            | 543/1014 [00:06<00:05, 83.58batch/s] 55%|██████████████▊            | 554/1014 [00:06<00:05, 83.67batch/s] 56%|███████████████            | 565/1014 [00:06<00:05, 83.50batch/s] 57%|███████████████▎           | 576/1014 [00:06<00:05, 83.50batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 83.48batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:04, 83.53batch/s] 60%|████████████████▏          | 609/1014 [00:07<00:04, 83.49batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 83.55batch/s] 62%|████████████████▊          | 631/1014 [00:07<00:04, 83.54batch/s] 63%|█████████████████          | 642/1014 [00:07<00:04, 83.62batch/s] 64%|█████████████████▍         | 653/1014 [00:07<00:04, 83.78batch/s] 65%|█████████████████▋         | 664/1014 [00:07<00:04, 84.04batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 83.98batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:03, 83.94batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:03, 84.12batch/s] 70%|██████████████████▊        | 708/1014 [00:08<00:03, 84.20batch/s] 71%|███████████████████▏       | 719/1014 [00:08<00:03, 84.28batch/s] 72%|███████████████████▍       | 730/1014 [00:08<00:03, 84.21batch/s] 73%|███████████████████▋       | 741/1014 [00:08<00:03, 84.32batch/s] 74%|████████████████████       | 752/1014 [00:08<00:03, 84.21batch/s] 75%|████████████████████▎      | 763/1014 [00:09<00:02, 84.27batch/s] 76%|████████████████████▌      | 774/1014 [00:09<00:02, 84.30batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 84.29batch/s] 79%|█████████████████████▏     | 796/1014 [00:09<00:02, 84.32batch/s] 80%|█████████████████████▍     | 807/1014 [00:09<00:02, 84.34batch/s] 81%|█████████████████████▊     | 818/1014 [00:09<00:02, 84.37batch/s] 82%|██████████████████████     | 829/1014 [00:09<00:02, 84.25batch/s] 83%|██████████████████████▎    | 840/1014 [00:09<00:02, 84.26batch/s] 84%|██████████████████████▋    | 851/1014 [00:10<00:01, 84.20batch/s] 85%|██████████████████████▉    | 862/1014 [00:10<00:01, 84.11batch/s] 86%|███████████████████████▏   | 873/1014 [00:10<00:01, 84.24batch/s] 87%|███████████████████████▌   | 884/1014 [00:10<00:01, 84.23batch/s] 88%|███████████████████████▊   | 895/1014 [00:10<00:01, 84.25batch/s] 89%|████████████████████████   | 906/1014 [00:10<00:01, 84.39batch/s] 90%|████████████████████████▍  | 917/1014 [00:10<00:01, 84.36batch/s] 92%|████████████████████████▋  | 928/1014 [00:11<00:01, 84.36batch/s] 93%|█████████████████████████  | 939/1014 [00:11<00:00, 84.30batch/s] 94%|█████████████████████████▎ | 950/1014 [00:11<00:00, 84.15batch/s] 95%|█████████████████████████▌ | 961/1014 [00:11<00:00, 84.09batch/s] 96%|█████████████████████████▉ | 972/1014 [00:11<00:00, 84.09batch/s] 97%|██████████████████████████▏| 983/1014 [00:11<00:00, 84.09batch/s] 98%|██████████████████████████▍| 994/1014 [00:11<00:00, 84.13batch/s] 99%|█████████████████████████▊| 1005/1014 [00:11<00:00, 84.05batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 84.14batch/s]
Validation 21 -> LOSS = 2.19
Validation 21 -> BLEU = 20.08, 52.3/26.6/15.9/9.8 (BP=0.931, ratio=0.933, hyp_len=11972, ref_len=12828)
** Learning rate changed -> 0.0002
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 19
--> Best BLEU so far: 20.51 @ validation 18
Starting Epoch 22
Epoch 22 - update      10020 => loss:   1.833 (#OOM: 0)
Epoch 22 - update      10050 => loss:   1.217 (#OOM: 0)
Epoch 22 - update      10080 => loss:   0.992 (#OOM: 0)
Epoch 22 - update      10110 => loss:   1.624 (#OOM: 0)
Epoch 22 - update      10140 => loss:   1.597 (#OOM: 0)
Epoch 22 - update      10170 => loss:   1.751 (#OOM: 0)
Epoch 22 - update      10200 => loss:   2.663 (#OOM: 0)
Epoch 22 - update      10230 => loss:   1.703 (#OOM: 0)
Epoch 22 - update      10260 => loss:   1.874 (#OOM: 0)
Epoch 22 - update      10290 => loss:   2.154 (#OOM: 0)
Epoch 22 - update      10320 => loss:   2.137 (#OOM: 0)
Epoch 22 - update      10350 => loss:   1.594 (#OOM: 0)
Epoch 22 - update      10380 => loss:   2.077 (#OOM: 0)
Epoch 22 - update      10410 => loss:   2.049 (#OOM: 0)
Epoch 22 - update      10440 => loss:   2.064 (#OOM: 0)
Epoch 22 - update      10470 => loss:   1.769 (#OOM: 0)
--> Epoch 22 finished with mean loss 1.94320
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (835 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.81batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 45.25batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.11batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 47.88batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.51batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.73batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.18batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 81.29batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.47batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 76.06batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.69batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 75.55batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.18batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 78.03batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 78.28batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 79.11batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 80.31batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 81.36batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 82.01batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 81.64batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 81.56batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 82.10batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 81.69batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 81.48batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 81.26batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 80.95batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 81.22batch/s] 21%|█████▌                     | 210/1014 [00:02<00:09, 81.08batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 81.11batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 81.56batch/s] 24%|██████▍                    | 240/1014 [00:02<00:09, 81.38batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 81.33batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 80.95batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 81.04batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 81.28batch/s] 29%|███████▋                   | 290/1014 [00:03<00:08, 81.08batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 81.14batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 81.20batch/s] 32%|████████▌                  | 320/1014 [00:03<00:08, 81.62batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 81.66batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 81.79batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 81.84batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:07, 81.85batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:07, 81.93batch/s] 37%|██████████                 | 380/1014 [00:04<00:07, 81.75batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 81.72batch/s] 39%|██████████▋                | 400/1014 [00:04<00:07, 81.88batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 81.97batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 82.21batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 82.13batch/s] 43%|███████████▋               | 440/1014 [00:05<00:06, 82.29batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 82.09batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 82.21batch/s] 46%|████████████▌              | 470/1014 [00:05<00:06, 81.85batch/s] 47%|████████████▊              | 480/1014 [00:05<00:06, 81.96batch/s] 48%|█████████████              | 490/1014 [00:05<00:06, 81.97batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 81.90batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 82.01batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 82.08batch/s] 52%|██████████████             | 530/1014 [00:06<00:05, 81.80batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:05, 81.58batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 81.61batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 81.68batch/s] 56%|███████████████▏           | 570/1014 [00:06<00:05, 81.86batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 81.93batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 81.82batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 81.95batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 81.74batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 81.76batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 81.87batch/s] 63%|█████████████████          | 640/1014 [00:07<00:04, 81.70batch/s] 64%|█████████████████▎         | 650/1014 [00:07<00:04, 81.85batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 81.96batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 81.91batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 81.69batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:03, 81.56batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 81.61batch/s] 70%|██████████████████▉        | 710/1014 [00:08<00:03, 81.67batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 81.82batch/s] 72%|███████████████████▍       | 730/1014 [00:08<00:03, 81.78batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 81.75batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 81.71batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 81.60batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:02, 81.62batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 81.64batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 81.60batch/s] 79%|█████████████████████▎     | 800/1014 [00:09<00:02, 81.56batch/s] 80%|█████████████████████▌     | 810/1014 [00:09<00:02, 81.68batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 81.75batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 81.79batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 81.90batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 81.78batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 81.94batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 81.91batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 81.96batch/s] 88%|███████████████████████▋   | 890/1014 [00:10<00:01, 82.00batch/s] 89%|███████████████████████▉   | 900/1014 [00:10<00:01, 81.99batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 81.99batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 82.06batch/s] 92%|████████████████████████▊  | 930/1014 [00:11<00:01, 82.08batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 82.02batch/s] 94%|█████████████████████████▎ | 950/1014 [00:11<00:00, 81.86batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 81.78batch/s] 96%|█████████████████████████▊ | 970/1014 [00:11<00:00, 81.69batch/s] 97%|██████████████████████████ | 980/1014 [00:11<00:00, 81.68batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 81.73batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 81.68batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 81.75batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.73batch/s]
Validation 22 -> LOSS = 2.18
Validation 22 -> BLEU = 20.79, 51.4/26.3/15.7/9.6 (BP=0.979, ratio=0.979, hyp_len=12559, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.79 @ validation 22
Starting Epoch 23
Epoch 23 - update      10500 => loss:   1.767 (#OOM: 0)
Epoch 23 - update      10530 => loss:   1.849 (#OOM: 0)
Epoch 23 - update      10560 => loss:   2.548 (#OOM: 0)
Epoch 23 - update      10590 => loss:   2.174 (#OOM: 0)
Epoch 23 - update      10620 => loss:   1.456 (#OOM: 0)
Epoch 23 - update      10650 => loss:   1.533 (#OOM: 0)
Epoch 23 - update      10680 => loss:   2.009 (#OOM: 0)
Epoch 23 - update      10710 => loss:   1.569 (#OOM: 0)
Epoch 23 - update      10740 => loss:   1.631 (#OOM: 0)
Epoch 23 - update      10770 => loss:   1.668 (#OOM: 0)
Epoch 23 - update      10800 => loss:   1.743 (#OOM: 0)
Epoch 23 - update      10830 => loss:   1.533 (#OOM: 0)
Epoch 23 - update      10860 => loss:   1.776 (#OOM: 0)
Epoch 23 - update      10890 => loss:   1.503 (#OOM: 0)
Epoch 23 - update      10920 => loss:   1.858 (#OOM: 0)
Epoch 23 - update      10950 => loss:   1.366 (#OOM: 0)
--> Epoch 23 finished with mean loss 1.91614
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (845 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 11%|███▌                           | 4/35 [00:00<00:00, 37.85batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.89batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.50batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 53.02batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 53.19batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.73batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.46batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.17batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 85.33batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 80.59batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 81.80batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 82.14batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 82.52batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 80.65batch/s]  8%|██▏                         | 81/1014 [00:00<00:11, 81.12batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 80.46batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 81.25batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 81.34batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 81.01batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 81.95batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 82.68batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 82.66batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 82.41batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 82.25batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 82.68batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 82.22batch/s] 20%|█████▎                     | 200/1014 [00:02<00:09, 82.36batch/s] 21%|█████▌                     | 210/1014 [00:02<00:09, 82.15batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 82.13batch/s] 23%|██████▏                    | 231/1014 [00:02<00:09, 82.88batch/s] 24%|██████▍                    | 242/1014 [00:02<00:09, 83.14batch/s] 25%|██████▋                    | 253/1014 [00:03<00:09, 82.87batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 83.32batch/s] 27%|███████▎                   | 275/1014 [00:03<00:08, 83.14batch/s] 28%|███████▌                   | 286/1014 [00:03<00:08, 83.50batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 83.96batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 83.92batch/s] 31%|████████▍                  | 319/1014 [00:03<00:08, 83.67batch/s] 33%|████████▊                  | 330/1014 [00:03<00:08, 83.73batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 83.64batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:07, 83.79batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:07, 83.50batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 83.24batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 83.31batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 83.50batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 83.54batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 82.26batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 82.10batch/s] 43%|███████████▋               | 440/1014 [00:05<00:06, 82.12batch/s] 44%|████████████               | 451/1014 [00:05<00:06, 82.26batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 82.45batch/s] 47%|████████████▌              | 473/1014 [00:05<00:06, 82.69batch/s] 48%|████████████▉              | 484/1014 [00:05<00:06, 82.74batch/s] 49%|█████████████▏             | 495/1014 [00:05<00:06, 82.69batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 82.76batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 82.64batch/s] 52%|██████████████             | 528/1014 [00:06<00:05, 82.74batch/s] 53%|██████████████▎            | 539/1014 [00:06<00:05, 82.74batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 82.82batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:05, 82.80batch/s] 56%|███████████████▏           | 572/1014 [00:06<00:05, 82.72batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 82.84batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 83.07batch/s] 60%|████████████████           | 605/1014 [00:07<00:04, 83.00batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 83.07batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 83.08batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 82.98batch/s] 64%|█████████████████▎         | 649/1014 [00:07<00:04, 82.74batch/s] 65%|█████████████████▌         | 660/1014 [00:07<00:04, 82.81batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 82.59batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 82.62batch/s] 68%|██████████████████▍        | 693/1014 [00:08<00:03, 82.53batch/s] 69%|██████████████████▋        | 704/1014 [00:08<00:03, 82.39batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 82.44batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 82.41batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 82.42batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 82.47batch/s] 75%|████████████████████▏      | 759/1014 [00:09<00:03, 82.49batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:02, 82.39batch/s] 77%|████████████████████▊      | 781/1014 [00:09<00:02, 82.44batch/s] 78%|█████████████████████      | 792/1014 [00:09<00:02, 82.49batch/s] 79%|█████████████████████▍     | 803/1014 [00:09<00:02, 82.52batch/s] 80%|█████████████████████▋     | 814/1014 [00:09<00:02, 82.44batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 82.45batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 82.39batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 82.44batch/s] 85%|██████████████████████▊    | 858/1014 [00:10<00:01, 82.54batch/s] 86%|███████████████████████▏   | 869/1014 [00:10<00:01, 82.55batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 82.59batch/s] 88%|███████████████████████▋   | 891/1014 [00:10<00:01, 82.64batch/s] 89%|████████████████████████   | 902/1014 [00:10<00:01, 82.64batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 82.65batch/s] 91%|████████████████████████▌  | 924/1014 [00:11<00:01, 82.71batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 82.74batch/s] 93%|█████████████████████████▏ | 946/1014 [00:11<00:00, 82.75batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 82.84batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 82.87batch/s] 97%|██████████████████████████ | 979/1014 [00:11<00:00, 82.91batch/s] 98%|██████████████████████████▎| 990/1014 [00:11<00:00, 82.91batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 82.91batch/s]100%|█████████████████████████▉| 1012/1014 [00:12<00:00, 82.95batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.90batch/s]
Validation 23 -> LOSS = 2.19
Validation 23 -> BLEU = 20.68, 52.0/26.6/15.9/9.8 (BP=0.960, ratio=0.961, hyp_len=12324, ref_len=12828)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.79 @ validation 22
Starting Epoch 24
Epoch 24 - update      10980 => loss:   1.986 (#OOM: 0)
Epoch 24 - update      11010 => loss:   1.848 (#OOM: 0)
Epoch 24 - update      11040 => loss:   1.903 (#OOM: 0)
Epoch 24 - update      11070 => loss:   1.606 (#OOM: 0)
Epoch 24 - update      11100 => loss:   2.405 (#OOM: 0)
Epoch 24 - update      11130 => loss:   1.548 (#OOM: 0)
Epoch 24 - update      11160 => loss:   1.752 (#OOM: 0)
Epoch 24 - update      11190 => loss:   1.589 (#OOM: 0)
Epoch 24 - update      11220 => loss:   1.487 (#OOM: 0)
Epoch 24 - update      11250 => loss:   1.759 (#OOM: 0)
Epoch 24 - update      11280 => loss:   1.312 (#OOM: 0)
Epoch 24 - update      11310 => loss:   1.855 (#OOM: 0)
Epoch 24 - update      11340 => loss:   2.322 (#OOM: 0)
Epoch 24 - update      11370 => loss:   2.151 (#OOM: 0)
Epoch 24 - update      11400 => loss:   2.175 (#OOM: 0)
Epoch 24 - update      11430 => loss:   2.060 (#OOM: 0)
--> Epoch 24 finished with mean loss 1.89809
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.59 mins)   (867 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.54batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.33batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 53.05batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.20batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 56.20batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.93batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.59batch/s]  2%|▌                           | 19/1014 [00:00<00:11, 87.87batch/s]  3%|▊                           | 29/1014 [00:00<00:11, 85.20batch/s]  4%|█                           | 39/1014 [00:00<00:11, 85.56batch/s]  5%|█▎                          | 49/1014 [00:00<00:11, 84.35batch/s]  6%|█▋                          | 59/1014 [00:00<00:11, 83.58batch/s]  7%|█▉                          | 69/1014 [00:00<00:11, 84.15batch/s]  8%|██▏                         | 79/1014 [00:00<00:10, 85.05batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 84.07batch/s] 10%|██▋                         | 99/1014 [00:01<00:10, 83.60batch/s] 11%|██▉                        | 109/1014 [00:01<00:10, 83.71batch/s] 12%|███▏                       | 119/1014 [00:01<00:10, 82.97batch/s] 13%|███▍                       | 129/1014 [00:01<00:10, 83.31batch/s] 14%|███▋                       | 139/1014 [00:01<00:10, 83.58batch/s] 15%|███▉                       | 149/1014 [00:01<00:10, 83.10batch/s] 16%|████▏                      | 159/1014 [00:01<00:10, 83.74batch/s] 17%|████▌                      | 169/1014 [00:02<00:10, 83.17batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 82.69batch/s] 19%|█████                      | 189/1014 [00:02<00:09, 82.55batch/s] 20%|█████▎                     | 199/1014 [00:02<00:09, 82.01batch/s] 21%|█████▌                     | 209/1014 [00:02<00:09, 82.29batch/s] 22%|█████▊                     | 219/1014 [00:02<00:09, 82.10batch/s] 23%|██████                     | 229/1014 [00:02<00:09, 81.78batch/s] 24%|██████▎                    | 239/1014 [00:02<00:09, 81.67batch/s] 25%|██████▋                    | 249/1014 [00:03<00:09, 81.42batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 81.60batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 81.74batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 81.47batch/s] 29%|███████▋                   | 289/1014 [00:03<00:08, 81.58batch/s] 29%|███████▉                   | 299/1014 [00:03<00:08, 81.83batch/s] 30%|████████▏                  | 309/1014 [00:03<00:08, 82.04batch/s] 31%|████████▍                  | 319/1014 [00:03<00:08, 81.93batch/s] 32%|████████▊                  | 329/1014 [00:04<00:08, 81.87batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 82.03batch/s] 34%|█████████▎                 | 349/1014 [00:04<00:08, 82.12batch/s] 35%|█████████▌                 | 359/1014 [00:04<00:07, 81.99batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:07, 82.06batch/s] 37%|██████████                 | 379/1014 [00:04<00:07, 82.36batch/s] 38%|██████████▎                | 389/1014 [00:04<00:07, 82.40batch/s] 39%|██████████▌                | 399/1014 [00:04<00:07, 82.46batch/s] 40%|██████████▉                | 409/1014 [00:04<00:07, 82.47batch/s] 41%|███████████▏               | 419/1014 [00:05<00:07, 82.46batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 82.48batch/s] 43%|███████████▋               | 439/1014 [00:05<00:06, 82.24batch/s] 44%|███████████▉               | 449/1014 [00:05<00:06, 81.92batch/s] 45%|████████████▏              | 459/1014 [00:05<00:06, 81.67batch/s] 46%|████████████▍              | 469/1014 [00:05<00:06, 81.48batch/s] 47%|████████████▊              | 479/1014 [00:05<00:06, 81.38batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 81.23batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 81.43batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 81.53batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:06, 81.49batch/s] 52%|██████████████             | 529/1014 [00:06<00:05, 81.74batch/s] 53%|██████████████▎            | 539/1014 [00:06<00:05, 81.95batch/s] 54%|██████████████▌            | 549/1014 [00:06<00:05, 81.81batch/s] 55%|██████████████▉            | 559/1014 [00:06<00:05, 81.82batch/s] 56%|███████████████▏           | 569/1014 [00:06<00:05, 81.85batch/s] 57%|███████████████▍           | 579/1014 [00:07<00:05, 82.02batch/s] 58%|███████████████▋           | 589/1014 [00:07<00:05, 82.01batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 82.02batch/s] 60%|████████████████▏          | 609/1014 [00:07<00:04, 81.96batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:04, 82.00batch/s] 62%|████████████████▋          | 629/1014 [00:07<00:04, 82.10batch/s] 63%|█████████████████          | 639/1014 [00:07<00:04, 82.12batch/s] 64%|█████████████████▎         | 649/1014 [00:07<00:04, 81.97batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 81.95batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 81.91batch/s] 67%|██████████████████         | 679/1014 [00:08<00:04, 81.99batch/s] 68%|██████████████████▎        | 689/1014 [00:08<00:03, 81.95batch/s] 69%|██████████████████▌        | 699/1014 [00:08<00:03, 81.77batch/s] 70%|██████████████████▉        | 709/1014 [00:08<00:03, 81.64batch/s] 71%|███████████████████▏       | 719/1014 [00:08<00:03, 81.49batch/s] 72%|███████████████████▍       | 729/1014 [00:08<00:03, 81.39batch/s] 73%|███████████████████▋       | 739/1014 [00:09<00:03, 81.39batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 81.52batch/s] 75%|████████████████████▏      | 759/1014 [00:09<00:03, 81.57batch/s] 76%|████████████████████▍      | 769/1014 [00:09<00:03, 81.63batch/s] 77%|████████████████████▋      | 779/1014 [00:09<00:02, 81.50batch/s] 78%|█████████████████████      | 789/1014 [00:09<00:02, 81.45batch/s] 79%|█████████████████████▎     | 799/1014 [00:09<00:02, 81.53batch/s] 80%|█████████████████████▌     | 809/1014 [00:09<00:02, 81.50batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 81.52batch/s] 82%|██████████████████████     | 829/1014 [00:10<00:02, 81.37batch/s] 83%|██████████████████████▎    | 839/1014 [00:10<00:02, 81.32batch/s] 84%|██████████████████████▌    | 849/1014 [00:10<00:02, 81.42batch/s] 85%|██████████████████████▊    | 859/1014 [00:10<00:01, 81.24batch/s] 86%|███████████████████████▏   | 869/1014 [00:10<00:01, 81.19batch/s] 87%|███████████████████████▍   | 879/1014 [00:10<00:01, 81.34batch/s] 88%|███████████████████████▋   | 889/1014 [00:10<00:01, 81.36batch/s] 89%|███████████████████████▉   | 899/1014 [00:11<00:01, 81.36batch/s] 90%|████████████████████████▏  | 909/1014 [00:11<00:01, 81.29batch/s] 91%|████████████████████████▍  | 919/1014 [00:11<00:01, 81.40batch/s] 92%|████████████████████████▋  | 929/1014 [00:11<00:01, 81.32batch/s] 93%|█████████████████████████  | 939/1014 [00:11<00:00, 81.43batch/s] 94%|█████████████████████████▎ | 949/1014 [00:11<00:00, 81.42batch/s] 95%|█████████████████████████▌ | 959/1014 [00:11<00:00, 81.35batch/s] 96%|█████████████████████████▊ | 969/1014 [00:11<00:00, 81.35batch/s] 97%|██████████████████████████ | 979/1014 [00:12<00:00, 81.47batch/s] 98%|██████████████████████████▎| 989/1014 [00:12<00:00, 81.37batch/s] 99%|██████████████████████████▌| 999/1014 [00:12<00:00, 81.35batch/s]100%|█████████████████████████▊| 1009/1014 [00:12<00:00, 81.41batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.44batch/s]
Validation 24 -> LOSS = 2.18
Validation 24 -> BLEU = 20.31, 50.6/25.2/15.1/9.1 (BP=0.992, ratio=0.992, hyp_len=12726, ref_len=12828)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.79 @ validation 22
Starting Epoch 25
Epoch 25 - update      11460 => loss:   1.379 (#OOM: 0)
Epoch 25 - update      11490 => loss:   2.289 (#OOM: 0)
Epoch 25 - update      11520 => loss:   1.538 (#OOM: 0)
Epoch 25 - update      11550 => loss:   1.742 (#OOM: 0)
Epoch 25 - update      11580 => loss:   1.572 (#OOM: 0)
Epoch 25 - update      11610 => loss:   1.615 (#OOM: 0)
Epoch 25 - update      11640 => loss:   1.646 (#OOM: 0)
Epoch 25 - update      11670 => loss:   1.943 (#OOM: 0)
Epoch 25 - update      11700 => loss:   1.757 (#OOM: 0)
Epoch 25 - update      11730 => loss:   1.414 (#OOM: 0)
Epoch 25 - update      11760 => loss:   1.735 (#OOM: 0)
Epoch 25 - update      11790 => loss:   1.639 (#OOM: 0)
Epoch 25 - update      11820 => loss:   2.045 (#OOM: 0)
Epoch 25 - update      11850 => loss:   2.256 (#OOM: 0)
Epoch 25 - update      11880 => loss:   1.829 (#OOM: 0)
Epoch 25 - update      11910 => loss:   1.327 (#OOM: 0)
--> Epoch 25 finished with mean loss 1.87849
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (856 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.09batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.43batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.19batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.71batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 53.77batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.98batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:14, 70.83batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 77.48batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 79.46batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 80.09batch/s]  4%|█▏                          | 44/1014 [00:00<00:11, 81.67batch/s]  5%|█▍                          | 53/1014 [00:00<00:11, 82.47batch/s]  6%|█▋                          | 62/1014 [00:00<00:11, 82.84batch/s]  7%|█▉                          | 71/1014 [00:00<00:11, 82.62batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 83.10batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 81.20batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 81.03batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 79.40batch/s] 12%|███                        | 117/1014 [00:01<00:11, 80.39batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 80.80batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 80.67batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 81.03batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 81.04batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 81.92batch/s] 18%|████▊                      | 179/1014 [00:02<00:10, 82.12batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 82.38batch/s] 20%|█████▎                     | 201/1014 [00:02<00:09, 82.49batch/s] 21%|█████▋                     | 212/1014 [00:02<00:09, 82.41batch/s] 22%|█████▉                     | 223/1014 [00:02<00:09, 82.37batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 82.60batch/s] 24%|██████▌                    | 245/1014 [00:02<00:09, 82.49batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 82.68batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 82.36batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 82.29batch/s] 29%|███████▋                   | 289/1014 [00:03<00:08, 82.27batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 82.35batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 82.38batch/s] 32%|████████▌                  | 322/1014 [00:03<00:08, 82.51batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 82.65batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 82.61batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:07, 82.79batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:07, 83.19batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 83.13batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 83.06batch/s] 39%|██████████▌                | 399/1014 [00:04<00:07, 82.84batch/s] 40%|██████████▉                | 410/1014 [00:04<00:07, 82.79batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 82.78batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 82.93batch/s] 44%|███████████▊               | 443/1014 [00:05<00:06, 82.34batch/s] 45%|████████████               | 454/1014 [00:05<00:06, 82.42batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 82.39batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 82.02batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 81.67batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 81.82batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 81.73batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 81.74batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:05, 81.58batch/s] 53%|██████████████▍            | 542/1014 [00:06<00:05, 81.78batch/s] 55%|██████████████▋            | 553/1014 [00:06<00:05, 81.84batch/s] 56%|███████████████            | 564/1014 [00:06<00:05, 81.82batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 82.03batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 81.94batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 81.98batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:04, 81.89batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:04, 81.85batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 81.94batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 81.62batch/s] 64%|█████████████████▎         | 652/1014 [00:07<00:04, 81.57batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 81.42batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 81.45batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 81.41batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:03, 81.58batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 81.61batch/s] 71%|███████████████████        | 718/1014 [00:08<00:03, 81.74batch/s] 72%|███████████████████▍       | 729/1014 [00:08<00:03, 81.74batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 81.90batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 81.74batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 81.58batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:02, 81.65batch/s] 77%|████████████████████▉      | 784/1014 [00:09<00:02, 81.73batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 81.52batch/s] 79%|█████████████████████▍     | 806/1014 [00:09<00:02, 81.52batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 81.45batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 81.47batch/s] 83%|██████████████████████▎    | 839/1014 [00:10<00:02, 81.56batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 81.54batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 81.52batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 81.38batch/s] 87%|███████████████████████▌   | 883/1014 [00:10<00:01, 81.30batch/s] 88%|███████████████████████▊   | 894/1014 [00:10<00:01, 81.31batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 81.33batch/s] 90%|████████████████████████▍  | 916/1014 [00:11<00:01, 81.27batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 81.13batch/s] 93%|████████████████████████▉  | 938/1014 [00:11<00:00, 81.05batch/s] 94%|█████████████████████████▎ | 949/1014 [00:11<00:00, 81.00batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 81.00batch/s] 96%|█████████████████████████▊ | 971/1014 [00:11<00:00, 80.95batch/s] 97%|██████████████████████████▏| 982/1014 [00:12<00:00, 81.02batch/s] 98%|██████████████████████████▍| 993/1014 [00:12<00:00, 81.10batch/s] 99%|█████████████████████████▋| 1004/1014 [00:12<00:00, 80.91batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.86batch/s]
Validation 25 -> LOSS = 2.18
Validation 25 -> BLEU = 19.79, 50.6/25.1/14.6/8.6 (BP=0.990, ratio=0.990, hyp_len=12703, ref_len=12828)
** Learning rate changed -> 0.0001
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.79 @ validation 22
Starting Epoch 26
Epoch 26 - update      11940 => loss:   2.051 (#OOM: 0)
Epoch 26 - update      11970 => loss:   1.552 (#OOM: 0)
Epoch 26 - update      12000 => loss:   1.369 (#OOM: 0)
Epoch 26 - update      12030 => loss:   1.723 (#OOM: 0)
Epoch 26 - update      12060 => loss:   2.165 (#OOM: 0)
Epoch 26 - update      12090 => loss:   1.976 (#OOM: 0)
Epoch 26 - update      12120 => loss:   1.431 (#OOM: 0)
Epoch 26 - update      12150 => loss:   1.420 (#OOM: 0)
Epoch 26 - update      12180 => loss:   2.021 (#OOM: 0)
Epoch 26 - update      12210 => loss:   2.044 (#OOM: 0)
Epoch 26 - update      12240 => loss:   1.933 (#OOM: 0)
Epoch 26 - update      12270 => loss:   1.615 (#OOM: 0)
Epoch 26 - update      12300 => loss:   1.576 (#OOM: 0)
Epoch 26 - update      12330 => loss:   1.724 (#OOM: 0)
Epoch 26 - update      12360 => loss:   1.461 (#OOM: 0)
Epoch 26 - update      12390 => loss:   2.012 (#OOM: 0)
--> Epoch 26 finished with mean loss 1.84518
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (806 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 55.17batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.25batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.62batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 54.78batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 55.14batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.92batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 88.43batch/s]  2%|▍                           | 18/1014 [00:00<00:13, 75.03batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 77.90batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 78.62batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 80.57batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 81.27batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 81.55batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 81.95batch/s]  8%|██▏                         | 81/1014 [00:00<00:11, 81.37batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 81.53batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 81.26batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 80.88batch/s] 12%|███                        | 117/1014 [00:01<00:11, 80.97batch/s] 12%|███▎                       | 126/1014 [00:01<00:11, 80.08batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 79.20batch/s] 14%|███▊                       | 144/1014 [00:01<00:11, 78.74batch/s] 15%|████                       | 153/1014 [00:01<00:10, 78.98batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 79.19batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 78.83batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 78.61batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 79.08batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 78.95batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 79.25batch/s] 21%|█████▊                     | 216/1014 [00:02<00:10, 79.63batch/s] 22%|█████▉                     | 225/1014 [00:02<00:09, 79.78batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 79.94batch/s] 24%|██████▍                    | 243/1014 [00:03<00:09, 80.09batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 79.63batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 79.74batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 79.90batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 80.20batch/s] 29%|███████▋                   | 291/1014 [00:03<00:09, 80.04batch/s] 30%|████████                   | 301/1014 [00:03<00:08, 80.03batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 80.02batch/s] 32%|████████▌                  | 321/1014 [00:04<00:08, 80.00batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 79.97batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 80.21batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 79.90batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 79.69batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:08, 79.64batch/s] 38%|██████████▏                | 381/1014 [00:04<00:07, 79.41batch/s] 39%|██████████▍                | 391/1014 [00:04<00:07, 79.41batch/s] 40%|██████████▋                | 401/1014 [00:05<00:07, 79.47batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 79.34batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 79.44batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 79.58batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 79.45batch/s] 44%|████████████               | 451/1014 [00:05<00:07, 79.59batch/s] 45%|████████████▎              | 461/1014 [00:05<00:06, 79.51batch/s] 46%|████████████▌              | 471/1014 [00:05<00:06, 79.39batch/s] 47%|████████████▊              | 481/1014 [00:06<00:06, 79.59batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 79.83batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 79.81batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 79.90batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 80.15batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:06, 80.23batch/s] 53%|██████████████▍            | 541/1014 [00:06<00:05, 80.01batch/s] 54%|██████████████▋            | 551/1014 [00:06<00:05, 80.03batch/s] 55%|██████████████▉            | 561/1014 [00:07<00:05, 80.04batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 80.01batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 80.22batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 80.05batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 79.95batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:05, 80.05batch/s] 61%|████████████████▌          | 621/1014 [00:07<00:04, 79.82batch/s] 62%|████████████████▊          | 631/1014 [00:07<00:04, 79.68batch/s] 63%|█████████████████          | 641/1014 [00:08<00:04, 79.80batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 79.56batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 79.40batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 79.49batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 79.25batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:04, 79.34batch/s] 69%|██████████████████▋        | 701/1014 [00:08<00:03, 79.48batch/s] 70%|██████████████████▉        | 711/1014 [00:08<00:03, 79.46batch/s] 71%|███████████████████▏       | 721/1014 [00:09<00:03, 79.52batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 79.50batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 79.56batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 79.68batch/s] 75%|████████████████████▎      | 761/1014 [00:09<00:03, 79.62batch/s] 76%|████████████████████▌      | 771/1014 [00:09<00:03, 79.78batch/s] 77%|████████████████████▊      | 781/1014 [00:09<00:02, 79.64batch/s] 78%|█████████████████████      | 791/1014 [00:09<00:02, 79.71batch/s] 79%|█████████████████████▎     | 801/1014 [00:10<00:02, 79.85batch/s] 80%|█████████████████████▌     | 811/1014 [00:10<00:02, 79.90batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 80.02batch/s] 82%|██████████████████████▏    | 831/1014 [00:10<00:02, 80.03batch/s] 83%|██████████████████████▍    | 841/1014 [00:10<00:02, 80.06batch/s] 84%|██████████████████████▋    | 851/1014 [00:10<00:02, 79.98batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 80.05batch/s] 86%|███████████████████████▏   | 871/1014 [00:10<00:01, 80.05batch/s] 87%|███████████████████████▍   | 881/1014 [00:11<00:01, 79.97batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 79.75batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 79.74batch/s] 90%|████████████████████████▎  | 911/1014 [00:11<00:01, 79.84batch/s] 91%|████████████████████████▌  | 921/1014 [00:11<00:01, 79.77batch/s] 92%|████████████████████████▊  | 931/1014 [00:11<00:01, 79.67batch/s] 93%|█████████████████████████  | 941/1014 [00:11<00:00, 79.57batch/s] 94%|█████████████████████████▎ | 951/1014 [00:11<00:00, 79.55batch/s] 95%|█████████████████████████▌ | 961/1014 [00:12<00:00, 79.47batch/s] 96%|█████████████████████████▊ | 971/1014 [00:12<00:00, 79.45batch/s] 97%|██████████████████████████ | 981/1014 [00:12<00:00, 79.42batch/s] 98%|██████████████████████████▍| 991/1014 [00:12<00:00, 79.51batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 79.48batch/s]100%|█████████████████████████▉| 1011/1014 [00:12<00:00, 79.55batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.55batch/s]
Validation 26 -> LOSS = 2.18
Validation 26 -> BLEU = 20.19, 50.4/25.3/14.8/8.8 (BP=1.000, ratio=1.013, hyp_len=12990, ref_len=12828)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.79 @ validation 22
Starting Epoch 27
Epoch 27 - update      12420 => loss:   1.519 (#OOM: 0)
Epoch 27 - update      12450 => loss:   1.901 (#OOM: 0)
Epoch 27 - update      12480 => loss:   1.748 (#OOM: 0)
Epoch 27 - update      12510 => loss:   1.809 (#OOM: 0)
Epoch 27 - update      12540 => loss:   1.691 (#OOM: 0)
Epoch 27 - update      12570 => loss:   1.613 (#OOM: 0)
Epoch 27 - update      12600 => loss:   2.091 (#OOM: 0)
Epoch 27 - update      12630 => loss:   1.225 (#OOM: 0)
Epoch 27 - update      12660 => loss:   1.518 (#OOM: 0)
Epoch 27 - update      12690 => loss:   1.919 (#OOM: 0)
Epoch 27 - update      12720 => loss:   1.587 (#OOM: 0)
Epoch 27 - update      12750 => loss:   2.119 (#OOM: 0)
Epoch 27 - update      12780 => loss:   1.555 (#OOM: 0)
Epoch 27 - update      12810 => loss:   2.525 (#OOM: 0)
Epoch 27 - update      12840 => loss:   1.982 (#OOM: 0)
Epoch 27 - update      12870 => loss:   1.563 (#OOM: 0)
--> Epoch 27 finished with mean loss 1.82969
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (828 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.66batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.96batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.96batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 51.57batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 52.88batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.27batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 79.17batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.54batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 82.62batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.93batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 83.50batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 82.03batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 80.05batch/s]  7%|██                          | 73/1014 [00:00<00:11, 81.15batch/s]  8%|██▎                         | 83/1014 [00:01<00:11, 81.83batch/s]  9%|██▌                         | 93/1014 [00:01<00:11, 81.56batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 81.55batch/s] 11%|███                        | 113/1014 [00:01<00:11, 81.73batch/s] 12%|███▎                       | 123/1014 [00:01<00:10, 81.09batch/s] 13%|███▌                       | 133/1014 [00:01<00:10, 80.83batch/s] 14%|███▊                       | 143/1014 [00:01<00:10, 81.20batch/s] 15%|████                       | 153/1014 [00:01<00:10, 81.81batch/s] 16%|████▎                      | 163/1014 [00:01<00:10, 82.34batch/s] 17%|████▌                      | 173/1014 [00:02<00:10, 81.57batch/s] 18%|████▊                      | 183/1014 [00:02<00:10, 81.98batch/s] 19%|█████▏                     | 193/1014 [00:02<00:10, 82.07batch/s] 20%|█████▍                     | 203/1014 [00:02<00:09, 82.00batch/s] 21%|█████▋                     | 213/1014 [00:02<00:09, 81.89batch/s] 22%|█████▉                     | 223/1014 [00:02<00:09, 81.92batch/s] 23%|██████▏                    | 233/1014 [00:02<00:09, 81.85batch/s] 24%|██████▍                    | 243/1014 [00:02<00:09, 81.59batch/s] 25%|██████▋                    | 253/1014 [00:03<00:09, 81.14batch/s] 26%|███████                    | 263/1014 [00:03<00:09, 80.93batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 81.31batch/s] 28%|███████▌                   | 283/1014 [00:03<00:08, 81.27batch/s] 29%|███████▊                   | 293/1014 [00:03<00:08, 81.19batch/s] 30%|████████                   | 303/1014 [00:03<00:08, 81.17batch/s] 31%|████████▎                  | 313/1014 [00:03<00:08, 81.37batch/s] 32%|████████▌                  | 323/1014 [00:03<00:08, 81.17batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 80.72batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:08, 80.44batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 80.49batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 80.64batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:07, 80.41batch/s] 38%|██████████▏                | 383/1014 [00:04<00:07, 80.40batch/s] 39%|██████████▍                | 393/1014 [00:04<00:07, 80.40batch/s] 40%|██████████▋                | 403/1014 [00:05<00:07, 80.58batch/s] 41%|██████████▉                | 413/1014 [00:05<00:07, 80.39batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 80.17batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 79.94batch/s] 44%|███████████▊               | 443/1014 [00:05<00:07, 79.81batch/s] 45%|████████████               | 453/1014 [00:05<00:07, 80.04batch/s] 46%|████████████▎              | 463/1014 [00:05<00:06, 79.95batch/s] 47%|████████████▌              | 473/1014 [00:05<00:06, 80.03batch/s] 48%|████████████▊              | 483/1014 [00:06<00:06, 79.92batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 80.11batch/s] 50%|█████████████▍             | 503/1014 [00:06<00:06, 79.96batch/s] 51%|█████████████▋             | 513/1014 [00:06<00:06, 79.80batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:06, 79.82batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:06, 80.05batch/s] 54%|██████████████▍            | 543/1014 [00:06<00:05, 80.04batch/s] 55%|██████████████▋            | 553/1014 [00:06<00:05, 79.98batch/s] 56%|██████████████▉            | 563/1014 [00:07<00:05, 79.84batch/s] 57%|███████████████▎           | 573/1014 [00:07<00:05, 79.81batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 79.63batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 79.69batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 79.57batch/s] 60%|████████████████▎          | 613/1014 [00:07<00:05, 79.40batch/s] 61%|████████████████▌          | 623/1014 [00:07<00:04, 79.49batch/s] 62%|████████████████▊          | 633/1014 [00:07<00:04, 79.21batch/s] 63%|█████████████████          | 643/1014 [00:08<00:04, 79.18batch/s] 64%|█████████████████▍         | 653/1014 [00:08<00:04, 79.11batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 79.21batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 79.14batch/s] 67%|██████████████████▏        | 683/1014 [00:08<00:04, 79.08batch/s] 68%|██████████████████▍        | 693/1014 [00:08<00:04, 79.25batch/s] 69%|██████████████████▋        | 703/1014 [00:08<00:03, 79.25batch/s] 70%|██████████████████▉        | 713/1014 [00:08<00:03, 79.28batch/s] 71%|███████████████████▎       | 723/1014 [00:09<00:03, 79.47batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 79.51batch/s] 73%|███████████████████▊       | 743/1014 [00:09<00:03, 79.53batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 79.28batch/s] 75%|████████████████████▎      | 763/1014 [00:09<00:03, 79.30batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:03, 79.33batch/s] 77%|████████████████████▊      | 783/1014 [00:09<00:02, 79.26batch/s] 78%|█████████████████████      | 793/1014 [00:10<00:02, 79.11batch/s] 79%|█████████████████████▍     | 803/1014 [00:10<00:02, 79.09batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 79.16batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 79.07batch/s] 82%|██████████████████████▏    | 833/1014 [00:10<00:02, 79.05batch/s] 83%|██████████████████████▍    | 843/1014 [00:10<00:02, 78.99batch/s] 84%|██████████████████████▋    | 853/1014 [00:10<00:02, 78.99batch/s] 85%|██████████████████████▉    | 863/1014 [00:10<00:01, 79.11batch/s] 86%|███████████████████████▏   | 873/1014 [00:11<00:01, 79.19batch/s] 87%|███████████████████████▌   | 883/1014 [00:11<00:01, 79.14batch/s] 88%|███████████████████████▊   | 893/1014 [00:11<00:01, 79.09batch/s] 89%|████████████████████████   | 903/1014 [00:11<00:01, 79.07batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 79.06batch/s] 91%|████████████████████████▌  | 923/1014 [00:11<00:01, 79.04batch/s] 92%|████████████████████████▊  | 933/1014 [00:11<00:01, 79.07batch/s] 93%|█████████████████████████  | 943/1014 [00:11<00:00, 79.13batch/s] 94%|█████████████████████████▍ | 953/1014 [00:12<00:00, 79.06batch/s] 95%|█████████████████████████▋ | 963/1014 [00:12<00:00, 79.19batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 79.15batch/s] 97%|██████████████████████████▏| 983/1014 [00:12<00:00, 79.14batch/s] 98%|██████████████████████████▍| 993/1014 [00:12<00:00, 79.20batch/s] 99%|█████████████████████████▋| 1003/1014 [00:12<00:00, 79.12batch/s]100%|█████████████████████████▉| 1013/1014 [00:12<00:00, 79.06batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 79.04batch/s]
Validation 27 -> LOSS = 2.18
Validation 27 -> BLEU = 20.86, 51.1/25.7/15.4/9.4 (BP=0.999, ratio=0.999, hyp_len=12818, ref_len=12828)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 28
Epoch 28 - update      12900 => loss:   1.339 (#OOM: 0)
Epoch 28 - update      12930 => loss:   2.450 (#OOM: 0)
Epoch 28 - update      12960 => loss:   1.101 (#OOM: 0)
Epoch 28 - update      12990 => loss:   1.969 (#OOM: 0)
Epoch 28 - update      13020 => loss:   1.922 (#OOM: 0)
Epoch 28 - update      13050 => loss:   1.919 (#OOM: 0)
Epoch 28 - update      13080 => loss:   1.644 (#OOM: 0)
Epoch 28 - update      13110 => loss:   1.513 (#OOM: 0)
Epoch 28 - update      13140 => loss:   1.597 (#OOM: 0)
Epoch 28 - update      13170 => loss:   2.118 (#OOM: 0)
Epoch 28 - update      13200 => loss:   1.599 (#OOM: 0)
Epoch 28 - update      13230 => loss:   1.573 (#OOM: 0)
Epoch 28 - update      13260 => loss:   1.344 (#OOM: 0)
Epoch 28 - update      13290 => loss:   1.778 (#OOM: 0)
Epoch 28 - update      13320 => loss:   1.738 (#OOM: 0)
Epoch 28 - update      13350 => loss:   1.740 (#OOM: 0)
--> Epoch 28 finished with mean loss 1.82372
--> Overhead/Training/Evaluation: 0.03/0.52/0.00 mins (total: 0.55 mins)   (936 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.14batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.31batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.13batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 52.45batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 53.25batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.13batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                          | 11/1014 [00:00<00:09, 102.33batch/s]  2%|▌                           | 22/1014 [00:00<00:11, 89.99batch/s]  3%|▉                           | 33/1014 [00:00<00:11, 87.75batch/s]  4%|█▏                          | 44/1014 [00:00<00:10, 88.65batch/s]  5%|█▌                          | 55/1014 [00:00<00:10, 89.02batch/s]  7%|█▊                          | 66/1014 [00:00<00:10, 89.92batch/s]  8%|██▏                         | 77/1014 [00:00<00:10, 88.11batch/s]  9%|██▍                         | 88/1014 [00:00<00:10, 88.54batch/s] 10%|██▋                         | 99/1014 [00:01<00:10, 87.21batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 87.04batch/s] 12%|███▏                       | 121/1014 [00:01<00:10, 88.02batch/s] 13%|███▌                       | 132/1014 [00:01<00:10, 87.40batch/s] 14%|███▊                       | 143/1014 [00:01<00:10, 86.16batch/s] 15%|████                       | 154/1014 [00:01<00:10, 85.66batch/s] 16%|████▍                      | 165/1014 [00:01<00:09, 86.06batch/s] 17%|████▋                      | 176/1014 [00:02<00:09, 86.08batch/s] 18%|████▉                      | 187/1014 [00:02<00:09, 85.99batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 86.44batch/s] 21%|█████▌                     | 209/1014 [00:02<00:09, 85.53batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 85.32batch/s] 23%|██████▏                    | 231/1014 [00:02<00:09, 85.48batch/s] 24%|██████▍                    | 242/1014 [00:02<00:08, 85.97batch/s] 25%|██████▋                    | 253/1014 [00:02<00:08, 85.97batch/s] 26%|███████                    | 264/1014 [00:03<00:08, 86.01batch/s] 27%|███████▎                   | 275/1014 [00:03<00:08, 85.77batch/s] 28%|███████▌                   | 286/1014 [00:03<00:08, 85.86batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 85.87batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 85.65batch/s] 31%|████████▍                  | 319/1014 [00:03<00:08, 85.64batch/s] 33%|████████▊                  | 330/1014 [00:03<00:07, 85.59batch/s] 34%|█████████                  | 341/1014 [00:04<00:07, 85.12batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:07, 85.29batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:07, 84.89batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 84.79batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 84.76batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 85.02batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 85.08batch/s] 41%|███████████▏               | 418/1014 [00:04<00:07, 85.01batch/s] 42%|███████████▍               | 429/1014 [00:05<00:06, 84.93batch/s] 43%|███████████▋               | 440/1014 [00:05<00:06, 84.67batch/s] 44%|████████████               | 451/1014 [00:05<00:06, 84.71batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 84.74batch/s] 47%|████████████▌              | 473/1014 [00:05<00:06, 84.63batch/s] 48%|████████████▉              | 484/1014 [00:05<00:06, 84.54batch/s] 49%|█████████████▏             | 495/1014 [00:05<00:06, 84.37batch/s] 50%|█████████████▍             | 506/1014 [00:05<00:06, 84.38batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:05, 84.23batch/s] 52%|██████████████             | 528/1014 [00:06<00:05, 84.21batch/s] 53%|██████████████▎            | 539/1014 [00:06<00:05, 84.15batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 84.18batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:05, 84.29batch/s] 56%|███████████████▏           | 572/1014 [00:06<00:05, 84.00batch/s] 57%|███████████████▌           | 583/1014 [00:06<00:05, 84.09batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 83.95batch/s] 60%|████████████████           | 605/1014 [00:07<00:04, 84.05batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 84.08batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 84.09batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 84.02batch/s] 64%|█████████████████▎         | 649/1014 [00:07<00:04, 83.97batch/s] 65%|█████████████████▌         | 660/1014 [00:07<00:04, 83.98batch/s] 66%|█████████████████▊         | 671/1014 [00:07<00:04, 83.95batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:03, 83.76batch/s] 68%|██████████████████▍        | 693/1014 [00:08<00:03, 83.96batch/s] 69%|██████████████████▋        | 704/1014 [00:08<00:03, 83.73batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 83.60batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 83.53batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 83.39batch/s] 74%|███████████████████▉       | 748/1014 [00:08<00:03, 83.39batch/s] 75%|████████████████████▏      | 759/1014 [00:09<00:03, 83.57batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:02, 83.61batch/s] 77%|████████████████████▊      | 781/1014 [00:09<00:02, 83.39batch/s] 78%|█████████████████████      | 792/1014 [00:09<00:02, 83.22batch/s] 79%|█████████████████████▍     | 803/1014 [00:09<00:02, 83.13batch/s] 80%|█████████████████████▋     | 814/1014 [00:09<00:02, 82.96batch/s] 81%|█████████████████████▉     | 825/1014 [00:09<00:02, 82.91batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 83.05batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 82.89batch/s] 85%|██████████████████████▊    | 858/1014 [00:10<00:01, 82.88batch/s] 86%|███████████████████████▏   | 869/1014 [00:10<00:01, 82.84batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 82.94batch/s] 88%|███████████████████████▋   | 891/1014 [00:10<00:01, 83.04batch/s] 89%|████████████████████████   | 902/1014 [00:10<00:01, 82.96batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 82.98batch/s] 91%|████████████████████████▌  | 924/1014 [00:11<00:01, 82.93batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 82.85batch/s] 93%|█████████████████████████▏ | 946/1014 [00:11<00:00, 82.67batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 82.59batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 82.46batch/s] 97%|██████████████████████████ | 979/1014 [00:11<00:00, 82.38batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 82.47batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 82.49batch/s]100%|█████████████████████████▉| 1012/1014 [00:12<00:00, 82.47batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.45batch/s]
Validation 28 -> LOSS = 2.19
Validation 28 -> BLEU = 20.27, 51.1/25.8/15.2/9.2 (BP=0.980, ratio=0.980, hyp_len=12569, ref_len=12828)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 29
Epoch 29 - update      13380 => loss:   1.710 (#OOM: 0)
Epoch 29 - update      13410 => loss:   1.625 (#OOM: 0)
Epoch 29 - update      13440 => loss:   1.858 (#OOM: 0)
Epoch 29 - update      13470 => loss:   1.508 (#OOM: 0)
Epoch 29 - update      13500 => loss:   1.589 (#OOM: 0)
Epoch 29 - update      13530 => loss:   2.300 (#OOM: 0)
Epoch 29 - update      13560 => loss:   1.555 (#OOM: 0)
Epoch 29 - update      13590 => loss:   1.840 (#OOM: 0)
Epoch 29 - update      13620 => loss:   2.173 (#OOM: 0)
Epoch 29 - update      13650 => loss:   2.257 (#OOM: 0)
Epoch 29 - update      13680 => loss:   1.598 (#OOM: 0)
Epoch 29 - update      13710 => loss:   1.690 (#OOM: 0)
Epoch 29 - update      13740 => loss:   1.830 (#OOM: 0)
Epoch 29 - update      13770 => loss:   1.645 (#OOM: 0)
Epoch 29 - update      13800 => loss:   1.554 (#OOM: 0)
Epoch 29 - update      13830 => loss:   1.475 (#OOM: 0)
--> Epoch 29 finished with mean loss 1.81007
--> Overhead/Training/Evaluation: 0.04/0.63/0.00 mins (total: 0.67 mins)   (770 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 57.85batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.26batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.89batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 55.19batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 56.08batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.35batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 86.88batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 85.39batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 82.67batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.78batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 81.04batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 81.36batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 81.14batch/s]  7%|██                          | 73/1014 [00:00<00:11, 82.32batch/s]  8%|██▎                         | 83/1014 [00:00<00:11, 84.05batch/s]  9%|██▌                         | 93/1014 [00:01<00:10, 84.79batch/s] 10%|██▋                        | 103/1014 [00:01<00:10, 84.39batch/s] 11%|███                        | 113/1014 [00:01<00:10, 83.32batch/s] 12%|███▎                       | 124/1014 [00:01<00:10, 84.73batch/s] 13%|███▌                       | 135/1014 [00:01<00:10, 84.54batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 83.65batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 83.57batch/s] 17%|████▍                      | 168/1014 [00:01<00:10, 84.04batch/s] 18%|████▊                      | 179/1014 [00:02<00:09, 84.34batch/s] 19%|█████                      | 190/1014 [00:02<00:09, 84.49batch/s] 20%|█████▎                     | 201/1014 [00:02<00:09, 83.06batch/s] 21%|█████▋                     | 212/1014 [00:02<00:09, 83.56batch/s] 22%|█████▉                     | 223/1014 [00:02<00:09, 83.81batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 83.80batch/s] 24%|██████▌                    | 245/1014 [00:02<00:09, 83.88batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 84.14batch/s] 26%|███████                    | 267/1014 [00:03<00:08, 84.56batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 84.34batch/s] 29%|███████▋                   | 289/1014 [00:03<00:08, 84.46batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 84.62batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 84.66batch/s] 32%|████████▌                  | 322/1014 [00:03<00:08, 85.08batch/s] 33%|████████▊                  | 333/1014 [00:03<00:08, 84.83batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:07, 84.89batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:07, 84.79batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:07, 84.52batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 84.59batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 84.40batch/s] 39%|██████████▌                | 399/1014 [00:04<00:07, 84.46batch/s] 40%|██████████▉                | 410/1014 [00:04<00:07, 84.12batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 84.16batch/s] 43%|███████████▌               | 432/1014 [00:05<00:06, 84.23batch/s] 44%|███████████▊               | 443/1014 [00:05<00:06, 84.22batch/s] 45%|████████████               | 454/1014 [00:05<00:06, 84.31batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 84.28batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 84.19batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 84.18batch/s] 49%|█████████████▎             | 498/1014 [00:05<00:06, 84.13batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 84.11batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:05, 84.22batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:05, 84.13batch/s] 53%|██████████████▍            | 542/1014 [00:06<00:05, 84.23batch/s] 55%|██████████████▋            | 553/1014 [00:06<00:05, 84.39batch/s] 56%|███████████████            | 564/1014 [00:06<00:05, 84.49batch/s] 57%|███████████████▎           | 575/1014 [00:06<00:05, 84.42batch/s] 58%|███████████████▌           | 586/1014 [00:06<00:05, 84.19batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:04, 84.12batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:04, 84.10batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:04, 84.01batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 84.08batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 84.32batch/s] 64%|█████████████████▎         | 652/1014 [00:07<00:04, 84.11batch/s] 65%|█████████████████▋         | 663/1014 [00:07<00:04, 84.26batch/s] 66%|█████████████████▉         | 674/1014 [00:07<00:04, 84.29batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:03, 84.43batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:03, 84.31batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 84.20batch/s] 71%|███████████████████        | 718/1014 [00:08<00:03, 84.35batch/s] 72%|███████████████████▍       | 729/1014 [00:08<00:03, 84.30batch/s] 73%|███████████████████▋       | 740/1014 [00:08<00:03, 84.33batch/s] 74%|███████████████████▉       | 751/1014 [00:08<00:03, 84.37batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:02, 84.27batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:02, 84.32batch/s] 77%|████████████████████▉      | 784/1014 [00:09<00:02, 84.27batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 84.31batch/s] 79%|█████████████████████▍     | 806/1014 [00:09<00:02, 84.36batch/s] 81%|█████████████████████▊     | 817/1014 [00:09<00:02, 84.18batch/s] 82%|██████████████████████     | 828/1014 [00:09<00:02, 84.20batch/s] 83%|██████████████████████▎    | 839/1014 [00:09<00:02, 84.14batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:01, 84.01batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 83.92batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 83.91batch/s] 87%|███████████████████████▌   | 883/1014 [00:10<00:01, 83.86batch/s] 88%|███████████████████████▊   | 894/1014 [00:10<00:01, 83.92batch/s] 89%|████████████████████████   | 905/1014 [00:10<00:01, 84.09batch/s] 90%|████████████████████████▍  | 916/1014 [00:10<00:01, 84.05batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 84.05batch/s] 93%|████████████████████████▉  | 938/1014 [00:11<00:00, 84.02batch/s] 94%|█████████████████████████▎ | 949/1014 [00:11<00:00, 84.13batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 84.15batch/s] 96%|█████████████████████████▊ | 971/1014 [00:11<00:00, 84.08batch/s] 97%|██████████████████████████▏| 982/1014 [00:11<00:00, 83.99batch/s] 98%|██████████████████████████▍| 993/1014 [00:11<00:00, 84.14batch/s] 99%|█████████████████████████▋| 1004/1014 [00:11<00:00, 84.22batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 84.21batch/s]
Validation 29 -> LOSS = 2.20
Validation 29 -> BLEU = 20.11, 51.7/26.2/15.6/9.5 (BP=0.951, ratio=0.952, hyp_len=12218, ref_len=12828)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 30
Epoch 30 - update      13860 => loss:   1.594 (#OOM: 0)
Epoch 30 - update      13890 => loss:   2.159 (#OOM: 0)
Epoch 30 - update      13920 => loss:   1.960 (#OOM: 0)
Epoch 30 - update      13950 => loss:   1.704 (#OOM: 0)
Epoch 30 - update      13980 => loss:   1.829 (#OOM: 0)
Epoch 30 - update      14010 => loss:   1.698 (#OOM: 0)
Epoch 30 - update      14040 => loss:   1.720 (#OOM: 0)
Epoch 30 - update      14070 => loss:   1.502 (#OOM: 0)
Epoch 30 - update      14100 => loss:   1.486 (#OOM: 0)
Epoch 30 - update      14130 => loss:   2.093 (#OOM: 0)
Epoch 30 - update      14160 => loss:   2.038 (#OOM: 0)
Epoch 30 - update      14190 => loss:   2.159 (#OOM: 0)
Epoch 30 - update      14220 => loss:   1.695 (#OOM: 0)
Epoch 30 - update      14250 => loss:   2.236 (#OOM: 0)
Epoch 30 - update      14280 => loss:   1.098 (#OOM: 0)
Epoch 30 - update      14310 => loss:   1.599 (#OOM: 0)
--> Epoch 30 finished with mean loss 1.80129
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (829 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 59.62batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.14batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.56batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.31batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 51.92batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 51.46batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 68.95batch/s]  1%|▍                           | 15/1014 [00:00<00:13, 73.58batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 74.43batch/s]  3%|▉                           | 32/1014 [00:00<00:12, 76.69batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 75.87batch/s]  5%|█▍                          | 50/1014 [00:00<00:12, 76.45batch/s]  6%|█▋                          | 59/1014 [00:00<00:12, 76.62batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 75.18batch/s]  8%|██▏                         | 77/1014 [00:01<00:12, 75.93batch/s]  8%|██▎                         | 86/1014 [00:01<00:12, 76.60batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 76.94batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 77.99batch/s] 11%|███                        | 115/1014 [00:01<00:11, 78.50batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 77.96batch/s] 13%|███▌                       | 135/1014 [00:01<00:11, 79.13batch/s] 14%|███▊                       | 145/1014 [00:01<00:10, 79.70batch/s] 15%|████▏                      | 155/1014 [00:01<00:10, 80.23batch/s] 16%|████▍                      | 165/1014 [00:02<00:10, 79.90batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 80.20batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 80.73batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 81.08batch/s] 20%|█████▍                     | 205/1014 [00:02<00:09, 81.62batch/s] 21%|█████▋                     | 215/1014 [00:02<00:09, 81.85batch/s] 22%|█████▉                     | 225/1014 [00:02<00:09, 81.40batch/s] 23%|██████▎                    | 235/1014 [00:02<00:09, 81.47batch/s] 24%|██████▌                    | 245/1014 [00:03<00:09, 81.37batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 81.34batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 81.56batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 81.45batch/s] 28%|███████▌                   | 285/1014 [00:03<00:08, 81.22batch/s] 29%|███████▊                   | 295/1014 [00:03<00:08, 80.95batch/s] 30%|████████                   | 305/1014 [00:03<00:08, 80.89batch/s] 31%|████████▍                  | 315/1014 [00:03<00:08, 81.32batch/s] 32%|████████▋                  | 325/1014 [00:04<00:08, 80.99batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 81.26batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 81.12batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 79.85batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:08, 79.64batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:08, 79.64batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 79.39batch/s] 39%|██████████▌                | 395/1014 [00:04<00:07, 79.32batch/s] 40%|██████████▊                | 405/1014 [00:05<00:07, 79.28batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 79.41batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 79.22batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 79.06batch/s] 44%|███████████▊               | 445/1014 [00:05<00:07, 79.02batch/s] 45%|████████████               | 455/1014 [00:05<00:07, 78.81batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 78.84batch/s] 47%|████████████▋              | 475/1014 [00:06<00:06, 78.90batch/s] 48%|████████████▉              | 485/1014 [00:06<00:06, 78.84batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 78.79batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 78.74batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 78.78batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:06, 78.61batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:06, 78.65batch/s] 54%|██████████████▌            | 545/1014 [00:06<00:05, 78.69batch/s] 55%|██████████████▊            | 555/1014 [00:07<00:05, 78.76batch/s] 56%|███████████████            | 565/1014 [00:07<00:05, 78.79batch/s] 57%|███████████████▎           | 575/1014 [00:07<00:05, 78.71batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 78.94batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 78.75batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 78.71batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:05, 78.62batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 78.69batch/s] 63%|████████████████▉          | 635/1014 [00:08<00:04, 78.64batch/s] 64%|█████████████████▏         | 645/1014 [00:08<00:04, 78.68batch/s] 65%|█████████████████▍         | 655/1014 [00:08<00:04, 78.55batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 78.54batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 78.51batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 78.52batch/s] 69%|██████████████████▌        | 695/1014 [00:08<00:04, 78.43batch/s] 70%|██████████████████▊        | 705/1014 [00:08<00:03, 78.53batch/s] 71%|███████████████████        | 715/1014 [00:09<00:03, 78.43batch/s] 71%|███████████████████▎       | 725/1014 [00:09<00:03, 78.39batch/s] 72%|███████████████████▌       | 735/1014 [00:09<00:03, 78.45batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 78.29batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 78.49batch/s] 75%|████████████████████▎      | 765/1014 [00:09<00:03, 78.56batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:03, 78.55batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 78.55batch/s] 78%|█████████████████████▏     | 795/1014 [00:10<00:02, 78.46batch/s] 79%|█████████████████████▍     | 805/1014 [00:10<00:02, 78.44batch/s] 80%|█████████████████████▋     | 815/1014 [00:10<00:02, 78.60batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 78.45batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 78.46batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 78.47batch/s] 84%|██████████████████████▊    | 855/1014 [00:10<00:02, 78.54batch/s] 85%|███████████████████████    | 865/1014 [00:11<00:01, 78.57batch/s] 86%|███████████████████████▎   | 875/1014 [00:11<00:01, 78.55batch/s] 87%|███████████████████████▌   | 885/1014 [00:11<00:01, 78.54batch/s] 88%|███████████████████████▊   | 895/1014 [00:11<00:01, 78.53batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 78.69batch/s] 90%|████████████████████████▎  | 915/1014 [00:11<00:01, 78.75batch/s] 91%|████████████████████████▋  | 925/1014 [00:11<00:01, 78.66batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:01, 78.66batch/s] 93%|█████████████████████████▏ | 945/1014 [00:12<00:00, 78.70batch/s] 94%|█████████████████████████▍ | 955/1014 [00:12<00:00, 78.73batch/s] 95%|█████████████████████████▋ | 965/1014 [00:12<00:00, 78.73batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 78.72batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 78.74batch/s] 98%|██████████████████████████▍| 995/1014 [00:12<00:00, 78.77batch/s] 99%|█████████████████████████▊| 1005/1014 [00:12<00:00, 78.85batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 78.92batch/s]
Validation 30 -> LOSS = 2.19
Validation 30 -> BLEU = 20.49, 50.6/25.4/15.0/9.1 (BP=1.000, ratio=1.000, hyp_len=12832, ref_len=12828)
** Learning rate changed -> 5e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 31
Epoch 31 - update      14340 => loss:   1.959 (#OOM: 0)
Epoch 31 - update      14370 => loss:   0.934 (#OOM: 0)
Epoch 31 - update      14400 => loss:   1.950 (#OOM: 0)
Epoch 31 - update      14430 => loss:   1.815 (#OOM: 0)
Epoch 31 - update      14460 => loss:   1.413 (#OOM: 0)
Epoch 31 - update      14490 => loss:   1.346 (#OOM: 0)
Epoch 31 - update      14520 => loss:   1.631 (#OOM: 0)
Epoch 31 - update      14550 => loss:   2.058 (#OOM: 0)
Epoch 31 - update      14580 => loss:   1.835 (#OOM: 0)
Epoch 31 - update      14610 => loss:   1.948 (#OOM: 0)
Epoch 31 - update      14640 => loss:   1.675 (#OOM: 0)
Epoch 31 - update      14670 => loss:   1.881 (#OOM: 0)
Epoch 31 - update      14700 => loss:   2.303 (#OOM: 0)
Epoch 31 - update      14730 => loss:   1.853 (#OOM: 0)
Epoch 31 - update      14760 => loss:   1.312 (#OOM: 0)
--> Epoch 31 finished with mean loss 1.78397
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (878 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 49.60batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 49.54batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 50.99batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 53.09batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 52.59batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.15batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.11batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 87.11batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 87.30batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 84.92batch/s]  4%|█                           | 37/1014 [00:00<00:11, 86.70batch/s]  5%|█▎                          | 48/1014 [00:00<00:10, 89.59batch/s]  6%|█▋                          | 59/1014 [00:00<00:10, 88.70batch/s]  7%|█▉                          | 70/1014 [00:00<00:10, 86.64batch/s]  8%|██▏                         | 81/1014 [00:00<00:10, 86.53batch/s]  9%|██▌                         | 92/1014 [00:01<00:10, 85.00batch/s] 10%|██▋                        | 103/1014 [00:01<00:10, 84.97batch/s] 11%|███                        | 114/1014 [00:01<00:10, 84.96batch/s] 12%|███▎                       | 125/1014 [00:01<00:10, 85.18batch/s] 13%|███▌                       | 136/1014 [00:01<00:10, 84.87batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 84.73batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 83.64batch/s] 17%|████▌                      | 169/1014 [00:02<00:10, 83.48batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 83.26batch/s] 19%|█████                      | 191/1014 [00:02<00:09, 83.33batch/s] 20%|█████▍                     | 202/1014 [00:02<00:09, 82.63batch/s] 21%|█████▋                     | 213/1014 [00:02<00:09, 81.64batch/s] 22%|█████▉                     | 224/1014 [00:02<00:09, 81.59batch/s] 23%|██████▎                    | 235/1014 [00:02<00:09, 81.49batch/s] 24%|██████▌                    | 246/1014 [00:03<00:09, 81.36batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 81.34batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 81.29batch/s] 28%|███████▍                   | 279/1014 [00:03<00:09, 80.87batch/s] 29%|███████▋                   | 290/1014 [00:03<00:08, 81.24batch/s] 30%|████████                   | 301/1014 [00:03<00:08, 81.29batch/s] 31%|████████▎                  | 312/1014 [00:03<00:08, 81.56batch/s] 32%|████████▌                  | 323/1014 [00:03<00:08, 81.05batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 80.80batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 80.77batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:08, 80.67batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 80.76batch/s] 37%|██████████                 | 378/1014 [00:04<00:07, 81.20batch/s] 38%|██████████▎                | 389/1014 [00:04<00:07, 81.38batch/s] 39%|██████████▋                | 400/1014 [00:04<00:07, 81.51batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 81.71batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 81.65batch/s] 43%|███████████▌               | 433/1014 [00:05<00:07, 81.75batch/s] 44%|███████████▊               | 444/1014 [00:05<00:06, 81.88batch/s] 45%|████████████               | 455/1014 [00:05<00:06, 81.99batch/s] 46%|████████████▍              | 466/1014 [00:05<00:06, 81.96batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 81.89batch/s] 48%|████████████▉              | 488/1014 [00:05<00:06, 82.17batch/s] 49%|█████████████▎             | 499/1014 [00:06<00:06, 82.29batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 82.50batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:05, 82.40batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:05, 82.37batch/s] 54%|██████████████▍            | 543/1014 [00:06<00:05, 82.59batch/s] 55%|██████████████▊            | 554/1014 [00:06<00:05, 82.85batch/s] 56%|███████████████            | 565/1014 [00:06<00:05, 83.01batch/s] 57%|███████████████▎           | 576/1014 [00:06<00:05, 83.06batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 83.21batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 83.13batch/s] 60%|████████████████▏          | 609/1014 [00:07<00:04, 83.27batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 83.31batch/s] 62%|████████████████▊          | 631/1014 [00:07<00:04, 83.08batch/s] 63%|█████████████████          | 642/1014 [00:07<00:04, 83.22batch/s] 64%|█████████████████▍         | 653/1014 [00:07<00:04, 82.89batch/s] 65%|█████████████████▋         | 664/1014 [00:08<00:04, 82.89batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 82.87batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:03, 82.81batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:03, 82.74batch/s] 70%|██████████████████▊        | 708/1014 [00:08<00:03, 82.64batch/s] 71%|███████████████████▏       | 719/1014 [00:08<00:03, 82.44batch/s] 72%|███████████████████▍       | 730/1014 [00:08<00:03, 82.38batch/s] 73%|███████████████████▋       | 741/1014 [00:09<00:03, 82.10batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 82.16batch/s] 75%|████████████████████▎      | 763/1014 [00:09<00:03, 82.18batch/s] 76%|████████████████████▌      | 774/1014 [00:09<00:02, 82.17batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 82.08batch/s] 79%|█████████████████████▏     | 796/1014 [00:09<00:02, 81.92batch/s] 80%|█████████████████████▍     | 807/1014 [00:09<00:02, 82.00batch/s] 81%|█████████████████████▊     | 818/1014 [00:09<00:02, 82.14batch/s] 82%|██████████████████████     | 829/1014 [00:10<00:02, 82.08batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 82.06batch/s] 84%|██████████████████████▋    | 851/1014 [00:10<00:01, 82.07batch/s] 85%|██████████████████████▉    | 862/1014 [00:10<00:01, 82.12batch/s] 86%|███████████████████████▏   | 873/1014 [00:10<00:01, 82.20batch/s] 87%|███████████████████████▌   | 884/1014 [00:10<00:01, 82.17batch/s] 88%|███████████████████████▊   | 895/1014 [00:10<00:01, 82.18batch/s] 89%|████████████████████████   | 906/1014 [00:11<00:01, 82.21batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 82.10batch/s] 92%|████████████████████████▋  | 928/1014 [00:11<00:01, 82.07batch/s] 93%|█████████████████████████  | 939/1014 [00:11<00:00, 82.16batch/s] 94%|█████████████████████████▎ | 950/1014 [00:11<00:00, 82.06batch/s] 95%|█████████████████████████▌ | 961/1014 [00:11<00:00, 82.13batch/s] 96%|█████████████████████████▉ | 972/1014 [00:11<00:00, 82.27batch/s] 97%|██████████████████████████▏| 983/1014 [00:11<00:00, 82.33batch/s] 98%|██████████████████████████▍| 994/1014 [00:12<00:00, 82.41batch/s] 99%|█████████████████████████▊| 1005/1014 [00:12<00:00, 82.45batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.50batch/s]
Validation 31 -> LOSS = 2.20
Validation 31 -> BLEU = 20.23, 51.7/26.0/15.5/9.4 (BP=0.960, ratio=0.961, hyp_len=12330, ref_len=12828)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 32
Epoch 32 - update      14790 => loss:   2.505 (#OOM: 0)
Epoch 32 - update      14820 => loss:   1.706 (#OOM: 0)
Epoch 32 - update      14850 => loss:   1.689 (#OOM: 0)
Epoch 32 - update      14880 => loss:   1.587 (#OOM: 0)
Epoch 32 - update      14910 => loss:   1.239 (#OOM: 0)
Epoch 32 - update      14940 => loss:   1.623 (#OOM: 0)
Epoch 32 - update      14970 => loss:   2.078 (#OOM: 0)
Epoch 32 - update      15000 => loss:   1.625 (#OOM: 0)
Epoch 32 - update      15030 => loss:   1.688 (#OOM: 0)
Epoch 32 - update      15060 => loss:   1.833 (#OOM: 0)
Epoch 32 - update      15090 => loss:   1.439 (#OOM: 0)
Epoch 32 - update      15120 => loss:   1.824 (#OOM: 0)
Epoch 32 - update      15150 => loss:   0.960 (#OOM: 0)
Epoch 32 - update      15180 => loss:   1.535 (#OOM: 0)
Epoch 32 - update      15210 => loss:   1.684 (#OOM: 0)
Epoch 32 - update      15240 => loss:   1.555 (#OOM: 0)
--> Epoch 32 finished with mean loss 1.77800
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.62 mins)   (825 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.90batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 48.73batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.68batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.35batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 52.61batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.39batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 83.05batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.35batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 78.00batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 78.38batch/s]  5%|█▎                          | 46/1014 [00:00<00:11, 81.11batch/s]  6%|█▌                          | 56/1014 [00:00<00:11, 82.53batch/s]  7%|█▊                          | 66/1014 [00:00<00:11, 81.72batch/s]  7%|██                          | 76/1014 [00:00<00:11, 83.11batch/s]  8%|██▎                         | 86/1014 [00:01<00:11, 81.61batch/s]  9%|██▋                         | 96/1014 [00:01<00:11, 80.92batch/s] 10%|██▊                        | 106/1014 [00:01<00:11, 81.54batch/s] 11%|███                        | 116/1014 [00:01<00:10, 82.33batch/s] 12%|███▎                       | 126/1014 [00:01<00:10, 82.57batch/s] 13%|███▌                       | 136/1014 [00:01<00:10, 83.15batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 82.93batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 83.16batch/s] 16%|████▍                      | 166/1014 [00:02<00:10, 82.96batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 83.02batch/s] 18%|████▉                      | 186/1014 [00:02<00:09, 83.30batch/s] 19%|█████▏                     | 196/1014 [00:02<00:09, 83.82batch/s] 20%|█████▍                     | 206/1014 [00:02<00:09, 83.93batch/s] 21%|█████▊                     | 216/1014 [00:02<00:09, 84.09batch/s] 22%|██████                     | 226/1014 [00:02<00:09, 84.22batch/s] 23%|██████▎                    | 236/1014 [00:02<00:09, 84.61batch/s] 24%|██████▌                    | 246/1014 [00:02<00:09, 84.55batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 84.08batch/s] 26%|███████                    | 266/1014 [00:03<00:08, 84.11batch/s] 27%|███████▎                   | 276/1014 [00:03<00:08, 84.20batch/s] 28%|███████▌                   | 286/1014 [00:03<00:08, 84.59batch/s] 29%|███████▉                   | 296/1014 [00:03<00:08, 84.03batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 84.13batch/s] 31%|████████▍                  | 316/1014 [00:03<00:08, 83.86batch/s] 32%|████████▋                  | 326/1014 [00:03<00:08, 83.47batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 83.63batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:07, 83.75batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:07, 83.87batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:07, 83.81batch/s] 37%|██████████                 | 376/1014 [00:04<00:07, 83.85batch/s] 38%|██████████▎                | 386/1014 [00:04<00:07, 83.64batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 83.77batch/s] 40%|██████████▊                | 406/1014 [00:04<00:07, 84.01batch/s] 41%|███████████                | 416/1014 [00:04<00:07, 84.18batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 83.91batch/s] 43%|███████████▌               | 436/1014 [00:05<00:06, 84.10batch/s] 44%|███████████▉               | 446/1014 [00:05<00:06, 84.37batch/s] 45%|████████████▏              | 456/1014 [00:05<00:06, 84.36batch/s] 46%|████████████▍              | 466/1014 [00:05<00:06, 84.15batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 83.97batch/s] 48%|████████████▉              | 486/1014 [00:05<00:06, 84.02batch/s] 49%|█████████████▏             | 496/1014 [00:05<00:06, 84.05batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 84.18batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:05, 84.42batch/s] 52%|██████████████             | 526/1014 [00:06<00:05, 84.40batch/s] 53%|██████████████▎            | 536/1014 [00:06<00:05, 84.44batch/s] 54%|██████████████▌            | 546/1014 [00:06<00:05, 84.16batch/s] 55%|██████████████▊            | 556/1014 [00:06<00:05, 84.10batch/s] 56%|███████████████            | 566/1014 [00:06<00:05, 83.92batch/s] 57%|███████████████▎           | 576/1014 [00:06<00:05, 83.77batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 83.70batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 83.55batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:04, 83.56batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 83.43batch/s] 62%|████████████████▋          | 626/1014 [00:07<00:04, 83.46batch/s] 63%|████████████████▉          | 636/1014 [00:07<00:04, 83.33batch/s] 64%|█████████████████▏         | 646/1014 [00:07<00:04, 83.38batch/s] 65%|█████████████████▍         | 656/1014 [00:07<00:04, 83.51batch/s] 66%|█████████████████▋         | 666/1014 [00:07<00:04, 83.69batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 83.70batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:03, 83.82batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:03, 83.90batch/s] 70%|██████████████████▊        | 706/1014 [00:08<00:03, 83.95batch/s] 71%|███████████████████        | 716/1014 [00:08<00:03, 83.96batch/s] 72%|███████████████████▎       | 727/1014 [00:08<00:03, 84.21batch/s] 73%|███████████████████▋       | 738/1014 [00:08<00:03, 84.13batch/s] 74%|███████████████████▉       | 749/1014 [00:08<00:03, 84.12batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 84.11batch/s] 76%|████████████████████▌      | 771/1014 [00:09<00:02, 83.96batch/s] 77%|████████████████████▊      | 782/1014 [00:09<00:02, 84.11batch/s] 78%|█████████████████████      | 793/1014 [00:09<00:02, 84.14batch/s] 79%|█████████████████████▍     | 804/1014 [00:09<00:02, 84.04batch/s] 80%|█████████████████████▋     | 815/1014 [00:09<00:02, 84.09batch/s] 81%|█████████████████████▉     | 826/1014 [00:09<00:02, 84.14batch/s] 83%|██████████████████████▎    | 837/1014 [00:09<00:02, 84.19batch/s] 84%|██████████████████████▌    | 848/1014 [00:10<00:01, 84.09batch/s] 85%|██████████████████████▊    | 859/1014 [00:10<00:01, 84.21batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 84.28batch/s] 87%|███████████████████████▍   | 881/1014 [00:10<00:01, 84.12batch/s] 88%|███████████████████████▊   | 892/1014 [00:10<00:01, 84.10batch/s] 89%|████████████████████████   | 903/1014 [00:10<00:01, 83.98batch/s] 90%|████████████████████████▎  | 914/1014 [00:10<00:01, 84.05batch/s] 91%|████████████████████████▋  | 925/1014 [00:11<00:01, 83.91batch/s] 92%|████████████████████████▉  | 936/1014 [00:11<00:00, 83.99batch/s] 93%|█████████████████████████▏ | 947/1014 [00:11<00:00, 84.03batch/s] 94%|█████████████████████████▌ | 958/1014 [00:11<00:00, 84.09batch/s] 96%|█████████████████████████▊ | 969/1014 [00:11<00:00, 84.08batch/s] 97%|██████████████████████████ | 980/1014 [00:11<00:00, 84.17batch/s] 98%|██████████████████████████▍| 991/1014 [00:11<00:00, 84.20batch/s] 99%|█████████████████████████▋| 1002/1014 [00:11<00:00, 84.14batch/s]100%|█████████████████████████▉| 1013/1014 [00:12<00:00, 84.20batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 84.18batch/s]
Validation 32 -> LOSS = 2.20
Validation 32 -> BLEU = 20.07, 51.7/26.0/15.6/9.5 (BP=0.949, ratio=0.950, hyp_len=12193, ref_len=12828)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 33
Epoch 33 - update      15270 => loss:   1.688 (#OOM: 0)
Epoch 33 - update      15300 => loss:   1.980 (#OOM: 0)
Epoch 33 - update      15330 => loss:   2.114 (#OOM: 0)
Epoch 33 - update      15360 => loss:   1.540 (#OOM: 0)
Epoch 33 - update      15390 => loss:   1.578 (#OOM: 0)
Epoch 33 - update      15420 => loss:   1.363 (#OOM: 0)
Epoch 33 - update      15450 => loss:   1.500 (#OOM: 0)
Epoch 33 - update      15480 => loss:   2.396 (#OOM: 0)
Epoch 33 - update      15510 => loss:   1.453 (#OOM: 0)
Epoch 33 - update      15540 => loss:   2.116 (#OOM: 0)
Epoch 33 - update      15570 => loss:   1.572 (#OOM: 0)
Epoch 33 - update      15600 => loss:   1.967 (#OOM: 0)
Epoch 33 - update      15630 => loss:   1.458 (#OOM: 0)
Epoch 33 - update      15660 => loss:   2.004 (#OOM: 0)
Epoch 33 - update      15690 => loss:   1.719 (#OOM: 0)
Epoch 33 - update      15720 => loss:   1.882 (#OOM: 0)
--> Epoch 33 finished with mean loss 1.77361
--> Overhead/Training/Evaluation: 0.03/0.54/0.00 mins (total: 0.57 mins)   (900 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.56batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.52batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 53.69batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 54.64batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 53.30batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.81batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 87.62batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 86.12batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 85.67batch/s]  4%|█                           | 38/1014 [00:00<00:12, 80.21batch/s]  5%|█▎                          | 48/1014 [00:00<00:11, 80.79batch/s]  6%|█▌                          | 58/1014 [00:00<00:11, 81.22batch/s]  7%|█▉                          | 68/1014 [00:00<00:11, 81.32batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 82.07batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 80.59batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 79.26batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 78.86batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 78.89batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 78.22batch/s] 14%|███▋                       | 138/1014 [00:01<00:11, 78.55batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 78.86batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 79.45batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 80.01batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 80.55batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 80.20batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 80.63batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 80.85batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 81.26batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 81.17batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 80.87batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 80.90batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 80.51batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 80.46batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 80.57batch/s] 28%|███████▋                   | 288/1014 [00:03<00:09, 80.50batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 80.29batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 80.26batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 80.25batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 80.19batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 79.99batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 79.95batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 80.00batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 79.82batch/s] 37%|██████████                 | 378/1014 [00:04<00:07, 79.92batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 80.05batch/s] 39%|██████████▌                | 398/1014 [00:04<00:07, 80.11batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 80.19batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 80.45batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 80.68batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 80.78batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 80.73batch/s] 45%|████████████▏              | 458/1014 [00:05<00:06, 80.64batch/s] 46%|████████████▍              | 468/1014 [00:05<00:06, 80.35batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 80.49batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 80.35batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 80.48batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 80.60batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 80.71batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 80.80batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:05, 80.90batch/s] 54%|██████████████▌            | 548/1014 [00:06<00:05, 80.90batch/s] 55%|██████████████▊            | 558/1014 [00:06<00:05, 80.74batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 80.72batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 80.86batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 80.93batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 80.99batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 81.18batch/s] 61%|████████████████▍          | 618/1014 [00:07<00:04, 81.21batch/s] 62%|████████████████▋          | 628/1014 [00:07<00:04, 81.18batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 81.28batch/s] 64%|█████████████████▎         | 648/1014 [00:07<00:04, 81.32batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 81.63batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 81.49batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 81.30batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:03, 81.27batch/s] 69%|██████████████████▋        | 703/1014 [00:08<00:03, 81.18batch/s] 70%|███████████████████        | 714/1014 [00:08<00:03, 81.15batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 81.03batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 81.15batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 81.01batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 80.89batch/s] 76%|████████████████████▍      | 769/1014 [00:09<00:03, 80.89batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 80.79batch/s] 78%|█████████████████████      | 791/1014 [00:09<00:02, 80.76batch/s] 79%|█████████████████████▎     | 802/1014 [00:09<00:02, 80.63batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 80.54batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 80.43batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 80.52batch/s] 83%|██████████████████████▌    | 846/1014 [00:10<00:02, 80.62batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 80.72batch/s] 86%|███████████████████████    | 868/1014 [00:10<00:01, 80.77batch/s] 87%|███████████████████████▍   | 879/1014 [00:10<00:01, 80.74batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 80.76batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 80.74batch/s] 90%|████████████████████████▎  | 912/1014 [00:11<00:01, 80.70batch/s] 91%|████████████████████████▌  | 923/1014 [00:11<00:01, 80.72batch/s] 92%|████████████████████████▊  | 934/1014 [00:11<00:00, 80.75batch/s] 93%|█████████████████████████▏ | 945/1014 [00:11<00:00, 80.72batch/s] 94%|█████████████████████████▍ | 956/1014 [00:11<00:00, 80.70batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 80.72batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 80.91batch/s] 98%|██████████████████████████▎| 989/1014 [00:12<00:00, 80.95batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 81.03batch/s]100%|█████████████████████████▉| 1011/1014 [00:12<00:00, 81.15batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.15batch/s]
Validation 33 -> LOSS = 2.20
Validation 33 -> BLEU = 20.57, 51.3/25.8/15.3/9.3 (BP=0.987, ratio=0.987, hyp_len=12664, ref_len=12828)
** Learning rate changed -> 2.5e-05
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 34
Epoch 34 - update      15750 => loss:   1.824 (#OOM: 0)
Epoch 34 - update      15780 => loss:   1.899 (#OOM: 0)
Epoch 34 - update      15810 => loss:   1.372 (#OOM: 0)
Epoch 34 - update      15840 => loss:   2.066 (#OOM: 0)
Epoch 34 - update      15870 => loss:   1.263 (#OOM: 0)
Epoch 34 - update      15900 => loss:   1.465 (#OOM: 0)
Epoch 34 - update      15930 => loss:   1.856 (#OOM: 0)
Epoch 34 - update      15960 => loss:   1.836 (#OOM: 0)
Epoch 34 - update      15990 => loss:   1.368 (#OOM: 0)
Epoch 34 - update      16020 => loss:   2.185 (#OOM: 0)
Epoch 34 - update      16050 => loss:   1.920 (#OOM: 0)
Epoch 34 - update      16080 => loss:   2.141 (#OOM: 0)
Epoch 34 - update      16110 => loss:   1.142 (#OOM: 0)
Epoch 34 - update      16140 => loss:   1.604 (#OOM: 0)
Epoch 34 - update      16170 => loss:   1.714 (#OOM: 0)
Epoch 34 - update      16200 => loss:   1.478 (#OOM: 0)
--> Epoch 34 finished with mean loss 1.76277
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (878 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 55.71batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.38batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 56.65batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 56.93batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 54.47batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.38batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 84.26batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 85.20batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.54batch/s]  4%|█                           | 37/1014 [00:00<00:11, 83.82batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 83.23batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 83.70batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 83.86batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 85.08batch/s]  9%|██▍                         | 87/1014 [00:01<00:10, 84.90batch/s] 10%|██▋                         | 97/1014 [00:01<00:10, 84.95batch/s] 11%|██▊                        | 107/1014 [00:01<00:10, 84.33batch/s] 12%|███                        | 117/1014 [00:01<00:10, 83.55batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 83.63batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 82.75batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 82.74batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 82.83batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 82.92batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 83.54batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 82.62batch/s] 19%|█████▏                     | 197/1014 [00:02<00:09, 82.85batch/s] 20%|█████▌                     | 207/1014 [00:02<00:09, 82.18batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 81.50batch/s] 22%|██████                     | 227/1014 [00:02<00:09, 81.46batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 81.35batch/s] 24%|██████▌                    | 247/1014 [00:03<00:09, 81.18batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 81.44batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 81.42batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 81.04batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 80.73batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 80.73batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 80.67batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 80.80batch/s] 32%|████████▋                  | 327/1014 [00:04<00:08, 80.56batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 80.34batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 80.40batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 80.27batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 80.31batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 80.36batch/s] 38%|██████████▎                | 387/1014 [00:04<00:07, 80.05batch/s] 39%|██████████▌                | 397/1014 [00:04<00:07, 79.81batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 80.00batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 80.03batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 79.88batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 79.92batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 80.15batch/s] 45%|████████████▏              | 457/1014 [00:05<00:06, 80.11batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 80.17batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 80.18batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 80.20batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 80.24batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 80.35batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 80.48batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 80.52batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 80.43batch/s] 54%|██████████████▌            | 547/1014 [00:06<00:05, 80.69batch/s] 55%|██████████████▊            | 557/1014 [00:06<00:05, 80.51batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 80.45batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 80.48batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 80.65batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 80.74batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 80.79batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:04, 80.70batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 80.65batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 80.74batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 80.83batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 80.83batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 80.86batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 80.94batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:04, 80.84batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:03, 80.96batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 80.86batch/s] 71%|███████████████████        | 717/1014 [00:08<00:03, 80.83batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 80.74batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 80.85batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 80.77batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 80.82batch/s] 76%|████████████████████▍      | 767/1014 [00:09<00:03, 80.74batch/s] 77%|████████████████████▋      | 777/1014 [00:09<00:02, 80.83batch/s] 78%|████████████████████▉      | 787/1014 [00:09<00:02, 80.78batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 80.86batch/s] 80%|█████████████████████▍     | 807/1014 [00:09<00:02, 80.87batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 80.72batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 80.68batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 80.65batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 80.66batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 80.52batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 80.53batch/s] 86%|███████████████████████▎   | 877/1014 [00:10<00:01, 80.53batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 80.39batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 80.22batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 80.23batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 80.21batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 80.23batch/s] 92%|████████████████████████▉  | 937/1014 [00:11<00:00, 80.14batch/s] 93%|█████████████████████████▏ | 947/1014 [00:11<00:00, 80.11batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 80.19batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 80.16batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 80.17batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 80.16batch/s] 98%|██████████████████████████▌| 997/1014 [00:12<00:00, 80.18batch/s] 99%|█████████████████████████▊| 1007/1014 [00:12<00:00, 80.16batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.18batch/s]
Validation 34 -> LOSS = 2.20
Validation 34 -> BLEU = 20.54, 51.4/25.8/15.3/9.3 (BP=0.983, ratio=0.984, hyp_len=12618, ref_len=12828)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 35
Epoch 35 - update      16230 => loss:   1.546 (#OOM: 0)
Epoch 35 - update      16260 => loss:   1.619 (#OOM: 0)
Epoch 35 - update      16290 => loss:   1.262 (#OOM: 0)
Epoch 35 - update      16320 => loss:   1.079 (#OOM: 0)
Epoch 35 - update      16350 => loss:   2.015 (#OOM: 0)
Epoch 35 - update      16380 => loss:   1.515 (#OOM: 0)
Epoch 35 - update      16410 => loss:   1.611 (#OOM: 0)
Epoch 35 - update      16440 => loss:   1.606 (#OOM: 0)
Epoch 35 - update      16470 => loss:   1.802 (#OOM: 0)
Epoch 35 - update      16500 => loss:   1.317 (#OOM: 0)
Epoch 35 - update      16530 => loss:   1.762 (#OOM: 0)
Epoch 35 - update      16560 => loss:   1.382 (#OOM: 0)
Epoch 35 - update      16590 => loss:   1.483 (#OOM: 0)
Epoch 35 - update      16620 => loss:   2.202 (#OOM: 0)
Epoch 35 - update      16650 => loss:   1.284 (#OOM: 0)
Epoch 35 - update      16680 => loss:   1.373 (#OOM: 0)
--> Epoch 35 finished with mean loss 1.75877
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (880 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 44.43batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 57.58batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 55.87batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 54.74batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.28batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.42batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 80.02batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 81.00batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 79.07batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 79.74batch/s]  5%|█▍                          | 53/1014 [00:00<00:11, 81.18batch/s]  6%|█▋                          | 62/1014 [00:00<00:11, 81.18batch/s]  7%|█▉                          | 71/1014 [00:00<00:11, 79.88batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 80.19batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 81.65batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 81.73batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 80.89batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 80.47batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 81.38batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 80.90batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 80.76batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 80.28batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 80.25batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 80.84batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 79.47batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 79.51batch/s] 21%|█████▌                     | 210/1014 [00:02<00:10, 79.67batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 79.70batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 79.50batch/s] 24%|██████▍                    | 240/1014 [00:03<00:09, 79.71batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 80.15batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 79.62batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 79.14batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 79.63batch/s] 29%|███████▋                   | 290/1014 [00:03<00:09, 79.69batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 79.42batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 79.56batch/s] 32%|████████▌                  | 320/1014 [00:04<00:08, 79.86batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 80.02batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 80.29batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 80.45batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 80.65batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:07, 80.62batch/s] 37%|██████████                 | 380/1014 [00:04<00:07, 80.87batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 80.72batch/s] 39%|██████████▋                | 400/1014 [00:04<00:07, 80.70batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 80.60batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 80.80batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 80.64batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 80.64batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 80.75batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 80.82batch/s] 46%|████████████▌              | 470/1014 [00:05<00:06, 80.85batch/s] 47%|████████████▊              | 480/1014 [00:05<00:06, 80.86batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 80.51batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 80.43batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 80.54batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 80.53batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 80.45batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:05, 80.52batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 80.51batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 80.57batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 80.64batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 80.79batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 80.86batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 80.82batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 80.59batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 80.39batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 80.30batch/s] 63%|█████████████████          | 640/1014 [00:07<00:04, 80.31batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 80.27batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 80.23batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 80.14batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 79.83batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:04, 79.89batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 79.82batch/s] 70%|██████████████████▉        | 710/1014 [00:08<00:03, 79.87batch/s] 71%|███████████████████▏       | 720/1014 [00:09<00:03, 79.90batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 80.03batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 79.96batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 80.04batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 80.10batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:03, 80.22batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 80.26batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 80.33batch/s] 79%|█████████████████████▎     | 800/1014 [00:09<00:02, 80.32batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 80.37batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 80.38batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 80.46batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 80.47batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 80.42batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 80.42batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 80.50batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 80.56batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 80.64batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 80.67batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 80.72batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 80.80batch/s] 92%|████████████████████████▊  | 930/1014 [00:11<00:01, 80.80batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 80.84batch/s] 94%|█████████████████████████▎ | 950/1014 [00:11<00:00, 80.94batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 80.95batch/s] 96%|█████████████████████████▊ | 970/1014 [00:11<00:00, 80.95batch/s] 97%|██████████████████████████ | 980/1014 [00:12<00:00, 80.84batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 80.96batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 80.94batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 81.00batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.04batch/s]
Validation 35 -> LOSS = 2.20
Validation 35 -> BLEU = 20.44, 51.0/25.6/15.1/9.2 (BP=0.991, ratio=0.992, hyp_len=12719, ref_len=12828)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 36
Epoch 36 - update      16710 => loss:   2.044 (#OOM: 0)
Epoch 36 - update      16740 => loss:   1.172 (#OOM: 0)
Epoch 36 - update      16770 => loss:   1.702 (#OOM: 0)
Epoch 36 - update      16800 => loss:   2.094 (#OOM: 0)
Epoch 36 - update      16830 => loss:   2.300 (#OOM: 0)
Epoch 36 - update      16860 => loss:   1.142 (#OOM: 0)
Epoch 36 - update      16890 => loss:   1.422 (#OOM: 0)
Epoch 36 - update      16920 => loss:   1.490 (#OOM: 0)
Epoch 36 - update      16950 => loss:   2.471 (#OOM: 0)
Epoch 36 - update      16980 => loss:   1.985 (#OOM: 0)
Epoch 36 - update      17010 => loss:   1.836 (#OOM: 0)
Epoch 36 - update      17040 => loss:   2.228 (#OOM: 0)
Epoch 36 - update      17070 => loss:   1.493 (#OOM: 0)
Epoch 36 - update      17100 => loss:   1.964 (#OOM: 0)
Epoch 36 - update      17130 => loss:   2.029 (#OOM: 0)
Epoch 36 - update      17160 => loss:   1.258 (#OOM: 0)
--> Epoch 36 finished with mean loss 1.75890
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (793 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.11batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.67batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.09batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 53.46batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 55.88batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.89batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 95.57batch/s]  2%|▌                           | 20/1014 [00:00<00:12, 82.27batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 86.20batch/s]  4%|█                           | 40/1014 [00:00<00:11, 86.38batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 84.67batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 84.83batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 85.18batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 83.49batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 83.84batch/s] 10%|██▋                        | 100/1014 [00:01<00:10, 83.35batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 82.93batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 82.51batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 82.23batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 81.70batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 82.23batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 82.11batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 82.19batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 80.69batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 80.54batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 80.64batch/s] 21%|█████▌                     | 210/1014 [00:02<00:09, 80.74batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 80.28batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 80.64batch/s] 24%|██████▍                    | 240/1014 [00:02<00:09, 80.88batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 81.12batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 81.36batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 81.02batch/s] 28%|███████▍                   | 280/1014 [00:03<00:09, 81.23batch/s] 29%|███████▋                   | 290/1014 [00:03<00:08, 81.27batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 81.24batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 81.12batch/s] 32%|████████▌                  | 320/1014 [00:03<00:08, 80.44batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 80.50batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 79.96batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 80.20batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:08, 80.51batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:08, 80.46batch/s] 37%|██████████                 | 380/1014 [00:04<00:07, 80.11batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 80.37batch/s] 39%|██████████▋                | 400/1014 [00:04<00:07, 80.74batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 80.14batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 80.27batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 80.38batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 80.44batch/s] 44%|███████████▉               | 450/1014 [00:05<00:07, 80.56batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 80.48batch/s] 46%|████████████▌              | 470/1014 [00:05<00:06, 80.39batch/s] 47%|████████████▊              | 480/1014 [00:05<00:06, 80.20batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 80.35batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 80.19batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 80.33batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 80.56batch/s] 52%|██████████████             | 530/1014 [00:06<00:06, 80.50batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:05, 80.42batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 80.35batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 80.44batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 80.50batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 80.46batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 80.43batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 80.57batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:05, 80.66batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 80.50batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 80.43batch/s] 63%|█████████████████          | 640/1014 [00:07<00:04, 80.59batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 80.64batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 80.77batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 80.75batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 80.73batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:04, 80.82batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 80.92batch/s] 70%|██████████████████▉        | 710/1014 [00:08<00:03, 80.95batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 80.98batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 80.97batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 80.93batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 81.11batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 81.30batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:03, 81.27batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 81.36batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 81.19batch/s] 79%|█████████████████████▎     | 800/1014 [00:09<00:02, 81.15batch/s] 80%|█████████████████████▌     | 810/1014 [00:09<00:02, 81.04batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 80.96batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 80.94batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 80.94batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 80.76batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 80.81batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 80.77batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 80.57batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 80.77batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 80.73batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 80.76batch/s] 91%|████████████████████████▌  | 924/1014 [00:11<00:01, 80.75batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 80.77batch/s] 93%|█████████████████████████▏ | 946/1014 [00:11<00:00, 80.54batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 80.36batch/s] 95%|█████████████████████████▊ | 968/1014 [00:12<00:00, 80.37batch/s] 97%|██████████████████████████ | 979/1014 [00:12<00:00, 80.37batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 80.42batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 80.34batch/s]100%|█████████████████████████▉| 1012/1014 [00:12<00:00, 80.46batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.48batch/s]
Validation 36 -> LOSS = 2.20
Validation 36 -> BLEU = 20.48, 51.6/26.0/15.5/9.4 (BP=0.975, ratio=0.975, hyp_len=12511, ref_len=12828)
** Learning rate changed -> 1.25e-05
Early stopping patience: 1
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 37
Epoch 37 - update      17190 => loss:   1.390 (#OOM: 0)
Epoch 37 - update      17220 => loss:   1.360 (#OOM: 0)
Epoch 37 - update      17250 => loss:   1.221 (#OOM: 0)
Epoch 37 - update      17280 => loss:   2.080 (#OOM: 0)
Epoch 37 - update      17310 => loss:   2.173 (#OOM: 0)
Epoch 37 - update      17340 => loss:   2.070 (#OOM: 0)
Epoch 37 - update      17370 => loss:   1.714 (#OOM: 0)
Epoch 37 - update      17400 => loss:   1.554 (#OOM: 0)
Epoch 37 - update      17430 => loss:   1.199 (#OOM: 0)
Epoch 37 - update      17460 => loss:   1.784 (#OOM: 0)
Epoch 37 - update      17490 => loss:   1.551 (#OOM: 0)
Epoch 37 - update      17520 => loss:   1.986 (#OOM: 0)
Epoch 37 - update      17550 => loss:   1.908 (#OOM: 0)
Epoch 37 - update      17580 => loss:   1.429 (#OOM: 0)
Epoch 37 - update      17610 => loss:   2.106 (#OOM: 0)
Epoch 37 - update      17640 => loss:   1.824 (#OOM: 0)
--> Epoch 37 finished with mean loss 1.75294
--> Overhead/Training/Evaluation: 0.03/0.55/0.00 mins (total: 0.58 mins)   (884 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.81batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.31batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.85batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.75batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 53.36batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.70batch/s]
Performing greedy search (args: {'k': 1})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.89batch/s]  2%|▍                           | 16/1014 [00:00<00:13, 76.68batch/s]  2%|▋                           | 24/1014 [00:00<00:12, 76.21batch/s]  3%|▉                           | 34/1014 [00:00<00:12, 80.83batch/s]  4%|█▏                          | 44/1014 [00:00<00:11, 81.32batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 81.87batch/s]  6%|█▊                          | 64/1014 [00:00<00:11, 80.61batch/s]  7%|██                          | 74/1014 [00:00<00:11, 82.36batch/s]  8%|██▎                         | 84/1014 [00:01<00:11, 81.27batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 81.18batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 80.38batch/s] 11%|███                        | 114/1014 [00:01<00:11, 80.82batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 80.64batch/s] 13%|███▌                       | 134/1014 [00:01<00:10, 80.05batch/s] 14%|███▊                       | 144/1014 [00:01<00:10, 80.29batch/s] 15%|████                       | 154/1014 [00:01<00:10, 80.50batch/s] 16%|████▎                      | 164/1014 [00:02<00:10, 80.49batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 80.64batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 79.96batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 79.59batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 79.92batch/s] 21%|█████▋                     | 214/1014 [00:02<00:09, 80.17batch/s] 22%|█████▉                     | 224/1014 [00:02<00:09, 80.74batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 80.77batch/s] 24%|██████▍                    | 244/1014 [00:03<00:09, 80.95batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 80.33batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 80.49batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 80.48batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 80.91batch/s] 29%|███████▊                   | 294/1014 [00:03<00:08, 80.95batch/s] 30%|████████                   | 304/1014 [00:03<00:08, 80.83batch/s] 31%|████████▎                  | 314/1014 [00:03<00:08, 80.90batch/s] 32%|████████▋                  | 324/1014 [00:03<00:08, 81.18batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 81.09batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 81.12batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 81.35batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:07, 81.64batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 81.72batch/s] 38%|██████████▏                | 384/1014 [00:04<00:07, 81.64batch/s] 39%|██████████▍                | 394/1014 [00:04<00:07, 81.77batch/s] 40%|██████████▊                | 404/1014 [00:04<00:07, 81.66batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 81.57batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 81.72batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 81.47batch/s] 44%|███████████▊               | 444/1014 [00:05<00:06, 81.58batch/s] 45%|████████████               | 454/1014 [00:05<00:06, 81.60batch/s] 46%|████████████▎              | 464/1014 [00:05<00:06, 81.22batch/s] 47%|████████████▌              | 474/1014 [00:05<00:06, 81.04batch/s] 48%|████████████▉              | 484/1014 [00:05<00:06, 80.95batch/s] 49%|█████████████▏             | 494/1014 [00:06<00:06, 81.14batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 81.49batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:06, 81.59batch/s] 52%|██████████████             | 527/1014 [00:06<00:05, 81.36batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:05, 81.36batch/s] 54%|██████████████▌            | 549/1014 [00:06<00:05, 81.30batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 81.40batch/s] 56%|███████████████▏           | 571/1014 [00:06<00:05, 81.59batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 81.47batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 81.43batch/s] 60%|████████████████           | 604/1014 [00:07<00:05, 81.40batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:04, 81.37batch/s] 62%|████████████████▋          | 626/1014 [00:07<00:04, 81.48batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 81.53batch/s] 64%|█████████████████▎         | 648/1014 [00:07<00:04, 81.60batch/s] 65%|█████████████████▌         | 659/1014 [00:08<00:04, 81.47batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 81.42batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 81.46batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:03, 81.40batch/s] 69%|██████████████████▋        | 703/1014 [00:08<00:03, 81.50batch/s] 70%|███████████████████        | 714/1014 [00:08<00:03, 81.34batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 81.42batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 81.32batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 81.26batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 81.26batch/s] 76%|████████████████████▍      | 769/1014 [00:09<00:03, 81.38batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 81.41batch/s] 78%|█████████████████████      | 791/1014 [00:09<00:02, 81.34batch/s] 79%|█████████████████████▎     | 802/1014 [00:09<00:02, 81.31batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 81.18batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 81.09batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 81.11batch/s] 83%|██████████████████████▌    | 846/1014 [00:10<00:02, 81.03batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 80.90batch/s] 86%|███████████████████████    | 868/1014 [00:10<00:01, 80.89batch/s] 87%|███████████████████████▍   | 879/1014 [00:10<00:01, 80.80batch/s] 88%|███████████████████████▋   | 890/1014 [00:11<00:01, 80.86batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 80.85batch/s] 90%|████████████████████████▎  | 912/1014 [00:11<00:01, 80.91batch/s] 91%|████████████████████████▌  | 923/1014 [00:11<00:01, 80.97batch/s] 92%|████████████████████████▊  | 934/1014 [00:11<00:00, 80.89batch/s] 93%|█████████████████████████▏ | 945/1014 [00:11<00:00, 80.93batch/s] 94%|█████████████████████████▍ | 956/1014 [00:11<00:00, 80.93batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 80.89batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 80.91batch/s] 98%|██████████████████████████▎| 989/1014 [00:12<00:00, 80.95batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 80.91batch/s]100%|█████████████████████████▉| 1011/1014 [00:12<00:00, 80.96batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.95batch/s]
Validation 37 -> LOSS = 2.20
Validation 37 -> BLEU = 20.19, 51.1/25.5/15.0/9.1 (BP=0.982, ratio=0.982, hyp_len=12603, ref_len=12828)
Early stopping patience: 0
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Starting Epoch 38
Early stopped.
--> This is model: simultaneouswaitknmt-r7b06f
--> Best LOSS so far: 2.18 @ validation 22
--> Best BLEU so far: 20.86 @ validation 27
Training finished on 23-04-2020 18:47
Thu Apr 23 18:47:51 2020       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 435.21       Driver Version: 435.21       CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  TITAN Xp            On   | 00000000:B3:00.0 Off |                  N/A |
| 23%   40C    P0    63W / 250W |      0MiB / 12196MiB |     22%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
 18:47:51 up 112 days,  4:02,  4 users,  load average: 21.77, 22.52, 24.82
