-------
[train]
-------
         num_workers:0
          pin_memory:False
                seed:1582660384
               gclip:1
              l2_reg:1e-05
            patience:10
           optimizer:adam
                  lr:0.0004
            lr_decay:plateau
     lr_decay_revert:False
     lr_decay_factor:0.5
   lr_decay_patience:2
        lr_decay_min:1e-06
          model_type:SimultaneousWaitKNMT
            momentum:0.0
            nesterov:False
           disp_freq:30
          batch_size:64
          max_epochs:100
      max_iterations:1000000
        eval_metrics:bleu,loss
        eval_filters:
             de-hyphen
     eval_batch_size:32
           eval_freq:0
        eval_max_len:100
          eval_start:1
           eval_zero:False
   save_best_metrics:True
           save_path:/homes/al4616/experiments/simnmt/nmtpy/w2w_models/en-de
    save_optim_state:False
     checkpoint_freq:5000
       n_checkpoints:0
     tensorboard_dir:/homes/al4616/experiments/simnmt/nmtpy/w2w_models/en-de/tb_dir
     pretrained_file:
   pretrained_layers:
       freeze_layers:
          handle_oom:False
           subfolder:wait2-rnn-unimodal
              exp_id:simultaneouswaitknmt-r9aa11
------
[vars]
------
                  sl:en
                  tl:de
-------
[model]
-------
            att_type:mlp
      att_bottleneck:hid
             enc_dim:320
   enc_bidirectional:False
             dec_dim:320
             emb_dim:200
         dropout_emb:0.4
         dropout_ctx:0.5
         dropout_out:0.5
          n_encoders:2
            tied_emb:2way
             max_len:None
           out_logic:deep
           direction:src:Text -> trg:Text
        sampler_type:bucket
           bucket_by:src
     translator_args:
                     k:2
------
[data]
------
            txt_root:/vol/bitbucket/al4616/simmt/data/multi30k/en-de
           train_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/train.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/train.lc.norm.tok.de
             val_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/val.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/val.lc.norm.tok.de
test_2016_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/test_2016_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/test_2016_flickr.lc.norm.tok.de
test_2017_flickr_set:
                   src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/test_2017_flickr.lc.norm.tok.en
                   trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/test_2017_flickr.lc.norm.tok.de
------------
[vocabulary]
------------
                 src:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/train.lc.norm.tok.vocab.en
                 trg:/vol/bitbucket/al4616/simmt/data/multi30k/en-de/train.lc.norm.tok-min2.vocab.de
----------------------------------------------------------------------

Python 3.7.7 -- torch 1.4.0 with CUDA 10.1 (on machine 'kingfisher.doc.ic.ac.uk')
nmtpytorch 4.1.0
DeviceManager(cuda:0, n_gpu=1)
Seed for further reproducibility: 1582660384
SLURM Job ID: 4756
Loading dataset(s)
Initializing dataset for 'src'...
0sents [00:00, ?sents/s]16752sents [00:00, 167476.24sents/s]29000sents [00:00, 167201.14sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]15568sents [00:00, 155635.62sents/s]29000sents [00:00, 155504.86sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'train.lc.norm.tok.en' (29000 sentences)
  Targets:
    --> TextDataset 'train.lc.norm.tok.de' (29000 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 120016.49sents/s]
Initializing dataset for 'trg'...
0sents [00:00, ?sents/s]1014sents [00:00, 19402.93sents/s]
MultimodalDataset - (1 source(s) / 1 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)
  Targets:
    --> TextDataset 'val.lc.norm.tok.de' (1014 sentences)

Initializing dataset for 'src'...
0sents [00:00, ?sents/s]1014sents [00:00, 151380.11sents/s]
Skipping 'trg' as target
MultimodalDataset - (1 source(s) / 0 target(s))
  Sampler type: bucket, bucket_by: src
  Sources:
    --> TextDataset 'val.lc.norm.tok.en' (1014 sentences)

Ignoring batch_size 32 for simultaneous greedy search
SimultaneousWaitKNMT(
  (encoders): ModuleDict(
    (src): TextEncoder(
      (do_emb): Dropout(p=0.4, inplace=False)
      (emb): Embedding(9797, 200, padding_idx=0)
      (enc): GRU(200, 320, num_layers=2)
      (output): Sequential(
        (0): Dropout(p=0.5, inplace=False)
      )
    )
  )
  (dec): SimultaneousConditionalDecoder(
    (emb): Embedding(7875, 200, padding_idx=0)
    (att): ModuleDict(
      (src): MLPAttention(
        (hid2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2ctx): Linear(in_features=320, out_features=320, bias=False)
        (ctx2hid): Linear(in_features=320, out_features=320, bias=False)
        (mlp): Linear(in_features=320, out_features=1, bias=False)
      )
    )
    (dec0): GRUCell(200, 320)
    (dec1): GRUCell(320, 320)
    (do_out): Dropout(p=0.5, inplace=False)
    (hid2out): FF(in_features=840, out_features=200, activ=tanh, bias=True, bias_zero=True)
    (out2prob): FF(in_features=200, out_features=7875, activ=linear, bias=True, bias_zero=True)
    (nll_loss): NLLLoss()
  )
)
Vocabulary of 9797 items ('train.lc.norm.tok.vocab.en')
Vocabulary of 7875 items ('train.lc.norm.tok-min2.vocab.de')
# parameters: 6.25M (6.25M learnable)

Optimizer => adam (lr: 0.0004, weight_decay: 1e-05, g_clip: 1, lr_decay: (patience=2, factor=0.5))
TensorBoard is active
Training started on 24-04-2020 03:07:08
Starting Epoch 1
Epoch 1 - update         30 => loss:   6.376 (#OOM: 0)
Epoch 1 - update         60 => loss:   5.657 (#OOM: 0)
Epoch 1 - update         90 => loss:   5.166 (#OOM: 0)
Epoch 1 - update        120 => loss:   5.105 (#OOM: 0)
Epoch 1 - update        150 => loss:   4.295 (#OOM: 0)
Epoch 1 - update        180 => loss:   4.736 (#OOM: 0)
Epoch 1 - update        210 => loss:   4.737 (#OOM: 0)
Epoch 1 - update        240 => loss:   4.639 (#OOM: 0)
Epoch 1 - update        270 => loss:   4.368 (#OOM: 0)
Epoch 1 - update        300 => loss:   4.498 (#OOM: 0)
Epoch 1 - update        330 => loss:   4.333 (#OOM: 0)
Epoch 1 - update        360 => loss:   3.730 (#OOM: 0)
Epoch 1 - update        390 => loss:   4.337 (#OOM: 0)
Epoch 1 - update        420 => loss:   4.297 (#OOM: 0)
Epoch 1 - update        450 => loss:   4.602 (#OOM: 0)
--> Epoch 1 finished with mean loss 4.80364
--> Overhead/Training/Evaluation: 0.03/0.48/0.00 mins (total: 0.50 mins)   (1014 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 56.96batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 58.80batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 56.43batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 55.36batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 55.71batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.96batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 92.72batch/s]  2%|▌                           | 20/1014 [00:00<00:11, 88.29batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 85.80batch/s]  4%|█                           | 40/1014 [00:00<00:11, 83.22batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 82.90batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 82.32batch/s]  7%|█▉                          | 71/1014 [00:00<00:11, 84.79batch/s]  8%|██▎                         | 82/1014 [00:00<00:11, 83.71batch/s]  9%|██▌                         | 93/1014 [00:01<00:10, 83.88batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 80.95batch/s] 11%|███                        | 115/1014 [00:01<00:10, 81.91batch/s] 12%|███▎                       | 126/1014 [00:01<00:10, 82.30batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 83.53batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 84.35batch/s] 16%|████▏                      | 159/1014 [00:01<00:10, 84.93batch/s] 17%|████▌                      | 170/1014 [00:01<00:09, 85.38batch/s] 18%|████▊                      | 181/1014 [00:02<00:09, 85.87batch/s] 19%|█████                      | 192/1014 [00:02<00:09, 86.41batch/s] 20%|█████▍                     | 203/1014 [00:02<00:09, 86.95batch/s] 21%|█████▋                     | 214/1014 [00:02<00:09, 87.24batch/s] 22%|█████▉                     | 225/1014 [00:02<00:08, 87.83batch/s] 23%|██████▎                    | 236/1014 [00:02<00:08, 88.14batch/s] 24%|██████▌                    | 247/1014 [00:02<00:08, 88.29batch/s] 25%|██████▊                    | 258/1014 [00:02<00:08, 88.01batch/s] 27%|███████▏                   | 269/1014 [00:03<00:08, 88.37batch/s] 28%|███████▍                   | 280/1014 [00:03<00:08, 88.71batch/s] 29%|███████▋                   | 291/1014 [00:03<00:08, 88.98batch/s] 30%|████████                   | 302/1014 [00:03<00:08, 88.94batch/s] 31%|████████▎                  | 313/1014 [00:03<00:07, 89.05batch/s] 32%|████████▋                  | 324/1014 [00:03<00:07, 89.04batch/s] 33%|████████▉                  | 335/1014 [00:03<00:07, 88.89batch/s] 34%|█████████▏                 | 346/1014 [00:03<00:07, 89.07batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:07, 88.99batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 89.02batch/s] 37%|██████████                 | 379/1014 [00:04<00:07, 89.09batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 88.94batch/s] 40%|██████████▋                | 402/1014 [00:04<00:06, 89.45batch/s] 41%|███████████                | 414/1014 [00:04<00:06, 89.21batch/s] 42%|███████████▎               | 426/1014 [00:04<00:06, 89.29batch/s] 43%|███████████▋               | 438/1014 [00:04<00:06, 89.39batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 89.68batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 89.79batch/s] 47%|████████████▌              | 474/1014 [00:05<00:06, 89.54batch/s] 48%|████████████▉              | 486/1014 [00:05<00:05, 89.30batch/s] 49%|█████████████▎             | 498/1014 [00:05<00:05, 89.14batch/s] 50%|█████████████▌             | 510/1014 [00:05<00:05, 89.35batch/s] 51%|█████████████▉             | 522/1014 [00:05<00:05, 89.20batch/s] 53%|██████████████▏            | 534/1014 [00:05<00:05, 89.08batch/s] 54%|██████████████▌            | 546/1014 [00:06<00:05, 89.05batch/s] 55%|██████████████▊            | 558/1014 [00:06<00:05, 89.38batch/s] 56%|███████████████▏           | 570/1014 [00:06<00:04, 89.49batch/s] 57%|███████████████▍           | 582/1014 [00:06<00:04, 89.62batch/s] 59%|███████████████▊           | 594/1014 [00:06<00:04, 89.68batch/s] 60%|████████████████▏          | 606/1014 [00:06<00:04, 89.73batch/s] 61%|████████████████▍          | 618/1014 [00:06<00:04, 89.76batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 89.76batch/s] 63%|█████████████████          | 642/1014 [00:07<00:04, 89.90batch/s] 64%|█████████████████▍         | 654/1014 [00:07<00:03, 90.15batch/s] 66%|█████████████████▋         | 666/1014 [00:07<00:03, 90.21batch/s] 67%|██████████████████         | 678/1014 [00:07<00:03, 90.00batch/s] 68%|██████████████████▎        | 690/1014 [00:07<00:03, 90.20batch/s] 69%|██████████████████▋        | 702/1014 [00:07<00:03, 90.27batch/s] 70%|███████████████████        | 714/1014 [00:07<00:03, 90.15batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 90.23batch/s] 73%|███████████████████▋       | 738/1014 [00:08<00:03, 90.24batch/s] 74%|███████████████████▉       | 750/1014 [00:08<00:02, 90.24batch/s] 75%|████████████████████▎      | 762/1014 [00:08<00:02, 90.25batch/s] 76%|████████████████████▌      | 774/1014 [00:08<00:02, 90.26batch/s] 78%|████████████████████▉      | 786/1014 [00:08<00:02, 90.42batch/s] 79%|█████████████████████▏     | 798/1014 [00:08<00:02, 90.28batch/s] 80%|█████████████████████▌     | 810/1014 [00:08<00:02, 90.29batch/s] 81%|█████████████████████▉     | 822/1014 [00:09<00:02, 90.48batch/s] 82%|██████████████████████▏    | 834/1014 [00:09<00:01, 90.36batch/s] 83%|██████████████████████▌    | 846/1014 [00:09<00:01, 90.45batch/s] 85%|██████████████████████▊    | 858/1014 [00:09<00:01, 90.39batch/s] 86%|███████████████████████▏   | 870/1014 [00:09<00:01, 90.51batch/s] 87%|███████████████████████▍   | 882/1014 [00:09<00:01, 90.56batch/s] 88%|███████████████████████▊   | 894/1014 [00:09<00:01, 90.48batch/s] 89%|████████████████████████   | 906/1014 [00:10<00:01, 90.59batch/s] 91%|████████████████████████▍  | 918/1014 [00:10<00:01, 90.76batch/s] 92%|████████████████████████▊  | 930/1014 [00:10<00:00, 90.91batch/s] 93%|█████████████████████████  | 942/1014 [00:10<00:00, 90.86batch/s] 94%|█████████████████████████▍ | 954/1014 [00:10<00:00, 90.80batch/s] 95%|█████████████████████████▋ | 966/1014 [00:10<00:00, 90.85batch/s] 96%|██████████████████████████ | 978/1014 [00:10<00:00, 90.86batch/s] 98%|██████████████████████████▎| 990/1014 [00:10<00:00, 90.69batch/s] 99%|█████████████████████████▋| 1002/1014 [00:11<00:00, 90.74batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 90.68batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 90.67batch/s]
Validation 1 -> LOSS = 3.57
Validation 1 -> BLEU = 9.39, 42.5/15.0/6.8/2.9 (BP=0.884, ratio=0.890, hyp_len=11422, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 3.57 @ validation 1
--> Best BLEU so far: 9.39 @ validation 1
Starting Epoch 2
Epoch 2 - update        480 => loss:   4.421 (#OOM: 0)
Epoch 2 - update        510 => loss:   4.073 (#OOM: 0)
Epoch 2 - update        540 => loss:   3.656 (#OOM: 0)
Epoch 2 - update        570 => loss:   3.658 (#OOM: 0)
Epoch 2 - update        600 => loss:   4.657 (#OOM: 0)
Epoch 2 - update        630 => loss:   3.545 (#OOM: 0)
Epoch 2 - update        660 => loss:   3.890 (#OOM: 0)
Epoch 2 - update        690 => loss:   3.713 (#OOM: 0)
Epoch 2 - update        720 => loss:   4.090 (#OOM: 0)
Epoch 2 - update        750 => loss:   3.746 (#OOM: 0)
Epoch 2 - update        780 => loss:   3.683 (#OOM: 0)
Epoch 2 - update        810 => loss:   3.504 (#OOM: 0)
Epoch 2 - update        840 => loss:   3.417 (#OOM: 0)
Epoch 2 - update        870 => loss:   3.419 (#OOM: 0)
Epoch 2 - update        900 => loss:   3.153 (#OOM: 0)
Epoch 2 - update        930 => loss:   3.219 (#OOM: 0)
--> Epoch 2 finished with mean loss 3.69125
--> Overhead/Training/Evaluation: 0.03/0.49/0.00 mins (total: 0.52 mins)   (988 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 20%|██████▏                        | 7/35 [00:00<00:00, 59.11batch/s] 40%|████████████                  | 14/35 [00:00<00:00, 55.23batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 56.53batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 55.69batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.88batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.83batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.81batch/s]  2%|▌                           | 20/1014 [00:00<00:10, 93.79batch/s]  3%|▊                           | 31/1014 [00:00<00:12, 77.32batch/s]  4%|█▏                          | 42/1014 [00:00<00:12, 79.65batch/s]  5%|█▍                          | 53/1014 [00:00<00:11, 81.84batch/s]  6%|█▊                          | 64/1014 [00:00<00:11, 81.87batch/s]  7%|██                          | 75/1014 [00:00<00:11, 82.67batch/s]  8%|██▎                         | 86/1014 [00:01<00:11, 84.25batch/s] 10%|██▋                         | 97/1014 [00:01<00:10, 85.88batch/s] 11%|██▉                        | 108/1014 [00:01<00:10, 85.63batch/s] 12%|███▏                       | 119/1014 [00:01<00:10, 86.45batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 87.54batch/s] 14%|███▊                       | 141/1014 [00:01<00:10, 83.92batch/s] 15%|████                       | 152/1014 [00:01<00:10, 84.97batch/s] 16%|████▎                      | 163/1014 [00:01<00:09, 86.14batch/s] 17%|████▋                      | 174/1014 [00:01<00:09, 87.02batch/s] 18%|████▉                      | 185/1014 [00:02<00:09, 87.42batch/s] 19%|█████▏                     | 197/1014 [00:02<00:09, 86.20batch/s] 21%|█████▌                     | 209/1014 [00:02<00:09, 86.40batch/s] 22%|█████▉                     | 221/1014 [00:02<00:09, 84.68batch/s] 23%|██████▏                    | 233/1014 [00:02<00:09, 82.93batch/s] 24%|██████▌                    | 245/1014 [00:02<00:09, 83.71batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 81.92batch/s] 27%|███████▏                   | 269/1014 [00:03<00:09, 79.35batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 79.88batch/s] 29%|███████▊                   | 293/1014 [00:03<00:08, 80.40batch/s] 30%|████████                   | 305/1014 [00:03<00:08, 80.90batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 80.94batch/s] 32%|████████▊                  | 329/1014 [00:04<00:08, 80.49batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 80.79batch/s] 35%|█████████▍                 | 353/1014 [00:04<00:08, 80.94batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:07, 81.39batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 81.80batch/s] 38%|██████████▎                | 389/1014 [00:04<00:07, 81.81batch/s] 40%|██████████▋                | 401/1014 [00:04<00:07, 82.37batch/s] 41%|██████████▉                | 413/1014 [00:04<00:07, 82.67batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 81.81batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 82.16batch/s] 44%|███████████▉               | 449/1014 [00:05<00:06, 82.46batch/s] 45%|████████████▎              | 461/1014 [00:05<00:06, 82.60batch/s] 47%|████████████▌              | 473/1014 [00:05<00:06, 81.53batch/s] 48%|████████████▉              | 485/1014 [00:05<00:06, 81.77batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 82.18batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 82.19batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:05, 82.58batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:05, 82.96batch/s] 54%|██████████████▌            | 545/1014 [00:06<00:05, 82.43batch/s] 55%|██████████████▊            | 557/1014 [00:06<00:05, 82.67batch/s] 56%|███████████████▏           | 569/1014 [00:06<00:05, 82.95batch/s] 57%|███████████████▍           | 581/1014 [00:06<00:05, 83.03batch/s] 58%|███████████████▊           | 593/1014 [00:07<00:05, 83.20batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 81.69batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:04, 81.94batch/s] 62%|████████████████▋          | 629/1014 [00:07<00:04, 81.25batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 81.54batch/s] 64%|█████████████████▍         | 653/1014 [00:07<00:04, 81.71batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 81.83batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 81.75batch/s] 68%|██████████████████▎        | 689/1014 [00:08<00:03, 81.92batch/s] 69%|██████████████████▋        | 701/1014 [00:08<00:03, 82.04batch/s] 70%|██████████████████▉        | 713/1014 [00:08<00:03, 82.10batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 82.26batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 81.90batch/s] 74%|███████████████████▉       | 749/1014 [00:09<00:03, 81.99batch/s] 75%|████████████████████▎      | 761/1014 [00:09<00:03, 82.02batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:02, 82.10batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 82.34batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 82.42batch/s] 80%|█████████████████████▌     | 809/1014 [00:09<00:02, 82.57batch/s] 81%|█████████████████████▊     | 821/1014 [00:09<00:02, 82.91batch/s] 82%|██████████████████████▏    | 833/1014 [00:10<00:02, 82.94batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 83.01batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 82.64batch/s] 86%|███████████████████████▏   | 869/1014 [00:10<00:01, 82.73batch/s] 87%|███████████████████████▍   | 881/1014 [00:10<00:01, 82.35batch/s] 88%|███████████████████████▊   | 893/1014 [00:10<00:01, 82.39batch/s] 89%|████████████████████████   | 905/1014 [00:10<00:01, 82.40batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 81.94batch/s] 92%|████████████████████████▋  | 929/1014 [00:11<00:01, 81.55batch/s] 93%|█████████████████████████  | 941/1014 [00:11<00:00, 81.16batch/s] 94%|█████████████████████████▍ | 953/1014 [00:11<00:00, 81.18batch/s] 95%|█████████████████████████▋ | 965/1014 [00:11<00:00, 80.77batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 80.86batch/s] 98%|██████████████████████████▎| 989/1014 [00:12<00:00, 80.90batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 81.08batch/s]100%|█████████████████████████▉| 1013/1014 [00:12<00:00, 81.12batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.14batch/s]
Validation 2 -> LOSS = 3.04
Validation 2 -> BLEU = 13.09, 41.3/17.5/9.0/4.5 (BP=1.000, ratio=1.022, hyp_len=13115, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 3.04 @ validation 2
--> Best BLEU so far: 13.09 @ validation 2
Starting Epoch 3
Epoch 3 - update        960 => loss:   3.453 (#OOM: 0)
Epoch 3 - update        990 => loss:   3.295 (#OOM: 0)
Epoch 3 - update       1020 => loss:   3.198 (#OOM: 0)
Epoch 3 - update       1050 => loss:   3.619 (#OOM: 0)
Epoch 3 - update       1080 => loss:   3.018 (#OOM: 0)
Epoch 3 - update       1110 => loss:   3.246 (#OOM: 0)
Epoch 3 - update       1140 => loss:   3.123 (#OOM: 0)
Epoch 3 - update       1170 => loss:   3.203 (#OOM: 0)
Epoch 3 - update       1200 => loss:   2.817 (#OOM: 0)
Epoch 3 - update       1230 => loss:   3.792 (#OOM: 0)
Epoch 3 - update       1260 => loss:   2.993 (#OOM: 0)
Epoch 3 - update       1290 => loss:   3.751 (#OOM: 0)
Epoch 3 - update       1320 => loss:   3.105 (#OOM: 0)
Epoch 3 - update       1350 => loss:   3.173 (#OOM: 0)
Epoch 3 - update       1380 => loss:   2.352 (#OOM: 0)
Epoch 3 - update       1410 => loss:   2.757 (#OOM: 0)
--> Epoch 3 finished with mean loss 3.26196
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (779 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.59batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.33batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.21batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.42batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 55.65batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.85batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 96.19batch/s]  2%|▌                           | 20/1014 [00:00<00:10, 96.51batch/s]  3%|▊                           | 30/1014 [00:00<00:10, 94.22batch/s]  4%|█                           | 40/1014 [00:00<00:10, 92.92batch/s]  5%|█▍                          | 50/1014 [00:00<00:10, 93.32batch/s]  6%|█▋                          | 60/1014 [00:00<00:10, 91.91batch/s]  7%|█▉                          | 70/1014 [00:00<00:10, 92.51batch/s]  8%|██▏                         | 80/1014 [00:00<00:10, 90.56batch/s]  9%|██▍                         | 90/1014 [00:00<00:10, 91.12batch/s] 10%|██▋                        | 100/1014 [00:01<00:09, 91.68batch/s] 11%|██▉                        | 111/1014 [00:01<00:09, 92.83batch/s] 12%|███▏                       | 122/1014 [00:01<00:09, 93.05batch/s] 13%|███▌                       | 133/1014 [00:01<00:09, 92.03batch/s] 14%|███▊                       | 144/1014 [00:01<00:09, 92.49batch/s] 15%|████▏                      | 155/1014 [00:01<00:09, 92.93batch/s] 16%|████▍                      | 166/1014 [00:01<00:09, 92.81batch/s] 17%|████▋                      | 177/1014 [00:01<00:08, 93.14batch/s] 19%|█████                      | 188/1014 [00:02<00:08, 92.98batch/s] 20%|█████▎                     | 199/1014 [00:02<00:08, 92.36batch/s] 21%|█████▌                     | 210/1014 [00:02<00:08, 91.79batch/s] 22%|█████▉                     | 221/1014 [00:02<00:08, 91.37batch/s] 23%|██████▏                    | 232/1014 [00:02<00:08, 91.14batch/s] 24%|██████▍                    | 243/1014 [00:02<00:08, 90.54batch/s] 25%|██████▊                    | 254/1014 [00:02<00:08, 90.51batch/s] 26%|███████                    | 265/1014 [00:02<00:08, 90.19batch/s] 27%|███████▎                   | 276/1014 [00:03<00:08, 89.65batch/s] 28%|███████▋                   | 287/1014 [00:03<00:08, 89.82batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 89.40batch/s] 30%|████████▏                  | 309/1014 [00:03<00:07, 89.49batch/s] 32%|████████▌                  | 320/1014 [00:03<00:07, 89.28batch/s] 33%|████████▊                  | 331/1014 [00:03<00:07, 89.22batch/s] 34%|█████████                  | 342/1014 [00:03<00:07, 88.98batch/s] 35%|█████████▍                 | 353/1014 [00:03<00:07, 89.26batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:07, 89.30batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:07, 89.19batch/s] 38%|██████████▎                | 386/1014 [00:04<00:07, 89.02batch/s] 39%|██████████▌                | 397/1014 [00:04<00:06, 89.19batch/s] 40%|██████████▊                | 408/1014 [00:04<00:06, 89.40batch/s] 41%|███████████▏               | 419/1014 [00:04<00:06, 89.64batch/s] 42%|███████████▍               | 430/1014 [00:04<00:06, 89.86batch/s] 43%|███████████▋               | 441/1014 [00:04<00:06, 89.89batch/s] 45%|████████████               | 453/1014 [00:05<00:06, 90.24batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 90.32batch/s] 47%|████████████▋              | 477/1014 [00:05<00:05, 90.38batch/s] 48%|█████████████              | 489/1014 [00:05<00:05, 90.42batch/s] 49%|█████████████▎             | 501/1014 [00:05<00:05, 90.57batch/s] 51%|█████████████▋             | 513/1014 [00:05<00:05, 90.52batch/s] 52%|█████████████▉             | 525/1014 [00:05<00:05, 90.30batch/s] 53%|██████████████▎            | 537/1014 [00:05<00:05, 90.40batch/s] 54%|██████████████▌            | 549/1014 [00:06<00:05, 90.69batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:04, 90.93batch/s] 57%|███████████████▎           | 573/1014 [00:06<00:04, 90.64batch/s] 58%|███████████████▌           | 585/1014 [00:06<00:04, 90.51batch/s] 59%|███████████████▉           | 597/1014 [00:06<00:04, 90.61batch/s] 60%|████████████████▏          | 609/1014 [00:06<00:04, 90.74batch/s] 61%|████████████████▌          | 621/1014 [00:06<00:04, 90.54batch/s] 62%|████████████████▊          | 633/1014 [00:06<00:04, 90.65batch/s] 64%|█████████████████▏         | 645/1014 [00:07<00:04, 90.59batch/s] 65%|█████████████████▍         | 657/1014 [00:07<00:03, 90.40batch/s] 66%|█████████████████▊         | 669/1014 [00:07<00:03, 90.37batch/s] 67%|██████████████████▏        | 681/1014 [00:07<00:03, 90.37batch/s] 68%|██████████████████▍        | 693/1014 [00:07<00:03, 90.49batch/s] 70%|██████████████████▊        | 705/1014 [00:07<00:03, 90.48batch/s] 71%|███████████████████        | 717/1014 [00:07<00:03, 90.48batch/s] 72%|███████████████████▍       | 729/1014 [00:08<00:03, 90.30batch/s] 73%|███████████████████▋       | 741/1014 [00:08<00:03, 90.21batch/s] 74%|████████████████████       | 753/1014 [00:08<00:02, 90.32batch/s] 75%|████████████████████▎      | 765/1014 [00:08<00:02, 90.20batch/s] 77%|████████████████████▋      | 777/1014 [00:08<00:02, 90.15batch/s] 78%|█████████████████████      | 789/1014 [00:08<00:02, 90.14batch/s] 79%|█████████████████████▎     | 801/1014 [00:08<00:02, 90.23batch/s] 80%|█████████████████████▋     | 813/1014 [00:09<00:02, 90.30batch/s] 81%|█████████████████████▉     | 825/1014 [00:09<00:02, 90.41batch/s] 83%|██████████████████████▎    | 837/1014 [00:09<00:01, 90.43batch/s] 84%|██████████████████████▌    | 849/1014 [00:09<00:01, 90.24batch/s] 85%|██████████████████████▉    | 861/1014 [00:09<00:01, 90.28batch/s] 86%|███████████████████████▏   | 873/1014 [00:09<00:01, 90.26batch/s] 87%|███████████████████████▌   | 885/1014 [00:09<00:01, 90.31batch/s] 88%|███████████████████████▉   | 897/1014 [00:09<00:01, 90.35batch/s] 90%|████████████████████████▏  | 909/1014 [00:10<00:01, 90.33batch/s] 91%|████████████████████████▌  | 921/1014 [00:10<00:01, 90.19batch/s] 92%|████████████████████████▊  | 933/1014 [00:10<00:00, 90.25batch/s] 93%|█████████████████████████▏ | 945/1014 [00:10<00:00, 90.14batch/s] 94%|█████████████████████████▍ | 957/1014 [00:10<00:00, 90.11batch/s] 96%|█████████████████████████▊ | 969/1014 [00:10<00:00, 89.98batch/s] 97%|██████████████████████████ | 981/1014 [00:10<00:00, 90.02batch/s] 98%|██████████████████████████▍| 993/1014 [00:11<00:00, 89.95batch/s] 99%|█████████████████████████▊| 1005/1014 [00:11<00:00, 89.93batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 89.98batch/s]
Validation 3 -> LOSS = 2.73
Validation 3 -> BLEU = 17.10, 52.5/25.0/14.0/7.9 (BP=0.876, ratio=0.883, hyp_len=11333, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 2.73 @ validation 3
--> Best BLEU so far: 17.10 @ validation 3
Starting Epoch 4
Epoch 4 - update       1440 => loss:   2.235 (#OOM: 0)
Epoch 4 - update       1470 => loss:   2.751 (#OOM: 0)
Epoch 4 - update       1500 => loss:   3.087 (#OOM: 0)
Epoch 4 - update       1530 => loss:   2.642 (#OOM: 0)
Epoch 4 - update       1560 => loss:   3.153 (#OOM: 0)
Epoch 4 - update       1590 => loss:   2.836 (#OOM: 0)
Epoch 4 - update       1620 => loss:   2.838 (#OOM: 0)
Epoch 4 - update       1650 => loss:   2.755 (#OOM: 0)
Epoch 4 - update       1680 => loss:   2.628 (#OOM: 0)
Epoch 4 - update       1710 => loss:   2.892 (#OOM: 0)
Epoch 4 - update       1740 => loss:   2.396 (#OOM: 0)
Epoch 4 - update       1770 => loss:   3.221 (#OOM: 0)
Epoch 4 - update       1800 => loss:   2.711 (#OOM: 0)
Epoch 4 - update       1830 => loss:   3.355 (#OOM: 0)
Epoch 4 - update       1860 => loss:   2.828 (#OOM: 0)
Epoch 4 - update       1890 => loss:   2.777 (#OOM: 0)
--> Epoch 4 finished with mean loss 2.98206
--> Overhead/Training/Evaluation: 0.04/0.55/0.00 mins (total: 0.59 mins)   (877 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 20%|██████▏                        | 7/35 [00:00<00:00, 62.97batch/s] 40%|████████████                  | 14/35 [00:00<00:00, 61.24batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 55.88batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 56.10batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 56.53batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 56.49batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:11, 90.98batch/s]  2%|▌                           | 21/1014 [00:00<00:10, 98.05batch/s]  3%|▉                           | 32/1014 [00:00<00:10, 92.88batch/s]  4%|█▏                          | 43/1014 [00:00<00:10, 92.47batch/s]  5%|█▍                          | 54/1014 [00:00<00:10, 92.32batch/s]  6%|█▊                          | 65/1014 [00:00<00:10, 92.54batch/s]  7%|██                          | 76/1014 [00:00<00:10, 93.27batch/s]  9%|██▍                         | 87/1014 [00:00<00:10, 92.63batch/s] 10%|██▋                         | 98/1014 [00:01<00:09, 93.04batch/s] 11%|██▉                        | 109/1014 [00:01<00:09, 93.10batch/s] 12%|███▏                       | 120/1014 [00:01<00:09, 92.93batch/s] 13%|███▍                       | 131/1014 [00:01<00:09, 92.30batch/s] 14%|███▊                       | 142/1014 [00:01<00:09, 89.35batch/s] 15%|████                       | 153/1014 [00:01<00:09, 88.95batch/s] 16%|████▎                      | 164/1014 [00:01<00:09, 88.93batch/s] 17%|████▋                      | 175/1014 [00:01<00:09, 89.65batch/s] 18%|████▉                      | 186/1014 [00:02<00:09, 89.78batch/s] 19%|█████▏                     | 197/1014 [00:02<00:09, 89.48batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 88.90batch/s] 22%|█████▊                     | 219/1014 [00:02<00:09, 88.29batch/s] 23%|██████                     | 230/1014 [00:02<00:08, 88.79batch/s] 24%|██████▍                    | 241/1014 [00:02<00:08, 88.25batch/s] 25%|██████▋                    | 252/1014 [00:02<00:08, 88.02batch/s] 26%|███████                    | 263/1014 [00:03<00:08, 87.59batch/s] 27%|███████▎                   | 274/1014 [00:03<00:08, 87.26batch/s] 28%|███████▌                   | 285/1014 [00:03<00:08, 87.20batch/s] 29%|███████▉                   | 296/1014 [00:03<00:08, 87.56batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 87.67batch/s] 31%|████████▍                  | 318/1014 [00:03<00:07, 87.28batch/s] 32%|████████▊                  | 329/1014 [00:03<00:07, 87.26batch/s] 34%|█████████                  | 340/1014 [00:03<00:07, 87.07batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:07, 87.48batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:07, 87.92batch/s] 37%|█████████▉                 | 373/1014 [00:04<00:07, 87.93batch/s] 38%|██████████▏                | 384/1014 [00:04<00:07, 88.19batch/s] 39%|██████████▌                | 395/1014 [00:04<00:07, 88.41batch/s] 40%|██████████▊                | 406/1014 [00:04<00:06, 88.06batch/s] 41%|███████████                | 417/1014 [00:04<00:06, 87.83batch/s] 42%|███████████▍               | 428/1014 [00:04<00:06, 87.50batch/s] 43%|███████████▋               | 439/1014 [00:05<00:06, 87.68batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 87.93batch/s] 45%|████████████▎              | 461/1014 [00:05<00:06, 87.90batch/s] 47%|████████████▌              | 472/1014 [00:05<00:06, 88.11batch/s] 48%|████████████▊              | 483/1014 [00:05<00:06, 88.04batch/s] 49%|█████████████▏             | 494/1014 [00:05<00:05, 87.98batch/s] 50%|█████████████▍             | 505/1014 [00:05<00:05, 88.07batch/s] 51%|█████████████▋             | 516/1014 [00:05<00:05, 87.79batch/s] 52%|██████████████             | 527/1014 [00:06<00:05, 87.81batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:05, 87.67batch/s] 54%|██████████████▌            | 549/1014 [00:06<00:05, 87.45batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 87.40batch/s] 56%|███████████████▏           | 571/1014 [00:06<00:05, 87.06batch/s] 57%|███████████████▍           | 582/1014 [00:06<00:04, 87.00batch/s] 58%|███████████████▊           | 593/1014 [00:06<00:04, 86.91batch/s] 60%|████████████████           | 604/1014 [00:06<00:04, 86.75batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:04, 86.51batch/s] 62%|████████████████▋          | 626/1014 [00:07<00:04, 86.42batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 86.27batch/s] 64%|█████████████████▎         | 648/1014 [00:07<00:04, 86.17batch/s] 65%|█████████████████▌         | 659/1014 [00:07<00:04, 86.07batch/s] 66%|█████████████████▊         | 670/1014 [00:07<00:03, 86.13batch/s] 67%|██████████████████▏        | 681/1014 [00:07<00:03, 86.26batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:03, 86.36batch/s] 69%|██████████████████▋        | 703/1014 [00:08<00:03, 86.16batch/s] 70%|███████████████████        | 714/1014 [00:08<00:03, 86.09batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 86.15batch/s] 73%|███████████████████▌       | 736/1014 [00:08<00:03, 85.93batch/s] 74%|███████████████████▉       | 747/1014 [00:08<00:03, 85.79batch/s] 75%|████████████████████▏      | 758/1014 [00:08<00:02, 85.92batch/s] 76%|████████████████████▍      | 769/1014 [00:08<00:02, 86.04batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 86.00batch/s] 78%|█████████████████████      | 791/1014 [00:09<00:02, 85.99batch/s] 79%|█████████████████████▎     | 802/1014 [00:09<00:02, 86.20batch/s] 80%|█████████████████████▋     | 813/1014 [00:09<00:02, 86.00batch/s] 81%|█████████████████████▉     | 824/1014 [00:09<00:02, 86.03batch/s] 82%|██████████████████████▏    | 835/1014 [00:09<00:02, 85.88batch/s] 83%|██████████████████████▌    | 846/1014 [00:09<00:01, 85.87batch/s] 85%|██████████████████████▊    | 857/1014 [00:09<00:01, 85.95batch/s] 86%|███████████████████████    | 868/1014 [00:10<00:01, 85.87batch/s] 87%|███████████████████████▍   | 879/1014 [00:10<00:01, 85.89batch/s] 88%|███████████████████████▋   | 890/1014 [00:10<00:01, 85.80batch/s] 89%|███████████████████████▉   | 901/1014 [00:10<00:01, 85.87batch/s] 90%|████████████████████████▎  | 912/1014 [00:10<00:01, 85.91batch/s] 91%|████████████████████████▌  | 923/1014 [00:10<00:01, 86.00batch/s] 92%|████████████████████████▊  | 934/1014 [00:10<00:00, 86.07batch/s] 93%|█████████████████████████▏ | 945/1014 [00:10<00:00, 86.26batch/s] 94%|█████████████████████████▍ | 956/1014 [00:11<00:00, 86.29batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 86.22batch/s] 96%|██████████████████████████ | 978/1014 [00:11<00:00, 86.20batch/s] 98%|██████████████████████████▎| 989/1014 [00:11<00:00, 86.31batch/s] 99%|█████████████████████████▋| 1000/1014 [00:11<00:00, 86.46batch/s]100%|█████████████████████████▉| 1011/1014 [00:11<00:00, 86.59batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 86.56batch/s]
Validation 4 -> LOSS = 2.53
Validation 4 -> BLEU = 18.93, 52.9/25.9/14.9/8.5 (BP=0.927, ratio=0.929, hyp_len=11919, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 2.53 @ validation 4
--> Best BLEU so far: 18.93 @ validation 4
Starting Epoch 5
Epoch 5 - update       1920 => loss:   3.323 (#OOM: 0)
Epoch 5 - update       1950 => loss:   2.434 (#OOM: 0)
Epoch 5 - update       1980 => loss:   2.441 (#OOM: 0)
Epoch 5 - update       2010 => loss:   2.594 (#OOM: 0)
Epoch 5 - update       2040 => loss:   2.835 (#OOM: 0)
Epoch 5 - update       2070 => loss:   2.629 (#OOM: 0)
Epoch 5 - update       2100 => loss:   2.331 (#OOM: 0)
Epoch 5 - update       2130 => loss:   2.921 (#OOM: 0)
Epoch 5 - update       2160 => loss:   2.714 (#OOM: 0)
Epoch 5 - update       2190 => loss:   2.386 (#OOM: 0)
Epoch 5 - update       2220 => loss:   2.238 (#OOM: 0)
Epoch 5 - update       2250 => loss:   2.280 (#OOM: 0)
Epoch 5 - update       2280 => loss:   3.122 (#OOM: 0)
Epoch 5 - update       2310 => loss:   2.390 (#OOM: 0)
Epoch 5 - update       2340 => loss:   2.433 (#OOM: 0)
Epoch 5 - update       2370 => loss:   2.704 (#OOM: 0)
--> Epoch 5 finished with mean loss 2.77319
--> Overhead/Training/Evaluation: 0.03/0.51/0.00 mins (total: 0.55 mins)   (940 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.81batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 47.64batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 47.80batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.13batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 55.98batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.31batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 95.47batch/s]  2%|▌                           | 20/1014 [00:00<00:10, 93.27batch/s]  3%|▊                           | 30/1014 [00:00<00:10, 93.13batch/s]  4%|█                           | 40/1014 [00:00<00:10, 92.14batch/s]  5%|█▍                          | 50/1014 [00:00<00:10, 91.55batch/s]  6%|█▋                          | 60/1014 [00:00<00:10, 92.35batch/s]  7%|█▉                          | 70/1014 [00:00<00:10, 90.99batch/s]  8%|██▏                         | 80/1014 [00:00<00:10, 89.79batch/s]  9%|██▍                         | 90/1014 [00:01<00:10, 89.05batch/s] 10%|██▋                        | 100/1014 [00:01<00:10, 88.69batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 89.39batch/s] 12%|███▏                       | 120/1014 [00:01<00:09, 90.07batch/s] 13%|███▍                       | 130/1014 [00:01<00:09, 90.54batch/s] 14%|███▋                       | 140/1014 [00:01<00:09, 90.72batch/s] 15%|███▉                       | 150/1014 [00:01<00:09, 90.88batch/s] 16%|████▎                      | 160/1014 [00:01<00:09, 90.70batch/s] 17%|████▌                      | 170/1014 [00:01<00:09, 90.97batch/s] 18%|████▊                      | 180/1014 [00:01<00:09, 91.20batch/s] 19%|█████                      | 190/1014 [00:02<00:09, 91.19batch/s] 20%|█████▎                     | 201/1014 [00:02<00:08, 91.61batch/s] 21%|█████▋                     | 212/1014 [00:02<00:08, 91.85batch/s] 22%|█████▉                     | 223/1014 [00:02<00:08, 92.30batch/s] 23%|██████▏                    | 234/1014 [00:02<00:08, 92.49batch/s] 24%|██████▌                    | 245/1014 [00:02<00:08, 92.55batch/s] 25%|██████▊                    | 256/1014 [00:02<00:08, 92.07batch/s] 26%|███████                    | 267/1014 [00:02<00:08, 92.45batch/s] 27%|███████▍                   | 278/1014 [00:03<00:07, 92.41batch/s] 29%|███████▋                   | 289/1014 [00:03<00:07, 91.77batch/s] 30%|███████▉                   | 300/1014 [00:03<00:07, 91.98batch/s] 31%|████████▎                  | 311/1014 [00:03<00:07, 92.10batch/s] 32%|████████▌                  | 322/1014 [00:03<00:07, 91.95batch/s] 33%|████████▊                  | 333/1014 [00:03<00:07, 91.78batch/s] 34%|█████████▏                 | 344/1014 [00:03<00:07, 92.00batch/s] 35%|█████████▍                 | 355/1014 [00:03<00:07, 92.36batch/s] 36%|█████████▋                 | 366/1014 [00:03<00:07, 92.56batch/s] 37%|██████████                 | 377/1014 [00:04<00:06, 92.74batch/s] 38%|██████████▎                | 388/1014 [00:04<00:06, 92.51batch/s] 39%|██████████▌                | 399/1014 [00:04<00:06, 92.56batch/s] 40%|██████████▉                | 410/1014 [00:04<00:06, 92.77batch/s] 42%|███████████▏               | 421/1014 [00:04<00:06, 92.74batch/s] 43%|███████████▌               | 432/1014 [00:04<00:06, 92.80batch/s] 44%|███████████▊               | 443/1014 [00:04<00:06, 92.85batch/s] 45%|████████████               | 454/1014 [00:04<00:06, 91.45batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 91.47batch/s] 47%|████████████▋              | 476/1014 [00:05<00:05, 91.25batch/s] 48%|████████████▉              | 487/1014 [00:05<00:05, 91.22batch/s] 49%|█████████████▎             | 498/1014 [00:05<00:05, 91.26batch/s] 50%|█████████████▌             | 509/1014 [00:05<00:05, 91.11batch/s] 51%|█████████████▊             | 520/1014 [00:05<00:05, 91.18batch/s] 52%|██████████████▏            | 531/1014 [00:05<00:05, 91.11batch/s] 53%|██████████████▍            | 542/1014 [00:05<00:05, 90.95batch/s] 55%|██████████████▋            | 553/1014 [00:06<00:05, 91.03batch/s] 56%|███████████████            | 564/1014 [00:06<00:04, 90.80batch/s] 57%|███████████████▎           | 575/1014 [00:06<00:04, 90.81batch/s] 58%|███████████████▌           | 586/1014 [00:06<00:04, 90.75batch/s] 59%|███████████████▉           | 597/1014 [00:06<00:04, 90.75batch/s] 60%|████████████████▏          | 608/1014 [00:06<00:04, 90.66batch/s] 61%|████████████████▍          | 619/1014 [00:06<00:04, 90.74batch/s] 62%|████████████████▊          | 630/1014 [00:06<00:04, 90.46batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 90.71batch/s] 64%|█████████████████▎         | 652/1014 [00:07<00:03, 90.76batch/s] 65%|█████████████████▋         | 663/1014 [00:07<00:03, 90.75batch/s] 66%|█████████████████▉         | 674/1014 [00:07<00:03, 90.62batch/s] 68%|██████████████████▏        | 685/1014 [00:07<00:03, 90.69batch/s] 69%|██████████████████▌        | 696/1014 [00:07<00:03, 90.68batch/s] 70%|██████████████████▊        | 707/1014 [00:07<00:03, 90.65batch/s] 71%|███████████████████        | 718/1014 [00:07<00:03, 90.60batch/s] 72%|███████████████████▍       | 729/1014 [00:08<00:03, 90.59batch/s] 73%|███████████████████▋       | 740/1014 [00:08<00:03, 90.50batch/s] 74%|███████████████████▉       | 751/1014 [00:08<00:02, 90.51batch/s] 75%|████████████████████▎      | 762/1014 [00:08<00:02, 90.51batch/s] 76%|████████████████████▌      | 773/1014 [00:08<00:02, 90.49batch/s] 77%|████████████████████▉      | 784/1014 [00:08<00:02, 90.38batch/s] 78%|█████████████████████▏     | 795/1014 [00:08<00:02, 90.55batch/s] 79%|█████████████████████▍     | 806/1014 [00:08<00:02, 90.54batch/s] 81%|█████████████████████▊     | 817/1014 [00:09<00:02, 90.51batch/s] 82%|██████████████████████     | 828/1014 [00:09<00:02, 90.51batch/s] 83%|██████████████████████▎    | 839/1014 [00:09<00:01, 90.48batch/s] 84%|██████████████████████▋    | 850/1014 [00:09<00:01, 90.36batch/s] 85%|██████████████████████▉    | 861/1014 [00:09<00:01, 90.36batch/s] 86%|███████████████████████▏   | 872/1014 [00:09<00:01, 90.46batch/s] 87%|███████████████████████▌   | 883/1014 [00:09<00:01, 90.49batch/s] 88%|███████████████████████▊   | 894/1014 [00:09<00:01, 90.52batch/s] 89%|████████████████████████   | 905/1014 [00:10<00:01, 90.40batch/s] 90%|████████████████████████▍  | 916/1014 [00:10<00:01, 90.29batch/s] 91%|████████████████████████▋  | 927/1014 [00:10<00:00, 90.22batch/s] 93%|████████████████████████▉  | 938/1014 [00:10<00:00, 90.13batch/s] 94%|█████████████████████████▎ | 949/1014 [00:10<00:00, 90.28batch/s] 95%|█████████████████████████▌ | 960/1014 [00:10<00:00, 90.05batch/s] 96%|█████████████████████████▊ | 971/1014 [00:10<00:00, 89.95batch/s] 97%|██████████████████████████▏| 982/1014 [00:10<00:00, 89.79batch/s] 98%|██████████████████████████▍| 993/1014 [00:11<00:00, 89.91batch/s] 99%|█████████████████████████▋| 1004/1014 [00:11<00:00, 89.87batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 89.92batch/s]
Validation 5 -> LOSS = 2.37
Validation 5 -> BLEU = 20.90, 56.2/29.4/17.7/10.7 (BP=0.884, ratio=0.890, hyp_len=11420, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 2.37 @ validation 5
--> Best BLEU so far: 20.90 @ validation 5
Starting Epoch 6
Epoch 6 - update       2400 => loss:   3.278 (#OOM: 0)
Epoch 6 - update       2430 => loss:   3.018 (#OOM: 0)
Epoch 6 - update       2460 => loss:   2.583 (#OOM: 0)
Epoch 6 - update       2490 => loss:   2.573 (#OOM: 0)
Epoch 6 - update       2520 => loss:   2.800 (#OOM: 0)
Epoch 6 - update       2550 => loss:   2.407 (#OOM: 0)
Epoch 6 - update       2580 => loss:   2.623 (#OOM: 0)
Epoch 6 - update       2610 => loss:   2.854 (#OOM: 0)
Epoch 6 - update       2640 => loss:   2.603 (#OOM: 0)
Epoch 6 - update       2670 => loss:   1.995 (#OOM: 0)
Epoch 6 - update       2700 => loss:   3.781 (#OOM: 0)
Epoch 6 - update       2730 => loss:   2.399 (#OOM: 0)
Epoch 6 - update       2760 => loss:   3.214 (#OOM: 0)
Epoch 6 - update       2790 => loss:   2.715 (#OOM: 0)
Epoch 6 - update       2820 => loss:   3.014 (#OOM: 0)
Epoch 6 - update       2850 => loss:   2.245 (#OOM: 0)
--> Epoch 6 finished with mean loss 2.61683
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (845 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.43batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.94batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.34batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.21batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 52.78batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.67batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.36batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 77.09batch/s]  2%|▋                           | 24/1014 [00:00<00:12, 76.92batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 79.45batch/s]  4%|█▏                          | 42/1014 [00:00<00:11, 81.10batch/s]  5%|█▍                          | 51/1014 [00:00<00:11, 80.39batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 80.89batch/s]  7%|█▉                          | 69/1014 [00:00<00:11, 81.26batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 81.91batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 82.15batch/s]  9%|██▋                         | 96/1014 [00:01<00:11, 82.70batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 82.29batch/s] 11%|███                        | 114/1014 [00:01<00:11, 81.64batch/s] 12%|███▎                       | 123/1014 [00:01<00:10, 81.72batch/s] 13%|███▌                       | 132/1014 [00:01<00:10, 82.15batch/s] 14%|███▊                       | 142/1014 [00:01<00:10, 82.85batch/s] 15%|████                       | 152/1014 [00:01<00:10, 82.92batch/s] 16%|████▎                      | 162/1014 [00:01<00:10, 82.67batch/s] 17%|████▌                      | 172/1014 [00:02<00:10, 82.99batch/s] 18%|████▊                      | 182/1014 [00:02<00:10, 82.99batch/s] 19%|█████                      | 192/1014 [00:02<00:09, 82.79batch/s] 20%|█████▍                     | 202/1014 [00:02<00:09, 82.04batch/s] 21%|█████▋                     | 212/1014 [00:02<00:09, 82.21batch/s] 22%|█████▉                     | 222/1014 [00:02<00:09, 81.70batch/s] 23%|██████▏                    | 232/1014 [00:02<00:09, 81.94batch/s] 24%|██████▍                    | 242/1014 [00:02<00:09, 82.32batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 81.74batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 81.99batch/s] 27%|███████▏                   | 272/1014 [00:03<00:08, 82.48batch/s] 28%|███████▌                   | 282/1014 [00:03<00:08, 82.43batch/s] 29%|███████▊                   | 292/1014 [00:03<00:08, 82.50batch/s] 30%|████████                   | 302/1014 [00:03<00:08, 82.62batch/s] 31%|████████▎                  | 312/1014 [00:03<00:08, 82.66batch/s] 32%|████████▌                  | 322/1014 [00:03<00:08, 83.07batch/s] 33%|████████▊                  | 332/1014 [00:03<00:08, 83.08batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 83.37batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:07, 82.89batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:07, 82.64batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:07, 82.92batch/s] 38%|██████████▏                | 382/1014 [00:04<00:07, 83.22batch/s] 39%|██████████▍                | 392/1014 [00:04<00:07, 82.89batch/s] 40%|██████████▋                | 402/1014 [00:04<00:07, 82.76batch/s] 41%|██████████▉                | 412/1014 [00:04<00:07, 82.84batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 82.86batch/s] 43%|███████████▌               | 432/1014 [00:05<00:06, 83.15batch/s] 44%|███████████▊               | 442/1014 [00:05<00:06, 83.31batch/s] 45%|████████████               | 452/1014 [00:05<00:06, 83.38batch/s] 46%|████████████▎              | 463/1014 [00:05<00:06, 83.72batch/s] 47%|████████████▌              | 474/1014 [00:05<00:06, 83.96batch/s] 48%|████████████▉              | 485/1014 [00:05<00:06, 83.98batch/s] 49%|█████████████▏             | 496/1014 [00:05<00:06, 83.94batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 83.78batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:05, 83.52batch/s] 52%|██████████████             | 529/1014 [00:06<00:05, 83.18batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:05, 83.22batch/s] 54%|██████████████▋            | 551/1014 [00:06<00:05, 83.01batch/s] 55%|██████████████▉            | 562/1014 [00:06<00:05, 83.12batch/s] 57%|███████████████▎           | 573/1014 [00:06<00:05, 83.06batch/s] 58%|███████████████▌           | 584/1014 [00:07<00:05, 83.20batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 83.09batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:04, 83.20batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:04, 82.70batch/s] 62%|████████████████▋          | 628/1014 [00:07<00:04, 82.83batch/s] 63%|█████████████████          | 639/1014 [00:07<00:04, 82.77batch/s] 64%|█████████████████▎         | 650/1014 [00:07<00:04, 82.78batch/s] 65%|█████████████████▌         | 661/1014 [00:07<00:04, 82.98batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 83.00batch/s] 67%|██████████████████▏        | 683/1014 [00:08<00:03, 83.13batch/s] 68%|██████████████████▍        | 694/1014 [00:08<00:03, 83.13batch/s] 70%|██████████████████▊        | 705/1014 [00:08<00:03, 83.19batch/s] 71%|███████████████████        | 716/1014 [00:08<00:03, 83.21batch/s] 72%|███████████████████▎       | 727/1014 [00:08<00:03, 83.19batch/s] 73%|███████████████████▋       | 738/1014 [00:08<00:03, 83.25batch/s] 74%|███████████████████▉       | 749/1014 [00:08<00:03, 83.32batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 83.38batch/s] 76%|████████████████████▌      | 771/1014 [00:09<00:02, 83.42batch/s] 77%|████████████████████▊      | 782/1014 [00:09<00:02, 83.53batch/s] 78%|█████████████████████      | 793/1014 [00:09<00:02, 83.66batch/s] 79%|█████████████████████▍     | 804/1014 [00:09<00:02, 83.68batch/s] 80%|█████████████████████▋     | 815/1014 [00:09<00:02, 83.87batch/s] 81%|█████████████████████▉     | 826/1014 [00:09<00:02, 83.81batch/s] 83%|██████████████████████▎    | 837/1014 [00:09<00:02, 83.84batch/s] 84%|██████████████████████▌    | 848/1014 [00:10<00:01, 84.07batch/s] 85%|██████████████████████▊    | 859/1014 [00:10<00:01, 84.09batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 84.07batch/s] 87%|███████████████████████▍   | 881/1014 [00:10<00:01, 84.10batch/s] 88%|███████████████████████▊   | 892/1014 [00:10<00:01, 84.17batch/s] 89%|████████████████████████   | 903/1014 [00:10<00:01, 84.24batch/s] 90%|████████████████████████▎  | 914/1014 [00:10<00:01, 84.29batch/s] 91%|████████████████████████▋  | 925/1014 [00:11<00:01, 83.88batch/s] 92%|████████████████████████▉  | 936/1014 [00:11<00:00, 83.95batch/s] 93%|█████████████████████████▏ | 947/1014 [00:11<00:00, 83.80batch/s] 94%|█████████████████████████▌ | 958/1014 [00:11<00:00, 83.90batch/s] 96%|█████████████████████████▊ | 969/1014 [00:11<00:00, 83.97batch/s] 97%|██████████████████████████ | 980/1014 [00:11<00:00, 83.97batch/s] 98%|██████████████████████████▍| 991/1014 [00:11<00:00, 83.97batch/s] 99%|█████████████████████████▋| 1002/1014 [00:11<00:00, 84.11batch/s]100%|█████████████████████████▉| 1013/1014 [00:12<00:00, 84.07batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 84.08batch/s]
Validation 6 -> LOSS = 2.23
Validation 6 -> BLEU = 22.40, 55.3/29.5/18.0/10.9 (BP=0.942, ratio=0.944, hyp_len=12109, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 2.23 @ validation 6
--> Best BLEU so far: 22.40 @ validation 6
Starting Epoch 7
Epoch 7 - update       2880 => loss:   2.832 (#OOM: 0)
Epoch 7 - update       2910 => loss:   2.344 (#OOM: 0)
Epoch 7 - update       2940 => loss:   2.296 (#OOM: 0)
Epoch 7 - update       2970 => loss:   2.744 (#OOM: 0)
Epoch 7 - update       3000 => loss:   3.165 (#OOM: 0)
Epoch 7 - update       3030 => loss:   2.332 (#OOM: 0)
Epoch 7 - update       3060 => loss:   2.042 (#OOM: 0)
Epoch 7 - update       3090 => loss:   1.861 (#OOM: 0)
Epoch 7 - update       3120 => loss:   2.039 (#OOM: 0)
Epoch 7 - update       3150 => loss:   2.815 (#OOM: 0)
Epoch 7 - update       3180 => loss:   2.191 (#OOM: 0)
Epoch 7 - update       3210 => loss:   2.399 (#OOM: 0)
Epoch 7 - update       3240 => loss:   2.632 (#OOM: 0)
Epoch 7 - update       3270 => loss:   2.290 (#OOM: 0)
Epoch 7 - update       3300 => loss:   1.663 (#OOM: 0)
Epoch 7 - update       3330 => loss:   2.187 (#OOM: 0)
--> Epoch 7 finished with mean loss 2.48682
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.66 mins)   (788 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.08batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.02batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 50.78batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.70batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 52.08batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.07batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 84.63batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 77.00batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 82.23batch/s]  4%|█                           | 38/1014 [00:00<00:12, 81.26batch/s]  5%|█▎                          | 48/1014 [00:00<00:11, 83.06batch/s]  6%|█▌                          | 58/1014 [00:00<00:11, 83.12batch/s]  7%|█▉                          | 68/1014 [00:00<00:11, 82.23batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 82.14batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 83.64batch/s] 10%|██▋                         | 98/1014 [00:01<00:10, 84.19batch/s] 11%|██▉                        | 108/1014 [00:01<00:10, 82.96batch/s] 12%|███▏                       | 118/1014 [00:01<00:10, 82.65batch/s] 13%|███▍                       | 128/1014 [00:01<00:10, 83.18batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 83.86batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 83.03batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 83.15batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 83.36batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 83.19batch/s] 19%|█████                      | 188/1014 [00:02<00:09, 82.86batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 83.29batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 83.43batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 83.52batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 84.07batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 84.47batch/s] 24%|██████▌                    | 248/1014 [00:02<00:09, 84.34batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 83.91batch/s] 26%|███████▏                   | 268/1014 [00:03<00:08, 84.04batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 84.01batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 84.07batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 83.90batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 84.13batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 83.99batch/s] 32%|████████▋                  | 328/1014 [00:03<00:08, 84.09batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 84.25batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:07, 84.27batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:07, 84.28batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 84.61batch/s] 37%|██████████                 | 379/1014 [00:04<00:07, 85.06batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 85.32batch/s] 40%|██████████▋                | 401/1014 [00:04<00:07, 85.58batch/s] 41%|██████████▉                | 412/1014 [00:04<00:07, 85.75batch/s] 42%|███████████▎               | 423/1014 [00:04<00:06, 85.61batch/s] 43%|███████████▌               | 434/1014 [00:05<00:06, 85.37batch/s] 44%|███████████▊               | 445/1014 [00:05<00:06, 85.40batch/s] 45%|████████████▏              | 456/1014 [00:05<00:06, 85.32batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 85.21batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 85.14batch/s] 48%|█████████████              | 489/1014 [00:05<00:06, 84.95batch/s] 49%|█████████████▎             | 500/1014 [00:05<00:06, 85.07batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:05, 84.87batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:05, 85.19batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:05, 85.45batch/s] 54%|██████████████▍            | 544/1014 [00:06<00:05, 85.48batch/s] 55%|██████████████▊            | 555/1014 [00:06<00:05, 85.73batch/s] 56%|███████████████            | 566/1014 [00:06<00:05, 85.87batch/s] 57%|███████████████▎           | 577/1014 [00:06<00:05, 84.98batch/s] 58%|███████████████▋           | 588/1014 [00:06<00:05, 84.88batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:04, 84.72batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 84.75batch/s] 61%|████████████████▌          | 621/1014 [00:07<00:04, 84.51batch/s] 62%|████████████████▊          | 632/1014 [00:07<00:04, 84.56batch/s] 63%|█████████████████          | 643/1014 [00:07<00:04, 84.60batch/s] 64%|█████████████████▍         | 654/1014 [00:07<00:04, 84.62batch/s] 66%|█████████████████▋         | 665/1014 [00:07<00:04, 84.55batch/s] 67%|██████████████████         | 676/1014 [00:07<00:03, 84.60batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:03, 84.59batch/s] 69%|██████████████████▌        | 698/1014 [00:08<00:03, 84.56batch/s] 70%|██████████████████▉        | 709/1014 [00:08<00:03, 84.44batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 84.21batch/s] 72%|███████████████████▍       | 731/1014 [00:08<00:03, 84.20batch/s] 73%|███████████████████▊       | 742/1014 [00:08<00:03, 84.09batch/s] 74%|████████████████████       | 753/1014 [00:08<00:03, 84.26batch/s] 75%|████████████████████▎      | 764/1014 [00:09<00:02, 84.00batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:02, 84.15batch/s] 78%|████████████████████▉      | 786/1014 [00:09<00:02, 84.13batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 84.16batch/s] 80%|█████████████████████▌     | 808/1014 [00:09<00:02, 84.27batch/s] 81%|█████████████████████▊     | 819/1014 [00:09<00:02, 84.25batch/s] 82%|██████████████████████     | 830/1014 [00:09<00:02, 84.09batch/s] 83%|██████████████████████▍    | 841/1014 [00:09<00:02, 84.25batch/s] 84%|██████████████████████▋    | 852/1014 [00:10<00:01, 84.29batch/s] 85%|██████████████████████▉    | 863/1014 [00:10<00:01, 84.24batch/s] 86%|███████████████████████▎   | 874/1014 [00:10<00:01, 84.02batch/s] 87%|███████████████████████▌   | 885/1014 [00:10<00:01, 83.94batch/s] 88%|███████████████████████▊   | 896/1014 [00:10<00:01, 83.98batch/s] 89%|████████████████████████▏  | 907/1014 [00:10<00:01, 83.94batch/s] 91%|████████████████████████▍  | 918/1014 [00:10<00:01, 84.07batch/s] 92%|████████████████████████▋  | 929/1014 [00:11<00:01, 84.19batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 84.29batch/s] 94%|█████████████████████████▎ | 951/1014 [00:11<00:00, 84.25batch/s] 95%|█████████████████████████▌ | 962/1014 [00:11<00:00, 84.24batch/s] 96%|█████████████████████████▉ | 973/1014 [00:11<00:00, 84.21batch/s] 97%|██████████████████████████▏| 984/1014 [00:11<00:00, 84.30batch/s] 98%|██████████████████████████▍| 995/1014 [00:11<00:00, 84.29batch/s] 99%|█████████████████████████▊| 1006/1014 [00:11<00:00, 84.25batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 84.34batch/s]
Validation 7 -> LOSS = 2.16
Validation 7 -> BLEU = 23.74, 57.1/31.0/19.1/11.8 (BP=0.945, ratio=0.947, hyp_len=12144, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 2.16 @ validation 7
--> Best BLEU so far: 23.74 @ validation 7
Starting Epoch 8
Epoch 8 - update       3360 => loss:   2.515 (#OOM: 0)
Epoch 8 - update       3390 => loss:   2.378 (#OOM: 0)
Epoch 8 - update       3420 => loss:   3.472 (#OOM: 0)
Epoch 8 - update       3450 => loss:   2.173 (#OOM: 0)
Epoch 8 - update       3480 => loss:   1.936 (#OOM: 0)
Epoch 8 - update       3510 => loss:   2.269 (#OOM: 0)
Epoch 8 - update       3540 => loss:   1.888 (#OOM: 0)
Epoch 8 - update       3570 => loss:   2.012 (#OOM: 0)
Epoch 8 - update       3600 => loss:   1.723 (#OOM: 0)
Epoch 8 - update       3630 => loss:   2.540 (#OOM: 0)
Epoch 8 - update       3660 => loss:   2.391 (#OOM: 0)
Epoch 8 - update       3690 => loss:   2.737 (#OOM: 0)
Epoch 8 - update       3720 => loss:   2.011 (#OOM: 0)
Epoch 8 - update       3750 => loss:   1.631 (#OOM: 0)
Epoch 8 - update       3780 => loss:   3.181 (#OOM: 0)
Epoch 8 - update       3810 => loss:   2.268 (#OOM: 0)
--> Epoch 8 finished with mean loss 2.38001
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.66 mins)   (788 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.55batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 50.76batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.46batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.54batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 51.90batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.71batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.55batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 79.18batch/s]  2%|▋                           | 25/1014 [00:00<00:12, 81.45batch/s]  3%|▉                           | 35/1014 [00:00<00:11, 85.02batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 86.20batch/s]  5%|█▌                          | 55/1014 [00:00<00:11, 85.05batch/s]  6%|█▊                          | 65/1014 [00:00<00:11, 85.05batch/s]  7%|██                          | 75/1014 [00:00<00:11, 84.42batch/s]  8%|██▎                         | 85/1014 [00:00<00:10, 85.50batch/s]  9%|██▌                         | 95/1014 [00:01<00:10, 85.22batch/s] 10%|██▊                        | 105/1014 [00:01<00:10, 85.60batch/s] 11%|███                        | 115/1014 [00:01<00:10, 85.71batch/s] 12%|███▎                       | 125/1014 [00:01<00:10, 85.68batch/s] 13%|███▌                       | 135/1014 [00:01<00:10, 84.92batch/s] 14%|███▊                       | 145/1014 [00:01<00:10, 84.48batch/s] 15%|████▏                      | 155/1014 [00:01<00:10, 85.02batch/s] 16%|████▍                      | 165/1014 [00:01<00:10, 84.78batch/s] 17%|████▋                      | 175/1014 [00:02<00:09, 84.78batch/s] 18%|████▉                      | 185/1014 [00:02<00:09, 85.20batch/s] 19%|█████▏                     | 195/1014 [00:02<00:09, 85.56batch/s] 20%|█████▍                     | 205/1014 [00:02<00:09, 85.29batch/s] 21%|█████▋                     | 215/1014 [00:02<00:09, 85.40batch/s] 22%|█████▉                     | 225/1014 [00:02<00:09, 85.27batch/s] 23%|██████▎                    | 235/1014 [00:02<00:09, 84.84batch/s] 24%|██████▌                    | 245/1014 [00:02<00:09, 84.80batch/s] 25%|██████▊                    | 255/1014 [00:03<00:08, 84.94batch/s] 26%|███████                    | 265/1014 [00:03<00:08, 85.01batch/s] 27%|███████▎                   | 275/1014 [00:03<00:08, 84.83batch/s] 28%|███████▌                   | 285/1014 [00:03<00:08, 85.09batch/s] 29%|███████▊                   | 295/1014 [00:03<00:08, 85.02batch/s] 30%|████████                   | 305/1014 [00:03<00:08, 84.54batch/s] 31%|████████▍                  | 315/1014 [00:03<00:08, 84.66batch/s] 32%|████████▋                  | 325/1014 [00:03<00:08, 84.40batch/s] 33%|████████▉                  | 335/1014 [00:03<00:08, 84.26batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:07, 84.34batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:07, 84.34batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:07, 84.47batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:07, 84.34batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 84.29batch/s] 39%|██████████▌                | 395/1014 [00:04<00:07, 84.61batch/s] 40%|██████████▊                | 405/1014 [00:04<00:07, 84.64batch/s] 41%|███████████                | 415/1014 [00:04<00:07, 84.81batch/s] 42%|███████████▎               | 425/1014 [00:05<00:06, 84.69batch/s] 43%|███████████▌               | 435/1014 [00:05<00:06, 84.73batch/s] 44%|███████████▊               | 445/1014 [00:05<00:06, 84.55batch/s] 45%|████████████               | 455/1014 [00:05<00:06, 84.11batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 84.01batch/s] 47%|████████████▋              | 475/1014 [00:05<00:06, 83.99batch/s] 48%|████████████▉              | 485/1014 [00:05<00:06, 83.87batch/s] 49%|█████████████▏             | 495/1014 [00:05<00:06, 83.72batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 83.84batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:05, 83.78batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:05, 83.92batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:05, 83.81batch/s] 54%|██████████████▌            | 545/1014 [00:06<00:05, 83.82batch/s] 55%|██████████████▊            | 555/1014 [00:06<00:05, 83.60batch/s] 56%|███████████████            | 565/1014 [00:06<00:05, 83.48batch/s] 57%|███████████████▎           | 575/1014 [00:06<00:05, 83.44batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 83.19batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 83.11batch/s] 60%|████████████████           | 605/1014 [00:07<00:04, 82.93batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:04, 82.99batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 82.97batch/s] 63%|████████████████▉          | 635/1014 [00:07<00:04, 82.73batch/s] 64%|█████████████████▏         | 645/1014 [00:07<00:04, 82.77batch/s] 65%|█████████████████▍         | 655/1014 [00:07<00:04, 82.83batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 82.81batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 82.93batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:03, 82.89batch/s] 69%|██████████████████▌        | 695/1014 [00:08<00:03, 82.89batch/s] 70%|██████████████████▊        | 705/1014 [00:08<00:03, 82.83batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 82.84batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 82.90batch/s] 72%|███████████████████▌       | 735/1014 [00:08<00:03, 82.88batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 82.70batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 82.76batch/s] 75%|████████████████████▎      | 765/1014 [00:09<00:03, 82.64batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:02, 82.50batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 82.54batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 82.55batch/s] 79%|█████████████████████▍     | 805/1014 [00:09<00:02, 82.45batch/s] 80%|█████████████████████▋     | 815/1014 [00:09<00:02, 82.41batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 82.38batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 82.38batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 82.39batch/s] 84%|██████████████████████▊    | 855/1014 [00:10<00:01, 82.46batch/s] 85%|███████████████████████    | 865/1014 [00:10<00:01, 82.45batch/s] 86%|███████████████████████▎   | 875/1014 [00:10<00:01, 82.55batch/s] 87%|███████████████████████▌   | 885/1014 [00:10<00:01, 82.46batch/s] 88%|███████████████████████▊   | 895/1014 [00:10<00:01, 82.46batch/s] 89%|████████████████████████   | 905/1014 [00:10<00:01, 82.47batch/s] 90%|████████████████████████▎  | 915/1014 [00:11<00:01, 82.52batch/s] 91%|████████████████████████▋  | 925/1014 [00:11<00:01, 82.58batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 82.62batch/s] 93%|█████████████████████████▏ | 945/1014 [00:11<00:00, 82.53batch/s] 94%|█████████████████████████▍ | 955/1014 [00:11<00:00, 82.41batch/s] 95%|█████████████████████████▋ | 965/1014 [00:11<00:00, 82.38batch/s] 96%|█████████████████████████▉ | 975/1014 [00:11<00:00, 82.38batch/s] 97%|██████████████████████████▏| 985/1014 [00:11<00:00, 82.33batch/s] 98%|██████████████████████████▍| 995/1014 [00:12<00:00, 82.27batch/s] 99%|█████████████████████████▊| 1005/1014 [00:12<00:00, 82.30batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.38batch/s]
Validation 8 -> LOSS = 2.09
Validation 8 -> BLEU = 25.00, 56.5/30.9/19.2/11.9 (BP=0.995, ratio=0.995, hyp_len=12770, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 2.09 @ validation 8
--> Best BLEU so far: 25.00 @ validation 8
Starting Epoch 9
Epoch 9 - update       3840 => loss:   2.278 (#OOM: 0)
Epoch 9 - update       3870 => loss:   2.167 (#OOM: 0)
Epoch 9 - update       3900 => loss:   2.646 (#OOM: 0)
Epoch 9 - update       3930 => loss:   3.353 (#OOM: 0)
Epoch 9 - update       3960 => loss:   1.514 (#OOM: 0)
Epoch 9 - update       3990 => loss:   2.936 (#OOM: 0)
Epoch 9 - update       4020 => loss:   1.870 (#OOM: 0)
Epoch 9 - update       4050 => loss:   2.805 (#OOM: 0)
Epoch 9 - update       4080 => loss:   1.920 (#OOM: 0)
Epoch 9 - update       4110 => loss:   1.941 (#OOM: 0)
Epoch 9 - update       4140 => loss:   2.016 (#OOM: 0)
Epoch 9 - update       4170 => loss:   2.481 (#OOM: 0)
Epoch 9 - update       4200 => loss:   2.048 (#OOM: 0)
Epoch 9 - update       4230 => loss:   1.867 (#OOM: 0)
Epoch 9 - update       4260 => loss:   2.028 (#OOM: 0)
Epoch 9 - update       4290 => loss:   2.321 (#OOM: 0)
--> Epoch 9 finished with mean loss 2.28945
--> Overhead/Training/Evaluation: 0.03/0.49/0.00 mins (total: 0.51 mins)   (995 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.61batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 59.82batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 56.78batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 55.54batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.76batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 84.53batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 85.59batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 84.11batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 84.46batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 85.14batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 84.45batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 84.60batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 84.92batch/s]  8%|██▏                         | 81/1014 [00:00<00:11, 83.56batch/s]  9%|██▍                         | 90/1014 [00:01<00:10, 84.12batch/s] 10%|██▋                         | 99/1014 [00:01<00:10, 83.76batch/s] 11%|██▉                        | 108/1014 [00:01<00:10, 82.64batch/s] 12%|███                        | 117/1014 [00:01<00:11, 81.02batch/s] 12%|███▎                       | 126/1014 [00:01<00:10, 81.07batch/s] 13%|███▌                       | 135/1014 [00:01<00:10, 79.97batch/s] 14%|███▊                       | 144/1014 [00:01<00:10, 80.15batch/s] 15%|████                       | 153/1014 [00:01<00:10, 80.30batch/s] 16%|████▎                      | 162/1014 [00:02<00:10, 80.10batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 80.34batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 80.59batch/s] 19%|█████                      | 189/1014 [00:02<00:10, 80.35batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 80.21batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 80.25batch/s] 21%|█████▊                     | 216/1014 [00:02<00:09, 79.82batch/s] 22%|█████▉                     | 225/1014 [00:02<00:09, 79.99batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 80.21batch/s] 24%|██████▍                    | 243/1014 [00:03<00:09, 80.52batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 80.20batch/s] 26%|██████▉                    | 261/1014 [00:03<00:09, 80.25batch/s] 27%|███████▏                   | 271/1014 [00:03<00:09, 80.71batch/s] 28%|███████▍                   | 281/1014 [00:03<00:09, 80.76batch/s] 29%|███████▋                   | 291/1014 [00:03<00:08, 80.54batch/s] 30%|████████                   | 301/1014 [00:03<00:08, 80.91batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 81.11batch/s] 32%|████████▌                  | 321/1014 [00:03<00:08, 81.07batch/s] 33%|████████▊                  | 331/1014 [00:04<00:08, 81.29batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 81.31batch/s] 35%|█████████▎                 | 351/1014 [00:04<00:08, 81.12batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:08, 81.34batch/s] 37%|█████████▉                 | 371/1014 [00:04<00:07, 81.28batch/s] 38%|██████████▏                | 381/1014 [00:04<00:07, 81.06batch/s] 39%|██████████▍                | 391/1014 [00:04<00:07, 80.96batch/s] 40%|██████████▋                | 401/1014 [00:04<00:07, 80.92batch/s] 41%|██████████▉                | 411/1014 [00:05<00:07, 80.82batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 80.75batch/s] 43%|███████████▍               | 431/1014 [00:05<00:07, 80.80batch/s] 43%|███████████▋               | 441/1014 [00:05<00:07, 80.92batch/s] 44%|████████████               | 451/1014 [00:05<00:06, 80.93batch/s] 45%|████████████▎              | 461/1014 [00:05<00:06, 81.11batch/s] 46%|████████████▌              | 471/1014 [00:05<00:06, 81.11batch/s] 47%|████████████▊              | 481/1014 [00:05<00:06, 81.04batch/s] 48%|█████████████              | 491/1014 [00:06<00:06, 81.17batch/s] 49%|█████████████▎             | 501/1014 [00:06<00:06, 81.21batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 81.39batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:06, 81.49batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:05, 81.22batch/s] 53%|██████████████▍            | 541/1014 [00:06<00:05, 81.21batch/s] 54%|██████████████▋            | 551/1014 [00:06<00:05, 81.22batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:05, 80.99batch/s] 56%|███████████████▏           | 571/1014 [00:07<00:05, 80.85batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 80.86batch/s] 58%|███████████████▋           | 591/1014 [00:07<00:05, 80.81batch/s] 59%|████████████████           | 601/1014 [00:07<00:05, 80.74batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:04, 80.66batch/s] 61%|████████████████▌          | 621/1014 [00:07<00:04, 80.77batch/s] 62%|████████████████▊          | 631/1014 [00:07<00:04, 80.97batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 80.85batch/s] 64%|█████████████████▎         | 651/1014 [00:08<00:04, 80.75batch/s] 65%|█████████████████▌         | 661/1014 [00:08<00:04, 80.75batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 80.51batch/s] 67%|██████████████████▏        | 681/1014 [00:08<00:04, 80.39batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:03, 80.65batch/s] 69%|██████████████████▋        | 703/1014 [00:08<00:03, 80.74batch/s] 70%|███████████████████        | 714/1014 [00:08<00:03, 80.67batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 80.71batch/s] 73%|███████████████████▌       | 736/1014 [00:09<00:03, 80.74batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 80.73batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 80.70batch/s] 76%|████████████████████▍      | 769/1014 [00:09<00:03, 80.81batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 80.76batch/s] 78%|█████████████████████      | 791/1014 [00:09<00:02, 80.68batch/s] 79%|█████████████████████▎     | 802/1014 [00:09<00:02, 80.63batch/s] 80%|█████████████████████▋     | 813/1014 [00:10<00:02, 80.56batch/s] 81%|█████████████████████▉     | 824/1014 [00:10<00:02, 80.64batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 80.64batch/s] 83%|██████████████████████▌    | 846/1014 [00:10<00:02, 80.78batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 80.82batch/s] 86%|███████████████████████    | 868/1014 [00:10<00:01, 80.89batch/s] 87%|███████████████████████▍   | 879/1014 [00:10<00:01, 80.90batch/s] 88%|███████████████████████▋   | 890/1014 [00:10<00:01, 81.02batch/s] 89%|███████████████████████▉   | 901/1014 [00:11<00:01, 80.96batch/s] 90%|████████████████████████▎  | 912/1014 [00:11<00:01, 81.10batch/s] 91%|████████████████████████▌  | 923/1014 [00:11<00:01, 81.08batch/s] 92%|████████████████████████▊  | 934/1014 [00:11<00:00, 81.07batch/s] 93%|█████████████████████████▏ | 945/1014 [00:11<00:00, 80.52batch/s] 94%|█████████████████████████▍ | 956/1014 [00:11<00:00, 80.56batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 80.60batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 80.57batch/s] 98%|██████████████████████████▎| 989/1014 [00:12<00:00, 80.58batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 80.68batch/s]100%|█████████████████████████▉| 1011/1014 [00:12<00:00, 80.81batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.81batch/s]
Validation 9 -> LOSS = 2.03
Validation 9 -> BLEU = 25.82, 56.9/31.5/19.9/12.5 (BP=0.999, ratio=0.999, hyp_len=12820, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 2.03 @ validation 9
--> Best BLEU so far: 25.82 @ validation 9
Starting Epoch 10
Epoch 10 - update       4320 => loss:   2.601 (#OOM: 0)
Epoch 10 - update       4350 => loss:   2.154 (#OOM: 0)
Epoch 10 - update       4380 => loss:   2.148 (#OOM: 0)
Epoch 10 - update       4410 => loss:   1.982 (#OOM: 0)
Epoch 10 - update       4440 => loss:   2.256 (#OOM: 0)
Epoch 10 - update       4470 => loss:   2.155 (#OOM: 0)
Epoch 10 - update       4500 => loss:   1.896 (#OOM: 0)
Epoch 10 - update       4530 => loss:   2.418 (#OOM: 0)
Epoch 10 - update       4560 => loss:   2.236 (#OOM: 0)
Epoch 10 - update       4590 => loss:   2.114 (#OOM: 0)
Epoch 10 - update       4620 => loss:   2.070 (#OOM: 0)
Epoch 10 - update       4650 => loss:   2.003 (#OOM: 0)
Epoch 10 - update       4680 => loss:   2.019 (#OOM: 0)
Epoch 10 - update       4710 => loss:   1.818 (#OOM: 0)
Epoch 10 - update       4740 => loss:   1.952 (#OOM: 0)
Epoch 10 - update       4770 => loss:   1.545 (#OOM: 0)
--> Epoch 10 finished with mean loss 2.21173
--> Overhead/Training/Evaluation: 0.04/0.55/0.00 mins (total: 0.59 mins)   (871 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.86batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.41batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.67batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.05batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 53.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.48batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:13, 75.85batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 80.84batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.18batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 80.27batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 79.59batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 80.37batch/s]  6%|█▊                          | 64/1014 [00:00<00:11, 82.03batch/s]  7%|██                          | 74/1014 [00:00<00:11, 81.84batch/s]  8%|██▎                         | 84/1014 [00:01<00:11, 82.04batch/s]  9%|██▌                         | 94/1014 [00:01<00:11, 81.51batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 80.18batch/s] 11%|███                        | 114/1014 [00:01<00:11, 80.95batch/s] 12%|███▎                       | 124/1014 [00:01<00:11, 80.57batch/s] 13%|███▌                       | 134/1014 [00:01<00:10, 80.97batch/s] 14%|███▊                       | 144/1014 [00:01<00:10, 80.78batch/s] 15%|████                       | 154/1014 [00:01<00:10, 81.73batch/s] 16%|████▎                      | 164/1014 [00:02<00:10, 82.00batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 82.26batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 81.94batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 81.70batch/s] 20%|█████▍                     | 204/1014 [00:02<00:09, 81.93batch/s] 21%|█████▋                     | 214/1014 [00:02<00:09, 82.09batch/s] 22%|█████▉                     | 224/1014 [00:02<00:09, 82.17batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 82.24batch/s] 24%|██████▍                    | 244/1014 [00:02<00:09, 81.85batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 81.34batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 80.81batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 81.37batch/s] 28%|███████▌                   | 284/1014 [00:03<00:08, 81.43batch/s] 29%|███████▊                   | 295/1014 [00:03<00:08, 82.04batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 82.41batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 82.27batch/s] 32%|████████▋                  | 328/1014 [00:03<00:08, 82.28batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 81.99batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 82.14batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:07, 82.45batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:07, 82.31batch/s] 38%|██████████▏                | 383/1014 [00:04<00:07, 82.31batch/s] 39%|██████████▍                | 394/1014 [00:04<00:07, 82.20batch/s] 40%|██████████▊                | 405/1014 [00:04<00:07, 82.42batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 82.27batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 81.98batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 81.74batch/s] 44%|███████████▉               | 449/1014 [00:05<00:06, 81.33batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 81.40batch/s] 46%|████████████▌              | 471/1014 [00:05<00:06, 81.14batch/s] 48%|████████████▊              | 482/1014 [00:05<00:06, 81.17batch/s] 49%|█████████████▏             | 493/1014 [00:06<00:06, 81.06batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 81.18batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 81.02batch/s] 52%|██████████████             | 526/1014 [00:06<00:06, 80.99batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 81.05batch/s] 54%|██████████████▌            | 548/1014 [00:06<00:05, 81.11batch/s] 55%|██████████████▉            | 559/1014 [00:06<00:05, 81.14batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 81.04batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 80.97batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 81.03batch/s] 59%|████████████████           | 603/1014 [00:07<00:05, 80.94batch/s] 61%|████████████████▎          | 614/1014 [00:07<00:04, 81.05batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 81.01batch/s] 63%|████████████████▉          | 636/1014 [00:07<00:04, 81.07batch/s] 64%|█████████████████▏         | 647/1014 [00:07<00:04, 81.16batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 81.42batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 81.70batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 81.62batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:03, 81.58batch/s] 69%|██████████████████▋        | 702/1014 [00:08<00:03, 81.68batch/s] 70%|██████████████████▉        | 713/1014 [00:08<00:03, 81.72batch/s] 71%|███████████████████▎       | 724/1014 [00:08<00:03, 81.70batch/s] 72%|███████████████████▌       | 735/1014 [00:08<00:03, 81.74batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 81.65batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 81.48batch/s] 76%|████████████████████▍      | 768/1014 [00:09<00:03, 81.53batch/s] 77%|████████████████████▋      | 779/1014 [00:09<00:02, 81.33batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 81.26batch/s] 79%|█████████████████████▎     | 801/1014 [00:09<00:02, 81.06batch/s] 80%|█████████████████████▌     | 812/1014 [00:09<00:02, 81.21batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 81.20batch/s] 82%|██████████████████████▏    | 834/1014 [00:10<00:02, 81.08batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 81.05batch/s] 84%|██████████████████████▊    | 856/1014 [00:10<00:01, 81.08batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 81.05batch/s] 87%|███████████████████████▍   | 878/1014 [00:10<00:01, 80.82batch/s] 88%|███████████████████████▋   | 889/1014 [00:11<00:01, 80.80batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 80.74batch/s] 90%|████████████████████████▎  | 911/1014 [00:11<00:01, 80.67batch/s] 91%|████████████████████████▌  | 922/1014 [00:11<00:01, 80.67batch/s] 92%|████████████████████████▊  | 933/1014 [00:11<00:01, 80.60batch/s] 93%|█████████████████████████▏ | 944/1014 [00:11<00:00, 80.61batch/s] 94%|█████████████████████████▍ | 955/1014 [00:11<00:00, 80.66batch/s] 95%|█████████████████████████▋ | 966/1014 [00:11<00:00, 80.61batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 80.62batch/s] 97%|██████████████████████████▎| 988/1014 [00:12<00:00, 80.57batch/s] 99%|██████████████████████████▌| 999/1014 [00:12<00:00, 80.47batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 80.33batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.34batch/s]
Validation 10 -> LOSS = 1.98
Validation 10 -> BLEU = 26.25, 57.8/32.3/20.8/13.4 (BP=0.977, ratio=0.977, hyp_len=12535, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.98 @ validation 10
--> Best BLEU so far: 26.25 @ validation 10
Starting Epoch 11
Epoch 11 - update       4800 => loss:   1.883 (#OOM: 0)
Epoch 11 - update       4830 => loss:   1.902 (#OOM: 0)
Epoch 11 - update       4860 => loss:   2.020 (#OOM: 0)
Epoch 11 - update       4890 => loss:   1.951 (#OOM: 0)
Epoch 11 - update       4920 => loss:   2.470 (#OOM: 0)
Epoch 11 - update       4950 => loss:   1.610 (#OOM: 0)
Epoch 11 - update       4980 => loss:   2.014 (#OOM: 0)
Epoch 11 - update       5010 => loss:   2.091 (#OOM: 0)
Epoch 11 - update       5040 => loss:   1.885 (#OOM: 0)
Epoch 11 - update       5070 => loss:   2.225 (#OOM: 0)
Epoch 11 - update       5100 => loss:   2.469 (#OOM: 0)
Epoch 11 - update       5130 => loss:   3.030 (#OOM: 0)
Epoch 11 - update       5160 => loss:   2.090 (#OOM: 0)
Epoch 11 - update       5190 => loss:   1.745 (#OOM: 0)
Epoch 11 - update       5220 => loss:   1.743 (#OOM: 0)
--> Epoch 11 finished with mean loss 2.13840
--> Overhead/Training/Evaluation: 0.04/0.55/0.00 mins (total: 0.58 mins)   (881 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.70batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.21batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.55batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 52.49batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 54.58batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.43batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 73.48batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 82.31batch/s]  3%|▊                           | 28/1014 [00:00<00:12, 78.58batch/s]  4%|█                           | 38/1014 [00:00<00:12, 78.28batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 78.29batch/s]  6%|█▌                          | 58/1014 [00:00<00:12, 78.93batch/s]  7%|█▉                          | 68/1014 [00:00<00:12, 77.27batch/s]  8%|██▏                         | 78/1014 [00:01<00:12, 77.52batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 79.02batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 79.57batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 79.96batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 80.38batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 79.71batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 79.84batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 80.50batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 80.84batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 81.39batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 82.17batch/s] 19%|█████                      | 188/1014 [00:02<00:09, 82.94batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 82.87batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 82.94batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 82.94batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 82.14batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 81.98batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 82.14batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 82.61batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 82.60batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 82.98batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 83.05batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 83.06batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 82.89batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 83.34batch/s] 32%|████████▋                  | 328/1014 [00:03<00:08, 83.07batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 83.41batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:07, 83.64batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:07, 83.74batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 83.92batch/s] 37%|██████████                 | 378/1014 [00:04<00:07, 84.05batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 83.88batch/s] 39%|██████████▌                | 398/1014 [00:04<00:07, 83.76batch/s] 40%|██████████▊                | 408/1014 [00:04<00:07, 83.71batch/s] 41%|███████████▏               | 418/1014 [00:04<00:07, 83.85batch/s] 42%|███████████▍               | 428/1014 [00:05<00:06, 83.73batch/s] 43%|███████████▋               | 438/1014 [00:05<00:06, 83.79batch/s] 44%|███████████▉               | 448/1014 [00:05<00:06, 83.69batch/s] 45%|████████████▏              | 458/1014 [00:05<00:06, 83.84batch/s] 46%|████████████▍              | 468/1014 [00:05<00:06, 83.72batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 83.71batch/s] 48%|████████████▉              | 488/1014 [00:05<00:06, 83.73batch/s] 49%|█████████████▎             | 499/1014 [00:05<00:06, 83.95batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:05, 84.10batch/s] 51%|█████████████▊             | 521/1014 [00:06<00:05, 84.08batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:05, 83.88batch/s] 54%|██████████████▍            | 543/1014 [00:06<00:05, 83.95batch/s] 55%|██████████████▊            | 554/1014 [00:06<00:05, 84.01batch/s] 56%|███████████████            | 565/1014 [00:06<00:05, 84.00batch/s] 57%|███████████████▎           | 576/1014 [00:06<00:05, 84.04batch/s] 58%|███████████████▋           | 587/1014 [00:06<00:05, 84.07batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:04, 84.14batch/s] 60%|████████████████▏          | 609/1014 [00:07<00:04, 84.20batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 84.41batch/s] 62%|████████████████▊          | 631/1014 [00:07<00:04, 84.47batch/s] 63%|█████████████████          | 642/1014 [00:07<00:04, 84.25batch/s] 64%|█████████████████▍         | 653/1014 [00:07<00:04, 84.22batch/s] 65%|█████████████████▋         | 664/1014 [00:07<00:04, 84.29batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 84.21batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:03, 84.18batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:03, 84.20batch/s] 70%|██████████████████▊        | 708/1014 [00:08<00:03, 84.08batch/s] 71%|███████████████████▏       | 719/1014 [00:08<00:03, 84.20batch/s] 72%|███████████████████▍       | 730/1014 [00:08<00:03, 84.32batch/s] 73%|███████████████████▋       | 741/1014 [00:08<00:03, 84.36batch/s] 74%|████████████████████       | 752/1014 [00:08<00:03, 84.46batch/s] 75%|████████████████████▎      | 763/1014 [00:09<00:02, 84.50batch/s] 76%|████████████████████▌      | 774/1014 [00:09<00:02, 84.25batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 84.07batch/s] 79%|█████████████████████▏     | 796/1014 [00:09<00:02, 83.99batch/s] 80%|█████████████████████▍     | 807/1014 [00:09<00:02, 83.96batch/s] 81%|█████████████████████▊     | 818/1014 [00:09<00:02, 84.00batch/s] 82%|██████████████████████     | 829/1014 [00:09<00:02, 84.13batch/s] 83%|██████████████████████▎    | 840/1014 [00:09<00:02, 84.02batch/s] 84%|██████████████████████▋    | 851/1014 [00:10<00:01, 83.68batch/s] 85%|██████████████████████▉    | 862/1014 [00:10<00:01, 83.62batch/s] 86%|███████████████████████▏   | 873/1014 [00:10<00:01, 83.56batch/s] 87%|███████████████████████▌   | 884/1014 [00:10<00:01, 83.54batch/s] 88%|███████████████████████▊   | 895/1014 [00:10<00:01, 83.54batch/s] 89%|████████████████████████   | 906/1014 [00:10<00:01, 83.47batch/s] 90%|████████████████████████▍  | 917/1014 [00:10<00:01, 83.57batch/s] 92%|████████████████████████▋  | 928/1014 [00:11<00:01, 83.52batch/s] 93%|█████████████████████████  | 939/1014 [00:11<00:00, 83.57batch/s] 94%|█████████████████████████▎ | 950/1014 [00:11<00:00, 83.51batch/s] 95%|█████████████████████████▌ | 961/1014 [00:11<00:00, 83.47batch/s] 96%|█████████████████████████▉ | 972/1014 [00:11<00:00, 83.43batch/s] 97%|██████████████████████████▏| 983/1014 [00:11<00:00, 83.40batch/s] 98%|██████████████████████████▍| 994/1014 [00:11<00:00, 83.41batch/s] 99%|█████████████████████████▊| 1005/1014 [00:12<00:00, 83.43batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 83.35batch/s]
Validation 11 -> LOSS = 1.96
Validation 11 -> BLEU = 26.78, 58.9/33.4/21.1/13.3 (BP=0.982, ratio=0.982, hyp_len=12594, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.96 @ validation 11
--> Best BLEU so far: 26.78 @ validation 11
Starting Epoch 12
Epoch 12 - update       5250 => loss:   2.192 (#OOM: 0)
Epoch 12 - update       5280 => loss:   1.756 (#OOM: 0)
Epoch 12 - update       5310 => loss:   1.939 (#OOM: 0)
Epoch 12 - update       5340 => loss:   1.734 (#OOM: 0)
Epoch 12 - update       5370 => loss:   2.196 (#OOM: 0)
Epoch 12 - update       5400 => loss:   1.858 (#OOM: 0)
Epoch 12 - update       5430 => loss:   1.661 (#OOM: 0)
Epoch 12 - update       5460 => loss:   2.415 (#OOM: 0)
Epoch 12 - update       5490 => loss:   2.097 (#OOM: 0)
Epoch 12 - update       5520 => loss:   3.056 (#OOM: 0)
Epoch 12 - update       5550 => loss:   1.885 (#OOM: 0)
Epoch 12 - update       5580 => loss:   1.834 (#OOM: 0)
Epoch 12 - update       5610 => loss:   2.093 (#OOM: 0)
Epoch 12 - update       5640 => loss:   1.918 (#OOM: 0)
Epoch 12 - update       5670 => loss:   2.754 (#OOM: 0)
Epoch 12 - update       5700 => loss:   1.761 (#OOM: 0)
--> Epoch 12 finished with mean loss 2.07506
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.64 mins)   (801 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.57batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.21batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.29batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 55.64batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 57.50batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.25batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.90batch/s]  2%|▍                           | 17/1014 [00:00<00:11, 84.21batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 89.21batch/s]  4%|█                           | 39/1014 [00:00<00:11, 84.08batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 85.69batch/s]  6%|█▋                          | 61/1014 [00:00<00:10, 86.80batch/s]  7%|█▉                          | 72/1014 [00:00<00:10, 87.05batch/s]  8%|██▎                         | 83/1014 [00:00<00:10, 87.00batch/s]  9%|██▌                         | 94/1014 [00:01<00:10, 86.80batch/s] 10%|██▊                        | 105/1014 [00:01<00:10, 86.18batch/s] 11%|███                        | 116/1014 [00:01<00:10, 84.60batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 84.57batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 83.90batch/s] 15%|███▉                       | 149/1014 [00:01<00:10, 84.21batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 84.29batch/s] 17%|████▌                      | 171/1014 [00:02<00:10, 84.04batch/s] 18%|████▊                      | 182/1014 [00:02<00:09, 84.22batch/s] 19%|█████▏                     | 193/1014 [00:02<00:09, 84.23batch/s] 20%|█████▍                     | 204/1014 [00:02<00:09, 84.25batch/s] 21%|█████▋                     | 215/1014 [00:02<00:09, 84.41batch/s] 22%|██████                     | 226/1014 [00:02<00:09, 84.34batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 83.93batch/s] 24%|██████▌                    | 248/1014 [00:02<00:09, 84.67batch/s] 26%|██████▉                    | 259/1014 [00:03<00:09, 83.83batch/s] 27%|███████▏                   | 270/1014 [00:03<00:08, 83.92batch/s] 28%|███████▍                   | 281/1014 [00:03<00:08, 83.36batch/s] 29%|███████▊                   | 292/1014 [00:03<00:08, 83.28batch/s] 30%|████████                   | 303/1014 [00:03<00:08, 83.62batch/s] 31%|████████▎                  | 314/1014 [00:03<00:08, 83.75batch/s] 32%|████████▋                  | 325/1014 [00:03<00:08, 83.74batch/s] 33%|████████▉                  | 336/1014 [00:04<00:08, 83.57batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:07, 83.44batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:07, 83.72batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:07, 83.66batch/s] 37%|██████████                 | 380/1014 [00:04<00:07, 83.69batch/s] 39%|██████████▍                | 391/1014 [00:04<00:07, 83.49batch/s] 40%|██████████▋                | 402/1014 [00:04<00:07, 83.27batch/s] 41%|██████████▉                | 413/1014 [00:04<00:07, 83.66batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 83.83batch/s] 43%|███████████▌               | 435/1014 [00:05<00:06, 83.87batch/s] 44%|███████████▉               | 446/1014 [00:05<00:06, 83.88batch/s] 45%|████████████▏              | 457/1014 [00:05<00:06, 83.53batch/s] 46%|████████████▍              | 468/1014 [00:05<00:06, 83.62batch/s] 47%|████████████▊              | 479/1014 [00:05<00:06, 83.73batch/s] 48%|█████████████              | 490/1014 [00:05<00:06, 83.70batch/s] 49%|█████████████▎             | 501/1014 [00:05<00:06, 83.68batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:05, 83.91batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:05, 84.01batch/s] 53%|██████████████▏            | 534/1014 [00:06<00:05, 84.14batch/s] 54%|██████████████▌            | 545/1014 [00:06<00:05, 84.37batch/s] 55%|██████████████▊            | 556/1014 [00:06<00:05, 84.35batch/s] 56%|███████████████            | 567/1014 [00:06<00:05, 84.34batch/s] 57%|███████████████▍           | 578/1014 [00:06<00:05, 84.52batch/s] 58%|███████████████▋           | 589/1014 [00:06<00:05, 84.66batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:04, 84.69batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:04, 84.84batch/s] 61%|████████████████▌          | 622/1014 [00:07<00:04, 85.02batch/s] 62%|████████████████▊          | 633/1014 [00:07<00:04, 85.01batch/s] 64%|█████████████████▏         | 644/1014 [00:07<00:04, 84.87batch/s] 65%|█████████████████▍         | 655/1014 [00:07<00:04, 84.85batch/s] 66%|█████████████████▋         | 666/1014 [00:07<00:04, 84.92batch/s] 67%|██████████████████         | 677/1014 [00:07<00:03, 84.95batch/s] 68%|██████████████████▎        | 688/1014 [00:08<00:03, 84.80batch/s] 69%|██████████████████▌        | 699/1014 [00:08<00:03, 84.78batch/s] 70%|██████████████████▉        | 710/1014 [00:08<00:03, 85.04batch/s] 71%|███████████████████▏       | 721/1014 [00:08<00:03, 85.16batch/s] 72%|███████████████████▍       | 732/1014 [00:08<00:03, 85.18batch/s] 73%|███████████████████▊       | 743/1014 [00:08<00:03, 85.16batch/s] 74%|████████████████████       | 754/1014 [00:08<00:03, 85.13batch/s] 75%|████████████████████▎      | 765/1014 [00:08<00:02, 85.21batch/s] 77%|████████████████████▋      | 776/1014 [00:09<00:02, 85.22batch/s] 78%|████████████████████▉      | 787/1014 [00:09<00:02, 84.87batch/s] 79%|█████████████████████▏     | 798/1014 [00:09<00:02, 84.82batch/s] 80%|█████████████████████▌     | 809/1014 [00:09<00:02, 84.87batch/s] 81%|█████████████████████▊     | 820/1014 [00:09<00:02, 84.63batch/s] 82%|██████████████████████▏    | 831/1014 [00:09<00:02, 84.37batch/s] 83%|██████████████████████▍    | 842/1014 [00:09<00:02, 84.46batch/s] 84%|██████████████████████▋    | 853/1014 [00:10<00:01, 84.43batch/s] 85%|███████████████████████    | 864/1014 [00:10<00:01, 84.24batch/s] 86%|███████████████████████▎   | 875/1014 [00:10<00:01, 84.16batch/s] 87%|███████████████████████▌   | 886/1014 [00:10<00:01, 84.24batch/s] 88%|███████████████████████▉   | 897/1014 [00:10<00:01, 84.22batch/s] 90%|████████████████████████▏  | 908/1014 [00:10<00:01, 84.17batch/s] 91%|████████████████████████▍  | 919/1014 [00:10<00:01, 84.09batch/s] 92%|████████████████████████▊  | 930/1014 [00:11<00:00, 84.02batch/s] 93%|█████████████████████████  | 941/1014 [00:11<00:00, 84.00batch/s] 94%|█████████████████████████▎ | 952/1014 [00:11<00:00, 84.03batch/s] 95%|█████████████████████████▋ | 963/1014 [00:11<00:00, 84.02batch/s] 96%|█████████████████████████▉ | 974/1014 [00:11<00:00, 84.02batch/s] 97%|██████████████████████████▏| 985/1014 [00:11<00:00, 83.98batch/s] 98%|██████████████████████████▌| 996/1014 [00:11<00:00, 84.00batch/s] 99%|█████████████████████████▊| 1007/1014 [00:11<00:00, 83.98batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 84.00batch/s]
Validation 12 -> LOSS = 1.92
Validation 12 -> BLEU = 25.68, 58.3/32.8/20.7/13.2 (BP=0.955, ratio=0.956, hyp_len=12266, ref_len=12828)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.92 @ validation 12
--> Best BLEU so far: 26.78 @ validation 11
Starting Epoch 13
Epoch 13 - update       5730 => loss:   1.445 (#OOM: 0)
Epoch 13 - update       5760 => loss:   1.417 (#OOM: 0)
Epoch 13 - update       5790 => loss:   2.526 (#OOM: 0)
Epoch 13 - update       5820 => loss:   2.255 (#OOM: 0)
Epoch 13 - update       5850 => loss:   1.988 (#OOM: 0)
Epoch 13 - update       5880 => loss:   1.857 (#OOM: 0)
Epoch 13 - update       5910 => loss:   2.035 (#OOM: 0)
Epoch 13 - update       5940 => loss:   2.139 (#OOM: 0)
Epoch 13 - update       5970 => loss:   1.829 (#OOM: 0)
Epoch 13 - update       6000 => loss:   1.731 (#OOM: 0)
Epoch 13 - update       6030 => loss:   1.710 (#OOM: 0)
Epoch 13 - update       6060 => loss:   1.637 (#OOM: 0)
Epoch 13 - update       6090 => loss:   1.992 (#OOM: 0)
Epoch 13 - update       6120 => loss:   1.856 (#OOM: 0)
Epoch 13 - update       6150 => loss:   2.244 (#OOM: 0)
Epoch 13 - update       6180 => loss:   2.259 (#OOM: 0)
--> Epoch 13 finished with mean loss 2.01903
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.61 mins)   (839 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 48.55batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.59batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 57.02batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 56.67batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.41batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 68.64batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 78.99batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 76.41batch/s]  4%|█                           | 37/1014 [00:00<00:12, 78.43batch/s]  5%|█▎                          | 47/1014 [00:00<00:12, 77.95batch/s]  6%|█▌                          | 57/1014 [00:00<00:12, 78.97batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 80.35batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 80.13batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 80.25batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 81.86batch/s] 11%|██▉                        | 108/1014 [00:01<00:10, 82.87batch/s] 12%|███▏                       | 119/1014 [00:01<00:10, 82.65batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 82.61batch/s] 14%|███▊                       | 141/1014 [00:01<00:10, 81.64batch/s] 15%|████                       | 152/1014 [00:01<00:10, 81.52batch/s] 16%|████▎                      | 163/1014 [00:01<00:10, 81.83batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 82.24batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 82.57batch/s] 19%|█████▏                     | 196/1014 [00:02<00:09, 82.52batch/s] 20%|█████▌                     | 207/1014 [00:02<00:09, 82.30batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 82.74batch/s] 23%|██████                     | 229/1014 [00:02<00:09, 82.33batch/s] 24%|██████▍                    | 240/1014 [00:02<00:09, 81.95batch/s] 25%|██████▋                    | 251/1014 [00:03<00:09, 81.66batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 81.35batch/s] 27%|███████▎                   | 273/1014 [00:03<00:09, 81.40batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 80.82batch/s] 29%|███████▊                   | 295/1014 [00:03<00:08, 81.41batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 81.58batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 81.87batch/s] 32%|████████▋                  | 328/1014 [00:03<00:08, 82.01batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 82.23batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 82.29batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:07, 82.14batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:07, 82.61batch/s] 38%|██████████▏                | 383/1014 [00:04<00:07, 82.60batch/s] 39%|██████████▍                | 394/1014 [00:04<00:07, 82.74batch/s] 40%|██████████▊                | 405/1014 [00:04<00:07, 82.84batch/s] 41%|███████████                | 416/1014 [00:05<00:07, 82.86batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 83.05batch/s] 43%|███████████▋               | 438/1014 [00:05<00:06, 83.14batch/s] 44%|███████████▉               | 449/1014 [00:05<00:06, 83.11batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 83.25batch/s] 46%|████████████▌              | 471/1014 [00:05<00:06, 82.96batch/s] 48%|████████████▊              | 482/1014 [00:05<00:06, 83.06batch/s] 49%|█████████████▏             | 493/1014 [00:05<00:06, 83.10batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 83.00batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 82.85batch/s] 52%|██████████████             | 526/1014 [00:06<00:05, 82.73batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 82.64batch/s] 54%|██████████████▌            | 548/1014 [00:06<00:05, 82.61batch/s] 55%|██████████████▉            | 559/1014 [00:06<00:05, 82.66batch/s] 56%|███████████████▏           | 570/1014 [00:06<00:05, 82.83batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 82.92batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 82.91batch/s] 59%|████████████████           | 603/1014 [00:07<00:04, 82.67batch/s] 61%|████████████████▎          | 614/1014 [00:07<00:04, 82.74batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 82.48batch/s] 63%|████████████████▉          | 636/1014 [00:07<00:04, 82.59batch/s] 64%|█████████████████▏         | 647/1014 [00:07<00:04, 82.44batch/s] 65%|█████████████████▌         | 658/1014 [00:07<00:04, 82.31batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 82.21batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 82.17batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:03, 82.21batch/s] 69%|██████████████████▋        | 702/1014 [00:08<00:03, 82.12batch/s] 70%|██████████████████▉        | 713/1014 [00:08<00:03, 82.12batch/s] 71%|███████████████████▎       | 724/1014 [00:08<00:03, 82.11batch/s] 72%|███████████████████▌       | 735/1014 [00:08<00:03, 82.17batch/s] 74%|███████████████████▊       | 746/1014 [00:09<00:03, 82.24batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 82.26batch/s] 76%|████████████████████▍      | 768/1014 [00:09<00:02, 82.21batch/s] 77%|████████████████████▋      | 779/1014 [00:09<00:02, 82.38batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 82.39batch/s] 79%|█████████████████████▎     | 801/1014 [00:09<00:02, 82.32batch/s] 80%|█████████████████████▌     | 812/1014 [00:09<00:02, 82.13batch/s] 81%|█████████████████████▉     | 823/1014 [00:10<00:02, 81.95batch/s] 82%|██████████████████████▏    | 834/1014 [00:10<00:02, 82.04batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 82.07batch/s] 84%|██████████████████████▊    | 856/1014 [00:10<00:01, 82.15batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 82.26batch/s] 87%|███████████████████████▍   | 878/1014 [00:10<00:01, 82.12batch/s] 88%|███████████████████████▋   | 889/1014 [00:10<00:01, 82.13batch/s] 89%|███████████████████████▉   | 900/1014 [00:10<00:01, 82.23batch/s] 90%|████████████████████████▎  | 911/1014 [00:11<00:01, 82.36batch/s] 91%|████████████████████████▌  | 922/1014 [00:11<00:01, 82.37batch/s] 92%|████████████████████████▊  | 933/1014 [00:11<00:00, 82.43batch/s] 93%|█████████████████████████▏ | 944/1014 [00:11<00:00, 82.46batch/s] 94%|█████████████████████████▍ | 955/1014 [00:11<00:00, 82.47batch/s] 95%|█████████████████████████▋ | 966/1014 [00:11<00:00, 82.46batch/s] 96%|██████████████████████████ | 977/1014 [00:11<00:00, 82.36batch/s] 97%|██████████████████████████▎| 988/1014 [00:11<00:00, 82.38batch/s] 99%|██████████████████████████▌| 999/1014 [00:12<00:00, 82.40batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 82.40batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.36batch/s]
Validation 13 -> LOSS = 1.90
Validation 13 -> BLEU = 27.47, 59.2/33.9/21.8/14.3 (BP=0.977, ratio=0.978, hyp_len=12541, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.90 @ validation 13
--> Best BLEU so far: 27.47 @ validation 13
Starting Epoch 14
Epoch 14 - update       6210 => loss:   2.549 (#OOM: 0)
Epoch 14 - update       6240 => loss:   1.881 (#OOM: 0)
Epoch 14 - update       6270 => loss:   1.369 (#OOM: 0)
Epoch 14 - update       6300 => loss:   2.261 (#OOM: 0)
Epoch 14 - update       6330 => loss:   1.598 (#OOM: 0)
Epoch 14 - update       6360 => loss:   1.398 (#OOM: 0)
Epoch 14 - update       6390 => loss:   1.751 (#OOM: 0)
Epoch 14 - update       6420 => loss:   1.044 (#OOM: 0)
Epoch 14 - update       6450 => loss:   2.600 (#OOM: 0)
Epoch 14 - update       6480 => loss:   1.788 (#OOM: 0)
Epoch 14 - update       6510 => loss:   2.154 (#OOM: 0)
Epoch 14 - update       6540 => loss:   1.878 (#OOM: 0)
Epoch 14 - update       6570 => loss:   2.375 (#OOM: 0)
Epoch 14 - update       6600 => loss:   1.893 (#OOM: 0)
Epoch 14 - update       6630 => loss:   2.158 (#OOM: 0)
Epoch 14 - update       6660 => loss:   2.088 (#OOM: 0)
--> Epoch 14 finished with mean loss 1.97006
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (820 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 51.39batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 54.39batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 53.54batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 52.60batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 53.54batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.07batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.12batch/s]  2%|▌                           | 19/1014 [00:00<00:11, 87.52batch/s]  3%|▊                           | 29/1014 [00:00<00:11, 87.79batch/s]  4%|█                           | 39/1014 [00:00<00:10, 90.04batch/s]  5%|█▎                          | 49/1014 [00:00<00:10, 89.36batch/s]  6%|█▋                          | 59/1014 [00:00<00:10, 87.44batch/s]  7%|█▉                          | 69/1014 [00:00<00:10, 87.20batch/s]  8%|██▏                         | 79/1014 [00:00<00:10, 88.47batch/s]  9%|██▍                         | 89/1014 [00:01<00:10, 88.36batch/s] 10%|██▋                         | 99/1014 [00:01<00:10, 88.30batch/s] 11%|██▉                        | 109/1014 [00:01<00:10, 87.63batch/s] 12%|███▏                       | 119/1014 [00:01<00:10, 86.50batch/s] 13%|███▍                       | 129/1014 [00:01<00:10, 86.29batch/s] 14%|███▋                       | 139/1014 [00:01<00:10, 86.24batch/s] 15%|███▉                       | 149/1014 [00:01<00:10, 86.46batch/s] 16%|████▎                      | 160/1014 [00:01<00:09, 87.12batch/s] 17%|████▌                      | 171/1014 [00:01<00:09, 87.54batch/s] 18%|████▊                      | 182/1014 [00:02<00:09, 87.64batch/s] 19%|█████▏                     | 193/1014 [00:02<00:09, 87.05batch/s] 20%|█████▍                     | 204/1014 [00:02<00:09, 86.97batch/s] 21%|█████▋                     | 215/1014 [00:02<00:09, 87.09batch/s] 22%|██████                     | 226/1014 [00:02<00:09, 86.71batch/s] 23%|██████▎                    | 237/1014 [00:02<00:08, 86.43batch/s] 24%|██████▌                    | 248/1014 [00:02<00:08, 86.29batch/s] 26%|██████▉                    | 259/1014 [00:02<00:08, 86.63batch/s] 27%|███████▏                   | 270/1014 [00:03<00:08, 86.71batch/s] 28%|███████▍                   | 281/1014 [00:03<00:08, 86.57batch/s] 29%|███████▊                   | 292/1014 [00:03<00:08, 86.49batch/s] 30%|████████                   | 303/1014 [00:03<00:08, 86.47batch/s] 31%|████████▎                  | 314/1014 [00:03<00:08, 86.76batch/s] 32%|████████▋                  | 325/1014 [00:03<00:07, 86.89batch/s] 33%|████████▉                  | 336/1014 [00:03<00:07, 86.74batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:07, 86.63batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:07, 86.87batch/s] 36%|█████████▊                 | 369/1014 [00:04<00:07, 87.11batch/s] 37%|██████████                 | 380/1014 [00:04<00:07, 86.98batch/s] 39%|██████████▍                | 391/1014 [00:04<00:07, 86.98batch/s] 40%|██████████▋                | 402/1014 [00:04<00:07, 87.15batch/s] 41%|██████████▉                | 413/1014 [00:04<00:06, 87.15batch/s] 42%|███████████▎               | 424/1014 [00:04<00:06, 87.20batch/s] 43%|███████████▌               | 435/1014 [00:04<00:06, 87.04batch/s] 44%|███████████▉               | 446/1014 [00:05<00:06, 86.92batch/s] 45%|████████████▏              | 457/1014 [00:05<00:06, 86.98batch/s] 46%|████████████▍              | 468/1014 [00:05<00:06, 87.00batch/s] 47%|████████████▊              | 479/1014 [00:05<00:06, 86.97batch/s] 48%|█████████████              | 490/1014 [00:05<00:06, 87.00batch/s] 49%|█████████████▎             | 501/1014 [00:05<00:05, 86.97batch/s] 50%|█████████████▋             | 512/1014 [00:05<00:05, 86.90batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:05, 86.79batch/s] 53%|██████████████▏            | 534/1014 [00:06<00:05, 86.54batch/s] 54%|██████████████▌            | 545/1014 [00:06<00:05, 86.57batch/s] 55%|██████████████▊            | 556/1014 [00:06<00:05, 86.49batch/s] 56%|███████████████            | 567/1014 [00:06<00:05, 86.47batch/s] 57%|███████████████▍           | 578/1014 [00:06<00:05, 86.45batch/s] 58%|███████████████▋           | 589/1014 [00:06<00:04, 86.44batch/s] 59%|███████████████▉           | 600/1014 [00:06<00:04, 86.16batch/s] 60%|████████████████▎          | 611/1014 [00:07<00:04, 86.26batch/s] 61%|████████████████▌          | 622/1014 [00:07<00:04, 86.07batch/s] 62%|████████████████▊          | 633/1014 [00:07<00:04, 86.08batch/s] 64%|█████████████████▏         | 644/1014 [00:07<00:04, 86.12batch/s] 65%|█████████████████▍         | 655/1014 [00:07<00:04, 86.39batch/s] 66%|█████████████████▋         | 666/1014 [00:07<00:04, 86.44batch/s] 67%|██████████████████         | 677/1014 [00:07<00:03, 86.49batch/s] 68%|██████████████████▎        | 688/1014 [00:07<00:03, 86.33batch/s] 69%|██████████████████▌        | 699/1014 [00:08<00:03, 86.26batch/s] 70%|██████████████████▉        | 710/1014 [00:08<00:03, 86.21batch/s] 71%|███████████████████▏       | 721/1014 [00:08<00:03, 86.11batch/s] 72%|███████████████████▍       | 732/1014 [00:08<00:03, 86.22batch/s] 73%|███████████████████▊       | 743/1014 [00:08<00:03, 85.89batch/s] 74%|████████████████████       | 754/1014 [00:08<00:03, 85.90batch/s] 75%|████████████████████▎      | 765/1014 [00:08<00:02, 85.94batch/s] 77%|████████████████████▋      | 776/1014 [00:09<00:02, 86.04batch/s] 78%|████████████████████▉      | 787/1014 [00:09<00:02, 86.05batch/s] 79%|█████████████████████▏     | 798/1014 [00:09<00:02, 86.13batch/s] 80%|█████████████████████▌     | 809/1014 [00:09<00:02, 86.06batch/s] 81%|█████████████████████▊     | 820/1014 [00:09<00:02, 86.14batch/s] 82%|██████████████████████▏    | 831/1014 [00:09<00:02, 86.13batch/s] 83%|██████████████████████▍    | 842/1014 [00:09<00:01, 86.11batch/s] 84%|██████████████████████▋    | 853/1014 [00:09<00:01, 86.03batch/s] 85%|███████████████████████    | 864/1014 [00:10<00:01, 85.95batch/s] 86%|███████████████████████▎   | 875/1014 [00:10<00:01, 85.84batch/s] 87%|███████████████████████▌   | 886/1014 [00:10<00:01, 85.92batch/s] 88%|███████████████████████▉   | 897/1014 [00:10<00:01, 85.85batch/s] 90%|████████████████████████▏  | 908/1014 [00:10<00:01, 85.84batch/s] 91%|████████████████████████▍  | 919/1014 [00:10<00:01, 85.88batch/s] 92%|████████████████████████▊  | 930/1014 [00:10<00:00, 85.96batch/s] 93%|█████████████████████████  | 941/1014 [00:10<00:00, 85.98batch/s] 94%|█████████████████████████▎ | 952/1014 [00:11<00:00, 85.97batch/s] 95%|█████████████████████████▋ | 963/1014 [00:11<00:00, 85.98batch/s] 96%|█████████████████████████▉ | 974/1014 [00:11<00:00, 86.05batch/s] 97%|██████████████████████████▏| 985/1014 [00:11<00:00, 86.04batch/s] 98%|██████████████████████████▌| 996/1014 [00:11<00:00, 86.01batch/s] 99%|█████████████████████████▊| 1007/1014 [00:11<00:00, 86.01batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 85.99batch/s]
Validation 14 -> LOSS = 1.91
Validation 14 -> BLEU = 26.59, 60.5/34.5/22.3/14.3 (BP=0.931, ratio=0.933, hyp_len=11972, ref_len=12828)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.90 @ validation 13
--> Best BLEU so far: 27.47 @ validation 13
Starting Epoch 15
Epoch 15 - update       6690 => loss:   1.599 (#OOM: 0)
Epoch 15 - update       6720 => loss:   2.764 (#OOM: 0)
Epoch 15 - update       6750 => loss:   1.361 (#OOM: 0)
Epoch 15 - update       6780 => loss:   1.593 (#OOM: 0)
Epoch 15 - update       6810 => loss:   2.264 (#OOM: 0)
Epoch 15 - update       6840 => loss:   1.568 (#OOM: 0)
Epoch 15 - update       6870 => loss:   2.090 (#OOM: 0)
Epoch 15 - update       6900 => loss:   1.518 (#OOM: 0)
Epoch 15 - update       6930 => loss:   1.711 (#OOM: 0)
Epoch 15 - update       6960 => loss:   1.588 (#OOM: 0)
Epoch 15 - update       6990 => loss:   1.709 (#OOM: 0)
Epoch 15 - update       7020 => loss:   1.917 (#OOM: 0)
Epoch 15 - update       7050 => loss:   1.932 (#OOM: 0)
Epoch 15 - update       7080 => loss:   1.965 (#OOM: 0)
Epoch 15 - update       7110 => loss:   2.177 (#OOM: 0)
Epoch 15 - update       7140 => loss:   1.970 (#OOM: 0)
--> Epoch 15 finished with mean loss 1.92230
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (794 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 53.48batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 57.37batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 57.44batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 54.09batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 55.27batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.79batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 64.12batch/s]  2%|▍                           | 17/1014 [00:00<00:13, 76.41batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.04batch/s]  4%|█                           | 37/1014 [00:00<00:11, 81.88batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 81.52batch/s]  6%|█▌                          | 57/1014 [00:00<00:12, 78.65batch/s]  7%|█▊                          | 67/1014 [00:00<00:12, 78.26batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 78.10batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 78.25batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 79.26batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 79.17batch/s] 12%|███                        | 117/1014 [00:01<00:11, 78.53batch/s] 13%|███▍                       | 127/1014 [00:01<00:11, 78.97batch/s] 14%|███▋                       | 137/1014 [00:01<00:11, 78.68batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 79.33batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 78.81batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 79.27batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 80.01batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 80.20batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 80.34batch/s] 20%|█████▌                     | 207/1014 [00:02<00:10, 80.13batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 80.32batch/s] 22%|██████                     | 227/1014 [00:02<00:09, 80.45batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 80.33batch/s] 24%|██████▌                    | 247/1014 [00:03<00:09, 80.10batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 80.32batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 80.46batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 79.87batch/s] 28%|███████▋                   | 287/1014 [00:03<00:09, 79.71batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 79.81batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 80.22batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 80.24batch/s] 32%|████████▋                  | 327/1014 [00:04<00:08, 79.95batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 79.77batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 79.73batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 79.94batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:08, 80.11batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 80.05batch/s] 38%|██████████▎                | 387/1014 [00:04<00:07, 80.12batch/s] 39%|██████████▌                | 397/1014 [00:04<00:07, 80.01batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 79.97batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 80.25batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 80.28batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 80.31batch/s] 44%|███████████▉               | 447/1014 [00:05<00:07, 80.29batch/s] 45%|████████████▏              | 457/1014 [00:05<00:06, 80.29batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 80.02batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 79.98batch/s] 48%|████████████▉              | 487/1014 [00:06<00:06, 80.19batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 80.25batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 80.29batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 80.52batch/s] 52%|██████████████             | 527/1014 [00:06<00:06, 80.46batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 80.62batch/s] 54%|██████████████▌            | 547/1014 [00:06<00:05, 80.60batch/s] 55%|██████████████▊            | 557/1014 [00:06<00:05, 80.77batch/s] 56%|███████████████            | 567/1014 [00:07<00:05, 80.56batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 80.26batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 80.15batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 80.05batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:05, 80.12batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:04, 80.24batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 80.20batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 79.91batch/s] 64%|█████████████████▏         | 647/1014 [00:08<00:04, 79.96batch/s] 65%|█████████████████▍         | 657/1014 [00:08<00:04, 79.93batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 79.90batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 80.04batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:04, 80.19batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:03, 80.31batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 80.37batch/s] 71%|███████████████████        | 717/1014 [00:08<00:03, 80.43batch/s] 72%|███████████████████▎       | 727/1014 [00:09<00:03, 80.57batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 80.47batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 80.58batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 80.40batch/s] 76%|████████████████████▍      | 767/1014 [00:09<00:03, 80.37batch/s] 77%|████████████████████▋      | 777/1014 [00:09<00:02, 80.33batch/s] 78%|████████████████████▉      | 787/1014 [00:09<00:02, 80.35batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 80.40batch/s] 80%|█████████████████████▍     | 807/1014 [00:10<00:02, 80.42batch/s] 81%|█████████████████████▊     | 817/1014 [00:10<00:02, 80.54batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 80.49batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 80.49batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 80.48batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 80.43batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 80.51batch/s] 86%|███████████████████████▎   | 877/1014 [00:10<00:01, 80.58batch/s] 87%|███████████████████████▌   | 887/1014 [00:11<00:01, 80.59batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 80.53batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 80.55batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 80.57batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 80.63batch/s] 92%|████████████████████████▉  | 937/1014 [00:11<00:00, 80.55batch/s] 93%|█████████████████████████▏ | 947/1014 [00:11<00:00, 80.49batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 80.58batch/s] 95%|█████████████████████████▋ | 967/1014 [00:12<00:00, 80.52batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 80.53batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 80.46batch/s] 98%|██████████████████████████▌| 997/1014 [00:12<00:00, 80.51batch/s] 99%|█████████████████████████▊| 1007/1014 [00:12<00:00, 80.47batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.49batch/s]
Validation 15 -> LOSS = 1.87
Validation 15 -> BLEU = 27.66, 58.7/33.4/21.6/14.1 (BP=0.995, ratio=0.995, hyp_len=12770, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.87 @ validation 15
--> Best BLEU so far: 27.66 @ validation 15
Starting Epoch 16
Epoch 16 - update       7170 => loss:   1.875 (#OOM: 0)
Epoch 16 - update       7200 => loss:   1.591 (#OOM: 0)
Epoch 16 - update       7230 => loss:   1.850 (#OOM: 0)
Epoch 16 - update       7260 => loss:   1.635 (#OOM: 0)
Epoch 16 - update       7290 => loss:   1.734 (#OOM: 0)
Epoch 16 - update       7320 => loss:   2.246 (#OOM: 0)
Epoch 16 - update       7350 => loss:   1.232 (#OOM: 0)
Epoch 16 - update       7380 => loss:   1.751 (#OOM: 0)
Epoch 16 - update       7410 => loss:   1.945 (#OOM: 0)
Epoch 16 - update       7440 => loss:   1.765 (#OOM: 0)
Epoch 16 - update       7470 => loss:   2.483 (#OOM: 0)
Epoch 16 - update       7500 => loss:   2.215 (#OOM: 0)
Epoch 16 - update       7530 => loss:   2.122 (#OOM: 0)
Epoch 16 - update       7560 => loss:   1.918 (#OOM: 0)
Epoch 16 - update       7590 => loss:   1.156 (#OOM: 0)
Epoch 16 - update       7620 => loss:   1.698 (#OOM: 0)
--> Epoch 16 finished with mean loss 1.87684
--> Overhead/Training/Evaluation: 0.03/0.47/0.00 mins (total: 0.50 mins)   (1032 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 49.01batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 56.01batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 56.97batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 56.32batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 55.88batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.47batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 82.91batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 83.20batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 81.88batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 83.09batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 83.02batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 83.89batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 84.61batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 83.75batch/s]  8%|██▎                         | 82/1014 [00:00<00:10, 85.16batch/s]  9%|██▌                         | 92/1014 [00:01<00:10, 84.95batch/s] 10%|██▋                        | 102/1014 [00:01<00:10, 84.44batch/s] 11%|██▉                        | 112/1014 [00:01<00:10, 85.09batch/s] 12%|███▏                       | 122/1014 [00:01<00:10, 84.60batch/s] 13%|███▌                       | 132/1014 [00:01<00:10, 84.41batch/s] 14%|███▊                       | 142/1014 [00:01<00:10, 84.58batch/s] 15%|████                       | 152/1014 [00:01<00:10, 84.31batch/s] 16%|████▎                      | 162/1014 [00:01<00:10, 84.38batch/s] 17%|████▌                      | 172/1014 [00:02<00:10, 84.02batch/s] 18%|████▊                      | 182/1014 [00:02<00:09, 83.22batch/s] 19%|█████                      | 192/1014 [00:02<00:09, 83.09batch/s] 20%|█████▍                     | 202/1014 [00:02<00:09, 83.62batch/s] 21%|█████▋                     | 212/1014 [00:02<00:09, 83.68batch/s] 22%|█████▉                     | 222/1014 [00:02<00:09, 83.57batch/s] 23%|██████▏                    | 232/1014 [00:02<00:09, 83.33batch/s] 24%|██████▍                    | 242/1014 [00:02<00:09, 83.00batch/s] 25%|██████▋                    | 252/1014 [00:03<00:09, 83.26batch/s] 26%|██████▉                    | 262/1014 [00:03<00:09, 83.23batch/s] 27%|███████▏                   | 272/1014 [00:03<00:08, 83.39batch/s] 28%|███████▌                   | 282/1014 [00:03<00:08, 83.39batch/s] 29%|███████▊                   | 292/1014 [00:03<00:08, 83.50batch/s] 30%|████████                   | 302/1014 [00:03<00:08, 83.56batch/s] 31%|████████▎                  | 312/1014 [00:03<00:08, 82.99batch/s] 32%|████████▌                  | 322/1014 [00:03<00:08, 82.91batch/s] 33%|████████▊                  | 332/1014 [00:04<00:08, 82.92batch/s] 34%|█████████                  | 342/1014 [00:04<00:08, 82.85batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 82.75batch/s] 36%|█████████▋                 | 362/1014 [00:04<00:07, 82.78batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:07, 82.68batch/s] 38%|██████████▏                | 382/1014 [00:04<00:07, 82.77batch/s] 39%|██████████▍                | 392/1014 [00:04<00:07, 82.59batch/s] 40%|██████████▋                | 402/1014 [00:04<00:07, 82.61batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 82.38batch/s] 42%|███████████▏               | 422/1014 [00:05<00:07, 82.48batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 82.41batch/s] 44%|███████████▊               | 442/1014 [00:05<00:06, 82.48batch/s] 45%|████████████               | 452/1014 [00:05<00:06, 82.00batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 82.15batch/s] 47%|████████████▌              | 472/1014 [00:05<00:06, 81.99batch/s] 48%|████████████▊              | 482/1014 [00:05<00:06, 82.09batch/s] 49%|█████████████              | 492/1014 [00:05<00:06, 82.19batch/s] 50%|█████████████▎             | 502/1014 [00:06<00:06, 82.35batch/s] 50%|█████████████▋             | 512/1014 [00:06<00:06, 82.10batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:05, 82.21batch/s] 52%|██████████████▏            | 532/1014 [00:06<00:05, 82.30batch/s] 53%|██████████████▍            | 542/1014 [00:06<00:05, 82.09batch/s] 54%|██████████████▋            | 552/1014 [00:06<00:05, 82.06batch/s] 55%|██████████████▉            | 562/1014 [00:06<00:05, 82.06batch/s] 56%|███████████████▏           | 572/1014 [00:06<00:05, 82.10batch/s] 57%|███████████████▍           | 582/1014 [00:07<00:05, 81.91batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 82.05batch/s] 59%|████████████████           | 602/1014 [00:07<00:05, 81.94batch/s] 60%|████████████████▎          | 612/1014 [00:07<00:04, 82.03batch/s] 61%|████████████████▌          | 622/1014 [00:07<00:04, 82.14batch/s] 62%|████████████████▊          | 632/1014 [00:07<00:04, 82.07batch/s] 63%|█████████████████          | 642/1014 [00:07<00:04, 82.09batch/s] 64%|█████████████████▎         | 652/1014 [00:07<00:04, 82.23batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 82.06batch/s] 66%|█████████████████▉         | 672/1014 [00:08<00:04, 81.87batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 81.57batch/s] 68%|██████████████████▍        | 692/1014 [00:08<00:03, 81.63batch/s] 69%|██████████████████▋        | 702/1014 [00:08<00:03, 81.53batch/s] 70%|██████████████████▉        | 712/1014 [00:08<00:03, 81.51batch/s] 71%|███████████████████▏       | 722/1014 [00:08<00:03, 81.56batch/s] 72%|███████████████████▍       | 732/1014 [00:08<00:03, 81.75batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 81.82batch/s] 74%|████████████████████       | 752/1014 [00:09<00:03, 81.91batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 81.85batch/s] 76%|████████████████████▌      | 772/1014 [00:09<00:02, 81.86batch/s] 77%|████████████████████▊      | 782/1014 [00:09<00:02, 81.71batch/s] 78%|█████████████████████      | 792/1014 [00:09<00:02, 81.69batch/s] 79%|█████████████████████▎     | 802/1014 [00:09<00:02, 81.58batch/s] 80%|█████████████████████▌     | 812/1014 [00:09<00:02, 81.48batch/s] 81%|█████████████████████▉     | 822/1014 [00:10<00:02, 81.55batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 81.52batch/s] 83%|██████████████████████▍    | 842/1014 [00:10<00:02, 81.53batch/s] 84%|██████████████████████▋    | 852/1014 [00:10<00:01, 81.49batch/s] 85%|██████████████████████▉    | 862/1014 [00:10<00:01, 81.48batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 81.34batch/s] 87%|███████████████████████▍   | 882/1014 [00:10<00:01, 81.37batch/s] 88%|███████████████████████▊   | 892/1014 [00:10<00:01, 81.47batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 81.49batch/s] 90%|████████████████████████▎  | 912/1014 [00:11<00:01, 81.46batch/s] 91%|████████████████████████▌  | 922/1014 [00:11<00:01, 81.42batch/s] 92%|████████████████████████▊  | 932/1014 [00:11<00:01, 81.42batch/s] 93%|█████████████████████████  | 942/1014 [00:11<00:00, 81.48batch/s] 94%|█████████████████████████▎ | 952/1014 [00:11<00:00, 81.39batch/s] 95%|█████████████████████████▋ | 963/1014 [00:11<00:00, 81.58batch/s] 96%|█████████████████████████▉ | 974/1014 [00:11<00:00, 81.62batch/s] 97%|██████████████████████████▏| 985/1014 [00:12<00:00, 81.63batch/s] 98%|██████████████████████████▌| 996/1014 [00:12<00:00, 81.56batch/s] 99%|█████████████████████████▊| 1007/1014 [00:12<00:00, 81.63batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.66batch/s]
Validation 16 -> LOSS = 1.87
Validation 16 -> BLEU = 27.64, 58.7/33.5/21.8/14.2 (BP=0.990, ratio=0.990, hyp_len=12703, ref_len=12828)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.87 @ validation 16
--> Best BLEU so far: 27.66 @ validation 15
Starting Epoch 17
Epoch 17 - update       7650 => loss:   1.190 (#OOM: 0)
Epoch 17 - update       7680 => loss:   2.785 (#OOM: 0)
Epoch 17 - update       7710 => loss:   2.019 (#OOM: 0)
Epoch 17 - update       7740 => loss:   2.194 (#OOM: 0)
Epoch 17 - update       7770 => loss:   1.495 (#OOM: 0)
Epoch 17 - update       7800 => loss:   2.038 (#OOM: 0)
Epoch 17 - update       7830 => loss:   2.156 (#OOM: 0)
Epoch 17 - update       7860 => loss:   1.652 (#OOM: 0)
Epoch 17 - update       7890 => loss:   1.439 (#OOM: 0)
Epoch 17 - update       7920 => loss:   1.427 (#OOM: 0)
Epoch 17 - update       7950 => loss:   1.893 (#OOM: 0)
Epoch 17 - update       7980 => loss:   1.778 (#OOM: 0)
Epoch 17 - update       8010 => loss:   1.665 (#OOM: 0)
Epoch 17 - update       8040 => loss:   1.637 (#OOM: 0)
Epoch 17 - update       8070 => loss:   2.525 (#OOM: 0)
Epoch 17 - update       8100 => loss:   1.043 (#OOM: 0)
--> Epoch 17 finished with mean loss 1.83665
--> Overhead/Training/Evaluation: 0.04/0.54/0.00 mins (total: 0.58 mins)   (891 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.10batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 51.94batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.50batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 53.14batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 53.19batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.61batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.69batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 79.77batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 81.76batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.86batch/s]  5%|█▎                          | 46/1014 [00:00<00:11, 84.74batch/s]  6%|█▌                          | 56/1014 [00:00<00:11, 82.88batch/s]  7%|█▊                          | 66/1014 [00:00<00:11, 83.17batch/s]  7%|██                          | 76/1014 [00:00<00:11, 84.35batch/s]  8%|██▎                         | 86/1014 [00:01<00:10, 85.49batch/s]  9%|██▋                         | 96/1014 [00:01<00:10, 85.90batch/s] 10%|██▊                        | 106/1014 [00:01<00:10, 85.72batch/s] 11%|███                        | 116/1014 [00:01<00:10, 85.55batch/s] 12%|███▎                       | 126/1014 [00:01<00:10, 85.08batch/s] 13%|███▌                       | 136/1014 [00:01<00:10, 85.70batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 85.59batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 85.69batch/s] 16%|████▍                      | 166/1014 [00:01<00:09, 86.29batch/s] 17%|████▋                      | 176/1014 [00:02<00:09, 85.87batch/s] 18%|████▉                      | 186/1014 [00:02<00:09, 85.77batch/s] 19%|█████▏                     | 196/1014 [00:02<00:09, 85.79batch/s] 20%|█████▍                     | 206/1014 [00:02<00:09, 85.74batch/s] 21%|█████▊                     | 216/1014 [00:02<00:09, 86.01batch/s] 22%|██████                     | 226/1014 [00:02<00:09, 85.88batch/s] 23%|██████▎                    | 236/1014 [00:02<00:09, 85.84batch/s] 24%|██████▌                    | 246/1014 [00:02<00:08, 86.22batch/s] 25%|██████▊                    | 256/1014 [00:02<00:08, 85.89batch/s] 26%|███████                    | 267/1014 [00:03<00:08, 86.47batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 86.44batch/s] 29%|███████▋                   | 289/1014 [00:03<00:08, 86.77batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 86.77batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 86.88batch/s] 32%|████████▌                  | 322/1014 [00:03<00:07, 86.74batch/s] 33%|████████▊                  | 333/1014 [00:03<00:07, 86.32batch/s] 34%|█████████▏                 | 344/1014 [00:03<00:07, 86.12batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:07, 86.05batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:07, 85.89batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 86.14batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 86.13batch/s] 39%|██████████▌                | 399/1014 [00:04<00:07, 86.13batch/s] 40%|██████████▉                | 410/1014 [00:04<00:07, 85.95batch/s] 42%|███████████▏               | 421/1014 [00:04<00:06, 85.77batch/s] 43%|███████████▌               | 432/1014 [00:05<00:06, 85.77batch/s] 44%|███████████▊               | 443/1014 [00:05<00:06, 85.49batch/s] 45%|████████████               | 454/1014 [00:05<00:06, 85.18batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 85.41batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 85.40batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 85.56batch/s] 49%|█████████████▎             | 498/1014 [00:05<00:06, 85.88batch/s] 50%|█████████████▌             | 509/1014 [00:05<00:05, 86.01batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:05, 85.80batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:05, 85.87batch/s] 53%|██████████████▍            | 542/1014 [00:06<00:05, 86.05batch/s] 55%|██████████████▋            | 553/1014 [00:06<00:05, 86.18batch/s] 56%|███████████████            | 564/1014 [00:06<00:05, 86.26batch/s] 57%|███████████████▎           | 575/1014 [00:06<00:05, 86.14batch/s] 58%|███████████████▌           | 586/1014 [00:06<00:04, 86.10batch/s] 59%|███████████████▉           | 597/1014 [00:06<00:04, 86.07batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:04, 86.06batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:04, 86.17batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 86.21batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 85.97batch/s] 64%|█████████████████▎         | 652/1014 [00:07<00:04, 85.66batch/s] 65%|█████████████████▋         | 663/1014 [00:07<00:04, 85.71batch/s] 66%|█████████████████▉         | 674/1014 [00:07<00:03, 85.81batch/s] 68%|██████████████████▏        | 685/1014 [00:07<00:03, 85.88batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:03, 85.93batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 86.04batch/s] 71%|███████████████████        | 718/1014 [00:08<00:03, 86.03batch/s] 72%|███████████████████▍       | 729/1014 [00:08<00:03, 85.98batch/s] 73%|███████████████████▋       | 740/1014 [00:08<00:03, 86.05batch/s] 74%|███████████████████▉       | 751/1014 [00:08<00:03, 86.02batch/s] 75%|████████████████████▎      | 762/1014 [00:08<00:02, 85.98batch/s] 76%|████████████████████▌      | 773/1014 [00:08<00:02, 86.01batch/s] 77%|████████████████████▉      | 784/1014 [00:09<00:02, 86.09batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 85.97batch/s] 79%|█████████████████████▍     | 806/1014 [00:09<00:02, 86.00batch/s] 81%|█████████████████████▊     | 817/1014 [00:09<00:02, 86.07batch/s] 82%|██████████████████████     | 828/1014 [00:09<00:02, 86.07batch/s] 83%|██████████████████████▎    | 839/1014 [00:09<00:02, 85.93batch/s] 84%|██████████████████████▋    | 850/1014 [00:09<00:01, 85.90batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 85.87batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 85.84batch/s] 87%|███████████████████████▌   | 883/1014 [00:10<00:01, 85.78batch/s] 88%|███████████████████████▊   | 894/1014 [00:10<00:01, 85.70batch/s] 89%|████████████████████████   | 905/1014 [00:10<00:01, 85.82batch/s] 90%|████████████████████████▍  | 916/1014 [00:10<00:01, 85.91batch/s] 91%|████████████████████████▋  | 927/1014 [00:10<00:01, 85.91batch/s] 93%|████████████████████████▉  | 938/1014 [00:10<00:00, 86.01batch/s] 94%|█████████████████████████▎ | 949/1014 [00:11<00:00, 86.02batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 86.10batch/s] 96%|█████████████████████████▊ | 971/1014 [00:11<00:00, 86.00batch/s] 97%|██████████████████████████▏| 982/1014 [00:11<00:00, 86.03batch/s] 98%|██████████████████████████▍| 993/1014 [00:11<00:00, 86.09batch/s] 99%|█████████████████████████▋| 1004/1014 [00:11<00:00, 86.01batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 86.05batch/s]
Validation 17 -> LOSS = 1.87
Validation 17 -> BLEU = 27.14, 60.4/34.7/22.5/14.6 (BP=0.942, ratio=0.943, hyp_len=12099, ref_len=12828)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.87 @ validation 16
--> Best BLEU so far: 27.66 @ validation 15
Starting Epoch 18
Epoch 18 - update       8130 => loss:   1.558 (#OOM: 0)
Epoch 18 - update       8160 => loss:   2.137 (#OOM: 0)
Epoch 18 - update       8190 => loss:   2.390 (#OOM: 0)
Epoch 18 - update       8220 => loss:   2.646 (#OOM: 0)
Epoch 18 - update       8250 => loss:   1.531 (#OOM: 0)
Epoch 18 - update       8280 => loss:   1.378 (#OOM: 0)
Epoch 18 - update       8310 => loss:   1.578 (#OOM: 0)
Epoch 18 - update       8340 => loss:   1.703 (#OOM: 0)
Epoch 18 - update       8370 => loss:   1.453 (#OOM: 0)
Epoch 18 - update       8400 => loss:   1.059 (#OOM: 0)
Epoch 18 - update       8430 => loss:   1.807 (#OOM: 0)
Epoch 18 - update       8460 => loss:   1.558 (#OOM: 0)
Epoch 18 - update       8490 => loss:   2.110 (#OOM: 0)
Epoch 18 - update       8520 => loss:   1.613 (#OOM: 0)
Epoch 18 - update       8550 => loss:   1.602 (#OOM: 0)
Epoch 18 - update       8580 => loss:   1.504 (#OOM: 0)
--> Epoch 18 finished with mean loss 1.79700
--> Overhead/Training/Evaluation: 0.04/0.55/0.00 mins (total: 0.58 mins)   (884 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 52.43batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 57.94batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 54.99batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 56.51batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 54.86batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.09batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 77.89batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.81batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 81.62batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 78.91batch/s]  5%|█▎                          | 46/1014 [00:00<00:11, 83.03batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 83.76batch/s]  7%|█▉                          | 68/1014 [00:00<00:11, 84.63batch/s]  8%|██▏                         | 79/1014 [00:00<00:10, 85.48batch/s]  9%|██▌                         | 91/1014 [00:01<00:10, 88.08batch/s] 10%|██▋                        | 103/1014 [00:01<00:10, 87.88batch/s] 11%|███                        | 115/1014 [00:01<00:10, 87.77batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 87.81batch/s] 14%|███▋                       | 139/1014 [00:01<00:10, 87.29batch/s] 15%|████                       | 151/1014 [00:01<00:09, 86.86batch/s] 16%|████▎                      | 163/1014 [00:01<00:09, 87.46batch/s] 17%|████▋                      | 175/1014 [00:02<00:09, 86.83batch/s] 18%|████▉                      | 187/1014 [00:02<00:09, 86.73batch/s] 20%|█████▎                     | 199/1014 [00:02<00:09, 86.54batch/s] 21%|█████▌                     | 211/1014 [00:02<00:09, 86.60batch/s] 22%|█████▉                     | 223/1014 [00:02<00:09, 86.63batch/s] 23%|██████▎                    | 235/1014 [00:02<00:08, 86.93batch/s] 24%|██████▌                    | 247/1014 [00:02<00:08, 86.60batch/s] 26%|██████▉                    | 259/1014 [00:02<00:08, 86.59batch/s] 27%|███████▏                   | 271/1014 [00:03<00:08, 86.38batch/s] 28%|███████▌                   | 283/1014 [00:03<00:08, 85.68batch/s] 29%|███████▊                   | 295/1014 [00:03<00:08, 85.79batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 85.44batch/s] 31%|████████▍                  | 319/1014 [00:03<00:08, 85.46batch/s] 33%|████████▊                  | 331/1014 [00:03<00:07, 85.60batch/s] 34%|█████████▏                 | 343/1014 [00:04<00:07, 85.69batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:07, 85.82batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:07, 85.74batch/s] 37%|██████████                 | 379/1014 [00:04<00:07, 86.00batch/s] 39%|██████████▍                | 391/1014 [00:04<00:07, 86.05batch/s] 40%|██████████▋                | 403/1014 [00:04<00:07, 85.44batch/s] 41%|███████████                | 415/1014 [00:04<00:06, 85.74batch/s] 42%|███████████▎               | 427/1014 [00:04<00:06, 85.52batch/s] 43%|███████████▋               | 439/1014 [00:05<00:06, 85.58batch/s] 44%|████████████               | 451/1014 [00:05<00:06, 85.53batch/s] 46%|████████████▎              | 463/1014 [00:05<00:06, 85.75batch/s] 47%|████████████▋              | 475/1014 [00:05<00:06, 85.83batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 86.10batch/s] 49%|█████████████▎             | 499/1014 [00:05<00:06, 85.54batch/s] 50%|█████████████▌             | 511/1014 [00:05<00:05, 85.40batch/s] 52%|█████████████▉             | 523/1014 [00:06<00:05, 85.25batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:05, 85.22batch/s] 54%|██████████████▌            | 547/1014 [00:06<00:05, 84.91batch/s] 55%|██████████████▉            | 559/1014 [00:06<00:05, 84.81batch/s] 56%|███████████████▏           | 571/1014 [00:06<00:05, 84.58batch/s] 57%|███████████████▌           | 583/1014 [00:06<00:05, 84.64batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:04, 84.60batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:04, 84.71batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:04, 84.83batch/s] 62%|████████████████▊          | 631/1014 [00:07<00:04, 84.83batch/s] 63%|█████████████████          | 643/1014 [00:07<00:04, 84.82batch/s] 65%|█████████████████▍         | 655/1014 [00:07<00:04, 84.87batch/s] 66%|█████████████████▊         | 667/1014 [00:07<00:04, 84.83batch/s] 67%|██████████████████         | 679/1014 [00:08<00:03, 84.71batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:03, 84.61batch/s] 69%|██████████████████▋        | 703/1014 [00:08<00:03, 84.70batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 84.68batch/s] 72%|███████████████████▎       | 727/1014 [00:08<00:03, 84.49batch/s] 73%|███████████████████▋       | 739/1014 [00:08<00:03, 84.46batch/s] 74%|███████████████████▉       | 751/1014 [00:08<00:03, 84.44batch/s] 75%|████████████████████▎      | 763/1014 [00:09<00:02, 84.53batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:02, 84.65batch/s] 78%|████████████████████▉      | 787/1014 [00:09<00:02, 84.77batch/s] 79%|█████████████████████▎     | 799/1014 [00:09<00:02, 84.76batch/s] 80%|█████████████████████▌     | 811/1014 [00:09<00:02, 84.66batch/s] 81%|█████████████████████▉     | 823/1014 [00:09<00:02, 84.68batch/s] 82%|██████████████████████▏    | 835/1014 [00:09<00:02, 84.61batch/s] 84%|██████████████████████▌    | 847/1014 [00:09<00:01, 84.76batch/s] 85%|██████████████████████▊    | 859/1014 [00:10<00:01, 84.65batch/s] 86%|███████████████████████▏   | 871/1014 [00:10<00:01, 84.71batch/s] 87%|███████████████████████▌   | 883/1014 [00:10<00:01, 84.71batch/s] 88%|███████████████████████▊   | 895/1014 [00:10<00:01, 84.71batch/s] 89%|████████████████████████▏  | 907/1014 [00:10<00:01, 84.55batch/s] 91%|████████████████████████▍  | 919/1014 [00:10<00:01, 84.47batch/s] 92%|████████████████████████▊  | 931/1014 [00:11<00:00, 84.43batch/s] 93%|█████████████████████████  | 943/1014 [00:11<00:00, 84.38batch/s] 94%|█████████████████████████▍ | 955/1014 [00:11<00:00, 84.50batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 84.56batch/s] 97%|██████████████████████████ | 979/1014 [00:11<00:00, 84.67batch/s] 98%|██████████████████████████▍| 991/1014 [00:11<00:00, 84.74batch/s] 99%|█████████████████████████▋| 1003/1014 [00:11<00:00, 84.76batch/s]100%|██████████████████████████| 1014/1014 [00:11<00:00, 84.73batch/s]
Validation 18 -> LOSS = 1.85
Validation 18 -> BLEU = 27.32, 60.4/34.8/22.5/14.8 (BP=0.945, ratio=0.946, hyp_len=12139, ref_len=12828)
** Learning rate changed -> 0.0002
Saving best model based on LOSS
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.85 @ validation 18
--> Best BLEU so far: 27.66 @ validation 15
Starting Epoch 19
Epoch 19 - update       8610 => loss:   2.320 (#OOM: 0)
Epoch 19 - update       8640 => loss:   1.552 (#OOM: 0)
Epoch 19 - update       8670 => loss:   2.108 (#OOM: 0)
Epoch 19 - update       8700 => loss:   1.642 (#OOM: 0)
Epoch 19 - update       8730 => loss:   1.769 (#OOM: 0)
Epoch 19 - update       8760 => loss:   2.137 (#OOM: 0)
Epoch 19 - update       8790 => loss:   2.093 (#OOM: 0)
Epoch 19 - update       8820 => loss:   1.641 (#OOM: 0)
Epoch 19 - update       8850 => loss:   1.333 (#OOM: 0)
Epoch 19 - update       8880 => loss:   1.283 (#OOM: 0)
Epoch 19 - update       8910 => loss:   2.305 (#OOM: 0)
Epoch 19 - update       8940 => loss:   2.158 (#OOM: 0)
Epoch 19 - update       8970 => loss:   1.119 (#OOM: 0)
Epoch 19 - update       9000 => loss:   1.421 (#OOM: 0)
Epoch 19 - update       9030 => loss:   1.654 (#OOM: 0)
Epoch 19 - update       9060 => loss:   1.726 (#OOM: 0)
--> Epoch 19 finished with mean loss 1.72789
--> Overhead/Training/Evaluation: 0.04/0.55/0.00 mins (total: 0.59 mins)   (873 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.08batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 56.33batch/s] 57%|█████████████████▏            | 20/35 [00:00<00:00, 58.61batch/s] 77%|███████████████████████▏      | 27/35 [00:00<00:00, 56.01batch/s] 97%|█████████████████████████████▏| 34/35 [00:00<00:00, 55.45batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.88batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 93.19batch/s]  2%|▌                           | 20/1014 [00:00<00:11, 85.08batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 85.67batch/s]  4%|█                           | 40/1014 [00:00<00:11, 84.62batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 83.97batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 81.93batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 81.65batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 82.10batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 82.28batch/s] 10%|██▋                        | 100/1014 [00:01<00:10, 83.13batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 82.35batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 82.24batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 82.98batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 82.93batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 82.80batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 82.53batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 82.80batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 83.07batch/s] 19%|█████                      | 190/1014 [00:02<00:09, 83.51batch/s] 20%|█████▎                     | 200/1014 [00:02<00:09, 83.37batch/s] 21%|█████▌                     | 210/1014 [00:02<00:09, 83.62batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 83.34batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 83.23batch/s] 24%|██████▍                    | 240/1014 [00:02<00:09, 83.06batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 82.74batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 82.31batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 82.33batch/s] 28%|███████▍                   | 280/1014 [00:03<00:08, 81.72batch/s] 29%|███████▋                   | 290/1014 [00:03<00:08, 81.86batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 81.69batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 81.74batch/s] 32%|████████▌                  | 320/1014 [00:03<00:08, 81.91batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 82.07batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 81.84batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 81.75batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:07, 82.02batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:07, 82.06batch/s] 37%|██████████                 | 380/1014 [00:04<00:07, 82.10batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 82.11batch/s] 39%|██████████▋                | 400/1014 [00:04<00:07, 82.43batch/s] 40%|██████████▉                | 410/1014 [00:04<00:07, 82.15batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 82.33batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 82.37batch/s] 43%|███████████▋               | 440/1014 [00:05<00:06, 82.35batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 82.27batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 82.05batch/s] 46%|████████████▌              | 470/1014 [00:05<00:06, 82.08batch/s] 47%|████████████▊              | 480/1014 [00:05<00:06, 82.02batch/s] 48%|█████████████              | 490/1014 [00:05<00:06, 82.02batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 82.10batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 82.18batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 82.15batch/s] 52%|██████████████             | 530/1014 [00:06<00:05, 82.15batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:05, 82.34batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 82.39batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 82.23batch/s] 56%|███████████████▏           | 570/1014 [00:06<00:05, 82.17batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 82.27batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 82.15batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 82.11batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 82.14batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 82.01batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 82.05batch/s] 63%|█████████████████          | 640/1014 [00:07<00:04, 82.00batch/s] 64%|█████████████████▎         | 650/1014 [00:07<00:04, 81.91batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 81.88batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 81.79batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 81.82batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:03, 81.94batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 81.91batch/s] 70%|██████████████████▉        | 710/1014 [00:08<00:03, 82.07batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 82.21batch/s] 72%|███████████████████▍       | 730/1014 [00:08<00:03, 82.26batch/s] 73%|███████████████████▋       | 740/1014 [00:08<00:03, 82.27batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 82.41batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 82.24batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:02, 82.32batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 82.48batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 82.44batch/s] 79%|█████████████████████▎     | 800/1014 [00:09<00:02, 82.32batch/s] 80%|█████████████████████▌     | 810/1014 [00:09<00:02, 82.37batch/s] 81%|█████████████████████▊     | 820/1014 [00:09<00:02, 82.24batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 82.36batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 82.28batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:01, 82.26batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 82.36batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 82.47batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 82.48batch/s] 88%|███████████████████████▋   | 890/1014 [00:10<00:01, 82.41batch/s] 89%|███████████████████████▉   | 900/1014 [00:10<00:01, 82.44batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 82.47batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 82.30batch/s] 92%|████████████████████████▊  | 930/1014 [00:11<00:01, 82.25batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 82.12batch/s] 94%|█████████████████████████▎ | 950/1014 [00:11<00:00, 81.99batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 81.94batch/s] 96%|█████████████████████████▊ | 970/1014 [00:11<00:00, 81.95batch/s] 97%|██████████████████████████ | 980/1014 [00:11<00:00, 82.10batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 82.15batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 82.10batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 82.14batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.15batch/s]
Validation 19 -> LOSS = 1.83
Validation 19 -> BLEU = 28.10, 59.7/34.4/22.3/14.6 (BP=0.982, ratio=0.982, hyp_len=12593, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.83 @ validation 19
--> Best BLEU so far: 28.10 @ validation 19
Starting Epoch 20
Epoch 20 - update       9090 => loss:   1.407 (#OOM: 0)
Epoch 20 - update       9120 => loss:   1.542 (#OOM: 0)
Epoch 20 - update       9150 => loss:   1.388 (#OOM: 0)
Epoch 20 - update       9180 => loss:   1.180 (#OOM: 0)
Epoch 20 - update       9210 => loss:   1.153 (#OOM: 0)
Epoch 20 - update       9240 => loss:   2.022 (#OOM: 0)
Epoch 20 - update       9270 => loss:   0.846 (#OOM: 0)
Epoch 20 - update       9300 => loss:   1.868 (#OOM: 0)
Epoch 20 - update       9330 => loss:   1.539 (#OOM: 0)
Epoch 20 - update       9360 => loss:   2.392 (#OOM: 0)
Epoch 20 - update       9390 => loss:   1.712 (#OOM: 0)
Epoch 20 - update       9420 => loss:   1.780 (#OOM: 0)
Epoch 20 - update       9450 => loss:   1.734 (#OOM: 0)
Epoch 20 - update       9480 => loss:   1.976 (#OOM: 0)
Epoch 20 - update       9510 => loss:   1.374 (#OOM: 0)
Epoch 20 - update       9540 => loss:   1.290 (#OOM: 0)
--> Epoch 20 finished with mean loss 1.70152
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.65 mins)   (793 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.88batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 57.85batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 55.51batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 55.00batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 54.40batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.32batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 74.63batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 76.82batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 78.04batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 81.67batch/s]  5%|█▎                          | 46/1014 [00:00<00:11, 81.90batch/s]  6%|█▌                          | 56/1014 [00:00<00:11, 82.07batch/s]  7%|█▊                          | 66/1014 [00:00<00:11, 84.29batch/s]  7%|██                          | 76/1014 [00:00<00:11, 84.56batch/s]  8%|██▎                         | 86/1014 [00:01<00:10, 84.78batch/s]  9%|██▋                         | 96/1014 [00:01<00:10, 85.09batch/s] 10%|██▊                        | 106/1014 [00:01<00:10, 84.00batch/s] 11%|███                        | 116/1014 [00:01<00:10, 84.96batch/s] 12%|███▎                       | 126/1014 [00:01<00:10, 85.11batch/s] 13%|███▌                       | 136/1014 [00:01<00:10, 85.15batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 85.65batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 85.53batch/s] 16%|████▍                      | 166/1014 [00:01<00:09, 85.73batch/s] 17%|████▋                      | 176/1014 [00:02<00:09, 85.35batch/s] 18%|████▉                      | 186/1014 [00:02<00:09, 85.66batch/s] 19%|█████▏                     | 196/1014 [00:02<00:09, 84.99batch/s] 20%|█████▍                     | 206/1014 [00:02<00:09, 84.91batch/s] 21%|█████▊                     | 216/1014 [00:02<00:09, 84.78batch/s] 22%|██████                     | 226/1014 [00:02<00:09, 84.60batch/s] 23%|██████▎                    | 236/1014 [00:02<00:09, 84.06batch/s] 24%|██████▌                    | 246/1014 [00:02<00:09, 84.22batch/s] 25%|██████▊                    | 256/1014 [00:03<00:08, 84.73batch/s] 26%|███████                    | 266/1014 [00:03<00:08, 84.55batch/s] 27%|███████▎                   | 276/1014 [00:03<00:08, 84.01batch/s] 28%|███████▌                   | 286/1014 [00:03<00:08, 84.05batch/s] 29%|███████▉                   | 296/1014 [00:03<00:08, 84.09batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 84.14batch/s] 31%|████████▍                  | 316/1014 [00:03<00:08, 84.27batch/s] 32%|████████▋                  | 326/1014 [00:03<00:08, 84.29batch/s] 33%|████████▉                  | 336/1014 [00:03<00:08, 84.48batch/s] 34%|█████████▏                 | 346/1014 [00:04<00:07, 84.28batch/s] 35%|█████████▍                 | 356/1014 [00:04<00:07, 84.00batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:07, 84.03batch/s] 37%|██████████                 | 376/1014 [00:04<00:07, 83.83batch/s] 38%|██████████▎                | 386/1014 [00:04<00:07, 83.86batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 83.75batch/s] 40%|██████████▊                | 406/1014 [00:04<00:07, 83.41batch/s] 41%|███████████                | 416/1014 [00:04<00:07, 83.44batch/s] 42%|███████████▎               | 426/1014 [00:05<00:07, 83.30batch/s] 43%|███████████▌               | 436/1014 [00:05<00:06, 83.29batch/s] 44%|███████████▉               | 446/1014 [00:05<00:06, 83.49batch/s] 45%|████████████▏              | 456/1014 [00:05<00:06, 83.63batch/s] 46%|████████████▍              | 466/1014 [00:05<00:06, 83.81batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 83.87batch/s] 48%|████████████▉              | 486/1014 [00:05<00:06, 84.09batch/s] 49%|█████████████▏             | 496/1014 [00:05<00:06, 83.91batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 84.00batch/s] 51%|█████████████▋             | 516/1014 [00:06<00:05, 84.24batch/s] 52%|██████████████             | 526/1014 [00:06<00:05, 84.34batch/s] 53%|██████████████▎            | 536/1014 [00:06<00:05, 84.31batch/s] 54%|██████████████▌            | 546/1014 [00:06<00:05, 84.08batch/s] 55%|██████████████▊            | 556/1014 [00:06<00:05, 84.00batch/s] 56%|███████████████            | 566/1014 [00:06<00:05, 84.16batch/s] 57%|███████████████▎           | 576/1014 [00:06<00:05, 84.14batch/s] 58%|███████████████▌           | 586/1014 [00:06<00:05, 84.21batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:04, 83.97batch/s] 60%|████████████████▏          | 606/1014 [00:07<00:04, 83.89batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 83.96batch/s] 62%|████████████████▋          | 626/1014 [00:07<00:04, 83.86batch/s] 63%|████████████████▉          | 636/1014 [00:07<00:04, 83.90batch/s] 64%|█████████████████▏         | 646/1014 [00:07<00:04, 83.97batch/s] 65%|█████████████████▍         | 656/1014 [00:07<00:04, 83.99batch/s] 66%|█████████████████▋         | 666/1014 [00:07<00:04, 84.06batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 83.93batch/s] 68%|██████████████████▎        | 686/1014 [00:08<00:03, 83.82batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:03, 83.78batch/s] 70%|██████████████████▊        | 706/1014 [00:08<00:03, 83.73batch/s] 71%|███████████████████        | 716/1014 [00:08<00:03, 83.70batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 83.80batch/s] 73%|███████████████████▌       | 736/1014 [00:08<00:03, 83.84batch/s] 74%|███████████████████▊       | 746/1014 [00:08<00:03, 83.85batch/s] 75%|████████████████████▏      | 756/1014 [00:09<00:03, 83.73batch/s] 76%|████████████████████▍      | 766/1014 [00:09<00:02, 83.72batch/s] 77%|████████████████████▋      | 776/1014 [00:09<00:02, 83.66batch/s] 78%|████████████████████▉      | 786/1014 [00:09<00:02, 83.72batch/s] 79%|█████████████████████▏     | 796/1014 [00:09<00:02, 83.75batch/s] 79%|█████████████████████▍     | 806/1014 [00:09<00:02, 83.83batch/s] 80%|█████████████████████▋     | 816/1014 [00:09<00:02, 83.80batch/s] 81%|█████████████████████▉     | 826/1014 [00:09<00:02, 83.76batch/s] 82%|██████████████████████▎    | 836/1014 [00:09<00:02, 83.80batch/s] 83%|██████████████████████▌    | 846/1014 [00:10<00:02, 83.88batch/s] 84%|██████████████████████▊    | 856/1014 [00:10<00:01, 83.91batch/s] 85%|███████████████████████    | 866/1014 [00:10<00:01, 83.98batch/s] 86%|███████████████████████▎   | 876/1014 [00:10<00:01, 83.91batch/s] 87%|███████████████████████▌   | 886/1014 [00:10<00:01, 83.85batch/s] 88%|███████████████████████▊   | 896/1014 [00:10<00:01, 83.82batch/s] 89%|████████████████████████▏  | 907/1014 [00:10<00:01, 84.02batch/s] 91%|████████████████████████▍  | 918/1014 [00:10<00:01, 83.95batch/s] 92%|████████████████████████▋  | 929/1014 [00:11<00:01, 84.04batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 84.01batch/s] 94%|█████████████████████████▎ | 951/1014 [00:11<00:00, 84.03batch/s] 95%|█████████████████████████▌ | 962/1014 [00:11<00:00, 83.99batch/s] 96%|█████████████████████████▉ | 973/1014 [00:11<00:00, 83.89batch/s] 97%|██████████████████████████▏| 984/1014 [00:11<00:00, 83.94batch/s] 98%|██████████████████████████▍| 995/1014 [00:11<00:00, 83.90batch/s] 99%|█████████████████████████▊| 1006/1014 [00:11<00:00, 83.97batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 83.85batch/s]
Validation 20 -> LOSS = 1.83
Validation 20 -> BLEU = 27.95, 59.9/34.6/22.5/14.7 (BP=0.971, ratio=0.972, hyp_len=12467, ref_len=12828)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.83 @ validation 20
--> Best BLEU so far: 28.10 @ validation 19
Starting Epoch 21
Epoch 21 - update       9570 => loss:   1.415 (#OOM: 0)
Epoch 21 - update       9600 => loss:   1.302 (#OOM: 0)
Epoch 21 - update       9630 => loss:   1.351 (#OOM: 0)
Epoch 21 - update       9660 => loss:   1.279 (#OOM: 0)
Epoch 21 - update       9690 => loss:   2.195 (#OOM: 0)
Epoch 21 - update       9720 => loss:   1.998 (#OOM: 0)
Epoch 21 - update       9750 => loss:   2.000 (#OOM: 0)
Epoch 21 - update       9780 => loss:   1.448 (#OOM: 0)
Epoch 21 - update       9810 => loss:   0.815 (#OOM: 0)
Epoch 21 - update       9840 => loss:   2.351 (#OOM: 0)
Epoch 21 - update       9870 => loss:   1.459 (#OOM: 0)
Epoch 21 - update       9900 => loss:   1.498 (#OOM: 0)
Epoch 21 - update       9930 => loss:   1.336 (#OOM: 0)
Epoch 21 - update       9960 => loss:   1.509 (#OOM: 0)
Epoch 21 - update       9990 => loss:   1.438 (#OOM: 0)
--> Epoch 21 finished with mean loss 1.67814
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (845 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 59.21batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 56.94batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 58.90batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 56.61batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 57.29batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.38batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 88.89batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 78.87batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.71batch/s]  4%|█                           | 37/1014 [00:00<00:11, 82.98batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 82.93batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 81.85batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 83.01batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 83.59batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 82.78batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 82.33batch/s] 11%|██▊                        | 107/1014 [00:01<00:10, 83.00batch/s] 12%|███                        | 117/1014 [00:01<00:10, 83.28batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 83.69batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 84.01batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 84.25batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 83.36batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 83.40batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 83.62batch/s] 18%|████▉                      | 187/1014 [00:02<00:09, 83.73batch/s] 19%|█████▏                     | 197/1014 [00:02<00:09, 83.67batch/s] 20%|█████▌                     | 207/1014 [00:02<00:09, 84.10batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 83.54batch/s] 22%|██████                     | 227/1014 [00:02<00:09, 84.15batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 84.28batch/s] 24%|██████▌                    | 247/1014 [00:02<00:09, 83.92batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 83.92batch/s] 26%|███████                    | 267/1014 [00:03<00:08, 84.06batch/s] 27%|███████▍                   | 277/1014 [00:03<00:08, 84.08batch/s] 28%|███████▋                   | 287/1014 [00:03<00:08, 83.83batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 83.64batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 83.27batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 83.36batch/s] 32%|████████▋                  | 327/1014 [00:03<00:08, 83.17batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 83.44batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:07, 83.55batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:07, 83.25batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:07, 82.97batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 82.56batch/s] 38%|██████████▎                | 387/1014 [00:04<00:07, 82.76batch/s] 39%|██████████▌                | 397/1014 [00:04<00:07, 82.81batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 82.92batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 82.99batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 82.78batch/s] 43%|███████████▋               | 437/1014 [00:05<00:06, 82.85batch/s] 44%|███████████▉               | 447/1014 [00:05<00:06, 82.77batch/s] 45%|████████████▏              | 457/1014 [00:05<00:06, 82.68batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 82.61batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 82.51batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 82.59batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 82.69batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 82.68batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 82.62batch/s] 52%|██████████████             | 527/1014 [00:06<00:05, 82.55batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 82.64batch/s] 54%|██████████████▌            | 547/1014 [00:06<00:05, 82.61batch/s] 55%|██████████████▊            | 557/1014 [00:06<00:05, 82.54batch/s] 56%|███████████████            | 567/1014 [00:06<00:05, 82.37batch/s] 57%|███████████████▎           | 577/1014 [00:06<00:05, 82.57batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 82.59batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 82.59batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:04, 82.70batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:04, 82.75batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 82.72batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 82.74batch/s] 64%|█████████████████▏         | 647/1014 [00:07<00:04, 82.92batch/s] 65%|█████████████████▍         | 657/1014 [00:07<00:04, 82.98batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 82.91batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 82.89batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:03, 82.95batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:03, 83.08batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 83.06batch/s] 71%|███████████████████        | 717/1014 [00:08<00:03, 83.11batch/s] 72%|███████████████████▎       | 727/1014 [00:08<00:03, 83.03batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 82.96batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 82.82batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 82.66batch/s] 76%|████████████████████▍      | 767/1014 [00:09<00:02, 82.84batch/s] 77%|████████████████████▋      | 777/1014 [00:09<00:02, 82.86batch/s] 78%|████████████████████▉      | 787/1014 [00:09<00:02, 83.00batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 83.05batch/s] 80%|█████████████████████▍     | 807/1014 [00:09<00:02, 83.13batch/s] 81%|█████████████████████▊     | 817/1014 [00:09<00:02, 83.14batch/s] 82%|██████████████████████     | 827/1014 [00:09<00:02, 83.11batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 83.08batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 83.09batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 83.06batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 83.18batch/s] 86%|███████████████████████▎   | 877/1014 [00:10<00:01, 83.24batch/s] 87%|███████████████████████▌   | 887/1014 [00:10<00:01, 83.16batch/s] 88%|███████████████████████▉   | 897/1014 [00:10<00:01, 83.08batch/s] 89%|████████████████████████▏  | 907/1014 [00:10<00:01, 83.14batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 83.14batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 83.03batch/s] 92%|████████████████████████▉  | 937/1014 [00:11<00:00, 82.93batch/s] 93%|█████████████████████████▏ | 947/1014 [00:11<00:00, 82.86batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 82.92batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 82.99batch/s] 96%|██████████████████████████ | 977/1014 [00:11<00:00, 82.94batch/s] 97%|██████████████████████████▎| 987/1014 [00:11<00:00, 82.90batch/s] 98%|██████████████████████████▌| 998/1014 [00:12<00:00, 83.06batch/s]100%|█████████████████████████▊| 1009/1014 [00:12<00:00, 82.87batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.86batch/s]
Validation 21 -> LOSS = 1.83
Validation 21 -> BLEU = 28.13, 59.8/34.5/22.5/14.8 (BP=0.977, ratio=0.977, hyp_len=12538, ref_len=12828)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.83 @ validation 20
--> Best BLEU so far: 28.13 @ validation 21
Starting Epoch 22
Epoch 22 - update      10020 => loss:   1.575 (#OOM: 0)
Epoch 22 - update      10050 => loss:   0.931 (#OOM: 0)
Epoch 22 - update      10080 => loss:   0.899 (#OOM: 0)
Epoch 22 - update      10110 => loss:   1.329 (#OOM: 0)
Epoch 22 - update      10140 => loss:   1.304 (#OOM: 0)
Epoch 22 - update      10170 => loss:   1.438 (#OOM: 0)
Epoch 22 - update      10200 => loss:   2.416 (#OOM: 0)
Epoch 22 - update      10230 => loss:   1.413 (#OOM: 0)
Epoch 22 - update      10260 => loss:   1.583 (#OOM: 0)
Epoch 22 - update      10290 => loss:   1.849 (#OOM: 0)
Epoch 22 - update      10320 => loss:   1.795 (#OOM: 0)
Epoch 22 - update      10350 => loss:   1.256 (#OOM: 0)
Epoch 22 - update      10380 => loss:   1.808 (#OOM: 0)
Epoch 22 - update      10410 => loss:   1.792 (#OOM: 0)
Epoch 22 - update      10440 => loss:   1.799 (#OOM: 0)
Epoch 22 - update      10470 => loss:   1.394 (#OOM: 0)
--> Epoch 22 finished with mean loss 1.66078
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (784 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.82batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 44.76batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 48.58batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 48.49batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 52.41batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.88batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 79.68batch/s]  2%|▍                           | 16/1014 [00:00<00:12, 79.82batch/s]  3%|▋                           | 26/1014 [00:00<00:11, 83.39batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.35batch/s]  5%|█▎                          | 46/1014 [00:00<00:11, 81.79batch/s]  6%|█▌                          | 56/1014 [00:00<00:11, 81.82batch/s]  7%|█▊                          | 66/1014 [00:00<00:11, 83.85batch/s]  7%|██                          | 76/1014 [00:00<00:11, 84.66batch/s]  8%|██▎                         | 86/1014 [00:01<00:11, 84.34batch/s]  9%|██▋                         | 96/1014 [00:01<00:10, 85.35batch/s] 10%|██▊                        | 106/1014 [00:01<00:10, 85.39batch/s] 11%|███                        | 116/1014 [00:01<00:10, 84.59batch/s] 12%|███▎                       | 126/1014 [00:01<00:10, 84.49batch/s] 13%|███▌                       | 136/1014 [00:01<00:10, 85.30batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 85.30batch/s] 15%|████▏                      | 156/1014 [00:01<00:10, 84.70batch/s] 16%|████▍                      | 166/1014 [00:01<00:09, 85.05batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 83.60batch/s] 18%|████▉                      | 186/1014 [00:02<00:09, 83.92batch/s] 19%|█████▏                     | 196/1014 [00:02<00:09, 83.79batch/s] 20%|█████▍                     | 206/1014 [00:02<00:09, 84.34batch/s] 21%|█████▊                     | 216/1014 [00:02<00:09, 83.96batch/s] 22%|██████                     | 226/1014 [00:02<00:09, 83.96batch/s] 23%|██████▎                    | 236/1014 [00:02<00:09, 83.96batch/s] 24%|██████▌                    | 246/1014 [00:02<00:09, 83.69batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 83.05batch/s] 26%|███████                    | 266/1014 [00:03<00:09, 82.64batch/s] 27%|███████▎                   | 276/1014 [00:03<00:08, 82.73batch/s] 28%|███████▌                   | 286/1014 [00:03<00:08, 82.36batch/s] 29%|███████▉                   | 296/1014 [00:03<00:08, 82.58batch/s] 30%|████████▏                  | 306/1014 [00:03<00:08, 82.45batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 82.94batch/s] 32%|████████▋                  | 328/1014 [00:03<00:08, 83.07batch/s] 33%|█████████                  | 339/1014 [00:04<00:08, 82.93batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:07, 83.12batch/s] 36%|█████████▌                 | 361/1014 [00:04<00:07, 83.22batch/s] 37%|█████████▉                 | 372/1014 [00:04<00:07, 83.32batch/s] 38%|██████████▏                | 383/1014 [00:04<00:07, 83.50batch/s] 39%|██████████▍                | 394/1014 [00:04<00:07, 83.46batch/s] 40%|██████████▊                | 405/1014 [00:04<00:07, 83.36batch/s] 41%|███████████                | 416/1014 [00:04<00:07, 83.50batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 83.80batch/s] 43%|███████████▋               | 438/1014 [00:05<00:06, 83.90batch/s] 44%|███████████▉               | 449/1014 [00:05<00:06, 84.04batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 83.79batch/s] 46%|████████████▌              | 471/1014 [00:05<00:06, 83.50batch/s] 48%|████████████▊              | 482/1014 [00:05<00:06, 83.62batch/s] 49%|█████████████▏             | 493/1014 [00:05<00:06, 83.55batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 83.54batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:05, 83.58batch/s] 52%|██████████████             | 526/1014 [00:06<00:05, 83.35batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 83.18batch/s] 54%|██████████████▌            | 548/1014 [00:06<00:05, 83.11batch/s] 55%|██████████████▉            | 559/1014 [00:06<00:05, 83.27batch/s] 56%|███████████████▏           | 570/1014 [00:06<00:05, 83.34batch/s] 57%|███████████████▍           | 581/1014 [00:06<00:05, 83.53batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 83.44batch/s] 59%|████████████████           | 603/1014 [00:07<00:04, 83.44batch/s] 61%|████████████████▎          | 614/1014 [00:07<00:04, 83.33batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 83.33batch/s] 63%|████████████████▉          | 636/1014 [00:07<00:04, 83.28batch/s] 64%|█████████████████▏         | 647/1014 [00:07<00:04, 83.16batch/s] 65%|█████████████████▌         | 658/1014 [00:07<00:04, 83.24batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 83.29batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 83.20batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:03, 83.10batch/s] 69%|██████████████████▋        | 702/1014 [00:08<00:03, 83.11batch/s] 70%|██████████████████▉        | 713/1014 [00:08<00:03, 83.12batch/s] 71%|███████████████████▎       | 724/1014 [00:08<00:03, 83.23batch/s] 72%|███████████████████▌       | 735/1014 [00:08<00:03, 83.23batch/s] 74%|███████████████████▊       | 746/1014 [00:08<00:03, 83.05batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 82.99batch/s] 76%|████████████████████▍      | 768/1014 [00:09<00:02, 82.87batch/s] 77%|████████████████████▋      | 779/1014 [00:09<00:02, 82.89batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 82.94batch/s] 79%|█████████████████████▎     | 801/1014 [00:09<00:02, 82.91batch/s] 80%|█████████████████████▌     | 812/1014 [00:09<00:02, 83.00batch/s] 81%|█████████████████████▉     | 823/1014 [00:09<00:02, 83.14batch/s] 82%|██████████████████████▏    | 834/1014 [00:10<00:02, 83.17batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 83.23batch/s] 84%|██████████████████████▊    | 856/1014 [00:10<00:01, 83.21batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 83.24batch/s] 87%|███████████████████████▍   | 878/1014 [00:10<00:01, 83.29batch/s] 88%|███████████████████████▋   | 889/1014 [00:10<00:01, 83.36batch/s] 89%|███████████████████████▉   | 900/1014 [00:10<00:01, 83.43batch/s] 90%|████████████████████████▎  | 911/1014 [00:10<00:01, 83.39batch/s] 91%|████████████████████████▌  | 922/1014 [00:11<00:01, 83.35batch/s] 92%|████████████████████████▊  | 933/1014 [00:11<00:00, 83.44batch/s] 93%|█████████████████████████▏ | 944/1014 [00:11<00:00, 83.37batch/s] 94%|█████████████████████████▍ | 955/1014 [00:11<00:00, 83.35batch/s] 95%|█████████████████████████▋ | 966/1014 [00:11<00:00, 83.19batch/s] 96%|██████████████████████████ | 977/1014 [00:11<00:00, 83.16batch/s] 97%|██████████████████████████▎| 988/1014 [00:11<00:00, 83.15batch/s] 99%|██████████████████████████▌| 999/1014 [00:12<00:00, 83.15batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 83.11batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 83.12batch/s]
Validation 22 -> LOSS = 1.83
Validation 22 -> BLEU = 28.51, 60.6/35.3/23.2/15.3 (BP=0.966, ratio=0.966, hyp_len=12394, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.83 @ validation 22
--> Best BLEU so far: 28.51 @ validation 22
Starting Epoch 23
Epoch 23 - update      10500 => loss:   1.540 (#OOM: 0)
Epoch 23 - update      10530 => loss:   1.600 (#OOM: 0)
Epoch 23 - update      10560 => loss:   2.436 (#OOM: 0)
Epoch 23 - update      10590 => loss:   1.842 (#OOM: 0)
Epoch 23 - update      10620 => loss:   1.210 (#OOM: 0)
Epoch 23 - update      10650 => loss:   1.262 (#OOM: 0)
Epoch 23 - update      10680 => loss:   1.788 (#OOM: 0)
Epoch 23 - update      10710 => loss:   1.225 (#OOM: 0)
Epoch 23 - update      10740 => loss:   1.415 (#OOM: 0)
Epoch 23 - update      10770 => loss:   1.281 (#OOM: 0)
Epoch 23 - update      10800 => loss:   1.317 (#OOM: 0)
Epoch 23 - update      10830 => loss:   1.268 (#OOM: 0)
Epoch 23 - update      10860 => loss:   1.510 (#OOM: 0)
Epoch 23 - update      10890 => loss:   1.163 (#OOM: 0)
Epoch 23 - update      10920 => loss:   1.501 (#OOM: 0)
Epoch 23 - update      10950 => loss:   1.056 (#OOM: 0)
--> Epoch 23 finished with mean loss 1.64224
--> Overhead/Training/Evaluation: 0.04/0.54/0.00 mins (total: 0.58 mins)   (894 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 41.13batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.11batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 52.64batch/s] 71%|█████████████████████▍        | 25/35 [00:00<00:00, 53.78batch/s] 91%|███████████████████████████▍  | 32/35 [00:00<00:00, 53.53batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.71batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 87.73batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 79.60batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.46batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 75.84batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 77.64batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 78.71batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 77.43batch/s]  7%|█▉                          | 72/1014 [00:00<00:12, 76.31batch/s]  8%|██▏                         | 81/1014 [00:01<00:12, 76.99batch/s]  9%|██▍                         | 90/1014 [00:01<00:12, 76.43batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 77.00batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 77.90batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 79.10batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 79.72batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 80.40batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 80.78batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 80.82batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 80.30batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 80.93batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 80.70batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 81.05batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 81.09batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 81.58batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 81.93batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 82.34batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 81.90batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 81.31batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 81.25batch/s] 27%|███████▍                   | 278/1014 [00:03<00:09, 81.22batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 81.22batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 81.05batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 81.02batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 80.76batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 80.66batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 80.65batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 80.78batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 80.45batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:08, 80.48batch/s] 37%|██████████                 | 378/1014 [00:04<00:07, 80.63batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 80.86batch/s] 39%|██████████▌                | 398/1014 [00:04<00:07, 80.96batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 81.07batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 80.86batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 81.02batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 80.91batch/s] 44%|███████████▉               | 448/1014 [00:05<00:06, 81.24batch/s] 45%|████████████▏              | 458/1014 [00:05<00:06, 80.93batch/s] 46%|████████████▍              | 468/1014 [00:05<00:06, 80.99batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 80.98batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 80.61batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 80.77batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 80.64batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 80.39batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 80.27batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:05, 80.42batch/s] 54%|██████████████▌            | 548/1014 [00:06<00:05, 80.41batch/s] 55%|██████████████▊            | 558/1014 [00:06<00:05, 80.45batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 80.44batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 80.55batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 80.68batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 80.73batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 80.78batch/s] 61%|████████████████▍          | 618/1014 [00:07<00:04, 80.98batch/s] 62%|████████████████▋          | 628/1014 [00:07<00:04, 81.00batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 81.10batch/s] 64%|█████████████████▎         | 648/1014 [00:07<00:04, 81.00batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 81.09batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 81.03batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 81.04batch/s] 68%|██████████████████▎        | 689/1014 [00:08<00:03, 81.31batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 81.25batch/s] 70%|██████████████████▉        | 711/1014 [00:08<00:03, 81.13batch/s] 71%|███████████████████▏       | 722/1014 [00:08<00:03, 81.07batch/s] 72%|███████████████████▌       | 733/1014 [00:09<00:03, 80.93batch/s] 73%|███████████████████▊       | 744/1014 [00:09<00:03, 80.81batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 80.85batch/s] 76%|████████████████████▍      | 766/1014 [00:09<00:03, 80.68batch/s] 77%|████████████████████▋      | 777/1014 [00:09<00:02, 80.82batch/s] 78%|████████████████████▉      | 788/1014 [00:09<00:02, 80.84batch/s] 79%|█████████████████████▎     | 799/1014 [00:09<00:02, 80.86batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 80.84batch/s] 81%|█████████████████████▊     | 821/1014 [00:10<00:02, 80.74batch/s] 82%|██████████████████████▏    | 832/1014 [00:10<00:02, 80.76batch/s] 83%|██████████████████████▍    | 843/1014 [00:10<00:02, 80.78batch/s] 84%|██████████████████████▋    | 854/1014 [00:10<00:01, 80.71batch/s] 85%|███████████████████████    | 865/1014 [00:10<00:01, 80.64batch/s] 86%|███████████████████████▎   | 876/1014 [00:10<00:01, 80.53batch/s] 87%|███████████████████████▌   | 887/1014 [00:10<00:01, 80.65batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 80.62batch/s] 90%|████████████████████████▏  | 909/1014 [00:11<00:01, 80.60batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 80.63batch/s] 92%|████████████████████████▊  | 931/1014 [00:11<00:01, 80.75batch/s] 93%|█████████████████████████  | 942/1014 [00:11<00:00, 80.75batch/s] 94%|█████████████████████████▍ | 953/1014 [00:11<00:00, 80.87batch/s] 95%|█████████████████████████▋ | 964/1014 [00:11<00:00, 80.84batch/s] 96%|█████████████████████████▉ | 975/1014 [00:12<00:00, 80.87batch/s] 97%|██████████████████████████▎| 986/1014 [00:12<00:00, 80.73batch/s] 98%|██████████████████████████▌| 997/1014 [00:12<00:00, 80.74batch/s] 99%|█████████████████████████▊| 1008/1014 [00:12<00:00, 80.79batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.68batch/s]
Validation 23 -> LOSS = 1.83
Validation 23 -> BLEU = 28.53, 59.5/34.5/22.4/14.7 (BP=0.994, ratio=0.994, hyp_len=12756, ref_len=12828)
Saving best model based on BLEU
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.83 @ validation 22
--> Best BLEU so far: 28.53 @ validation 23
Starting Epoch 24
Epoch 24 - update      10980 => loss:   1.662 (#OOM: 0)
Epoch 24 - update      11010 => loss:   1.616 (#OOM: 0)
Epoch 24 - update      11040 => loss:   1.632 (#OOM: 0)
Epoch 24 - update      11070 => loss:   1.232 (#OOM: 0)
Epoch 24 - update      11100 => loss:   2.057 (#OOM: 0)
Epoch 24 - update      11130 => loss:   1.271 (#OOM: 0)
Epoch 24 - update      11160 => loss:   1.488 (#OOM: 0)
Epoch 24 - update      11190 => loss:   1.256 (#OOM: 0)
Epoch 24 - update      11220 => loss:   1.252 (#OOM: 0)
Epoch 24 - update      11250 => loss:   1.555 (#OOM: 0)
Epoch 24 - update      11280 => loss:   0.968 (#OOM: 0)
Epoch 24 - update      11310 => loss:   1.558 (#OOM: 0)
Epoch 24 - update      11340 => loss:   2.073 (#OOM: 0)
Epoch 24 - update      11370 => loss:   1.938 (#OOM: 0)
Epoch 24 - update      11400 => loss:   1.850 (#OOM: 0)
Epoch 24 - update      11430 => loss:   1.878 (#OOM: 0)
--> Epoch 24 finished with mean loss 1.62455
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.59 mins)   (866 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.43batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.36batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 51.03batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 51.90batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 53.80batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.64batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 81.77batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 82.93batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.39batch/s]  4%|█                           | 37/1014 [00:00<00:11, 82.02batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 81.84batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 80.60batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 82.64batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 82.06batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 81.12batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 81.53batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 80.78batch/s] 12%|███                        | 117/1014 [00:01<00:11, 80.91batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 81.68batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 82.47batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 81.96batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 82.55batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 82.14batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 82.19batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 82.19batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 81.66batch/s] 20%|█████▌                     | 207/1014 [00:02<00:09, 81.84batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 81.65batch/s] 22%|██████                     | 227/1014 [00:02<00:09, 81.41batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 80.95batch/s] 24%|██████▌                    | 247/1014 [00:03<00:09, 81.10batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 81.15batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 81.34batch/s] 27%|███████▍                   | 277/1014 [00:03<00:09, 81.20batch/s] 28%|███████▋                   | 287/1014 [00:03<00:08, 81.33batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 81.61batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 82.20batch/s] 31%|████████▍                  | 319/1014 [00:03<00:08, 82.12batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 82.25batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 82.22batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 82.51batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:07, 82.45batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 82.57batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 82.59batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 82.67batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 82.81batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 82.74batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 82.68batch/s] 43%|███████████▋               | 440/1014 [00:05<00:06, 82.58batch/s] 44%|████████████               | 451/1014 [00:05<00:06, 82.28batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 82.06batch/s] 47%|████████████▌              | 473/1014 [00:05<00:06, 81.84batch/s] 48%|████████████▉              | 484/1014 [00:05<00:06, 81.99batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 82.30batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 82.35batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 82.38batch/s] 52%|██████████████             | 528/1014 [00:06<00:05, 82.47batch/s] 53%|██████████████▎            | 539/1014 [00:06<00:05, 82.54batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 82.47batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:05, 82.52batch/s] 56%|███████████████▏           | 572/1014 [00:06<00:05, 82.66batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 82.79batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 82.87batch/s] 60%|████████████████           | 605/1014 [00:07<00:04, 82.96batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 83.06batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 83.12batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 83.15batch/s] 64%|█████████████████▎         | 649/1014 [00:07<00:04, 83.06batch/s] 65%|█████████████████▌         | 660/1014 [00:07<00:04, 83.08batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 83.10batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 82.99batch/s] 68%|██████████████████▍        | 693/1014 [00:08<00:03, 82.97batch/s] 69%|██████████████████▋        | 704/1014 [00:08<00:03, 82.64batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 82.55batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 82.47batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 82.41batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 82.57batch/s] 75%|████████████████████▏      | 759/1014 [00:09<00:03, 82.56batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:02, 82.60batch/s] 77%|████████████████████▊      | 781/1014 [00:09<00:02, 82.46batch/s] 78%|█████████████████████      | 792/1014 [00:09<00:02, 82.41batch/s] 79%|█████████████████████▍     | 803/1014 [00:09<00:02, 82.33batch/s] 80%|█████████████████████▋     | 814/1014 [00:09<00:02, 82.44batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 82.40batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 82.48batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 82.44batch/s] 85%|██████████████████████▊    | 858/1014 [00:10<00:01, 82.38batch/s] 86%|███████████████████████▏   | 869/1014 [00:10<00:01, 82.24batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 82.43batch/s] 88%|███████████████████████▋   | 891/1014 [00:10<00:01, 82.52batch/s] 89%|████████████████████████   | 902/1014 [00:10<00:01, 82.45batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 82.40batch/s] 91%|████████████████████████▌  | 924/1014 [00:11<00:01, 82.33batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 82.31batch/s] 93%|█████████████████████████▏ | 946/1014 [00:11<00:00, 82.13batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 82.05batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 82.08batch/s] 97%|██████████████████████████ | 979/1014 [00:11<00:00, 82.25batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 82.13batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 82.13batch/s]100%|█████████████████████████▉| 1012/1014 [00:12<00:00, 82.16batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.14batch/s]
Validation 24 -> LOSS = 1.83
Validation 24 -> BLEU = 28.48, 59.7/34.8/22.7/15.1 (BP=0.981, ratio=0.981, hyp_len=12584, ref_len=12828)
Saving best model based on LOSS
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.83 @ validation 24
--> Best BLEU so far: 28.53 @ validation 23
Starting Epoch 25
Epoch 25 - update      11460 => loss:   1.171 (#OOM: 0)
Epoch 25 - update      11490 => loss:   1.975 (#OOM: 0)
Epoch 25 - update      11520 => loss:   1.276 (#OOM: 0)
Epoch 25 - update      11550 => loss:   1.450 (#OOM: 0)
Epoch 25 - update      11580 => loss:   1.704 (#OOM: 0)
Epoch 25 - update      11610 => loss:   1.241 (#OOM: 0)
Epoch 25 - update      11640 => loss:   1.362 (#OOM: 0)
Epoch 25 - update      11670 => loss:   1.622 (#OOM: 0)
Epoch 25 - update      11700 => loss:   1.340 (#OOM: 0)
Epoch 25 - update      11730 => loss:   1.176 (#OOM: 0)
Epoch 25 - update      11760 => loss:   1.359 (#OOM: 0)
Epoch 25 - update      11790 => loss:   1.447 (#OOM: 0)
Epoch 25 - update      11820 => loss:   1.851 (#OOM: 0)
Epoch 25 - update      11850 => loss:   2.168 (#OOM: 0)
Epoch 25 - update      11880 => loss:   1.580 (#OOM: 0)
Epoch 25 - update      11910 => loss:   0.957 (#OOM: 0)
--> Epoch 25 finished with mean loss 1.60445
--> Overhead/Training/Evaluation: 0.03/0.51/0.00 mins (total: 0.54 mins)   (945 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 47.08batch/s] 29%|████████▌                     | 10/35 [00:00<00:00, 46.77batch/s] 46%|█████████████▋                | 16/35 [00:00<00:00, 49.85batch/s] 63%|██████████████████▊           | 22/35 [00:00<00:00, 49.40batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 49.55batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 52.91batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 75.72batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.42batch/s]  3%|▋                           | 26/1014 [00:00<00:12, 78.21batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 79.33batch/s]  4%|█▏                          | 44/1014 [00:00<00:11, 81.04batch/s]  5%|█▍                          | 53/1014 [00:00<00:11, 81.76batch/s]  6%|█▋                          | 62/1014 [00:00<00:11, 81.08batch/s]  7%|█▉                          | 71/1014 [00:00<00:11, 81.79batch/s]  8%|██▏                         | 80/1014 [00:00<00:11, 82.57batch/s]  9%|██▍                         | 89/1014 [00:01<00:11, 82.65batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 83.17batch/s] 11%|██▊                        | 107/1014 [00:01<00:10, 82.92batch/s] 12%|███                        | 117/1014 [00:01<00:10, 83.60batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 83.38batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 83.62batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 83.76batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 83.36batch/s] 16%|████▍                      | 167/1014 [00:01<00:10, 83.64batch/s] 17%|████▋                      | 177/1014 [00:02<00:09, 83.95batch/s] 18%|████▉                      | 187/1014 [00:02<00:09, 83.74batch/s] 19%|█████▏                     | 197/1014 [00:02<00:09, 83.74batch/s] 20%|█████▌                     | 207/1014 [00:02<00:09, 83.90batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 83.86batch/s] 22%|██████                     | 227/1014 [00:02<00:09, 83.76batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 83.93batch/s] 24%|██████▌                    | 247/1014 [00:02<00:09, 83.84batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 84.08batch/s] 26%|███████                    | 267/1014 [00:03<00:08, 83.54batch/s] 27%|███████▍                   | 277/1014 [00:03<00:08, 83.24batch/s] 28%|███████▋                   | 287/1014 [00:03<00:08, 82.76batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 82.93batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 82.93batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 83.08batch/s] 32%|████████▋                  | 327/1014 [00:03<00:08, 82.93batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 82.94batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 83.01batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:07, 83.26batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:07, 83.51batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 83.38batch/s] 38%|██████████▎                | 387/1014 [00:04<00:07, 83.26batch/s] 39%|██████████▌                | 397/1014 [00:04<00:07, 82.91batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 82.78batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 82.56batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 82.84batch/s] 43%|███████████▋               | 437/1014 [00:05<00:06, 82.87batch/s] 44%|███████████▉               | 447/1014 [00:05<00:06, 82.92batch/s] 45%|████████████▏              | 457/1014 [00:05<00:06, 82.69batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 82.66batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 82.72batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 82.35batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 82.42batch/s] 50%|█████████████▌             | 507/1014 [00:06<00:06, 82.31batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 82.18batch/s] 52%|██████████████             | 527/1014 [00:06<00:05, 82.08batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 82.08batch/s] 54%|██████████████▌            | 547/1014 [00:06<00:05, 82.26batch/s] 55%|██████████████▊            | 557/1014 [00:06<00:05, 82.21batch/s] 56%|███████████████            | 567/1014 [00:06<00:05, 82.21batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 82.21batch/s] 58%|███████████████▋           | 587/1014 [00:07<00:05, 82.22batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 82.21batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:04, 82.14batch/s] 61%|████████████████▍          | 617/1014 [00:07<00:04, 82.18batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 82.22batch/s] 63%|████████████████▉          | 637/1014 [00:07<00:04, 82.21batch/s] 64%|█████████████████▏         | 647/1014 [00:07<00:04, 82.20batch/s] 65%|█████████████████▍         | 657/1014 [00:07<00:04, 82.19batch/s] 66%|█████████████████▊         | 667/1014 [00:08<00:04, 82.29batch/s] 67%|██████████████████         | 677/1014 [00:08<00:04, 82.42batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:03, 82.35batch/s] 69%|██████████████████▌        | 697/1014 [00:08<00:03, 82.41batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 82.38batch/s] 71%|███████████████████        | 717/1014 [00:08<00:03, 82.41batch/s] 72%|███████████████████▎       | 727/1014 [00:08<00:03, 82.38batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 82.37batch/s] 74%|███████████████████▉       | 747/1014 [00:09<00:03, 82.35batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 82.01batch/s] 76%|████████████████████▍      | 767/1014 [00:09<00:03, 82.00batch/s] 77%|████████████████████▋      | 777/1014 [00:09<00:02, 82.04batch/s] 78%|████████████████████▉      | 787/1014 [00:09<00:02, 81.94batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 81.95batch/s] 80%|█████████████████████▍     | 807/1014 [00:09<00:02, 81.76batch/s] 81%|█████████████████████▊     | 817/1014 [00:09<00:02, 81.75batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 81.54batch/s] 83%|██████████████████████▎    | 837/1014 [00:10<00:02, 81.58batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 81.54batch/s] 85%|██████████████████████▊    | 857/1014 [00:10<00:01, 81.54batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 81.38batch/s] 86%|███████████████████████▎   | 877/1014 [00:10<00:01, 81.20batch/s] 87%|███████████████████████▌   | 887/1014 [00:10<00:01, 81.17batch/s] 88%|███████████████████████▉   | 897/1014 [00:11<00:01, 81.14batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 81.17batch/s] 90%|████████████████████████▍  | 917/1014 [00:11<00:01, 81.08batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 80.97batch/s] 92%|████████████████████████▉  | 937/1014 [00:11<00:00, 80.92batch/s] 93%|█████████████████████████▏ | 947/1014 [00:11<00:00, 80.74batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 80.81batch/s] 95%|█████████████████████████▋ | 967/1014 [00:11<00:00, 80.75batch/s] 96%|██████████████████████████ | 977/1014 [00:12<00:00, 80.78batch/s] 97%|██████████████████████████▎| 987/1014 [00:12<00:00, 80.80batch/s] 98%|██████████████████████████▌| 997/1014 [00:12<00:00, 80.77batch/s] 99%|█████████████████████████▊| 1007/1014 [00:12<00:00, 80.81batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.81batch/s]
Validation 25 -> LOSS = 1.82
Validation 25 -> BLEU = 28.50, 59.5/34.6/22.5/14.7 (BP=0.991, ratio=0.991, hyp_len=12718, ref_len=12828)
Saving best model based on LOSS
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.82 @ validation 25
--> Best BLEU so far: 28.53 @ validation 23
Starting Epoch 26
Epoch 26 - update      11940 => loss:   1.841 (#OOM: 0)
Epoch 26 - update      11970 => loss:   1.258 (#OOM: 0)
Epoch 26 - update      12000 => loss:   1.183 (#OOM: 0)
Epoch 26 - update      12030 => loss:   1.605 (#OOM: 0)
Epoch 26 - update      12060 => loss:   1.934 (#OOM: 0)
Epoch 26 - update      12090 => loss:   1.727 (#OOM: 0)
Epoch 26 - update      12120 => loss:   1.201 (#OOM: 0)
Epoch 26 - update      12150 => loss:   1.199 (#OOM: 0)
Epoch 26 - update      12180 => loss:   1.786 (#OOM: 0)
Epoch 26 - update      12210 => loss:   1.826 (#OOM: 0)
Epoch 26 - update      12240 => loss:   1.649 (#OOM: 0)
Epoch 26 - update      12270 => loss:   1.354 (#OOM: 0)
Epoch 26 - update      12300 => loss:   1.300 (#OOM: 0)
Epoch 26 - update      12330 => loss:   1.532 (#OOM: 0)
Epoch 26 - update      12360 => loss:   1.226 (#OOM: 0)
Epoch 26 - update      12390 => loss:   1.647 (#OOM: 0)
--> Epoch 26 finished with mean loss 1.59124
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (818 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.45batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.07batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.73batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.20batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 53.96batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.72batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.98batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 76.75batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 80.05batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 80.38batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 80.34batch/s]  5%|█▍                          | 54/1014 [00:00<00:12, 79.04batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 78.39batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 79.56batch/s]  8%|██▏                         | 81/1014 [00:01<00:11, 78.58batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 78.69batch/s] 10%|██▋                        | 100/1014 [00:01<00:11, 79.99batch/s] 11%|██▉                        | 110/1014 [00:01<00:11, 79.98batch/s] 12%|███▏                       | 120/1014 [00:01<00:11, 80.63batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 80.44batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 79.78batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 79.91batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 80.28batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 80.36batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 80.24batch/s] 19%|█████                      | 190/1014 [00:02<00:10, 80.87batch/s] 20%|█████▎                     | 200/1014 [00:02<00:10, 81.12batch/s] 21%|█████▌                     | 210/1014 [00:02<00:09, 81.40batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 81.83batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 81.71batch/s] 24%|██████▍                    | 240/1014 [00:02<00:09, 82.22batch/s] 25%|██████▋                    | 250/1014 [00:03<00:09, 81.73batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 81.71batch/s] 27%|███████▏                   | 270/1014 [00:03<00:09, 81.60batch/s] 28%|███████▍                   | 280/1014 [00:03<00:08, 81.68batch/s] 29%|███████▋                   | 290/1014 [00:03<00:08, 81.42batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 81.49batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 81.39batch/s] 32%|████████▌                  | 320/1014 [00:03<00:08, 81.50batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 81.38batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 81.52batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 81.65batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:07, 81.81batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:07, 81.89batch/s] 37%|██████████                 | 380/1014 [00:04<00:07, 81.97batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 82.12batch/s] 39%|██████████▋                | 400/1014 [00:04<00:07, 82.30batch/s] 40%|██████████▉                | 410/1014 [00:04<00:07, 82.17batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 82.13batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 82.08batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 81.86batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 82.00batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 81.86batch/s] 46%|████████████▌              | 470/1014 [00:05<00:06, 81.80batch/s] 47%|████████████▊              | 480/1014 [00:05<00:06, 81.89batch/s] 48%|█████████████              | 490/1014 [00:05<00:06, 82.10batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 82.05batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 81.94batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 81.91batch/s] 52%|██████████████             | 530/1014 [00:06<00:05, 82.02batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:05, 81.86batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 81.80batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 81.80batch/s] 56%|███████████████▏           | 570/1014 [00:06<00:05, 81.97batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 82.02batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 81.87batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 81.72batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 81.79batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 81.88batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 81.79batch/s] 63%|█████████████████          | 640/1014 [00:07<00:04, 81.83batch/s] 64%|█████████████████▎         | 650/1014 [00:07<00:04, 81.74batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 81.65batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 81.70batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 81.43batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:03, 81.44batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 81.45batch/s] 70%|██████████████████▉        | 710/1014 [00:08<00:03, 81.52batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 81.52batch/s] 72%|███████████████████▍       | 730/1014 [00:08<00:03, 81.51batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 81.58batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 81.60batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 81.54batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:02, 81.63batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 81.58batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 81.71batch/s] 79%|█████████████████████▎     | 800/1014 [00:09<00:02, 81.79batch/s] 80%|█████████████████████▌     | 810/1014 [00:09<00:02, 81.75batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 81.68batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 81.61batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 81.57batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 81.53batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 81.69batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 81.76batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 81.74batch/s] 88%|███████████████████████▋   | 890/1014 [00:10<00:01, 81.69batch/s] 89%|███████████████████████▉   | 900/1014 [00:11<00:01, 81.71batch/s] 90%|████████████████████████▏  | 910/1014 [00:11<00:01, 81.86batch/s] 91%|████████████████████████▍  | 920/1014 [00:11<00:01, 81.88batch/s] 92%|████████████████████████▊  | 930/1014 [00:11<00:01, 81.90batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 81.97batch/s] 94%|█████████████████████████▎ | 950/1014 [00:11<00:00, 82.02batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 81.94batch/s] 96%|█████████████████████████▊ | 970/1014 [00:11<00:00, 81.87batch/s] 97%|██████████████████████████ | 980/1014 [00:11<00:00, 81.88batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 81.93batch/s] 99%|█████████████████████████▋| 1000/1014 [00:12<00:00, 81.99batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 82.00batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.95batch/s]
Validation 26 -> LOSS = 1.82
Validation 26 -> BLEU = 28.52, 59.6/34.8/22.7/15.1 (BP=0.982, ratio=0.982, hyp_len=12602, ref_len=12828)
** Learning rate changed -> 0.0001
Saving best model based on LOSS
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.82 @ validation 26
--> Best BLEU so far: 28.53 @ validation 23
Starting Epoch 27
Epoch 27 - update      12420 => loss:   1.195 (#OOM: 0)
Epoch 27 - update      12450 => loss:   1.563 (#OOM: 0)
Epoch 27 - update      12480 => loss:   1.629 (#OOM: 0)
Epoch 27 - update      12510 => loss:   1.624 (#OOM: 0)
Epoch 27 - update      12540 => loss:   1.441 (#OOM: 0)
Epoch 27 - update      12570 => loss:   1.364 (#OOM: 0)
Epoch 27 - update      12600 => loss:   1.806 (#OOM: 0)
Epoch 27 - update      12630 => loss:   0.919 (#OOM: 0)
Epoch 27 - update      12660 => loss:   1.063 (#OOM: 0)
Epoch 27 - update      12690 => loss:   1.667 (#OOM: 0)
Epoch 27 - update      12720 => loss:   1.305 (#OOM: 0)
Epoch 27 - update      12750 => loss:   1.907 (#OOM: 0)
Epoch 27 - update      12780 => loss:   1.339 (#OOM: 0)
Epoch 27 - update      12810 => loss:   2.302 (#OOM: 0)
Epoch 27 - update      12840 => loss:   1.663 (#OOM: 0)
Epoch 27 - update      12870 => loss:   1.332 (#OOM: 0)
--> Epoch 27 finished with mean loss 1.55618
--> Overhead/Training/Evaluation: 0.04/0.58/0.00 mins (total: 0.62 mins)   (829 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.03batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 49.24batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 52.51batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 51.83batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 51.48batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.66batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:14, 67.86batch/s]  1%|▍                           | 15/1014 [00:00<00:13, 73.13batch/s]  2%|▋                           | 24/1014 [00:00<00:12, 77.38batch/s]  3%|▉                           | 33/1014 [00:00<00:12, 76.10batch/s]  4%|█▏                          | 43/1014 [00:00<00:12, 78.88batch/s]  5%|█▍                          | 53/1014 [00:00<00:12, 79.82batch/s]  6%|█▋                          | 63/1014 [00:00<00:12, 76.49batch/s]  7%|██                          | 73/1014 [00:00<00:12, 77.50batch/s]  8%|██▎                         | 83/1014 [00:01<00:11, 79.11batch/s]  9%|██▌                         | 93/1014 [00:01<00:11, 80.73batch/s] 10%|██▋                        | 103/1014 [00:01<00:11, 80.85batch/s] 11%|███                        | 113/1014 [00:01<00:11, 80.84batch/s] 12%|███▎                       | 123/1014 [00:01<00:11, 80.60batch/s] 13%|███▌                       | 133/1014 [00:01<00:10, 80.45batch/s] 14%|███▊                       | 143/1014 [00:01<00:10, 81.01batch/s] 15%|████                       | 154/1014 [00:01<00:10, 81.96batch/s] 16%|████▍                      | 165/1014 [00:02<00:10, 82.32batch/s] 17%|████▋                      | 176/1014 [00:02<00:10, 82.49batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 82.27batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 82.37batch/s] 21%|█████▌                     | 209/1014 [00:02<00:09, 82.30batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 82.82batch/s] 23%|██████▏                    | 231/1014 [00:02<00:09, 82.57batch/s] 24%|██████▍                    | 242/1014 [00:02<00:09, 82.44batch/s] 25%|██████▋                    | 253/1014 [00:03<00:09, 82.17batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 81.96batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 81.88batch/s] 28%|███████▌                   | 286/1014 [00:03<00:08, 81.57batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 81.57batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 81.62batch/s] 31%|████████▍                  | 319/1014 [00:03<00:08, 81.58batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 81.22batch/s] 34%|█████████                  | 341/1014 [00:04<00:08, 80.81batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:08, 80.86batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:08, 81.04batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 80.74batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 80.80batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 81.11batch/s] 40%|██████████▊                | 407/1014 [00:05<00:07, 80.99batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 80.77batch/s] 42%|███████████▍               | 429/1014 [00:05<00:07, 80.38batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 80.46batch/s] 44%|████████████               | 451/1014 [00:05<00:06, 80.68batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 80.53batch/s] 47%|████████████▌              | 473/1014 [00:05<00:06, 80.71batch/s] 48%|████████████▉              | 484/1014 [00:05<00:06, 80.80batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 81.05batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 81.07batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:06, 81.00batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 80.98batch/s] 53%|██████████████▎            | 539/1014 [00:06<00:05, 80.86batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 80.77batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:05, 80.63batch/s] 56%|███████████████▏           | 572/1014 [00:07<00:05, 80.57batch/s] 57%|███████████████▌           | 583/1014 [00:07<00:05, 80.34batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 80.41batch/s] 60%|████████████████           | 605/1014 [00:07<00:05, 80.41batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 80.38batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 80.32batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 80.20batch/s] 64%|█████████████████▎         | 649/1014 [00:08<00:04, 80.12batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 80.13batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 80.24batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:04, 80.31batch/s] 68%|██████████████████▍        | 693/1014 [00:08<00:03, 80.39batch/s] 69%|██████████████████▋        | 704/1014 [00:08<00:03, 80.47batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 80.53batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 80.70batch/s] 73%|███████████████████▌       | 737/1014 [00:09<00:03, 80.70batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 80.73batch/s] 75%|████████████████████▏      | 759/1014 [00:09<00:03, 80.57batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:03, 80.67batch/s] 77%|████████████████████▊      | 781/1014 [00:09<00:02, 80.80batch/s] 78%|█████████████████████      | 792/1014 [00:09<00:02, 80.61batch/s] 79%|█████████████████████▍     | 803/1014 [00:09<00:02, 80.76batch/s] 80%|█████████████████████▋     | 814/1014 [00:10<00:02, 80.91batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 80.73batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 80.71batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 80.79batch/s] 85%|██████████████████████▊    | 858/1014 [00:10<00:01, 80.93batch/s] 86%|███████████████████████▏   | 869/1014 [00:10<00:01, 80.98batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 80.93batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 80.91batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 80.91batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 80.86batch/s] 91%|████████████████████████▌  | 924/1014 [00:11<00:01, 80.84batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 80.87batch/s] 93%|█████████████████████████▏ | 946/1014 [00:11<00:00, 80.95batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 80.92batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 80.92batch/s] 97%|██████████████████████████ | 979/1014 [00:12<00:00, 80.89batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 81.01batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 80.95batch/s]100%|█████████████████████████▉| 1012/1014 [00:12<00:00, 81.03batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.00batch/s]
Validation 27 -> LOSS = 1.81
Validation 27 -> BLEU = 28.74, 59.5/34.5/22.6/15.0 (BP=0.994, ratio=0.994, hyp_len=12745, ref_len=12828)
Saving best model based on BLEU
Saving best model based on LOSS
Early stopping patience: 10
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 28
Epoch 28 - update      12900 => loss:   1.114 (#OOM: 0)
Epoch 28 - update      12930 => loss:   2.264 (#OOM: 0)
Epoch 28 - update      12960 => loss:   0.927 (#OOM: 0)
Epoch 28 - update      12990 => loss:   1.725 (#OOM: 0)
Epoch 28 - update      13020 => loss:   1.736 (#OOM: 0)
Epoch 28 - update      13050 => loss:   1.667 (#OOM: 0)
Epoch 28 - update      13080 => loss:   1.274 (#OOM: 0)
Epoch 28 - update      13110 => loss:   1.139 (#OOM: 0)
Epoch 28 - update      13140 => loss:   1.296 (#OOM: 0)
Epoch 28 - update      13170 => loss:   1.769 (#OOM: 0)
Epoch 28 - update      13200 => loss:   1.380 (#OOM: 0)
Epoch 28 - update      13230 => loss:   1.295 (#OOM: 0)
Epoch 28 - update      13260 => loss:   0.991 (#OOM: 0)
Epoch 28 - update      13290 => loss:   1.501 (#OOM: 0)
Epoch 28 - update      13320 => loss:   1.464 (#OOM: 0)
Epoch 28 - update      13350 => loss:   1.463 (#OOM: 0)
--> Epoch 28 finished with mean loss 1.54467
--> Overhead/Training/Evaluation: 0.04/0.61/0.00 mins (total: 0.66 mins)   (789 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 43.62batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.62batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.67batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 53.21batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 54.39batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.41batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                          | 11/1014 [00:00<00:09, 102.99batch/s]  2%|▌                           | 22/1014 [00:00<00:10, 93.64batch/s]  3%|▉                           | 33/1014 [00:00<00:10, 92.00batch/s]  4%|█▏                          | 44/1014 [00:00<00:10, 88.86batch/s]  5%|█▌                          | 55/1014 [00:00<00:10, 89.35batch/s]  7%|█▊                          | 66/1014 [00:00<00:10, 89.38batch/s]  8%|██▏                         | 77/1014 [00:00<00:10, 88.44batch/s]  9%|██▍                         | 88/1014 [00:00<00:10, 89.46batch/s] 10%|██▋                         | 99/1014 [00:01<00:10, 88.87batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 88.94batch/s] 12%|███▏                       | 121/1014 [00:01<00:10, 89.07batch/s] 13%|███▌                       | 132/1014 [00:01<00:09, 88.57batch/s] 14%|███▊                       | 143/1014 [00:01<00:09, 87.24batch/s] 15%|████                       | 154/1014 [00:01<00:09, 87.15batch/s] 16%|████▍                      | 165/1014 [00:01<00:09, 87.20batch/s] 17%|████▋                      | 176/1014 [00:02<00:09, 86.73batch/s] 18%|████▉                      | 187/1014 [00:02<00:09, 86.51batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 86.91batch/s] 21%|█████▌                     | 209/1014 [00:02<00:09, 85.65batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 85.66batch/s] 23%|██████▏                    | 231/1014 [00:02<00:09, 85.98batch/s] 24%|██████▍                    | 242/1014 [00:02<00:08, 86.14batch/s] 25%|██████▋                    | 253/1014 [00:02<00:08, 86.00batch/s] 26%|███████                    | 264/1014 [00:03<00:08, 85.92batch/s] 27%|███████▎                   | 275/1014 [00:03<00:08, 85.67batch/s] 28%|███████▌                   | 286/1014 [00:03<00:08, 85.76batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 85.46batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 85.56batch/s] 31%|████████▍                  | 319/1014 [00:03<00:08, 85.55batch/s] 33%|████████▊                  | 330/1014 [00:03<00:08, 85.37batch/s] 34%|█████████                  | 341/1014 [00:04<00:07, 84.76batch/s] 35%|█████████▎                 | 352/1014 [00:04<00:07, 84.89batch/s] 36%|█████████▋                 | 363/1014 [00:04<00:07, 84.65batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 84.40batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 84.22batch/s] 39%|██████████▌                | 396/1014 [00:04<00:07, 84.53batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 84.59batch/s] 41%|███████████▏               | 418/1014 [00:04<00:07, 84.58batch/s] 42%|███████████▍               | 429/1014 [00:05<00:06, 84.68batch/s] 43%|███████████▋               | 440/1014 [00:05<00:06, 84.47batch/s] 44%|████████████               | 451/1014 [00:05<00:06, 84.54batch/s] 46%|████████████▎              | 462/1014 [00:05<00:06, 84.52batch/s] 47%|████████████▌              | 473/1014 [00:05<00:06, 84.32batch/s] 48%|████████████▉              | 484/1014 [00:05<00:06, 84.15batch/s] 49%|█████████████▏             | 495/1014 [00:05<00:06, 83.80batch/s] 50%|█████████████▍             | 506/1014 [00:06<00:06, 83.84batch/s] 51%|█████████████▊             | 517/1014 [00:06<00:05, 83.84batch/s] 52%|██████████████             | 528/1014 [00:06<00:05, 83.90batch/s] 53%|██████████████▎            | 539/1014 [00:06<00:05, 84.10batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 84.33batch/s] 55%|██████████████▉            | 561/1014 [00:06<00:05, 84.28batch/s] 56%|███████████████▏           | 572/1014 [00:06<00:05, 83.96batch/s] 57%|███████████████▌           | 583/1014 [00:06<00:05, 83.90batch/s] 59%|███████████████▊           | 594/1014 [00:07<00:05, 83.75batch/s] 60%|████████████████           | 605/1014 [00:07<00:04, 83.83batch/s] 61%|████████████████▍          | 616/1014 [00:07<00:04, 83.81batch/s] 62%|████████████████▋          | 627/1014 [00:07<00:04, 83.80batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 83.77batch/s] 64%|█████████████████▎         | 649/1014 [00:07<00:04, 83.70batch/s] 65%|█████████████████▌         | 660/1014 [00:07<00:04, 83.77batch/s] 66%|█████████████████▊         | 671/1014 [00:08<00:04, 83.81batch/s] 67%|██████████████████▏        | 682/1014 [00:08<00:03, 83.56batch/s] 68%|██████████████████▍        | 693/1014 [00:08<00:03, 83.66batch/s] 69%|██████████████████▋        | 704/1014 [00:08<00:03, 83.51batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 83.48batch/s] 72%|███████████████████▎       | 726/1014 [00:08<00:03, 83.53batch/s] 73%|███████████████████▌       | 737/1014 [00:08<00:03, 83.38batch/s] 74%|███████████████████▉       | 748/1014 [00:08<00:03, 83.34batch/s] 75%|████████████████████▏      | 759/1014 [00:09<00:03, 83.51batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:02, 83.45batch/s] 77%|████████████████████▊      | 781/1014 [00:09<00:02, 83.33batch/s] 78%|█████████████████████      | 792/1014 [00:09<00:02, 83.15batch/s] 79%|█████████████████████▍     | 803/1014 [00:09<00:02, 83.02batch/s] 80%|█████████████████████▋     | 814/1014 [00:09<00:02, 83.01batch/s] 81%|█████████████████████▉     | 825/1014 [00:09<00:02, 82.96batch/s] 82%|██████████████████████▎    | 836/1014 [00:10<00:02, 83.03batch/s] 84%|██████████████████████▌    | 847/1014 [00:10<00:02, 82.89batch/s] 85%|██████████████████████▊    | 858/1014 [00:10<00:01, 82.85batch/s] 86%|███████████████████████▏   | 869/1014 [00:10<00:01, 82.83batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 82.89batch/s] 88%|███████████████████████▋   | 891/1014 [00:10<00:01, 82.83batch/s] 89%|████████████████████████   | 902/1014 [00:10<00:01, 82.73batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 82.72batch/s] 91%|████████████████████████▌  | 924/1014 [00:11<00:01, 82.68batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 82.64batch/s] 93%|█████████████████████████▏ | 946/1014 [00:11<00:00, 82.48batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 82.38batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 82.26batch/s] 97%|██████████████████████████ | 979/1014 [00:11<00:00, 82.15batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 82.22batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 82.15batch/s]100%|█████████████████████████▉| 1012/1014 [00:12<00:00, 82.20batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.19batch/s]
Validation 28 -> LOSS = 1.81
Validation 28 -> BLEU = 28.40, 59.9/34.6/22.6/14.9 (BP=0.982, ratio=0.982, hyp_len=12603, ref_len=12828)
Early stopping patience: 9
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 29
Epoch 29 - update      13380 => loss:   1.462 (#OOM: 0)
Epoch 29 - update      13410 => loss:   1.355 (#OOM: 0)
Epoch 29 - update      13440 => loss:   1.542 (#OOM: 0)
Epoch 29 - update      13470 => loss:   1.249 (#OOM: 0)
Epoch 29 - update      13500 => loss:   1.313 (#OOM: 0)
Epoch 29 - update      13530 => loss:   1.993 (#OOM: 0)
Epoch 29 - update      13560 => loss:   1.242 (#OOM: 0)
Epoch 29 - update      13590 => loss:   1.576 (#OOM: 0)
Epoch 29 - update      13620 => loss:   1.867 (#OOM: 0)
Epoch 29 - update      13650 => loss:   2.068 (#OOM: 0)
Epoch 29 - update      13680 => loss:   1.267 (#OOM: 0)
Epoch 29 - update      13710 => loss:   1.430 (#OOM: 0)
Epoch 29 - update      13740 => loss:   1.576 (#OOM: 0)
Epoch 29 - update      13770 => loss:   1.325 (#OOM: 0)
Epoch 29 - update      13800 => loss:   1.278 (#OOM: 0)
Epoch 29 - update      13830 => loss:   1.243 (#OOM: 0)
--> Epoch 29 finished with mean loss 1.53335
--> Overhead/Training/Evaluation: 0.04/0.54/0.00 mins (total: 0.58 mins)   (892 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 58.27batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 53.00batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 54.44batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.43batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 55.85batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.84batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 78.14batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 77.96batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.20batch/s]  4%|▉                           | 36/1014 [00:00<00:12, 79.89batch/s]  4%|█▏                          | 45/1014 [00:00<00:12, 78.35batch/s]  5%|█▌                          | 55/1014 [00:00<00:11, 80.38batch/s]  6%|█▊                          | 65/1014 [00:00<00:12, 78.49batch/s]  7%|██                          | 75/1014 [00:00<00:11, 79.26batch/s]  8%|██▎                         | 85/1014 [00:01<00:11, 80.17batch/s]  9%|██▌                         | 95/1014 [00:01<00:11, 80.59batch/s] 10%|██▊                        | 105/1014 [00:01<00:11, 80.53batch/s] 11%|███                        | 115/1014 [00:01<00:11, 80.21batch/s] 12%|███▎                       | 125/1014 [00:01<00:11, 80.31batch/s] 13%|███▌                       | 135/1014 [00:01<00:10, 80.56batch/s] 14%|███▊                       | 145/1014 [00:01<00:10, 80.09batch/s] 15%|████▏                      | 155/1014 [00:01<00:10, 80.12batch/s] 16%|████▍                      | 165/1014 [00:02<00:10, 80.39batch/s] 17%|████▋                      | 175/1014 [00:02<00:10, 80.26batch/s] 18%|████▉                      | 185/1014 [00:02<00:10, 80.21batch/s] 19%|█████▏                     | 195/1014 [00:02<00:10, 80.56batch/s] 20%|█████▍                     | 205/1014 [00:02<00:09, 80.94batch/s] 21%|█████▋                     | 215/1014 [00:02<00:09, 80.91batch/s] 22%|█████▉                     | 225/1014 [00:02<00:09, 80.76batch/s] 23%|██████▎                    | 235/1014 [00:02<00:09, 80.73batch/s] 24%|██████▌                    | 245/1014 [00:03<00:09, 81.08batch/s] 25%|██████▊                    | 255/1014 [00:03<00:09, 81.22batch/s] 26%|███████                    | 265/1014 [00:03<00:09, 81.38batch/s] 27%|███████▎                   | 275/1014 [00:03<00:09, 80.96batch/s] 28%|███████▌                   | 285/1014 [00:03<00:08, 81.47batch/s] 29%|███████▊                   | 295/1014 [00:03<00:08, 81.77batch/s] 30%|████████                   | 305/1014 [00:03<00:08, 81.77batch/s] 31%|████████▍                  | 315/1014 [00:03<00:08, 81.48batch/s] 32%|████████▋                  | 325/1014 [00:03<00:08, 81.58batch/s] 33%|████████▉                  | 335/1014 [00:04<00:08, 81.50batch/s] 34%|█████████▏                 | 345/1014 [00:04<00:08, 81.60batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:08, 81.74batch/s] 36%|█████████▋                 | 365/1014 [00:04<00:07, 81.92batch/s] 37%|█████████▉                 | 375/1014 [00:04<00:07, 82.18batch/s] 38%|██████████▎                | 385/1014 [00:04<00:07, 82.08batch/s] 39%|██████████▌                | 395/1014 [00:04<00:07, 82.29batch/s] 40%|██████████▊                | 405/1014 [00:04<00:07, 82.13batch/s] 41%|███████████                | 415/1014 [00:05<00:07, 81.85batch/s] 42%|███████████▎               | 425/1014 [00:05<00:07, 81.58batch/s] 43%|███████████▌               | 435/1014 [00:05<00:07, 81.82batch/s] 44%|███████████▊               | 445/1014 [00:05<00:06, 81.96batch/s] 45%|████████████               | 455/1014 [00:05<00:06, 81.90batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 81.84batch/s] 47%|████████████▋              | 475/1014 [00:05<00:06, 81.85batch/s] 48%|████████████▉              | 485/1014 [00:05<00:06, 81.98batch/s] 49%|█████████████▏             | 495/1014 [00:06<00:06, 81.81batch/s] 50%|█████████████▍             | 505/1014 [00:06<00:06, 81.72batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 81.93batch/s] 52%|█████████████▉             | 525/1014 [00:06<00:05, 81.73batch/s] 53%|██████████████▏            | 535/1014 [00:06<00:05, 81.97batch/s] 54%|██████████████▌            | 545/1014 [00:06<00:05, 82.08batch/s] 55%|██████████████▊            | 555/1014 [00:06<00:05, 82.30batch/s] 56%|███████████████            | 565/1014 [00:06<00:05, 82.35batch/s] 57%|███████████████▎           | 575/1014 [00:06<00:05, 82.34batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 82.16batch/s] 59%|███████████████▊           | 595/1014 [00:07<00:05, 81.95batch/s] 60%|████████████████           | 605/1014 [00:07<00:04, 81.82batch/s] 61%|████████████████▍          | 615/1014 [00:07<00:04, 81.82batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 81.79batch/s] 63%|████████████████▉          | 635/1014 [00:07<00:04, 81.90batch/s] 64%|█████████████████▏         | 645/1014 [00:07<00:04, 82.11batch/s] 65%|█████████████████▍         | 655/1014 [00:07<00:04, 82.10batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 82.28batch/s] 67%|█████████████████▉         | 675/1014 [00:08<00:04, 82.18batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:03, 82.26batch/s] 69%|██████████████████▌        | 695/1014 [00:08<00:03, 82.29batch/s] 70%|██████████████████▊        | 705/1014 [00:08<00:03, 82.41batch/s] 71%|███████████████████        | 715/1014 [00:08<00:03, 82.49batch/s] 71%|███████████████████▎       | 725/1014 [00:08<00:03, 82.45batch/s] 72%|███████████████████▌       | 735/1014 [00:08<00:03, 82.50batch/s] 73%|███████████████████▊       | 745/1014 [00:09<00:03, 82.49batch/s] 74%|████████████████████       | 755/1014 [00:09<00:03, 82.49batch/s] 75%|████████████████████▎      | 765/1014 [00:09<00:03, 82.49batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:02, 82.49batch/s] 77%|████████████████████▉      | 785/1014 [00:09<00:02, 82.46batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 82.53batch/s] 79%|█████████████████████▍     | 805/1014 [00:09<00:02, 82.52batch/s] 80%|█████████████████████▋     | 815/1014 [00:09<00:02, 82.43batch/s] 81%|█████████████████████▉     | 825/1014 [00:10<00:02, 82.49batch/s] 82%|██████████████████████▏    | 835/1014 [00:10<00:02, 82.47batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 82.29batch/s] 84%|██████████████████████▊    | 855/1014 [00:10<00:01, 82.22batch/s] 85%|███████████████████████    | 865/1014 [00:10<00:01, 82.24batch/s] 86%|███████████████████████▎   | 875/1014 [00:10<00:01, 82.23batch/s] 87%|███████████████████████▌   | 885/1014 [00:10<00:01, 82.23batch/s] 88%|███████████████████████▊   | 895/1014 [00:10<00:01, 82.35batch/s] 89%|████████████████████████   | 905/1014 [00:10<00:01, 82.45batch/s] 90%|████████████████████████▎  | 915/1014 [00:11<00:01, 82.45batch/s] 91%|████████████████████████▋  | 925/1014 [00:11<00:01, 82.37batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 82.35batch/s] 93%|█████████████████████████▏ | 945/1014 [00:11<00:00, 82.41batch/s] 94%|█████████████████████████▍ | 955/1014 [00:11<00:00, 82.38batch/s] 95%|█████████████████████████▋ | 965/1014 [00:11<00:00, 82.38batch/s] 96%|█████████████████████████▉ | 975/1014 [00:11<00:00, 82.34batch/s] 97%|██████████████████████████▏| 985/1014 [00:11<00:00, 82.34batch/s] 98%|██████████████████████████▍| 995/1014 [00:12<00:00, 82.41batch/s] 99%|█████████████████████████▊| 1005/1014 [00:12<00:00, 82.41batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.35batch/s]
Validation 29 -> LOSS = 1.82
Validation 29 -> BLEU = 28.25, 60.0/34.9/22.7/14.9 (BP=0.974, ratio=0.974, hyp_len=12493, ref_len=12828)
Early stopping patience: 8
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 30
Epoch 30 - update      13860 => loss:   1.275 (#OOM: 0)
Epoch 30 - update      13890 => loss:   2.008 (#OOM: 0)
Epoch 30 - update      13920 => loss:   1.595 (#OOM: 0)
Epoch 30 - update      13950 => loss:   1.469 (#OOM: 0)
Epoch 30 - update      13980 => loss:   1.667 (#OOM: 0)
Epoch 30 - update      14010 => loss:   1.414 (#OOM: 0)
Epoch 30 - update      14040 => loss:   1.386 (#OOM: 0)
Epoch 30 - update      14070 => loss:   1.201 (#OOM: 0)
Epoch 30 - update      14100 => loss:   1.215 (#OOM: 0)
Epoch 30 - update      14130 => loss:   1.884 (#OOM: 0)
Epoch 30 - update      14160 => loss:   1.704 (#OOM: 0)
Epoch 30 - update      14190 => loss:   1.808 (#OOM: 0)
Epoch 30 - update      14220 => loss:   1.459 (#OOM: 0)
Epoch 30 - update      14250 => loss:   2.012 (#OOM: 0)
Epoch 30 - update      14280 => loss:   0.872 (#OOM: 0)
Epoch 30 - update      14310 => loss:   1.374 (#OOM: 0)
--> Epoch 30 finished with mean loss 1.52339
--> Overhead/Training/Evaluation: 0.04/0.62/0.00 mins (total: 0.66 mins)   (782 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 20%|██████▏                        | 7/35 [00:00<00:00, 57.89batch/s] 40%|████████████                  | 14/35 [00:00<00:00, 56.92batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 56.73batch/s] 80%|████████████████████████      | 28/35 [00:00<00:00, 56.42batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.47batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.44batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 7/1014 [00:00<00:15, 66.51batch/s]  1%|▍                           | 15/1014 [00:00<00:14, 71.26batch/s]  2%|▋                           | 23/1014 [00:00<00:13, 73.94batch/s]  3%|▉                           | 32/1014 [00:00<00:12, 76.91batch/s]  4%|█▏                          | 41/1014 [00:00<00:12, 78.03batch/s]  5%|█▍                          | 51/1014 [00:00<00:11, 81.34batch/s]  6%|█▋                          | 61/1014 [00:00<00:11, 81.76batch/s]  7%|█▉                          | 71/1014 [00:00<00:11, 81.67batch/s]  8%|██▏                         | 81/1014 [00:00<00:11, 82.22batch/s]  9%|██▌                         | 91/1014 [00:01<00:11, 82.34batch/s] 10%|██▋                        | 102/1014 [00:01<00:10, 84.07batch/s] 11%|███                        | 113/1014 [00:01<00:10, 83.95batch/s] 12%|███▎                       | 124/1014 [00:01<00:10, 83.10batch/s] 13%|███▌                       | 135/1014 [00:01<00:10, 84.03batch/s] 14%|███▉                       | 146/1014 [00:01<00:10, 84.01batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 83.85batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 83.53batch/s] 18%|████▊                      | 179/1014 [00:02<00:09, 83.65batch/s] 19%|█████                      | 190/1014 [00:02<00:09, 83.50batch/s] 20%|█████▎                     | 201/1014 [00:02<00:09, 83.57batch/s] 21%|█████▋                     | 212/1014 [00:02<00:09, 83.97batch/s] 22%|█████▉                     | 223/1014 [00:02<00:09, 83.20batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 83.37batch/s] 24%|██████▌                    | 245/1014 [00:02<00:09, 83.02batch/s] 25%|██████▊                    | 256/1014 [00:03<00:09, 83.16batch/s] 26%|███████                    | 267/1014 [00:03<00:08, 83.57batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 83.48batch/s] 29%|███████▋                   | 289/1014 [00:03<00:08, 82.92batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 82.77batch/s] 31%|████████▎                  | 311/1014 [00:03<00:08, 82.79batch/s] 32%|████████▌                  | 322/1014 [00:03<00:08, 83.04batch/s] 33%|████████▊                  | 333/1014 [00:04<00:08, 83.09batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 83.19batch/s] 35%|█████████▍                 | 355/1014 [00:04<00:07, 83.04batch/s] 36%|█████████▋                 | 366/1014 [00:04<00:07, 82.64batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 82.43batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 82.31batch/s] 39%|██████████▌                | 399/1014 [00:04<00:07, 82.14batch/s] 40%|██████████▉                | 410/1014 [00:04<00:07, 82.40batch/s] 42%|███████████▏               | 421/1014 [00:05<00:07, 82.62batch/s] 43%|███████████▌               | 432/1014 [00:05<00:07, 82.28batch/s] 44%|███████████▊               | 443/1014 [00:05<00:06, 82.38batch/s] 45%|████████████               | 454/1014 [00:05<00:06, 82.15batch/s] 46%|████████████▍              | 465/1014 [00:05<00:06, 82.20batch/s] 47%|████████████▋              | 476/1014 [00:05<00:06, 82.33batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 82.30batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 82.23batch/s] 50%|█████████████▌             | 509/1014 [00:06<00:06, 82.16batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 82.23batch/s] 52%|██████████████▏            | 531/1014 [00:06<00:05, 82.02batch/s] 53%|██████████████▍            | 542/1014 [00:06<00:05, 82.38batch/s] 55%|██████████████▋            | 553/1014 [00:06<00:05, 82.40batch/s] 56%|███████████████            | 564/1014 [00:06<00:05, 82.26batch/s] 57%|███████████████▎           | 575/1014 [00:06<00:05, 82.23batch/s] 58%|███████████████▌           | 586/1014 [00:07<00:05, 82.28batch/s] 59%|███████████████▉           | 597/1014 [00:07<00:05, 82.02batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:04, 81.98batch/s] 61%|████████████████▍          | 619/1014 [00:07<00:04, 81.68batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 81.62batch/s] 63%|█████████████████          | 641/1014 [00:07<00:04, 81.69batch/s] 64%|█████████████████▎         | 652/1014 [00:07<00:04, 81.54batch/s] 65%|█████████████████▋         | 663/1014 [00:08<00:04, 81.56batch/s] 66%|█████████████████▉         | 674/1014 [00:08<00:04, 81.38batch/s] 68%|██████████████████▏        | 685/1014 [00:08<00:04, 81.31batch/s] 69%|██████████████████▌        | 696/1014 [00:08<00:03, 81.28batch/s] 70%|██████████████████▊        | 707/1014 [00:08<00:03, 81.23batch/s] 71%|███████████████████        | 718/1014 [00:08<00:03, 81.32batch/s] 72%|███████████████████▍       | 729/1014 [00:08<00:03, 81.43batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 81.33batch/s] 74%|███████████████████▉       | 751/1014 [00:09<00:03, 81.35batch/s] 75%|████████████████████▎      | 762/1014 [00:09<00:03, 81.31batch/s] 76%|████████████████████▌      | 773/1014 [00:09<00:02, 81.43batch/s] 77%|████████████████████▉      | 784/1014 [00:09<00:02, 81.54batch/s] 78%|█████████████████████▏     | 795/1014 [00:09<00:02, 81.47batch/s] 79%|█████████████████████▍     | 806/1014 [00:09<00:02, 81.56batch/s] 81%|█████████████████████▊     | 817/1014 [00:09<00:02, 81.76batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 81.53batch/s] 83%|██████████████████████▎    | 839/1014 [00:10<00:02, 81.52batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 81.58batch/s] 85%|██████████████████████▉    | 861/1014 [00:10<00:01, 81.63batch/s] 86%|███████████████████████▏   | 872/1014 [00:10<00:01, 81.57batch/s] 87%|███████████████████████▌   | 883/1014 [00:10<00:01, 81.55batch/s] 88%|███████████████████████▊   | 894/1014 [00:10<00:01, 81.62batch/s] 89%|████████████████████████   | 905/1014 [00:11<00:01, 81.75batch/s] 90%|████████████████████████▍  | 916/1014 [00:11<00:01, 81.66batch/s] 91%|████████████████████████▋  | 927/1014 [00:11<00:01, 81.69batch/s] 93%|████████████████████████▉  | 938/1014 [00:11<00:00, 81.71batch/s] 94%|█████████████████████████▎ | 949/1014 [00:11<00:00, 81.80batch/s] 95%|█████████████████████████▌ | 960/1014 [00:11<00:00, 81.86batch/s] 96%|█████████████████████████▊ | 971/1014 [00:11<00:00, 81.85batch/s] 97%|██████████████████████████▏| 982/1014 [00:11<00:00, 81.94batch/s] 98%|██████████████████████████▍| 993/1014 [00:12<00:00, 82.01batch/s] 99%|█████████████████████████▋| 1004/1014 [00:12<00:00, 82.05batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.08batch/s]
Validation 30 -> LOSS = 1.82
Validation 30 -> BLEU = 28.44, 59.3/34.1/22.2/14.7 (BP=0.999, ratio=0.999, hyp_len=12813, ref_len=12828)
** Learning rate changed -> 5e-05
Early stopping patience: 7
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 31
Epoch 31 - update      14340 => loss:   1.707 (#OOM: 0)
Epoch 31 - update      14370 => loss:   0.810 (#OOM: 0)
Epoch 31 - update      14400 => loss:   1.606 (#OOM: 0)
Epoch 31 - update      14430 => loss:   1.577 (#OOM: 0)
Epoch 31 - update      14460 => loss:   1.069 (#OOM: 0)
Epoch 31 - update      14490 => loss:   1.069 (#OOM: 0)
Epoch 31 - update      14520 => loss:   1.333 (#OOM: 0)
Epoch 31 - update      14550 => loss:   1.714 (#OOM: 0)
Epoch 31 - update      14580 => loss:   1.524 (#OOM: 0)
Epoch 31 - update      14610 => loss:   1.623 (#OOM: 0)
Epoch 31 - update      14640 => loss:   1.312 (#OOM: 0)
Epoch 31 - update      14670 => loss:   1.653 (#OOM: 0)
Epoch 31 - update      14700 => loss:   1.907 (#OOM: 0)
Epoch 31 - update      14730 => loss:   1.556 (#OOM: 0)
Epoch 31 - update      14760 => loss:   0.948 (#OOM: 0)
--> Epoch 31 finished with mean loss 1.50719
--> Overhead/Training/Evaluation: 0.04/0.59/0.00 mins (total: 0.63 mins)   (816 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 50.37batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 52.05batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.99batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 54.45batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 56.19batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.39batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 88.98batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 85.63batch/s]  3%|▋                           | 27/1014 [00:00<00:11, 84.54batch/s]  4%|▉                           | 36/1014 [00:00<00:11, 82.11batch/s]  4%|█▏                          | 45/1014 [00:00<00:11, 83.29batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 83.87batch/s]  6%|█▋                          | 63/1014 [00:00<00:11, 82.87batch/s]  7%|█▉                          | 72/1014 [00:00<00:11, 82.35batch/s]  8%|██▏                         | 81/1014 [00:00<00:11, 82.74batch/s]  9%|██▍                         | 90/1014 [00:01<00:11, 82.37batch/s] 10%|██▋                         | 99/1014 [00:01<00:11, 82.93batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 81.28batch/s] 12%|███▏                       | 118/1014 [00:01<00:10, 82.27batch/s] 13%|███▍                       | 128/1014 [00:01<00:10, 82.27batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 82.91batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 83.64batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 83.15batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 82.60batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 83.25batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 82.52batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 82.30batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 81.85batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 81.82batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 82.31batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 82.29batch/s] 24%|██████▌                    | 248/1014 [00:02<00:09, 82.71batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 82.44batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 82.75batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 82.43batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 82.48batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 82.68batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 82.70batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 82.74batch/s] 32%|████████▋                  | 328/1014 [00:03<00:08, 82.26batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 82.36batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 82.16batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:07, 82.40batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 82.28batch/s] 37%|██████████                 | 379/1014 [00:04<00:07, 82.68batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 82.95batch/s] 40%|██████████▋                | 401/1014 [00:04<00:07, 83.18batch/s] 41%|██████████▉                | 412/1014 [00:04<00:07, 83.18batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 83.34batch/s] 43%|███████████▌               | 434/1014 [00:05<00:06, 83.21batch/s] 44%|███████████▊               | 445/1014 [00:05<00:06, 83.46batch/s] 45%|████████████▏              | 456/1014 [00:05<00:06, 83.15batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 83.27batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 83.29batch/s] 48%|█████████████              | 489/1014 [00:05<00:06, 83.44batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 83.23batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 83.36batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:05, 83.21batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:05, 83.13batch/s] 54%|██████████████▍            | 544/1014 [00:06<00:05, 83.23batch/s] 55%|██████████████▊            | 555/1014 [00:06<00:05, 83.31batch/s] 56%|███████████████            | 566/1014 [00:06<00:05, 83.37batch/s] 57%|███████████████▎           | 577/1014 [00:06<00:05, 83.48batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 83.71batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:04, 83.70batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 83.84batch/s] 61%|████████████████▌          | 621/1014 [00:07<00:04, 83.91batch/s] 62%|████████████████▊          | 632/1014 [00:07<00:04, 83.81batch/s] 63%|█████████████████          | 643/1014 [00:07<00:04, 83.92batch/s] 64%|█████████████████▍         | 654/1014 [00:07<00:04, 83.83batch/s] 66%|█████████████████▋         | 665/1014 [00:07<00:04, 83.65batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 83.52batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:03, 83.58batch/s] 69%|██████████████████▌        | 698/1014 [00:08<00:03, 83.63batch/s] 70%|██████████████████▉        | 709/1014 [00:08<00:03, 83.64batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 83.45batch/s] 72%|███████████████████▍       | 731/1014 [00:08<00:03, 83.31batch/s] 73%|███████████████████▊       | 742/1014 [00:08<00:03, 83.29batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 83.24batch/s] 75%|████████████████████▎      | 764/1014 [00:09<00:03, 83.20batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:02, 83.02batch/s] 78%|████████████████████▉      | 786/1014 [00:09<00:02, 82.97batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 82.91batch/s] 80%|█████████████████████▌     | 808/1014 [00:09<00:02, 83.04batch/s] 81%|█████████████████████▊     | 819/1014 [00:09<00:02, 83.19batch/s] 82%|██████████████████████     | 830/1014 [00:09<00:02, 83.07batch/s] 83%|██████████████████████▍    | 841/1014 [00:10<00:02, 83.00batch/s] 84%|██████████████████████▋    | 852/1014 [00:10<00:01, 82.99batch/s] 85%|██████████████████████▉    | 863/1014 [00:10<00:01, 82.94batch/s] 86%|███████████████████████▎   | 874/1014 [00:10<00:01, 83.01batch/s] 87%|███████████████████████▌   | 885/1014 [00:10<00:01, 82.87batch/s] 88%|███████████████████████▊   | 896/1014 [00:10<00:01, 82.89batch/s] 89%|████████████████████████▏  | 907/1014 [00:10<00:01, 82.92batch/s] 91%|████████████████████████▍  | 918/1014 [00:11<00:01, 82.82batch/s] 92%|████████████████████████▋  | 929/1014 [00:11<00:01, 82.82batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 82.78batch/s] 94%|█████████████████████████▎ | 951/1014 [00:11<00:00, 82.82batch/s] 95%|█████████████████████████▌ | 962/1014 [00:11<00:00, 82.86batch/s] 96%|█████████████████████████▉ | 973/1014 [00:11<00:00, 82.96batch/s] 97%|██████████████████████████▏| 984/1014 [00:11<00:00, 82.83batch/s] 98%|██████████████████████████▍| 995/1014 [00:12<00:00, 82.91batch/s] 99%|█████████████████████████▊| 1006/1014 [00:12<00:00, 82.83batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.86batch/s]
Validation 31 -> LOSS = 1.82
Validation 31 -> BLEU = 28.32, 60.6/35.0/22.8/15.0 (BP=0.970, ratio=0.971, hyp_len=12453, ref_len=12828)
Early stopping patience: 6
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 32
Epoch 32 - update      14790 => loss:   2.325 (#OOM: 0)
Epoch 32 - update      14820 => loss:   1.446 (#OOM: 0)
Epoch 32 - update      14850 => loss:   1.408 (#OOM: 0)
Epoch 32 - update      14880 => loss:   1.252 (#OOM: 0)
Epoch 32 - update      14910 => loss:   0.851 (#OOM: 0)
Epoch 32 - update      14940 => loss:   1.321 (#OOM: 0)
Epoch 32 - update      14970 => loss:   1.813 (#OOM: 0)
Epoch 32 - update      15000 => loss:   1.434 (#OOM: 0)
Epoch 32 - update      15030 => loss:   1.375 (#OOM: 0)
Epoch 32 - update      15060 => loss:   1.528 (#OOM: 0)
Epoch 32 - update      15090 => loss:   1.129 (#OOM: 0)
Epoch 32 - update      15120 => loss:   1.397 (#OOM: 0)
Epoch 32 - update      15150 => loss:   0.945 (#OOM: 0)
Epoch 32 - update      15180 => loss:   1.281 (#OOM: 0)
Epoch 32 - update      15210 => loss:   1.352 (#OOM: 0)
Epoch 32 - update      15240 => loss:   1.229 (#OOM: 0)
--> Epoch 32 finished with mean loss 1.49873
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.59 mins)   (870 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 48.62batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.96batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 53.63batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 55.97batch/s] 89%|██████████████████████████▌   | 31/35 [00:00<00:00, 53.81batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.49batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.65batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 85.98batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 82.43batch/s]  4%|█                           | 38/1014 [00:00<00:12, 80.36batch/s]  5%|█▎                          | 48/1014 [00:00<00:12, 78.21batch/s]  6%|█▌                          | 58/1014 [00:00<00:11, 79.75batch/s]  7%|█▉                          | 68/1014 [00:00<00:11, 80.45batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 80.03batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 80.27batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 79.42batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 80.55batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 80.67batch/s] 13%|███▍                       | 128/1014 [00:01<00:10, 80.76batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 80.07batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 79.83batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 80.31batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 80.97batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 80.97batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 81.16batch/s] 20%|█████▎                     | 198/1014 [00:02<00:10, 81.21batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 81.32batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 81.41batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 81.23batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 81.54batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 81.61batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 81.64batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 81.90batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 81.96batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 82.19batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 81.71batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 81.96batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 81.68batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 81.85batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 81.91batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 81.96batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:07, 82.01batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 81.91batch/s] 37%|██████████                 | 378/1014 [00:04<00:07, 81.77batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 81.75batch/s] 39%|██████████▌                | 398/1014 [00:04<00:07, 81.79batch/s] 40%|██████████▊                | 408/1014 [00:04<00:07, 81.85batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 81.88batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 81.76batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 81.70batch/s] 44%|███████████▉               | 449/1014 [00:05<00:06, 82.03batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 82.06batch/s] 46%|████████████▌              | 471/1014 [00:05<00:06, 82.01batch/s] 48%|████████████▊              | 482/1014 [00:05<00:06, 81.93batch/s] 49%|█████████████▏             | 493/1014 [00:05<00:06, 82.17batch/s] 50%|█████████████▍             | 504/1014 [00:06<00:06, 82.39batch/s] 51%|█████████████▋             | 515/1014 [00:06<00:06, 82.80batch/s] 52%|██████████████             | 526/1014 [00:06<00:05, 82.74batch/s] 53%|██████████████▎            | 537/1014 [00:06<00:05, 82.83batch/s] 54%|██████████████▌            | 548/1014 [00:06<00:05, 82.66batch/s] 55%|██████████████▉            | 559/1014 [00:06<00:05, 82.60batch/s] 56%|███████████████▏           | 570/1014 [00:06<00:05, 82.46batch/s] 57%|███████████████▍           | 581/1014 [00:07<00:05, 82.40batch/s] 58%|███████████████▊           | 592/1014 [00:07<00:05, 82.33batch/s] 59%|████████████████           | 603/1014 [00:07<00:04, 82.41batch/s] 61%|████████████████▎          | 614/1014 [00:07<00:04, 82.40batch/s] 62%|████████████████▋          | 625/1014 [00:07<00:04, 82.35batch/s] 63%|████████████████▉          | 636/1014 [00:07<00:04, 82.22batch/s] 64%|█████████████████▏         | 647/1014 [00:07<00:04, 82.28batch/s] 65%|█████████████████▌         | 658/1014 [00:07<00:04, 82.49batch/s] 66%|█████████████████▊         | 669/1014 [00:08<00:04, 82.61batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 82.64batch/s] 68%|██████████████████▍        | 691/1014 [00:08<00:03, 82.74batch/s] 69%|██████████████████▋        | 702/1014 [00:08<00:03, 82.70batch/s] 70%|██████████████████▉        | 713/1014 [00:08<00:03, 82.80batch/s] 71%|███████████████████▎       | 724/1014 [00:08<00:03, 82.92batch/s] 72%|███████████████████▌       | 735/1014 [00:08<00:03, 82.99batch/s] 74%|███████████████████▊       | 746/1014 [00:08<00:03, 83.07batch/s] 75%|████████████████████▏      | 757/1014 [00:09<00:03, 83.07batch/s] 76%|████████████████████▍      | 768/1014 [00:09<00:02, 82.98batch/s] 77%|████████████████████▋      | 779/1014 [00:09<00:02, 83.10batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 83.06batch/s] 79%|█████████████████████▎     | 801/1014 [00:09<00:02, 82.97batch/s] 80%|█████████████████████▌     | 812/1014 [00:09<00:02, 83.04batch/s] 81%|█████████████████████▉     | 823/1014 [00:09<00:02, 83.13batch/s] 82%|██████████████████████▏    | 834/1014 [00:10<00:02, 83.20batch/s] 83%|██████████████████████▌    | 845/1014 [00:10<00:02, 83.10batch/s] 84%|██████████████████████▊    | 856/1014 [00:10<00:01, 83.13batch/s] 86%|███████████████████████    | 867/1014 [00:10<00:01, 83.16batch/s] 87%|███████████████████████▍   | 878/1014 [00:10<00:01, 83.23batch/s] 88%|███████████████████████▋   | 889/1014 [00:10<00:01, 83.12batch/s] 89%|███████████████████████▉   | 900/1014 [00:10<00:01, 83.07batch/s] 90%|████████████████████████▎  | 911/1014 [00:10<00:01, 83.15batch/s] 91%|████████████████████████▌  | 922/1014 [00:11<00:01, 83.19batch/s] 92%|████████████████████████▊  | 933/1014 [00:11<00:00, 83.13batch/s] 93%|█████████████████████████▏ | 944/1014 [00:11<00:00, 83.20batch/s] 94%|█████████████████████████▍ | 955/1014 [00:11<00:00, 83.24batch/s] 95%|█████████████████████████▋ | 966/1014 [00:11<00:00, 83.36batch/s] 96%|██████████████████████████ | 977/1014 [00:11<00:00, 83.36batch/s] 97%|██████████████████████████▎| 988/1014 [00:11<00:00, 83.28batch/s] 99%|██████████████████████████▌| 999/1014 [00:11<00:00, 83.32batch/s]100%|█████████████████████████▉| 1010/1014 [00:12<00:00, 83.30batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 83.33batch/s]
Validation 32 -> LOSS = 1.82
Validation 32 -> BLEU = 28.09, 60.1/34.6/22.5/14.7 (BP=0.975, ratio=0.975, hyp_len=12508, ref_len=12828)
Early stopping patience: 5
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 33
Epoch 33 - update      15270 => loss:   1.446 (#OOM: 0)
Epoch 33 - update      15300 => loss:   1.725 (#OOM: 0)
Epoch 33 - update      15330 => loss:   1.854 (#OOM: 0)
Epoch 33 - update      15360 => loss:   1.112 (#OOM: 0)
Epoch 33 - update      15390 => loss:   1.204 (#OOM: 0)
Epoch 33 - update      15420 => loss:   1.090 (#OOM: 0)
Epoch 33 - update      15450 => loss:   1.157 (#OOM: 0)
Epoch 33 - update      15480 => loss:   2.248 (#OOM: 0)
Epoch 33 - update      15510 => loss:   1.104 (#OOM: 0)
Epoch 33 - update      15540 => loss:   1.886 (#OOM: 0)
Epoch 33 - update      15570 => loss:   1.301 (#OOM: 0)
Epoch 33 - update      15600 => loss:   1.640 (#OOM: 0)
Epoch 33 - update      15630 => loss:   1.191 (#OOM: 0)
Epoch 33 - update      15660 => loss:   1.712 (#OOM: 0)
Epoch 33 - update      15690 => loss:   1.490 (#OOM: 0)
Epoch 33 - update      15720 => loss:   1.676 (#OOM: 0)
--> Epoch 33 finished with mean loss 1.49407
--> Overhead/Training/Evaluation: 0.04/0.54/0.00 mins (total: 0.58 mins)   (888 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 55.69batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.41batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 54.98batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 55.66batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 54.27batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.75batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:12, 80.72batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 84.13batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 88.74batch/s]  4%|█                           | 38/1014 [00:00<00:11, 84.25batch/s]  5%|█▎                          | 48/1014 [00:00<00:11, 84.14batch/s]  6%|█▌                          | 58/1014 [00:00<00:11, 81.56batch/s]  7%|█▉                          | 68/1014 [00:00<00:11, 81.43batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 81.92batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 81.29batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 79.96batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 80.29batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 80.47batch/s] 13%|███▍                       | 128/1014 [00:01<00:11, 80.09batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 80.79batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 81.05batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 81.56batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 81.72batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 82.36batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 82.29batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 82.52batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 82.30batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 82.86batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 82.74batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 82.47batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 82.38batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 82.45batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 82.34batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 82.23batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 82.16batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 82.14batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 81.68batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 81.70batch/s] 32%|████████▋                  | 328/1014 [00:04<00:08, 81.50batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 81.18batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 81.07batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 81.17batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 81.04batch/s] 37%|██████████                 | 379/1014 [00:04<00:07, 81.55batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 81.88batch/s] 40%|██████████▋                | 401/1014 [00:04<00:07, 81.91batch/s] 41%|██████████▉                | 412/1014 [00:05<00:07, 81.78batch/s] 42%|███████████▎               | 423/1014 [00:05<00:07, 82.03batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 82.09batch/s] 44%|███████████▊               | 445/1014 [00:05<00:06, 82.03batch/s] 45%|████████████▏              | 456/1014 [00:05<00:06, 81.90batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 82.05batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 81.99batch/s] 48%|█████████████              | 489/1014 [00:05<00:06, 82.15batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 82.35batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 82.53batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:05, 82.46batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:05, 82.57batch/s] 54%|██████████████▍            | 544/1014 [00:06<00:05, 82.47batch/s] 55%|██████████████▊            | 555/1014 [00:06<00:05, 82.47batch/s] 56%|███████████████            | 566/1014 [00:06<00:05, 82.23batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 82.04batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 82.07batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 81.97batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 82.11batch/s] 61%|████████████████▌          | 621/1014 [00:07<00:04, 82.13batch/s] 62%|████████████████▊          | 632/1014 [00:07<00:04, 82.16batch/s] 63%|█████████████████          | 643/1014 [00:07<00:04, 82.28batch/s] 64%|█████████████████▍         | 654/1014 [00:07<00:04, 82.38batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 82.37batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 82.34batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:03, 82.22batch/s] 69%|██████████████████▌        | 698/1014 [00:08<00:03, 82.27batch/s] 70%|██████████████████▉        | 709/1014 [00:08<00:03, 82.31batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 82.14batch/s] 72%|███████████████████▍       | 731/1014 [00:08<00:03, 82.22batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 82.11batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 82.09batch/s] 75%|████████████████████▎      | 764/1014 [00:09<00:03, 82.19batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:02, 82.08batch/s] 78%|████████████████████▉      | 786/1014 [00:09<00:02, 82.04batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 82.04batch/s] 80%|█████████████████████▌     | 808/1014 [00:09<00:02, 81.82batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 81.87batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 81.95batch/s] 83%|██████████████████████▍    | 841/1014 [00:10<00:02, 82.02batch/s] 84%|██████████████████████▋    | 852/1014 [00:10<00:01, 82.09batch/s] 85%|██████████████████████▉    | 863/1014 [00:10<00:01, 82.17batch/s] 86%|███████████████████████▎   | 874/1014 [00:10<00:01, 82.18batch/s] 87%|███████████████████████▌   | 885/1014 [00:10<00:01, 82.08batch/s] 88%|███████████████████████▊   | 896/1014 [00:10<00:01, 82.12batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 82.08batch/s] 91%|████████████████████████▍  | 918/1014 [00:11<00:01, 82.09batch/s] 92%|████████████████████████▋  | 929/1014 [00:11<00:01, 82.09batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 82.12batch/s] 94%|█████████████████████████▎ | 951/1014 [00:11<00:00, 82.16batch/s] 95%|█████████████████████████▌ | 962/1014 [00:11<00:00, 82.15batch/s] 96%|█████████████████████████▉ | 973/1014 [00:11<00:00, 82.29batch/s] 97%|██████████████████████████▏| 984/1014 [00:11<00:00, 82.41batch/s] 98%|██████████████████████████▍| 995/1014 [00:12<00:00, 82.54batch/s] 99%|█████████████████████████▊| 1006/1014 [00:12<00:00, 82.57batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.48batch/s]
Validation 33 -> LOSS = 1.82
Validation 33 -> BLEU = 28.38, 59.8/34.5/22.4/14.6 (BP=0.991, ratio=0.991, hyp_len=12711, ref_len=12828)
** Learning rate changed -> 2.5e-05
Early stopping patience: 4
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 34
Epoch 34 - update      15750 => loss:   1.535 (#OOM: 0)
Epoch 34 - update      15780 => loss:   1.584 (#OOM: 0)
Epoch 34 - update      15810 => loss:   1.126 (#OOM: 0)
Epoch 34 - update      15840 => loss:   1.794 (#OOM: 0)
Epoch 34 - update      15870 => loss:   0.962 (#OOM: 0)
Epoch 34 - update      15900 => loss:   1.091 (#OOM: 0)
Epoch 34 - update      15930 => loss:   1.613 (#OOM: 0)
Epoch 34 - update      15960 => loss:   1.537 (#OOM: 0)
Epoch 34 - update      15990 => loss:   1.083 (#OOM: 0)
Epoch 34 - update      16020 => loss:   1.881 (#OOM: 0)
Epoch 34 - update      16050 => loss:   1.664 (#OOM: 0)
Epoch 34 - update      16080 => loss:   1.977 (#OOM: 0)
Epoch 34 - update      16110 => loss:   0.839 (#OOM: 0)
Epoch 34 - update      16140 => loss:   1.264 (#OOM: 0)
Epoch 34 - update      16170 => loss:   1.307 (#OOM: 0)
Epoch 34 - update      16200 => loss:   1.099 (#OOM: 0)
--> Epoch 34 finished with mean loss 1.48508
--> Overhead/Training/Evaluation: 0.04/0.60/0.00 mins (total: 0.65 mins)   (800 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 55.86batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 51.99batch/s] 54%|████████████████▎             | 19/35 [00:00<00:00, 55.92batch/s] 74%|██████████████████████▎       | 26/35 [00:00<00:00, 56.20batch/s] 94%|████████████████████████████▎ | 33/35 [00:00<00:00, 53.72batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 53.58batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:13, 76.39batch/s]  2%|▍                           | 18/1014 [00:00<00:11, 84.65batch/s]  3%|▊                           | 28/1014 [00:00<00:11, 82.35batch/s]  4%|█                           | 38/1014 [00:00<00:11, 83.38batch/s]  5%|█▎                          | 48/1014 [00:00<00:11, 83.31batch/s]  6%|█▌                          | 58/1014 [00:00<00:11, 81.36batch/s]  7%|█▉                          | 68/1014 [00:00<00:11, 81.37batch/s]  8%|██▏                         | 78/1014 [00:00<00:11, 81.83batch/s]  9%|██▍                         | 88/1014 [00:01<00:11, 81.29batch/s] 10%|██▋                         | 98/1014 [00:01<00:11, 81.19batch/s] 11%|██▉                        | 108/1014 [00:01<00:11, 81.54batch/s] 12%|███▏                       | 118/1014 [00:01<00:11, 81.43batch/s] 13%|███▍                       | 128/1014 [00:01<00:10, 81.79batch/s] 14%|███▋                       | 138/1014 [00:01<00:10, 81.83batch/s] 15%|███▉                       | 148/1014 [00:01<00:10, 82.46batch/s] 16%|████▏                      | 158/1014 [00:01<00:10, 82.20batch/s] 17%|████▍                      | 168/1014 [00:02<00:10, 82.25batch/s] 18%|████▋                      | 178/1014 [00:02<00:10, 82.83batch/s] 19%|█████                      | 188/1014 [00:02<00:10, 81.86batch/s] 20%|█████▎                     | 198/1014 [00:02<00:09, 82.33batch/s] 21%|█████▌                     | 208/1014 [00:02<00:09, 81.85batch/s] 21%|█████▊                     | 218/1014 [00:02<00:09, 81.60batch/s] 22%|██████                     | 228/1014 [00:02<00:09, 81.68batch/s] 23%|██████▎                    | 238/1014 [00:02<00:09, 81.79batch/s] 24%|██████▌                    | 248/1014 [00:03<00:09, 81.94batch/s] 25%|██████▊                    | 258/1014 [00:03<00:09, 82.37batch/s] 26%|███████▏                   | 268/1014 [00:03<00:09, 82.56batch/s] 27%|███████▍                   | 278/1014 [00:03<00:08, 82.35batch/s] 28%|███████▋                   | 288/1014 [00:03<00:08, 81.87batch/s] 29%|███████▉                   | 298/1014 [00:03<00:08, 82.02batch/s] 30%|████████▏                  | 308/1014 [00:03<00:08, 82.19batch/s] 31%|████████▍                  | 318/1014 [00:03<00:08, 82.31batch/s] 32%|████████▋                  | 328/1014 [00:03<00:08, 82.05batch/s] 33%|█████████                  | 338/1014 [00:04<00:08, 81.91batch/s] 34%|█████████▎                 | 348/1014 [00:04<00:08, 81.91batch/s] 35%|█████████▌                 | 358/1014 [00:04<00:08, 81.79batch/s] 36%|█████████▊                 | 368/1014 [00:04<00:07, 81.56batch/s] 37%|██████████                 | 378/1014 [00:04<00:07, 81.37batch/s] 38%|██████████▎                | 388/1014 [00:04<00:07, 81.29batch/s] 39%|██████████▌                | 398/1014 [00:04<00:07, 80.93batch/s] 40%|██████████▊                | 408/1014 [00:05<00:07, 80.81batch/s] 41%|███████████▏               | 418/1014 [00:05<00:07, 80.74batch/s] 42%|███████████▍               | 428/1014 [00:05<00:07, 80.40batch/s] 43%|███████████▋               | 438/1014 [00:05<00:07, 80.51batch/s] 44%|███████████▉               | 448/1014 [00:05<00:07, 80.59batch/s] 45%|████████████▏              | 458/1014 [00:05<00:06, 80.46batch/s] 46%|████████████▍              | 468/1014 [00:05<00:06, 80.38batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 80.40batch/s] 48%|████████████▉              | 488/1014 [00:06<00:06, 80.31batch/s] 49%|█████████████▎             | 498/1014 [00:06<00:06, 80.09batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 80.26batch/s] 51%|█████████████▊             | 518/1014 [00:06<00:06, 80.38batch/s] 52%|██████████████             | 528/1014 [00:06<00:06, 80.38batch/s] 53%|██████████████▎            | 538/1014 [00:06<00:05, 80.27batch/s] 54%|██████████████▌            | 548/1014 [00:06<00:05, 80.29batch/s] 55%|██████████████▊            | 558/1014 [00:06<00:05, 80.22batch/s] 56%|███████████████            | 568/1014 [00:07<00:05, 80.41batch/s] 57%|███████████████▍           | 578/1014 [00:07<00:05, 80.42batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 80.49batch/s] 59%|███████████████▉           | 598/1014 [00:07<00:05, 80.36batch/s] 60%|████████████████▏          | 608/1014 [00:07<00:05, 80.45batch/s] 61%|████████████████▍          | 618/1014 [00:07<00:04, 80.41batch/s] 62%|████████████████▋          | 628/1014 [00:07<00:04, 80.41batch/s] 63%|████████████████▉          | 638/1014 [00:07<00:04, 80.46batch/s] 64%|█████████████████▎         | 648/1014 [00:08<00:04, 80.56batch/s] 65%|█████████████████▌         | 658/1014 [00:08<00:04, 80.47batch/s] 66%|█████████████████▊         | 668/1014 [00:08<00:04, 80.50batch/s] 67%|██████████████████         | 678/1014 [00:08<00:04, 80.61batch/s] 68%|██████████████████▎        | 688/1014 [00:08<00:04, 80.56batch/s] 69%|██████████████████▌        | 698/1014 [00:08<00:03, 80.63batch/s] 70%|██████████████████▊        | 708/1014 [00:08<00:03, 80.59batch/s] 71%|███████████████████        | 718/1014 [00:08<00:03, 80.54batch/s] 72%|███████████████████▍       | 728/1014 [00:09<00:03, 80.47batch/s] 73%|███████████████████▋       | 738/1014 [00:09<00:03, 80.66batch/s] 74%|███████████████████▉       | 748/1014 [00:09<00:03, 80.53batch/s] 75%|████████████████████▏      | 758/1014 [00:09<00:03, 80.62batch/s] 76%|████████████████████▍      | 768/1014 [00:09<00:03, 80.54batch/s] 77%|████████████████████▋      | 778/1014 [00:09<00:02, 80.65batch/s] 78%|████████████████████▉      | 788/1014 [00:09<00:02, 80.68batch/s] 79%|█████████████████████▏     | 798/1014 [00:09<00:02, 80.82batch/s] 80%|█████████████████████▌     | 808/1014 [00:09<00:02, 80.81batch/s] 81%|█████████████████████▊     | 818/1014 [00:10<00:02, 80.72batch/s] 82%|██████████████████████     | 828/1014 [00:10<00:02, 80.75batch/s] 83%|██████████████████████▎    | 838/1014 [00:10<00:02, 80.67batch/s] 84%|██████████████████████▌    | 848/1014 [00:10<00:02, 80.66batch/s] 85%|██████████████████████▊    | 858/1014 [00:10<00:01, 80.70batch/s] 86%|███████████████████████    | 868/1014 [00:10<00:01, 80.76batch/s] 87%|███████████████████████▍   | 878/1014 [00:10<00:01, 80.90batch/s] 88%|███████████████████████▋   | 888/1014 [00:10<00:01, 81.02batch/s] 89%|███████████████████████▉   | 898/1014 [00:11<00:01, 80.97batch/s] 90%|████████████████████████▏  | 908/1014 [00:11<00:01, 80.95batch/s] 91%|████████████████████████▍  | 918/1014 [00:11<00:01, 80.98batch/s] 92%|████████████████████████▋  | 928/1014 [00:11<00:01, 80.94batch/s] 93%|████████████████████████▉  | 938/1014 [00:11<00:00, 80.96batch/s] 93%|█████████████████████████▏ | 948/1014 [00:11<00:00, 80.95batch/s] 94%|█████████████████████████▌ | 958/1014 [00:11<00:00, 80.99batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 81.04batch/s] 96%|██████████████████████████ | 978/1014 [00:12<00:00, 80.99batch/s] 97%|██████████████████████████▎| 988/1014 [00:12<00:00, 80.90batch/s] 98%|██████████████████████████▌| 998/1014 [00:12<00:00, 81.04batch/s] 99%|█████████████████████████▊| 1008/1014 [00:12<00:00, 81.01batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 81.06batch/s]
Validation 34 -> LOSS = 1.82
Validation 34 -> BLEU = 28.21, 59.8/34.4/22.4/14.7 (BP=0.983, ratio=0.984, hyp_len=12617, ref_len=12828)
Early stopping patience: 3
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 35
Epoch 35 - update      16230 => loss:   1.216 (#OOM: 0)
Epoch 35 - update      16260 => loss:   1.348 (#OOM: 0)
Epoch 35 - update      16290 => loss:   0.898 (#OOM: 0)
Epoch 35 - update      16320 => loss:   0.839 (#OOM: 0)
Epoch 35 - update      16350 => loss:   1.707 (#OOM: 0)
Epoch 35 - update      16380 => loss:   1.219 (#OOM: 0)
Epoch 35 - update      16410 => loss:   1.306 (#OOM: 0)
Epoch 35 - update      16440 => loss:   1.333 (#OOM: 0)
Epoch 35 - update      16470 => loss:   1.528 (#OOM: 0)
Epoch 35 - update      16500 => loss:   1.038 (#OOM: 0)
Epoch 35 - update      16530 => loss:   1.384 (#OOM: 0)
Epoch 35 - update      16560 => loss:   1.044 (#OOM: 0)
Epoch 35 - update      16590 => loss:   1.202 (#OOM: 0)
Epoch 35 - update      16620 => loss:   1.923 (#OOM: 0)
Epoch 35 - update      16650 => loss:   1.011 (#OOM: 0)
Epoch 35 - update      16680 => loss:   1.143 (#OOM: 0)
--> Epoch 35 finished with mean loss 1.48108
--> Overhead/Training/Evaluation: 0.04/0.57/0.00 mins (total: 0.61 mins)   (845 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 46.58batch/s] 37%|███████████▏                  | 13/35 [00:00<00:00, 58.37batch/s] 60%|██████████████████            | 21/35 [00:00<00:00, 55.95batch/s] 83%|████████████████████████▊     | 29/35 [00:00<00:00, 55.47batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.02batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▏                            | 8/1014 [00:00<00:12, 78.26batch/s]  2%|▍                           | 17/1014 [00:00<00:12, 81.97batch/s]  3%|▋                           | 26/1014 [00:00<00:11, 82.85batch/s]  3%|▉                           | 35/1014 [00:00<00:12, 81.56batch/s]  4%|█▏                          | 44/1014 [00:00<00:12, 79.79batch/s]  5%|█▍                          | 54/1014 [00:00<00:11, 82.48batch/s]  6%|█▊                          | 64/1014 [00:00<00:11, 81.49batch/s]  7%|██                          | 74/1014 [00:00<00:11, 81.97batch/s]  8%|██▎                         | 84/1014 [00:01<00:11, 83.62batch/s]  9%|██▌                         | 94/1014 [00:01<00:10, 83.93batch/s] 10%|██▊                        | 104/1014 [00:01<00:11, 82.63batch/s] 11%|███                        | 114/1014 [00:01<00:11, 81.53batch/s] 12%|███▎                       | 124/1014 [00:01<00:10, 82.01batch/s] 13%|███▌                       | 134/1014 [00:01<00:10, 81.99batch/s] 14%|███▊                       | 144/1014 [00:01<00:10, 81.02batch/s] 15%|████                       | 154/1014 [00:01<00:10, 81.59batch/s] 16%|████▎                      | 164/1014 [00:02<00:10, 81.26batch/s] 17%|████▋                      | 174/1014 [00:02<00:10, 81.28batch/s] 18%|████▉                      | 184/1014 [00:02<00:10, 81.06batch/s] 19%|█████▏                     | 194/1014 [00:02<00:10, 80.61batch/s] 20%|█████▍                     | 204/1014 [00:02<00:10, 80.99batch/s] 21%|█████▋                     | 214/1014 [00:02<00:09, 81.05batch/s] 22%|█████▉                     | 224/1014 [00:02<00:09, 80.65batch/s] 23%|██████▏                    | 234/1014 [00:02<00:09, 80.83batch/s] 24%|██████▍                    | 244/1014 [00:03<00:09, 81.02batch/s] 25%|██████▊                    | 254/1014 [00:03<00:09, 81.30batch/s] 26%|███████                    | 264/1014 [00:03<00:09, 81.13batch/s] 27%|███████▎                   | 274/1014 [00:03<00:09, 80.82batch/s] 28%|███████▌                   | 284/1014 [00:03<00:09, 80.93batch/s] 29%|███████▊                   | 294/1014 [00:03<00:08, 81.21batch/s] 30%|████████                   | 304/1014 [00:03<00:08, 81.21batch/s] 31%|████████▎                  | 314/1014 [00:03<00:08, 81.41batch/s] 32%|████████▋                  | 324/1014 [00:03<00:08, 81.76batch/s] 33%|████████▉                  | 334/1014 [00:04<00:08, 81.67batch/s] 34%|█████████▏                 | 344/1014 [00:04<00:08, 81.50batch/s] 35%|█████████▍                 | 354/1014 [00:04<00:08, 81.63batch/s] 36%|█████████▋                 | 364/1014 [00:04<00:07, 81.59batch/s] 37%|█████████▉                 | 374/1014 [00:04<00:07, 81.55batch/s] 38%|██████████▏                | 384/1014 [00:04<00:07, 81.42batch/s] 39%|██████████▍                | 394/1014 [00:04<00:07, 81.26batch/s] 40%|██████████▊                | 404/1014 [00:04<00:07, 81.43batch/s] 41%|███████████                | 414/1014 [00:05<00:07, 81.17batch/s] 42%|███████████▎               | 424/1014 [00:05<00:07, 81.42batch/s] 43%|███████████▌               | 434/1014 [00:05<00:07, 81.23batch/s] 44%|███████████▊               | 445/1014 [00:05<00:06, 81.54batch/s] 45%|████████████▏              | 456/1014 [00:05<00:06, 81.61batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 81.49batch/s] 47%|████████████▋              | 478/1014 [00:05<00:06, 81.29batch/s] 48%|█████████████              | 489/1014 [00:06<00:06, 80.68batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 80.66batch/s] 50%|█████████████▌             | 511/1014 [00:06<00:06, 80.94batch/s] 51%|█████████████▉             | 522/1014 [00:06<00:06, 80.97batch/s] 53%|██████████████▏            | 533/1014 [00:06<00:05, 81.00batch/s] 54%|██████████████▍            | 544/1014 [00:06<00:05, 81.00batch/s] 55%|██████████████▊            | 555/1014 [00:06<00:05, 80.80batch/s] 56%|███████████████            | 566/1014 [00:07<00:05, 80.82batch/s] 57%|███████████████▎           | 577/1014 [00:07<00:05, 80.87batch/s] 58%|███████████████▋           | 588/1014 [00:07<00:05, 80.88batch/s] 59%|███████████████▉           | 599/1014 [00:07<00:05, 81.02batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 81.00batch/s] 61%|████████████████▌          | 621/1014 [00:07<00:04, 80.90batch/s] 62%|████████████████▊          | 632/1014 [00:07<00:04, 80.92batch/s] 63%|█████████████████          | 643/1014 [00:07<00:04, 80.86batch/s] 64%|█████████████████▍         | 654/1014 [00:08<00:04, 80.64batch/s] 66%|█████████████████▋         | 665/1014 [00:08<00:04, 80.67batch/s] 67%|██████████████████         | 676/1014 [00:08<00:04, 80.35batch/s] 68%|██████████████████▎        | 687/1014 [00:08<00:04, 80.37batch/s] 69%|██████████████████▌        | 698/1014 [00:08<00:03, 80.40batch/s] 70%|██████████████████▉        | 709/1014 [00:08<00:03, 80.46batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 80.57batch/s] 72%|███████████████████▍       | 731/1014 [00:09<00:03, 80.66batch/s] 73%|███████████████████▊       | 742/1014 [00:09<00:03, 80.63batch/s] 74%|████████████████████       | 753/1014 [00:09<00:03, 80.68batch/s] 75%|████████████████████▎      | 764/1014 [00:09<00:03, 80.71batch/s] 76%|████████████████████▋      | 775/1014 [00:09<00:02, 80.70batch/s] 78%|████████████████████▉      | 786/1014 [00:09<00:02, 80.79batch/s] 79%|█████████████████████▏     | 797/1014 [00:09<00:02, 80.79batch/s] 80%|█████████████████████▌     | 808/1014 [00:09<00:02, 80.83batch/s] 81%|█████████████████████▊     | 819/1014 [00:10<00:02, 80.81batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 80.85batch/s] 83%|██████████████████████▍    | 841/1014 [00:10<00:02, 80.88batch/s] 84%|██████████████████████▋    | 852/1014 [00:10<00:02, 80.86batch/s] 85%|██████████████████████▉    | 863/1014 [00:10<00:01, 80.82batch/s] 86%|███████████████████████▎   | 874/1014 [00:10<00:01, 80.89batch/s] 87%|███████████████████████▌   | 885/1014 [00:10<00:01, 80.90batch/s] 88%|███████████████████████▊   | 896/1014 [00:11<00:01, 80.82batch/s] 89%|████████████████████████▏  | 907/1014 [00:11<00:01, 80.75batch/s] 91%|████████████████████████▍  | 918/1014 [00:11<00:01, 80.81batch/s] 92%|████████████████████████▋  | 929/1014 [00:11<00:01, 80.83batch/s] 93%|█████████████████████████  | 940/1014 [00:11<00:00, 80.86batch/s] 94%|█████████████████████████▎ | 951/1014 [00:11<00:00, 80.96batch/s] 95%|█████████████████████████▌ | 962/1014 [00:11<00:00, 81.03batch/s] 96%|█████████████████████████▉ | 973/1014 [00:12<00:00, 80.97batch/s] 97%|██████████████████████████▏| 984/1014 [00:12<00:00, 80.81batch/s] 98%|██████████████████████████▍| 995/1014 [00:12<00:00, 80.94batch/s] 99%|█████████████████████████▊| 1006/1014 [00:12<00:00, 80.92batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.86batch/s]
Validation 35 -> LOSS = 1.82
Validation 35 -> BLEU = 28.04, 59.4/34.2/22.1/14.4 (BP=0.988, ratio=0.988, hyp_len=12674, ref_len=12828)
Early stopping patience: 2
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 36
Epoch 36 - update      16710 => loss:   1.763 (#OOM: 0)
Epoch 36 - update      16740 => loss:   0.921 (#OOM: 0)
Epoch 36 - update      16770 => loss:   1.311 (#OOM: 0)
Epoch 36 - update      16800 => loss:   1.795 (#OOM: 0)
Epoch 36 - update      16830 => loss:   1.860 (#OOM: 0)
Epoch 36 - update      16860 => loss:   0.893 (#OOM: 0)
Epoch 36 - update      16890 => loss:   1.137 (#OOM: 0)
Epoch 36 - update      16920 => loss:   1.289 (#OOM: 0)
Epoch 36 - update      16950 => loss:   2.320 (#OOM: 0)
Epoch 36 - update      16980 => loss:   1.669 (#OOM: 0)
Epoch 36 - update      17010 => loss:   1.550 (#OOM: 0)
Epoch 36 - update      17040 => loss:   1.939 (#OOM: 0)
Epoch 36 - update      17070 => loss:   1.131 (#OOM: 0)
Epoch 36 - update      17100 => loss:   1.694 (#OOM: 0)
Epoch 36 - update      17130 => loss:   1.735 (#OOM: 0)
Epoch 36 - update      17160 => loss:   0.979 (#OOM: 0)
--> Epoch 36 finished with mean loss 1.47862
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (860 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 14%|████▍                          | 5/35 [00:00<00:00, 45.06batch/s] 31%|█████████▍                    | 11/35 [00:00<00:00, 50.59batch/s] 49%|██████████████▌               | 17/35 [00:00<00:00, 51.38batch/s] 66%|███████████████████▋          | 23/35 [00:00<00:00, 53.31batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 56.02batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 54.14batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                           | 10/1014 [00:00<00:10, 97.11batch/s]  2%|▌                           | 20/1014 [00:00<00:12, 82.67batch/s]  3%|▊                           | 30/1014 [00:00<00:11, 87.01batch/s]  4%|█                           | 40/1014 [00:00<00:11, 86.71batch/s]  5%|█▍                          | 50/1014 [00:00<00:11, 85.78batch/s]  6%|█▋                          | 60/1014 [00:00<00:11, 85.81batch/s]  7%|█▉                          | 70/1014 [00:00<00:11, 85.55batch/s]  8%|██▏                         | 80/1014 [00:00<00:10, 85.05batch/s]  9%|██▍                         | 90/1014 [00:01<00:10, 85.44batch/s] 10%|██▋                        | 100/1014 [00:01<00:10, 85.39batch/s] 11%|██▉                        | 110/1014 [00:01<00:10, 84.81batch/s] 12%|███▏                       | 120/1014 [00:01<00:10, 84.41batch/s] 13%|███▍                       | 130/1014 [00:01<00:10, 84.25batch/s] 14%|███▋                       | 140/1014 [00:01<00:10, 83.71batch/s] 15%|███▉                       | 150/1014 [00:01<00:10, 83.56batch/s] 16%|████▎                      | 160/1014 [00:01<00:10, 83.55batch/s] 17%|████▌                      | 170/1014 [00:02<00:10, 83.73batch/s] 18%|████▊                      | 180/1014 [00:02<00:10, 82.89batch/s] 19%|█████                      | 190/1014 [00:02<00:09, 82.76batch/s] 20%|█████▎                     | 200/1014 [00:02<00:09, 83.01batch/s] 21%|█████▌                     | 210/1014 [00:02<00:09, 83.07batch/s] 22%|█████▊                     | 220/1014 [00:02<00:09, 82.92batch/s] 23%|██████                     | 230/1014 [00:02<00:09, 82.62batch/s] 24%|██████▍                    | 240/1014 [00:02<00:09, 82.99batch/s] 25%|██████▋                    | 250/1014 [00:02<00:09, 83.35batch/s] 26%|██████▉                    | 260/1014 [00:03<00:09, 83.55batch/s] 27%|███████▏                   | 270/1014 [00:03<00:08, 83.20batch/s] 28%|███████▍                   | 280/1014 [00:03<00:08, 83.14batch/s] 29%|███████▋                   | 290/1014 [00:03<00:08, 83.06batch/s] 30%|███████▉                   | 300/1014 [00:03<00:08, 83.08batch/s] 31%|████████▎                  | 310/1014 [00:03<00:08, 82.74batch/s] 32%|████████▌                  | 320/1014 [00:03<00:08, 82.05batch/s] 33%|████████▊                  | 330/1014 [00:04<00:08, 82.23batch/s] 34%|█████████                  | 340/1014 [00:04<00:08, 81.85batch/s] 35%|█████████▎                 | 350/1014 [00:04<00:08, 81.95batch/s] 36%|█████████▌                 | 360/1014 [00:04<00:07, 82.00batch/s] 36%|█████████▊                 | 370/1014 [00:04<00:07, 81.88batch/s] 37%|██████████                 | 380/1014 [00:04<00:07, 81.52batch/s] 38%|██████████▍                | 390/1014 [00:04<00:07, 81.45batch/s] 39%|██████████▋                | 400/1014 [00:04<00:07, 81.81batch/s] 40%|██████████▉                | 410/1014 [00:05<00:07, 81.69batch/s] 41%|███████████▏               | 420/1014 [00:05<00:07, 81.63batch/s] 42%|███████████▍               | 430/1014 [00:05<00:07, 81.60batch/s] 43%|███████████▋               | 440/1014 [00:05<00:07, 81.60batch/s] 44%|███████████▉               | 450/1014 [00:05<00:06, 81.62batch/s] 45%|████████████▏              | 460/1014 [00:05<00:06, 81.62batch/s] 46%|████████████▌              | 470/1014 [00:05<00:06, 81.62batch/s] 47%|████████████▊              | 480/1014 [00:05<00:06, 81.48batch/s] 48%|█████████████              | 490/1014 [00:06<00:06, 81.50batch/s] 49%|█████████████▎             | 500/1014 [00:06<00:06, 81.20batch/s] 50%|█████████████▌             | 510/1014 [00:06<00:06, 81.07batch/s] 51%|█████████████▊             | 520/1014 [00:06<00:06, 81.04batch/s] 52%|██████████████             | 530/1014 [00:06<00:05, 81.06batch/s] 53%|██████████████▍            | 540/1014 [00:06<00:05, 81.06batch/s] 54%|██████████████▋            | 550/1014 [00:06<00:05, 81.14batch/s] 55%|██████████████▉            | 560/1014 [00:06<00:05, 81.02batch/s] 56%|███████████████▏           | 570/1014 [00:07<00:05, 81.13batch/s] 57%|███████████████▍           | 580/1014 [00:07<00:05, 81.06batch/s] 58%|███████████████▋           | 590/1014 [00:07<00:05, 80.93batch/s] 59%|███████████████▉           | 600/1014 [00:07<00:05, 80.88batch/s] 60%|████████████████▏          | 610/1014 [00:07<00:04, 80.86batch/s] 61%|████████████████▌          | 620/1014 [00:07<00:04, 80.79batch/s] 62%|████████████████▊          | 630/1014 [00:07<00:04, 80.56batch/s] 63%|█████████████████          | 640/1014 [00:07<00:04, 80.70batch/s] 64%|█████████████████▎         | 650/1014 [00:08<00:04, 80.51batch/s] 65%|█████████████████▌         | 660/1014 [00:08<00:04, 80.44batch/s] 66%|█████████████████▊         | 670/1014 [00:08<00:04, 80.44batch/s] 67%|██████████████████         | 680/1014 [00:08<00:04, 80.30batch/s] 68%|██████████████████▎        | 690/1014 [00:08<00:04, 80.25batch/s] 69%|██████████████████▋        | 700/1014 [00:08<00:03, 80.30batch/s] 70%|██████████████████▉        | 710/1014 [00:08<00:03, 80.36batch/s] 71%|███████████████████▏       | 720/1014 [00:08<00:03, 80.42batch/s] 72%|███████████████████▍       | 730/1014 [00:09<00:03, 80.32batch/s] 73%|███████████████████▋       | 740/1014 [00:09<00:03, 80.34batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 80.38batch/s] 75%|████████████████████▏      | 760/1014 [00:09<00:03, 80.51batch/s] 76%|████████████████████▌      | 770/1014 [00:09<00:03, 80.55batch/s] 77%|████████████████████▊      | 780/1014 [00:09<00:02, 80.70batch/s] 78%|█████████████████████      | 790/1014 [00:09<00:02, 80.58batch/s] 79%|█████████████████████▎     | 800/1014 [00:09<00:02, 80.61batch/s] 80%|█████████████████████▌     | 810/1014 [00:10<00:02, 80.67batch/s] 81%|█████████████████████▊     | 820/1014 [00:10<00:02, 80.52batch/s] 82%|██████████████████████     | 830/1014 [00:10<00:02, 80.55batch/s] 83%|██████████████████████▎    | 840/1014 [00:10<00:02, 80.53batch/s] 84%|██████████████████████▋    | 850/1014 [00:10<00:02, 80.56batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 80.64batch/s] 86%|███████████████████████▏   | 870/1014 [00:10<00:01, 80.71batch/s] 87%|███████████████████████▍   | 880/1014 [00:10<00:01, 80.67batch/s] 88%|███████████████████████▋   | 891/1014 [00:11<00:01, 80.87batch/s] 89%|████████████████████████   | 902/1014 [00:11<00:01, 80.81batch/s] 90%|████████████████████████▎  | 913/1014 [00:11<00:01, 80.80batch/s] 91%|████████████████████████▌  | 924/1014 [00:11<00:01, 80.78batch/s] 92%|████████████████████████▉  | 935/1014 [00:11<00:00, 80.88batch/s] 93%|█████████████████████████▏ | 946/1014 [00:11<00:00, 80.77batch/s] 94%|█████████████████████████▍ | 957/1014 [00:11<00:00, 80.75batch/s] 95%|█████████████████████████▊ | 968/1014 [00:11<00:00, 80.69batch/s] 97%|██████████████████████████ | 979/1014 [00:12<00:00, 80.75batch/s] 98%|██████████████████████████▎| 990/1014 [00:12<00:00, 80.74batch/s] 99%|█████████████████████████▋| 1001/1014 [00:12<00:00, 80.71batch/s]100%|█████████████████████████▉| 1012/1014 [00:12<00:00, 80.63batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 80.65batch/s]
Validation 36 -> LOSS = 1.82
Validation 36 -> BLEU = 28.30, 59.7/34.4/22.4/14.7 (BP=0.988, ratio=0.988, hyp_len=12672, ref_len=12828)
** Learning rate changed -> 1.25e-05
Early stopping patience: 1
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 37
Epoch 37 - update      17190 => loss:   1.072 (#OOM: 0)
Epoch 37 - update      17220 => loss:   1.056 (#OOM: 0)
Epoch 37 - update      17250 => loss:   0.826 (#OOM: 0)
Epoch 37 - update      17280 => loss:   1.775 (#OOM: 0)
Epoch 37 - update      17310 => loss:   1.857 (#OOM: 0)
Epoch 37 - update      17340 => loss:   1.877 (#OOM: 0)
Epoch 37 - update      17370 => loss:   1.312 (#OOM: 0)
Epoch 37 - update      17400 => loss:   1.196 (#OOM: 0)
Epoch 37 - update      17430 => loss:   0.966 (#OOM: 0)
Epoch 37 - update      17460 => loss:   1.479 (#OOM: 0)
Epoch 37 - update      17490 => loss:   1.248 (#OOM: 0)
Epoch 37 - update      17520 => loss:   1.687 (#OOM: 0)
Epoch 37 - update      17550 => loss:   1.646 (#OOM: 0)
Epoch 37 - update      17580 => loss:   1.138 (#OOM: 0)
Epoch 37 - update      17610 => loss:   1.738 (#OOM: 0)
Epoch 37 - update      17640 => loss:   1.590 (#OOM: 0)
--> Epoch 37 finished with mean loss 1.47472
--> Overhead/Training/Evaluation: 0.04/0.56/0.00 mins (total: 0.60 mins)   (862 samples/sec)
Computing evaluation loss...
  0%|                                       | 0/35 [00:00<?, ?batch/s] 17%|█████▎                         | 6/35 [00:00<00:00, 54.83batch/s] 34%|██████████▎                   | 12/35 [00:00<00:00, 55.59batch/s] 51%|███████████████▍              | 18/35 [00:00<00:00, 55.16batch/s] 69%|████████████████████▌         | 24/35 [00:00<00:00, 54.37batch/s] 86%|█████████████████████████▋    | 30/35 [00:00<00:00, 54.89batch/s]100%|██████████████████████████████| 35/35 [00:00<00:00, 55.25batch/s]
Performing greedy search (args: {'k': 2})
  0%|                                     | 0/1014 [00:00<?, ?batch/s]  1%|▎                            | 9/1014 [00:00<00:11, 85.29batch/s]  2%|▍                           | 18/1014 [00:00<00:12, 77.59batch/s]  3%|▋                           | 27/1014 [00:00<00:12, 79.95batch/s]  4%|█                           | 37/1014 [00:00<00:11, 82.70batch/s]  5%|█▎                          | 47/1014 [00:00<00:11, 81.34batch/s]  6%|█▌                          | 57/1014 [00:00<00:11, 80.02batch/s]  7%|█▊                          | 67/1014 [00:00<00:11, 80.56batch/s]  8%|██▏                         | 77/1014 [00:00<00:11, 81.88batch/s]  9%|██▍                         | 87/1014 [00:01<00:11, 81.32batch/s] 10%|██▋                         | 97/1014 [00:01<00:11, 82.08batch/s] 11%|██▊                        | 107/1014 [00:01<00:11, 82.06batch/s] 12%|███                        | 117/1014 [00:01<00:10, 82.22batch/s] 13%|███▍                       | 127/1014 [00:01<00:10, 81.91batch/s] 14%|███▋                       | 137/1014 [00:01<00:10, 81.26batch/s] 14%|███▉                       | 147/1014 [00:01<00:10, 81.21batch/s] 15%|████▏                      | 157/1014 [00:01<00:10, 81.08batch/s] 16%|████▍                      | 167/1014 [00:02<00:10, 81.05batch/s] 17%|████▋                      | 177/1014 [00:02<00:10, 80.95batch/s] 18%|████▉                      | 187/1014 [00:02<00:10, 81.21batch/s] 19%|█████▏                     | 197/1014 [00:02<00:10, 81.03batch/s] 20%|█████▌                     | 207/1014 [00:02<00:09, 81.58batch/s] 21%|█████▊                     | 217/1014 [00:02<00:09, 82.07batch/s] 22%|██████                     | 227/1014 [00:02<00:09, 82.23batch/s] 23%|██████▎                    | 237/1014 [00:02<00:09, 82.23batch/s] 24%|██████▌                    | 247/1014 [00:03<00:09, 82.12batch/s] 25%|██████▊                    | 257/1014 [00:03<00:09, 82.09batch/s] 26%|███████                    | 267/1014 [00:03<00:09, 82.33batch/s] 27%|███████▍                   | 277/1014 [00:03<00:08, 82.26batch/s] 28%|███████▋                   | 287/1014 [00:03<00:08, 82.50batch/s] 29%|███████▉                   | 297/1014 [00:03<00:08, 82.72batch/s] 30%|████████▏                  | 307/1014 [00:03<00:08, 82.50batch/s] 31%|████████▍                  | 317/1014 [00:03<00:08, 82.40batch/s] 32%|████████▋                  | 327/1014 [00:03<00:08, 82.29batch/s] 33%|████████▉                  | 337/1014 [00:04<00:08, 82.32batch/s] 34%|█████████▏                 | 347/1014 [00:04<00:08, 82.15batch/s] 35%|█████████▌                 | 357/1014 [00:04<00:08, 82.12batch/s] 36%|█████████▊                 | 367/1014 [00:04<00:07, 82.41batch/s] 37%|██████████                 | 377/1014 [00:04<00:07, 82.22batch/s] 38%|██████████▎                | 387/1014 [00:04<00:07, 82.19batch/s] 39%|██████████▌                | 397/1014 [00:04<00:07, 81.92batch/s] 40%|██████████▊                | 407/1014 [00:04<00:07, 82.16batch/s] 41%|███████████                | 417/1014 [00:05<00:07, 82.04batch/s] 42%|███████████▎               | 427/1014 [00:05<00:07, 82.00batch/s] 43%|███████████▋               | 437/1014 [00:05<00:07, 81.84batch/s] 44%|███████████▉               | 447/1014 [00:05<00:06, 82.02batch/s] 45%|████████████▏              | 457/1014 [00:05<00:06, 82.27batch/s] 46%|████████████▍              | 467/1014 [00:05<00:06, 82.04batch/s] 47%|████████████▋              | 477/1014 [00:05<00:06, 82.22batch/s] 48%|████████████▉              | 487/1014 [00:05<00:06, 82.06batch/s] 49%|█████████████▏             | 497/1014 [00:06<00:06, 82.25batch/s] 50%|█████████████▌             | 508/1014 [00:06<00:06, 82.59batch/s] 51%|█████████████▊             | 519/1014 [00:06<00:05, 82.60batch/s] 52%|██████████████             | 530/1014 [00:06<00:05, 82.51batch/s] 53%|██████████████▍            | 541/1014 [00:06<00:05, 82.65batch/s] 54%|██████████████▋            | 552/1014 [00:06<00:05, 82.66batch/s] 56%|██████████████▉            | 563/1014 [00:06<00:05, 82.65batch/s] 57%|███████████████▎           | 574/1014 [00:06<00:05, 82.53batch/s] 58%|███████████████▌           | 585/1014 [00:07<00:05, 82.40batch/s] 59%|███████████████▊           | 596/1014 [00:07<00:05, 82.40batch/s] 60%|████████████████▏          | 607/1014 [00:07<00:04, 82.44batch/s] 61%|████████████████▍          | 618/1014 [00:07<00:04, 82.31batch/s] 62%|████████████████▋          | 629/1014 [00:07<00:04, 82.27batch/s] 63%|█████████████████          | 640/1014 [00:07<00:04, 82.37batch/s] 64%|█████████████████▎         | 651/1014 [00:07<00:04, 82.46batch/s] 65%|█████████████████▋         | 662/1014 [00:08<00:04, 82.31batch/s] 66%|█████████████████▉         | 673/1014 [00:08<00:04, 82.33batch/s] 67%|██████████████████▏        | 684/1014 [00:08<00:04, 82.30batch/s] 69%|██████████████████▌        | 695/1014 [00:08<00:03, 82.13batch/s] 70%|██████████████████▊        | 706/1014 [00:08<00:03, 82.31batch/s] 71%|███████████████████        | 717/1014 [00:08<00:03, 82.22batch/s] 72%|███████████████████▍       | 728/1014 [00:08<00:03, 82.17batch/s] 73%|███████████████████▋       | 739/1014 [00:08<00:03, 82.24batch/s] 74%|███████████████████▉       | 750/1014 [00:09<00:03, 82.18batch/s] 75%|████████████████████▎      | 761/1014 [00:09<00:03, 82.09batch/s] 76%|████████████████████▌      | 772/1014 [00:09<00:02, 82.15batch/s] 77%|████████████████████▊      | 783/1014 [00:09<00:02, 82.17batch/s] 78%|█████████████████████▏     | 794/1014 [00:09<00:02, 82.01batch/s] 79%|█████████████████████▍     | 805/1014 [00:09<00:02, 82.11batch/s] 80%|█████████████████████▋     | 816/1014 [00:09<00:02, 81.92batch/s] 82%|██████████████████████     | 827/1014 [00:10<00:02, 81.86batch/s] 83%|██████████████████████▎    | 838/1014 [00:10<00:02, 81.92batch/s] 84%|██████████████████████▌    | 849/1014 [00:10<00:02, 81.99batch/s] 85%|██████████████████████▉    | 860/1014 [00:10<00:01, 82.03batch/s] 86%|███████████████████████▏   | 871/1014 [00:10<00:01, 82.06batch/s] 87%|███████████████████████▍   | 882/1014 [00:10<00:01, 82.05batch/s] 88%|███████████████████████▊   | 893/1014 [00:10<00:01, 81.90batch/s] 89%|████████████████████████   | 904/1014 [00:11<00:01, 82.00batch/s] 90%|████████████████████████▎  | 915/1014 [00:11<00:01, 82.21batch/s] 91%|████████████████████████▋  | 926/1014 [00:11<00:01, 82.22batch/s] 92%|████████████████████████▉  | 937/1014 [00:11<00:00, 82.19batch/s] 93%|█████████████████████████▏ | 948/1014 [00:11<00:00, 82.16batch/s] 95%|█████████████████████████▌ | 959/1014 [00:11<00:00, 82.20batch/s] 96%|█████████████████████████▊ | 970/1014 [00:11<00:00, 82.23batch/s] 97%|██████████████████████████ | 981/1014 [00:11<00:00, 82.14batch/s] 98%|██████████████████████████▍| 992/1014 [00:12<00:00, 82.14batch/s] 99%|█████████████████████████▋| 1003/1014 [00:12<00:00, 82.15batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.11batch/s]100%|██████████████████████████| 1014/1014 [00:12<00:00, 82.11batch/s]
Validation 37 -> LOSS = 1.82
Validation 37 -> BLEU = 28.20, 59.6/34.3/22.3/14.6 (BP=0.987, ratio=0.987, hyp_len=12662, ref_len=12828)
Early stopping patience: 0
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Starting Epoch 38
Early stopped.
--> This is model: simultaneouswaitknmt-r9aa11
--> Best LOSS so far: 1.81 @ validation 27
--> Best BLEU so far: 28.74 @ validation 27
Training finished on 24-04-2020 03:37
Fri Apr 24 03:38:00 2020       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 435.21       Driver Version: 435.21       CUDA Version: 10.1     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  TITAN Xp            On   | 00000000:B3:00.0 Off |                  N/A |
| 23%   41C    P0    63W / 250W |      0MiB / 12196MiB |      4%      Default |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
 03:38:00 up 112 days, 12:52,  4 users,  load average: 15.53, 15.62, 15.62
